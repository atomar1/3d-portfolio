function _mergeNamespaces(nt,_e){for(var et=0;et<_e.length;et++){const rt=_e[et];if(typeof rt!="string"&&!Array.isArray(rt)){for(const it in rt)if(it!=="default"&&!(it in nt)){const st=Object.getOwnPropertyDescriptor(rt,it);st&&Object.defineProperty(nt,it,st.get?st:{enumerable:!0,get:()=>rt[it]})}}}return Object.freeze(Object.defineProperty(nt,Symbol.toStringTag,{value:"Module"}))}(function(){const _e=document.createElement("link").relList;if(_e&&_e.supports&&_e.supports("modulepreload"))return;for(const it of document.querySelectorAll('link[rel="modulepreload"]'))rt(it);new MutationObserver(it=>{for(const st of it)if(st.type==="childList")for(const ot of st.addedNodes)ot.tagName==="LINK"&&ot.rel==="modulepreload"&&rt(ot)}).observe(document,{childList:!0,subtree:!0});function et(it){const st={};return it.integrity&&(st.integrity=it.integrity),it.referrerPolicy&&(st.referrerPolicy=it.referrerPolicy),it.crossOrigin==="use-credentials"?st.credentials="include":it.crossOrigin==="anonymous"?st.credentials="omit":st.credentials="same-origin",st}function rt(it){if(it.ep)return;it.ep=!0;const st=et(it);fetch(it.href,st)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(nt){return nt&&nt.__esModule&&Object.prototype.hasOwnProperty.call(nt,"default")?nt.default:nt}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$4=Symbol.for("react.portal"),p$6=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$4=Symbol.for("react.context"),v$5=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$3=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$2(nt){return nt===null||typeof nt!="object"?null:(nt=z$3&&nt[z$3]||nt["@@iterator"],typeof nt=="function"?nt:null)}var B$3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$3={};function E$3(nt,_e,et){this.props=nt,this.context=_e,this.refs=D$3,this.updater=et||B$3}E$3.prototype.isReactComponent={};E$3.prototype.setState=function(nt,_e){if(typeof nt!="object"&&typeof nt!="function"&&nt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,nt,_e,"setState")};E$3.prototype.forceUpdate=function(nt){this.updater.enqueueForceUpdate(this,nt,"forceUpdate")};function F$2(){}F$2.prototype=E$3.prototype;function G$2(nt,_e,et){this.props=nt,this.context=_e,this.refs=D$3,this.updater=et||B$3}var H$3=G$2.prototype=new F$2;H$3.constructor=G$2;C$2(H$3,E$3.prototype);H$3.isPureReactComponent=!0;var I$5=Array.isArray,J$2=Object.prototype.hasOwnProperty,K$1={current:null},L$4={key:!0,ref:!0,__self:!0,__source:!0};function M$4(nt,_e,et){var rt,it={},st=null,ot=null;if(_e!=null)for(rt in _e.ref!==void 0&&(ot=_e.ref),_e.key!==void 0&&(st=""+_e.key),_e)J$2.call(_e,rt)&&!L$4.hasOwnProperty(rt)&&(it[rt]=_e[rt]);var at=arguments.length-2;if(at===1)it.children=et;else if(1<at){for(var lt=Array(at),ct=0;ct<at;ct++)lt[ct]=arguments[ct+2];it.children=lt}if(nt&&nt.defaultProps)for(rt in at=nt.defaultProps,at)it[rt]===void 0&&(it[rt]=at[rt]);return{$$typeof:l$3,type:nt,key:st,ref:ot,props:it,_owner:K$1.current}}function N$4(nt,_e){return{$$typeof:l$3,type:nt.type,key:_e,ref:nt.ref,props:nt.props,_owner:nt._owner}}function O$2(nt){return typeof nt=="object"&&nt!==null&&nt.$$typeof===l$3}function escape$1(nt){var _e={"=":"=0",":":"=2"};return"$"+nt.replace(/[=:]/g,function(et){return _e[et]})}var P$2=/\/+/g;function Q$3(nt,_e){return typeof nt=="object"&&nt!==null&&nt.key!=null?escape$1(""+nt.key):_e.toString(36)}function R$3(nt,_e,et,rt,it){var st=typeof nt;(st==="undefined"||st==="boolean")&&(nt=null);var ot=!1;if(nt===null)ot=!0;else switch(st){case"string":case"number":ot=!0;break;case"object":switch(nt.$$typeof){case l$3:case n$4:ot=!0}}if(ot)return ot=nt,it=it(ot),nt=rt===""?"."+Q$3(ot,0):rt,I$5(it)?(et="",nt!=null&&(et=nt.replace(P$2,"$&/")+"/"),R$3(it,_e,et,"",function(ct){return ct})):it!=null&&(O$2(it)&&(it=N$4(it,et+(!it.key||ot&&ot.key===it.key?"":(""+it.key).replace(P$2,"$&/")+"/")+nt)),_e.push(it)),1;if(ot=0,rt=rt===""?".":rt+":",I$5(nt))for(var at=0;at<nt.length;at++){st=nt[at];var lt=rt+Q$3(st,at);ot+=R$3(st,_e,et,lt,it)}else if(lt=A$2(nt),typeof lt=="function")for(nt=lt.call(nt),at=0;!(st=nt.next()).done;)st=st.value,lt=rt+Q$3(st,at++),ot+=R$3(st,_e,et,lt,it);else if(st==="object")throw _e=String(nt),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(nt).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.");return ot}function S$4(nt,_e,et){if(nt==null)return nt;var rt=[],it=0;return R$3(nt,rt,"","",function(st){return _e.call(et,st,it++)}),rt}function T$3(nt){if(nt._status===-1){var _e=nt._result;_e=_e(),_e.then(function(et){(nt._status===0||nt._status===-1)&&(nt._status=1,nt._result=et)},function(et){(nt._status===0||nt._status===-1)&&(nt._status=2,nt._result=et)}),nt._status===-1&&(nt._status=0,nt._result=_e)}if(nt._status===1)return nt._result.default;throw nt._result}var U$4={current:null},V$5={transition:null},W$3={ReactCurrentDispatcher:U$4,ReactCurrentBatchConfig:V$5,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$4,forEach:function(nt,_e,et){S$4(nt,function(){_e.apply(this,arguments)},et)},count:function(nt){var _e=0;return S$4(nt,function(){_e++}),_e},toArray:function(nt){return S$4(nt,function(_e){return _e})||[]},only:function(nt){if(!O$2(nt))throw Error("React.Children.only expected to receive a single React element child.");return nt}};react_production_min.Component=E$3;react_production_min.Fragment=p$6;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$3;react_production_min.act=X$2;react_production_min.cloneElement=function(nt,_e,et){if(nt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+nt+".");var rt=C$2({},nt.props),it=nt.key,st=nt.ref,ot=nt._owner;if(_e!=null){if(_e.ref!==void 0&&(st=_e.ref,ot=K$1.current),_e.key!==void 0&&(it=""+_e.key),nt.type&&nt.type.defaultProps)var at=nt.type.defaultProps;for(lt in _e)J$2.call(_e,lt)&&!L$4.hasOwnProperty(lt)&&(rt[lt]=_e[lt]===void 0&&at!==void 0?at[lt]:_e[lt])}var lt=arguments.length-2;if(lt===1)rt.children=et;else if(1<lt){at=Array(lt);for(var ct=0;ct<lt;ct++)at[ct]=arguments[ct+2];rt.children=at}return{$$typeof:l$3,type:nt.type,key:it,ref:st,props:rt,_owner:ot}};react_production_min.createContext=function(nt){return nt={$$typeof:u$4,_currentValue:nt,_currentValue2:nt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},nt.Provider={$$typeof:t$2,_context:nt},nt.Consumer=nt};react_production_min.createElement=M$4;react_production_min.createFactory=function(nt){var _e=M$4.bind(null,nt);return _e.type=nt,_e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(nt){return{$$typeof:v$5,render:nt}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(nt){return{$$typeof:y$3,_payload:{_status:-1,_result:nt},_init:T$3}};react_production_min.memo=function(nt,_e){return{$$typeof:x$2,type:nt,compare:_e===void 0?null:_e}};react_production_min.startTransition=function(nt){var _e=V$5.transition;V$5.transition={};try{nt()}finally{V$5.transition=_e}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(nt,_e){return U$4.current.useCallback(nt,_e)};react_production_min.useContext=function(nt){return U$4.current.useContext(nt)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(nt){return U$4.current.useDeferredValue(nt)};react_production_min.useEffect=function(nt,_e){return U$4.current.useEffect(nt,_e)};react_production_min.useId=function(){return U$4.current.useId()};react_production_min.useImperativeHandle=function(nt,_e,et){return U$4.current.useImperativeHandle(nt,_e,et)};react_production_min.useInsertionEffect=function(nt,_e){return U$4.current.useInsertionEffect(nt,_e)};react_production_min.useLayoutEffect=function(nt,_e){return U$4.current.useLayoutEffect(nt,_e)};react_production_min.useMemo=function(nt,_e){return U$4.current.useMemo(nt,_e)};react_production_min.useReducer=function(nt,_e,et){return U$4.current.useReducer(nt,_e,et)};react_production_min.useRef=function(nt){return U$4.current.useRef(nt)};react_production_min.useState=function(nt){return U$4.current.useState(nt)};react_production_min.useSyncExternalStore=function(nt,_e,et){return U$4.current.useSyncExternalStore(nt,_e,et)};react_production_min.useTransition=function(){return U$4.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs$1(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$3=reactExports,k$3=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$4=Object.prototype.hasOwnProperty,n$3=f$3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$5={key:!0,ref:!0,__self:!0,__source:!0};function q$2(nt,_e,et){var rt,it={},st=null,ot=null;et!==void 0&&(st=""+et),_e.key!==void 0&&(st=""+_e.key),_e.ref!==void 0&&(ot=_e.ref);for(rt in _e)m$4.call(_e,rt)&&!p$5.hasOwnProperty(rt)&&(it[rt]=_e[rt]);if(nt&&nt.defaultProps)for(rt in _e=nt.defaultProps,_e)it[rt]===void 0&&(it[rt]=_e[rt]);return{$$typeof:k$3,type:nt,key:st,ref:ot,props:it,_owner:n$3.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler$2={exports:{}},scheduler_production_min$2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(nt){function _e(Gt,jt){var Kt=Gt.length;Gt.push(jt);e:for(;0<Kt;){var Jt=Kt-1>>>1,sn=Gt[Jt];if(0<it(sn,jt))Gt[Jt]=jt,Gt[Kt]=sn,Kt=Jt;else break e}}function et(Gt){return Gt.length===0?null:Gt[0]}function rt(Gt){if(Gt.length===0)return null;var jt=Gt[0],Kt=Gt.pop();if(Kt!==jt){Gt[0]=Kt;e:for(var Jt=0,sn=Gt.length,hn=sn>>>1;Jt<hn;){var an=2*(Jt+1)-1,pn=Gt[an],_n=an+1,yn=Gt[_n];if(0>it(pn,Kt))_n<sn&&0>it(yn,pn)?(Gt[Jt]=yn,Gt[_n]=Kt,Jt=_n):(Gt[Jt]=pn,Gt[an]=Kt,Jt=an);else if(_n<sn&&0>it(yn,Kt))Gt[Jt]=yn,Gt[_n]=Kt,Jt=_n;else break e}}return jt}function it(Gt,jt){var Kt=Gt.sortIndex-jt.sortIndex;return Kt!==0?Kt:Gt.id-jt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;nt.unstable_now=function(){return st.now()}}else{var ot=Date,at=ot.now();nt.unstable_now=function(){return ot.now()-at}}var lt=[],ct=[],ut=1,ht=null,dt=3,ft=!1,pt=!1,mt=!1,At=typeof setTimeout=="function"?setTimeout:null,gt=typeof clearTimeout=="function"?clearTimeout:null,bt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Tt(Gt){for(var jt=et(ct);jt!==null;){if(jt.callback===null)rt(ct);else if(jt.startTime<=Gt)rt(ct),jt.sortIndex=jt.expirationTime,_e(lt,jt);else break;jt=et(ct)}}function wt(Gt){if(mt=!1,Tt(Gt),!pt)if(et(lt)!==null)pt=!0,Zt(Rt);else{var jt=et(ct);jt!==null&&rn(wt,jt.startTime-Gt)}}function Rt(Gt,jt){pt=!1,mt&&(mt=!1,gt($t),$t=-1),ft=!0;var Kt=dt;try{for(Tt(jt),ht=et(lt);ht!==null&&(!(ht.expirationTime>jt)||Gt&&!Ot());){var Jt=ht.callback;if(typeof Jt=="function"){ht.callback=null,dt=ht.priorityLevel;var sn=Jt(ht.expirationTime<=jt);jt=nt.unstable_now(),typeof sn=="function"?ht.callback=sn:ht===et(lt)&&rt(lt),Tt(jt)}else rt(lt);ht=et(lt)}if(ht!==null)var hn=!0;else{var an=et(ct);an!==null&&rn(wt,an.startTime-jt),hn=!1}return hn}finally{ht=null,dt=Kt,ft=!1}}var It=!1,Lt=null,$t=-1,kt=5,Dt=-1;function Ot(){return!(nt.unstable_now()-Dt<kt)}function zt(){if(Lt!==null){var Gt=nt.unstable_now();Dt=Gt;var jt=!0;try{jt=Lt(!0,Gt)}finally{jt?Ht():(It=!1,Lt=null)}}else It=!1}var Ht;if(typeof bt=="function")Ht=function(){bt(zt)};else if(typeof MessageChannel<"u"){var Yt=new MessageChannel,Xt=Yt.port2;Yt.port1.onmessage=zt,Ht=function(){Xt.postMessage(null)}}else Ht=function(){At(zt,0)};function Zt(Gt){Lt=Gt,It||(It=!0,Ht())}function rn(Gt,jt){$t=At(function(){Gt(nt.unstable_now())},jt)}nt.unstable_IdlePriority=5,nt.unstable_ImmediatePriority=1,nt.unstable_LowPriority=4,nt.unstable_NormalPriority=3,nt.unstable_Profiling=null,nt.unstable_UserBlockingPriority=2,nt.unstable_cancelCallback=function(Gt){Gt.callback=null},nt.unstable_continueExecution=function(){pt||ft||(pt=!0,Zt(Rt))},nt.unstable_forceFrameRate=function(Gt){0>Gt||125<Gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<Gt?Math.floor(1e3/Gt):5},nt.unstable_getCurrentPriorityLevel=function(){return dt},nt.unstable_getFirstCallbackNode=function(){return et(lt)},nt.unstable_next=function(Gt){switch(dt){case 1:case 2:case 3:var jt=3;break;default:jt=dt}var Kt=dt;dt=jt;try{return Gt()}finally{dt=Kt}},nt.unstable_pauseExecution=function(){},nt.unstable_requestPaint=function(){},nt.unstable_runWithPriority=function(Gt,jt){switch(Gt){case 1:case 2:case 3:case 4:case 5:break;default:Gt=3}var Kt=dt;dt=Gt;try{return jt()}finally{dt=Kt}},nt.unstable_scheduleCallback=function(Gt,jt,Kt){var Jt=nt.unstable_now();switch(typeof Kt=="object"&&Kt!==null?(Kt=Kt.delay,Kt=typeof Kt=="number"&&0<Kt?Jt+Kt:Jt):Kt=Jt,Gt){case 1:var sn=-1;break;case 2:sn=250;break;case 5:sn=1073741823;break;case 4:sn=1e4;break;default:sn=5e3}return sn=Kt+sn,Gt={id:ut++,callback:jt,priorityLevel:Gt,startTime:Kt,expirationTime:sn,sortIndex:-1},Kt>Jt?(Gt.sortIndex=Kt,_e(ct,Gt),et(lt)===null&&Gt===et(ct)&&(mt?(gt($t),$t=-1):mt=!0,rn(wt,Kt-Jt))):(Gt.sortIndex=sn,_e(lt,Gt),pt||ft||(pt=!0,Zt(Rt))),Gt},nt.unstable_shouldYield=Ot,nt.unstable_wrapCallback=function(Gt){var jt=dt;return function(){var Kt=dt;dt=jt;try{return Gt.apply(this,arguments)}finally{dt=Kt}}}})(scheduler_production_min$2);scheduler$2.exports=scheduler_production_min$2;var schedulerExports$1=scheduler$2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports$1;function p$4(nt){for(var _e="https://reactjs.org/docs/error-decoder.html?invariant="+nt,et=1;et<arguments.length;et++)_e+="&args[]="+encodeURIComponent(arguments[et]);return"Minified React error #"+nt+"; visit "+_e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(nt,_e){ha(nt,_e),ha(nt+"Capture",_e)}function ha(nt,_e){for(ea[nt]=_e,nt=0;nt<_e.length;nt++)da.add(_e[nt])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(nt){return ja.call(ma,nt)?!0:ja.call(la,nt)?!1:ka.test(nt)?ma[nt]=!0:(la[nt]=!0,!1)}function pa(nt,_e,et,rt){if(et!==null&&et.type===0)return!1;switch(typeof _e){case"function":case"symbol":return!0;case"boolean":return rt?!1:et!==null?!et.acceptsBooleans:(nt=nt.toLowerCase().slice(0,5),nt!=="data-"&&nt!=="aria-");default:return!1}}function qa(nt,_e,et,rt){if(_e===null||typeof _e>"u"||pa(nt,_e,et,rt))return!0;if(rt)return!1;if(et!==null)switch(et.type){case 3:return!_e;case 4:return _e===!1;case 5:return isNaN(_e);case 6:return isNaN(_e)||1>_e}return!1}function v$4(nt,_e,et,rt,it,st,ot){this.acceptsBooleans=_e===2||_e===3||_e===4,this.attributeName=rt,this.attributeNamespace=it,this.mustUseProperty=et,this.propertyName=nt,this.type=_e,this.sanitizeURL=st,this.removeEmptyString=ot}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(nt){z$2[nt]=new v$4(nt,0,!1,nt,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(nt){var _e=nt[0];z$2[_e]=new v$4(_e,1,!1,nt[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(nt){z$2[nt]=new v$4(nt,2,!1,nt.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(nt){z$2[nt]=new v$4(nt,2,!1,nt,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(nt){z$2[nt]=new v$4(nt,3,!1,nt.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(nt){z$2[nt]=new v$4(nt,3,!0,nt,null,!1,!1)});["capture","download"].forEach(function(nt){z$2[nt]=new v$4(nt,4,!1,nt,null,!1,!1)});["cols","rows","size","span"].forEach(function(nt){z$2[nt]=new v$4(nt,6,!1,nt,null,!1,!1)});["rowSpan","start"].forEach(function(nt){z$2[nt]=new v$4(nt,5,!1,nt.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(nt){return nt[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(nt){var _e=nt.replace(ra,sa);z$2[_e]=new v$4(_e,1,!1,nt,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(nt){var _e=nt.replace(ra,sa);z$2[_e]=new v$4(_e,1,!1,nt,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(nt){var _e=nt.replace(ra,sa);z$2[_e]=new v$4(_e,1,!1,nt,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(nt){z$2[nt]=new v$4(nt,1,!1,nt.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$4("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(nt){z$2[nt]=new v$4(nt,1,!1,nt.toLowerCase(),null,!0,!0)});function ta(nt,_e,et,rt){var it=z$2.hasOwnProperty(_e)?z$2[_e]:null;(it!==null?it.type!==0:rt||!(2<_e.length)||_e[0]!=="o"&&_e[0]!=="O"||_e[1]!=="n"&&_e[1]!=="N")&&(qa(_e,et,it,rt)&&(et=null),rt||it===null?oa(_e)&&(et===null?nt.removeAttribute(_e):nt.setAttribute(_e,""+et)):it.mustUseProperty?nt[it.propertyName]=et===null?it.type===3?!1:"":et:(_e=it.attributeName,rt=it.attributeNamespace,et===null?nt.removeAttribute(_e):(it=it.type,et=it===3||it===4&&et===!0?"":""+et,rt?nt.setAttributeNS(rt,_e,et):nt.setAttribute(_e,et))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(nt){return nt===null||typeof nt!="object"?null:(nt=Ja&&nt[Ja]||nt["@@iterator"],typeof nt=="function"?nt:null)}var A$1=Object.assign,La;function Ma(nt){if(La===void 0)try{throw Error()}catch(et){var _e=et.stack.trim().match(/\n( *(at )?)/);La=_e&&_e[1]||""}return`
`+La+nt}var Na=!1;function Oa(nt,_e){if(!nt||Na)return"";Na=!0;var et=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_e)if(_e=function(){throw Error()},Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ct){var rt=ct}Reflect.construct(nt,[],_e)}else{try{_e.call()}catch(ct){rt=ct}nt.call(_e.prototype)}else{try{throw Error()}catch(ct){rt=ct}nt()}}catch(ct){if(ct&&rt&&typeof ct.stack=="string"){for(var it=ct.stack.split(`
`),st=rt.stack.split(`
`),ot=it.length-1,at=st.length-1;1<=ot&&0<=at&&it[ot]!==st[at];)at--;for(;1<=ot&&0<=at;ot--,at--)if(it[ot]!==st[at]){if(ot!==1||at!==1)do if(ot--,at--,0>at||it[ot]!==st[at]){var lt=`
`+it[ot].replace(" at new "," at ");return nt.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",nt.displayName)),lt}while(1<=ot&&0<=at);break}}}finally{Na=!1,Error.prepareStackTrace=et}return(nt=nt?nt.displayName||nt.name:"")?Ma(nt):""}function Pa(nt){switch(nt.tag){case 5:return Ma(nt.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return nt=Oa(nt.type,!1),nt;case 11:return nt=Oa(nt.type.render,!1),nt;case 1:return nt=Oa(nt.type,!0),nt;default:return""}}function Qa(nt){if(nt==null)return null;if(typeof nt=="function")return nt.displayName||nt.name||null;if(typeof nt=="string")return nt;switch(nt){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof nt=="object")switch(nt.$$typeof){case Ca:return(nt.displayName||"Context")+".Consumer";case Ba:return(nt._context.displayName||"Context")+".Provider";case Da:var _e=nt.render;return nt=nt.displayName,nt||(nt=_e.displayName||_e.name||"",nt=nt!==""?"ForwardRef("+nt+")":"ForwardRef"),nt;case Ga:return _e=nt.displayName||null,_e!==null?_e:Qa(nt.type)||"Memo";case Ha:_e=nt._payload,nt=nt._init;try{return Qa(nt(_e))}catch{}}return null}function Ra(nt){var _e=nt.type;switch(nt.tag){case 24:return"Cache";case 9:return(_e.displayName||"Context")+".Consumer";case 10:return(_e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return nt=_e.render,nt=nt.displayName||nt.name||"",_e.displayName||(nt!==""?"ForwardRef("+nt+")":"ForwardRef");case 7:return"Fragment";case 5:return _e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(_e);case 8:return _e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _e=="function")return _e.displayName||_e.name||null;if(typeof _e=="string")return _e}return null}function Sa(nt){switch(typeof nt){case"boolean":case"number":case"string":case"undefined":return nt;case"object":return nt;default:return""}}function Ta(nt){var _e=nt.type;return(nt=nt.nodeName)&&nt.toLowerCase()==="input"&&(_e==="checkbox"||_e==="radio")}function Ua(nt){var _e=Ta(nt)?"checked":"value",et=Object.getOwnPropertyDescriptor(nt.constructor.prototype,_e),rt=""+nt[_e];if(!nt.hasOwnProperty(_e)&&typeof et<"u"&&typeof et.get=="function"&&typeof et.set=="function"){var it=et.get,st=et.set;return Object.defineProperty(nt,_e,{configurable:!0,get:function(){return it.call(this)},set:function(ot){rt=""+ot,st.call(this,ot)}}),Object.defineProperty(nt,_e,{enumerable:et.enumerable}),{getValue:function(){return rt},setValue:function(ot){rt=""+ot},stopTracking:function(){nt._valueTracker=null,delete nt[_e]}}}}function Va(nt){nt._valueTracker||(nt._valueTracker=Ua(nt))}function Wa(nt){if(!nt)return!1;var _e=nt._valueTracker;if(!_e)return!0;var et=_e.getValue(),rt="";return nt&&(rt=Ta(nt)?nt.checked?"true":"false":nt.value),nt=rt,nt!==et?(_e.setValue(nt),!0):!1}function Xa(nt){if(nt=nt||(typeof document<"u"?document:void 0),typeof nt>"u")return null;try{return nt.activeElement||nt.body}catch{return nt.body}}function Ya(nt,_e){var et=_e.checked;return A$1({},_e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:et??nt._wrapperState.initialChecked})}function Za(nt,_e){var et=_e.defaultValue==null?"":_e.defaultValue,rt=_e.checked!=null?_e.checked:_e.defaultChecked;et=Sa(_e.value!=null?_e.value:et),nt._wrapperState={initialChecked:rt,initialValue:et,controlled:_e.type==="checkbox"||_e.type==="radio"?_e.checked!=null:_e.value!=null}}function ab(nt,_e){_e=_e.checked,_e!=null&&ta(nt,"checked",_e,!1)}function bb(nt,_e){ab(nt,_e);var et=Sa(_e.value),rt=_e.type;if(et!=null)rt==="number"?(et===0&&nt.value===""||nt.value!=et)&&(nt.value=""+et):nt.value!==""+et&&(nt.value=""+et);else if(rt==="submit"||rt==="reset"){nt.removeAttribute("value");return}_e.hasOwnProperty("value")?cb(nt,_e.type,et):_e.hasOwnProperty("defaultValue")&&cb(nt,_e.type,Sa(_e.defaultValue)),_e.checked==null&&_e.defaultChecked!=null&&(nt.defaultChecked=!!_e.defaultChecked)}function db(nt,_e,et){if(_e.hasOwnProperty("value")||_e.hasOwnProperty("defaultValue")){var rt=_e.type;if(!(rt!=="submit"&&rt!=="reset"||_e.value!==void 0&&_e.value!==null))return;_e=""+nt._wrapperState.initialValue,et||_e===nt.value||(nt.value=_e),nt.defaultValue=_e}et=nt.name,et!==""&&(nt.name=""),nt.defaultChecked=!!nt._wrapperState.initialChecked,et!==""&&(nt.name=et)}function cb(nt,_e,et){(_e!=="number"||Xa(nt.ownerDocument)!==nt)&&(et==null?nt.defaultValue=""+nt._wrapperState.initialValue:nt.defaultValue!==""+et&&(nt.defaultValue=""+et))}var eb=Array.isArray;function fb(nt,_e,et,rt){if(nt=nt.options,_e){_e={};for(var it=0;it<et.length;it++)_e["$"+et[it]]=!0;for(et=0;et<nt.length;et++)it=_e.hasOwnProperty("$"+nt[et].value),nt[et].selected!==it&&(nt[et].selected=it),it&&rt&&(nt[et].defaultSelected=!0)}else{for(et=""+Sa(et),_e=null,it=0;it<nt.length;it++){if(nt[it].value===et){nt[it].selected=!0,rt&&(nt[it].defaultSelected=!0);return}_e!==null||nt[it].disabled||(_e=nt[it])}_e!==null&&(_e.selected=!0)}}function gb(nt,_e){if(_e.dangerouslySetInnerHTML!=null)throw Error(p$4(91));return A$1({},_e,{value:void 0,defaultValue:void 0,children:""+nt._wrapperState.initialValue})}function hb(nt,_e){var et=_e.value;if(et==null){if(et=_e.children,_e=_e.defaultValue,et!=null){if(_e!=null)throw Error(p$4(92));if(eb(et)){if(1<et.length)throw Error(p$4(93));et=et[0]}_e=et}_e==null&&(_e=""),et=_e}nt._wrapperState={initialValue:Sa(et)}}function ib(nt,_e){var et=Sa(_e.value),rt=Sa(_e.defaultValue);et!=null&&(et=""+et,et!==nt.value&&(nt.value=et),_e.defaultValue==null&&nt.defaultValue!==et&&(nt.defaultValue=et)),rt!=null&&(nt.defaultValue=""+rt)}function jb(nt){var _e=nt.textContent;_e===nt._wrapperState.initialValue&&_e!==""&&_e!==null&&(nt.value=_e)}function kb(nt){switch(nt){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(nt,_e){return nt==null||nt==="http://www.w3.org/1999/xhtml"?kb(_e):nt==="http://www.w3.org/2000/svg"&&_e==="foreignObject"?"http://www.w3.org/1999/xhtml":nt}var mb,nb=function(nt){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_e,et,rt,it){MSApp.execUnsafeLocalFunction(function(){return nt(_e,et,rt,it)})}:nt}(function(nt,_e){if(nt.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in nt)nt.innerHTML=_e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+_e.valueOf().toString()+"</svg>",_e=mb.firstChild;nt.firstChild;)nt.removeChild(nt.firstChild);for(;_e.firstChild;)nt.appendChild(_e.firstChild)}});function ob(nt,_e){if(_e){var et=nt.firstChild;if(et&&et===nt.lastChild&&et.nodeType===3){et.nodeValue=_e;return}}nt.textContent=_e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(nt){qb.forEach(function(_e){_e=_e+nt.charAt(0).toUpperCase()+nt.substring(1),pb[_e]=pb[nt]})});function rb(nt,_e,et){return _e==null||typeof _e=="boolean"||_e===""?"":et||typeof _e!="number"||_e===0||pb.hasOwnProperty(nt)&&pb[nt]?(""+_e).trim():_e+"px"}function sb(nt,_e){nt=nt.style;for(var et in _e)if(_e.hasOwnProperty(et)){var rt=et.indexOf("--")===0,it=rb(et,_e[et],rt);et==="float"&&(et="cssFloat"),rt?nt.setProperty(et,it):nt[et]=it}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(nt,_e){if(_e){if(tb[nt]&&(_e.children!=null||_e.dangerouslySetInnerHTML!=null))throw Error(p$4(137,nt));if(_e.dangerouslySetInnerHTML!=null){if(_e.children!=null)throw Error(p$4(60));if(typeof _e.dangerouslySetInnerHTML!="object"||!("__html"in _e.dangerouslySetInnerHTML))throw Error(p$4(61))}if(_e.style!=null&&typeof _e.style!="object")throw Error(p$4(62))}}function vb(nt,_e){if(nt.indexOf("-")===-1)return typeof _e.is=="string";switch(nt){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(nt){return nt=nt.target||nt.srcElement||window,nt.correspondingUseElement&&(nt=nt.correspondingUseElement),nt.nodeType===3?nt.parentNode:nt}var yb=null,zb=null,Ab=null;function Bb(nt){if(nt=Cb(nt)){if(typeof yb!="function")throw Error(p$4(280));var _e=nt.stateNode;_e&&(_e=Db(_e),yb(nt.stateNode,nt.type,_e))}}function Eb(nt){zb?Ab?Ab.push(nt):Ab=[nt]:zb=nt}function Fb(){if(zb){var nt=zb,_e=Ab;if(Ab=zb=null,Bb(nt),_e)for(nt=0;nt<_e.length;nt++)Bb(_e[nt])}}function Gb(nt,_e){return nt(_e)}function Hb(){}var Ib=!1;function Jb(nt,_e,et){if(Ib)return nt(_e,et);Ib=!0;try{return Gb(nt,_e,et)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(nt,_e){var et=nt.stateNode;if(et===null)return null;var rt=Db(et);if(rt===null)return null;et=rt[_e];e:switch(_e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(rt=!rt.disabled)||(nt=nt.type,rt=!(nt==="button"||nt==="input"||nt==="select"||nt==="textarea")),nt=!rt;break e;default:nt=!1}if(nt)return null;if(et&&typeof et!="function")throw Error(p$4(231,_e,typeof et));return et}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(nt,_e,et,rt,it,st,ot,at,lt){var ct=Array.prototype.slice.call(arguments,3);try{_e.apply(et,ct)}catch(ut){this.onError(ut)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(nt){Ob=!0,Pb=nt}};function Tb(nt,_e,et,rt,it,st,ot,at,lt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(nt,_e,et,rt,it,st,ot,at,lt){if(Tb.apply(this,arguments),Ob){if(Ob){var ct=Pb;Ob=!1,Pb=null}else throw Error(p$4(198));Qb||(Qb=!0,Rb=ct)}}function Vb(nt){var _e=nt,et=nt;if(nt.alternate)for(;_e.return;)_e=_e.return;else{nt=_e;do _e=nt,_e.flags&4098&&(et=_e.return),nt=_e.return;while(nt)}return _e.tag===3?et:null}function Wb(nt){if(nt.tag===13){var _e=nt.memoizedState;if(_e===null&&(nt=nt.alternate,nt!==null&&(_e=nt.memoizedState)),_e!==null)return _e.dehydrated}return null}function Xb(nt){if(Vb(nt)!==nt)throw Error(p$4(188))}function Yb(nt){var _e=nt.alternate;if(!_e){if(_e=Vb(nt),_e===null)throw Error(p$4(188));return _e!==nt?null:nt}for(var et=nt,rt=_e;;){var it=et.return;if(it===null)break;var st=it.alternate;if(st===null){if(rt=it.return,rt!==null){et=rt;continue}break}if(it.child===st.child){for(st=it.child;st;){if(st===et)return Xb(it),nt;if(st===rt)return Xb(it),_e;st=st.sibling}throw Error(p$4(188))}if(et.return!==rt.return)et=it,rt=st;else{for(var ot=!1,at=it.child;at;){if(at===et){ot=!0,et=it,rt=st;break}if(at===rt){ot=!0,rt=it,et=st;break}at=at.sibling}if(!ot){for(at=st.child;at;){if(at===et){ot=!0,et=st,rt=it;break}if(at===rt){ot=!0,rt=st,et=it;break}at=at.sibling}if(!ot)throw Error(p$4(189))}}if(et.alternate!==rt)throw Error(p$4(190))}if(et.tag!==3)throw Error(p$4(188));return et.stateNode.current===et?nt:_e}function Zb(nt){return nt=Yb(nt),nt!==null?$b(nt):null}function $b(nt){if(nt.tag===5||nt.tag===6)return nt;for(nt=nt.child;nt!==null;){var _e=$b(nt);if(_e!==null)return _e;nt=nt.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$2=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(nt){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,nt,void 0,(nt.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(nt){return nt>>>=0,nt===0?32:31-(pc(nt)/qc|0)|0}var rc=64,sc=4194304;function tc(nt){switch(nt&-nt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return nt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return nt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return nt}}function uc(nt,_e){var et=nt.pendingLanes;if(et===0)return 0;var rt=0,it=nt.suspendedLanes,st=nt.pingedLanes,ot=et&268435455;if(ot!==0){var at=ot&~it;at!==0?rt=tc(at):(st&=ot,st!==0&&(rt=tc(st)))}else ot=et&~it,ot!==0?rt=tc(ot):st!==0&&(rt=tc(st));if(rt===0)return 0;if(_e!==0&&_e!==rt&&!(_e&it)&&(it=rt&-rt,st=_e&-_e,it>=st||it===16&&(st&4194240)!==0))return _e;if(rt&4&&(rt|=et&16),_e=nt.entangledLanes,_e!==0)for(nt=nt.entanglements,_e&=rt;0<_e;)et=31-oc(_e),it=1<<et,rt|=nt[et],_e&=~it;return rt}function vc(nt,_e){switch(nt){case 1:case 2:case 4:return _e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(nt,_e){for(var et=nt.suspendedLanes,rt=nt.pingedLanes,it=nt.expirationTimes,st=nt.pendingLanes;0<st;){var ot=31-oc(st),at=1<<ot,lt=it[ot];lt===-1?(!(at&et)||at&rt)&&(it[ot]=vc(at,_e)):lt<=_e&&(nt.expiredLanes|=at),st&=~at}}function xc(nt){return nt=nt.pendingLanes&-1073741825,nt!==0?nt:nt&1073741824?1073741824:0}function yc(){var nt=rc;return rc<<=1,!(rc&4194240)&&(rc=64),nt}function zc(nt){for(var _e=[],et=0;31>et;et++)_e.push(nt);return _e}function Ac(nt,_e,et){nt.pendingLanes|=_e,_e!==536870912&&(nt.suspendedLanes=0,nt.pingedLanes=0),nt=nt.eventTimes,_e=31-oc(_e),nt[_e]=et}function Bc(nt,_e){var et=nt.pendingLanes&~_e;nt.pendingLanes=_e,nt.suspendedLanes=0,nt.pingedLanes=0,nt.expiredLanes&=_e,nt.mutableReadLanes&=_e,nt.entangledLanes&=_e,_e=nt.entanglements;var rt=nt.eventTimes;for(nt=nt.expirationTimes;0<et;){var it=31-oc(et),st=1<<it;_e[it]=0,rt[it]=-1,nt[it]=-1,et&=~st}}function Cc(nt,_e){var et=nt.entangledLanes|=_e;for(nt=nt.entanglements;et;){var rt=31-oc(et),it=1<<rt;it&_e|nt[rt]&_e&&(nt[rt]|=_e),et&=~it}}var C$1=0;function Dc(nt){return nt&=-nt,1<nt?4<nt?nt&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(nt,_e){switch(nt){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(_e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(_e.pointerId)}}function Tc(nt,_e,et,rt,it,st){return nt===null||nt.nativeEvent!==st?(nt={blockedOn:_e,domEventName:et,eventSystemFlags:rt,nativeEvent:st,targetContainers:[it]},_e!==null&&(_e=Cb(_e),_e!==null&&Fc(_e)),nt):(nt.eventSystemFlags|=rt,_e=nt.targetContainers,it!==null&&_e.indexOf(it)===-1&&_e.push(it),nt)}function Uc(nt,_e,et,rt,it){switch(_e){case"focusin":return Lc=Tc(Lc,nt,_e,et,rt,it),!0;case"dragenter":return Mc=Tc(Mc,nt,_e,et,rt,it),!0;case"mouseover":return Nc=Tc(Nc,nt,_e,et,rt,it),!0;case"pointerover":var st=it.pointerId;return Oc.set(st,Tc(Oc.get(st)||null,nt,_e,et,rt,it)),!0;case"gotpointercapture":return st=it.pointerId,Pc.set(st,Tc(Pc.get(st)||null,nt,_e,et,rt,it)),!0}return!1}function Vc(nt){var _e=Wc(nt.target);if(_e!==null){var et=Vb(_e);if(et!==null){if(_e=et.tag,_e===13){if(_e=Wb(et),_e!==null){nt.blockedOn=_e,Ic(nt.priority,function(){Gc(et)});return}}else if(_e===3&&et.stateNode.current.memoizedState.isDehydrated){nt.blockedOn=et.tag===3?et.stateNode.containerInfo:null;return}}}nt.blockedOn=null}function Xc(nt){if(nt.blockedOn!==null)return!1;for(var _e=nt.targetContainers;0<_e.length;){var et=Yc(nt.domEventName,nt.eventSystemFlags,_e[0],nt.nativeEvent);if(et===null){et=nt.nativeEvent;var rt=new et.constructor(et.type,et);wb=rt,et.target.dispatchEvent(rt),wb=null}else return _e=Cb(et),_e!==null&&Fc(_e),nt.blockedOn=et,!1;_e.shift()}return!0}function Zc(nt,_e,et){Xc(nt)&&et.delete(_e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(nt,_e){nt.blockedOn===_e&&(nt.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(nt){function _e(it){return ad(it,nt)}if(0<Kc.length){ad(Kc[0],nt);for(var et=1;et<Kc.length;et++){var rt=Kc[et];rt.blockedOn===nt&&(rt.blockedOn=null)}}for(Lc!==null&&ad(Lc,nt),Mc!==null&&ad(Mc,nt),Nc!==null&&ad(Nc,nt),Oc.forEach(_e),Pc.forEach(_e),et=0;et<Qc.length;et++)rt=Qc[et],rt.blockedOn===nt&&(rt.blockedOn=null);for(;0<Qc.length&&(et=Qc[0],et.blockedOn===null);)Vc(et),et.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(nt,_e,et,rt){var it=C$1,st=cd.transition;cd.transition=null;try{C$1=1,fd(nt,_e,et,rt)}finally{C$1=it,cd.transition=st}}function gd(nt,_e,et,rt){var it=C$1,st=cd.transition;cd.transition=null;try{C$1=4,fd(nt,_e,et,rt)}finally{C$1=it,cd.transition=st}}function fd(nt,_e,et,rt){if(dd){var it=Yc(nt,_e,et,rt);if(it===null)hd(nt,_e,rt,id$3,et),Sc(nt,rt);else if(Uc(it,nt,_e,et,rt))rt.stopPropagation();else if(Sc(nt,rt),_e&4&&-1<Rc.indexOf(nt)){for(;it!==null;){var st=Cb(it);if(st!==null&&Ec(st),st=Yc(nt,_e,et,rt),st===null&&hd(nt,_e,rt,id$3,et),st===it)break;it=st}it!==null&&rt.stopPropagation()}else hd(nt,_e,rt,null,et)}}var id$3=null;function Yc(nt,_e,et,rt){if(id$3=null,nt=xb(rt),nt=Wc(nt),nt!==null)if(_e=Vb(nt),_e===null)nt=null;else if(et=_e.tag,et===13){if(nt=Wb(_e),nt!==null)return nt;nt=null}else if(et===3){if(_e.stateNode.current.memoizedState.isDehydrated)return _e.tag===3?_e.stateNode.containerInfo:null;nt=null}else _e!==nt&&(nt=null);return id$3=nt,null}function jd(nt){switch(nt){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var nt,_e=ld,et=_e.length,rt,it="value"in kd?kd.value:kd.textContent,st=it.length;for(nt=0;nt<et&&_e[nt]===it[nt];nt++);var ot=et-nt;for(rt=1;rt<=ot&&_e[et-rt]===it[st-rt];rt++);return md=it.slice(nt,1<rt?1-rt:void 0)}function od(nt){var _e=nt.keyCode;return"charCode"in nt?(nt=nt.charCode,nt===0&&_e===13&&(nt=13)):nt=_e,nt===10&&(nt=13),32<=nt||nt===13?nt:0}function pd(){return!0}function qd(){return!1}function rd(nt){function _e(et,rt,it,st,ot){this._reactName=et,this._targetInst=it,this.type=rt,this.nativeEvent=st,this.target=ot,this.currentTarget=null;for(var at in nt)nt.hasOwnProperty(at)&&(et=nt[at],this[at]=et?et(st):st[at]);return this.isDefaultPrevented=(st.defaultPrevented!=null?st.defaultPrevented:st.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(_e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var et=this.nativeEvent;et&&(et.preventDefault?et.preventDefault():typeof et.returnValue!="unknown"&&(et.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var et=this.nativeEvent;et&&(et.stopPropagation?et.stopPropagation():typeof et.cancelBubble!="unknown"&&(et.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(nt){return nt.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(nt){return nt.relatedTarget===void 0?nt.fromElement===nt.srcElement?nt.toElement:nt.fromElement:nt.relatedTarget},movementX:function(nt){return"movementX"in nt?nt.movementX:(nt!==yd&&(yd&&nt.type==="mousemove"?(wd=nt.screenX-yd.screenX,xd=nt.screenY-yd.screenY):xd=wd=0,yd=nt),wd)},movementY:function(nt){return"movementY"in nt?nt.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(nt){return"clipboardData"in nt?nt.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(nt){var _e=this.nativeEvent;return _e.getModifierState?_e.getModifierState(nt):(nt=Od[nt])?!!_e[nt]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(nt){if(nt.key){var _e=Md[nt.key]||nt.key;if(_e!=="Unidentified")return _e}return nt.type==="keypress"?(nt=od(nt),nt===13?"Enter":String.fromCharCode(nt)):nt.type==="keydown"||nt.type==="keyup"?Nd[nt.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(nt){return nt.type==="keypress"?od(nt):0},keyCode:function(nt){return nt.type==="keydown"||nt.type==="keyup"?nt.keyCode:0},which:function(nt){return nt.type==="keypress"?od(nt):nt.type==="keydown"||nt.type==="keyup"?nt.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(nt){return"deltaX"in nt?nt.deltaX:"wheelDeltaX"in nt?-nt.wheelDeltaX:0},deltaY:function(nt){return"deltaY"in nt?nt.deltaY:"wheelDeltaY"in nt?-nt.wheelDeltaY:"wheelDelta"in nt?-nt.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee$1=" ",fe=!1;function ge(nt,_e){switch(nt){case"keyup":return $d.indexOf(_e.keyCode)!==-1;case"keydown":return _e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(nt){return nt=nt.detail,typeof nt=="object"&&"data"in nt?nt.data:null}var ie=!1;function je(nt,_e){switch(nt){case"compositionend":return he(_e);case"keypress":return _e.which!==32?null:(fe=!0,ee$1);case"textInput":return nt=_e.data,nt===ee$1&&fe?null:nt;default:return null}}function ke(nt,_e){if(ie)return nt==="compositionend"||!ae&&ge(nt,_e)?(nt=nd(),md=ld=kd=null,ie=!1,nt):null;switch(nt){case"paste":return null;case"keypress":if(!(_e.ctrlKey||_e.altKey||_e.metaKey)||_e.ctrlKey&&_e.altKey){if(_e.char&&1<_e.char.length)return _e.char;if(_e.which)return String.fromCharCode(_e.which)}return null;case"compositionend":return de&&_e.locale!=="ko"?null:_e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(nt){var _e=nt&&nt.nodeName&&nt.nodeName.toLowerCase();return _e==="input"?!!le[nt.type]:_e==="textarea"}function ne(nt,_e,et,rt){Eb(rt),_e=oe(_e,"onChange"),0<_e.length&&(et=new td("onChange","change",null,et,rt),nt.push({event:et,listeners:_e}))}var pe=null,qe=null;function re$2(nt){se(nt,0)}function te(nt){var _e=ue(nt);if(Wa(_e))return nt}function ve(nt,_e){if(nt==="change")return _e}var we=!1;if(ia){var xe$1;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe$1=ye}else xe$1=!1;we=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(nt){if(nt.propertyName==="value"&&te(qe)){var _e=[];ne(_e,qe,nt,xb(nt)),Jb(re$2,_e)}}function Ce$1(nt,_e,et){nt==="focusin"?(Ae(),pe=_e,qe=et,pe.attachEvent("onpropertychange",Be)):nt==="focusout"&&Ae()}function De(nt){if(nt==="selectionchange"||nt==="keyup"||nt==="keydown")return te(qe)}function Ee(nt,_e){if(nt==="click")return te(_e)}function Fe(nt,_e){if(nt==="input"||nt==="change")return te(_e)}function Ge(nt,_e){return nt===_e&&(nt!==0||1/nt===1/_e)||nt!==nt&&_e!==_e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(nt,_e){if(He(nt,_e))return!0;if(typeof nt!="object"||nt===null||typeof _e!="object"||_e===null)return!1;var et=Object.keys(nt),rt=Object.keys(_e);if(et.length!==rt.length)return!1;for(rt=0;rt<et.length;rt++){var it=et[rt];if(!ja.call(_e,it)||!He(nt[it],_e[it]))return!1}return!0}function Je(nt){for(;nt&&nt.firstChild;)nt=nt.firstChild;return nt}function Ke(nt,_e){var et=Je(nt);nt=0;for(var rt;et;){if(et.nodeType===3){if(rt=nt+et.textContent.length,nt<=_e&&rt>=_e)return{node:et,offset:_e-nt};nt=rt}e:{for(;et;){if(et.nextSibling){et=et.nextSibling;break e}et=et.parentNode}et=void 0}et=Je(et)}}function Le(nt,_e){return nt&&_e?nt===_e?!0:nt&&nt.nodeType===3?!1:_e&&_e.nodeType===3?Le(nt,_e.parentNode):"contains"in nt?nt.contains(_e):nt.compareDocumentPosition?!!(nt.compareDocumentPosition(_e)&16):!1:!1}function Me$1(){for(var nt=window,_e=Xa();_e instanceof nt.HTMLIFrameElement;){try{var et=typeof _e.contentWindow.location.href=="string"}catch{et=!1}if(et)nt=_e.contentWindow;else break;_e=Xa(nt.document)}return _e}function Ne$1(nt){var _e=nt&&nt.nodeName&&nt.nodeName.toLowerCase();return _e&&(_e==="input"&&(nt.type==="text"||nt.type==="search"||nt.type==="tel"||nt.type==="url"||nt.type==="password")||_e==="textarea"||nt.contentEditable==="true")}function Oe(nt){var _e=Me$1(),et=nt.focusedElem,rt=nt.selectionRange;if(_e!==et&&et&&et.ownerDocument&&Le(et.ownerDocument.documentElement,et)){if(rt!==null&&Ne$1(et)){if(_e=rt.start,nt=rt.end,nt===void 0&&(nt=_e),"selectionStart"in et)et.selectionStart=_e,et.selectionEnd=Math.min(nt,et.value.length);else if(nt=(_e=et.ownerDocument||document)&&_e.defaultView||window,nt.getSelection){nt=nt.getSelection();var it=et.textContent.length,st=Math.min(rt.start,it);rt=rt.end===void 0?st:Math.min(rt.end,it),!nt.extend&&st>rt&&(it=rt,rt=st,st=it),it=Ke(et,st);var ot=Ke(et,rt);it&&ot&&(nt.rangeCount!==1||nt.anchorNode!==it.node||nt.anchorOffset!==it.offset||nt.focusNode!==ot.node||nt.focusOffset!==ot.offset)&&(_e=_e.createRange(),_e.setStart(it.node,it.offset),nt.removeAllRanges(),st>rt?(nt.addRange(_e),nt.extend(ot.node,ot.offset)):(_e.setEnd(ot.node,ot.offset),nt.addRange(_e)))}}for(_e=[],nt=et;nt=nt.parentNode;)nt.nodeType===1&&_e.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof et.focus=="function"&&et.focus(),et=0;et<_e.length;et++)nt=_e[et],nt.element.scrollLeft=nt.left,nt.element.scrollTop=nt.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(nt,_e,et){var rt=et.window===et?et.document:et.nodeType===9?et:et.ownerDocument;Te||Qe==null||Qe!==Xa(rt)||(rt=Qe,"selectionStart"in rt&&Ne$1(rt)?rt={start:rt.selectionStart,end:rt.selectionEnd}:(rt=(rt.ownerDocument&&rt.ownerDocument.defaultView||window).getSelection(),rt={anchorNode:rt.anchorNode,anchorOffset:rt.anchorOffset,focusNode:rt.focusNode,focusOffset:rt.focusOffset}),Se&&Ie(Se,rt)||(Se=rt,rt=oe(Re,"onSelect"),0<rt.length&&(_e=new td("onSelect","select",null,_e,et),nt.push({event:_e,listeners:rt}),_e.target=Qe)))}function Ve(nt,_e){var et={};return et[nt.toLowerCase()]=_e.toLowerCase(),et["Webkit"+nt]="webkit"+_e,et["Moz"+nt]="moz"+_e,et}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(nt){if(Xe[nt])return Xe[nt];if(!We[nt])return nt;var _e=We[nt],et;for(et in _e)if(_e.hasOwnProperty(et)&&et in Ye)return Xe[nt]=_e[et];return nt}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(nt,_e){df.set(nt,_e),fa(_e,[nt])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(nt,_e,et){var rt=nt.type||"unknown-event";nt.currentTarget=et,Ub(rt,_e,void 0,nt),nt.currentTarget=null}function se(nt,_e){_e=(_e&4)!==0;for(var et=0;et<nt.length;et++){var rt=nt[et],it=rt.event;rt=rt.listeners;e:{var st=void 0;if(_e)for(var ot=rt.length-1;0<=ot;ot--){var at=rt[ot],lt=at.instance,ct=at.currentTarget;if(at=at.listener,lt!==st&&it.isPropagationStopped())break e;nf(it,at,ct),st=lt}else for(ot=0;ot<rt.length;ot++){if(at=rt[ot],lt=at.instance,ct=at.currentTarget,at=at.listener,lt!==st&&it.isPropagationStopped())break e;nf(it,at,ct),st=lt}}}if(Qb)throw nt=Rb,Qb=!1,Rb=null,nt}function D$2(nt,_e){var et=_e[of];et===void 0&&(et=_e[of]=new Set);var rt=nt+"__bubble";et.has(rt)||(pf(_e,nt,2,!1),et.add(rt))}function qf(nt,_e,et){var rt=0;_e&&(rt|=4),pf(et,nt,rt,_e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(nt){if(!nt[rf]){nt[rf]=!0,da.forEach(function(et){et!=="selectionchange"&&(mf.has(et)||qf(et,!1,nt),qf(et,!0,nt))});var _e=nt.nodeType===9?nt:nt.ownerDocument;_e===null||_e[rf]||(_e[rf]=!0,qf("selectionchange",!1,_e))}}function pf(nt,_e,et,rt){switch(jd(_e)){case 1:var it=ed;break;case 4:it=gd;break;default:it=fd}et=it.bind(null,_e,et,nt),it=void 0,!Lb||_e!=="touchstart"&&_e!=="touchmove"&&_e!=="wheel"||(it=!0),rt?it!==void 0?nt.addEventListener(_e,et,{capture:!0,passive:it}):nt.addEventListener(_e,et,!0):it!==void 0?nt.addEventListener(_e,et,{passive:it}):nt.addEventListener(_e,et,!1)}function hd(nt,_e,et,rt,it){var st=rt;if(!(_e&1)&&!(_e&2)&&rt!==null)e:for(;;){if(rt===null)return;var ot=rt.tag;if(ot===3||ot===4){var at=rt.stateNode.containerInfo;if(at===it||at.nodeType===8&&at.parentNode===it)break;if(ot===4)for(ot=rt.return;ot!==null;){var lt=ot.tag;if((lt===3||lt===4)&&(lt=ot.stateNode.containerInfo,lt===it||lt.nodeType===8&&lt.parentNode===it))return;ot=ot.return}for(;at!==null;){if(ot=Wc(at),ot===null)return;if(lt=ot.tag,lt===5||lt===6){rt=st=ot;continue e}at=at.parentNode}}rt=rt.return}Jb(function(){var ct=st,ut=xb(et),ht=[];e:{var dt=df.get(nt);if(dt!==void 0){var ft=td,pt=nt;switch(nt){case"keypress":if(od(et)===0)break e;case"keydown":case"keyup":ft=Rd;break;case"focusin":pt="focus",ft=Fd;break;case"focusout":pt="blur",ft=Fd;break;case"beforeblur":case"afterblur":ft=Fd;break;case"click":if(et.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=Vd;break;case $e:case af:case bf:ft=Hd;break;case cf:ft=Xd;break;case"scroll":ft=vd;break;case"wheel":ft=Zd;break;case"copy":case"cut":case"paste":ft=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Td}var mt=(_e&4)!==0,At=!mt&&nt==="scroll",gt=mt?dt!==null?dt+"Capture":null:dt;mt=[];for(var bt=ct,Tt;bt!==null;){Tt=bt;var wt=Tt.stateNode;if(Tt.tag===5&&wt!==null&&(Tt=wt,gt!==null&&(wt=Kb(bt,gt),wt!=null&&mt.push(tf(bt,wt,Tt)))),At)break;bt=bt.return}0<mt.length&&(dt=new ft(dt,pt,null,et,ut),ht.push({event:dt,listeners:mt}))}}if(!(_e&7)){e:{if(dt=nt==="mouseover"||nt==="pointerover",ft=nt==="mouseout"||nt==="pointerout",dt&&et!==wb&&(pt=et.relatedTarget||et.fromElement)&&(Wc(pt)||pt[uf]))break e;if((ft||dt)&&(dt=ut.window===ut?ut:(dt=ut.ownerDocument)?dt.defaultView||dt.parentWindow:window,ft?(pt=et.relatedTarget||et.toElement,ft=ct,pt=pt?Wc(pt):null,pt!==null&&(At=Vb(pt),pt!==At||pt.tag!==5&&pt.tag!==6)&&(pt=null)):(ft=null,pt=ct),ft!==pt)){if(mt=Bd,wt="onMouseLeave",gt="onMouseEnter",bt="mouse",(nt==="pointerout"||nt==="pointerover")&&(mt=Td,wt="onPointerLeave",gt="onPointerEnter",bt="pointer"),At=ft==null?dt:ue(ft),Tt=pt==null?dt:ue(pt),dt=new mt(wt,bt+"leave",ft,et,ut),dt.target=At,dt.relatedTarget=Tt,wt=null,Wc(ut)===ct&&(mt=new mt(gt,bt+"enter",pt,et,ut),mt.target=Tt,mt.relatedTarget=At,wt=mt),At=wt,ft&&pt)t:{for(mt=ft,gt=pt,bt=0,Tt=mt;Tt;Tt=vf(Tt))bt++;for(Tt=0,wt=gt;wt;wt=vf(wt))Tt++;for(;0<bt-Tt;)mt=vf(mt),bt--;for(;0<Tt-bt;)gt=vf(gt),Tt--;for(;bt--;){if(mt===gt||gt!==null&&mt===gt.alternate)break t;mt=vf(mt),gt=vf(gt)}mt=null}else mt=null;ft!==null&&wf(ht,dt,ft,mt,!1),pt!==null&&At!==null&&wf(ht,At,pt,mt,!0)}}e:{if(dt=ct?ue(ct):window,ft=dt.nodeName&&dt.nodeName.toLowerCase(),ft==="select"||ft==="input"&&dt.type==="file")var Rt=ve;else if(me(dt))if(we)Rt=Fe;else{Rt=De;var It=Ce$1}else(ft=dt.nodeName)&&ft.toLowerCase()==="input"&&(dt.type==="checkbox"||dt.type==="radio")&&(Rt=Ee);if(Rt&&(Rt=Rt(nt,ct))){ne(ht,Rt,et,ut);break e}It&&It(nt,dt,ct),nt==="focusout"&&(It=dt._wrapperState)&&It.controlled&&dt.type==="number"&&cb(dt,"number",dt.value)}switch(It=ct?ue(ct):window,nt){case"focusin":(me(It)||It.contentEditable==="true")&&(Qe=It,Re=ct,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ht,et,ut);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ht,et,ut)}var Lt;if(ae)e:{switch(nt){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else ie?ge(nt,et)&&($t="onCompositionEnd"):nt==="keydown"&&et.keyCode===229&&($t="onCompositionStart");$t&&(de&&et.locale!=="ko"&&(ie||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&ie&&(Lt=nd()):(kd=ut,ld="value"in kd?kd.value:kd.textContent,ie=!0)),It=oe(ct,$t),0<It.length&&($t=new Ld($t,nt,null,et,ut),ht.push({event:$t,listeners:It}),Lt?$t.data=Lt:(Lt=he(et),Lt!==null&&($t.data=Lt)))),(Lt=ce?je(nt,et):ke(nt,et))&&(ct=oe(ct,"onBeforeInput"),0<ct.length&&(ut=new Ld("onBeforeInput","beforeinput",null,et,ut),ht.push({event:ut,listeners:ct}),ut.data=Lt))}se(ht,_e)})}function tf(nt,_e,et){return{instance:nt,listener:_e,currentTarget:et}}function oe(nt,_e){for(var et=_e+"Capture",rt=[];nt!==null;){var it=nt,st=it.stateNode;it.tag===5&&st!==null&&(it=st,st=Kb(nt,et),st!=null&&rt.unshift(tf(nt,st,it)),st=Kb(nt,_e),st!=null&&rt.push(tf(nt,st,it))),nt=nt.return}return rt}function vf(nt){if(nt===null)return null;do nt=nt.return;while(nt&&nt.tag!==5);return nt||null}function wf(nt,_e,et,rt,it){for(var st=_e._reactName,ot=[];et!==null&&et!==rt;){var at=et,lt=at.alternate,ct=at.stateNode;if(lt!==null&&lt===rt)break;at.tag===5&&ct!==null&&(at=ct,it?(lt=Kb(et,st),lt!=null&&ot.unshift(tf(et,lt,at))):it||(lt=Kb(et,st),lt!=null&&ot.push(tf(et,lt,at)))),et=et.return}ot.length!==0&&nt.push({event:_e,listeners:ot})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(nt){return(typeof nt=="string"?nt:""+nt).replace(xf,`
`).replace(yf,"")}function Af(nt,_e,et){if(_e=zf(_e),zf(nt)!==_e&&et)throw Error(p$4(425))}function Bf(){}var Cf=null,Df=null;function Ef(nt,_e){return nt==="textarea"||nt==="noscript"||typeof _e.children=="string"||typeof _e.children=="number"||typeof _e.dangerouslySetInnerHTML=="object"&&_e.dangerouslySetInnerHTML!==null&&_e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(nt){return Hf.resolve(null).then(nt).catch(If$1)}:Ff;function If$1(nt){setTimeout(function(){throw nt})}function Kf(nt,_e){var et=_e,rt=0;do{var it=et.nextSibling;if(nt.removeChild(et),it&&it.nodeType===8)if(et=it.data,et==="/$"){if(rt===0){nt.removeChild(it),bd(_e);return}rt--}else et!=="$"&&et!=="$?"&&et!=="$!"||rt++;et=it}while(et);bd(_e)}function Lf(nt){for(;nt!=null;nt=nt.nextSibling){var _e=nt.nodeType;if(_e===1||_e===3)break;if(_e===8){if(_e=nt.data,_e==="$"||_e==="$!"||_e==="$?")break;if(_e==="/$")return null}}return nt}function Mf(nt){nt=nt.previousSibling;for(var _e=0;nt;){if(nt.nodeType===8){var et=nt.data;if(et==="$"||et==="$!"||et==="$?"){if(_e===0)return nt;_e--}else et==="/$"&&_e++}nt=nt.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(nt){var _e=nt[Of];if(_e)return _e;for(var et=nt.parentNode;et;){if(_e=et[uf]||et[Of]){if(et=_e.alternate,_e.child!==null||et!==null&&et.child!==null)for(nt=Mf(nt);nt!==null;){if(et=nt[Of])return et;nt=Mf(nt)}return _e}nt=et,et=nt.parentNode}return null}function Cb(nt){return nt=nt[Of]||nt[uf],!nt||nt.tag!==5&&nt.tag!==6&&nt.tag!==13&&nt.tag!==3?null:nt}function ue(nt){if(nt.tag===5||nt.tag===6)return nt.stateNode;throw Error(p$4(33))}function Db(nt){return nt[Pf]||null}var Sf=[],Tf=-1;function Uf(nt){return{current:nt}}function E$2(nt){0>Tf||(nt.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(nt,_e){Tf++,Sf[Tf]=nt.current,nt.current=_e}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(nt,_e){var et=nt.type.contextTypes;if(!et)return Vf;var rt=nt.stateNode;if(rt&&rt.__reactInternalMemoizedUnmaskedChildContext===_e)return rt.__reactInternalMemoizedMaskedChildContext;var it={},st;for(st in et)it[st]=_e[st];return rt&&(nt=nt.stateNode,nt.__reactInternalMemoizedUnmaskedChildContext=_e,nt.__reactInternalMemoizedMaskedChildContext=it),it}function Zf(nt){return nt=nt.childContextTypes,nt!=null}function $f(){E$2(Wf),E$2(H$2)}function ag(nt,_e,et){if(H$2.current!==Vf)throw Error(p$4(168));G$1(H$2,_e),G$1(Wf,et)}function bg(nt,_e,et){var rt=nt.stateNode;if(_e=_e.childContextTypes,typeof rt.getChildContext!="function")return et;rt=rt.getChildContext();for(var it in rt)if(!(it in _e))throw Error(p$4(108,Ra(nt)||"Unknown",it));return A$1({},et,rt)}function cg(nt){return nt=(nt=nt.stateNode)&&nt.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G$1(H$2,nt),G$1(Wf,Wf.current),!0}function dg(nt,_e,et){var rt=nt.stateNode;if(!rt)throw Error(p$4(169));et?(nt=bg(nt,_e,Xf),rt.__reactInternalMemoizedMergedChildContext=nt,E$2(Wf),E$2(H$2),G$1(H$2,nt)):E$2(Wf),G$1(Wf,et)}var eg=null,fg=!1,gg=!1;function hg(nt){eg===null?eg=[nt]:eg.push(nt)}function ig(nt){fg=!0,hg(nt)}function jg(){if(!gg&&eg!==null){gg=!0;var nt=0,_e=C$1;try{var et=eg;for(C$1=1;nt<et.length;nt++){var rt=et[nt];do rt=rt(!0);while(rt!==null)}eg=null,fg=!1}catch(it){throw eg!==null&&(eg=eg.slice(nt+1)),ac(fc,jg),it}finally{C$1=_e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(nt,_e){kg[lg++]=ng,kg[lg++]=mg,mg=nt,ng=_e}function ug(nt,_e,et){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=nt;var rt=rg;nt=sg;var it=32-oc(rt)-1;rt&=~(1<<it),et+=1;var st=32-oc(_e)+it;if(30<st){var ot=it-it%5;st=(rt&(1<<ot)-1).toString(32),rt>>=ot,it-=ot,rg=1<<32-oc(_e)+it|et<<it|rt,sg=st+nt}else rg=1<<st|et<<it|rt,sg=nt}function vg(nt){nt.return!==null&&(tg(nt,1),ug(nt,1,0))}function wg(nt){for(;nt===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;nt===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$4=!1,zg=null;function Ag(nt,_e){var et=Bg(5,null,null,0);et.elementType="DELETED",et.stateNode=_e,et.return=nt,_e=nt.deletions,_e===null?(nt.deletions=[et],nt.flags|=16):_e.push(et)}function Cg(nt,_e){switch(nt.tag){case 5:var et=nt.type;return _e=_e.nodeType!==1||et.toLowerCase()!==_e.nodeName.toLowerCase()?null:_e,_e!==null?(nt.stateNode=_e,xg=nt,yg=Lf(_e.firstChild),!0):!1;case 6:return _e=nt.pendingProps===""||_e.nodeType!==3?null:_e,_e!==null?(nt.stateNode=_e,xg=nt,yg=null,!0):!1;case 13:return _e=_e.nodeType!==8?null:_e,_e!==null?(et=qg!==null?{id:rg,overflow:sg}:null,nt.memoizedState={dehydrated:_e,treeContext:et,retryLane:1073741824},et=Bg(18,null,null,0),et.stateNode=_e,et.return=nt,nt.child=et,xg=nt,yg=null,!0):!1;default:return!1}}function Dg(nt){return(nt.mode&1)!==0&&(nt.flags&128)===0}function Eg(nt){if(I$4){var _e=yg;if(_e){var et=_e;if(!Cg(nt,_e)){if(Dg(nt))throw Error(p$4(418));_e=Lf(et.nextSibling);var rt=xg;_e&&Cg(nt,_e)?Ag(rt,et):(nt.flags=nt.flags&-4097|2,I$4=!1,xg=nt)}}else{if(Dg(nt))throw Error(p$4(418));nt.flags=nt.flags&-4097|2,I$4=!1,xg=nt}}}function Fg(nt){for(nt=nt.return;nt!==null&&nt.tag!==5&&nt.tag!==3&&nt.tag!==13;)nt=nt.return;xg=nt}function Gg(nt){if(nt!==xg)return!1;if(!I$4)return Fg(nt),I$4=!0,!1;var _e;if((_e=nt.tag!==3)&&!(_e=nt.tag!==5)&&(_e=nt.type,_e=_e!=="head"&&_e!=="body"&&!Ef(nt.type,nt.memoizedProps)),_e&&(_e=yg)){if(Dg(nt))throw Hg(),Error(p$4(418));for(;_e;)Ag(nt,_e),_e=Lf(_e.nextSibling)}if(Fg(nt),nt.tag===13){if(nt=nt.memoizedState,nt=nt!==null?nt.dehydrated:null,!nt)throw Error(p$4(317));e:{for(nt=nt.nextSibling,_e=0;nt;){if(nt.nodeType===8){var et=nt.data;if(et==="/$"){if(_e===0){yg=Lf(nt.nextSibling);break e}_e--}else et!=="$"&&et!=="$!"&&et!=="$?"||_e++}nt=nt.nextSibling}yg=null}}else yg=xg?Lf(nt.stateNode.nextSibling):null;return!0}function Hg(){for(var nt=yg;nt;)nt=Lf(nt.nextSibling)}function Ig(){yg=xg=null,I$4=!1}function Jg(nt){zg===null?zg=[nt]:zg.push(nt)}var Kg=ua.ReactCurrentBatchConfig;function Lg(nt,_e,et){if(nt=et.ref,nt!==null&&typeof nt!="function"&&typeof nt!="object"){if(et._owner){if(et=et._owner,et){if(et.tag!==1)throw Error(p$4(309));var rt=et.stateNode}if(!rt)throw Error(p$4(147,nt));var it=rt,st=""+nt;return _e!==null&&_e.ref!==null&&typeof _e.ref=="function"&&_e.ref._stringRef===st?_e.ref:(_e=function(ot){var at=it.refs;ot===null?delete at[st]:at[st]=ot},_e._stringRef=st,_e)}if(typeof nt!="string")throw Error(p$4(284));if(!et._owner)throw Error(p$4(290,nt))}return nt}function Mg(nt,_e){throw nt=Object.prototype.toString.call(_e),Error(p$4(31,nt==="[object Object]"?"object with keys {"+Object.keys(_e).join(", ")+"}":nt))}function Ng(nt){var _e=nt._init;return _e(nt._payload)}function Og(nt){function _e(gt,bt){if(nt){var Tt=gt.deletions;Tt===null?(gt.deletions=[bt],gt.flags|=16):Tt.push(bt)}}function et(gt,bt){if(!nt)return null;for(;bt!==null;)_e(gt,bt),bt=bt.sibling;return null}function rt(gt,bt){for(gt=new Map;bt!==null;)bt.key!==null?gt.set(bt.key,bt):gt.set(bt.index,bt),bt=bt.sibling;return gt}function it(gt,bt){return gt=Pg(gt,bt),gt.index=0,gt.sibling=null,gt}function st(gt,bt,Tt){return gt.index=Tt,nt?(Tt=gt.alternate,Tt!==null?(Tt=Tt.index,Tt<bt?(gt.flags|=2,bt):Tt):(gt.flags|=2,bt)):(gt.flags|=1048576,bt)}function ot(gt){return nt&&gt.alternate===null&&(gt.flags|=2),gt}function at(gt,bt,Tt,wt){return bt===null||bt.tag!==6?(bt=Qg(Tt,gt.mode,wt),bt.return=gt,bt):(bt=it(bt,Tt),bt.return=gt,bt)}function lt(gt,bt,Tt,wt){var Rt=Tt.type;return Rt===ya?ut(gt,bt,Tt.props.children,wt,Tt.key):bt!==null&&(bt.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===Ha&&Ng(Rt)===bt.type)?(wt=it(bt,Tt.props),wt.ref=Lg(gt,bt,Tt),wt.return=gt,wt):(wt=Rg(Tt.type,Tt.key,Tt.props,null,gt.mode,wt),wt.ref=Lg(gt,bt,Tt),wt.return=gt,wt)}function ct(gt,bt,Tt,wt){return bt===null||bt.tag!==4||bt.stateNode.containerInfo!==Tt.containerInfo||bt.stateNode.implementation!==Tt.implementation?(bt=Sg(Tt,gt.mode,wt),bt.return=gt,bt):(bt=it(bt,Tt.children||[]),bt.return=gt,bt)}function ut(gt,bt,Tt,wt,Rt){return bt===null||bt.tag!==7?(bt=Tg(Tt,gt.mode,wt,Rt),bt.return=gt,bt):(bt=it(bt,Tt),bt.return=gt,bt)}function ht(gt,bt,Tt){if(typeof bt=="string"&&bt!==""||typeof bt=="number")return bt=Qg(""+bt,gt.mode,Tt),bt.return=gt,bt;if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case va:return Tt=Rg(bt.type,bt.key,bt.props,null,gt.mode,Tt),Tt.ref=Lg(gt,null,bt),Tt.return=gt,Tt;case wa:return bt=Sg(bt,gt.mode,Tt),bt.return=gt,bt;case Ha:var wt=bt._init;return ht(gt,wt(bt._payload),Tt)}if(eb(bt)||Ka(bt))return bt=Tg(bt,gt.mode,Tt,null),bt.return=gt,bt;Mg(gt,bt)}return null}function dt(gt,bt,Tt,wt){var Rt=bt!==null?bt.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return Rt!==null?null:at(gt,bt,""+Tt,wt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case va:return Tt.key===Rt?lt(gt,bt,Tt,wt):null;case wa:return Tt.key===Rt?ct(gt,bt,Tt,wt):null;case Ha:return Rt=Tt._init,dt(gt,bt,Rt(Tt._payload),wt)}if(eb(Tt)||Ka(Tt))return Rt!==null?null:ut(gt,bt,Tt,wt,null);Mg(gt,Tt)}return null}function ft(gt,bt,Tt,wt,Rt){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return gt=gt.get(Tt)||null,at(bt,gt,""+wt,Rt);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case va:return gt=gt.get(wt.key===null?Tt:wt.key)||null,lt(bt,gt,wt,Rt);case wa:return gt=gt.get(wt.key===null?Tt:wt.key)||null,ct(bt,gt,wt,Rt);case Ha:var It=wt._init;return ft(gt,bt,Tt,It(wt._payload),Rt)}if(eb(wt)||Ka(wt))return gt=gt.get(Tt)||null,ut(bt,gt,wt,Rt,null);Mg(bt,wt)}return null}function pt(gt,bt,Tt,wt){for(var Rt=null,It=null,Lt=bt,$t=bt=0,kt=null;Lt!==null&&$t<Tt.length;$t++){Lt.index>$t?(kt=Lt,Lt=null):kt=Lt.sibling;var Dt=dt(gt,Lt,Tt[$t],wt);if(Dt===null){Lt===null&&(Lt=kt);break}nt&&Lt&&Dt.alternate===null&&_e(gt,Lt),bt=st(Dt,bt,$t),It===null?Rt=Dt:It.sibling=Dt,It=Dt,Lt=kt}if($t===Tt.length)return et(gt,Lt),I$4&&tg(gt,$t),Rt;if(Lt===null){for(;$t<Tt.length;$t++)Lt=ht(gt,Tt[$t],wt),Lt!==null&&(bt=st(Lt,bt,$t),It===null?Rt=Lt:It.sibling=Lt,It=Lt);return I$4&&tg(gt,$t),Rt}for(Lt=rt(gt,Lt);$t<Tt.length;$t++)kt=ft(Lt,gt,$t,Tt[$t],wt),kt!==null&&(nt&&kt.alternate!==null&&Lt.delete(kt.key===null?$t:kt.key),bt=st(kt,bt,$t),It===null?Rt=kt:It.sibling=kt,It=kt);return nt&&Lt.forEach(function(Ot){return _e(gt,Ot)}),I$4&&tg(gt,$t),Rt}function mt(gt,bt,Tt,wt){var Rt=Ka(Tt);if(typeof Rt!="function")throw Error(p$4(150));if(Tt=Rt.call(Tt),Tt==null)throw Error(p$4(151));for(var It=Rt=null,Lt=bt,$t=bt=0,kt=null,Dt=Tt.next();Lt!==null&&!Dt.done;$t++,Dt=Tt.next()){Lt.index>$t?(kt=Lt,Lt=null):kt=Lt.sibling;var Ot=dt(gt,Lt,Dt.value,wt);if(Ot===null){Lt===null&&(Lt=kt);break}nt&&Lt&&Ot.alternate===null&&_e(gt,Lt),bt=st(Ot,bt,$t),It===null?Rt=Ot:It.sibling=Ot,It=Ot,Lt=kt}if(Dt.done)return et(gt,Lt),I$4&&tg(gt,$t),Rt;if(Lt===null){for(;!Dt.done;$t++,Dt=Tt.next())Dt=ht(gt,Dt.value,wt),Dt!==null&&(bt=st(Dt,bt,$t),It===null?Rt=Dt:It.sibling=Dt,It=Dt);return I$4&&tg(gt,$t),Rt}for(Lt=rt(gt,Lt);!Dt.done;$t++,Dt=Tt.next())Dt=ft(Lt,gt,$t,Dt.value,wt),Dt!==null&&(nt&&Dt.alternate!==null&&Lt.delete(Dt.key===null?$t:Dt.key),bt=st(Dt,bt,$t),It===null?Rt=Dt:It.sibling=Dt,It=Dt);return nt&&Lt.forEach(function(zt){return _e(gt,zt)}),I$4&&tg(gt,$t),Rt}function At(gt,bt,Tt,wt){if(typeof Tt=="object"&&Tt!==null&&Tt.type===ya&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case va:e:{for(var Rt=Tt.key,It=bt;It!==null;){if(It.key===Rt){if(Rt=Tt.type,Rt===ya){if(It.tag===7){et(gt,It.sibling),bt=it(It,Tt.props.children),bt.return=gt,gt=bt;break e}}else if(It.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===Ha&&Ng(Rt)===It.type){et(gt,It.sibling),bt=it(It,Tt.props),bt.ref=Lg(gt,It,Tt),bt.return=gt,gt=bt;break e}et(gt,It);break}else _e(gt,It);It=It.sibling}Tt.type===ya?(bt=Tg(Tt.props.children,gt.mode,wt,Tt.key),bt.return=gt,gt=bt):(wt=Rg(Tt.type,Tt.key,Tt.props,null,gt.mode,wt),wt.ref=Lg(gt,bt,Tt),wt.return=gt,gt=wt)}return ot(gt);case wa:e:{for(It=Tt.key;bt!==null;){if(bt.key===It)if(bt.tag===4&&bt.stateNode.containerInfo===Tt.containerInfo&&bt.stateNode.implementation===Tt.implementation){et(gt,bt.sibling),bt=it(bt,Tt.children||[]),bt.return=gt,gt=bt;break e}else{et(gt,bt);break}else _e(gt,bt);bt=bt.sibling}bt=Sg(Tt,gt.mode,wt),bt.return=gt,gt=bt}return ot(gt);case Ha:return It=Tt._init,At(gt,bt,It(Tt._payload),wt)}if(eb(Tt))return pt(gt,bt,Tt,wt);if(Ka(Tt))return mt(gt,bt,Tt,wt);Mg(gt,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"?(Tt=""+Tt,bt!==null&&bt.tag===6?(et(gt,bt.sibling),bt=it(bt,Tt),bt.return=gt,gt=bt):(et(gt,bt),bt=Qg(Tt,gt.mode,wt),bt.return=gt,gt=bt),ot(gt)):et(gt,bt)}return At}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(nt){var _e=Wg.current;E$2(Wg),nt._currentValue=_e}function bh(nt,_e,et){for(;nt!==null;){var rt=nt.alternate;if((nt.childLanes&_e)!==_e?(nt.childLanes|=_e,rt!==null&&(rt.childLanes|=_e)):rt!==null&&(rt.childLanes&_e)!==_e&&(rt.childLanes|=_e),nt===et)break;nt=nt.return}}function ch(nt,_e){Xg=nt,Zg=Yg=null,nt=nt.dependencies,nt!==null&&nt.firstContext!==null&&(nt.lanes&_e&&(dh=!0),nt.firstContext=null)}function eh(nt){var _e=nt._currentValue;if(Zg!==nt)if(nt={context:nt,memoizedValue:_e,next:null},Yg===null){if(Xg===null)throw Error(p$4(308));Yg=nt,Xg.dependencies={lanes:0,firstContext:nt}}else Yg=Yg.next=nt;return _e}var fh=null;function gh(nt){fh===null?fh=[nt]:fh.push(nt)}function hh(nt,_e,et,rt){var it=_e.interleaved;return it===null?(et.next=et,gh(_e)):(et.next=it.next,it.next=et),_e.interleaved=et,ih(nt,rt)}function ih(nt,_e){nt.lanes|=_e;var et=nt.alternate;for(et!==null&&(et.lanes|=_e),et=nt,nt=nt.return;nt!==null;)nt.childLanes|=_e,et=nt.alternate,et!==null&&(et.childLanes|=_e),et=nt,nt=nt.return;return et.tag===3?et.stateNode:null}var jh=!1;function kh(nt){nt.updateQueue={baseState:nt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(nt,_e){nt=nt.updateQueue,_e.updateQueue===nt&&(_e.updateQueue={baseState:nt.baseState,firstBaseUpdate:nt.firstBaseUpdate,lastBaseUpdate:nt.lastBaseUpdate,shared:nt.shared,effects:nt.effects})}function mh(nt,_e){return{eventTime:nt,lane:_e,tag:0,payload:null,callback:null,next:null}}function nh(nt,_e,et){var rt=nt.updateQueue;if(rt===null)return null;if(rt=rt.shared,K&2){var it=rt.pending;return it===null?_e.next=_e:(_e.next=it.next,it.next=_e),rt.pending=_e,ih(nt,et)}return it=rt.interleaved,it===null?(_e.next=_e,gh(rt)):(_e.next=it.next,it.next=_e),rt.interleaved=_e,ih(nt,et)}function oh(nt,_e,et){if(_e=_e.updateQueue,_e!==null&&(_e=_e.shared,(et&4194240)!==0)){var rt=_e.lanes;rt&=nt.pendingLanes,et|=rt,_e.lanes=et,Cc(nt,et)}}function ph(nt,_e){var et=nt.updateQueue,rt=nt.alternate;if(rt!==null&&(rt=rt.updateQueue,et===rt)){var it=null,st=null;if(et=et.firstBaseUpdate,et!==null){do{var ot={eventTime:et.eventTime,lane:et.lane,tag:et.tag,payload:et.payload,callback:et.callback,next:null};st===null?it=st=ot:st=st.next=ot,et=et.next}while(et!==null);st===null?it=st=_e:st=st.next=_e}else it=st=_e;et={baseState:rt.baseState,firstBaseUpdate:it,lastBaseUpdate:st,shared:rt.shared,effects:rt.effects},nt.updateQueue=et;return}nt=et.lastBaseUpdate,nt===null?et.firstBaseUpdate=_e:nt.next=_e,et.lastBaseUpdate=_e}function qh(nt,_e,et,rt){var it=nt.updateQueue;jh=!1;var st=it.firstBaseUpdate,ot=it.lastBaseUpdate,at=it.shared.pending;if(at!==null){it.shared.pending=null;var lt=at,ct=lt.next;lt.next=null,ot===null?st=ct:ot.next=ct,ot=lt;var ut=nt.alternate;ut!==null&&(ut=ut.updateQueue,at=ut.lastBaseUpdate,at!==ot&&(at===null?ut.firstBaseUpdate=ct:at.next=ct,ut.lastBaseUpdate=lt))}if(st!==null){var ht=it.baseState;ot=0,ut=ct=lt=null,at=st;do{var dt=at.lane,ft=at.eventTime;if((rt&dt)===dt){ut!==null&&(ut=ut.next={eventTime:ft,lane:0,tag:at.tag,payload:at.payload,callback:at.callback,next:null});e:{var pt=nt,mt=at;switch(dt=_e,ft=et,mt.tag){case 1:if(pt=mt.payload,typeof pt=="function"){ht=pt.call(ft,ht,dt);break e}ht=pt;break e;case 3:pt.flags=pt.flags&-65537|128;case 0:if(pt=mt.payload,dt=typeof pt=="function"?pt.call(ft,ht,dt):pt,dt==null)break e;ht=A$1({},ht,dt);break e;case 2:jh=!0}}at.callback!==null&&at.lane!==0&&(nt.flags|=64,dt=it.effects,dt===null?it.effects=[at]:dt.push(at))}else ft={eventTime:ft,lane:dt,tag:at.tag,payload:at.payload,callback:at.callback,next:null},ut===null?(ct=ut=ft,lt=ht):ut=ut.next=ft,ot|=dt;if(at=at.next,at===null){if(at=it.shared.pending,at===null)break;dt=at,at=dt.next,dt.next=null,it.lastBaseUpdate=dt,it.shared.pending=null}}while(!0);if(ut===null&&(lt=ht),it.baseState=lt,it.firstBaseUpdate=ct,it.lastBaseUpdate=ut,_e=it.shared.interleaved,_e!==null){it=_e;do ot|=it.lane,it=it.next;while(it!==_e)}else st===null&&(it.shared.lanes=0);rh|=ot,nt.lanes=ot,nt.memoizedState=ht}}function sh(nt,_e,et){if(nt=_e.effects,_e.effects=null,nt!==null)for(_e=0;_e<nt.length;_e++){var rt=nt[_e],it=rt.callback;if(it!==null){if(rt.callback=null,rt=et,typeof it!="function")throw Error(p$4(191,it));it.call(rt)}}}var th={},uh=Uf(th),vh$1=Uf(th),wh=Uf(th);function xh(nt){if(nt===th)throw Error(p$4(174));return nt}function yh(nt,_e){switch(G$1(wh,_e),G$1(vh$1,nt),G$1(uh,th),nt=_e.nodeType,nt){case 9:case 11:_e=(_e=_e.documentElement)?_e.namespaceURI:lb(null,"");break;default:nt=nt===8?_e.parentNode:_e,_e=nt.namespaceURI||null,nt=nt.tagName,_e=lb(_e,nt)}E$2(uh),G$1(uh,_e)}function zh(){E$2(uh),E$2(vh$1),E$2(wh)}function Ah(nt){xh(wh.current);var _e=xh(uh.current),et=lb(_e,nt.type);_e!==et&&(G$1(vh$1,nt),G$1(uh,et))}function Bh(nt){vh$1.current===nt&&(E$2(uh),E$2(vh$1))}var L$3=Uf(0);function Ch(nt){for(var _e=nt;_e!==null;){if(_e.tag===13){var et=_e.memoizedState;if(et!==null&&(et=et.dehydrated,et===null||et.data==="$?"||et.data==="$!"))return _e}else if(_e.tag===19&&_e.memoizedProps.revealOrder!==void 0){if(_e.flags&128)return _e}else if(_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===nt)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===nt)return null;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}return null}var Dh=[];function Eh(){for(var nt=0;nt<Dh.length;nt++)Dh[nt]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$3=null,N$3=null,O$1=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$4(321))}function Mh(nt,_e){if(_e===null)return!1;for(var et=0;et<_e.length&&et<nt.length;et++)if(!He(nt[et],_e[et]))return!1;return!0}function Nh(nt,_e,et,rt,it,st){if(Hh=st,M$3=_e,_e.memoizedState=null,_e.updateQueue=null,_e.lanes=0,Fh.current=nt===null||nt.memoizedState===null?Oh:Ph,nt=et(rt,it),Jh){st=0;do{if(Jh=!1,Kh=0,25<=st)throw Error(p$4(301));st+=1,O$1=N$3=null,_e.updateQueue=null,Fh.current=Qh,nt=et(rt,it)}while(Jh)}if(Fh.current=Rh,_e=N$3!==null&&N$3.next!==null,Hh=0,O$1=N$3=M$3=null,Ih=!1,_e)throw Error(p$4(300));return nt}function Sh(){var nt=Kh!==0;return Kh=0,nt}function Th(){var nt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$3.memoizedState=O$1=nt:O$1=O$1.next=nt,O$1}function Uh(){if(N$3===null){var nt=M$3.alternate;nt=nt!==null?nt.memoizedState:null}else nt=N$3.next;var _e=O$1===null?M$3.memoizedState:O$1.next;if(_e!==null)O$1=_e,N$3=nt;else{if(nt===null)throw Error(p$4(310));N$3=nt,nt={memoizedState:N$3.memoizedState,baseState:N$3.baseState,baseQueue:N$3.baseQueue,queue:N$3.queue,next:null},O$1===null?M$3.memoizedState=O$1=nt:O$1=O$1.next=nt}return O$1}function Vh(nt,_e){return typeof _e=="function"?_e(nt):_e}function Wh(nt){var _e=Uh(),et=_e.queue;if(et===null)throw Error(p$4(311));et.lastRenderedReducer=nt;var rt=N$3,it=rt.baseQueue,st=et.pending;if(st!==null){if(it!==null){var ot=it.next;it.next=st.next,st.next=ot}rt.baseQueue=it=st,et.pending=null}if(it!==null){st=it.next,rt=rt.baseState;var at=ot=null,lt=null,ct=st;do{var ut=ct.lane;if((Hh&ut)===ut)lt!==null&&(lt=lt.next={lane:0,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),rt=ct.hasEagerState?ct.eagerState:nt(rt,ct.action);else{var ht={lane:ut,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null};lt===null?(at=lt=ht,ot=rt):lt=lt.next=ht,M$3.lanes|=ut,rh|=ut}ct=ct.next}while(ct!==null&&ct!==st);lt===null?ot=rt:lt.next=at,He(rt,_e.memoizedState)||(dh=!0),_e.memoizedState=rt,_e.baseState=ot,_e.baseQueue=lt,et.lastRenderedState=rt}if(nt=et.interleaved,nt!==null){it=nt;do st=it.lane,M$3.lanes|=st,rh|=st,it=it.next;while(it!==nt)}else it===null&&(et.lanes=0);return[_e.memoizedState,et.dispatch]}function Xh(nt){var _e=Uh(),et=_e.queue;if(et===null)throw Error(p$4(311));et.lastRenderedReducer=nt;var rt=et.dispatch,it=et.pending,st=_e.memoizedState;if(it!==null){et.pending=null;var ot=it=it.next;do st=nt(st,ot.action),ot=ot.next;while(ot!==it);He(st,_e.memoizedState)||(dh=!0),_e.memoizedState=st,_e.baseQueue===null&&(_e.baseState=st),et.lastRenderedState=st}return[st,rt]}function Yh(){}function Zh(nt,_e){var et=M$3,rt=Uh(),it=_e(),st=!He(rt.memoizedState,it);if(st&&(rt.memoizedState=it,dh=!0),rt=rt.queue,$h(ai.bind(null,et,rt,nt),[nt]),rt.getSnapshot!==_e||st||O$1!==null&&O$1.memoizedState.tag&1){if(et.flags|=2048,bi(9,ci.bind(null,et,rt,it,_e),void 0,null),Q$2===null)throw Error(p$4(349));Hh&30||di(et,_e,it)}return it}function di(nt,_e,et){nt.flags|=16384,nt={getSnapshot:_e,value:et},_e=M$3.updateQueue,_e===null?(_e={lastEffect:null,stores:null},M$3.updateQueue=_e,_e.stores=[nt]):(et=_e.stores,et===null?_e.stores=[nt]:et.push(nt))}function ci(nt,_e,et,rt){_e.value=et,_e.getSnapshot=rt,ei(_e)&&fi(nt)}function ai(nt,_e,et){return et(function(){ei(_e)&&fi(nt)})}function ei(nt){var _e=nt.getSnapshot;nt=nt.value;try{var et=_e();return!He(nt,et)}catch{return!0}}function fi(nt){var _e=ih(nt,1);_e!==null&&gi(_e,nt,1,-1)}function hi(nt){var _e=Th();return typeof nt=="function"&&(nt=nt()),_e.memoizedState=_e.baseState=nt,nt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:nt},_e.queue=nt,nt=nt.dispatch=ii.bind(null,M$3,nt),[_e.memoizedState,nt]}function bi(nt,_e,et,rt){return nt={tag:nt,create:_e,destroy:et,deps:rt,next:null},_e=M$3.updateQueue,_e===null?(_e={lastEffect:null,stores:null},M$3.updateQueue=_e,_e.lastEffect=nt.next=nt):(et=_e.lastEffect,et===null?_e.lastEffect=nt.next=nt:(rt=et.next,et.next=nt,nt.next=rt,_e.lastEffect=nt)),nt}function ji(){return Uh().memoizedState}function ki(nt,_e,et,rt){var it=Th();M$3.flags|=nt,it.memoizedState=bi(1|_e,et,void 0,rt===void 0?null:rt)}function li(nt,_e,et,rt){var it=Uh();rt=rt===void 0?null:rt;var st=void 0;if(N$3!==null){var ot=N$3.memoizedState;if(st=ot.destroy,rt!==null&&Mh(rt,ot.deps)){it.memoizedState=bi(_e,et,st,rt);return}}M$3.flags|=nt,it.memoizedState=bi(1|_e,et,st,rt)}function mi(nt,_e){return ki(8390656,8,nt,_e)}function $h(nt,_e){return li(2048,8,nt,_e)}function ni(nt,_e){return li(4,2,nt,_e)}function oi(nt,_e){return li(4,4,nt,_e)}function pi$2(nt,_e){if(typeof _e=="function")return nt=nt(),_e(nt),function(){_e(null)};if(_e!=null)return nt=nt(),_e.current=nt,function(){_e.current=null}}function qi(nt,_e,et){return et=et!=null?et.concat([nt]):null,li(4,4,pi$2.bind(null,_e,nt),et)}function ri(){}function si(nt,_e){var et=Uh();_e=_e===void 0?null:_e;var rt=et.memoizedState;return rt!==null&&_e!==null&&Mh(_e,rt[1])?rt[0]:(et.memoizedState=[nt,_e],nt)}function ti(nt,_e){var et=Uh();_e=_e===void 0?null:_e;var rt=et.memoizedState;return rt!==null&&_e!==null&&Mh(_e,rt[1])?rt[0]:(nt=nt(),et.memoizedState=[nt,_e],nt)}function ui(nt,_e,et){return Hh&21?(He(et,_e)||(et=yc(),M$3.lanes|=et,rh|=et,nt.baseState=!0),_e):(nt.baseState&&(nt.baseState=!1,dh=!0),nt.memoizedState=et)}function vi(nt,_e){var et=C$1;C$1=et!==0&&4>et?et:4,nt(!0);var rt=Gh.transition;Gh.transition={};try{nt(!1),_e()}finally{C$1=et,Gh.transition=rt}}function wi(){return Uh().memoizedState}function xi(nt,_e,et){var rt=yi(nt);if(et={lane:rt,action:et,hasEagerState:!1,eagerState:null,next:null},zi(nt))Ai(_e,et);else if(et=hh(nt,_e,et,rt),et!==null){var it=R$2();gi(et,nt,rt,it),Bi(et,_e,rt)}}function ii(nt,_e,et){var rt=yi(nt),it={lane:rt,action:et,hasEagerState:!1,eagerState:null,next:null};if(zi(nt))Ai(_e,it);else{var st=nt.alternate;if(nt.lanes===0&&(st===null||st.lanes===0)&&(st=_e.lastRenderedReducer,st!==null))try{var ot=_e.lastRenderedState,at=st(ot,et);if(it.hasEagerState=!0,it.eagerState=at,He(at,ot)){var lt=_e.interleaved;lt===null?(it.next=it,gh(_e)):(it.next=lt.next,lt.next=it),_e.interleaved=it;return}}catch{}finally{}et=hh(nt,_e,it,rt),et!==null&&(it=R$2(),gi(et,nt,rt,it),Bi(et,_e,rt))}}function zi(nt){var _e=nt.alternate;return nt===M$3||_e!==null&&_e===M$3}function Ai(nt,_e){Jh=Ih=!0;var et=nt.pending;et===null?_e.next=_e:(_e.next=et.next,et.next=_e),nt.pending=_e}function Bi(nt,_e,et){if(et&4194240){var rt=_e.lanes;rt&=nt.pendingLanes,et|=rt,_e.lanes=et,Cc(nt,et)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(nt,_e){return Th().memoizedState=[nt,_e===void 0?null:_e],nt},useContext:eh,useEffect:mi,useImperativeHandle:function(nt,_e,et){return et=et!=null?et.concat([nt]):null,ki(4194308,4,pi$2.bind(null,_e,nt),et)},useLayoutEffect:function(nt,_e){return ki(4194308,4,nt,_e)},useInsertionEffect:function(nt,_e){return ki(4,2,nt,_e)},useMemo:function(nt,_e){var et=Th();return _e=_e===void 0?null:_e,nt=nt(),et.memoizedState=[nt,_e],nt},useReducer:function(nt,_e,et){var rt=Th();return _e=et!==void 0?et(_e):_e,rt.memoizedState=rt.baseState=_e,nt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nt,lastRenderedState:_e},rt.queue=nt,nt=nt.dispatch=xi.bind(null,M$3,nt),[rt.memoizedState,nt]},useRef:function(nt){var _e=Th();return nt={current:nt},_e.memoizedState=nt},useState:hi,useDebugValue:ri,useDeferredValue:function(nt){return Th().memoizedState=nt},useTransition:function(){var nt=hi(!1),_e=nt[0];return nt=vi.bind(null,nt[1]),Th().memoizedState=nt,[_e,nt]},useMutableSource:function(){},useSyncExternalStore:function(nt,_e,et){var rt=M$3,it=Th();if(I$4){if(et===void 0)throw Error(p$4(407));et=et()}else{if(et=_e(),Q$2===null)throw Error(p$4(349));Hh&30||di(rt,_e,et)}it.memoizedState=et;var st={value:et,getSnapshot:_e};return it.queue=st,mi(ai.bind(null,rt,st,nt),[nt]),rt.flags|=2048,bi(9,ci.bind(null,rt,st,et,_e),void 0,null),et},useId:function(){var nt=Th(),_e=Q$2.identifierPrefix;if(I$4){var et=sg,rt=rg;et=(rt&~(1<<32-oc(rt)-1)).toString(32)+et,_e=":"+_e+"R"+et,et=Kh++,0<et&&(_e+="H"+et.toString(32)),_e+=":"}else et=Lh++,_e=":"+_e+"r"+et.toString(32)+":";return nt.memoizedState=_e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(nt){var _e=Uh();return ui(_e,N$3.memoizedState,nt)},useTransition:function(){var nt=Wh(Vh)[0],_e=Uh().memoizedState;return[nt,_e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(nt){var _e=Uh();return N$3===null?_e.memoizedState=nt:ui(_e,N$3.memoizedState,nt)},useTransition:function(){var nt=Xh(Vh)[0],_e=Uh().memoizedState;return[nt,_e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(nt,_e){if(nt&&nt.defaultProps){_e=A$1({},_e),nt=nt.defaultProps;for(var et in nt)_e[et]===void 0&&(_e[et]=nt[et]);return _e}return _e}function Di(nt,_e,et,rt){_e=nt.memoizedState,et=et(rt,_e),et=et==null?_e:A$1({},_e,et),nt.memoizedState=et,nt.lanes===0&&(nt.updateQueue.baseState=et)}var Ei={isMounted:function(nt){return(nt=nt._reactInternals)?Vb(nt)===nt:!1},enqueueSetState:function(nt,_e,et){nt=nt._reactInternals;var rt=R$2(),it=yi(nt),st=mh(rt,it);st.payload=_e,et!=null&&(st.callback=et),_e=nh(nt,st,it),_e!==null&&(gi(_e,nt,it,rt),oh(_e,nt,it))},enqueueReplaceState:function(nt,_e,et){nt=nt._reactInternals;var rt=R$2(),it=yi(nt),st=mh(rt,it);st.tag=1,st.payload=_e,et!=null&&(st.callback=et),_e=nh(nt,st,it),_e!==null&&(gi(_e,nt,it,rt),oh(_e,nt,it))},enqueueForceUpdate:function(nt,_e){nt=nt._reactInternals;var et=R$2(),rt=yi(nt),it=mh(et,rt);it.tag=2,_e!=null&&(it.callback=_e),_e=nh(nt,it,rt),_e!==null&&(gi(_e,nt,rt,et),oh(_e,nt,rt))}};function Fi(nt,_e,et,rt,it,st,ot){return nt=nt.stateNode,typeof nt.shouldComponentUpdate=="function"?nt.shouldComponentUpdate(rt,st,ot):_e.prototype&&_e.prototype.isPureReactComponent?!Ie(et,rt)||!Ie(it,st):!0}function Gi(nt,_e,et){var rt=!1,it=Vf,st=_e.contextType;return typeof st=="object"&&st!==null?st=eh(st):(it=Zf(_e)?Xf:H$2.current,rt=_e.contextTypes,st=(rt=rt!=null)?Yf(nt,it):Vf),_e=new _e(et,st),nt.memoizedState=_e.state!==null&&_e.state!==void 0?_e.state:null,_e.updater=Ei,nt.stateNode=_e,_e._reactInternals=nt,rt&&(nt=nt.stateNode,nt.__reactInternalMemoizedUnmaskedChildContext=it,nt.__reactInternalMemoizedMaskedChildContext=st),_e}function Hi(nt,_e,et,rt){nt=_e.state,typeof _e.componentWillReceiveProps=="function"&&_e.componentWillReceiveProps(et,rt),typeof _e.UNSAFE_componentWillReceiveProps=="function"&&_e.UNSAFE_componentWillReceiveProps(et,rt),_e.state!==nt&&Ei.enqueueReplaceState(_e,_e.state,null)}function Ii(nt,_e,et,rt){var it=nt.stateNode;it.props=et,it.state=nt.memoizedState,it.refs={},kh(nt);var st=_e.contextType;typeof st=="object"&&st!==null?it.context=eh(st):(st=Zf(_e)?Xf:H$2.current,it.context=Yf(nt,st)),it.state=nt.memoizedState,st=_e.getDerivedStateFromProps,typeof st=="function"&&(Di(nt,_e,st,et),it.state=nt.memoizedState),typeof _e.getDerivedStateFromProps=="function"||typeof it.getSnapshotBeforeUpdate=="function"||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(_e=it.state,typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount(),_e!==it.state&&Ei.enqueueReplaceState(it,it.state,null),qh(nt,et,it,rt),it.state=nt.memoizedState),typeof it.componentDidMount=="function"&&(nt.flags|=4194308)}function Ji(nt,_e){try{var et="",rt=_e;do et+=Pa(rt),rt=rt.return;while(rt);var it=et}catch(st){it=`
Error generating stack: `+st.message+`
`+st.stack}return{value:nt,source:_e,stack:it,digest:null}}function Ki(nt,_e,et){return{value:nt,source:null,stack:et??null,digest:_e??null}}function Li(nt,_e){try{console.error(_e.value)}catch(et){setTimeout(function(){throw et})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(nt,_e,et){et=mh(-1,et),et.tag=3,et.payload={element:null};var rt=_e.value;return et.callback=function(){Oi||(Oi=!0,Pi=rt),Li(nt,_e)},et}function Qi(nt,_e,et){et=mh(-1,et),et.tag=3;var rt=nt.type.getDerivedStateFromError;if(typeof rt=="function"){var it=_e.value;et.payload=function(){return rt(it)},et.callback=function(){Li(nt,_e)}}var st=nt.stateNode;return st!==null&&typeof st.componentDidCatch=="function"&&(et.callback=function(){Li(nt,_e),typeof rt!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var ot=_e.stack;this.componentDidCatch(_e.value,{componentStack:ot!==null?ot:""})}),et}function Si(nt,_e,et){var rt=nt.pingCache;if(rt===null){rt=nt.pingCache=new Mi;var it=new Set;rt.set(_e,it)}else it=rt.get(_e),it===void 0&&(it=new Set,rt.set(_e,it));it.has(et)||(it.add(et),nt=Ti.bind(null,nt,_e,et),_e.then(nt,nt))}function Ui(nt){do{var _e;if((_e=nt.tag===13)&&(_e=nt.memoizedState,_e=_e!==null?_e.dehydrated!==null:!0),_e)return nt;nt=nt.return}while(nt!==null);return null}function Vi(nt,_e,et,rt,it){return nt.mode&1?(nt.flags|=65536,nt.lanes=it,nt):(nt===_e?nt.flags|=65536:(nt.flags|=128,et.flags|=131072,et.flags&=-52805,et.tag===1&&(et.alternate===null?et.tag=17:(_e=mh(-1,1),_e.tag=2,nh(et,_e,1))),et.lanes|=1),nt)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(nt,_e,et,rt){_e.child=nt===null?Vg(_e,null,et,rt):Ug(_e,nt.child,et,rt)}function Yi(nt,_e,et,rt,it){et=et.render;var st=_e.ref;return ch(_e,it),rt=Nh(nt,_e,et,rt,st,it),et=Sh(),nt!==null&&!dh?(_e.updateQueue=nt.updateQueue,_e.flags&=-2053,nt.lanes&=~it,Zi(nt,_e,it)):(I$4&&et&&vg(_e),_e.flags|=1,Xi(nt,_e,rt,it),_e.child)}function $i(nt,_e,et,rt,it){if(nt===null){var st=et.type;return typeof st=="function"&&!aj(st)&&st.defaultProps===void 0&&et.compare===null&&et.defaultProps===void 0?(_e.tag=15,_e.type=st,bj(nt,_e,st,rt,it)):(nt=Rg(et.type,null,rt,_e,_e.mode,it),nt.ref=_e.ref,nt.return=_e,_e.child=nt)}if(st=nt.child,!(nt.lanes&it)){var ot=st.memoizedProps;if(et=et.compare,et=et!==null?et:Ie,et(ot,rt)&&nt.ref===_e.ref)return Zi(nt,_e,it)}return _e.flags|=1,nt=Pg(st,rt),nt.ref=_e.ref,nt.return=_e,_e.child=nt}function bj(nt,_e,et,rt,it){if(nt!==null){var st=nt.memoizedProps;if(Ie(st,rt)&&nt.ref===_e.ref)if(dh=!1,_e.pendingProps=rt=st,(nt.lanes&it)!==0)nt.flags&131072&&(dh=!0);else return _e.lanes=nt.lanes,Zi(nt,_e,it)}return cj(nt,_e,et,rt,it)}function dj(nt,_e,et){var rt=_e.pendingProps,it=rt.children,st=nt!==null?nt.memoizedState:null;if(rt.mode==="hidden")if(!(_e.mode&1))_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej,fj),fj|=et;else{if(!(et&1073741824))return nt=st!==null?st.baseLanes|et:et,_e.lanes=_e.childLanes=1073741824,_e.memoizedState={baseLanes:nt,cachePool:null,transitions:null},_e.updateQueue=null,G$1(ej,fj),fj|=nt,null;_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt=st!==null?st.baseLanes:et,G$1(ej,fj),fj|=rt}else st!==null?(rt=st.baseLanes|et,_e.memoizedState=null):rt=et,G$1(ej,fj),fj|=rt;return Xi(nt,_e,it,et),_e.child}function gj(nt,_e){var et=_e.ref;(nt===null&&et!==null||nt!==null&&nt.ref!==et)&&(_e.flags|=512,_e.flags|=2097152)}function cj(nt,_e,et,rt,it){var st=Zf(et)?Xf:H$2.current;return st=Yf(_e,st),ch(_e,it),et=Nh(nt,_e,et,rt,st,it),rt=Sh(),nt!==null&&!dh?(_e.updateQueue=nt.updateQueue,_e.flags&=-2053,nt.lanes&=~it,Zi(nt,_e,it)):(I$4&&rt&&vg(_e),_e.flags|=1,Xi(nt,_e,et,it),_e.child)}function hj(nt,_e,et,rt,it){if(Zf(et)){var st=!0;cg(_e)}else st=!1;if(ch(_e,it),_e.stateNode===null)ij(nt,_e),Gi(_e,et,rt),Ii(_e,et,rt,it),rt=!0;else if(nt===null){var ot=_e.stateNode,at=_e.memoizedProps;ot.props=at;var lt=ot.context,ct=et.contextType;typeof ct=="object"&&ct!==null?ct=eh(ct):(ct=Zf(et)?Xf:H$2.current,ct=Yf(_e,ct));var ut=et.getDerivedStateFromProps,ht=typeof ut=="function"||typeof ot.getSnapshotBeforeUpdate=="function";ht||typeof ot.UNSAFE_componentWillReceiveProps!="function"&&typeof ot.componentWillReceiveProps!="function"||(at!==rt||lt!==ct)&&Hi(_e,ot,rt,ct),jh=!1;var dt=_e.memoizedState;ot.state=dt,qh(_e,rt,ot,it),lt=_e.memoizedState,at!==rt||dt!==lt||Wf.current||jh?(typeof ut=="function"&&(Di(_e,et,ut,rt),lt=_e.memoizedState),(at=jh||Fi(_e,et,at,rt,dt,lt,ct))?(ht||typeof ot.UNSAFE_componentWillMount!="function"&&typeof ot.componentWillMount!="function"||(typeof ot.componentWillMount=="function"&&ot.componentWillMount(),typeof ot.UNSAFE_componentWillMount=="function"&&ot.UNSAFE_componentWillMount()),typeof ot.componentDidMount=="function"&&(_e.flags|=4194308)):(typeof ot.componentDidMount=="function"&&(_e.flags|=4194308),_e.memoizedProps=rt,_e.memoizedState=lt),ot.props=rt,ot.state=lt,ot.context=ct,rt=at):(typeof ot.componentDidMount=="function"&&(_e.flags|=4194308),rt=!1)}else{ot=_e.stateNode,lh(nt,_e),at=_e.memoizedProps,ct=_e.type===_e.elementType?at:Ci(_e.type,at),ot.props=ct,ht=_e.pendingProps,dt=ot.context,lt=et.contextType,typeof lt=="object"&&lt!==null?lt=eh(lt):(lt=Zf(et)?Xf:H$2.current,lt=Yf(_e,lt));var ft=et.getDerivedStateFromProps;(ut=typeof ft=="function"||typeof ot.getSnapshotBeforeUpdate=="function")||typeof ot.UNSAFE_componentWillReceiveProps!="function"&&typeof ot.componentWillReceiveProps!="function"||(at!==ht||dt!==lt)&&Hi(_e,ot,rt,lt),jh=!1,dt=_e.memoizedState,ot.state=dt,qh(_e,rt,ot,it);var pt=_e.memoizedState;at!==ht||dt!==pt||Wf.current||jh?(typeof ft=="function"&&(Di(_e,et,ft,rt),pt=_e.memoizedState),(ct=jh||Fi(_e,et,ct,rt,dt,pt,lt)||!1)?(ut||typeof ot.UNSAFE_componentWillUpdate!="function"&&typeof ot.componentWillUpdate!="function"||(typeof ot.componentWillUpdate=="function"&&ot.componentWillUpdate(rt,pt,lt),typeof ot.UNSAFE_componentWillUpdate=="function"&&ot.UNSAFE_componentWillUpdate(rt,pt,lt)),typeof ot.componentDidUpdate=="function"&&(_e.flags|=4),typeof ot.getSnapshotBeforeUpdate=="function"&&(_e.flags|=1024)):(typeof ot.componentDidUpdate!="function"||at===nt.memoizedProps&&dt===nt.memoizedState||(_e.flags|=4),typeof ot.getSnapshotBeforeUpdate!="function"||at===nt.memoizedProps&&dt===nt.memoizedState||(_e.flags|=1024),_e.memoizedProps=rt,_e.memoizedState=pt),ot.props=rt,ot.state=pt,ot.context=lt,rt=ct):(typeof ot.componentDidUpdate!="function"||at===nt.memoizedProps&&dt===nt.memoizedState||(_e.flags|=4),typeof ot.getSnapshotBeforeUpdate!="function"||at===nt.memoizedProps&&dt===nt.memoizedState||(_e.flags|=1024),rt=!1)}return jj(nt,_e,et,rt,st,it)}function jj(nt,_e,et,rt,it,st){gj(nt,_e);var ot=(_e.flags&128)!==0;if(!rt&&!ot)return it&&dg(_e,et,!1),Zi(nt,_e,st);rt=_e.stateNode,Wi.current=_e;var at=ot&&typeof et.getDerivedStateFromError!="function"?null:rt.render();return _e.flags|=1,nt!==null&&ot?(_e.child=Ug(_e,nt.child,null,st),_e.child=Ug(_e,null,at,st)):Xi(nt,_e,at,st),_e.memoizedState=rt.state,it&&dg(_e,et,!0),_e.child}function kj(nt){var _e=nt.stateNode;_e.pendingContext?ag(nt,_e.pendingContext,_e.pendingContext!==_e.context):_e.context&&ag(nt,_e.context,!1),yh(nt,_e.containerInfo)}function lj(nt,_e,et,rt,it){return Ig(),Jg(it),_e.flags|=256,Xi(nt,_e,et,rt),_e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(nt){return{baseLanes:nt,cachePool:null,transitions:null}}function oj(nt,_e,et){var rt=_e.pendingProps,it=L$3.current,st=!1,ot=(_e.flags&128)!==0,at;if((at=ot)||(at=nt!==null&&nt.memoizedState===null?!1:(it&2)!==0),at?(st=!0,_e.flags&=-129):(nt===null||nt.memoizedState!==null)&&(it|=1),G$1(L$3,it&1),nt===null)return Eg(_e),nt=_e.memoizedState,nt!==null&&(nt=nt.dehydrated,nt!==null)?(_e.mode&1?nt.data==="$!"?_e.lanes=8:_e.lanes=1073741824:_e.lanes=1,null):(ot=rt.children,nt=rt.fallback,st?(rt=_e.mode,st=_e.child,ot={mode:"hidden",children:ot},!(rt&1)&&st!==null?(st.childLanes=0,st.pendingProps=ot):st=pj(ot,rt,0,null),nt=Tg(nt,rt,et,null),st.return=_e,nt.return=_e,st.sibling=nt,_e.child=st,_e.child.memoizedState=nj(et),_e.memoizedState=mj,nt):qj(_e,ot));if(it=nt.memoizedState,it!==null&&(at=it.dehydrated,at!==null))return rj(nt,_e,ot,rt,at,it,et);if(st){st=rt.fallback,ot=_e.mode,it=nt.child,at=it.sibling;var lt={mode:"hidden",children:rt.children};return!(ot&1)&&_e.child!==it?(rt=_e.child,rt.childLanes=0,rt.pendingProps=lt,_e.deletions=null):(rt=Pg(it,lt),rt.subtreeFlags=it.subtreeFlags&14680064),at!==null?st=Pg(at,st):(st=Tg(st,ot,et,null),st.flags|=2),st.return=_e,rt.return=_e,rt.sibling=st,_e.child=rt,rt=st,st=_e.child,ot=nt.child.memoizedState,ot=ot===null?nj(et):{baseLanes:ot.baseLanes|et,cachePool:null,transitions:ot.transitions},st.memoizedState=ot,st.childLanes=nt.childLanes&~et,_e.memoizedState=mj,rt}return st=nt.child,nt=st.sibling,rt=Pg(st,{mode:"visible",children:rt.children}),!(_e.mode&1)&&(rt.lanes=et),rt.return=_e,rt.sibling=null,nt!==null&&(et=_e.deletions,et===null?(_e.deletions=[nt],_e.flags|=16):et.push(nt)),_e.child=rt,_e.memoizedState=null,rt}function qj(nt,_e){return _e=pj({mode:"visible",children:_e},nt.mode,0,null),_e.return=nt,nt.child=_e}function sj(nt,_e,et,rt){return rt!==null&&Jg(rt),Ug(_e,nt.child,null,et),nt=qj(_e,_e.pendingProps.children),nt.flags|=2,_e.memoizedState=null,nt}function rj(nt,_e,et,rt,it,st,ot){if(et)return _e.flags&256?(_e.flags&=-257,rt=Ki(Error(p$4(422))),sj(nt,_e,ot,rt)):_e.memoizedState!==null?(_e.child=nt.child,_e.flags|=128,null):(st=rt.fallback,it=_e.mode,rt=pj({mode:"visible",children:rt.children},it,0,null),st=Tg(st,it,ot,null),st.flags|=2,rt.return=_e,st.return=_e,rt.sibling=st,_e.child=rt,_e.mode&1&&Ug(_e,nt.child,null,ot),_e.child.memoizedState=nj(ot),_e.memoizedState=mj,st);if(!(_e.mode&1))return sj(nt,_e,ot,null);if(it.data==="$!"){if(rt=it.nextSibling&&it.nextSibling.dataset,rt)var at=rt.dgst;return rt=at,st=Error(p$4(419)),rt=Ki(st,rt,void 0),sj(nt,_e,ot,rt)}if(at=(ot&nt.childLanes)!==0,dh||at){if(rt=Q$2,rt!==null){switch(ot&-ot){case 4:it=2;break;case 16:it=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:it=32;break;case 536870912:it=268435456;break;default:it=0}it=it&(rt.suspendedLanes|ot)?0:it,it!==0&&it!==st.retryLane&&(st.retryLane=it,ih(nt,it),gi(rt,nt,it,-1))}return tj(),rt=Ki(Error(p$4(421))),sj(nt,_e,ot,rt)}return it.data==="$?"?(_e.flags|=128,_e.child=nt.child,_e=uj.bind(null,nt),it._reactRetry=_e,null):(nt=st.treeContext,yg=Lf(it.nextSibling),xg=_e,I$4=!0,zg=null,nt!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=nt.id,sg=nt.overflow,qg=_e),_e=qj(_e,rt.children),_e.flags|=4096,_e)}function vj(nt,_e,et){nt.lanes|=_e;var rt=nt.alternate;rt!==null&&(rt.lanes|=_e),bh(nt.return,_e,et)}function wj(nt,_e,et,rt,it){var st=nt.memoizedState;st===null?nt.memoizedState={isBackwards:_e,rendering:null,renderingStartTime:0,last:rt,tail:et,tailMode:it}:(st.isBackwards=_e,st.rendering=null,st.renderingStartTime=0,st.last=rt,st.tail=et,st.tailMode=it)}function xj(nt,_e,et){var rt=_e.pendingProps,it=rt.revealOrder,st=rt.tail;if(Xi(nt,_e,rt.children,et),rt=L$3.current,rt&2)rt=rt&1|2,_e.flags|=128;else{if(nt!==null&&nt.flags&128)e:for(nt=_e.child;nt!==null;){if(nt.tag===13)nt.memoizedState!==null&&vj(nt,et,_e);else if(nt.tag===19)vj(nt,et,_e);else if(nt.child!==null){nt.child.return=nt,nt=nt.child;continue}if(nt===_e)break e;for(;nt.sibling===null;){if(nt.return===null||nt.return===_e)break e;nt=nt.return}nt.sibling.return=nt.return,nt=nt.sibling}rt&=1}if(G$1(L$3,rt),!(_e.mode&1))_e.memoizedState=null;else switch(it){case"forwards":for(et=_e.child,it=null;et!==null;)nt=et.alternate,nt!==null&&Ch(nt)===null&&(it=et),et=et.sibling;et=it,et===null?(it=_e.child,_e.child=null):(it=et.sibling,et.sibling=null),wj(_e,!1,it,et,st);break;case"backwards":for(et=null,it=_e.child,_e.child=null;it!==null;){if(nt=it.alternate,nt!==null&&Ch(nt)===null){_e.child=it;break}nt=it.sibling,it.sibling=et,et=it,it=nt}wj(_e,!0,et,null,st);break;case"together":wj(_e,!1,null,null,void 0);break;default:_e.memoizedState=null}return _e.child}function ij(nt,_e){!(_e.mode&1)&&nt!==null&&(nt.alternate=null,_e.alternate=null,_e.flags|=2)}function Zi(nt,_e,et){if(nt!==null&&(_e.dependencies=nt.dependencies),rh|=_e.lanes,!(et&_e.childLanes))return null;if(nt!==null&&_e.child!==nt.child)throw Error(p$4(153));if(_e.child!==null){for(nt=_e.child,et=Pg(nt,nt.pendingProps),_e.child=et,et.return=_e;nt.sibling!==null;)nt=nt.sibling,et=et.sibling=Pg(nt,nt.pendingProps),et.return=_e;et.sibling=null}return _e.child}function yj(nt,_e,et){switch(_e.tag){case 3:kj(_e),Ig();break;case 5:Ah(_e);break;case 1:Zf(_e.type)&&cg(_e);break;case 4:yh(_e,_e.stateNode.containerInfo);break;case 10:var rt=_e.type._context,it=_e.memoizedProps.value;G$1(Wg,rt._currentValue),rt._currentValue=it;break;case 13:if(rt=_e.memoizedState,rt!==null)return rt.dehydrated!==null?(G$1(L$3,L$3.current&1),_e.flags|=128,null):et&_e.child.childLanes?oj(nt,_e,et):(G$1(L$3,L$3.current&1),nt=Zi(nt,_e,et),nt!==null?nt.sibling:null);G$1(L$3,L$3.current&1);break;case 19:if(rt=(et&_e.childLanes)!==0,nt.flags&128){if(rt)return xj(nt,_e,et);_e.flags|=128}if(it=_e.memoizedState,it!==null&&(it.rendering=null,it.tail=null,it.lastEffect=null),G$1(L$3,L$3.current),rt)break;return null;case 22:case 23:return _e.lanes=0,dj(nt,_e,et)}return Zi(nt,_e,et)}var zj,Aj,Bj,Cj;zj=function(nt,_e){for(var et=_e.child;et!==null;){if(et.tag===5||et.tag===6)nt.appendChild(et.stateNode);else if(et.tag!==4&&et.child!==null){et.child.return=et,et=et.child;continue}if(et===_e)break;for(;et.sibling===null;){if(et.return===null||et.return===_e)return;et=et.return}et.sibling.return=et.return,et=et.sibling}};Aj=function(){};Bj=function(nt,_e,et,rt){var it=nt.memoizedProps;if(it!==rt){nt=_e.stateNode,xh(uh.current);var st=null;switch(et){case"input":it=Ya(nt,it),rt=Ya(nt,rt),st=[];break;case"select":it=A$1({},it,{value:void 0}),rt=A$1({},rt,{value:void 0}),st=[];break;case"textarea":it=gb(nt,it),rt=gb(nt,rt),st=[];break;default:typeof it.onClick!="function"&&typeof rt.onClick=="function"&&(nt.onclick=Bf)}ub(et,rt);var ot;et=null;for(ct in it)if(!rt.hasOwnProperty(ct)&&it.hasOwnProperty(ct)&&it[ct]!=null)if(ct==="style"){var at=it[ct];for(ot in at)at.hasOwnProperty(ot)&&(et||(et={}),et[ot]="")}else ct!=="dangerouslySetInnerHTML"&&ct!=="children"&&ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&ct!=="autoFocus"&&(ea.hasOwnProperty(ct)?st||(st=[]):(st=st||[]).push(ct,null));for(ct in rt){var lt=rt[ct];if(at=it!=null?it[ct]:void 0,rt.hasOwnProperty(ct)&&lt!==at&&(lt!=null||at!=null))if(ct==="style")if(at){for(ot in at)!at.hasOwnProperty(ot)||lt&&lt.hasOwnProperty(ot)||(et||(et={}),et[ot]="");for(ot in lt)lt.hasOwnProperty(ot)&&at[ot]!==lt[ot]&&(et||(et={}),et[ot]=lt[ot])}else et||(st||(st=[]),st.push(ct,et)),et=lt;else ct==="dangerouslySetInnerHTML"?(lt=lt?lt.__html:void 0,at=at?at.__html:void 0,lt!=null&&at!==lt&&(st=st||[]).push(ct,lt)):ct==="children"?typeof lt!="string"&&typeof lt!="number"||(st=st||[]).push(ct,""+lt):ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&(ea.hasOwnProperty(ct)?(lt!=null&&ct==="onScroll"&&D$2("scroll",nt),st||at===lt||(st=[])):(st=st||[]).push(ct,lt))}et&&(st=st||[]).push("style",et);var ct=st;(_e.updateQueue=ct)&&(_e.flags|=4)}};Cj=function(nt,_e,et,rt){et!==rt&&(_e.flags|=4)};function Dj(nt,_e){if(!I$4)switch(nt.tailMode){case"hidden":_e=nt.tail;for(var et=null;_e!==null;)_e.alternate!==null&&(et=_e),_e=_e.sibling;et===null?nt.tail=null:et.sibling=null;break;case"collapsed":et=nt.tail;for(var rt=null;et!==null;)et.alternate!==null&&(rt=et),et=et.sibling;rt===null?_e||nt.tail===null?nt.tail=null:nt.tail.sibling=null:rt.sibling=null}}function S$3(nt){var _e=nt.alternate!==null&&nt.alternate.child===nt.child,et=0,rt=0;if(_e)for(var it=nt.child;it!==null;)et|=it.lanes|it.childLanes,rt|=it.subtreeFlags&14680064,rt|=it.flags&14680064,it.return=nt,it=it.sibling;else for(it=nt.child;it!==null;)et|=it.lanes|it.childLanes,rt|=it.subtreeFlags,rt|=it.flags,it.return=nt,it=it.sibling;return nt.subtreeFlags|=rt,nt.childLanes=et,_e}function Ej(nt,_e,et){var rt=_e.pendingProps;switch(wg(_e),_e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$3(_e),null;case 1:return Zf(_e.type)&&$f(),S$3(_e),null;case 3:return rt=_e.stateNode,zh(),E$2(Wf),E$2(H$2),Eh(),rt.pendingContext&&(rt.context=rt.pendingContext,rt.pendingContext=null),(nt===null||nt.child===null)&&(Gg(_e)?_e.flags|=4:nt===null||nt.memoizedState.isDehydrated&&!(_e.flags&256)||(_e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(nt,_e),S$3(_e),null;case 5:Bh(_e);var it=xh(wh.current);if(et=_e.type,nt!==null&&_e.stateNode!=null)Bj(nt,_e,et,rt,it),nt.ref!==_e.ref&&(_e.flags|=512,_e.flags|=2097152);else{if(!rt){if(_e.stateNode===null)throw Error(p$4(166));return S$3(_e),null}if(nt=xh(uh.current),Gg(_e)){rt=_e.stateNode,et=_e.type;var st=_e.memoizedProps;switch(rt[Of]=_e,rt[Pf]=st,nt=(_e.mode&1)!==0,et){case"dialog":D$2("cancel",rt),D$2("close",rt);break;case"iframe":case"object":case"embed":D$2("load",rt);break;case"video":case"audio":for(it=0;it<lf.length;it++)D$2(lf[it],rt);break;case"source":D$2("error",rt);break;case"img":case"image":case"link":D$2("error",rt),D$2("load",rt);break;case"details":D$2("toggle",rt);break;case"input":Za(rt,st),D$2("invalid",rt);break;case"select":rt._wrapperState={wasMultiple:!!st.multiple},D$2("invalid",rt);break;case"textarea":hb(rt,st),D$2("invalid",rt)}ub(et,st),it=null;for(var ot in st)if(st.hasOwnProperty(ot)){var at=st[ot];ot==="children"?typeof at=="string"?rt.textContent!==at&&(st.suppressHydrationWarning!==!0&&Af(rt.textContent,at,nt),it=["children",at]):typeof at=="number"&&rt.textContent!==""+at&&(st.suppressHydrationWarning!==!0&&Af(rt.textContent,at,nt),it=["children",""+at]):ea.hasOwnProperty(ot)&&at!=null&&ot==="onScroll"&&D$2("scroll",rt)}switch(et){case"input":Va(rt),db(rt,st,!0);break;case"textarea":Va(rt),jb(rt);break;case"select":case"option":break;default:typeof st.onClick=="function"&&(rt.onclick=Bf)}rt=it,_e.updateQueue=rt,rt!==null&&(_e.flags|=4)}else{ot=it.nodeType===9?it:it.ownerDocument,nt==="http://www.w3.org/1999/xhtml"&&(nt=kb(et)),nt==="http://www.w3.org/1999/xhtml"?et==="script"?(nt=ot.createElement("div"),nt.innerHTML="<script><\/script>",nt=nt.removeChild(nt.firstChild)):typeof rt.is=="string"?nt=ot.createElement(et,{is:rt.is}):(nt=ot.createElement(et),et==="select"&&(ot=nt,rt.multiple?ot.multiple=!0:rt.size&&(ot.size=rt.size))):nt=ot.createElementNS(nt,et),nt[Of]=_e,nt[Pf]=rt,zj(nt,_e,!1,!1),_e.stateNode=nt;e:{switch(ot=vb(et,rt),et){case"dialog":D$2("cancel",nt),D$2("close",nt),it=rt;break;case"iframe":case"object":case"embed":D$2("load",nt),it=rt;break;case"video":case"audio":for(it=0;it<lf.length;it++)D$2(lf[it],nt);it=rt;break;case"source":D$2("error",nt),it=rt;break;case"img":case"image":case"link":D$2("error",nt),D$2("load",nt),it=rt;break;case"details":D$2("toggle",nt),it=rt;break;case"input":Za(nt,rt),it=Ya(nt,rt),D$2("invalid",nt);break;case"option":it=rt;break;case"select":nt._wrapperState={wasMultiple:!!rt.multiple},it=A$1({},rt,{value:void 0}),D$2("invalid",nt);break;case"textarea":hb(nt,rt),it=gb(nt,rt),D$2("invalid",nt);break;default:it=rt}ub(et,it),at=it;for(st in at)if(at.hasOwnProperty(st)){var lt=at[st];st==="style"?sb(nt,lt):st==="dangerouslySetInnerHTML"?(lt=lt?lt.__html:void 0,lt!=null&&nb(nt,lt)):st==="children"?typeof lt=="string"?(et!=="textarea"||lt!=="")&&ob(nt,lt):typeof lt=="number"&&ob(nt,""+lt):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(ea.hasOwnProperty(st)?lt!=null&&st==="onScroll"&&D$2("scroll",nt):lt!=null&&ta(nt,st,lt,ot))}switch(et){case"input":Va(nt),db(nt,rt,!1);break;case"textarea":Va(nt),jb(nt);break;case"option":rt.value!=null&&nt.setAttribute("value",""+Sa(rt.value));break;case"select":nt.multiple=!!rt.multiple,st=rt.value,st!=null?fb(nt,!!rt.multiple,st,!1):rt.defaultValue!=null&&fb(nt,!!rt.multiple,rt.defaultValue,!0);break;default:typeof it.onClick=="function"&&(nt.onclick=Bf)}switch(et){case"button":case"input":case"select":case"textarea":rt=!!rt.autoFocus;break e;case"img":rt=!0;break e;default:rt=!1}}rt&&(_e.flags|=4)}_e.ref!==null&&(_e.flags|=512,_e.flags|=2097152)}return S$3(_e),null;case 6:if(nt&&_e.stateNode!=null)Cj(nt,_e,nt.memoizedProps,rt);else{if(typeof rt!="string"&&_e.stateNode===null)throw Error(p$4(166));if(et=xh(wh.current),xh(uh.current),Gg(_e)){if(rt=_e.stateNode,et=_e.memoizedProps,rt[Of]=_e,(st=rt.nodeValue!==et)&&(nt=xg,nt!==null))switch(nt.tag){case 3:Af(rt.nodeValue,et,(nt.mode&1)!==0);break;case 5:nt.memoizedProps.suppressHydrationWarning!==!0&&Af(rt.nodeValue,et,(nt.mode&1)!==0)}st&&(_e.flags|=4)}else rt=(et.nodeType===9?et:et.ownerDocument).createTextNode(rt),rt[Of]=_e,_e.stateNode=rt}return S$3(_e),null;case 13:if(E$2(L$3),rt=_e.memoizedState,nt===null||nt.memoizedState!==null&&nt.memoizedState.dehydrated!==null){if(I$4&&yg!==null&&_e.mode&1&&!(_e.flags&128))Hg(),Ig(),_e.flags|=98560,st=!1;else if(st=Gg(_e),rt!==null&&rt.dehydrated!==null){if(nt===null){if(!st)throw Error(p$4(318));if(st=_e.memoizedState,st=st!==null?st.dehydrated:null,!st)throw Error(p$4(317));st[Of]=_e}else Ig(),!(_e.flags&128)&&(_e.memoizedState=null),_e.flags|=4;S$3(_e),st=!1}else zg!==null&&(Fj(zg),zg=null),st=!0;if(!st)return _e.flags&65536?_e:null}return _e.flags&128?(_e.lanes=et,_e):(rt=rt!==null,rt!==(nt!==null&&nt.memoizedState!==null)&&rt&&(_e.child.flags|=8192,_e.mode&1&&(nt===null||L$3.current&1?T$2===0&&(T$2=3):tj())),_e.updateQueue!==null&&(_e.flags|=4),S$3(_e),null);case 4:return zh(),Aj(nt,_e),nt===null&&sf(_e.stateNode.containerInfo),S$3(_e),null;case 10:return ah(_e.type._context),S$3(_e),null;case 17:return Zf(_e.type)&&$f(),S$3(_e),null;case 19:if(E$2(L$3),st=_e.memoizedState,st===null)return S$3(_e),null;if(rt=(_e.flags&128)!==0,ot=st.rendering,ot===null)if(rt)Dj(st,!1);else{if(T$2!==0||nt!==null&&nt.flags&128)for(nt=_e.child;nt!==null;){if(ot=Ch(nt),ot!==null){for(_e.flags|=128,Dj(st,!1),rt=ot.updateQueue,rt!==null&&(_e.updateQueue=rt,_e.flags|=4),_e.subtreeFlags=0,rt=et,et=_e.child;et!==null;)st=et,nt=rt,st.flags&=14680066,ot=st.alternate,ot===null?(st.childLanes=0,st.lanes=nt,st.child=null,st.subtreeFlags=0,st.memoizedProps=null,st.memoizedState=null,st.updateQueue=null,st.dependencies=null,st.stateNode=null):(st.childLanes=ot.childLanes,st.lanes=ot.lanes,st.child=ot.child,st.subtreeFlags=0,st.deletions=null,st.memoizedProps=ot.memoizedProps,st.memoizedState=ot.memoizedState,st.updateQueue=ot.updateQueue,st.type=ot.type,nt=ot.dependencies,st.dependencies=nt===null?null:{lanes:nt.lanes,firstContext:nt.firstContext}),et=et.sibling;return G$1(L$3,L$3.current&1|2),_e.child}nt=nt.sibling}st.tail!==null&&B$2()>Gj&&(_e.flags|=128,rt=!0,Dj(st,!1),_e.lanes=4194304)}else{if(!rt)if(nt=Ch(ot),nt!==null){if(_e.flags|=128,rt=!0,et=nt.updateQueue,et!==null&&(_e.updateQueue=et,_e.flags|=4),Dj(st,!0),st.tail===null&&st.tailMode==="hidden"&&!ot.alternate&&!I$4)return S$3(_e),null}else 2*B$2()-st.renderingStartTime>Gj&&et!==1073741824&&(_e.flags|=128,rt=!0,Dj(st,!1),_e.lanes=4194304);st.isBackwards?(ot.sibling=_e.child,_e.child=ot):(et=st.last,et!==null?et.sibling=ot:_e.child=ot,st.last=ot)}return st.tail!==null?(_e=st.tail,st.rendering=_e,st.tail=_e.sibling,st.renderingStartTime=B$2(),_e.sibling=null,et=L$3.current,G$1(L$3,rt?et&1|2:et&1),_e):(S$3(_e),null);case 22:case 23:return Hj(),rt=_e.memoizedState!==null,nt!==null&&nt.memoizedState!==null!==rt&&(_e.flags|=8192),rt&&_e.mode&1?fj&1073741824&&(S$3(_e),_e.subtreeFlags&6&&(_e.flags|=8192)):S$3(_e),null;case 24:return null;case 25:return null}throw Error(p$4(156,_e.tag))}function Ij(nt,_e){switch(wg(_e),_e.tag){case 1:return Zf(_e.type)&&$f(),nt=_e.flags,nt&65536?(_e.flags=nt&-65537|128,_e):null;case 3:return zh(),E$2(Wf),E$2(H$2),Eh(),nt=_e.flags,nt&65536&&!(nt&128)?(_e.flags=nt&-65537|128,_e):null;case 5:return Bh(_e),null;case 13:if(E$2(L$3),nt=_e.memoizedState,nt!==null&&nt.dehydrated!==null){if(_e.alternate===null)throw Error(p$4(340));Ig()}return nt=_e.flags,nt&65536?(_e.flags=nt&-65537|128,_e):null;case 19:return E$2(L$3),null;case 4:return zh(),null;case 10:return ah(_e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$3=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$4=null;function Lj(nt,_e){var et=nt.ref;if(et!==null)if(typeof et=="function")try{et(null)}catch(rt){W$2(nt,_e,rt)}else et.current=null}function Mj(nt,_e,et){try{et()}catch(rt){W$2(nt,_e,rt)}}var Nj=!1;function Oj(nt,_e){if(Cf=dd,nt=Me$1(),Ne$1(nt)){if("selectionStart"in nt)var et={start:nt.selectionStart,end:nt.selectionEnd};else e:{et=(et=nt.ownerDocument)&&et.defaultView||window;var rt=et.getSelection&&et.getSelection();if(rt&&rt.rangeCount!==0){et=rt.anchorNode;var it=rt.anchorOffset,st=rt.focusNode;rt=rt.focusOffset;try{et.nodeType,st.nodeType}catch{et=null;break e}var ot=0,at=-1,lt=-1,ct=0,ut=0,ht=nt,dt=null;t:for(;;){for(var ft;ht!==et||it!==0&&ht.nodeType!==3||(at=ot+it),ht!==st||rt!==0&&ht.nodeType!==3||(lt=ot+rt),ht.nodeType===3&&(ot+=ht.nodeValue.length),(ft=ht.firstChild)!==null;)dt=ht,ht=ft;for(;;){if(ht===nt)break t;if(dt===et&&++ct===it&&(at=ot),dt===st&&++ut===rt&&(lt=ot),(ft=ht.nextSibling)!==null)break;ht=dt,dt=ht.parentNode}ht=ft}et=at===-1||lt===-1?null:{start:at,end:lt}}else et=null}et=et||{start:0,end:0}}else et=null;for(Df={focusedElem:nt,selectionRange:et},dd=!1,V$4=_e;V$4!==null;)if(_e=V$4,nt=_e.child,(_e.subtreeFlags&1028)!==0&&nt!==null)nt.return=_e,V$4=nt;else for(;V$4!==null;){_e=V$4;try{var pt=_e.alternate;if(_e.flags&1024)switch(_e.tag){case 0:case 11:case 15:break;case 1:if(pt!==null){var mt=pt.memoizedProps,At=pt.memoizedState,gt=_e.stateNode,bt=gt.getSnapshotBeforeUpdate(_e.elementType===_e.type?mt:Ci(_e.type,mt),At);gt.__reactInternalSnapshotBeforeUpdate=bt}break;case 3:var Tt=_e.stateNode.containerInfo;Tt.nodeType===1?Tt.textContent="":Tt.nodeType===9&&Tt.documentElement&&Tt.removeChild(Tt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$4(163))}}catch(wt){W$2(_e,_e.return,wt)}if(nt=_e.sibling,nt!==null){nt.return=_e.return,V$4=nt;break}V$4=_e.return}return pt=Nj,Nj=!1,pt}function Pj(nt,_e,et){var rt=_e.updateQueue;if(rt=rt!==null?rt.lastEffect:null,rt!==null){var it=rt=rt.next;do{if((it.tag&nt)===nt){var st=it.destroy;it.destroy=void 0,st!==void 0&&Mj(_e,et,st)}it=it.next}while(it!==rt)}}function Qj(nt,_e){if(_e=_e.updateQueue,_e=_e!==null?_e.lastEffect:null,_e!==null){var et=_e=_e.next;do{if((et.tag&nt)===nt){var rt=et.create;et.destroy=rt()}et=et.next}while(et!==_e)}}function Rj(nt){var _e=nt.ref;if(_e!==null){var et=nt.stateNode;switch(nt.tag){case 5:nt=et;break;default:nt=et}typeof _e=="function"?_e(nt):_e.current=nt}}function Sj(nt){var _e=nt.alternate;_e!==null&&(nt.alternate=null,Sj(_e)),nt.child=null,nt.deletions=null,nt.sibling=null,nt.tag===5&&(_e=nt.stateNode,_e!==null&&(delete _e[Of],delete _e[Pf],delete _e[of],delete _e[Qf],delete _e[Rf])),nt.stateNode=null,nt.return=null,nt.dependencies=null,nt.memoizedProps=null,nt.memoizedState=null,nt.pendingProps=null,nt.stateNode=null,nt.updateQueue=null}function Tj(nt){return nt.tag===5||nt.tag===3||nt.tag===4}function Uj(nt){e:for(;;){for(;nt.sibling===null;){if(nt.return===null||Tj(nt.return))return null;nt=nt.return}for(nt.sibling.return=nt.return,nt=nt.sibling;nt.tag!==5&&nt.tag!==6&&nt.tag!==18;){if(nt.flags&2||nt.child===null||nt.tag===4)continue e;nt.child.return=nt,nt=nt.child}if(!(nt.flags&2))return nt.stateNode}}function Vj(nt,_e,et){var rt=nt.tag;if(rt===5||rt===6)nt=nt.stateNode,_e?et.nodeType===8?et.parentNode.insertBefore(nt,_e):et.insertBefore(nt,_e):(et.nodeType===8?(_e=et.parentNode,_e.insertBefore(nt,et)):(_e=et,_e.appendChild(nt)),et=et._reactRootContainer,et!=null||_e.onclick!==null||(_e.onclick=Bf));else if(rt!==4&&(nt=nt.child,nt!==null))for(Vj(nt,_e,et),nt=nt.sibling;nt!==null;)Vj(nt,_e,et),nt=nt.sibling}function Wj(nt,_e,et){var rt=nt.tag;if(rt===5||rt===6)nt=nt.stateNode,_e?et.insertBefore(nt,_e):et.appendChild(nt);else if(rt!==4&&(nt=nt.child,nt!==null))for(Wj(nt,_e,et),nt=nt.sibling;nt!==null;)Wj(nt,_e,et),nt=nt.sibling}var X$1=null,Xj=!1;function Yj(nt,_e,et){for(et=et.child;et!==null;)Zj(nt,_e,et),et=et.sibling}function Zj(nt,_e,et){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,et)}catch{}switch(et.tag){case 5:U$3||Lj(et,_e);case 6:var rt=X$1,it=Xj;X$1=null,Yj(nt,_e,et),X$1=rt,Xj=it,X$1!==null&&(Xj?(nt=X$1,et=et.stateNode,nt.nodeType===8?nt.parentNode.removeChild(et):nt.removeChild(et)):X$1.removeChild(et.stateNode));break;case 18:X$1!==null&&(Xj?(nt=X$1,et=et.stateNode,nt.nodeType===8?Kf(nt.parentNode,et):nt.nodeType===1&&Kf(nt,et),bd(nt)):Kf(X$1,et.stateNode));break;case 4:rt=X$1,it=Xj,X$1=et.stateNode.containerInfo,Xj=!0,Yj(nt,_e,et),X$1=rt,Xj=it;break;case 0:case 11:case 14:case 15:if(!U$3&&(rt=et.updateQueue,rt!==null&&(rt=rt.lastEffect,rt!==null))){it=rt=rt.next;do{var st=it,ot=st.destroy;st=st.tag,ot!==void 0&&(st&2||st&4)&&Mj(et,_e,ot),it=it.next}while(it!==rt)}Yj(nt,_e,et);break;case 1:if(!U$3&&(Lj(et,_e),rt=et.stateNode,typeof rt.componentWillUnmount=="function"))try{rt.props=et.memoizedProps,rt.state=et.memoizedState,rt.componentWillUnmount()}catch(at){W$2(et,_e,at)}Yj(nt,_e,et);break;case 21:Yj(nt,_e,et);break;case 22:et.mode&1?(U$3=(rt=U$3)||et.memoizedState!==null,Yj(nt,_e,et),U$3=rt):Yj(nt,_e,et);break;default:Yj(nt,_e,et)}}function ak(nt){var _e=nt.updateQueue;if(_e!==null){nt.updateQueue=null;var et=nt.stateNode;et===null&&(et=nt.stateNode=new Kj),_e.forEach(function(rt){var it=bk.bind(null,nt,rt);et.has(rt)||(et.add(rt),rt.then(it,it))})}}function ck(nt,_e){var et=_e.deletions;if(et!==null)for(var rt=0;rt<et.length;rt++){var it=et[rt];try{var st=nt,ot=_e,at=ot;e:for(;at!==null;){switch(at.tag){case 5:X$1=at.stateNode,Xj=!1;break e;case 3:X$1=at.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=at.stateNode.containerInfo,Xj=!0;break e}at=at.return}if(X$1===null)throw Error(p$4(160));Zj(st,ot,it),X$1=null,Xj=!1;var lt=it.alternate;lt!==null&&(lt.return=null),it.return=null}catch(ct){W$2(it,_e,ct)}}if(_e.subtreeFlags&12854)for(_e=_e.child;_e!==null;)dk(_e,nt),_e=_e.sibling}function dk(nt,_e){var et=nt.alternate,rt=nt.flags;switch(nt.tag){case 0:case 11:case 14:case 15:if(ck(_e,nt),ek(nt),rt&4){try{Pj(3,nt,nt.return),Qj(3,nt)}catch(mt){W$2(nt,nt.return,mt)}try{Pj(5,nt,nt.return)}catch(mt){W$2(nt,nt.return,mt)}}break;case 1:ck(_e,nt),ek(nt),rt&512&&et!==null&&Lj(et,et.return);break;case 5:if(ck(_e,nt),ek(nt),rt&512&&et!==null&&Lj(et,et.return),nt.flags&32){var it=nt.stateNode;try{ob(it,"")}catch(mt){W$2(nt,nt.return,mt)}}if(rt&4&&(it=nt.stateNode,it!=null)){var st=nt.memoizedProps,ot=et!==null?et.memoizedProps:st,at=nt.type,lt=nt.updateQueue;if(nt.updateQueue=null,lt!==null)try{at==="input"&&st.type==="radio"&&st.name!=null&&ab(it,st),vb(at,ot);var ct=vb(at,st);for(ot=0;ot<lt.length;ot+=2){var ut=lt[ot],ht=lt[ot+1];ut==="style"?sb(it,ht):ut==="dangerouslySetInnerHTML"?nb(it,ht):ut==="children"?ob(it,ht):ta(it,ut,ht,ct)}switch(at){case"input":bb(it,st);break;case"textarea":ib(it,st);break;case"select":var dt=it._wrapperState.wasMultiple;it._wrapperState.wasMultiple=!!st.multiple;var ft=st.value;ft!=null?fb(it,!!st.multiple,ft,!1):dt!==!!st.multiple&&(st.defaultValue!=null?fb(it,!!st.multiple,st.defaultValue,!0):fb(it,!!st.multiple,st.multiple?[]:"",!1))}it[Pf]=st}catch(mt){W$2(nt,nt.return,mt)}}break;case 6:if(ck(_e,nt),ek(nt),rt&4){if(nt.stateNode===null)throw Error(p$4(162));it=nt.stateNode,st=nt.memoizedProps;try{it.nodeValue=st}catch(mt){W$2(nt,nt.return,mt)}}break;case 3:if(ck(_e,nt),ek(nt),rt&4&&et!==null&&et.memoizedState.isDehydrated)try{bd(_e.containerInfo)}catch(mt){W$2(nt,nt.return,mt)}break;case 4:ck(_e,nt),ek(nt);break;case 13:ck(_e,nt),ek(nt),it=nt.child,it.flags&8192&&(st=it.memoizedState!==null,it.stateNode.isHidden=st,!st||it.alternate!==null&&it.alternate.memoizedState!==null||(fk=B$2())),rt&4&&ak(nt);break;case 22:if(ut=et!==null&&et.memoizedState!==null,nt.mode&1?(U$3=(ct=U$3)||ut,ck(_e,nt),U$3=ct):ck(_e,nt),ek(nt),rt&8192){if(ct=nt.memoizedState!==null,(nt.stateNode.isHidden=ct)&&!ut&&nt.mode&1)for(V$4=nt,ut=nt.child;ut!==null;){for(ht=V$4=ut;V$4!==null;){switch(dt=V$4,ft=dt.child,dt.tag){case 0:case 11:case 14:case 15:Pj(4,dt,dt.return);break;case 1:Lj(dt,dt.return);var pt=dt.stateNode;if(typeof pt.componentWillUnmount=="function"){rt=dt,et=dt.return;try{_e=rt,pt.props=_e.memoizedProps,pt.state=_e.memoizedState,pt.componentWillUnmount()}catch(mt){W$2(rt,et,mt)}}break;case 5:Lj(dt,dt.return);break;case 22:if(dt.memoizedState!==null){gk(ht);continue}}ft!==null?(ft.return=dt,V$4=ft):gk(ht)}ut=ut.sibling}e:for(ut=null,ht=nt;;){if(ht.tag===5){if(ut===null){ut=ht;try{it=ht.stateNode,ct?(st=it.style,typeof st.setProperty=="function"?st.setProperty("display","none","important"):st.display="none"):(at=ht.stateNode,lt=ht.memoizedProps.style,ot=lt!=null&&lt.hasOwnProperty("display")?lt.display:null,at.style.display=rb("display",ot))}catch(mt){W$2(nt,nt.return,mt)}}}else if(ht.tag===6){if(ut===null)try{ht.stateNode.nodeValue=ct?"":ht.memoizedProps}catch(mt){W$2(nt,nt.return,mt)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===nt)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===nt)break e;for(;ht.sibling===null;){if(ht.return===null||ht.return===nt)break e;ut===ht&&(ut=null),ht=ht.return}ut===ht&&(ut=null),ht.sibling.return=ht.return,ht=ht.sibling}}break;case 19:ck(_e,nt),ek(nt),rt&4&&ak(nt);break;case 21:break;default:ck(_e,nt),ek(nt)}}function ek(nt){var _e=nt.flags;if(_e&2){try{e:{for(var et=nt.return;et!==null;){if(Tj(et)){var rt=et;break e}et=et.return}throw Error(p$4(160))}switch(rt.tag){case 5:var it=rt.stateNode;rt.flags&32&&(ob(it,""),rt.flags&=-33);var st=Uj(nt);Wj(nt,st,it);break;case 3:case 4:var ot=rt.stateNode.containerInfo,at=Uj(nt);Vj(nt,at,ot);break;default:throw Error(p$4(161))}}catch(lt){W$2(nt,nt.return,lt)}nt.flags&=-3}_e&4096&&(nt.flags&=-4097)}function hk(nt,_e,et){V$4=nt,ik(nt)}function ik(nt,_e,et){for(var rt=(nt.mode&1)!==0;V$4!==null;){var it=V$4,st=it.child;if(it.tag===22&&rt){var ot=it.memoizedState!==null||Jj;if(!ot){var at=it.alternate,lt=at!==null&&at.memoizedState!==null||U$3;at=Jj;var ct=U$3;if(Jj=ot,(U$3=lt)&&!ct)for(V$4=it;V$4!==null;)ot=V$4,lt=ot.child,ot.tag===22&&ot.memoizedState!==null?jk(it):lt!==null?(lt.return=ot,V$4=lt):jk(it);for(;st!==null;)V$4=st,ik(st),st=st.sibling;V$4=it,Jj=at,U$3=ct}kk(nt)}else it.subtreeFlags&8772&&st!==null?(st.return=it,V$4=st):kk(nt)}}function kk(nt){for(;V$4!==null;){var _e=V$4;if(_e.flags&8772){var et=_e.alternate;try{if(_e.flags&8772)switch(_e.tag){case 0:case 11:case 15:U$3||Qj(5,_e);break;case 1:var rt=_e.stateNode;if(_e.flags&4&&!U$3)if(et===null)rt.componentDidMount();else{var it=_e.elementType===_e.type?et.memoizedProps:Ci(_e.type,et.memoizedProps);rt.componentDidUpdate(it,et.memoizedState,rt.__reactInternalSnapshotBeforeUpdate)}var st=_e.updateQueue;st!==null&&sh(_e,st,rt);break;case 3:var ot=_e.updateQueue;if(ot!==null){if(et=null,_e.child!==null)switch(_e.child.tag){case 5:et=_e.child.stateNode;break;case 1:et=_e.child.stateNode}sh(_e,ot,et)}break;case 5:var at=_e.stateNode;if(et===null&&_e.flags&4){et=at;var lt=_e.memoizedProps;switch(_e.type){case"button":case"input":case"select":case"textarea":lt.autoFocus&&et.focus();break;case"img":lt.src&&(et.src=lt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_e.memoizedState===null){var ct=_e.alternate;if(ct!==null){var ut=ct.memoizedState;if(ut!==null){var ht=ut.dehydrated;ht!==null&&bd(ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$4(163))}U$3||_e.flags&512&&Rj(_e)}catch(dt){W$2(_e,_e.return,dt)}}if(_e===nt){V$4=null;break}if(et=_e.sibling,et!==null){et.return=_e.return,V$4=et;break}V$4=_e.return}}function gk(nt){for(;V$4!==null;){var _e=V$4;if(_e===nt){V$4=null;break}var et=_e.sibling;if(et!==null){et.return=_e.return,V$4=et;break}V$4=_e.return}}function jk(nt){for(;V$4!==null;){var _e=V$4;try{switch(_e.tag){case 0:case 11:case 15:var et=_e.return;try{Qj(4,_e)}catch(lt){W$2(_e,et,lt)}break;case 1:var rt=_e.stateNode;if(typeof rt.componentDidMount=="function"){var it=_e.return;try{rt.componentDidMount()}catch(lt){W$2(_e,it,lt)}}var st=_e.return;try{Rj(_e)}catch(lt){W$2(_e,st,lt)}break;case 5:var ot=_e.return;try{Rj(_e)}catch(lt){W$2(_e,ot,lt)}}}catch(lt){W$2(_e,_e.return,lt)}if(_e===nt){V$4=null;break}var at=_e.sibling;if(at!==null){at.return=_e.return,V$4=at;break}V$4=_e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q$2=null,Y$3=null,Z$1=0,fj=0,ej=Uf(0),T$2=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$2(){return K&6?B$2():Ak!==-1?Ak:Ak=B$2()}function yi(nt){return nt.mode&1?K&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(nt=C$1,nt!==0||(nt=window.event,nt=nt===void 0?16:jd(nt.type)),nt):1}function gi(nt,_e,et,rt){if(50<yk)throw yk=0,zk=null,Error(p$4(185));Ac(nt,et,rt),(!(K&2)||nt!==Q$2)&&(nt===Q$2&&(!(K&2)&&(qk|=et),T$2===4&&Ck(nt,Z$1)),Dk(nt,rt),et===1&&K===0&&!(_e.mode&1)&&(Gj=B$2()+500,fg&&jg()))}function Dk(nt,_e){var et=nt.callbackNode;wc(nt,_e);var rt=uc(nt,nt===Q$2?Z$1:0);if(rt===0)et!==null&&bc(et),nt.callbackNode=null,nt.callbackPriority=0;else if(_e=rt&-rt,nt.callbackPriority!==_e){if(et!=null&&bc(et),_e===1)nt.tag===0?ig(Ek.bind(null,nt)):hg(Ek.bind(null,nt)),Jf(function(){!(K&6)&&jg()}),et=null;else{switch(Dc(rt)){case 1:et=fc;break;case 4:et=gc;break;case 16:et=hc;break;case 536870912:et=jc;break;default:et=hc}et=Fk(et,Gk.bind(null,nt))}nt.callbackPriority=_e,nt.callbackNode=et}}function Gk(nt,_e){if(Ak=-1,Bk=0,K&6)throw Error(p$4(327));var et=nt.callbackNode;if(Hk()&&nt.callbackNode!==et)return null;var rt=uc(nt,nt===Q$2?Z$1:0);if(rt===0)return null;if(rt&30||rt&nt.expiredLanes||_e)_e=Ik(nt,rt);else{_e=rt;var it=K;K|=2;var st=Jk();(Q$2!==nt||Z$1!==_e)&&(uk=null,Gj=B$2()+500,Kk(nt,_e));do try{Lk();break}catch(at){Mk(nt,at)}while(!0);$g(),mk.current=st,K=it,Y$3!==null?_e=0:(Q$2=null,Z$1=0,_e=T$2)}if(_e!==0){if(_e===2&&(it=xc(nt),it!==0&&(rt=it,_e=Nk(nt,it))),_e===1)throw et=pk,Kk(nt,0),Ck(nt,rt),Dk(nt,B$2()),et;if(_e===6)Ck(nt,rt);else{if(it=nt.current.alternate,!(rt&30)&&!Ok(it)&&(_e=Ik(nt,rt),_e===2&&(st=xc(nt),st!==0&&(rt=st,_e=Nk(nt,st))),_e===1))throw et=pk,Kk(nt,0),Ck(nt,rt),Dk(nt,B$2()),et;switch(nt.finishedWork=it,nt.finishedLanes=rt,_e){case 0:case 1:throw Error(p$4(345));case 2:Pk(nt,tk,uk);break;case 3:if(Ck(nt,rt),(rt&130023424)===rt&&(_e=fk+500-B$2(),10<_e)){if(uc(nt,0)!==0)break;if(it=nt.suspendedLanes,(it&rt)!==rt){R$2(),nt.pingedLanes|=nt.suspendedLanes&it;break}nt.timeoutHandle=Ff(Pk.bind(null,nt,tk,uk),_e);break}Pk(nt,tk,uk);break;case 4:if(Ck(nt,rt),(rt&4194240)===rt)break;for(_e=nt.eventTimes,it=-1;0<rt;){var ot=31-oc(rt);st=1<<ot,ot=_e[ot],ot>it&&(it=ot),rt&=~st}if(rt=it,rt=B$2()-rt,rt=(120>rt?120:480>rt?480:1080>rt?1080:1920>rt?1920:3e3>rt?3e3:4320>rt?4320:1960*lk(rt/1960))-rt,10<rt){nt.timeoutHandle=Ff(Pk.bind(null,nt,tk,uk),rt);break}Pk(nt,tk,uk);break;case 5:Pk(nt,tk,uk);break;default:throw Error(p$4(329))}}}return Dk(nt,B$2()),nt.callbackNode===et?Gk.bind(null,nt):null}function Nk(nt,_e){var et=sk;return nt.current.memoizedState.isDehydrated&&(Kk(nt,_e).flags|=256),nt=Ik(nt,_e),nt!==2&&(_e=tk,tk=et,_e!==null&&Fj(_e)),nt}function Fj(nt){tk===null?tk=nt:tk.push.apply(tk,nt)}function Ok(nt){for(var _e=nt;;){if(_e.flags&16384){var et=_e.updateQueue;if(et!==null&&(et=et.stores,et!==null))for(var rt=0;rt<et.length;rt++){var it=et[rt],st=it.getSnapshot;it=it.value;try{if(!He(st(),it))return!1}catch{return!1}}}if(et=_e.child,_e.subtreeFlags&16384&&et!==null)et.return=_e,_e=et;else{if(_e===nt)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===nt)return!0;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}}return!0}function Ck(nt,_e){for(_e&=~rk,_e&=~qk,nt.suspendedLanes|=_e,nt.pingedLanes&=~_e,nt=nt.expirationTimes;0<_e;){var et=31-oc(_e),rt=1<<et;nt[et]=-1,_e&=~rt}}function Ek(nt){if(K&6)throw Error(p$4(327));Hk();var _e=uc(nt,0);if(!(_e&1))return Dk(nt,B$2()),null;var et=Ik(nt,_e);if(nt.tag!==0&&et===2){var rt=xc(nt);rt!==0&&(_e=rt,et=Nk(nt,rt))}if(et===1)throw et=pk,Kk(nt,0),Ck(nt,_e),Dk(nt,B$2()),et;if(et===6)throw Error(p$4(345));return nt.finishedWork=nt.current.alternate,nt.finishedLanes=_e,Pk(nt,tk,uk),Dk(nt,B$2()),null}function Qk(nt,_e){var et=K;K|=1;try{return nt(_e)}finally{K=et,K===0&&(Gj=B$2()+500,fg&&jg())}}function Rk(nt){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var _e=K;K|=1;var et=ok.transition,rt=C$1;try{if(ok.transition=null,C$1=1,nt)return nt()}finally{C$1=rt,ok.transition=et,K=_e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$2(ej)}function Kk(nt,_e){nt.finishedWork=null,nt.finishedLanes=0;var et=nt.timeoutHandle;if(et!==-1&&(nt.timeoutHandle=-1,Gf(et)),Y$3!==null)for(et=Y$3.return;et!==null;){var rt=et;switch(wg(rt),rt.tag){case 1:rt=rt.type.childContextTypes,rt!=null&&$f();break;case 3:zh(),E$2(Wf),E$2(H$2),Eh();break;case 5:Bh(rt);break;case 4:zh();break;case 13:E$2(L$3);break;case 19:E$2(L$3);break;case 10:ah(rt.type._context);break;case 22:case 23:Hj()}et=et.return}if(Q$2=nt,Y$3=nt=Pg(nt.current,null),Z$1=fj=_e,T$2=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(_e=0;_e<fh.length;_e++)if(et=fh[_e],rt=et.interleaved,rt!==null){et.interleaved=null;var it=rt.next,st=et.pending;if(st!==null){var ot=st.next;st.next=it,rt.next=ot}et.pending=rt}fh=null}return nt}function Mk(nt,_e){do{var et=Y$3;try{if($g(),Fh.current=Rh,Ih){for(var rt=M$3.memoizedState;rt!==null;){var it=rt.queue;it!==null&&(it.pending=null),rt=rt.next}Ih=!1}if(Hh=0,O$1=N$3=M$3=null,Jh=!1,Kh=0,nk.current=null,et===null||et.return===null){T$2=1,pk=_e,Y$3=null;break}e:{var st=nt,ot=et.return,at=et,lt=_e;if(_e=Z$1,at.flags|=32768,lt!==null&&typeof lt=="object"&&typeof lt.then=="function"){var ct=lt,ut=at,ht=ut.tag;if(!(ut.mode&1)&&(ht===0||ht===11||ht===15)){var dt=ut.alternate;dt?(ut.updateQueue=dt.updateQueue,ut.memoizedState=dt.memoizedState,ut.lanes=dt.lanes):(ut.updateQueue=null,ut.memoizedState=null)}var ft=Ui(ot);if(ft!==null){ft.flags&=-257,Vi(ft,ot,at,st,_e),ft.mode&1&&Si(st,ct,_e),_e=ft,lt=ct;var pt=_e.updateQueue;if(pt===null){var mt=new Set;mt.add(lt),_e.updateQueue=mt}else pt.add(lt);break e}else{if(!(_e&1)){Si(st,ct,_e),tj();break e}lt=Error(p$4(426))}}else if(I$4&&at.mode&1){var At=Ui(ot);if(At!==null){!(At.flags&65536)&&(At.flags|=256),Vi(At,ot,at,st,_e),Jg(Ji(lt,at));break e}}st=lt=Ji(lt,at),T$2!==4&&(T$2=2),sk===null?sk=[st]:sk.push(st),st=ot;do{switch(st.tag){case 3:st.flags|=65536,_e&=-_e,st.lanes|=_e;var gt=Ni(st,lt,_e);ph(st,gt);break e;case 1:at=lt;var bt=st.type,Tt=st.stateNode;if(!(st.flags&128)&&(typeof bt.getDerivedStateFromError=="function"||Tt!==null&&typeof Tt.componentDidCatch=="function"&&(Ri===null||!Ri.has(Tt)))){st.flags|=65536,_e&=-_e,st.lanes|=_e;var wt=Qi(st,at,_e);ph(st,wt);break e}}st=st.return}while(st!==null)}Sk(et)}catch(Rt){_e=Rt,Y$3===et&&et!==null&&(Y$3=et=et.return);continue}break}while(!0)}function Jk(){var nt=mk.current;return mk.current=Rh,nt===null?Rh:nt}function tj(){(T$2===0||T$2===3||T$2===2)&&(T$2=4),Q$2===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q$2,Z$1)}function Ik(nt,_e){var et=K;K|=2;var rt=Jk();(Q$2!==nt||Z$1!==_e)&&(uk=null,Kk(nt,_e));do try{Tk();break}catch(it){Mk(nt,it)}while(!0);if($g(),K=et,mk.current=rt,Y$3!==null)throw Error(p$4(261));return Q$2=null,Z$1=0,T$2}function Tk(){for(;Y$3!==null;)Uk(Y$3)}function Lk(){for(;Y$3!==null&&!cc();)Uk(Y$3)}function Uk(nt){var _e=Vk(nt.alternate,nt,fj);nt.memoizedProps=nt.pendingProps,_e===null?Sk(nt):Y$3=_e,nk.current=null}function Sk(nt){var _e=nt;do{var et=_e.alternate;if(nt=_e.return,_e.flags&32768){if(et=Ij(et,_e),et!==null){et.flags&=32767,Y$3=et;return}if(nt!==null)nt.flags|=32768,nt.subtreeFlags=0,nt.deletions=null;else{T$2=6,Y$3=null;return}}else if(et=Ej(et,_e,fj),et!==null){Y$3=et;return}if(_e=_e.sibling,_e!==null){Y$3=_e;return}Y$3=_e=nt}while(_e!==null);T$2===0&&(T$2=5)}function Pk(nt,_e,et){var rt=C$1,it=ok.transition;try{ok.transition=null,C$1=1,Wk(nt,_e,et,rt)}finally{ok.transition=it,C$1=rt}return null}function Wk(nt,_e,et,rt){do Hk();while(wk!==null);if(K&6)throw Error(p$4(327));et=nt.finishedWork;var it=nt.finishedLanes;if(et===null)return null;if(nt.finishedWork=null,nt.finishedLanes=0,et===nt.current)throw Error(p$4(177));nt.callbackNode=null,nt.callbackPriority=0;var st=et.lanes|et.childLanes;if(Bc(nt,st),nt===Q$2&&(Y$3=Q$2=null,Z$1=0),!(et.subtreeFlags&2064)&&!(et.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),st=(et.flags&15990)!==0,et.subtreeFlags&15990||st){st=ok.transition,ok.transition=null;var ot=C$1;C$1=1;var at=K;K|=4,nk.current=null,Oj(nt,et),dk(et,nt),Oe(Df),dd=!!Cf,Df=Cf=null,nt.current=et,hk(et),dc(),K=at,C$1=ot,ok.transition=st}else nt.current=et;if(vk&&(vk=!1,wk=nt,xk=it),st=nt.pendingLanes,st===0&&(Ri=null),mc(et.stateNode),Dk(nt,B$2()),_e!==null)for(rt=nt.onRecoverableError,et=0;et<_e.length;et++)it=_e[et],rt(it.value,{componentStack:it.stack,digest:it.digest});if(Oi)throw Oi=!1,nt=Pi,Pi=null,nt;return xk&1&&nt.tag!==0&&Hk(),st=nt.pendingLanes,st&1?nt===zk?yk++:(yk=0,zk=nt):yk=0,jg(),null}function Hk(){if(wk!==null){var nt=Dc(xk),_e=ok.transition,et=C$1;try{if(ok.transition=null,C$1=16>nt?16:nt,wk===null)var rt=!1;else{if(nt=wk,wk=null,xk=0,K&6)throw Error(p$4(331));var it=K;for(K|=4,V$4=nt.current;V$4!==null;){var st=V$4,ot=st.child;if(V$4.flags&16){var at=st.deletions;if(at!==null){for(var lt=0;lt<at.length;lt++){var ct=at[lt];for(V$4=ct;V$4!==null;){var ut=V$4;switch(ut.tag){case 0:case 11:case 15:Pj(8,ut,st)}var ht=ut.child;if(ht!==null)ht.return=ut,V$4=ht;else for(;V$4!==null;){ut=V$4;var dt=ut.sibling,ft=ut.return;if(Sj(ut),ut===ct){V$4=null;break}if(dt!==null){dt.return=ft,V$4=dt;break}V$4=ft}}}var pt=st.alternate;if(pt!==null){var mt=pt.child;if(mt!==null){pt.child=null;do{var At=mt.sibling;mt.sibling=null,mt=At}while(mt!==null)}}V$4=st}}if(st.subtreeFlags&2064&&ot!==null)ot.return=st,V$4=ot;else e:for(;V$4!==null;){if(st=V$4,st.flags&2048)switch(st.tag){case 0:case 11:case 15:Pj(9,st,st.return)}var gt=st.sibling;if(gt!==null){gt.return=st.return,V$4=gt;break e}V$4=st.return}}var bt=nt.current;for(V$4=bt;V$4!==null;){ot=V$4;var Tt=ot.child;if(ot.subtreeFlags&2064&&Tt!==null)Tt.return=ot,V$4=Tt;else e:for(ot=bt;V$4!==null;){if(at=V$4,at.flags&2048)try{switch(at.tag){case 0:case 11:case 15:Qj(9,at)}}catch(Rt){W$2(at,at.return,Rt)}if(at===ot){V$4=null;break e}var wt=at.sibling;if(wt!==null){wt.return=at.return,V$4=wt;break e}V$4=at.return}}if(K=it,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,nt)}catch{}rt=!0}return rt}finally{C$1=et,ok.transition=_e}}return!1}function Xk(nt,_e,et){_e=Ji(et,_e),_e=Ni(nt,_e,1),nt=nh(nt,_e,1),_e=R$2(),nt!==null&&(Ac(nt,1,_e),Dk(nt,_e))}function W$2(nt,_e,et){if(nt.tag===3)Xk(nt,nt,et);else for(;_e!==null;){if(_e.tag===3){Xk(_e,nt,et);break}else if(_e.tag===1){var rt=_e.stateNode;if(typeof _e.type.getDerivedStateFromError=="function"||typeof rt.componentDidCatch=="function"&&(Ri===null||!Ri.has(rt))){nt=Ji(et,nt),nt=Qi(_e,nt,1),_e=nh(_e,nt,1),nt=R$2(),_e!==null&&(Ac(_e,1,nt),Dk(_e,nt));break}}_e=_e.return}}function Ti(nt,_e,et){var rt=nt.pingCache;rt!==null&&rt.delete(_e),_e=R$2(),nt.pingedLanes|=nt.suspendedLanes&et,Q$2===nt&&(Z$1&et)===et&&(T$2===4||T$2===3&&(Z$1&130023424)===Z$1&&500>B$2()-fk?Kk(nt,0):rk|=et),Dk(nt,_e)}function Yk(nt,_e){_e===0&&(nt.mode&1?(_e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):_e=1);var et=R$2();nt=ih(nt,_e),nt!==null&&(Ac(nt,_e,et),Dk(nt,et))}function uj(nt){var _e=nt.memoizedState,et=0;_e!==null&&(et=_e.retryLane),Yk(nt,et)}function bk(nt,_e){var et=0;switch(nt.tag){case 13:var rt=nt.stateNode,it=nt.memoizedState;it!==null&&(et=it.retryLane);break;case 19:rt=nt.stateNode;break;default:throw Error(p$4(314))}rt!==null&&rt.delete(_e),Yk(nt,et)}var Vk;Vk=function(nt,_e,et){if(nt!==null)if(nt.memoizedProps!==_e.pendingProps||Wf.current)dh=!0;else{if(!(nt.lanes&et)&&!(_e.flags&128))return dh=!1,yj(nt,_e,et);dh=!!(nt.flags&131072)}else dh=!1,I$4&&_e.flags&1048576&&ug(_e,ng,_e.index);switch(_e.lanes=0,_e.tag){case 2:var rt=_e.type;ij(nt,_e),nt=_e.pendingProps;var it=Yf(_e,H$2.current);ch(_e,et),it=Nh(null,_e,rt,nt,it,et);var st=Sh();return _e.flags|=1,typeof it=="object"&&it!==null&&typeof it.render=="function"&&it.$$typeof===void 0?(_e.tag=1,_e.memoizedState=null,_e.updateQueue=null,Zf(rt)?(st=!0,cg(_e)):st=!1,_e.memoizedState=it.state!==null&&it.state!==void 0?it.state:null,kh(_e),it.updater=Ei,_e.stateNode=it,it._reactInternals=_e,Ii(_e,rt,nt,et),_e=jj(null,_e,rt,!0,st,et)):(_e.tag=0,I$4&&st&&vg(_e),Xi(null,_e,it,et),_e=_e.child),_e;case 16:rt=_e.elementType;e:{switch(ij(nt,_e),nt=_e.pendingProps,it=rt._init,rt=it(rt._payload),_e.type=rt,it=_e.tag=Zk(rt),nt=Ci(rt,nt),it){case 0:_e=cj(null,_e,rt,nt,et);break e;case 1:_e=hj(null,_e,rt,nt,et);break e;case 11:_e=Yi(null,_e,rt,nt,et);break e;case 14:_e=$i(null,_e,rt,Ci(rt.type,nt),et);break e}throw Error(p$4(306,rt,""))}return _e;case 0:return rt=_e.type,it=_e.pendingProps,it=_e.elementType===rt?it:Ci(rt,it),cj(nt,_e,rt,it,et);case 1:return rt=_e.type,it=_e.pendingProps,it=_e.elementType===rt?it:Ci(rt,it),hj(nt,_e,rt,it,et);case 3:e:{if(kj(_e),nt===null)throw Error(p$4(387));rt=_e.pendingProps,st=_e.memoizedState,it=st.element,lh(nt,_e),qh(_e,rt,null,et);var ot=_e.memoizedState;if(rt=ot.element,st.isDehydrated)if(st={element:rt,isDehydrated:!1,cache:ot.cache,pendingSuspenseBoundaries:ot.pendingSuspenseBoundaries,transitions:ot.transitions},_e.updateQueue.baseState=st,_e.memoizedState=st,_e.flags&256){it=Ji(Error(p$4(423)),_e),_e=lj(nt,_e,rt,et,it);break e}else if(rt!==it){it=Ji(Error(p$4(424)),_e),_e=lj(nt,_e,rt,et,it);break e}else for(yg=Lf(_e.stateNode.containerInfo.firstChild),xg=_e,I$4=!0,zg=null,et=Vg(_e,null,rt,et),_e.child=et;et;)et.flags=et.flags&-3|4096,et=et.sibling;else{if(Ig(),rt===it){_e=Zi(nt,_e,et);break e}Xi(nt,_e,rt,et)}_e=_e.child}return _e;case 5:return Ah(_e),nt===null&&Eg(_e),rt=_e.type,it=_e.pendingProps,st=nt!==null?nt.memoizedProps:null,ot=it.children,Ef(rt,it)?ot=null:st!==null&&Ef(rt,st)&&(_e.flags|=32),gj(nt,_e),Xi(nt,_e,ot,et),_e.child;case 6:return nt===null&&Eg(_e),null;case 13:return oj(nt,_e,et);case 4:return yh(_e,_e.stateNode.containerInfo),rt=_e.pendingProps,nt===null?_e.child=Ug(_e,null,rt,et):Xi(nt,_e,rt,et),_e.child;case 11:return rt=_e.type,it=_e.pendingProps,it=_e.elementType===rt?it:Ci(rt,it),Yi(nt,_e,rt,it,et);case 7:return Xi(nt,_e,_e.pendingProps,et),_e.child;case 8:return Xi(nt,_e,_e.pendingProps.children,et),_e.child;case 12:return Xi(nt,_e,_e.pendingProps.children,et),_e.child;case 10:e:{if(rt=_e.type._context,it=_e.pendingProps,st=_e.memoizedProps,ot=it.value,G$1(Wg,rt._currentValue),rt._currentValue=ot,st!==null)if(He(st.value,ot)){if(st.children===it.children&&!Wf.current){_e=Zi(nt,_e,et);break e}}else for(st=_e.child,st!==null&&(st.return=_e);st!==null;){var at=st.dependencies;if(at!==null){ot=st.child;for(var lt=at.firstContext;lt!==null;){if(lt.context===rt){if(st.tag===1){lt=mh(-1,et&-et),lt.tag=2;var ct=st.updateQueue;if(ct!==null){ct=ct.shared;var ut=ct.pending;ut===null?lt.next=lt:(lt.next=ut.next,ut.next=lt),ct.pending=lt}}st.lanes|=et,lt=st.alternate,lt!==null&&(lt.lanes|=et),bh(st.return,et,_e),at.lanes|=et;break}lt=lt.next}}else if(st.tag===10)ot=st.type===_e.type?null:st.child;else if(st.tag===18){if(ot=st.return,ot===null)throw Error(p$4(341));ot.lanes|=et,at=ot.alternate,at!==null&&(at.lanes|=et),bh(ot,et,_e),ot=st.sibling}else ot=st.child;if(ot!==null)ot.return=st;else for(ot=st;ot!==null;){if(ot===_e){ot=null;break}if(st=ot.sibling,st!==null){st.return=ot.return,ot=st;break}ot=ot.return}st=ot}Xi(nt,_e,it.children,et),_e=_e.child}return _e;case 9:return it=_e.type,rt=_e.pendingProps.children,ch(_e,et),it=eh(it),rt=rt(it),_e.flags|=1,Xi(nt,_e,rt,et),_e.child;case 14:return rt=_e.type,it=Ci(rt,_e.pendingProps),it=Ci(rt.type,it),$i(nt,_e,rt,it,et);case 15:return bj(nt,_e,_e.type,_e.pendingProps,et);case 17:return rt=_e.type,it=_e.pendingProps,it=_e.elementType===rt?it:Ci(rt,it),ij(nt,_e),_e.tag=1,Zf(rt)?(nt=!0,cg(_e)):nt=!1,ch(_e,et),Gi(_e,rt,it),Ii(_e,rt,it,et),jj(null,_e,rt,!0,nt,et);case 19:return xj(nt,_e,et);case 22:return dj(nt,_e,et)}throw Error(p$4(156,_e.tag))};function Fk(nt,_e){return ac(nt,_e)}function $k(nt,_e,et,rt){this.tag=nt,this.key=et,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=rt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(nt,_e,et,rt){return new $k(nt,_e,et,rt)}function aj(nt){return nt=nt.prototype,!(!nt||!nt.isReactComponent)}function Zk(nt){if(typeof nt=="function")return aj(nt)?1:0;if(nt!=null){if(nt=nt.$$typeof,nt===Da)return 11;if(nt===Ga)return 14}return 2}function Pg(nt,_e){var et=nt.alternate;return et===null?(et=Bg(nt.tag,_e,nt.key,nt.mode),et.elementType=nt.elementType,et.type=nt.type,et.stateNode=nt.stateNode,et.alternate=nt,nt.alternate=et):(et.pendingProps=_e,et.type=nt.type,et.flags=0,et.subtreeFlags=0,et.deletions=null),et.flags=nt.flags&14680064,et.childLanes=nt.childLanes,et.lanes=nt.lanes,et.child=nt.child,et.memoizedProps=nt.memoizedProps,et.memoizedState=nt.memoizedState,et.updateQueue=nt.updateQueue,_e=nt.dependencies,et.dependencies=_e===null?null:{lanes:_e.lanes,firstContext:_e.firstContext},et.sibling=nt.sibling,et.index=nt.index,et.ref=nt.ref,et}function Rg(nt,_e,et,rt,it,st){var ot=2;if(rt=nt,typeof nt=="function")aj(nt)&&(ot=1);else if(typeof nt=="string")ot=5;else e:switch(nt){case ya:return Tg(et.children,it,st,_e);case za:ot=8,it|=8;break;case Aa:return nt=Bg(12,et,_e,it|2),nt.elementType=Aa,nt.lanes=st,nt;case Ea:return nt=Bg(13,et,_e,it),nt.elementType=Ea,nt.lanes=st,nt;case Fa:return nt=Bg(19,et,_e,it),nt.elementType=Fa,nt.lanes=st,nt;case Ia:return pj(et,it,st,_e);default:if(typeof nt=="object"&&nt!==null)switch(nt.$$typeof){case Ba:ot=10;break e;case Ca:ot=9;break e;case Da:ot=11;break e;case Ga:ot=14;break e;case Ha:ot=16,rt=null;break e}throw Error(p$4(130,nt==null?nt:typeof nt,""))}return _e=Bg(ot,et,_e,it),_e.elementType=nt,_e.type=rt,_e.lanes=st,_e}function Tg(nt,_e,et,rt){return nt=Bg(7,nt,rt,_e),nt.lanes=et,nt}function pj(nt,_e,et,rt){return nt=Bg(22,nt,rt,_e),nt.elementType=Ia,nt.lanes=et,nt.stateNode={isHidden:!1},nt}function Qg(nt,_e,et){return nt=Bg(6,nt,null,_e),nt.lanes=et,nt}function Sg(nt,_e,et){return _e=Bg(4,nt.children!==null?nt.children:[],nt.key,_e),_e.lanes=et,_e.stateNode={containerInfo:nt.containerInfo,pendingChildren:null,implementation:nt.implementation},_e}function al(nt,_e,et,rt,it){this.tag=_e,this.containerInfo=nt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=rt,this.onRecoverableError=it,this.mutableSourceEagerHydrationData=null}function bl(nt,_e,et,rt,it,st,ot,at,lt){return nt=new al(nt,_e,et,at,lt),_e===1?(_e=1,st===!0&&(_e|=8)):_e=0,st=Bg(3,null,null,_e),nt.current=st,st.stateNode=nt,st.memoizedState={element:rt,isDehydrated:et,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(st),nt}function cl(nt,_e,et){var rt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:rt==null?null:""+rt,children:nt,containerInfo:_e,implementation:et}}function dl(nt){if(!nt)return Vf;nt=nt._reactInternals;e:{if(Vb(nt)!==nt||nt.tag!==1)throw Error(p$4(170));var _e=nt;do{switch(_e.tag){case 3:_e=_e.stateNode.context;break e;case 1:if(Zf(_e.type)){_e=_e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_e=_e.return}while(_e!==null);throw Error(p$4(171))}if(nt.tag===1){var et=nt.type;if(Zf(et))return bg(nt,et,_e)}return _e}function el(nt,_e,et,rt,it,st,ot,at,lt){return nt=bl(et,rt,!0,nt,it,st,ot,at,lt),nt.context=dl(null),et=nt.current,rt=R$2(),it=yi(et),st=mh(rt,it),st.callback=_e??null,nh(et,st,it),nt.current.lanes=it,Ac(nt,it,rt),Dk(nt,rt),nt}function fl(nt,_e,et,rt){var it=_e.current,st=R$2(),ot=yi(it);return et=dl(et),_e.context===null?_e.context=et:_e.pendingContext=et,_e=mh(st,ot),_e.payload={element:nt},rt=rt===void 0?null:rt,rt!==null&&(_e.callback=rt),nt=nh(it,_e,ot),nt!==null&&(gi(nt,it,ot,st),oh(nt,it,ot)),ot}function gl(nt){if(nt=nt.current,!nt.child)return null;switch(nt.child.tag){case 5:return nt.child.stateNode;default:return nt.child.stateNode}}function hl(nt,_e){if(nt=nt.memoizedState,nt!==null&&nt.dehydrated!==null){var et=nt.retryLane;nt.retryLane=et!==0&&et<_e?et:_e}}function il(nt,_e){hl(nt,_e),(nt=nt.alternate)&&hl(nt,_e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(nt){console.error(nt)};function ll(nt){this._internalRoot=nt}ml.prototype.render=ll.prototype.render=function(nt){var _e=this._internalRoot;if(_e===null)throw Error(p$4(409));fl(nt,_e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var nt=this._internalRoot;if(nt!==null){this._internalRoot=null;var _e=nt.containerInfo;Rk(function(){fl(null,nt,null,null)}),_e[uf]=null}};function ml(nt){this._internalRoot=nt}ml.prototype.unstable_scheduleHydration=function(nt){if(nt){var _e=Hc();nt={blockedOn:null,target:nt,priority:_e};for(var et=0;et<Qc.length&&_e!==0&&_e<Qc[et].priority;et++);Qc.splice(et,0,nt),et===0&&Vc(nt)}};function nl(nt){return!(!nt||nt.nodeType!==1&&nt.nodeType!==9&&nt.nodeType!==11)}function ol(nt){return!(!nt||nt.nodeType!==1&&nt.nodeType!==9&&nt.nodeType!==11&&(nt.nodeType!==8||nt.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(nt,_e,et,rt,it){if(it){if(typeof rt=="function"){var st=rt;rt=function(){var ct=gl(ot);st.call(ct)}}var ot=el(_e,rt,nt,0,null,!1,!1,"",pl);return nt._reactRootContainer=ot,nt[uf]=ot.current,sf(nt.nodeType===8?nt.parentNode:nt),Rk(),ot}for(;it=nt.lastChild;)nt.removeChild(it);if(typeof rt=="function"){var at=rt;rt=function(){var ct=gl(lt);at.call(ct)}}var lt=bl(nt,0,!1,null,null,!1,!1,"",pl);return nt._reactRootContainer=lt,nt[uf]=lt.current,sf(nt.nodeType===8?nt.parentNode:nt),Rk(function(){fl(_e,lt,et,rt)}),lt}function rl(nt,_e,et,rt,it){var st=et._reactRootContainer;if(st){var ot=st;if(typeof it=="function"){var at=it;it=function(){var lt=gl(ot);at.call(lt)}}fl(_e,ot,nt,it)}else ot=ql(et,_e,nt,it,rt);return gl(ot)}Ec=function(nt){switch(nt.tag){case 3:var _e=nt.stateNode;if(_e.current.memoizedState.isDehydrated){var et=tc(_e.pendingLanes);et!==0&&(Cc(_e,et|1),Dk(_e,B$2()),!(K&6)&&(Gj=B$2()+500,jg()))}break;case 13:Rk(function(){var rt=ih(nt,1);if(rt!==null){var it=R$2();gi(rt,nt,1,it)}}),il(nt,1)}};Fc=function(nt){if(nt.tag===13){var _e=ih(nt,134217728);if(_e!==null){var et=R$2();gi(_e,nt,134217728,et)}il(nt,134217728)}};Gc=function(nt){if(nt.tag===13){var _e=yi(nt),et=ih(nt,_e);if(et!==null){var rt=R$2();gi(et,nt,_e,rt)}il(nt,_e)}};Hc=function(){return C$1};Ic=function(nt,_e){var et=C$1;try{return C$1=nt,_e()}finally{C$1=et}};yb=function(nt,_e,et){switch(_e){case"input":if(bb(nt,et),_e=et.name,et.type==="radio"&&_e!=null){for(et=nt;et.parentNode;)et=et.parentNode;for(et=et.querySelectorAll("input[name="+JSON.stringify(""+_e)+'][type="radio"]'),_e=0;_e<et.length;_e++){var rt=et[_e];if(rt!==nt&&rt.form===nt.form){var it=Db(rt);if(!it)throw Error(p$4(90));Wa(rt),bb(rt,it)}}}break;case"textarea":ib(nt,et);break;case"select":_e=et.value,_e!=null&&fb(nt,!!et.multiple,_e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(nt){return nt=Zb(nt),nt===null?null:nt.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(nt,_e){var et=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(_e))throw Error(p$4(200));return cl(nt,_e,null,et)};reactDom_production_min.createRoot=function(nt,_e){if(!nl(nt))throw Error(p$4(299));var et=!1,rt="",it=kl;return _e!=null&&(_e.unstable_strictMode===!0&&(et=!0),_e.identifierPrefix!==void 0&&(rt=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(it=_e.onRecoverableError)),_e=bl(nt,1,!1,null,null,et,!1,rt,it),nt[uf]=_e.current,sf(nt.nodeType===8?nt.parentNode:nt),new ll(_e)};reactDom_production_min.findDOMNode=function(nt){if(nt==null)return null;if(nt.nodeType===1)return nt;var _e=nt._reactInternals;if(_e===void 0)throw typeof nt.render=="function"?Error(p$4(188)):(nt=Object.keys(nt).join(","),Error(p$4(268,nt)));return nt=Zb(_e),nt=nt===null?null:nt.stateNode,nt};reactDom_production_min.flushSync=function(nt){return Rk(nt)};reactDom_production_min.hydrate=function(nt,_e,et){if(!ol(_e))throw Error(p$4(200));return rl(null,nt,_e,!0,et)};reactDom_production_min.hydrateRoot=function(nt,_e,et){if(!nl(nt))throw Error(p$4(405));var rt=et!=null&&et.hydratedSources||null,it=!1,st="",ot=kl;if(et!=null&&(et.unstable_strictMode===!0&&(it=!0),et.identifierPrefix!==void 0&&(st=et.identifierPrefix),et.onRecoverableError!==void 0&&(ot=et.onRecoverableError)),_e=el(_e,null,nt,1,et??null,it,!1,st,ot),nt[uf]=_e.current,sf(nt),rt)for(nt=0;nt<rt.length;nt++)et=rt[nt],it=et._getVersion,it=it(et._source),_e.mutableSourceEagerHydrationData==null?_e.mutableSourceEagerHydrationData=[et,it]:_e.mutableSourceEagerHydrationData.push(et,it);return new ml(_e)};reactDom_production_min.render=function(nt,_e,et){if(!ol(_e))throw Error(p$4(200));return rl(null,nt,_e,!1,et)};reactDom_production_min.unmountComponentAtNode=function(nt){if(!ol(nt))throw Error(p$4(40));return nt._reactRootContainer?(Rk(function(){rl(null,null,nt,!1,function(){nt._reactRootContainer=null,nt[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(nt,_e,et,rt){if(!ol(et))throw Error(p$4(200));if(nt==null||nt._reactInternals===void 0)throw Error(p$4(38));return rl(nt,_e,et,!1,rt)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(nt){console.error(nt)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs$1(reactDomExports);var createRoot$1,m$3=reactDomExports;createRoot$1=m$3.createRoot,m$3.hydrateRoot;function setRef(nt,_e){typeof nt=="function"?nt(_e):nt!=null&&(nt.current=_e)}function composeRefs(...nt){return _e=>nt.forEach(et=>setRef(et,_e))}function useComposedRefs(...nt){return reactExports.useCallback(composeRefs(...nt),nt)}var Slot=reactExports.forwardRef((nt,_e)=>{const{children:et,...rt}=nt,it=reactExports.Children.toArray(et),st=it.find(isSlottable);if(st){const ot=st.props.children,at=it.map(lt=>lt===st?reactExports.Children.count(ot)>1?reactExports.Children.only(null):reactExports.isValidElement(ot)?ot.props.children:null:lt);return jsxRuntimeExports.jsx(SlotClone,{...rt,ref:_e,children:reactExports.isValidElement(ot)?reactExports.cloneElement(ot,void 0,at):null})}return jsxRuntimeExports.jsx(SlotClone,{...rt,ref:_e,children:et})});Slot.displayName="Slot";var SlotClone=reactExports.forwardRef((nt,_e)=>{const{children:et,...rt}=nt;if(reactExports.isValidElement(et)){const it=getElementRef$1(et);return reactExports.cloneElement(et,{...mergeProps(rt,et.props),ref:_e?composeRefs(_e,it):it})}return reactExports.Children.count(et)>1?reactExports.Children.only(null):null});SlotClone.displayName="SlotClone";var Slottable=({children:nt})=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:nt});function isSlottable(nt){return reactExports.isValidElement(nt)&&nt.type===Slottable}function mergeProps(nt,_e){const et={..._e};for(const rt in _e){const it=nt[rt],st=_e[rt];/^on[A-Z]/.test(rt)?it&&st?et[rt]=(...at)=>{st(...at),it(...at)}:it&&(et[rt]=it):rt==="style"?et[rt]={...it,...st}:rt==="className"&&(et[rt]=[it,st].filter(Boolean).join(" "))}return{...nt,...et}}function getElementRef$1(nt){var rt,it;let _e=(rt=Object.getOwnPropertyDescriptor(nt.props,"ref"))==null?void 0:rt.get,et=_e&&"isReactWarning"in _e&&_e.isReactWarning;return et?nt.ref:(_e=(it=Object.getOwnPropertyDescriptor(nt,"ref"))==null?void 0:it.get,et=_e&&"isReactWarning"in _e&&_e.isReactWarning,et?nt.props.ref:nt.props.ref||nt.ref)}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Primitive=NODES.reduce((nt,_e)=>{const et=reactExports.forwardRef((rt,it)=>{const{asChild:st,...ot}=rt,at=st?Slot:_e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(at,{...ot,ref:it})});return et.displayName=`Primitive.${_e}`,{...nt,[_e]:et}},{});function dispatchDiscreteCustomEvent(nt,_e){nt&&reactDomExports.flushSync(()=>nt.dispatchEvent(_e))}var useLayoutEffect2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},PORTAL_NAME$1="Portal",Portal$2=reactExports.forwardRef((nt,_e)=>{var at;const{container:et,...rt}=nt,[it,st]=reactExports.useState(!1);useLayoutEffect2(()=>st(!0),[]);const ot=et||it&&((at=globalThis==null?void 0:globalThis.document)==null?void 0:at.body);return ot?ReactDOM.createPortal(jsxRuntimeExports.jsx(Primitive.div,{...rt,ref:_e}),ot):null});Portal$2.displayName=PORTAL_NAME$1;var Root$2=Portal$2,has=Object.prototype.hasOwnProperty;function dequal(nt,_e){var et,rt;if(nt===_e)return!0;if(nt&&_e&&(et=nt.constructor)===_e.constructor){if(et===Date)return nt.getTime()===_e.getTime();if(et===RegExp)return nt.toString()===_e.toString();if(et===Array){if((rt=nt.length)===_e.length)for(;rt--&&dequal(nt[rt],_e[rt]););return rt===-1}if(!et||typeof nt=="object"){rt=0;for(et in nt)if(has.call(nt,et)&&++rt&&!has.call(_e,et)||!(et in _e)||!dequal(nt[et],_e[et]))return!1;return Object.keys(_e).length===rt}}return nt!==nt&&_e!==_e}function shallow(nt,_e){if(Object.is(nt,_e))return!0;if(typeof nt!="object"||nt===null||typeof _e!="object"||_e===null)return!1;const et=Object.keys(nt);if(et.length!==Object.keys(_e).length)return!1;for(let rt=0;rt<et.length;rt++)if(!Object.prototype.hasOwnProperty.call(_e,et[rt])||!Object.is(nt[et[rt]],_e[et[rt]]))return!1;return!0}var Rule=function(_e,et,rt,it){this.name=_e,this.fn=et,this.args=rt,this.modifiers=it};Rule.prototype._test=function(_e){var et=this.fn;try{testAux(this.modifiers.slice(),et,this)(_e)}catch{et=function(){return!1}}try{return testAux(this.modifiers.slice(),et,this)(_e)}catch{return!1}};Rule.prototype._check=function(_e){try{testAux(this.modifiers.slice(),this.fn,this)(_e)}catch{if(testAux(this.modifiers.slice(),function(rt){return rt},this)(!1))return}if(!testAux(this.modifiers.slice(),this.fn,this)(_e))throw null};Rule.prototype._testAsync=function(_e){var et=this;return new Promise(function(rt,it){testAsyncAux(et.modifiers.slice(),et.fn,et)(_e).then(function(st){st?rt(_e):it(null)}).catch(function(st){return it(st)})})};function pickFn(nt,_e){return _e===void 0&&(_e="simple"),typeof nt=="object"?nt[_e]:nt}function testAux(nt,_e,et){if(nt.length){var rt=nt.shift(),it=testAux(nt,_e,et);return rt.perform(it,et)}else return pickFn(_e)}function testAsyncAux(nt,_e,et){if(nt.length){var rt=nt.shift(),it=testAsyncAux(nt,_e,et);return rt.performAsync(it,et)}else return function(st){return Promise.resolve(pickFn(_e,"async")(st))}}var Modifier=function(_e,et,rt){this.name=_e,this.perform=et,this.performAsync=rt},ValidationError=function(nt){function _e(et,rt,it,st){for(var ot=[],at=arguments.length-4;at-- >0;)ot[at]=arguments[at+4];nt.call(this,ot),nt.captureStackTrace&&nt.captureStackTrace(this,_e),this.rule=et,this.value=rt,this.cause=it,this.target=st}return nt&&(_e.__proto__=nt),_e.prototype=Object.create(nt&&nt.prototype),_e.prototype.constructor=_e,_e}(Error),Context$2=function(_e,et){_e===void 0&&(_e=[]),et===void 0&&(et=[]),this.chain=_e,this.nextRuleModifiers=et};Context$2.prototype._applyRule=function(_e,et){var rt=this;return function(){for(var it=[],st=arguments.length;st--;)it[st]=arguments[st];return rt.chain.push(new Rule(et,_e.apply(rt,it),it,rt.nextRuleModifiers)),rt.nextRuleModifiers=[],rt}};Context$2.prototype._applyModifier=function(_e,et){return this.nextRuleModifiers.push(new Modifier(et,_e.simple,_e.async)),this};Context$2.prototype._clone=function(){return new Context$2(this.chain.slice(),this.nextRuleModifiers.slice())};Context$2.prototype.test=function(_e){return this.chain.every(function(et){return et._test(_e)})};Context$2.prototype.testAll=function(_e){var et=[];return this.chain.forEach(function(rt){try{rt._check(_e)}catch(it){et.push(new ValidationError(rt,_e,it))}}),et};Context$2.prototype.check=function(_e){this.chain.forEach(function(et){try{et._check(_e)}catch(rt){throw new ValidationError(et,_e,rt)}})};Context$2.prototype.testAsync=function(_e){var et=this;return new Promise(function(rt,it){executeAsyncRules(_e,et.chain.slice(),rt,it)})};function executeAsyncRules(nt,_e,et,rt){if(_e.length){var it=_e.shift();it._testAsync(nt).then(function(){executeAsyncRules(nt,_e,et,rt)},function(st){rt(new ValidationError(it,nt,st))})}else et(nt)}var consideredEmpty=function(nt,_e){return _e&&typeof nt=="string"&&nt.trim().length===0?!0:nt==null};function optional(nt,_e){return _e===void 0&&(_e=!1),{simple:function(et){return consideredEmpty(et,_e)||nt.check(et)===void 0},async:function(et){return consideredEmpty(et,_e)||nt.testAsync(et)}}}function v8n(){return typeof Proxy<"u"?proxyContext(new Context$2):proxylessContext(new Context$2)}var customRules={};v8n.extend=function(nt){Object.assign(customRules,nt)};v8n.clearCustomRules=function(){customRules={}};function proxyContext(nt){return new Proxy(nt,{get:function(et,rt){if(rt in et)return et[rt];var it=proxyContext(nt._clone());if(rt in availableModifiers)return it._applyModifier(availableModifiers[rt],rt);if(rt in customRules)return it._applyRule(customRules[rt],rt);if(rt in availableRules)return it._applyRule(availableRules[rt],rt)}})}function proxylessContext(nt){var _e=function(it,st){return Object.keys(it).forEach(function(ot){st[ot]=function(){for(var at=[],lt=arguments.length;lt--;)at[lt]=arguments[lt];var ct=proxylessContext(st._clone()),ut=ct._applyRule(it[ot],ot).apply(void 0,at);return ut}}),st},et=_e(availableRules,nt),rt=_e(customRules,et);return Object.keys(availableModifiers).forEach(function(it){Object.defineProperty(rt,it,{get:function(){var st=proxylessContext(rt._clone());return st._applyModifier(availableModifiers[it],it)}})}),rt}var availableModifiers={not:{simple:function(nt){return function(_e){return!nt(_e)}},async:function(nt){return function(_e){return Promise.resolve(nt(_e)).then(function(et){return!et}).catch(function(){return!0})}}},some:{simple:function(nt){return function(_e){return split$1(_e).some(function(et){try{return nt(et)}catch{return!1}})}},async:function(nt){return function(_e){return Promise.all(split$1(_e).map(function(et){try{return nt(et).catch(function(){return!1})}catch{return!1}})).then(function(et){return et.some(Boolean)})}}},every:{simple:function(nt){return function(_e){return _e!==!1&&split$1(_e).every(nt)}},async:function(nt){return function(_e){return Promise.all(split$1(_e).map(nt)).then(function(et){return et.every(Boolean)})}}},strict:{simple:function(nt,_e){return function(et){return isSchemaRule(_e)&&et&&typeof et=="object"?Object.keys(_e.args[0]).length===Object.keys(et).length&&nt(et):nt(et)}},async:function(nt,_e){return function(et){return Promise.resolve(nt(et)).then(function(rt){return isSchemaRule(_e)&&et&&typeof et=="object"?Object.keys(_e.args[0]).length===Object.keys(et).length&&rt:rt}).catch(function(){return!1})}}}};function isSchemaRule(nt){return nt&&nt.name==="schema"&&nt.args.length>0&&typeof nt.args[0]=="object"}function split$1(nt){return typeof nt=="string"?nt.split(""):nt}var availableRules={equal:function(nt){return function(_e){return _e==nt}},exact:function(nt){return function(_e){return _e===nt}},number:function(nt){return nt===void 0&&(nt=!0),function(_e){return typeof _e=="number"&&(nt||isFinite(_e))}},integer:function(){return function(nt){var _e=Number.isInteger||isIntegerPolyfill;return _e(nt)}},numeric:function(){return function(nt){return!isNaN(parseFloat(nt))&&isFinite(nt)}},string:function(){return testType("string")},boolean:function(){return testType("boolean")},undefined:function(){return testType("undefined")},null:function(){return testType("null")},array:function(){return testType("array")},object:function(){return testType("object")},instanceOf:function(nt){return function(_e){return _e instanceof nt}},pattern:function(nt){return function(_e){return nt.test(_e)}},lowercase:function(){return function(nt){return typeof nt=="boolean"||nt===nt.toLowerCase()&&nt.trim()!==""}},uppercase:function(){return function(nt){return nt===nt.toUpperCase()&&nt.trim()!==""}},vowel:function(){return function(nt){return/^[aeiou]+$/i.test(nt)}},consonant:function(){return function(nt){return/^(?=[^aeiou])([a-z]+)$/i.test(nt)}},first:function(nt){return function(_e){return _e[0]==nt}},last:function(nt){return function(_e){return _e[_e.length-1]==nt}},empty:function(){return function(nt){return nt.length===0}},length:function(nt,_e){return function(et){return et.length>=nt&&et.length<=(_e||nt)}},minLength:function(nt){return function(_e){return _e.length>=nt}},maxLength:function(nt){return function(_e){return _e.length<=nt}},negative:function(){return function(nt){return nt<0}},positive:function(){return function(nt){return nt>=0}},between:function(nt,_e){return function(et){return et>=nt&&et<=_e}},range:function(nt,_e){return function(et){return et>=nt&&et<=_e}},lessThan:function(nt){return function(_e){return _e<nt}},lessThanOrEqual:function(nt){return function(_e){return _e<=nt}},greaterThan:function(nt){return function(_e){return _e>nt}},greaterThanOrEqual:function(nt){return function(_e){return _e>=nt}},even:function(){return function(nt){return nt%2===0}},odd:function(){return function(nt){return nt%2!==0}},includes:function(nt){return function(_e){return~_e.indexOf(nt)}},schema:function(nt){return testSchema(nt)},passesAnyOf:function(){for(var nt=[],_e=arguments.length;_e--;)nt[_e]=arguments[_e];return function(et){return nt.some(function(rt){return rt.test(et)})}},optional};function testType(nt){return function(_e){return Array.isArray(_e)&&nt==="array"||_e===null&&nt==="null"||typeof _e===nt}}function isIntegerPolyfill(nt){return typeof nt=="number"&&isFinite(nt)&&Math.floor(nt)===nt}function testSchema(nt){return{simple:function(_e){var et=[];if(Object.keys(nt).forEach(function(rt){var it=nt[rt];try{it.check((_e||{})[rt])}catch(st){st.target=rt,et.push(st)}}),et.length>0)throw et;return!0},async:function(_e){var et=[],rt=Object.keys(nt).map(function(it){var st=nt[it];return st.testAsync((_e||{})[it]).catch(function(ot){ot.target=it,et.push(ot)})});return Promise.all(rt).then(function(){if(et.length>0)throw et;return!0})}}}var e$1="colors",t$1="sizes",r$1="space",n$2={gap:r$1,gridGap:r$1,columnGap:r$1,gridColumnGap:r$1,rowGap:r$1,gridRowGap:r$1,inset:r$1,insetBlock:r$1,insetBlockEnd:r$1,insetBlockStart:r$1,insetInline:r$1,insetInlineEnd:r$1,insetInlineStart:r$1,margin:r$1,marginTop:r$1,marginRight:r$1,marginBottom:r$1,marginLeft:r$1,marginBlock:r$1,marginBlockEnd:r$1,marginBlockStart:r$1,marginInline:r$1,marginInlineEnd:r$1,marginInlineStart:r$1,padding:r$1,paddingTop:r$1,paddingRight:r$1,paddingBottom:r$1,paddingLeft:r$1,paddingBlock:r$1,paddingBlockEnd:r$1,paddingBlockStart:r$1,paddingInline:r$1,paddingInlineEnd:r$1,paddingInlineStart:r$1,top:r$1,right:r$1,bottom:r$1,left:r$1,scrollMargin:r$1,scrollMarginTop:r$1,scrollMarginRight:r$1,scrollMarginBottom:r$1,scrollMarginLeft:r$1,scrollMarginX:r$1,scrollMarginY:r$1,scrollMarginBlock:r$1,scrollMarginBlockEnd:r$1,scrollMarginBlockStart:r$1,scrollMarginInline:r$1,scrollMarginInlineEnd:r$1,scrollMarginInlineStart:r$1,scrollPadding:r$1,scrollPaddingTop:r$1,scrollPaddingRight:r$1,scrollPaddingBottom:r$1,scrollPaddingLeft:r$1,scrollPaddingX:r$1,scrollPaddingY:r$1,scrollPaddingBlock:r$1,scrollPaddingBlockEnd:r$1,scrollPaddingBlockStart:r$1,scrollPaddingInline:r$1,scrollPaddingInlineEnd:r$1,scrollPaddingInlineStart:r$1,fontSize:"fontSizes",background:e$1,backgroundColor:e$1,backgroundImage:e$1,borderImage:e$1,border:e$1,borderBlock:e$1,borderBlockEnd:e$1,borderBlockStart:e$1,borderBottom:e$1,borderBottomColor:e$1,borderColor:e$1,borderInline:e$1,borderInlineEnd:e$1,borderInlineStart:e$1,borderLeft:e$1,borderLeftColor:e$1,borderRight:e$1,borderRightColor:e$1,borderTop:e$1,borderTopColor:e$1,caretColor:e$1,color:e$1,columnRuleColor:e$1,fill:e$1,outline:e$1,outlineColor:e$1,stroke:e$1,textDecorationColor:e$1,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:t$1,minBlockSize:t$1,maxBlockSize:t$1,inlineSize:t$1,minInlineSize:t$1,maxInlineSize:t$1,width:t$1,minWidth:t$1,maxWidth:t$1,height:t$1,minHeight:t$1,maxHeight:t$1,flexBasis:t$1,gridTemplateColumns:t$1,gridTemplateRows:t$1,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i$5=(nt,_e)=>typeof _e=="function"?{"()":Function.prototype.toString.call(_e)}:_e,o$1=()=>{const nt=Object.create(null);return(_e,et,...rt)=>{const it=(st=>JSON.stringify(st,i$5))(_e);return it in nt?nt[it]:nt[it]=et(_e,...rt)}},l$1=Symbol.for("sxs.internal"),s$3=(nt,_e)=>Object.defineProperties(nt,Object.getOwnPropertyDescriptors(_e)),a$1=nt=>{for(const _e in nt)return!0;return!1},{hasOwnProperty:c$2}=Object.prototype,d$2=nt=>nt.includes("-")?nt:nt.replace(/[A-Z]/g,_e=>"-"+_e.toLowerCase()),g$2=/\s+(?![^()]*\))/,p$3=nt=>_e=>nt(...typeof _e=="string"?String(_e).split(g$2):[_e]),u$3={appearance:nt=>({WebkitAppearance:nt,appearance:nt}),backfaceVisibility:nt=>({WebkitBackfaceVisibility:nt,backfaceVisibility:nt}),backdropFilter:nt=>({WebkitBackdropFilter:nt,backdropFilter:nt}),backgroundClip:nt=>({WebkitBackgroundClip:nt,backgroundClip:nt}),boxDecorationBreak:nt=>({WebkitBoxDecorationBreak:nt,boxDecorationBreak:nt}),clipPath:nt=>({WebkitClipPath:nt,clipPath:nt}),content:nt=>({content:nt.includes('"')||nt.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(nt)?nt:`"${nt}"`}),hyphens:nt=>({WebkitHyphens:nt,hyphens:nt}),maskImage:nt=>({WebkitMaskImage:nt,maskImage:nt}),maskSize:nt=>({WebkitMaskSize:nt,maskSize:nt}),tabSize:nt=>({MozTabSize:nt,tabSize:nt}),textSizeAdjust:nt=>({WebkitTextSizeAdjust:nt,textSizeAdjust:nt}),userSelect:nt=>({WebkitUserSelect:nt,userSelect:nt}),marginBlock:p$3((nt,_e)=>({marginBlockStart:nt,marginBlockEnd:_e||nt})),marginInline:p$3((nt,_e)=>({marginInlineStart:nt,marginInlineEnd:_e||nt})),maxSize:p$3((nt,_e)=>({maxBlockSize:nt,maxInlineSize:_e||nt})),minSize:p$3((nt,_e)=>({minBlockSize:nt,minInlineSize:_e||nt})),paddingBlock:p$3((nt,_e)=>({paddingBlockStart:nt,paddingBlockEnd:_e||nt})),paddingInline:p$3((nt,_e)=>({paddingInlineStart:nt,paddingInlineEnd:_e||nt}))},h$2=/([\d.]+)([^]*)/,f$2=(nt,_e)=>nt.length?nt.reduce((et,rt)=>(et.push(..._e.map(it=>it.includes("&")?it.replace(/&/g,/[ +>|~]/.test(rt)&&/&.*&/.test(it)?`:is(${rt})`:rt):rt+" "+it)),et),[]):_e,m$2=(nt,_e)=>nt in b$2&&typeof _e=="string"?_e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(et,rt,it,st)=>rt+(it==="stretch"?`-moz-available${st};${d$2(nt)}:${rt}-webkit-fill-available`:`-moz-fit-content${st};${d$2(nt)}:${rt}fit-content`)+st):String(_e),b$2={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},S$2=nt=>nt?nt+"-":"",k$2=(nt,_e,et)=>nt.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(rt,it,st,ot,at)=>ot=="$"==!!st?rt:(it||ot=="--"?"calc(":"")+"var(--"+(ot==="$"?S$2(_e)+(at.includes("$")?"":S$2(et))+at.replace(/\$/g,"-"):at)+")"+(it||ot=="--"?"*"+(it||"")+(st||"1")+")":"")),y$2=/\s*,\s*(?![^()]*\))/,B$1=Object.prototype.toString,$$2=(nt,_e,et,rt,it)=>{let st,ot,at;const lt=(ct,ut,ht)=>{let dt,ft;const pt=mt=>{for(dt in mt){const bt=dt.charCodeAt(0)===64,Tt=bt&&Array.isArray(mt[dt])?mt[dt]:[mt[dt]];for(ft of Tt){const wt=/[A-Z]/.test(gt=dt)?gt:gt.replace(/-[^]/g,It=>It[1].toUpperCase()),Rt=typeof ft=="object"&&ft&&ft.toString===B$1&&(!rt.utils[wt]||!ut.length);if(wt in rt.utils&&!Rt){const It=rt.utils[wt];if(It!==ot){ot=It,pt(It(ft)),ot=null;continue}}else if(wt in u$3){const It=u$3[wt];if(It!==at){at=It,pt(It(ft)),at=null;continue}}if(bt&&(At=dt.slice(1)in rt.media?"@media "+rt.media[dt.slice(1)]:dt,dt=At.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(It,Lt,$t,kt,Dt,Ot)=>{const zt=h$2.test(Lt),Ht=.0625*(zt?-1:1),[Yt,Xt]=zt?[kt,Lt]:[Lt,kt];return"("+($t[0]==="="?"":$t[0]===">"===zt?"max-":"min-")+Yt+":"+($t[0]!=="="&&$t.length===1?Xt.replace(h$2,(Zt,rn,Gt)=>Number(rn)+Ht*($t===">"?1:-1)+Gt):Xt)+(Dt?") and ("+(Dt[0]===">"?"min-":"max-")+Yt+":"+(Dt.length===1?Ot.replace(h$2,(Zt,rn,Gt)=>Number(rn)+Ht*(Dt===">"?-1:1)+Gt):Ot):"")+")"})),Rt){const It=bt?ht.concat(dt):[...ht],Lt=bt?[...ut]:f$2(ut,dt.split(y$2));st!==void 0&&it(x$1(...st)),st=void 0,lt(ft,Lt,It)}else st===void 0&&(st=[[],ut,ht]),dt=bt||dt.charCodeAt(0)!==36?dt:`--${S$2(rt.prefix)}${dt.slice(1).replace(/\$/g,"-")}`,ft=Rt?ft:typeof ft=="number"?ft&&wt in I$3?String(ft)+"px":String(ft):k$2(m$2(wt,ft??""),rt.prefix,rt.themeMap[wt]),st[0].push(`${bt?`${dt} `:`${d$2(dt)}:`}${ft}`)}}var At,gt};pt(ct),st!==void 0&&it(x$1(...st)),st=void 0};lt(nt,_e,et)},x$1=(nt,_e,et)=>`${et.map(rt=>`${rt}{`).join("")}${_e.length?`${_e.join(",")}{`:""}${nt.join(";")}${_e.length?"}":""}${Array(et.length?et.length+1:0).join("}")}`,I$3={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},R$1=nt=>String.fromCharCode(nt+(nt>25?39:97)),z$1=nt=>(_e=>{let et,rt="";for(et=Math.abs(_e);et>52;et=et/52|0)rt=R$1(et%52)+rt;return R$1(et%52)+rt})(((_e,et)=>{let rt=et.length;for(;rt;)_e=33*_e^et.charCodeAt(--rt);return _e})(5381,JSON.stringify(nt))>>>0),W$1=["themed","global","styled","onevar","resonevar","allvar","inline"],j$1=nt=>{if(nt.href&&!nt.href.startsWith(location.origin))return!1;try{return!!nt.cssRules}catch{return!1}},E$1=nt=>{let _e;const et=()=>{const{cssRules:it}=_e.sheet;return[].map.call(it,(st,ot)=>{const{cssText:at}=st;let lt="";if(at.startsWith("--sxs"))return"";if(it[ot-1]&&(lt=it[ot-1].cssText).startsWith("--sxs")){if(!st.cssRules.length)return"";for(const ct in _e.rules)if(_e.rules[ct].group===st)return`--sxs{--sxs:${[..._e.rules[ct].cache].join(" ")}}${at}`;return st.cssRules.length?`${lt}${at}`:""}return at}).join("")},rt=()=>{if(_e){const{rules:at,sheet:lt}=_e;if(!lt.deleteRule){for(;Object(Object(lt.cssRules)[0]).type===3;)lt.cssRules.splice(0,1);lt.cssRules=[]}for(const ct in at)delete at[ct]}const it=Object(nt).styleSheets||[];for(const at of it)if(j$1(at)){for(let lt=0,ct=at.cssRules;ct[lt];++lt){const ut=Object(ct[lt]);if(ut.type!==1)continue;const ht=Object(ct[lt+1]);if(ht.type!==4)continue;++lt;const{cssText:dt}=ut;if(!dt.startsWith("--sxs"))continue;const ft=dt.slice(14,-3).trim().split(/\s+/),pt=W$1[ft[0]];pt&&(_e||(_e={sheet:at,reset:rt,rules:{},toString:et}),_e.rules[pt]={group:ht,index:lt,cache:new Set(ft)})}if(_e)break}if(!_e){const at=(lt,ct)=>({type:ct,cssRules:[],insertRule(ut,ht){this.cssRules.splice(ht,0,at(ut,{import:3,undefined:1}[(ut.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return lt==="@media{}"?`@media{${[].map.call(this.cssRules,ut=>ut.cssText).join("")}}`:lt}});_e={sheet:nt?(nt.head||nt).appendChild(document.createElement("style")).sheet:at("","text/css"),rules:{},reset:rt,toString:et}}const{sheet:st,rules:ot}=_e;for(let at=W$1.length-1;at>=0;--at){const lt=W$1[at];if(!ot[lt]){const ct=W$1[at+1],ut=ot[ct]?ot[ct].index:st.cssRules.length;st.insertRule("@media{}",ut),st.insertRule(`--sxs{--sxs:${at}}`,ut),ot[lt]={group:st.cssRules[ut+1],index:ut,cache:new Set([at])}}v$3(ot[lt])}};return rt(),_e},v$3=nt=>{const _e=nt.group;let et=_e.cssRules.length;nt.apply=rt=>{try{_e.insertRule(rt,et),++et}catch{}}},T$1=Symbol(),w$1=o$1(),M$2=(nt,_e)=>w$1(nt,()=>(...et)=>{let rt={type:null,composers:new Set};for(const it of et)if(it!=null)if(it[l$1]){rt.type==null&&(rt.type=it[l$1].type);for(const st of it[l$1].composers)rt.composers.add(st)}else it.constructor!==Object||it.$$typeof?rt.type==null&&(rt.type=it):rt.composers.add(C(it,nt));return rt.type==null&&(rt.type="span"),rt.composers.size||rt.composers.add(["PJLV",{},[],[],{},[]]),P(nt,rt,_e)}),C=({variants:nt,compoundVariants:_e,defaultVariants:et,...rt},it)=>{const st=`${S$2(it.prefix)}c-${z$1(rt)}`,ot=[],at=[],lt=Object.create(null),ct=[];for(const dt in et)lt[dt]=String(et[dt]);if(typeof nt=="object"&&nt)for(const dt in nt){ut=lt,ht=dt,c$2.call(ut,ht)||(lt[dt]="undefined");const ft=nt[dt];for(const pt in ft){const mt={[dt]:String(pt)};String(pt)==="undefined"&&ct.push(dt);const At=ft[pt],gt=[mt,At,!a$1(At)];ot.push(gt)}}var ut,ht;if(typeof _e=="object"&&_e)for(const dt of _e){let{css:ft,...pt}=dt;ft=typeof ft=="object"&&ft||{};for(const At in pt)pt[At]=String(pt[At]);const mt=[pt,ft,!a$1(ft)];at.push(mt)}return[st,rt,ot,at,lt,ct]},P=(nt,_e,et)=>{const[rt,it,st,ot]=L$2(_e.composers),at=typeof _e.type=="function"||_e.type.$$typeof?(ht=>{function dt(){for(let ft=0;ft<dt[T$1].length;ft++){const[pt,mt]=dt[T$1][ft];ht.rules[pt].apply(mt)}return dt[T$1]=[],null}return dt[T$1]=[],dt.rules={},W$1.forEach(ft=>dt.rules[ft]={apply:pt=>dt[T$1].push([ft,pt])}),dt})(et):null,lt=(at||et).rules,ct=`.${rt}${it.length>1?`:where(.${it.slice(1).join(".")})`:""}`,ut=ht=>{ht=typeof ht=="object"&&ht||A;const{css:dt,...ft}=ht,pt={};for(const gt in st)if(delete ft[gt],gt in ht){let bt=ht[gt];typeof bt=="object"&&bt?pt[gt]={"@initial":st[gt],...bt}:(bt=String(bt),pt[gt]=bt!=="undefined"||ot.has(gt)?bt:st[gt])}else pt[gt]=st[gt];const mt=new Set([...it]);for(const[gt,bt,Tt,wt]of _e.composers){et.rules.styled.cache.has(gt)||(et.rules.styled.cache.add(gt),$$2(bt,[`.${gt}`],[],nt,Lt=>{lt.styled.apply(Lt)}));const Rt=O(Tt,pt,nt.media),It=O(wt,pt,nt.media,!0);for(const Lt of Rt)if(Lt!==void 0)for(const[$t,kt,Dt]of Lt){const Ot=`${gt}-${z$1(kt)}-${$t}`;mt.add(Ot);const zt=(Dt?et.rules.resonevar:et.rules.onevar).cache,Ht=Dt?lt.resonevar:lt.onevar;zt.has(Ot)||(zt.add(Ot),$$2(kt,[`.${Ot}`],[],nt,Yt=>{Ht.apply(Yt)}))}for(const Lt of It)if(Lt!==void 0)for(const[$t,kt]of Lt){const Dt=`${gt}-${z$1(kt)}-${$t}`;mt.add(Dt),et.rules.allvar.cache.has(Dt)||(et.rules.allvar.cache.add(Dt),$$2(kt,[`.${Dt}`],[],nt,Ot=>{lt.allvar.apply(Ot)}))}}if(typeof dt=="object"&&dt){const gt=`${rt}-i${z$1(dt)}-css`;mt.add(gt),et.rules.inline.cache.has(gt)||(et.rules.inline.cache.add(gt),$$2(dt,[`.${gt}`],[],nt,bt=>{lt.inline.apply(bt)}))}for(const gt of String(ht.className||"").trim().split(/\s+/))gt&&mt.add(gt);const At=ft.className=[...mt].join(" ");return{type:_e.type,className:At,selector:ct,props:ft,toString:()=>At,deferredInjector:at}};return s$3(ut,{className:rt,selector:ct,[l$1]:_e,toString:()=>(et.rules.styled.cache.has(rt)||ut(),rt)})},L$2=nt=>{let _e="";const et=[],rt={},it=[];for(const[st,,,,ot,at]of nt){_e===""&&(_e=st),et.push(st),it.push(...at);for(const lt in ot){const ct=ot[lt];(rt[lt]===void 0||ct!=="undefined"||at.includes(ct))&&(rt[lt]=ct)}}return[_e,et,rt,new Set(it)]},O=(nt,_e,et,rt)=>{const it=[];e:for(let[st,ot,at]of nt){if(at)continue;let lt,ct=0,ut=!1;for(lt in st){const ht=st[lt];let dt=_e[lt];if(dt!==ht){if(typeof dt!="object"||!dt)continue e;{let ft,pt,mt=0;for(const At in dt){if(ht===String(dt[At])){if(At!=="@initial"){const gt=At.slice(1);(pt=pt||[]).push(gt in et?et[gt]:At.replace(/^@media ?/,"")),ut=!0}ct+=mt,ft=!0}++mt}if(pt&&pt.length&&(ot={["@media "+pt.join(", ")]:ot}),!ft)continue e}}}(it[ct]=it[ct]||[]).push([rt?"cv":`${lt}-${st[lt]}`,ot,ut])}return it},A={},N$2=o$1(),D$1=(nt,_e)=>N$2(nt,()=>(...et)=>{const rt=()=>{for(let it of et){it=typeof it=="object"&&it||{};let st=z$1(it);if(!_e.rules.global.cache.has(st)){if(_e.rules.global.cache.add(st),"@import"in it){let ot=[].indexOf.call(_e.sheet.cssRules,_e.rules.themed.group)-1;for(let at of[].concat(it["@import"]))at=at.includes('"')||at.includes("'")?at:`"${at}"`,_e.sheet.insertRule(`@import ${at};`,ot++);delete it["@import"]}$$2(it,[],[],nt,ot=>{_e.rules.global.apply(ot)})}}return""};return s$3(rt,{toString:rt})}),H$1=o$1(),V$3=(nt,_e)=>H$1(nt,()=>et=>{const rt=`${S$2(nt.prefix)}k-${z$1(et)}`,it=()=>{if(!_e.rules.global.cache.has(rt)){_e.rules.global.cache.add(rt);const st=[];$$2(et,[],[],nt,at=>st.push(at));const ot=`@keyframes ${rt}{${st.join("")}}`;_e.rules.global.apply(ot)}return rt};return s$3(it,{get name(){return it()},toString:it})}),G=class{constructor(nt,_e,et,rt){this.token=nt==null?"":String(nt),this.value=_e==null?"":String(_e),this.scale=et==null?"":String(et),this.prefix=rt==null?"":String(rt)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+S$2(this.prefix)+S$2(this.scale)+this.token}toString(){return this.computedValue}},F$1=o$1(),J$1=(nt,_e)=>F$1(nt,()=>(et,rt)=>{rt=typeof et=="object"&&et||Object(rt);const it=`.${et=(et=typeof et=="string"?et:"")||`${S$2(nt.prefix)}t-${z$1(rt)}`}`,st={},ot=[];for(const lt in rt){st[lt]={};for(const ct in rt[lt]){const ut=`--${S$2(nt.prefix)}${lt}-${ct}`,ht=k$2(String(rt[lt][ct]),nt.prefix,lt);st[lt][ct]=new G(ct,ht,lt,nt.prefix),ot.push(`${ut}:${ht}`)}}const at=()=>{if(ot.length&&!_e.rules.themed.cache.has(et)){_e.rules.themed.cache.add(et);const lt=`${rt===nt.theme?":root,":""}.${et}{${ot.join(";")}}`;_e.rules.themed.apply(lt)}return et};return{...st,get className(){return at()},selector:it,toString:at}}),U$2=o$1(),Y$2=o$1(),q$1=nt=>{const _e=(et=>{let rt=!1;const it=U$2(et,st=>{rt=!0;const ot="prefix"in(st=typeof st=="object"&&st||{})?String(st.prefix):"",at=typeof st.media=="object"&&st.media||{},lt=typeof st.root=="object"?st.root||null:globalThis.document||null,ct=typeof st.theme=="object"&&st.theme||{},ut={prefix:ot,media:at,theme:ct,themeMap:typeof st.themeMap=="object"&&st.themeMap||{...n$2},utils:typeof st.utils=="object"&&st.utils||{}},ht=E$1(lt),dt={css:M$2(ut,ht),globalCss:D$1(ut,ht),keyframes:V$3(ut,ht),createTheme:J$1(ut,ht),reset(){ht.reset(),dt.theme.toString()},theme:{},sheet:ht,config:ut,prefix:ot,getCssText:ht.toString,toString:ht.toString};return String(dt.theme=dt.createTheme(ct)),dt});return rt||it.reset(),it})(nt);return _e.styled=(({config:et,sheet:rt})=>Y$2(et,()=>{const it=M$2(et,rt);return(...st)=>{const ot=it(...st),at=ot[l$1].type,lt=React.forwardRef((ct,ut)=>{const ht=ct&&ct.as||at,{props:dt,deferredInjector:ft}=ot(ct);return delete dt.as,dt.ref=ut,ft?React.createElement(React.Fragment,null,React.createElement(ht,dt),React.createElement(ft,null)):React.createElement(ht,dt)});return lt.className=ot.className,lt.displayName=`Styled.${at.displayName||at.name||at}`,lt.selector=ot.selector,lt.toString=()=>ot.selector,lt[l$1]=ot[l$1],lt}}))(_e),_e};function clamp$8(nt,_e,et){return Math.max(_e,Math.min(nt,et))}const V$2={toVector(nt,_e){return nt===void 0&&(nt=_e),Array.isArray(nt)?nt:[nt,nt]},add(nt,_e){return[nt[0]+_e[0],nt[1]+_e[1]]},sub(nt,_e){return[nt[0]-_e[0],nt[1]-_e[1]]},addTo(nt,_e){nt[0]+=_e[0],nt[1]+=_e[1]},subTo(nt,_e){nt[0]-=_e[0],nt[1]-=_e[1]}};function rubberband(nt,_e,et){return _e===0||Math.abs(_e)===1/0?Math.pow(nt,et*5):nt*_e*et/(_e+et*nt)}function rubberbandIfOutOfBounds(nt,_e,et,rt=.15){return rt===0?clamp$8(nt,_e,et):nt<_e?-rubberband(_e-nt,et-_e,rt)+_e:nt>et?+rubberband(nt-et,et-_e,rt)+et:nt}function computeRubberband(nt,[_e,et],[rt,it]){const[[st,ot],[at,lt]]=nt;return[rubberbandIfOutOfBounds(_e,st,ot,rt),rubberbandIfOutOfBounds(et,at,lt,it)]}function _toPrimitive$7(nt,_e){if(typeof nt!="object"||nt===null)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey$7(nt){var _e=_toPrimitive$7(nt,"string");return typeof _e=="symbol"?_e:String(_e)}function _defineProperty$a(nt,_e,et){return _e=_toPropertyKey$7(_e),_e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function ownKeys$7(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread2$5(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$7(Object(et),!0).forEach(function(rt){_defineProperty$a(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$7(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}const EVENT_TYPE_MAP={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(nt){return nt?nt[0].toUpperCase()+nt.slice(1):""}const actionsWithoutCaptureSupported=["enter","leave"];function hasCapture(nt=!1,_e){return nt&&!actionsWithoutCaptureSupported.includes(_e)}function toHandlerProp(nt,_e="",et=!1){const rt=EVENT_TYPE_MAP[nt],it=rt&&rt[_e]||_e;return"on"+capitalize(nt)+capitalize(it)+(hasCapture(et,it)?"Capture":"")}const pointerCaptureEvents=["gotpointercapture","lostpointercapture"];function parseProp(nt){let _e=nt.substring(2).toLowerCase();const et=!!~_e.indexOf("passive");et&&(_e=_e.replace("passive",""));const rt=pointerCaptureEvents.includes(_e)?"capturecapture":"capture",it=!!~_e.indexOf(rt);return it&&(_e=_e.replace("capture","")),{device:_e,capture:it,passive:et}}function toDomEventType(nt,_e=""){const et=EVENT_TYPE_MAP[nt],rt=et&&et[_e]||_e;return nt+rt}function isTouch(nt){return"touches"in nt}function getPointerType(nt){return isTouch(nt)?"touch":"pointerType"in nt?nt.pointerType:"mouse"}function getCurrentTargetTouchList(nt){return Array.from(nt.touches).filter(_e=>{var et,rt;return _e.target===nt.currentTarget||((et=nt.currentTarget)===null||et===void 0||(rt=et.contains)===null||rt===void 0?void 0:rt.call(et,_e.target))})}function getTouchList(nt){return nt.type==="touchend"||nt.type==="touchcancel"?nt.changedTouches:nt.targetTouches}function getValueEvent(nt){return isTouch(nt)?getTouchList(nt)[0]:nt}function touchIds(nt){return getCurrentTargetTouchList(nt).map(_e=>_e.identifier)}function pointerId(nt){const _e=getValueEvent(nt);return isTouch(nt)?_e.identifier:_e.pointerId}function pointerValues(nt){const _e=getValueEvent(nt);return[_e.clientX,_e.clientY]}function getEventDetails(nt){const _e={};if("buttons"in nt&&(_e.buttons=nt.buttons),"shiftKey"in nt){const{shiftKey:et,altKey:rt,metaKey:it,ctrlKey:st}=nt;Object.assign(_e,{shiftKey:et,altKey:rt,metaKey:it,ctrlKey:st})}return _e}function call$1(nt,..._e){return typeof nt=="function"?nt(..._e):nt}function noop$4(){}function chain(...nt){return nt.length===0?noop$4:nt.length===1?nt[0]:function(){let _e;for(const et of nt)_e=et.apply(this,arguments)||_e;return _e}}function assignDefault(nt,_e){return Object.assign({},_e,nt||{})}const BEFORE_LAST_KINEMATICS_DELAY=32;class Engine{constructor(_e,et,rt){this.ctrl=_e,this.args=et,this.key=rt,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(_e){this.ctrl.state[this.key]=_e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:_e,shared:et,ingKey:rt,args:it}=this;et[rt]=_e._active=_e.active=_e._blocked=_e._force=!1,_e._step=[!1,!1],_e.intentional=!1,_e._movement=[0,0],_e._distance=[0,0],_e._direction=[0,0],_e._delta=[0,0],_e._bounds=[[-1/0,1/0],[-1/0,1/0]],_e.args=it,_e.axis=void 0,_e.memo=void 0,_e.elapsedTime=_e.timeDelta=0,_e.direction=[0,0],_e.distance=[0,0],_e.overflow=[0,0],_e._movementBound=[!1,!1],_e.velocity=[0,0],_e.movement=[0,0],_e.delta=[0,0],_e.timeStamp=0}start(_e){const et=this.state,rt=this.config;et._active||(this.reset(),this.computeInitial(),et._active=!0,et.target=_e.target,et.currentTarget=_e.currentTarget,et.lastOffset=rt.from?call$1(rt.from,et):et.offset,et.offset=et.lastOffset,et.startTime=et.timeStamp=_e.timeStamp)}computeValues(_e){const et=this.state;et._values=_e,et.values=this.config.transform(_e)}computeInitial(){const _e=this.state;_e._initial=_e._values,_e.initial=_e.values}compute(_e){const{state:et,config:rt,shared:it}=this;et.args=this.args;let st=0;if(_e&&(et.event=_e,rt.preventDefault&&_e.cancelable&&et.event.preventDefault(),et.type=_e.type,it.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,it.locked=!!document.pointerLockElement,Object.assign(it,getEventDetails(_e)),it.down=it.pressed=it.buttons%2===1||it.touches>0,st=_e.timeStamp-et.timeStamp,et.timeStamp=_e.timeStamp,et.elapsedTime=et.timeStamp-et.startTime),et._active){const It=et._delta.map(Math.abs);V$2.addTo(et._distance,It)}this.axisIntent&&this.axisIntent(_e);const[ot,at]=et._movement,[lt,ct]=rt.threshold,{_step:ut,values:ht}=et;if(rt.hasCustomTransform?(ut[0]===!1&&(ut[0]=Math.abs(ot)>=lt&&ht[0]),ut[1]===!1&&(ut[1]=Math.abs(at)>=ct&&ht[1])):(ut[0]===!1&&(ut[0]=Math.abs(ot)>=lt&&Math.sign(ot)*lt),ut[1]===!1&&(ut[1]=Math.abs(at)>=ct&&Math.sign(at)*ct)),et.intentional=ut[0]!==!1||ut[1]!==!1,!et.intentional)return;const dt=[0,0];if(rt.hasCustomTransform){const[It,Lt]=ht;dt[0]=ut[0]!==!1?It-ut[0]:0,dt[1]=ut[1]!==!1?Lt-ut[1]:0}else dt[0]=ut[0]!==!1?ot-ut[0]:0,dt[1]=ut[1]!==!1?at-ut[1]:0;this.restrictToAxis&&!et._blocked&&this.restrictToAxis(dt);const ft=et.offset,pt=et._active&&!et._blocked||et.active;pt&&(et.first=et._active&&!et.active,et.last=!et._active&&et.active,et.active=it[this.ingKey]=et._active,_e&&(et.first&&("bounds"in rt&&(et._bounds=call$1(rt.bounds,et)),this.setup&&this.setup()),et.movement=dt,this.computeOffset()));const[mt,At]=et.offset,[[gt,bt],[Tt,wt]]=et._bounds;et.overflow=[mt<gt?-1:mt>bt?1:0,At<Tt?-1:At>wt?1:0],et._movementBound[0]=et.overflow[0]?et._movementBound[0]===!1?et._movement[0]:et._movementBound[0]:!1,et._movementBound[1]=et.overflow[1]?et._movementBound[1]===!1?et._movement[1]:et._movementBound[1]:!1;const Rt=et._active?rt.rubberband||[0,0]:[0,0];if(et.offset=computeRubberband(et._bounds,et.offset,Rt),et.delta=V$2.sub(et.offset,ft),this.computeMovement(),pt&&(!et.last||st>BEFORE_LAST_KINEMATICS_DELAY)){et.delta=V$2.sub(et.offset,ft);const It=et.delta.map(Math.abs);V$2.addTo(et.distance,It),et.direction=et.delta.map(Math.sign),et._direction=et._delta.map(Math.sign),!et.first&&st>0&&(et.velocity=[It[0]/st,It[1]/st],et.timeDelta=st)}}emit(){const _e=this.state,et=this.shared,rt=this.config;if(_e._active||this.clean(),(_e._blocked||!_e.intentional)&&!_e._force&&!rt.triggerAllEvents)return;const it=this.handler(_objectSpread2$5(_objectSpread2$5(_objectSpread2$5({},et),_e),{},{[this.aliasKey]:_e.values}));it!==void 0&&(_e.memo=it)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function selectAxis([nt,_e],et){const rt=Math.abs(nt),it=Math.abs(_e);if(rt>it&&rt>et)return"x";if(it>rt&&it>et)return"y"}class CoordinatesEngine extends Engine{constructor(..._e){super(..._e),_defineProperty$a(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=V$2.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=V$2.sub(this.state.offset,this.state.lastOffset)}axisIntent(_e){const et=this.state,rt=this.config;if(!et.axis&&_e){const it=typeof rt.axisThreshold=="object"?rt.axisThreshold[getPointerType(_e)]:rt.axisThreshold;et.axis=selectAxis(et._movement,it)}et._blocked=(rt.lockDirection||!!rt.axis)&&!et.axis||!!rt.axis&&rt.axis!==et.axis}restrictToAxis(_e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":_e[1]=0;break;case"y":_e[0]=0;break}}}const identity$3=nt=>nt,DEFAULT_RUBBERBAND=.15,commonConfigResolver={enabled(nt=!0){return nt},eventOptions(nt,_e,et){return _objectSpread2$5(_objectSpread2$5({},et.shared.eventOptions),nt)},preventDefault(nt=!1){return nt},triggerAllEvents(nt=!1){return nt},rubberband(nt=0){switch(nt){case!0:return[DEFAULT_RUBBERBAND,DEFAULT_RUBBERBAND];case!1:return[0,0];default:return V$2.toVector(nt)}},from(nt){if(typeof nt=="function")return nt;if(nt!=null)return V$2.toVector(nt)},transform(nt,_e,et){const rt=nt||et.shared.transform;return this.hasCustomTransform=!!rt,rt||identity$3},threshold(nt){return V$2.toVector(nt,0)}},DEFAULT_AXIS_THRESHOLD=0,coordinatesConfigResolver=_objectSpread2$5(_objectSpread2$5({},commonConfigResolver),{},{axis(nt,_e,{axis:et}){if(this.lockDirection=et==="lock",!this.lockDirection)return et},axisThreshold(nt=DEFAULT_AXIS_THRESHOLD){return nt},bounds(nt={}){if(typeof nt=="function")return st=>coordinatesConfigResolver.bounds(nt(st));if("current"in nt)return()=>nt.current;if(typeof HTMLElement=="function"&&nt instanceof HTMLElement)return nt;const{left:_e=-1/0,right:et=1/0,top:rt=-1/0,bottom:it=1/0}=nt;return[[_e,et],[rt,it]]}}),KEYS_DELTA_MAP={ArrowRight:(nt,_e=1)=>[nt*_e,0],ArrowLeft:(nt,_e=1)=>[-1*nt*_e,0],ArrowUp:(nt,_e=1)=>[0,-1*nt*_e],ArrowDown:(nt,_e=1)=>[0,nt*_e]};class DragEngine extends CoordinatesEngine{constructor(..._e){super(..._e),_defineProperty$a(this,"ingKey","dragging")}reset(){super.reset();const _e=this.state;_e._pointerId=void 0,_e._pointerActive=!1,_e._keyboardActive=!1,_e._preventScroll=!1,_e._delayed=!1,_e.swipe=[0,0],_e.tap=!1,_e.canceled=!1,_e.cancel=this.cancel.bind(this)}setup(){const _e=this.state;if(_e._bounds instanceof HTMLElement){const et=_e._bounds.getBoundingClientRect(),rt=_e.currentTarget.getBoundingClientRect(),it={left:et.left-rt.left+_e.offset[0],right:et.right-rt.right+_e.offset[0],top:et.top-rt.top+_e.offset[1],bottom:et.bottom-rt.bottom+_e.offset[1]};_e._bounds=coordinatesConfigResolver.bounds(it)}}cancel(){const _e=this.state;_e.canceled||(_e.canceled=!0,_e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(_e){const et=this.config,rt=this.state;if(_e.buttons!=null&&(Array.isArray(et.pointerButtons)?!et.pointerButtons.includes(_e.buttons):et.pointerButtons!==-1&&et.pointerButtons!==_e.buttons))return;const it=this.ctrl.setEventIds(_e);et.pointerCapture&&_e.target.setPointerCapture(_e.pointerId),!(it&&it.size>1&&rt._pointerActive)&&(this.start(_e),this.setupPointer(_e),rt._pointerId=pointerId(_e),rt._pointerActive=!0,this.computeValues(pointerValues(_e)),this.computeInitial(),et.preventScrollAxis&&getPointerType(_e)!=="mouse"?(rt._active=!1,this.setupScrollPrevention(_e)):et.delay>0?(this.setupDelayTrigger(_e),et.triggerAllEvents&&(this.compute(_e),this.emit())):this.startPointerDrag(_e))}startPointerDrag(_e){const et=this.state;et._active=!0,et._preventScroll=!0,et._delayed=!1,this.compute(_e),this.emit()}pointerMove(_e){const et=this.state,rt=this.config;if(!et._pointerActive)return;const it=pointerId(_e);if(et._pointerId!==void 0&&it!==et._pointerId)return;const st=pointerValues(_e);if(document.pointerLockElement===_e.target?et._delta=[_e.movementX,_e.movementY]:(et._delta=V$2.sub(st,et._values),this.computeValues(st)),V$2.addTo(et._movement,et._delta),this.compute(_e),et._delayed&&et.intentional){this.timeoutStore.remove("dragDelay"),et.active=!1,this.startPointerDrag(_e);return}if(rt.preventScrollAxis&&!et._preventScroll)if(et.axis)if(et.axis===rt.preventScrollAxis||rt.preventScrollAxis==="xy"){et._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(_e);return}else return;this.emit()}pointerUp(_e){this.ctrl.setEventIds(_e);try{this.config.pointerCapture&&_e.target.hasPointerCapture(_e.pointerId)&&_e.target.releasePointerCapture(_e.pointerId)}catch{}const et=this.state,rt=this.config;if(!et._active||!et._pointerActive)return;const it=pointerId(_e);if(et._pointerId!==void 0&&it!==et._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(_e);const[st,ot]=et._distance;if(et.tap=st<=rt.tapsThreshold&&ot<=rt.tapsThreshold,et.tap&&rt.filterTaps)et._force=!0;else{const[at,lt]=et._delta,[ct,ut]=et._movement,[ht,dt]=rt.swipe.velocity,[ft,pt]=rt.swipe.distance,mt=rt.swipe.duration;if(et.elapsedTime<mt){const At=Math.abs(at/et.timeDelta),gt=Math.abs(lt/et.timeDelta);At>ht&&Math.abs(ct)>ft&&(et.swipe[0]=Math.sign(at)),gt>dt&&Math.abs(ut)>pt&&(et.swipe[1]=Math.sign(lt))}}this.emit()}pointerClick(_e){!this.state.tap&&_e.detail>0&&(_e.preventDefault(),_e.stopPropagation())}setupPointer(_e){const et=this.config,rt=et.device;et.pointerLock&&_e.currentTarget.requestPointerLock(),et.pointerCapture||(this.eventStore.add(this.sharedConfig.window,rt,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,rt,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,rt,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(_e){this.state._preventScroll&&_e.cancelable&&_e.preventDefault()}setupScrollPrevention(_e){this.state._preventScroll=!1,persistEvent(_e);const et=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",et),this.eventStore.add(this.sharedConfig.window,"touch","cancel",et),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,_e)}setupDelayTrigger(_e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(_e)},this.config.delay)}keyDown(_e){const et=KEYS_DELTA_MAP[_e.key];if(et){const rt=this.state,it=_e.shiftKey?10:_e.altKey?.1:1;this.start(_e),rt._delta=et(this.config.keyboardDisplacement,it),rt._keyboardActive=!0,V$2.addTo(rt._movement,rt._delta),this.compute(_e),this.emit()}}keyUp(_e){_e.key in KEYS_DELTA_MAP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(_e),this.emit())}bind(_e){const et=this.config.device;_e(et,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(_e(et,"change",this.pointerMove.bind(this)),_e(et,"end",this.pointerUp.bind(this)),_e(et,"cancel",this.pointerUp.bind(this)),_e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(_e("key","down",this.keyDown.bind(this)),_e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&_e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function persistEvent(nt){"persist"in nt&&typeof nt.persist=="function"&&nt.persist()}const isBrowser$1=typeof window<"u"&&window.document&&window.document.createElement;function supportsTouchEvents(){return isBrowser$1&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||isBrowser$1&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return isBrowser$1&&"onpointerdown"in window}function supportsPointerLock(){return isBrowser$1&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch{return!1}}const SUPPORT={isBrowser:isBrowser$1,gesture:supportsGestureEvents(),touch:supportsTouchEvents(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},DEFAULT_PREVENT_SCROLL_DELAY=250,DEFAULT_DRAG_DELAY=180,DEFAULT_SWIPE_VELOCITY=.5,DEFAULT_SWIPE_DISTANCE=50,DEFAULT_SWIPE_DURATION=250,DEFAULT_KEYBOARD_DISPLACEMENT=10,DEFAULT_DRAG_AXIS_THRESHOLD={mouse:0,touch:0,pen:8},dragConfigResolver=_objectSpread2$5(_objectSpread2$5({},coordinatesConfigResolver),{},{device(nt,_e,{pointer:{touch:et=!1,lock:rt=!1,mouse:it=!1}={}}){return this.pointerLock=rt&&SUPPORT.pointerLock,SUPPORT.touch&&et?"touch":this.pointerLock?"mouse":SUPPORT.pointer&&!it?"pointer":SUPPORT.touch?"touch":"mouse"},preventScrollAxis(nt,_e,{preventScroll:et}){if(this.preventScrollDelay=typeof et=="number"?et:et||et===void 0&&nt?DEFAULT_PREVENT_SCROLL_DELAY:void 0,!(!SUPPORT.touchscreen||et===!1))return nt||(et!==void 0?"y":void 0)},pointerCapture(nt,_e,{pointer:{capture:et=!0,buttons:rt=1,keys:it=!0}={}}){return this.pointerButtons=rt,this.keys=it,!this.pointerLock&&this.device==="pointer"&&et},threshold(nt,_e,{filterTaps:et=!1,tapsThreshold:rt=3,axis:it=void 0}){const st=V$2.toVector(nt,et?rt:it?1:0);return this.filterTaps=et,this.tapsThreshold=rt,st},swipe({velocity:nt=DEFAULT_SWIPE_VELOCITY,distance:_e=DEFAULT_SWIPE_DISTANCE,duration:et=DEFAULT_SWIPE_DURATION}={}){return{velocity:this.transform(V$2.toVector(nt)),distance:this.transform(V$2.toVector(_e)),duration:et}},delay(nt=0){switch(nt){case!0:return DEFAULT_DRAG_DELAY;case!1:return 0;default:return nt}},axisThreshold(nt){return nt?_objectSpread2$5(_objectSpread2$5({},DEFAULT_DRAG_AXIS_THRESHOLD),nt):DEFAULT_DRAG_AXIS_THRESHOLD},keyboardDisplacement(nt=DEFAULT_KEYBOARD_DISPLACEMENT){return nt}});_objectSpread2$5(_objectSpread2$5({},commonConfigResolver),{},{device(nt,_e,{shared:et,pointer:{touch:rt=!1}={}}){if(et.target&&!SUPPORT.touch&&SUPPORT.gesture)return"gesture";if(SUPPORT.touch&&rt)return"touch";if(SUPPORT.touchscreen){if(SUPPORT.pointer)return"pointer";if(SUPPORT.touch)return"touch"}},bounds(nt,_e,{scaleBounds:et={},angleBounds:rt={}}){const it=ot=>{const at=assignDefault(call$1(et,ot),{min:-1/0,max:1/0});return[at.min,at.max]},st=ot=>{const at=assignDefault(call$1(rt,ot),{min:-1/0,max:1/0});return[at.min,at.max]};return typeof et!="function"&&typeof rt!="function"?[it(),st()]:ot=>[it(ot),st(ot)]},threshold(nt,_e,et){return this.lockDirection=et.axis==="lock",V$2.toVector(nt,this.lockDirection?[.1,3]:0)},modifierKey(nt){return nt===void 0?"ctrlKey":nt},pinchOnWheel(nt=!0){return nt}});_objectSpread2$5(_objectSpread2$5({},coordinatesConfigResolver),{},{mouseOnly:(nt=!0)=>nt});_objectSpread2$5(_objectSpread2$5({},coordinatesConfigResolver),{},{mouseOnly:(nt=!0)=>nt});const EngineMap=new Map,ConfigResolverMap=new Map;function registerAction(nt){EngineMap.set(nt.key,nt.engine),ConfigResolverMap.set(nt.key,nt.resolver)}const dragAction={key:"drag",engine:DragEngine,resolver:dragConfigResolver};function _objectWithoutPropertiesLoose$6(nt,_e){if(nt==null)return{};var et={},rt=Object.keys(nt),it,st;for(st=0;st<rt.length;st++)it=rt[st],!(_e.indexOf(it)>=0)&&(et[it]=nt[it]);return et}function _objectWithoutProperties$6(nt,_e){if(nt==null)return{};var et=_objectWithoutPropertiesLoose$6(nt,_e),rt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(it=0;it<st.length;it++)rt=st[it],!(_e.indexOf(rt)>=0)&&Object.prototype.propertyIsEnumerable.call(nt,rt)&&(et[rt]=nt[rt])}return et}const sharedConfigResolver={target(nt){if(nt)return()=>"current"in nt?nt.current:nt},enabled(nt=!0){return nt},window(nt=SUPPORT.isBrowser?window:void 0){return nt},eventOptions({passive:nt=!0,capture:_e=!1}={}){return{passive:nt,capture:_e}},transform(nt){return nt}},_excluded$c=["target","eventOptions","window","enabled","transform"];function resolveWith(nt={},_e){const et={};for(const[rt,it]of Object.entries(_e))switch(typeof it){case"function":et[rt]=it.call(et,nt[rt],rt,nt);break;case"object":et[rt]=resolveWith(nt[rt],it);break;case"boolean":it&&(et[rt]=nt[rt]);break}return et}function parse$3(nt,_e,et={}){const rt=nt,{target:it,eventOptions:st,window:ot,enabled:at,transform:lt}=rt,ct=_objectWithoutProperties$6(rt,_excluded$c);if(et.shared=resolveWith({target:it,eventOptions:st,window:ot,enabled:at,transform:lt},sharedConfigResolver),_e){const ut=ConfigResolverMap.get(_e);et[_e]=resolveWith(_objectSpread2$5({shared:et.shared},ct),ut)}else for(const ut in ct){const ht=ConfigResolverMap.get(ut);ht&&(et[ut]=resolveWith(_objectSpread2$5({shared:et.shared},ct[ut]),ht))}return et}class EventStore{constructor(_e,et){_defineProperty$a(this,"_listeners",new Set),this._ctrl=_e,this._gestureKey=et}add(_e,et,rt,it,st){const ot=this._listeners,at=toDomEventType(et,rt),lt=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},ct=_objectSpread2$5(_objectSpread2$5({},lt),st);_e.addEventListener(at,it,ct);const ut=()=>{_e.removeEventListener(at,it,ct),ot.delete(ut)};return ot.add(ut),ut}clean(){this._listeners.forEach(_e=>_e()),this._listeners.clear()}}class TimeoutStore{constructor(){_defineProperty$a(this,"_timeouts",new Map)}add(_e,et,rt=140,...it){this.remove(_e),this._timeouts.set(_e,window.setTimeout(et,rt,...it))}remove(_e){const et=this._timeouts.get(_e);et&&window.clearTimeout(et)}clean(){this._timeouts.forEach(_e=>void window.clearTimeout(_e)),this._timeouts.clear()}}class Controller{constructor(_e){_defineProperty$a(this,"gestures",new Set),_defineProperty$a(this,"_targetEventStore",new EventStore(this)),_defineProperty$a(this,"gestureEventStores",{}),_defineProperty$a(this,"gestureTimeoutStores",{}),_defineProperty$a(this,"handlers",{}),_defineProperty$a(this,"config",{}),_defineProperty$a(this,"pointerIds",new Set),_defineProperty$a(this,"touchIds",new Set),_defineProperty$a(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,_e)}setEventIds(_e){if(isTouch(_e))return this.touchIds=new Set(touchIds(_e)),this.touchIds;if("pointerId"in _e)return _e.type==="pointerup"||_e.type==="pointercancel"?this.pointerIds.delete(_e.pointerId):_e.type==="pointerdown"&&this.pointerIds.add(_e.pointerId),this.pointerIds}applyHandlers(_e,et){this.handlers=_e,this.nativeHandlers=et}applyConfig(_e,et){this.config=parse$3(_e,et,this.config)}clean(){this._targetEventStore.clean();for(const _e of this.gestures)this.gestureEventStores[_e].clean(),this.gestureTimeoutStores[_e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(..._e){const et=this.config.shared,rt={};let it;if(!(et.target&&(it=et.target(),!it))){if(et.enabled){for(const ot of this.gestures){const at=this.config[ot],lt=bindToProps(rt,at.eventOptions,!!it);if(at.enabled){const ct=EngineMap.get(ot);new ct(this,_e,ot).bind(lt)}}const st=bindToProps(rt,et.eventOptions,!!it);for(const ot in this.nativeHandlers)st(ot,"",at=>this.nativeHandlers[ot](_objectSpread2$5(_objectSpread2$5({},this.state.shared),{},{event:at,args:_e})),void 0,!0)}for(const st in rt)rt[st]=chain(...rt[st]);if(!it)return rt;for(const st in rt){const{device:ot,capture:at,passive:lt}=parseProp(st);this._targetEventStore.add(it,ot,"",rt[st],{capture:at,passive:lt})}}}}function setupGesture(nt,_e){nt.gestures.add(_e),nt.gestureEventStores[_e]=new EventStore(nt,_e),nt.gestureTimeoutStores[_e]=new TimeoutStore}function resolveGestures(nt,_e){_e.drag&&setupGesture(nt,"drag"),_e.wheel&&setupGesture(nt,"wheel"),_e.scroll&&setupGesture(nt,"scroll"),_e.move&&setupGesture(nt,"move"),_e.pinch&&setupGesture(nt,"pinch"),_e.hover&&setupGesture(nt,"hover")}const bindToProps=(nt,_e,et)=>(rt,it,st,ot={},at=!1)=>{var lt,ct;const ut=(lt=ot.capture)!==null&&lt!==void 0?lt:_e.capture,ht=(ct=ot.passive)!==null&&ct!==void 0?ct:_e.passive;let dt=at?rt:toHandlerProp(rt,it,ut);et&&ht&&(dt+="Passive"),nt[dt]=nt[dt]||[],nt[dt].push(st)};function useRecognizers(nt,_e={},et,rt){const it=React.useMemo(()=>new Controller(nt),[]);if(it.applyHandlers(nt,rt),it.applyConfig(_e,et),React.useEffect(it.effect.bind(it)),React.useEffect(()=>it.clean.bind(it),[]),_e.target===void 0)return it.bind.bind(it)}function useDrag$1(nt,_e){return registerAction(dragAction),useRecognizers({drag:nt},_e||{},"drag")}function composeEventHandlers$1(nt,_e,{checkForDefaultPrevented:et=!0}={}){return function(it){if(nt==null||nt(it),et===!1||!it.defaultPrevented)return _e==null?void 0:_e(it)}}function createContextScope$1(nt,_e=[]){let et=[];function rt(st,ot){const at=reactExports.createContext(ot),lt=et.length;et=[...et,ot];const ct=ht=>{var gt;const{scope:dt,children:ft,...pt}=ht,mt=((gt=dt==null?void 0:dt[nt])==null?void 0:gt[lt])||at,At=reactExports.useMemo(()=>pt,Object.values(pt));return jsxRuntimeExports.jsx(mt.Provider,{value:At,children:ft})};ct.displayName=st+"Provider";function ut(ht,dt){var mt;const ft=((mt=dt==null?void 0:dt[nt])==null?void 0:mt[lt])||at,pt=reactExports.useContext(ft);if(pt)return pt;if(ot!==void 0)return ot;throw new Error(`\`${ht}\` must be used within \`${st}\``)}return[ct,ut]}const it=()=>{const st=et.map(ot=>reactExports.createContext(ot));return function(at){const lt=(at==null?void 0:at[nt])||st;return reactExports.useMemo(()=>({[`__scope${nt}`]:{...at,[nt]:lt}}),[at,lt])}};return it.scopeName=nt,[rt,composeContextScopes$1(it,..._e)]}function composeContextScopes$1(...nt){const _e=nt[0];if(nt.length===1)return _e;const et=()=>{const rt=nt.map(it=>({useScope:it(),scopeName:it.scopeName}));return function(st){const ot=rt.reduce((at,{useScope:lt,scopeName:ct})=>{const ht=lt(st)[`__scope${ct}`];return{...at,...ht}},{});return reactExports.useMemo(()=>({[`__scope${_e.scopeName}`]:ot}),[ot])}};return et.scopeName=_e.scopeName,et}function useCallbackRef(nt){const _e=reactExports.useRef(nt);return reactExports.useEffect(()=>{_e.current=nt}),reactExports.useMemo(()=>(...et)=>{var rt;return(rt=_e.current)==null?void 0:rt.call(_e,...et)},[])}function useEscapeKeydown(nt,_e=globalThis==null?void 0:globalThis.document){const et=useCallbackRef(nt);reactExports.useEffect(()=>{const rt=it=>{it.key==="Escape"&&et(it)};return _e.addEventListener("keydown",rt,{capture:!0}),()=>_e.removeEventListener("keydown",rt,{capture:!0})},[et,_e])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((nt,_e)=>{const{disableOutsidePointerEvents:et=!1,onEscapeKeyDown:rt,onPointerDownOutside:it,onFocusOutside:st,onInteractOutside:ot,onDismiss:at,...lt}=nt,ct=reactExports.useContext(DismissableLayerContext),[ut,ht]=reactExports.useState(null),dt=(ut==null?void 0:ut.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,ft]=reactExports.useState({}),pt=useComposedRefs(_e,Lt=>ht(Lt)),mt=Array.from(ct.layers),[At]=[...ct.layersWithOutsidePointerEventsDisabled].slice(-1),gt=mt.indexOf(At),bt=ut?mt.indexOf(ut):-1,Tt=ct.layersWithOutsidePointerEventsDisabled.size>0,wt=bt>=gt,Rt=usePointerDownOutside(Lt=>{const $t=Lt.target,kt=[...ct.branches].some(Dt=>Dt.contains($t));!wt||kt||(it==null||it(Lt),ot==null||ot(Lt),Lt.defaultPrevented||at==null||at())},dt),It=useFocusOutside(Lt=>{const $t=Lt.target;[...ct.branches].some(Dt=>Dt.contains($t))||(st==null||st(Lt),ot==null||ot(Lt),Lt.defaultPrevented||at==null||at())},dt);return useEscapeKeydown(Lt=>{bt===ct.layers.size-1&&(rt==null||rt(Lt),!Lt.defaultPrevented&&at&&(Lt.preventDefault(),at()))},dt),reactExports.useEffect(()=>{if(ut)return et&&(ct.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=dt.body.style.pointerEvents,dt.body.style.pointerEvents="none"),ct.layersWithOutsidePointerEventsDisabled.add(ut)),ct.layers.add(ut),dispatchUpdate(),()=>{et&&ct.layersWithOutsidePointerEventsDisabled.size===1&&(dt.body.style.pointerEvents=originalBodyPointerEvents)}},[ut,dt,et,ct]),reactExports.useEffect(()=>()=>{ut&&(ct.layers.delete(ut),ct.layersWithOutsidePointerEventsDisabled.delete(ut),dispatchUpdate())},[ut,ct]),reactExports.useEffect(()=>{const Lt=()=>ft({});return document.addEventListener(CONTEXT_UPDATE,Lt),()=>document.removeEventListener(CONTEXT_UPDATE,Lt)},[]),jsxRuntimeExports.jsx(Primitive.div,{...lt,ref:pt,style:{pointerEvents:Tt?wt?"auto":"none":void 0,...nt.style},onFocusCapture:composeEventHandlers$1(nt.onFocusCapture,It.onFocusCapture),onBlurCapture:composeEventHandlers$1(nt.onBlurCapture,It.onBlurCapture),onPointerDownCapture:composeEventHandlers$1(nt.onPointerDownCapture,Rt.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((nt,_e)=>{const et=reactExports.useContext(DismissableLayerContext),rt=reactExports.useRef(null),it=useComposedRefs(_e,rt);return reactExports.useEffect(()=>{const st=rt.current;if(st)return et.branches.add(st),()=>{et.branches.delete(st)}},[et.branches]),jsxRuntimeExports.jsx(Primitive.div,{...nt,ref:it})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(nt,_e=globalThis==null?void 0:globalThis.document){const et=useCallbackRef(nt),rt=reactExports.useRef(!1),it=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const st=at=>{if(at.target&&!rt.current){let lt=function(){handleAndDispatchCustomEvent(POINTER_DOWN_OUTSIDE,et,ct,{discrete:!0})};const ct={originalEvent:at};at.pointerType==="touch"?(_e.removeEventListener("click",it.current),it.current=lt,_e.addEventListener("click",it.current,{once:!0})):lt()}else _e.removeEventListener("click",it.current);rt.current=!1},ot=window.setTimeout(()=>{_e.addEventListener("pointerdown",st)},0);return()=>{window.clearTimeout(ot),_e.removeEventListener("pointerdown",st),_e.removeEventListener("click",it.current)}},[_e,et]),{onPointerDownCapture:()=>rt.current=!0}}function useFocusOutside(nt,_e=globalThis==null?void 0:globalThis.document){const et=useCallbackRef(nt),rt=reactExports.useRef(!1);return reactExports.useEffect(()=>{const it=st=>{st.target&&!rt.current&&handleAndDispatchCustomEvent(FOCUS_OUTSIDE,et,{originalEvent:st},{discrete:!1})};return _e.addEventListener("focusin",it),()=>_e.removeEventListener("focusin",it)},[_e,et]),{onFocusCapture:()=>rt.current=!0,onBlurCapture:()=>rt.current=!1}}function dispatchUpdate(){const nt=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(nt)}function handleAndDispatchCustomEvent(nt,_e,et,{discrete:rt}){const it=et.originalEvent.target,st=new CustomEvent(nt,{bubbles:!1,cancelable:!0,detail:et});_e&&it.addEventListener(nt,_e,{once:!0}),rt?dispatchDiscreteCustomEvent(it,st):it.dispatchEvent(st)}var useReactId=React$1.useId||(()=>{}),count=0;function useId(nt){const[_e,et]=reactExports.useState(useReactId());return useLayoutEffect2(()=>{et(rt=>rt??String(count++))},[nt]),_e?`radix-${_e}`:""}const sides=["top","right","bottom","left"],min$2=Math.min,max$3=Math.max,round$1=Math.round,floor$1=Math.floor,createCoords=nt=>({x:nt,y:nt}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$7(nt,_e,et){return max$3(nt,min$2(_e,et))}function evaluate$1(nt,_e){return typeof nt=="function"?nt(_e):nt}function getSide(nt){return nt.split("-")[0]}function getAlignment(nt){return nt.split("-")[1]}function getOppositeAxis(nt){return nt==="x"?"y":"x"}function getAxisLength(nt){return nt==="y"?"height":"width"}function getSideAxis(nt){return["top","bottom"].includes(getSide(nt))?"y":"x"}function getAlignmentAxis(nt){return getOppositeAxis(getSideAxis(nt))}function getAlignmentSides(nt,_e,et){et===void 0&&(et=!1);const rt=getAlignment(nt),it=getAlignmentAxis(nt),st=getAxisLength(it);let ot=it==="x"?rt===(et?"end":"start")?"right":"left":rt==="start"?"bottom":"top";return _e.reference[st]>_e.floating[st]&&(ot=getOppositePlacement(ot)),[ot,getOppositePlacement(ot)]}function getExpandedPlacements(nt){const _e=getOppositePlacement(nt);return[getOppositeAlignmentPlacement(nt),_e,getOppositeAlignmentPlacement(_e)]}function getOppositeAlignmentPlacement(nt){return nt.replace(/start|end/g,_e=>oppositeAlignmentMap[_e])}function getSideList(nt,_e,et){const rt=["left","right"],it=["right","left"],st=["top","bottom"],ot=["bottom","top"];switch(nt){case"top":case"bottom":return et?_e?it:rt:_e?rt:it;case"left":case"right":return _e?st:ot;default:return[]}}function getOppositeAxisPlacements(nt,_e,et,rt){const it=getAlignment(nt);let st=getSideList(getSide(nt),et==="start",rt);return it&&(st=st.map(ot=>ot+"-"+it),_e&&(st=st.concat(st.map(getOppositeAlignmentPlacement)))),st}function getOppositePlacement(nt){return nt.replace(/left|right|bottom|top/g,_e=>oppositeSideMap[_e])}function expandPaddingObject(nt){return{top:0,right:0,bottom:0,left:0,...nt}}function getPaddingObject(nt){return typeof nt!="number"?expandPaddingObject(nt):{top:nt,right:nt,bottom:nt,left:nt}}function rectToClientRect(nt){const{x:_e,y:et,width:rt,height:it}=nt;return{width:rt,height:it,top:et,left:_e,right:_e+rt,bottom:et+it,x:_e,y:et}}function computeCoordsFromPlacement(nt,_e,et){let{reference:rt,floating:it}=nt;const st=getSideAxis(_e),ot=getAlignmentAxis(_e),at=getAxisLength(ot),lt=getSide(_e),ct=st==="y",ut=rt.x+rt.width/2-it.width/2,ht=rt.y+rt.height/2-it.height/2,dt=rt[at]/2-it[at]/2;let ft;switch(lt){case"top":ft={x:ut,y:rt.y-it.height};break;case"bottom":ft={x:ut,y:rt.y+rt.height};break;case"right":ft={x:rt.x+rt.width,y:ht};break;case"left":ft={x:rt.x-it.width,y:ht};break;default:ft={x:rt.x,y:rt.y}}switch(getAlignment(_e)){case"start":ft[ot]-=dt*(et&&ct?-1:1);break;case"end":ft[ot]+=dt*(et&&ct?-1:1);break}return ft}const computePosition$1=async(nt,_e,et)=>{const{placement:rt="bottom",strategy:it="absolute",middleware:st=[],platform:ot}=et,at=st.filter(Boolean),lt=await(ot.isRTL==null?void 0:ot.isRTL(_e));let ct=await ot.getElementRects({reference:nt,floating:_e,strategy:it}),{x:ut,y:ht}=computeCoordsFromPlacement(ct,rt,lt),dt=rt,ft={},pt=0;for(let mt=0;mt<at.length;mt++){const{name:At,fn:gt}=at[mt],{x:bt,y:Tt,data:wt,reset:Rt}=await gt({x:ut,y:ht,initialPlacement:rt,placement:dt,strategy:it,middlewareData:ft,rects:ct,platform:ot,elements:{reference:nt,floating:_e}});ut=bt??ut,ht=Tt??ht,ft={...ft,[At]:{...ft[At],...wt}},Rt&&pt<=50&&(pt++,typeof Rt=="object"&&(Rt.placement&&(dt=Rt.placement),Rt.rects&&(ct=Rt.rects===!0?await ot.getElementRects({reference:nt,floating:_e,strategy:it}):Rt.rects),{x:ut,y:ht}=computeCoordsFromPlacement(ct,dt,lt)),mt=-1)}return{x:ut,y:ht,placement:dt,strategy:it,middlewareData:ft}};async function detectOverflow(nt,_e){var et;_e===void 0&&(_e={});const{x:rt,y:it,platform:st,rects:ot,elements:at,strategy:lt}=nt,{boundary:ct="clippingAncestors",rootBoundary:ut="viewport",elementContext:ht="floating",altBoundary:dt=!1,padding:ft=0}=evaluate$1(_e,nt),pt=getPaddingObject(ft),At=at[dt?ht==="floating"?"reference":"floating":ht],gt=rectToClientRect(await st.getClippingRect({element:(et=await(st.isElement==null?void 0:st.isElement(At)))==null||et?At:At.contextElement||await(st.getDocumentElement==null?void 0:st.getDocumentElement(at.floating)),boundary:ct,rootBoundary:ut,strategy:lt})),bt=ht==="floating"?{x:rt,y:it,width:ot.floating.width,height:ot.floating.height}:ot.reference,Tt=await(st.getOffsetParent==null?void 0:st.getOffsetParent(at.floating)),wt=await(st.isElement==null?void 0:st.isElement(Tt))?await(st.getScale==null?void 0:st.getScale(Tt))||{x:1,y:1}:{x:1,y:1},Rt=rectToClientRect(st.convertOffsetParentRelativeRectToViewportRelativeRect?await st.convertOffsetParentRelativeRectToViewportRelativeRect({elements:at,rect:bt,offsetParent:Tt,strategy:lt}):bt);return{top:(gt.top-Rt.top+pt.top)/wt.y,bottom:(Rt.bottom-gt.bottom+pt.bottom)/wt.y,left:(gt.left-Rt.left+pt.left)/wt.x,right:(Rt.right-gt.right+pt.right)/wt.x}}const arrow$3=nt=>({name:"arrow",options:nt,async fn(_e){const{x:et,y:rt,placement:it,rects:st,platform:ot,elements:at,middlewareData:lt}=_e,{element:ct,padding:ut=0}=evaluate$1(nt,_e)||{};if(ct==null)return{};const ht=getPaddingObject(ut),dt={x:et,y:rt},ft=getAlignmentAxis(it),pt=getAxisLength(ft),mt=await ot.getDimensions(ct),At=ft==="y",gt=At?"top":"left",bt=At?"bottom":"right",Tt=At?"clientHeight":"clientWidth",wt=st.reference[pt]+st.reference[ft]-dt[ft]-st.floating[pt],Rt=dt[ft]-st.reference[ft],It=await(ot.getOffsetParent==null?void 0:ot.getOffsetParent(ct));let Lt=It?It[Tt]:0;(!Lt||!await(ot.isElement==null?void 0:ot.isElement(It)))&&(Lt=at.floating[Tt]||st.floating[pt]);const $t=wt/2-Rt/2,kt=Lt/2-mt[pt]/2-1,Dt=min$2(ht[gt],kt),Ot=min$2(ht[bt],kt),zt=Dt,Ht=Lt-mt[pt]-Ot,Yt=Lt/2-mt[pt]/2+$t,Xt=clamp$7(zt,Yt,Ht),Zt=!lt.arrow&&getAlignment(it)!=null&&Yt!==Xt&&st.reference[pt]/2-(Yt<zt?Dt:Ot)-mt[pt]/2<0,rn=Zt?Yt<zt?Yt-zt:Yt-Ht:0;return{[ft]:dt[ft]+rn,data:{[ft]:Xt,centerOffset:Yt-Xt-rn,...Zt&&{alignmentOffset:rn}},reset:Zt}}}),flip$3=function(nt){return nt===void 0&&(nt={}),{name:"flip",options:nt,async fn(_e){var et,rt;const{placement:it,middlewareData:st,rects:ot,initialPlacement:at,platform:lt,elements:ct}=_e,{mainAxis:ut=!0,crossAxis:ht=!0,fallbackPlacements:dt,fallbackStrategy:ft="bestFit",fallbackAxisSideDirection:pt="none",flipAlignment:mt=!0,...At}=evaluate$1(nt,_e);if((et=st.arrow)!=null&&et.alignmentOffset)return{};const gt=getSide(it),bt=getSideAxis(at),Tt=getSide(at)===at,wt=await(lt.isRTL==null?void 0:lt.isRTL(ct.floating)),Rt=dt||(Tt||!mt?[getOppositePlacement(at)]:getExpandedPlacements(at)),It=pt!=="none";!dt&&It&&Rt.push(...getOppositeAxisPlacements(at,mt,pt,wt));const Lt=[at,...Rt],$t=await detectOverflow(_e,At),kt=[];let Dt=((rt=st.flip)==null?void 0:rt.overflows)||[];if(ut&&kt.push($t[gt]),ht){const Yt=getAlignmentSides(it,ot,wt);kt.push($t[Yt[0]],$t[Yt[1]])}if(Dt=[...Dt,{placement:it,overflows:kt}],!kt.every(Yt=>Yt<=0)){var Ot,zt;const Yt=(((Ot=st.flip)==null?void 0:Ot.index)||0)+1,Xt=Lt[Yt];if(Xt)return{data:{index:Yt,overflows:Dt},reset:{placement:Xt}};let Zt=(zt=Dt.filter(rn=>rn.overflows[0]<=0).sort((rn,Gt)=>rn.overflows[1]-Gt.overflows[1])[0])==null?void 0:zt.placement;if(!Zt)switch(ft){case"bestFit":{var Ht;const rn=(Ht=Dt.filter(Gt=>{if(It){const jt=getSideAxis(Gt.placement);return jt===bt||jt==="y"}return!0}).map(Gt=>[Gt.placement,Gt.overflows.filter(jt=>jt>0).reduce((jt,Kt)=>jt+Kt,0)]).sort((Gt,jt)=>Gt[1]-jt[1])[0])==null?void 0:Ht[0];rn&&(Zt=rn);break}case"initialPlacement":Zt=at;break}if(it!==Zt)return{reset:{placement:Zt}}}return{}}}};function getSideOffsets(nt,_e){return{top:nt.top-_e.height,right:nt.right-_e.width,bottom:nt.bottom-_e.height,left:nt.left-_e.width}}function isAnySideFullyClipped(nt){return sides.some(_e=>nt[_e]>=0)}const hide$2=function(nt){return nt===void 0&&(nt={}),{name:"hide",options:nt,async fn(_e){const{rects:et}=_e,{strategy:rt="referenceHidden",...it}=evaluate$1(nt,_e);switch(rt){case"referenceHidden":{const st=await detectOverflow(_e,{...it,elementContext:"reference"}),ot=getSideOffsets(st,et.reference);return{data:{referenceHiddenOffsets:ot,referenceHidden:isAnySideFullyClipped(ot)}}}case"escaped":{const st=await detectOverflow(_e,{...it,altBoundary:!0}),ot=getSideOffsets(st,et.floating);return{data:{escapedOffsets:ot,escaped:isAnySideFullyClipped(ot)}}}default:return{}}}}};async function convertValueToCoords(nt,_e){const{placement:et,platform:rt,elements:it}=nt,st=await(rt.isRTL==null?void 0:rt.isRTL(it.floating)),ot=getSide(et),at=getAlignment(et),lt=getSideAxis(et)==="y",ct=["left","top"].includes(ot)?-1:1,ut=st&&lt?-1:1,ht=evaluate$1(_e,nt);let{mainAxis:dt,crossAxis:ft,alignmentAxis:pt}=typeof ht=="number"?{mainAxis:ht,crossAxis:0,alignmentAxis:null}:{mainAxis:ht.mainAxis||0,crossAxis:ht.crossAxis||0,alignmentAxis:ht.alignmentAxis};return at&&typeof pt=="number"&&(ft=at==="end"?pt*-1:pt),lt?{x:ft*ut,y:dt*ct}:{x:dt*ct,y:ft*ut}}const offset$2=function(nt){return nt===void 0&&(nt=0),{name:"offset",options:nt,async fn(_e){var et,rt;const{x:it,y:st,placement:ot,middlewareData:at}=_e,lt=await convertValueToCoords(_e,nt);return ot===((et=at.offset)==null?void 0:et.placement)&&(rt=at.arrow)!=null&&rt.alignmentOffset?{}:{x:it+lt.x,y:st+lt.y,data:{...lt,placement:ot}}}}},shift$2=function(nt){return nt===void 0&&(nt={}),{name:"shift",options:nt,async fn(_e){const{x:et,y:rt,placement:it}=_e,{mainAxis:st=!0,crossAxis:ot=!1,limiter:at={fn:At=>{let{x:gt,y:bt}=At;return{x:gt,y:bt}}},...lt}=evaluate$1(nt,_e),ct={x:et,y:rt},ut=await detectOverflow(_e,lt),ht=getSideAxis(getSide(it)),dt=getOppositeAxis(ht);let ft=ct[dt],pt=ct[ht];if(st){const At=dt==="y"?"top":"left",gt=dt==="y"?"bottom":"right",bt=ft+ut[At],Tt=ft-ut[gt];ft=clamp$7(bt,ft,Tt)}if(ot){const At=ht==="y"?"top":"left",gt=ht==="y"?"bottom":"right",bt=pt+ut[At],Tt=pt-ut[gt];pt=clamp$7(bt,pt,Tt)}const mt=at.fn({..._e,[dt]:ft,[ht]:pt});return{...mt,data:{x:mt.x-et,y:mt.y-rt,enabled:{[dt]:st,[ht]:ot}}}}}},limitShift$2=function(nt){return nt===void 0&&(nt={}),{options:nt,fn(_e){const{x:et,y:rt,placement:it,rects:st,middlewareData:ot}=_e,{offset:at=0,mainAxis:lt=!0,crossAxis:ct=!0}=evaluate$1(nt,_e),ut={x:et,y:rt},ht=getSideAxis(it),dt=getOppositeAxis(ht);let ft=ut[dt],pt=ut[ht];const mt=evaluate$1(at,_e),At=typeof mt=="number"?{mainAxis:mt,crossAxis:0}:{mainAxis:0,crossAxis:0,...mt};if(lt){const Tt=dt==="y"?"height":"width",wt=st.reference[dt]-st.floating[Tt]+At.mainAxis,Rt=st.reference[dt]+st.reference[Tt]-At.mainAxis;ft<wt?ft=wt:ft>Rt&&(ft=Rt)}if(ct){var gt,bt;const Tt=dt==="y"?"width":"height",wt=["top","left"].includes(getSide(it)),Rt=st.reference[ht]-st.floating[Tt]+(wt&&((gt=ot.offset)==null?void 0:gt[ht])||0)+(wt?0:At.crossAxis),It=st.reference[ht]+st.reference[Tt]+(wt?0:((bt=ot.offset)==null?void 0:bt[ht])||0)-(wt?At.crossAxis:0);pt<Rt?pt=Rt:pt>It&&(pt=It)}return{[dt]:ft,[ht]:pt}}}},size$2=function(nt){return nt===void 0&&(nt={}),{name:"size",options:nt,async fn(_e){var et,rt;const{placement:it,rects:st,platform:ot,elements:at}=_e,{apply:lt=()=>{},...ct}=evaluate$1(nt,_e),ut=await detectOverflow(_e,ct),ht=getSide(it),dt=getAlignment(it),ft=getSideAxis(it)==="y",{width:pt,height:mt}=st.floating;let At,gt;ht==="top"||ht==="bottom"?(At=ht,gt=dt===(await(ot.isRTL==null?void 0:ot.isRTL(at.floating))?"start":"end")?"left":"right"):(gt=ht,At=dt==="end"?"top":"bottom");const bt=mt-ut.top-ut.bottom,Tt=pt-ut.left-ut.right,wt=min$2(mt-ut[At],bt),Rt=min$2(pt-ut[gt],Tt),It=!_e.middlewareData.shift;let Lt=wt,$t=Rt;if((et=_e.middlewareData.shift)!=null&&et.enabled.x&&($t=Tt),(rt=_e.middlewareData.shift)!=null&&rt.enabled.y&&(Lt=bt),It&&!dt){const Dt=max$3(ut.left,0),Ot=max$3(ut.right,0),zt=max$3(ut.top,0),Ht=max$3(ut.bottom,0);ft?$t=pt-2*(Dt!==0||Ot!==0?Dt+Ot:max$3(ut.left,ut.right)):Lt=mt-2*(zt!==0||Ht!==0?zt+Ht:max$3(ut.top,ut.bottom))}await lt({..._e,availableWidth:$t,availableHeight:Lt});const kt=await ot.getDimensions(at.floating);return pt!==kt.width||mt!==kt.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(nt){return isNode(nt)?(nt.nodeName||"").toLowerCase():"#document"}function getWindow(nt){var _e;return(nt==null||(_e=nt.ownerDocument)==null?void 0:_e.defaultView)||window}function getDocumentElement(nt){var _e;return(_e=(isNode(nt)?nt.ownerDocument:nt.document)||window.document)==null?void 0:_e.documentElement}function isNode(nt){return hasWindow()?nt instanceof Node||nt instanceof getWindow(nt).Node:!1}function isElement(nt){return hasWindow()?nt instanceof Element||nt instanceof getWindow(nt).Element:!1}function isHTMLElement(nt){return hasWindow()?nt instanceof HTMLElement||nt instanceof getWindow(nt).HTMLElement:!1}function isShadowRoot(nt){return!hasWindow()||typeof ShadowRoot>"u"?!1:nt instanceof ShadowRoot||nt instanceof getWindow(nt).ShadowRoot}function isOverflowElement(nt){const{overflow:_e,overflowX:et,overflowY:rt,display:it}=getComputedStyle$2(nt);return/auto|scroll|overlay|hidden|clip/.test(_e+rt+et)&&!["inline","contents"].includes(it)}function isTableElement(nt){return["table","td","th"].includes(getNodeName(nt))}function isTopLayer(nt){return[":popover-open",":modal"].some(_e=>{try{return nt.matches(_e)}catch{return!1}})}function isContainingBlock(nt){const _e=isWebKit(),et=isElement(nt)?getComputedStyle$2(nt):nt;return et.transform!=="none"||et.perspective!=="none"||(et.containerType?et.containerType!=="normal":!1)||!_e&&(et.backdropFilter?et.backdropFilter!=="none":!1)||!_e&&(et.filter?et.filter!=="none":!1)||["transform","perspective","filter"].some(rt=>(et.willChange||"").includes(rt))||["paint","layout","strict","content"].some(rt=>(et.contain||"").includes(rt))}function getContainingBlock(nt){let _e=getParentNode(nt);for(;isHTMLElement(_e)&&!isLastTraversableNode(_e);){if(isContainingBlock(_e))return _e;if(isTopLayer(_e))return null;_e=getParentNode(_e)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(nt){return["html","body","#document"].includes(getNodeName(nt))}function getComputedStyle$2(nt){return getWindow(nt).getComputedStyle(nt)}function getNodeScroll(nt){return isElement(nt)?{scrollLeft:nt.scrollLeft,scrollTop:nt.scrollTop}:{scrollLeft:nt.scrollX,scrollTop:nt.scrollY}}function getParentNode(nt){if(getNodeName(nt)==="html")return nt;const _e=nt.assignedSlot||nt.parentNode||isShadowRoot(nt)&&nt.host||getDocumentElement(nt);return isShadowRoot(_e)?_e.host:_e}function getNearestOverflowAncestor(nt){const _e=getParentNode(nt);return isLastTraversableNode(_e)?nt.ownerDocument?nt.ownerDocument.body:nt.body:isHTMLElement(_e)&&isOverflowElement(_e)?_e:getNearestOverflowAncestor(_e)}function getOverflowAncestors(nt,_e,et){var rt;_e===void 0&&(_e=[]),et===void 0&&(et=!0);const it=getNearestOverflowAncestor(nt),st=it===((rt=nt.ownerDocument)==null?void 0:rt.body),ot=getWindow(it);if(st){const at=getFrameElement(ot);return _e.concat(ot,ot.visualViewport||[],isOverflowElement(it)?it:[],at&&et?getOverflowAncestors(at):[])}return _e.concat(it,getOverflowAncestors(it,[],et))}function getFrameElement(nt){return nt.parent&&Object.getPrototypeOf(nt.parent)?nt.frameElement:null}function getCssDimensions(nt){const _e=getComputedStyle$2(nt);let et=parseFloat(_e.width)||0,rt=parseFloat(_e.height)||0;const it=isHTMLElement(nt),st=it?nt.offsetWidth:et,ot=it?nt.offsetHeight:rt,at=round$1(et)!==st||round$1(rt)!==ot;return at&&(et=st,rt=ot),{width:et,height:rt,$:at}}function unwrapElement(nt){return isElement(nt)?nt:nt.contextElement}function getScale(nt){const _e=unwrapElement(nt);if(!isHTMLElement(_e))return createCoords(1);const et=_e.getBoundingClientRect(),{width:rt,height:it,$:st}=getCssDimensions(_e);let ot=(st?round$1(et.width):et.width)/rt,at=(st?round$1(et.height):et.height)/it;return(!ot||!Number.isFinite(ot))&&(ot=1),(!at||!Number.isFinite(at))&&(at=1),{x:ot,y:at}}const noOffsets=createCoords(0);function getVisualOffsets(nt){const _e=getWindow(nt);return!isWebKit()||!_e.visualViewport?noOffsets:{x:_e.visualViewport.offsetLeft,y:_e.visualViewport.offsetTop}}function shouldAddVisualOffsets(nt,_e,et){return _e===void 0&&(_e=!1),!et||_e&&et!==getWindow(nt)?!1:_e}function getBoundingClientRect(nt,_e,et,rt){_e===void 0&&(_e=!1),et===void 0&&(et=!1);const it=nt.getBoundingClientRect(),st=unwrapElement(nt);let ot=createCoords(1);_e&&(rt?isElement(rt)&&(ot=getScale(rt)):ot=getScale(nt));const at=shouldAddVisualOffsets(st,et,rt)?getVisualOffsets(st):createCoords(0);let lt=(it.left+at.x)/ot.x,ct=(it.top+at.y)/ot.y,ut=it.width/ot.x,ht=it.height/ot.y;if(st){const dt=getWindow(st),ft=rt&&isElement(rt)?getWindow(rt):rt;let pt=dt,mt=getFrameElement(pt);for(;mt&&rt&&ft!==pt;){const At=getScale(mt),gt=mt.getBoundingClientRect(),bt=getComputedStyle$2(mt),Tt=gt.left+(mt.clientLeft+parseFloat(bt.paddingLeft))*At.x,wt=gt.top+(mt.clientTop+parseFloat(bt.paddingTop))*At.y;lt*=At.x,ct*=At.y,ut*=At.x,ht*=At.y,lt+=Tt,ct+=wt,pt=getWindow(mt),mt=getFrameElement(pt)}}return rectToClientRect({width:ut,height:ht,x:lt,y:ct})}function convertOffsetParentRelativeRectToViewportRelativeRect(nt){let{elements:_e,rect:et,offsetParent:rt,strategy:it}=nt;const st=it==="fixed",ot=getDocumentElement(rt),at=_e?isTopLayer(_e.floating):!1;if(rt===ot||at&&st)return et;let lt={scrollLeft:0,scrollTop:0},ct=createCoords(1);const ut=createCoords(0),ht=isHTMLElement(rt);if((ht||!ht&&!st)&&((getNodeName(rt)!=="body"||isOverflowElement(ot))&&(lt=getNodeScroll(rt)),isHTMLElement(rt))){const dt=getBoundingClientRect(rt);ct=getScale(rt),ut.x=dt.x+rt.clientLeft,ut.y=dt.y+rt.clientTop}return{width:et.width*ct.x,height:et.height*ct.y,x:et.x*ct.x-lt.scrollLeft*ct.x+ut.x,y:et.y*ct.y-lt.scrollTop*ct.y+ut.y}}function getClientRects(nt){return Array.from(nt.getClientRects())}function getWindowScrollBarX(nt,_e){const et=getNodeScroll(nt).scrollLeft;return _e?_e.left+et:getBoundingClientRect(getDocumentElement(nt)).left+et}function getDocumentRect(nt){const _e=getDocumentElement(nt),et=getNodeScroll(nt),rt=nt.ownerDocument.body,it=max$3(_e.scrollWidth,_e.clientWidth,rt.scrollWidth,rt.clientWidth),st=max$3(_e.scrollHeight,_e.clientHeight,rt.scrollHeight,rt.clientHeight);let ot=-et.scrollLeft+getWindowScrollBarX(nt);const at=-et.scrollTop;return getComputedStyle$2(rt).direction==="rtl"&&(ot+=max$3(_e.clientWidth,rt.clientWidth)-it),{width:it,height:st,x:ot,y:at}}function getViewportRect(nt,_e){const et=getWindow(nt),rt=getDocumentElement(nt),it=et.visualViewport;let st=rt.clientWidth,ot=rt.clientHeight,at=0,lt=0;if(it){st=it.width,ot=it.height;const ct=isWebKit();(!ct||ct&&_e==="fixed")&&(at=it.offsetLeft,lt=it.offsetTop)}return{width:st,height:ot,x:at,y:lt}}function getInnerBoundingClientRect(nt,_e){const et=getBoundingClientRect(nt,!0,_e==="fixed"),rt=et.top+nt.clientTop,it=et.left+nt.clientLeft,st=isHTMLElement(nt)?getScale(nt):createCoords(1),ot=nt.clientWidth*st.x,at=nt.clientHeight*st.y,lt=it*st.x,ct=rt*st.y;return{width:ot,height:at,x:lt,y:ct}}function getClientRectFromClippingAncestor(nt,_e,et){let rt;if(_e==="viewport")rt=getViewportRect(nt,et);else if(_e==="document")rt=getDocumentRect(getDocumentElement(nt));else if(isElement(_e))rt=getInnerBoundingClientRect(_e,et);else{const it=getVisualOffsets(nt);rt={..._e,x:_e.x-it.x,y:_e.y-it.y}}return rectToClientRect(rt)}function hasFixedPositionAncestor(nt,_e){const et=getParentNode(nt);return et===_e||!isElement(et)||isLastTraversableNode(et)?!1:getComputedStyle$2(et).position==="fixed"||hasFixedPositionAncestor(et,_e)}function getClippingElementAncestors(nt,_e){const et=_e.get(nt);if(et)return et;let rt=getOverflowAncestors(nt,[],!1).filter(at=>isElement(at)&&getNodeName(at)!=="body"),it=null;const st=getComputedStyle$2(nt).position==="fixed";let ot=st?getParentNode(nt):nt;for(;isElement(ot)&&!isLastTraversableNode(ot);){const at=getComputedStyle$2(ot),lt=isContainingBlock(ot);!lt&&at.position==="fixed"&&(it=null),(st?!lt&&!it:!lt&&at.position==="static"&&!!it&&["absolute","fixed"].includes(it.position)||isOverflowElement(ot)&&!lt&&hasFixedPositionAncestor(nt,ot))?rt=rt.filter(ut=>ut!==ot):it=at,ot=getParentNode(ot)}return _e.set(nt,rt),rt}function getClippingRect(nt){let{element:_e,boundary:et,rootBoundary:rt,strategy:it}=nt;const ot=[...et==="clippingAncestors"?isTopLayer(_e)?[]:getClippingElementAncestors(_e,this._c):[].concat(et),rt],at=ot[0],lt=ot.reduce((ct,ut)=>{const ht=getClientRectFromClippingAncestor(_e,ut,it);return ct.top=max$3(ht.top,ct.top),ct.right=min$2(ht.right,ct.right),ct.bottom=min$2(ht.bottom,ct.bottom),ct.left=max$3(ht.left,ct.left),ct},getClientRectFromClippingAncestor(_e,at,it));return{width:lt.right-lt.left,height:lt.bottom-lt.top,x:lt.left,y:lt.top}}function getDimensions(nt){const{width:_e,height:et}=getCssDimensions(nt);return{width:_e,height:et}}function getRectRelativeToOffsetParent(nt,_e,et){const rt=isHTMLElement(_e),it=getDocumentElement(_e),st=et==="fixed",ot=getBoundingClientRect(nt,!0,st,_e);let at={scrollLeft:0,scrollTop:0};const lt=createCoords(0);if(rt||!rt&&!st)if((getNodeName(_e)!=="body"||isOverflowElement(it))&&(at=getNodeScroll(_e)),rt){const ft=getBoundingClientRect(_e,!0,st,_e);lt.x=ft.x+_e.clientLeft,lt.y=ft.y+_e.clientTop}else it&&(lt.x=getWindowScrollBarX(it));let ct=0,ut=0;if(it&&!rt&&!st){const ft=it.getBoundingClientRect();ut=ft.top+at.scrollTop,ct=ft.left+at.scrollLeft-getWindowScrollBarX(it,ft)}const ht=ot.left+at.scrollLeft-lt.x-ct,dt=ot.top+at.scrollTop-lt.y-ut;return{x:ht,y:dt,width:ot.width,height:ot.height}}function isStaticPositioned(nt){return getComputedStyle$2(nt).position==="static"}function getTrueOffsetParent(nt,_e){if(!isHTMLElement(nt)||getComputedStyle$2(nt).position==="fixed")return null;if(_e)return _e(nt);let et=nt.offsetParent;return getDocumentElement(nt)===et&&(et=et.ownerDocument.body),et}function getOffsetParent(nt,_e){const et=getWindow(nt);if(isTopLayer(nt))return et;if(!isHTMLElement(nt)){let it=getParentNode(nt);for(;it&&!isLastTraversableNode(it);){if(isElement(it)&&!isStaticPositioned(it))return it;it=getParentNode(it)}return et}let rt=getTrueOffsetParent(nt,_e);for(;rt&&isTableElement(rt)&&isStaticPositioned(rt);)rt=getTrueOffsetParent(rt,_e);return rt&&isLastTraversableNode(rt)&&isStaticPositioned(rt)&&!isContainingBlock(rt)?et:rt||getContainingBlock(nt)||et}const getElementRects=async function(nt){const _e=this.getOffsetParent||getOffsetParent,et=this.getDimensions,rt=await et(nt.floating);return{reference:getRectRelativeToOffsetParent(nt.reference,await _e(nt.floating),nt.strategy),floating:{x:0,y:0,width:rt.width,height:rt.height}}};function isRTL(nt){return getComputedStyle$2(nt).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(nt,_e){let et=null,rt;const it=getDocumentElement(nt);function st(){var at;clearTimeout(rt),(at=et)==null||at.disconnect(),et=null}function ot(at,lt){at===void 0&&(at=!1),lt===void 0&&(lt=1),st();const{left:ct,top:ut,width:ht,height:dt}=nt.getBoundingClientRect();if(at||_e(),!ht||!dt)return;const ft=floor$1(ut),pt=floor$1(it.clientWidth-(ct+ht)),mt=floor$1(it.clientHeight-(ut+dt)),At=floor$1(ct),bt={rootMargin:-ft+"px "+-pt+"px "+-mt+"px "+-At+"px",threshold:max$3(0,min$2(1,lt))||1};let Tt=!0;function wt(Rt){const It=Rt[0].intersectionRatio;if(It!==lt){if(!Tt)return ot();It?ot(!1,It):rt=setTimeout(()=>{ot(!1,1e-7)},1e3)}Tt=!1}try{et=new IntersectionObserver(wt,{...bt,root:it.ownerDocument})}catch{et=new IntersectionObserver(wt,bt)}et.observe(nt)}return ot(!0),st}function autoUpdate(nt,_e,et,rt){rt===void 0&&(rt={});const{ancestorScroll:it=!0,ancestorResize:st=!0,elementResize:ot=typeof ResizeObserver=="function",layoutShift:at=typeof IntersectionObserver=="function",animationFrame:lt=!1}=rt,ct=unwrapElement(nt),ut=it||st?[...ct?getOverflowAncestors(ct):[],...getOverflowAncestors(_e)]:[];ut.forEach(gt=>{it&&gt.addEventListener("scroll",et,{passive:!0}),st&&gt.addEventListener("resize",et)});const ht=ct&&at?observeMove(ct,et):null;let dt=-1,ft=null;ot&&(ft=new ResizeObserver(gt=>{let[bt]=gt;bt&&bt.target===ct&&ft&&(ft.unobserve(_e),cancelAnimationFrame(dt),dt=requestAnimationFrame(()=>{var Tt;(Tt=ft)==null||Tt.observe(_e)})),et()}),ct&&!lt&&ft.observe(ct),ft.observe(_e));let pt,mt=lt?getBoundingClientRect(nt):null;lt&&At();function At(){const gt=getBoundingClientRect(nt);mt&&(gt.x!==mt.x||gt.y!==mt.y||gt.width!==mt.width||gt.height!==mt.height)&&et(),mt=gt,pt=requestAnimationFrame(At)}return et(),()=>{var gt;ut.forEach(bt=>{it&&bt.removeEventListener("scroll",et),st&&bt.removeEventListener("resize",et)}),ht==null||ht(),(gt=ft)==null||gt.disconnect(),ft=null,lt&&cancelAnimationFrame(pt)}}const offset$1=offset$2,shift$1=shift$2,flip$2=flip$3,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(nt,_e,et)=>{const rt=new Map,it={platform,...et},st={...it.platform,_c:rt};return computePosition$1(nt,_e,{...it,platform:st})};var index$4=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual(nt,_e){if(nt===_e)return!0;if(typeof nt!=typeof _e)return!1;if(typeof nt=="function"&&nt.toString()===_e.toString())return!0;let et,rt,it;if(nt&&_e&&typeof nt=="object"){if(Array.isArray(nt)){if(et=nt.length,et!==_e.length)return!1;for(rt=et;rt--!==0;)if(!deepEqual(nt[rt],_e[rt]))return!1;return!0}if(it=Object.keys(nt),et=it.length,et!==Object.keys(_e).length)return!1;for(rt=et;rt--!==0;)if(!{}.hasOwnProperty.call(_e,it[rt]))return!1;for(rt=et;rt--!==0;){const st=it[rt];if(!(st==="_owner"&&nt.$$typeof)&&!deepEqual(nt[st],_e[st]))return!1}return!0}return nt!==nt&&_e!==_e}function getDPR(nt){return typeof window>"u"?1:(nt.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(nt,_e){const et=getDPR(nt);return Math.round(_e*et)/et}function useLatestRef(nt){const _e=reactExports.useRef(nt);return index$4(()=>{_e.current=nt}),_e}function useFloating(nt){nt===void 0&&(nt={});const{placement:_e="bottom",strategy:et="absolute",middleware:rt=[],platform:it,elements:{reference:st,floating:ot}={},transform:at=!0,whileElementsMounted:lt,open:ct}=nt,[ut,ht]=reactExports.useState({x:0,y:0,strategy:et,placement:_e,middlewareData:{},isPositioned:!1}),[dt,ft]=reactExports.useState(rt);deepEqual(dt,rt)||ft(rt);const[pt,mt]=reactExports.useState(null),[At,gt]=reactExports.useState(null),bt=reactExports.useCallback(Gt=>{Gt!==It.current&&(It.current=Gt,mt(Gt))},[]),Tt=reactExports.useCallback(Gt=>{Gt!==Lt.current&&(Lt.current=Gt,gt(Gt))},[]),wt=st||pt,Rt=ot||At,It=reactExports.useRef(null),Lt=reactExports.useRef(null),$t=reactExports.useRef(ut),kt=lt!=null,Dt=useLatestRef(lt),Ot=useLatestRef(it),zt=useLatestRef(ct),Ht=reactExports.useCallback(()=>{if(!It.current||!Lt.current)return;const Gt={placement:_e,strategy:et,middleware:dt};Ot.current&&(Gt.platform=Ot.current),computePosition(It.current,Lt.current,Gt).then(jt=>{const Kt={...jt,isPositioned:zt.current!==!1};Yt.current&&!deepEqual($t.current,Kt)&&($t.current=Kt,reactDomExports.flushSync(()=>{ht(Kt)}))})},[dt,_e,et,Ot,zt]);index$4(()=>{ct===!1&&$t.current.isPositioned&&($t.current.isPositioned=!1,ht(Gt=>({...Gt,isPositioned:!1})))},[ct]);const Yt=reactExports.useRef(!1);index$4(()=>(Yt.current=!0,()=>{Yt.current=!1}),[]),index$4(()=>{if(wt&&(It.current=wt),Rt&&(Lt.current=Rt),wt&&Rt){if(Dt.current)return Dt.current(wt,Rt,Ht);Ht()}},[wt,Rt,Ht,Dt,kt]);const Xt=reactExports.useMemo(()=>({reference:It,floating:Lt,setReference:bt,setFloating:Tt}),[bt,Tt]),Zt=reactExports.useMemo(()=>({reference:wt,floating:Rt}),[wt,Rt]),rn=reactExports.useMemo(()=>{const Gt={position:et,left:0,top:0};if(!Zt.floating)return Gt;const jt=roundByDPR(Zt.floating,ut.x),Kt=roundByDPR(Zt.floating,ut.y);return at?{...Gt,transform:"translate("+jt+"px, "+Kt+"px)",...getDPR(Zt.floating)>=1.5&&{willChange:"transform"}}:{position:et,left:jt,top:Kt}},[et,at,Zt.floating,ut.x,ut.y]);return reactExports.useMemo(()=>({...ut,update:Ht,refs:Xt,elements:Zt,floatingStyles:rn}),[ut,Ht,Xt,Zt,rn])}const arrow$1=nt=>{function _e(et){return{}.hasOwnProperty.call(et,"current")}return{name:"arrow",options:nt,fn(et){const{element:rt,padding:it}=typeof nt=="function"?nt(et):nt;return rt&&_e(rt)?rt.current!=null?arrow$2({element:rt.current,padding:it}).fn(et):{}:rt?arrow$2({element:rt,padding:it}).fn(et):{}}}},offset=(nt,_e)=>({...offset$1(nt),options:[nt,_e]}),shift=(nt,_e)=>({...shift$1(nt),options:[nt,_e]}),limitShift=(nt,_e)=>({...limitShift$1(nt),options:[nt,_e]}),flip$1=(nt,_e)=>({...flip$2(nt),options:[nt,_e]}),size=(nt,_e)=>({...size$1(nt),options:[nt,_e]}),hide=(nt,_e)=>({...hide$1(nt),options:[nt,_e]}),arrow=(nt,_e)=>({...arrow$1(nt),options:[nt,_e]});var NAME$1="Arrow",Arrow$1=reactExports.forwardRef((nt,_e)=>{const{children:et,width:rt=10,height:it=5,...st}=nt;return jsxRuntimeExports.jsx(Primitive.svg,{...st,ref:_e,width:rt,height:it,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:nt.asChild?et:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME$1;var Root$1=Arrow$1;function createContextScope(nt,_e=[]){let et=[];function rt(st,ot){const at=reactExports.createContext(ot),lt=et.length;et=[...et,ot];function ct(ht){const{scope:dt,children:ft,...pt}=ht,mt=(dt==null?void 0:dt[nt][lt])||at,At=reactExports.useMemo(()=>pt,Object.values(pt));return jsxRuntimeExports.jsx(mt.Provider,{value:At,children:ft})}function ut(ht,dt){const ft=(dt==null?void 0:dt[nt][lt])||at,pt=reactExports.useContext(ft);if(pt)return pt;if(ot!==void 0)return ot;throw new Error(`\`${ht}\` must be used within \`${st}\``)}return ct.displayName=st+"Provider",[ct,ut]}const it=()=>{const st=et.map(ot=>reactExports.createContext(ot));return function(at){const lt=(at==null?void 0:at[nt])||st;return reactExports.useMemo(()=>({[`__scope${nt}`]:{...at,[nt]:lt}}),[at,lt])}};return it.scopeName=nt,[rt,composeContextScopes(it,..._e)]}function composeContextScopes(...nt){const _e=nt[0];if(nt.length===1)return _e;const et=()=>{const rt=nt.map(it=>({useScope:it(),scopeName:it.scopeName}));return function(st){const ot=rt.reduce((at,{useScope:lt,scopeName:ct})=>{const ht=lt(st)[`__scope${ct}`];return{...at,...ht}},{});return reactExports.useMemo(()=>({[`__scope${_e.scopeName}`]:ot}),[ot])}};return et.scopeName=_e.scopeName,et}function useSize(nt){const[_e,et]=reactExports.useState(void 0);return useLayoutEffect2(()=>{if(nt){et({width:nt.offsetWidth,height:nt.offsetHeight});const rt=new ResizeObserver(it=>{if(!Array.isArray(it)||!it.length)return;const st=it[0];let ot,at;if("borderBoxSize"in st){const lt=st.borderBoxSize,ct=Array.isArray(lt)?lt[0]:lt;ot=ct.inlineSize,at=ct.blockSize}else ot=nt.offsetWidth,at=nt.offsetHeight;et({width:ot,height:at})});return rt.observe(nt,{box:"border-box"}),()=>rt.unobserve(nt)}else et(void 0)},[nt]),_e}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),Popper=nt=>{const{__scopePopper:_e,children:et}=nt,[rt,it]=reactExports.useState(null);return jsxRuntimeExports.jsx(PopperProvider,{scope:_e,anchor:rt,onAnchorChange:it,children:et})};Popper.displayName=POPPER_NAME;var ANCHOR_NAME="PopperAnchor",PopperAnchor=reactExports.forwardRef((nt,_e)=>{const{__scopePopper:et,virtualRef:rt,...it}=nt,st=usePopperContext(ANCHOR_NAME,et),ot=reactExports.useRef(null),at=useComposedRefs(_e,ot);return reactExports.useEffect(()=>{st.onAnchorChange((rt==null?void 0:rt.current)||ot.current)}),rt?null:jsxRuntimeExports.jsx(Primitive.div,{...it,ref:at})});PopperAnchor.displayName=ANCHOR_NAME;var CONTENT_NAME$1="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$1),PopperContent=reactExports.forwardRef((nt,_e)=>{var yn,$n,Jn,Xn,Vn,En;const{__scopePopper:et,side:rt="bottom",sideOffset:it=0,align:st="center",alignOffset:ot=0,arrowPadding:at=0,avoidCollisions:lt=!0,collisionBoundary:ct=[],collisionPadding:ut=0,sticky:ht="partial",hideWhenDetached:dt=!1,updatePositionStrategy:ft="optimized",onPlaced:pt,...mt}=nt,At=usePopperContext(CONTENT_NAME$1,et),[gt,bt]=reactExports.useState(null),Tt=useComposedRefs(_e,dn=>bt(dn)),[wt,Rt]=reactExports.useState(null),It=useSize(wt),Lt=(It==null?void 0:It.width)??0,$t=(It==null?void 0:It.height)??0,kt=rt+(st!=="center"?"-"+st:""),Dt=typeof ut=="number"?ut:{top:0,right:0,bottom:0,left:0,...ut},Ot=Array.isArray(ct)?ct:[ct],zt=Ot.length>0,Ht={padding:Dt,boundary:Ot.filter(isNotNull$1),altBoundary:zt},{refs:Yt,floatingStyles:Xt,placement:Zt,isPositioned:rn,middlewareData:Gt}=useFloating({strategy:"fixed",placement:kt,whileElementsMounted:(...dn)=>autoUpdate(...dn,{animationFrame:ft==="always"}),elements:{reference:At.anchor},middleware:[offset({mainAxis:it+$t,alignmentAxis:ot}),lt&&shift({mainAxis:!0,crossAxis:!1,limiter:ht==="partial"?limitShift():void 0,...Ht}),lt&&flip$1({...Ht}),size({...Ht,apply:({elements:dn,rects:rr,availableWidth:er,availableHeight:Yn})=>{const{width:ir,height:Qn}=rr.reference,sr=dn.floating.style;sr.setProperty("--radix-popper-available-width",`${er}px`),sr.setProperty("--radix-popper-available-height",`${Yn}px`),sr.setProperty("--radix-popper-anchor-width",`${ir}px`),sr.setProperty("--radix-popper-anchor-height",`${Qn}px`)}}),wt&&arrow({element:wt,padding:at}),transformOrigin({arrowWidth:Lt,arrowHeight:$t}),dt&&hide({strategy:"referenceHidden",...Ht})]}),[jt,Kt]=getSideAndAlignFromPlacement(Zt),Jt=useCallbackRef(pt);useLayoutEffect2(()=>{rn&&(Jt==null||Jt())},[rn,Jt]);const sn=(yn=Gt.arrow)==null?void 0:yn.x,hn=($n=Gt.arrow)==null?void 0:$n.y,an=((Jn=Gt.arrow)==null?void 0:Jn.centerOffset)!==0,[pn,_n]=reactExports.useState();return useLayoutEffect2(()=>{gt&&_n(window.getComputedStyle(gt).zIndex)},[gt]),jsxRuntimeExports.jsx("div",{ref:Yt.setFloating,"data-radix-popper-content-wrapper":"",style:{...Xt,transform:rn?Xt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:pn,"--radix-popper-transform-origin":[(Xn=Gt.transformOrigin)==null?void 0:Xn.x,(Vn=Gt.transformOrigin)==null?void 0:Vn.y].join(" "),...((En=Gt.hide)==null?void 0:En.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:nt.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:et,placedSide:jt,onArrowChange:Rt,arrowX:sn,arrowY:hn,shouldHideArrow:an,children:jsxRuntimeExports.jsx(Primitive.div,{"data-side":jt,"data-align":Kt,...mt,ref:Tt,style:{...mt.style,animation:rn?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$1;var ARROW_NAME$1="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function(_e,et){const{__scopePopper:rt,...it}=_e,st=useContentContext(ARROW_NAME$1,rt),ot=OPPOSITE_SIDE[st.placedSide];return jsxRuntimeExports.jsx("span",{ref:st.onArrowChange,style:{position:"absolute",left:st.arrowX,top:st.arrowY,[ot]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[st.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[st.placedSide],visibility:st.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root$1,{...it,ref:et,style:{...it.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$1;function isNotNull$1(nt){return nt!==null}var transformOrigin=nt=>({name:"transformOrigin",options:nt,fn(_e){var At,gt,bt;const{placement:et,rects:rt,middlewareData:it}=_e,ot=((At=it.arrow)==null?void 0:At.centerOffset)!==0,at=ot?0:nt.arrowWidth,lt=ot?0:nt.arrowHeight,[ct,ut]=getSideAndAlignFromPlacement(et),ht={start:"0%",center:"50%",end:"100%"}[ut],dt=(((gt=it.arrow)==null?void 0:gt.x)??0)+at/2,ft=(((bt=it.arrow)==null?void 0:bt.y)??0)+lt/2;let pt="",mt="";return ct==="bottom"?(pt=ot?ht:`${dt}px`,mt=`${-lt}px`):ct==="top"?(pt=ot?ht:`${dt}px`,mt=`${rt.floating.height+lt}px`):ct==="right"?(pt=`${-lt}px`,mt=ot?ht:`${ft}px`):ct==="left"&&(pt=`${rt.floating.width+lt}px`,mt=ot?ht:`${ft}px`),{data:{x:pt,y:mt}}}});function getSideAndAlignFromPlacement(nt){const[_e,et="center"]=nt.split("-");return[_e,et]}var Root2=Popper,Anchor=PopperAnchor,Content=PopperContent,Arrow=PopperArrow;function useStateMachine(nt,_e){return reactExports.useReducer((et,rt)=>_e[et][rt]??et,nt)}var Presence=nt=>{const{present:_e,children:et}=nt,rt=usePresence$1(_e),it=typeof et=="function"?et({present:rt.isPresent}):reactExports.Children.only(et),st=useComposedRefs(rt.ref,getElementRef(it));return typeof et=="function"||rt.isPresent?reactExports.cloneElement(it,{ref:st}):null};Presence.displayName="Presence";function usePresence$1(nt){const[_e,et]=reactExports.useState(),rt=reactExports.useRef({}),it=reactExports.useRef(nt),st=reactExports.useRef("none"),ot=nt?"mounted":"unmounted",[at,lt]=useStateMachine(ot,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const ct=getAnimationName(rt.current);st.current=at==="mounted"?ct:"none"},[at]),useLayoutEffect2(()=>{const ct=rt.current,ut=it.current;if(ut!==nt){const dt=st.current,ft=getAnimationName(ct);nt?lt("MOUNT"):ft==="none"||(ct==null?void 0:ct.display)==="none"?lt("UNMOUNT"):lt(ut&&dt!==ft?"ANIMATION_OUT":"UNMOUNT"),it.current=nt}},[nt,lt]),useLayoutEffect2(()=>{if(_e){let ct;const ut=_e.ownerDocument.defaultView??window,ht=ft=>{const mt=getAnimationName(rt.current).includes(ft.animationName);if(ft.target===_e&&mt&&(lt("ANIMATION_END"),!it.current)){const At=_e.style.animationFillMode;_e.style.animationFillMode="forwards",ct=ut.setTimeout(()=>{_e.style.animationFillMode==="forwards"&&(_e.style.animationFillMode=At)})}},dt=ft=>{ft.target===_e&&(st.current=getAnimationName(rt.current))};return _e.addEventListener("animationstart",dt),_e.addEventListener("animationcancel",ht),_e.addEventListener("animationend",ht),()=>{ut.clearTimeout(ct),_e.removeEventListener("animationstart",dt),_e.removeEventListener("animationcancel",ht),_e.removeEventListener("animationend",ht)}}else lt("ANIMATION_END")},[_e,lt]),{isPresent:["mounted","unmountSuspended"].includes(at),ref:reactExports.useCallback(ct=>{ct&&(rt.current=getComputedStyle(ct)),et(ct)},[])}}function getAnimationName(nt){return(nt==null?void 0:nt.animationName)||"none"}function getElementRef(nt){var rt,it;let _e=(rt=Object.getOwnPropertyDescriptor(nt.props,"ref"))==null?void 0:rt.get,et=_e&&"isReactWarning"in _e&&_e.isReactWarning;return et?nt.ref:(_e=(it=Object.getOwnPropertyDescriptor(nt,"ref"))==null?void 0:it.get,et=_e&&"isReactWarning"in _e&&_e.isReactWarning,et?nt.props.ref:nt.props.ref||nt.ref)}function useControllableState({prop:nt,defaultProp:_e,onChange:et=()=>{}}){const[rt,it]=useUncontrolledState({defaultProp:_e,onChange:et}),st=nt!==void 0,ot=st?nt:rt,at=useCallbackRef(et),lt=reactExports.useCallback(ct=>{if(st){const ht=typeof ct=="function"?ct(nt):ct;ht!==nt&&at(ht)}else it(ct)},[st,nt,it,at]);return[ot,lt]}function useUncontrolledState({defaultProp:nt,onChange:_e}){const et=reactExports.useState(nt),[rt]=et,it=reactExports.useRef(rt),st=useCallbackRef(_e);return reactExports.useEffect(()=>{it.current!==rt&&(st(rt),it.current=rt)},[rt,it,st]),et}var NAME="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((nt,_e)=>jsxRuntimeExports.jsx(Primitive.span,{...nt,ref:_e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...nt.style}}));VisuallyHidden.displayName=NAME;var Root=VisuallyHidden,[createTooltipContext,createTooltipScope]=createContextScope$1("Tooltip",[createPopperScope]),usePopperScope=createPopperScope(),PROVIDER_NAME="TooltipProvider",TOOLTIP_OPEN="tooltip.open",[TooltipProviderContextProvider,useTooltipProviderContext]=createTooltipContext(PROVIDER_NAME),TOOLTIP_NAME="Tooltip",[TooltipContextProvider,useTooltipContext]=createTooltipContext(TOOLTIP_NAME),Tooltip=nt=>{const{__scopeTooltip:_e,children:et,open:rt,defaultOpen:it=!1,onOpenChange:st,disableHoverableContent:ot,delayDuration:at}=nt,lt=useTooltipProviderContext(TOOLTIP_NAME,nt.__scopeTooltip),ct=usePopperScope(_e),[ut,ht]=reactExports.useState(null),dt=useId(),ft=reactExports.useRef(0),pt=ot??lt.disableHoverableContent,mt=at??lt.delayDuration,At=reactExports.useRef(!1),[gt=!1,bt]=useControllableState({prop:rt,defaultProp:it,onChange:Lt=>{Lt?(lt.onOpen(),document.dispatchEvent(new CustomEvent(TOOLTIP_OPEN))):lt.onClose(),st==null||st(Lt)}}),Tt=reactExports.useMemo(()=>gt?At.current?"delayed-open":"instant-open":"closed",[gt]),wt=reactExports.useCallback(()=>{window.clearTimeout(ft.current),At.current=!1,bt(!0)},[bt]),Rt=reactExports.useCallback(()=>{window.clearTimeout(ft.current),bt(!1)},[bt]),It=reactExports.useCallback(()=>{window.clearTimeout(ft.current),ft.current=window.setTimeout(()=>{At.current=!0,bt(!0)},mt)},[mt,bt]);return reactExports.useEffect(()=>()=>window.clearTimeout(ft.current),[]),jsxRuntimeExports.jsx(Root2,{...ct,children:jsxRuntimeExports.jsx(TooltipContextProvider,{scope:_e,contentId:dt,open:gt,stateAttribute:Tt,trigger:ut,onTriggerChange:ht,onTriggerEnter:reactExports.useCallback(()=>{lt.isOpenDelayed?It():wt()},[lt.isOpenDelayed,It,wt]),onTriggerLeave:reactExports.useCallback(()=>{pt?Rt():window.clearTimeout(ft.current)},[Rt,pt]),onOpen:wt,onClose:Rt,disableHoverableContent:pt,children:et})})};Tooltip.displayName=TOOLTIP_NAME;var TRIGGER_NAME="TooltipTrigger",TooltipTrigger=reactExports.forwardRef((nt,_e)=>{const{__scopeTooltip:et,...rt}=nt,it=useTooltipContext(TRIGGER_NAME,et),st=useTooltipProviderContext(TRIGGER_NAME,et),ot=usePopperScope(et),at=reactExports.useRef(null),lt=useComposedRefs(_e,at,it.onTriggerChange),ct=reactExports.useRef(!1),ut=reactExports.useRef(!1),ht=reactExports.useCallback(()=>ct.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",ht),[ht]),jsxRuntimeExports.jsx(Anchor,{asChild:!0,...ot,children:jsxRuntimeExports.jsx(Primitive.button,{"aria-describedby":it.open?it.contentId:void 0,"data-state":it.stateAttribute,...rt,ref:lt,onPointerMove:composeEventHandlers$1(nt.onPointerMove,dt=>{dt.pointerType!=="touch"&&!ut.current&&!st.isPointerInTransitRef.current&&(it.onTriggerEnter(),ut.current=!0)}),onPointerLeave:composeEventHandlers$1(nt.onPointerLeave,()=>{it.onTriggerLeave(),ut.current=!1}),onPointerDown:composeEventHandlers$1(nt.onPointerDown,()=>{ct.current=!0,document.addEventListener("pointerup",ht,{once:!0})}),onFocus:composeEventHandlers$1(nt.onFocus,()=>{ct.current||it.onOpen()}),onBlur:composeEventHandlers$1(nt.onBlur,it.onClose),onClick:composeEventHandlers$1(nt.onClick,it.onClose)})})});TooltipTrigger.displayName=TRIGGER_NAME;var PORTAL_NAME="TooltipPortal",[PortalProvider,usePortalContext]=createTooltipContext(PORTAL_NAME,{forceMount:void 0}),CONTENT_NAME="TooltipContent",TooltipContent=reactExports.forwardRef((nt,_e)=>{const et=usePortalContext(CONTENT_NAME,nt.__scopeTooltip),{forceMount:rt=et.forceMount,side:it="top",...st}=nt,ot=useTooltipContext(CONTENT_NAME,nt.__scopeTooltip);return jsxRuntimeExports.jsx(Presence,{present:rt||ot.open,children:ot.disableHoverableContent?jsxRuntimeExports.jsx(TooltipContentImpl,{side:it,...st,ref:_e}):jsxRuntimeExports.jsx(TooltipContentHoverable,{side:it,...st,ref:_e})})}),TooltipContentHoverable=reactExports.forwardRef((nt,_e)=>{const et=useTooltipContext(CONTENT_NAME,nt.__scopeTooltip),rt=useTooltipProviderContext(CONTENT_NAME,nt.__scopeTooltip),it=reactExports.useRef(null),st=useComposedRefs(_e,it),[ot,at]=reactExports.useState(null),{trigger:lt,onClose:ct}=et,ut=it.current,{onPointerInTransitChange:ht}=rt,dt=reactExports.useCallback(()=>{at(null),ht(!1)},[ht]),ft=reactExports.useCallback((pt,mt)=>{const At=pt.currentTarget,gt={x:pt.clientX,y:pt.clientY},bt=getExitSideFromRect(gt,At.getBoundingClientRect()),Tt=getPaddedExitPoints(gt,bt),wt=getPointsFromRect(mt.getBoundingClientRect()),Rt=getHull([...Tt,...wt]);at(Rt),ht(!0)},[ht]);return reactExports.useEffect(()=>()=>dt(),[dt]),reactExports.useEffect(()=>{if(lt&&ut){const pt=At=>ft(At,ut),mt=At=>ft(At,lt);return lt.addEventListener("pointerleave",pt),ut.addEventListener("pointerleave",mt),()=>{lt.removeEventListener("pointerleave",pt),ut.removeEventListener("pointerleave",mt)}}},[lt,ut,ft,dt]),reactExports.useEffect(()=>{if(ot){const pt=mt=>{const At=mt.target,gt={x:mt.clientX,y:mt.clientY},bt=(lt==null?void 0:lt.contains(At))||(ut==null?void 0:ut.contains(At)),Tt=!isPointInPolygon(gt,ot);bt?dt():Tt&&(dt(),ct())};return document.addEventListener("pointermove",pt),()=>document.removeEventListener("pointermove",pt)}},[lt,ut,ot,ct,dt]),jsxRuntimeExports.jsx(TooltipContentImpl,{...nt,ref:st})}),[VisuallyHiddenContentContextProvider,useVisuallyHiddenContentContext]=createTooltipContext(TOOLTIP_NAME,{isInside:!1}),TooltipContentImpl=reactExports.forwardRef((nt,_e)=>{const{__scopeTooltip:et,children:rt,"aria-label":it,onEscapeKeyDown:st,onPointerDownOutside:ot,...at}=nt,lt=useTooltipContext(CONTENT_NAME,et),ct=usePopperScope(et),{onClose:ut}=lt;return reactExports.useEffect(()=>(document.addEventListener(TOOLTIP_OPEN,ut),()=>document.removeEventListener(TOOLTIP_OPEN,ut)),[ut]),reactExports.useEffect(()=>{if(lt.trigger){const ht=dt=>{const ft=dt.target;ft!=null&&ft.contains(lt.trigger)&&ut()};return window.addEventListener("scroll",ht,{capture:!0}),()=>window.removeEventListener("scroll",ht,{capture:!0})}},[lt.trigger,ut]),jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:st,onPointerDownOutside:ot,onFocusOutside:ht=>ht.preventDefault(),onDismiss:ut,children:jsxRuntimeExports.jsxs(Content,{"data-state":lt.stateAttribute,...ct,...at,ref:_e,style:{...at.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[jsxRuntimeExports.jsx(Slottable,{children:rt}),jsxRuntimeExports.jsx(VisuallyHiddenContentContextProvider,{scope:et,isInside:!0,children:jsxRuntimeExports.jsx(Root,{id:lt.contentId,role:"tooltip",children:it||rt})})]})})});TooltipContent.displayName=CONTENT_NAME;var ARROW_NAME="TooltipArrow",TooltipArrow=reactExports.forwardRef((nt,_e)=>{const{__scopeTooltip:et,...rt}=nt,it=usePopperScope(et);return useVisuallyHiddenContentContext(ARROW_NAME,et).isInside?null:jsxRuntimeExports.jsx(Arrow,{...it,...rt,ref:_e})});TooltipArrow.displayName=ARROW_NAME;function getExitSideFromRect(nt,_e){const et=Math.abs(_e.top-nt.y),rt=Math.abs(_e.bottom-nt.y),it=Math.abs(_e.right-nt.x),st=Math.abs(_e.left-nt.x);switch(Math.min(et,rt,it,st)){case st:return"left";case it:return"right";case et:return"top";case rt:return"bottom";default:throw new Error("unreachable")}}function getPaddedExitPoints(nt,_e,et=5){const rt=[];switch(_e){case"top":rt.push({x:nt.x-et,y:nt.y+et},{x:nt.x+et,y:nt.y+et});break;case"bottom":rt.push({x:nt.x-et,y:nt.y-et},{x:nt.x+et,y:nt.y-et});break;case"left":rt.push({x:nt.x+et,y:nt.y-et},{x:nt.x+et,y:nt.y+et});break;case"right":rt.push({x:nt.x-et,y:nt.y-et},{x:nt.x-et,y:nt.y+et});break}return rt}function getPointsFromRect(nt){const{top:_e,right:et,bottom:rt,left:it}=nt;return[{x:it,y:_e},{x:et,y:_e},{x:et,y:rt},{x:it,y:rt}]}function isPointInPolygon(nt,_e){const{x:et,y:rt}=nt;let it=!1;for(let st=0,ot=_e.length-1;st<_e.length;ot=st++){const at=_e[st].x,lt=_e[st].y,ct=_e[ot].x,ut=_e[ot].y;lt>rt!=ut>rt&&et<(ct-at)*(rt-lt)/(ut-lt)+at&&(it=!it)}return it}function getHull(nt){const _e=nt.slice();return _e.sort((et,rt)=>et.x<rt.x?-1:et.x>rt.x?1:et.y<rt.y?-1:et.y>rt.y?1:0),getHullPresorted(_e)}function getHullPresorted(nt){if(nt.length<=1)return nt.slice();const _e=[];for(let rt=0;rt<nt.length;rt++){const it=nt[rt];for(;_e.length>=2;){const st=_e[_e.length-1],ot=_e[_e.length-2];if((st.x-ot.x)*(it.y-ot.y)>=(st.y-ot.y)*(it.x-ot.x))_e.pop();else break}_e.push(it)}_e.pop();const et=[];for(let rt=nt.length-1;rt>=0;rt--){const it=nt[rt];for(;et.length>=2;){const st=et[et.length-1],ot=et[et.length-2];if((st.x-ot.x)*(it.y-ot.y)>=(st.y-ot.y)*(it.x-ot.x))et.pop();else break}et.push(it)}return et.pop(),_e.length===1&&et.length===1&&_e[0].x===et[0].x&&_e[0].y===et[0].y?_e:_e.concat(et)}var Root3=Tooltip,Trigger=TooltipTrigger,Content2=TooltipContent,Arrow2=TooltipArrow;function _objectWithoutPropertiesLoose$5(nt,_e){if(nt==null)return{};var et={},rt=Object.keys(nt),it,st;for(st=0;st<rt.length;st++)it=rt[st],!(_e.indexOf(it)>=0)&&(et[it]=nt[it]);return et}function _objectWithoutProperties$5(nt,_e){if(nt==null)return{};var et=_objectWithoutPropertiesLoose$5(nt,_e),rt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(it=0;it<st.length;it++)rt=st[it],!(_e.indexOf(rt)>=0)&&Object.prototype.propertyIsEnumerable.call(nt,rt)&&(et[rt]=nt[rt])}return et}let LevaErrors;(function(nt){nt[nt.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",nt[nt.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",nt[nt.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",nt[nt.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",nt[nt.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",nt[nt.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",nt[nt.THEME_ERROR=6]="THEME_ERROR",nt[nt.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",nt[nt.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",nt[nt.EMPTY_KEY=9]="EMPTY_KEY"})(LevaErrors||(LevaErrors={}));const ErrorList={[LevaErrors.UNSUPPORTED_INPUT]:(nt,_e)=>[`An input with type \`${nt}\` input was found at path \`${_e}\` but it's not supported yet.`],[LevaErrors.NO_COMPONENT_FOR_TYPE]:(nt,_e)=>[`Type \`${nt}\` found at path \`${_e}\` can't be displayed in panel because no component supports it yet.`],[LevaErrors.UNKNOWN_INPUT]:(nt,_e)=>[`input at path \`${nt}\` is not recognized.`,_e],[LevaErrors.DUPLICATE_KEYS]:(nt,_e,et)=>[`Key \`${nt}\` of path \`${_e}\` already exists at path \`${et}\`. Even nested keys need to be unique. Rename one of the keys.`],[LevaErrors.ALREADY_REGISTERED_TYPE]:nt=>[`Type ${nt} has already been registered. You can't register a component with the same type.`],[LevaErrors.CLIPBOARD_ERROR]:nt=>["Error copying the value",nt],[LevaErrors.THEME_ERROR]:(nt,_e)=>[`Error accessing the theme \`${nt}.${_e}\` value.`],[LevaErrors.PATH_DOESNT_EXIST]:nt=>[`Error getting the value at path \`${nt}\`. There is probably an error in your \`render\` function.`],[LevaErrors.PATH_DOESNT_EXIST]:nt=>[`Error accessing the value at path \`${nt}\``],[LevaErrors.INPUT_TYPE_OVERRIDE]:(nt,_e,et)=>[`Input at path \`${nt}\` already exists with type: \`${_e}\`. Its type cannot be overridden with type \`${et}\`.`],[LevaErrors.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function _log(nt,_e,...et){const[rt,...it]=ErrorList[_e](...et);console[nt]("LEVA: "+rt,...it)}const warn=_log.bind(null,"warn"),log$1=_log.bind(null,"log"),_excluded$a=["value"],_excluded2$4=["schema"],_excluded3$1=["value"],Schemas=[],Plugins={};function getValueType$1(nt){let{value:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded$a);for(let rt of Schemas){const it=rt(_e,et);if(it)return it}}function register(nt,_e){let{schema:et}=_e,rt=_objectWithoutProperties$5(_e,_excluded2$4);if(nt in Plugins){warn(LevaErrors.ALREADY_REGISTERED_TYPE,nt);return}Schemas.push((it,st)=>et(it,st)&&nt),Plugins[nt]=rt}function createInternalPlugin(nt){return nt}function normalize$3$2(nt,_e,et,rt){const{normalize:it}=Plugins[nt];if(it)return it(_e,et,rt);if(typeof _e!="object"||!("value"in _e))return{value:_e};const{value:st}=_e,ot=_objectWithoutProperties$5(_e,_excluded3$1);return{value:st,settings:ot}}function sanitize$4(nt,_e,et,rt,it,st){const{sanitize:ot}=Plugins[nt];return ot?ot(_e,et,rt,it,st):_e}function format$2$1(nt,_e,et){const{format:rt}=Plugins[nt];return rt?rt(_e,et):_e}function _defineProperty$9(nt,_e,et){return _e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function ownKeys$6(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread2$4(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$6(Object(et),!0).forEach(function(rt){_defineProperty$9(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$6(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}const clamp$6=(nt,_e,et)=>nt>et?et:nt<_e?_e:nt,parseNumber=nt=>{if(nt===""||typeof nt=="number")return nt;try{const _e=evaluate(nt);if(!isNaN(_e))return _e}catch{}return parseFloat(nt)},log10=Math.log(10);function getStep(nt){let _e=Math.abs(+String(nt).replace(".",""));if(_e===0)return .01;for(;_e!==0&&_e%10===0;)_e/=10;const et=Math.floor(Math.log(_e)/log10)+1,rt=Math.floor(Math.log10(Math.abs(nt))),it=Math.pow(10,rt-et);return Math.max(it,.001)}const range$2=(nt,_e,et)=>et===_e?0:(clamp$6(nt,_e,et)-_e)/(et-_e),invertedRange=(nt,_e,et)=>nt*(et-_e)+_e,getUid=()=>"_"+Math.random().toString(36).substr(2,9),parens=/\(([0-9+\-*/^ .]+)\)/,exp$2=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,mul$1=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,div$1=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,add$1=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,sub$1=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function evaluate(nt){if(isNaN(Number(nt)))if(parens.test(nt)){const _e=nt.replace(parens,(et,rt)=>String(evaluate(rt)));return evaluate(_e)}else if(exp$2.test(nt)){const _e=nt.replace(exp$2,(et,rt,it)=>String(Math.pow(Number(rt),Number(it))));return evaluate(_e)}else if(mul$1.test(nt)){const _e=nt.replace(mul$1,(et,rt,it)=>String(Number(rt)*Number(it)));return evaluate(_e)}else if(div$1.test(nt)){const _e=nt.replace(div$1,(et,rt,it)=>{if(it!=0)return String(Number(rt)/Number(it));throw new Error("Division by zero")});return evaluate(_e)}else if(add$1.test(nt)){const _e=nt.replace(add$1,(et,rt,it)=>String(Number(rt)+Number(it)));return evaluate(_e)}else if(sub$1.test(nt)){const _e=nt.replace(sub$1,(et,rt,it)=>String(Number(rt)-Number(it)));return evaluate(_e)}else return Number(nt);return Number(nt)}function omit$1(nt,_e){const et=_objectSpread2$4({},nt);return _e.forEach(rt=>rt in nt&&delete et[rt]),et}function mapArrayToKeys(nt,_e){return nt.reduce((et,rt,it)=>Object.assign(et,{[_e[it]]:rt}),{})}function isObject$9(nt){return Object.prototype.toString.call(nt)==="[object Object]"}const isEmptyObject=nt=>isObject$9(nt)&&Object.keys(nt).length===0;let SpecialInputs;(function(nt){nt.BUTTON="BUTTON",nt.BUTTON_GROUP="BUTTON_GROUP",nt.MONITOR="MONITOR",nt.FOLDER="FOLDER"})(SpecialInputs||(SpecialInputs={}));let LevaInputs;(function(nt){nt.SELECT="SELECT",nt.IMAGE="IMAGE",nt.NUMBER="NUMBER",nt.COLOR="COLOR",nt.STRING="STRING",nt.BOOLEAN="BOOLEAN",nt.INTERVAL="INTERVAL",nt.VECTOR3D="VECTOR3D",nt.VECTOR2D="VECTOR2D"})(LevaInputs||(LevaInputs={}));const _excluded$9=["type","__customInput"],_excluded2$3=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],_excluded3$2=["type"];function parseOptions$1(nt,_e,et={},rt){var it,st;if(typeof nt!="object"||Array.isArray(nt))return{type:rt,input:nt,options:_objectSpread2$4({key:_e,label:_e,optional:!1,disabled:!1,order:0},et)};if("__customInput"in nt){const{type:Rt,__customInput:It}=nt,Lt=_objectWithoutProperties$5(nt,_excluded$9);return parseOptions$1(It,_e,Lt,Rt)}const{render:ot,label:at,optional:lt,order:ct=0,disabled:ut,hint:ht,onChange:dt,onEditStart:ft,onEditEnd:pt,transient:mt}=nt,At=_objectWithoutProperties$5(nt,_excluded2$3),gt=_objectSpread2$4({render:ot,key:_e,label:at??_e,hint:ht,transient:mt??!!dt,onEditStart:ft,onEditEnd:pt,disabled:ut,optional:lt,order:ct},et);let{type:bt}=At,Tt=_objectWithoutProperties$5(At,_excluded3$2);if(bt=rt??bt,bt in SpecialInputs)return{type:bt,input:Tt,options:gt};let wt;return rt&&isObject$9(Tt)&&"value"in Tt?wt=Tt.value:wt=isEmptyObject(Tt)?void 0:Tt,{type:bt,input:wt,options:_objectSpread2$4(_objectSpread2$4({},gt),{},{onChange:dt,optional:(it=gt.optional)!==null&&it!==void 0?it:!1,disabled:(st=gt.disabled)!==null&&st!==void 0?st:!1})}}function normalizeInput(nt,_e,et,rt){const it=parseOptions$1(nt,_e),{type:st,input:ot,options:at}=it;if(st)return st in SpecialInputs?it:{type:st,input:normalize$3$2(st,ot,et,rt),options:at};let lt=getValueType$1(ot);return lt?{type:lt,input:normalize$3$2(lt,ot,et,rt),options:at}:(lt=getValueType$1({value:ot}),lt?{type:lt,input:normalize$3$2(lt,{value:ot},et,rt),options:at}:!1)}function updateInput(nt,_e,et,rt,it){const{value:st,type:ot,settings:at}=nt;nt.value=sanitizeValue({type:ot,value:st,settings:at},_e,et,rt),nt.fromPanel=it}const ValueError=function(_e,et,rt){this.type="LEVA_ERROR",this.message="LEVA: "+_e,this.previousValue=et,this.error=rt};function sanitizeValue({type:nt,value:_e,settings:et},rt,it,st){const ot=nt!=="SELECT"&&typeof rt=="function"?rt(_e):rt;let at;try{at=sanitize$4(nt,ot,et,_e,it,st)}catch(lt){throw new ValueError(`The value \`${rt}\` did not result in a correct value.`,_e,lt)}return dequal(at,_e)?_e:at}const debounce$2=(nt,_e,et=!1)=>{let rt=0;return function(){const it=arguments,st=et&&!rt,ot=()=>nt.apply(this,it);window.clearTimeout(rt),rt=window.setTimeout(ot,_e),st&&ot()}},multiplyStep=nt=>nt.shiftKey?5:nt.altKey?1/5:1,_excluded$8$1=["value"],_excluded2$2$1=["min","max"],schema$3=nt=>{if(typeof nt=="number")return!0;if(typeof nt=="string"){const _e=parseFloat(nt);return isNaN(_e)?!1:nt.substring((""+_e).length).trim().length<4}return!1},sanitize$3$1=(nt,{min:_e=-1/0,max:et=1/0,suffix:rt})=>{const it=parseFloat(nt);if(nt===""||isNaN(it))throw Error("Invalid number");const st=clamp$6(it,_e,et);return rt?st+rt:st},format$1$2=(nt,{pad:_e=0,suffix:et})=>{const rt=parseFloat(nt).toFixed(_e);return et?rt+et:rt},normalize$2$2=nt=>{let{value:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded$8$1);const{min:rt=-1/0,max:it=1/0}=et,st=_objectWithoutProperties$5(et,_excluded2$2$1);let ot=parseFloat(_e);const at=typeof _e=="string"?_e.substring((""+ot).length):void 0;ot=clamp$6(ot,rt,it);let lt=et.step;lt||(Number.isFinite(rt)?Number.isFinite(it)?lt=+(Math.abs(it-rt)/100).toPrecision(1):lt=+(Math.abs(ot-rt)/100).toPrecision(1):Number.isFinite(it)&&(lt=+(Math.abs(it-ot)/100).toPrecision(1)));const ct=lt?getStep(lt)*10:getStep(ot);lt=lt||ct/10;const ut=Math.round(clamp$6(Math.log10(1/ct),0,2));return{value:at?ot+at:ot,settings:_objectSpread2$4({initialValue:ot,step:lt,pad:ut,min:rt,max:it,suffix:at},st)}},sanitizeStep$1=(nt,{step:_e,initialValue:et})=>{const rt=Math.round((nt-et)/_e);return et+rt*_e};var props$3=Object.freeze({__proto__:null,schema:schema$3,sanitize:sanitize$3$1,format:format$1$2,normalize:normalize$2$2,sanitizeStep:sanitizeStep$1});function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e];for(var rt in et)Object.prototype.hasOwnProperty.call(et,rt)&&(nt[rt]=et[rt])}return nt},_extends$3.apply(this,arguments)}const InputContext=reactExports.createContext({});function useInputContext(){return reactExports.useContext(InputContext)}const ThemeContext=reactExports.createContext(null),StoreContext=reactExports.createContext(null),PanelSettingsContext=reactExports.createContext(null);function useStoreContext(){return reactExports.useContext(StoreContext)}function usePanelSettingsContext(){return reactExports.useContext(PanelSettingsContext)}const getDefaultTheme=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function createStateClass(nt,_e){const[et,rt]=nt.split(" "),it={};return et!=="none"&&(it.boxShadow=`${_e.inset?"inset ":""}0 0 0 $borderWidths${[_e.key]} $colors${et!=="default"&&et||_e.borderColor}`),rt&&(it.backgroundColor=rt),it}const utils={$inputStyle:()=>nt=>createStateClass(nt,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>nt=>createStateClass(nt,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>nt=>createStateClass(nt,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>nt=>createStateClass(nt,{key:"$active",borderColor:"$accent1",inset:!0})},{styled,css,createTheme,globalCss,keyframes:keyframes$1}=q$1({prefix:"leva",theme:getDefaultTheme(),utils:_objectSpread2$4(_objectSpread2$4({},utils),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:nt=>({"&:focus":utils.$focusStyle()(nt)}),$focusWithin:nt=>({"&:focus-within":utils.$focusStyle()(nt)}),$hover:nt=>({"&:hover":utils.$hoverStyle()(nt)}),$active:nt=>({"&:active":utils.$activeStyle()(nt)})})}),globalStyles=globalCss({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function useTh(nt,_e){const{theme:et}=reactExports.useContext(ThemeContext);if(!(nt in et)||!(_e in et[nt]))return warn(LevaErrors.THEME_ERROR,nt,_e),"";let rt=_e;for(;;){let it=et[nt][rt];if(typeof it=="string"&&it.charAt(0)==="$")rt=it.substr(1);else return it}}const StyledInput=styled("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),InnerLabel=styled("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${StyledInput}`]:{paddingLeft:0}}),InnerNumberLabel=styled(InnerLabel,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),InputContainer=styled("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),_excluded$7$1=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],_excluded2$1$1=["onUpdate"];function ValueInput(nt){let{innerLabel:_e,value:et,onUpdate:rt,onChange:it,onKeyDown:st,type:ot,id:at,inputType:lt="text",rows:ct=0}=nt,ut=_objectWithoutProperties$5(nt,_excluded$7$1);const{id:ht,emitOnEditStart:dt,emitOnEditEnd:ft,disabled:pt}=useInputContext(),mt=at||ht,At=reactExports.useRef(null),gt=ct>0,bt=gt?"textarea":"input",Tt=reactExports.useCallback(It=>Lt=>{const $t=Lt.currentTarget.value;It($t)},[]);React.useEffect(()=>{const It=At.current,Lt=Tt($t=>{rt($t),ft()});return It==null||It.addEventListener("blur",Lt),()=>It==null?void 0:It.removeEventListener("blur",Lt)},[Tt,rt,ft]);const wt=reactExports.useCallback(It=>{It.key==="Enter"&&Tt(rt)(It)},[Tt,rt]),Rt=Object.assign({as:bt},gt?{rows:ct}:{},ut);return React.createElement(InputContainer,{textArea:gt},_e&&typeof _e=="string"?React.createElement(InnerLabel,null,_e):_e,React.createElement(StyledInput,_extends$3({levaType:ot,ref:At,id:mt,type:lt,autoComplete:"off",spellCheck:"false",value:et,onChange:Tt(it),onFocus:()=>dt(),onKeyPress:wt,onKeyDown:st,disabled:pt},Rt)))}function NumberInput(nt){let{onUpdate:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded2$1$1);const rt=reactExports.useCallback(st=>_e(parseNumber(st)),[_e]),it=reactExports.useCallback(st=>{const ot=st.key==="ArrowUp"?1:st.key==="ArrowDown"?-1:0;if(ot){st.preventDefault();const at=st.altKey?.1:st.shiftKey?10:1;_e(lt=>parseFloat(lt)+ot*at)}},[_e]);return React.createElement(ValueInput,_extends$3({},et,{onUpdate:rt,onKeyDown:it,type:"number"}))}const StyledFolder=styled("div",{}),StyledWrapper=styled("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),StyledTitle=styled("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & > svg`]:{opacity:1}}),StyledContent=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${StyledFolder}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),StyledRow=styled("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${StyledContent} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),StyledInputRow=styled(StyledRow,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),CopyLabelContainer=styled("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),StyledOptionalToggle=styled("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),StyledLabel=styled("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),StyledInputWrapper$1=styled("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${StyledLabel}`]:{pointerEvents:"auto"}}}}}),Overlay=styled("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),StyledToolTipContent=styled("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),ToolTipArrow=styled(Arrow2,{fill:"$toolTipBackground"});function Portal$1({children:nt}){const{className:_e}=reactExports.useContext(ThemeContext);return React.createElement(Root$2,{className:_e},nt)}const _excluded$6$1=["align"];function OptionalToggle(){const{id:nt,disable:_e,disabled:et}=useInputContext();return React.createElement(React.Fragment,null,React.createElement(StyledOptionalToggle,{id:nt+"__disable",type:"checkbox",checked:!et,onChange:()=>_e(!et)}),React.createElement("label",{htmlFor:nt+"__disable"}))}function RawLabel(nt){const{id:_e,optional:et,hint:rt}=useInputContext(),it=nt.htmlFor||(_e?{htmlFor:_e}:null),st=!rt&&typeof nt.children=="string"?{title:nt.children}:null;return React.createElement(React.Fragment,null,et&&React.createElement(OptionalToggle,null),rt!==void 0?React.createElement(Root3,null,React.createElement(Trigger,{asChild:!0},React.createElement(StyledLabel,_extends$3({},it,nt))),React.createElement(Content2,{side:"top",sideOffset:2},React.createElement(StyledToolTipContent,null,rt,React.createElement(ToolTipArrow,null)))):React.createElement(StyledLabel,_extends$3({},it,st,nt)))}function Label(nt){let{align:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded$6$1);const{value:rt,label:it,key:st,disabled:ot}=useInputContext(),{hideCopyButton:at}=usePanelSettingsContext(),lt=!at&&st!==void 0,[ct,ut]=reactExports.useState(!1),ht=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[st]:rt??""})),ut(!0)}catch{warn(LevaErrors.CLIPBOARD_ERROR,{[st]:rt})}};return React.createElement(CopyLabelContainer,{align:_e,onPointerLeave:()=>ut(!1)},React.createElement(RawLabel,et),lt&&!ot&&React.createElement("div",{title:`Click to copy ${typeof it=="string"?it:st} value`},ct?React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),React.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):React.createElement("svg",{onClick:ht,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),React.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const _excluded$5$1=["toggled"],Svg=styled("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function Chevron(nt){let{toggled:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded$5$1);return React.createElement(Svg,_extends$3({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${_e?0:-90}deg)`}},et),React.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const _excluded$4$1=["input"];function Row$1(nt){let{input:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded$4$1);return _e?React.createElement(StyledInputRow,et):React.createElement(StyledRow,et)}function useInputSetters({value:nt,type:_e,settings:et,setValue:rt}){const[it,st]=reactExports.useState(format$2$1(_e,nt,et)),ot=reactExports.useRef(nt),at=reactExports.useRef(et);at.current=et;const lt=reactExports.useCallback(ut=>st(format$2$1(_e,ut,at.current)),[_e]),ct=reactExports.useCallback(ut=>{try{rt(ut)}catch(ht){const{type:dt,previousValue:ft}=ht;if(dt!=="LEVA_ERROR")throw ht;lt(ft)}},[lt,rt]);return reactExports.useEffect(()=>{dequal(nt,ot.current)||lt(nt),ot.current=nt},[nt,lt]),{displayValue:it,onChange:st,onUpdate:ct}}function useDrag(nt,_e){const{emitOnEditStart:et,emitOnEditEnd:rt}=useInputContext();return useDrag$1(it=>{it.first&&(document.body.classList.add("leva__panel__dragged"),et==null||et());const st=nt(it);return it.last&&(document.body.classList.remove("leva__panel__dragged"),rt==null||rt()),st},_e)}function useCanvas2d(nt){const _e=reactExports.useRef(null),et=reactExports.useRef(null),rt=reactExports.useRef(!1);return reactExports.useEffect(()=>{const it=debounce$2(()=>{_e.current.width=_e.current.offsetWidth*window.devicePixelRatio,_e.current.height=_e.current.offsetHeight*window.devicePixelRatio,nt(_e.current,et.current)},250);return window.addEventListener("resize",it),rt.current||(it(),rt.current=!0),()=>window.removeEventListener("resize",it)},[nt]),reactExports.useEffect(()=>{et.current=_e.current.getContext("2d")},[]),[_e,et]}function useTransform(){const nt=reactExports.useRef(null),_e=reactExports.useRef({x:0,y:0}),et=reactExports.useCallback(rt=>{Object.assign(_e.current,rt),nt.current&&(nt.current.style.transform=`translate3d(${_e.current.x}px, ${_e.current.y}px, 0)`)},[]);return[nt,et]}const _excluded$3$1=["__refCount"],getInputAtPath=(nt,_e)=>{if(!nt[_e])return null;const et=nt[_e];return _objectWithoutProperties$5(et,_excluded$3$1)};function useInput(nt){const _e=useStoreContext(),[et,rt]=reactExports.useState(getInputAtPath(_e.getData(),nt)),it=reactExports.useCallback(ct=>_e.setValueAtPath(nt,ct,!0),[nt,_e]),st=reactExports.useCallback(ct=>_e.setSettingsAtPath(nt,ct),[nt,_e]),ot=reactExports.useCallback(ct=>_e.disableInputAtPath(nt,ct),[nt,_e]),at=reactExports.useCallback(()=>_e.emitOnEditStart(nt),[nt,_e]),lt=reactExports.useCallback(()=>_e.emitOnEditEnd(nt),[nt,_e]);return reactExports.useEffect(()=>{rt(getInputAtPath(_e.getData(),nt));const ct=_e.useStore.subscribe(ut=>getInputAtPath(ut.data,nt),rt,{equalityFn:shallow});return()=>ct()},[_e,nt]),[et,{set:it,setSettings:st,disable:ot,storeId:_e.storeId,emitOnEditStart:at,emitOnEditEnd:lt}]}const RangeGrid=styled("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Range=styled("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),Scrubber=styled("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),RangeWrapper=styled("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Indicator=styled("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function RangeSlider({value:nt,min:_e,max:et,onDrag:rt,step:it,initialValue:st}){const ot=reactExports.useRef(null),at=reactExports.useRef(null),lt=reactExports.useRef(0),ct=useTh("sizes","scrubberWidth"),ut=useDrag(({event:dt,first:ft,xy:[pt],movement:[mt],memo:At})=>{if(ft){const{width:bt,left:Tt}=ot.current.getBoundingClientRect();lt.current=bt-parseFloat(ct),At=(dt==null?void 0:dt.target)===at.current?nt:invertedRange((pt-Tt)/bt,_e,et)}const gt=At+invertedRange(mt/lt.current,0,et-_e);return rt(sanitizeStep$1(gt,{step:it,initialValue:st})),At}),ht=range$2(nt,_e,et);return React.createElement(RangeWrapper,_extends$3({ref:ot},ut()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:0,right:`${(1-ht)*100}%`}})),React.createElement(Scrubber,{ref:at,style:{left:`calc(${ht} * (100% - ${ct}))`}}))}const DraggableLabel=React.memo(({label:nt,onUpdate:_e,step:et,innerLabelTrim:rt})=>{const[it,st]=reactExports.useState(!1),ot=useDrag(({active:at,delta:[lt],event:ct,memo:ut=0})=>(st(at),ut+=lt/2,Math.abs(ut)>=1&&(_e(ht=>parseFloat(ht)+Math.floor(ut)*et*multiplyStep(ct)),ut=0),ut));return React.createElement(InnerNumberLabel,_extends$3({dragging:it,title:nt.length>1?nt:""},ot()),nt.slice(0,rt))});function Number$1({label:nt,id:_e,displayValue:et,onUpdate:rt,onChange:it,settings:st,innerLabelTrim:ot=1}){const at=ot>0&&React.createElement(DraggableLabel,{label:nt,step:st.step,onUpdate:rt,innerLabelTrim:ot});return React.createElement(NumberInput,{id:_e,value:String(et),onUpdate:rt,onChange:it,innerLabel:at})}function NumberComponent(){const nt=useInputContext(),{label:_e,value:et,onUpdate:rt,settings:it,id:st}=nt,{min:ot,max:at}=it,lt=at!==1/0&&ot!==-1/0;return React.createElement(Row$1,{input:!0},React.createElement(Label,null,_e),React.createElement(RangeGrid,{hasRange:lt},lt&&React.createElement(RangeSlider,_extends$3({value:parseFloat(et),onDrag:rt},it)),React.createElement(Number$1,_extends$3({},nt,{id:st,label:"value",innerLabelTrim:lt?0:1}))))}const{sanitizeStep}=props$3,rest=_objectWithoutProperties$5(props$3,["sanitizeStep"]);var number$4=_objectSpread2$4({component:NumberComponent},rest);const schema$2$1=(nt,_e)=>v8n().schema({options:v8n().passesAnyOf(v8n().object(),v8n().array())}).test(_e),sanitize$2$1=(nt,{values:_e})=>{if(_e.indexOf(nt)<0)throw Error("Selected value doesn't match Select options");return nt},format$3=(nt,{values:_e})=>_e.indexOf(nt),normalize$1$2=nt=>{let{value:_e,options:et}=nt,rt,it;return Array.isArray(et)?(it=et,rt=et.map(st=>String(st))):(it=Object.values(et),rt=Object.keys(et)),"value"in nt?it.includes(_e)||(rt.unshift(String(_e)),it.unshift(_e)):_e=it[0],Object.values(et).includes(_e)||(et[String(_e)]=_e),{value:_e,settings:{keys:rt,values:it}}};var props$2$1=Object.freeze({__proto__:null,schema:schema$2$1,sanitize:sanitize$2$1,format:format$3,normalize:normalize$1$2});const SelectContainer=styled("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),NativeSelect=styled("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),PresentationalSelect=styled("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${NativeSelect}:focus + &`]:{$focusStyle:""},[`${NativeSelect}:hover + &`]:{$hoverStyle:""}});function Select({displayValue:nt,value:_e,onUpdate:et,id:rt,settings:it,disabled:st}){const{keys:ot,values:at}=it,lt=reactExports.useRef();return _e===at[nt]&&(lt.current=ot[nt]),React.createElement(SelectContainer,null,React.createElement(NativeSelect,{id:rt,value:nt,onChange:ct=>et(at[Number(ct.currentTarget.value)]),disabled:st},ot.map((ct,ut)=>React.createElement("option",{key:ct,value:ut},ct))),React.createElement(PresentationalSelect,null,lt.current),React.createElement(Chevron,{toggled:!0}))}function SelectComponent(){const{label:nt,value:_e,displayValue:et,onUpdate:rt,id:it,disabled:st,settings:ot}=useInputContext();return React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(Select,{id:it,value:_e,displayValue:et,onUpdate:rt,settings:ot,disabled:st}))}var select$1=_objectSpread2$4({component:SelectComponent},props$2$1);const schema$1$1=nt=>v8n().string().test(nt),sanitize$1$1=nt=>{if(typeof nt!="string")throw Error("Invalid string");return nt},normalize$6=({value:nt,editable:_e=!0,rows:et=!1})=>({value:nt,settings:{editable:_e,rows:typeof et=="number"?et:et?5:0}});var props$1$1=Object.freeze({__proto__:null,schema:schema$1$1,sanitize:sanitize$1$1,normalize:normalize$6});const _excluded$2$1=["displayValue","onUpdate","onChange","editable"],NonEditableString=styled("div",{whiteSpace:"pre-wrap"});function String$1(nt){let{displayValue:_e,onUpdate:et,onChange:rt,editable:it=!0}=nt,st=_objectWithoutProperties$5(nt,_excluded$2$1);return it?React.createElement(ValueInput,_extends$3({value:_e,onUpdate:et,onChange:rt},st)):React.createElement(NonEditableString,null,_e)}function StringComponent(){const{label:nt,settings:_e,displayValue:et,onUpdate:rt,onChange:it}=useInputContext();return React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(String$1,_extends$3({displayValue:et,onUpdate:rt,onChange:it},_e)))}var string$1=_objectSpread2$4({component:StringComponent},props$1$1);const schema$4=nt=>v8n().boolean().test(nt),sanitize$5=nt=>{if(typeof nt!="boolean")throw Error("Invalid boolean");return nt};var props$4=Object.freeze({__proto__:null,schema:schema$4,sanitize:sanitize$5});const StyledInputWrapper=styled("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function Boolean$1({value:nt,onUpdate:_e,id:et,disabled:rt}){return React.createElement(StyledInputWrapper,null,React.createElement("input",{id:et,type:"checkbox",checked:nt,onChange:it=>_e(it.currentTarget.checked),disabled:rt}),React.createElement("label",{htmlFor:et},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function BooleanComponent(){const{label:nt,value:_e,onUpdate:et,disabled:rt,id:it}=useInputContext();return React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(Boolean$1,{value:_e,onUpdate:et,id:it,disabled:rt}))}var boolean=_objectSpread2$4({component:BooleanComponent},props$4);const _excluded$1$1=["locked"];function Coordinate({value:nt,id:_e,valueKey:et,settings:rt,onUpdate:it,innerLabelTrim:st}){const ot=reactExports.useRef(nt[et]);ot.current=nt[et];const at=reactExports.useCallback(ct=>it({[et]:sanitizeValue({type:"NUMBER",value:ot.current,settings:rt},ct)}),[it,rt,et]),lt=useInputSetters({type:"NUMBER",value:nt[et],settings:rt,setValue:at});return React.createElement(Number$1,{id:_e,label:et,value:nt[et],displayValue:lt.displayValue,onUpdate:lt.onUpdate,onChange:lt.onChange,settings:rt,innerLabelTrim:st})}const Container$3=styled("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function Lock(nt){let{locked:_e}=nt,et=_objectWithoutProperties$5(nt,_excluded$1$1);return React.createElement("svg",_extends$3({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},et),_e?React.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):React.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function Vector({value:nt,onUpdate:_e,settings:et,innerLabelTrim:rt}){const{id:it,setSettings:st}=useInputContext(),{lock:ot,locked:at}=et;return React.createElement(Container$3,{withLock:ot},ot&&React.createElement(Lock,{locked:at,onClick:()=>st({locked:!at})}),Object.keys(nt).map((lt,ct)=>React.createElement(Coordinate,{id:ct===0?it:`${it}.${lt}`,key:lt,valueKey:lt,value:nt,settings:et[lt],onUpdate:_e,innerLabelTrim:rt})))}const normalizeKeyedNumberSettings=(nt,_e)=>{const et={};let rt=0,it=1/0;Object.entries(nt).forEach(([st,ot])=>{et[st]=normalize$2$2(_objectSpread2$4({value:ot},_e[st])).settings,rt=Math.max(rt,et[st].step),it=Math.min(it,et[st].pad)});for(let st in et){const{step:ot,min:at,max:lt}=_e[st]||{};!isFinite(ot)&&(!isFinite(at)||!isFinite(lt))&&(et[st].step=rt,et[st].pad=it)}return et},_excluded$b=["lock"],_excluded2$5=["value"];function getVectorSchema(nt){const _e=v8n().array().length(nt).every.number(),et=rt=>{if(!rt||typeof rt!="object")return!1;const it=Object.values(rt);return it.length===nt&&it.every(st=>isFinite(st))};return rt=>_e.test(rt)||et(rt)}function getVectorType(nt){return Array.isArray(nt)?"array":"object"}function convert$2(nt,_e,et){return getVectorType(nt)===_e?nt:_e==="array"?Object.values(nt):mapArrayToKeys(nt,et)}const sanitizeVector=(nt,_e,et)=>{const rt=convert$2(nt,"object",_e.keys);for(let ot in rt)rt[ot]=sanitize$3$1(rt[ot],_e[ot]);const it=Object.keys(rt);let st={};if(it.length===_e.keys.length)st=rt;else{const ot=convert$2(et,"object",_e.keys);if(it.length===1&&_e.locked){const at=it[0],lt=rt[at],ct=ot[at],ut=ct!==0?lt/ct:1;for(let ht in ot)ht===at?st[at]=lt:st[ht]=ot[ht]*ut}else st=_objectSpread2$4(_objectSpread2$4({},ot),rt)}return convert$2(st,_e.format,_e.keys)},formatVector=(nt,_e)=>convert$2(nt,"object",_e.keys),isNumberSettings=nt=>!!nt&&("step"in nt||"min"in nt||"max"in nt);function normalizeVector(nt,_e,et=[]){const{lock:rt=!1}=_e,it=_objectWithoutProperties$5(_e,_excluded$b),st=Array.isArray(nt)?"array":"object",ot=st==="object"?Object.keys(nt):et,at=convert$2(nt,"object",ot),lt=isNumberSettings(it)?ot.reduce((ut,ht)=>Object.assign(ut,{[ht]:it}),{}):it,ct=normalizeKeyedNumberSettings(at,lt);return{value:st==="array"?nt:at,settings:_objectSpread2$4(_objectSpread2$4({},ct),{},{format:st,keys:ot,lock:rt,locked:!1})}}function getVectorPlugin(nt){return{schema:getVectorSchema(nt.length),normalize:_e=>{let{value:et}=_e,rt=_objectWithoutProperties$5(_e,_excluded2$5);return normalizeVector(et,rt,nt)},format:(_e,et)=>formatVector(_e,et),sanitize:(_e,et,rt)=>sanitizeVector(_e,et,rt)}}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(nt){return typeof nt=="string"?nt.length>0:typeof nt=="number"},n$1=function(nt,_e,et){return _e===void 0&&(_e=0),et===void 0&&(et=Math.pow(10,_e)),Math.round(et*nt)/et+0},e=function(nt,_e,et){return _e===void 0&&(_e=0),et===void 0&&(et=1),nt>et?et:nt>_e?nt:_e},u$2=function(nt){return(nt=isFinite(nt)?nt%360:0)>0?nt:nt+360},a=function(nt){return{r:e(nt.r,0,255),g:e(nt.g,0,255),b:e(nt.b,0,255),a:e(nt.a)}},o=function(nt){return{r:n$1(nt.r),g:n$1(nt.g),b:n$1(nt.b),a:n$1(nt.a,3)}},i$4=/^#([0-9a-f]{3,8})$/i,s$2=function(nt){var _e=nt.toString(16);return _e.length<2?"0"+_e:_e},h$1=function(nt){var _e=nt.r,et=nt.g,rt=nt.b,it=nt.a,st=Math.max(_e,et,rt),ot=st-Math.min(_e,et,rt),at=ot?st===_e?(et-rt)/ot:st===et?2+(rt-_e)/ot:4+(_e-et)/ot:0;return{h:60*(at<0?at+6:at),s:st?ot/st*100:0,v:st/255*100,a:it}},b$1=function(nt){var _e=nt.h,et=nt.s,rt=nt.v,it=nt.a;_e=_e/360*6,et/=100,rt/=100;var st=Math.floor(_e),ot=rt*(1-et),at=rt*(1-(_e-st)*et),lt=rt*(1-(1-_e+st)*et),ct=st%6;return{r:255*[rt,at,ot,ot,lt,rt][ct],g:255*[lt,rt,rt,at,ot,ot][ct],b:255*[ot,ot,lt,rt,rt,at][ct],a:it}},g$1=function(nt){return{h:u$2(nt.h),s:e(nt.s,0,100),l:e(nt.l,0,100),a:e(nt.a)}},d$1=function(nt){return{h:n$1(nt.h),s:n$1(nt.s),l:n$1(nt.l),a:n$1(nt.a,3)}},f$1=function(nt){return b$1((et=(_e=nt).s,{h:_e.h,s:(et*=((rt=_e.l)<50?rt:100-rt)/100)>0?2*et/(rt+et)*100:0,v:rt+et,a:_e.a}));var _e,et,rt},c$1=function(nt){return{h:(_e=h$1(nt)).h,s:(it=(200-(et=_e.s))*(rt=_e.v)/100)>0&&it<200?et*rt/100/(it<=100?it:200-it)*100:0,l:it/2,a:_e.a};var _e,et,rt,it},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$2=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$2=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$1={string:[[function(nt){var _e=i$4.exec(nt);return _e?(nt=_e[1]).length<=4?{r:parseInt(nt[0]+nt[0],16),g:parseInt(nt[1]+nt[1],16),b:parseInt(nt[2]+nt[2],16),a:nt.length===4?n$1(parseInt(nt[3]+nt[3],16)/255,2):1}:nt.length===6||nt.length===8?{r:parseInt(nt.substr(0,2),16),g:parseInt(nt.substr(2,2),16),b:parseInt(nt.substr(4,2),16),a:nt.length===8?n$1(parseInt(nt.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(nt){var _e=v$2.exec(nt)||m$1.exec(nt);return _e?_e[2]!==_e[4]||_e[4]!==_e[6]?null:a({r:Number(_e[1])/(_e[2]?100/255:1),g:Number(_e[3])/(_e[4]?100/255:1),b:Number(_e[5])/(_e[6]?100/255:1),a:_e[7]===void 0?1:Number(_e[7])/(_e[8]?100:1)}):null},"rgb"],[function(nt){var _e=l.exec(nt)||p$2.exec(nt);if(!_e)return null;var et,rt,it=g$1({h:(et=_e[1],rt=_e[2],rt===void 0&&(rt="deg"),Number(et)*(r[rt]||1)),s:Number(_e[3]),l:Number(_e[4]),a:_e[5]===void 0?1:Number(_e[5])/(_e[6]?100:1)});return f$1(it)},"hsl"]],object:[[function(nt){var _e=nt.r,et=nt.g,rt=nt.b,it=nt.a,st=it===void 0?1:it;return t(_e)&&t(et)&&t(rt)?a({r:Number(_e),g:Number(et),b:Number(rt),a:Number(st)}):null},"rgb"],[function(nt){var _e=nt.h,et=nt.s,rt=nt.l,it=nt.a,st=it===void 0?1:it;if(!t(_e)||!t(et)||!t(rt))return null;var ot=g$1({h:Number(_e),s:Number(et),l:Number(rt),a:Number(st)});return f$1(ot)},"hsl"],[function(nt){var _e=nt.h,et=nt.s,rt=nt.v,it=nt.a,st=it===void 0?1:it;if(!t(_e)||!t(et)||!t(rt))return null;var ot=function(at){return{h:u$2(at.h),s:e(at.s,0,100),v:e(at.v,0,100),a:e(at.a)}}({h:Number(_e),s:Number(et),v:Number(rt),a:Number(st)});return b$1(ot)},"hsv"]]},N$1=function(nt,_e){for(var et=0;et<_e.length;et++){var rt=_e[et][0](nt);if(rt)return[rt,_e[et][1]]}return[null,void 0]},x=function(nt){return typeof nt=="string"?N$1(nt.trim(),y$1.string):typeof nt=="object"&&nt!==null?N$1(nt,y$1.object):[null,void 0]},I$2=function(nt){return x(nt)[1]},M$1=function(nt,_e){var et=c$1(nt);return{h:et.h,s:e(et.s+100*_e,0,100),l:et.l,a:et.a}},H=function(nt){return(299*nt.r+587*nt.g+114*nt.b)/1e3/255},$$1=function(nt,_e){var et=c$1(nt);return{h:et.h,s:et.s,l:e(et.l+100*_e,0,100),a:et.a}},j=function(){function nt(_e){this.parsed=x(_e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return nt.prototype.isValid=function(){return this.parsed!==null},nt.prototype.brightness=function(){return n$1(H(this.rgba),2)},nt.prototype.isDark=function(){return H(this.rgba)<.5},nt.prototype.isLight=function(){return H(this.rgba)>=.5},nt.prototype.toHex=function(){return _e=o(this.rgba),et=_e.r,rt=_e.g,it=_e.b,ot=(st=_e.a)<1?s$2(n$1(255*st)):"","#"+s$2(et)+s$2(rt)+s$2(it)+ot;var _e,et,rt,it,st,ot},nt.prototype.toRgb=function(){return o(this.rgba)},nt.prototype.toRgbString=function(){return _e=o(this.rgba),et=_e.r,rt=_e.g,it=_e.b,(st=_e.a)<1?"rgba("+et+", "+rt+", "+it+", "+st+")":"rgb("+et+", "+rt+", "+it+")";var _e,et,rt,it,st},nt.prototype.toHsl=function(){return d$1(c$1(this.rgba))},nt.prototype.toHslString=function(){return _e=d$1(c$1(this.rgba)),et=_e.h,rt=_e.s,it=_e.l,(st=_e.a)<1?"hsla("+et+", "+rt+"%, "+it+"%, "+st+")":"hsl("+et+", "+rt+"%, "+it+"%)";var _e,et,rt,it,st},nt.prototype.toHsv=function(){return _e=h$1(this.rgba),{h:n$1(_e.h),s:n$1(_e.s),v:n$1(_e.v),a:n$1(_e.a,3)};var _e},nt.prototype.invert=function(){return w({r:255-(_e=this.rgba).r,g:255-_e.g,b:255-_e.b,a:_e.a});var _e},nt.prototype.saturate=function(_e){return _e===void 0&&(_e=.1),w(M$1(this.rgba,_e))},nt.prototype.desaturate=function(_e){return _e===void 0&&(_e=.1),w(M$1(this.rgba,-_e))},nt.prototype.grayscale=function(){return w(M$1(this.rgba,-1))},nt.prototype.lighten=function(_e){return _e===void 0&&(_e=.1),w($$1(this.rgba,_e))},nt.prototype.darken=function(_e){return _e===void 0&&(_e=.1),w($$1(this.rgba,-_e))},nt.prototype.rotate=function(_e){return _e===void 0&&(_e=15),this.hue(this.hue()+_e)},nt.prototype.alpha=function(_e){return typeof _e=="number"?w({r:(et=this.rgba).r,g:et.g,b:et.b,a:_e}):n$1(this.rgba.a,3);var et},nt.prototype.hue=function(_e){var et=c$1(this.rgba);return typeof _e=="number"?w({h:_e,s:et.s,l:et.l,a:et.a}):n$1(et.h)},nt.prototype.isEqual=function(_e){return this.toHex()===w(_e).toHex()},nt}(),w=function(nt){return nt instanceof j?nt:new j(nt)},S$1=[],k$1=function(nt){nt.forEach(function(_e){S$1.indexOf(_e)<0&&(_e(j,y$1),S$1.push(_e))})};function namesPlugin(nt,_e){var et={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},rt={};for(var it in et)rt[et[it]]=it;var st={};nt.prototype.toName=function(ot){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var at,lt,ct=rt[this.toHex()];if(ct)return ct;if(ot!=null&&ot.closest){var ut=this.toRgb(),ht=1/0,dt="black";if(!st.length)for(var ft in et)st[ft]=new nt(et[ft]).toRgb();for(var pt in et){var mt=(at=ut,lt=st[pt],Math.pow(at.r-lt.r,2)+Math.pow(at.g-lt.g,2)+Math.pow(at.b-lt.b,2));mt<ht&&(ht=mt,dt=pt)}return dt}},_e.string.push([function(ot){var at=ot.toLowerCase(),lt=at==="transparent"?"#0000":et[at];return lt?new nt(lt).toRgb():null},"name"])}function u$1(){return(u$1=Object.assign||function(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e];for(var rt in et)Object.prototype.hasOwnProperty.call(et,rt)&&(nt[rt]=et[rt])}return nt}).apply(this,arguments)}function c(nt,_e){if(nt==null)return{};var et,rt,it={},st=Object.keys(nt);for(rt=0;rt<st.length;rt++)_e.indexOf(et=st[rt])>=0||(it[et]=nt[et]);return it}function i$3(nt){var _e=reactExports.useRef(nt),et=reactExports.useRef(function(rt){_e.current&&_e.current(rt)});return _e.current=nt,et.current}var s$1=function(nt,_e,et){return _e===void 0&&(_e=0),et===void 0&&(et=1),nt>et?et:nt<_e?_e:nt},f=function(nt){return"touches"in nt},v$1=function(nt){return nt&&nt.ownerDocument.defaultView||self},d=function(nt,_e,et){var rt=nt.getBoundingClientRect(),it=f(_e)?function(st,ot){for(var at=0;at<st.length;at++)if(st[at].identifier===ot)return st[at];return st[0]}(_e.touches,et):_e;return{left:s$1((it.pageX-(rt.left+v$1(nt).pageXOffset))/rt.width),top:s$1((it.pageY-(rt.top+v$1(nt).pageYOffset))/rt.height)}},h=function(nt){!f(nt)&&nt.preventDefault()},m=React.memo(function(nt){var _e=nt.onMove,et=nt.onKey,rt=c(nt,["onMove","onKey"]),it=reactExports.useRef(null),st=i$3(_e),ot=i$3(et),at=reactExports.useRef(null),lt=reactExports.useRef(!1),ct=reactExports.useMemo(function(){var ft=function(At){h(At),(f(At)?At.touches.length>0:At.buttons>0)&&it.current?st(d(it.current,At,at.current)):mt(!1)},pt=function(){return mt(!1)};function mt(At){var gt=lt.current,bt=v$1(it.current),Tt=At?bt.addEventListener:bt.removeEventListener;Tt(gt?"touchmove":"mousemove",ft),Tt(gt?"touchend":"mouseup",pt)}return[function(At){var gt=At.nativeEvent,bt=it.current;if(bt&&(h(gt),!function(wt,Rt){return Rt&&!f(wt)}(gt,lt.current)&&bt)){if(f(gt)){lt.current=!0;var Tt=gt.changedTouches||[];Tt.length&&(at.current=Tt[0].identifier)}bt.focus(),st(d(bt,gt,at.current)),mt(!0)}},function(At){var gt=At.which||At.keyCode;gt<37||gt>40||(At.preventDefault(),ot({left:gt===39?.05:gt===37?-.05:0,top:gt===40?.05:gt===38?-.05:0}))},mt]},[ot,st]),ut=ct[0],ht=ct[1],dt=ct[2];return reactExports.useEffect(function(){return dt},[dt]),React.createElement("div",u$1({},rt,{onTouchStart:ut,onMouseDown:ut,className:"react-colorful__interactive",ref:it,onKeyDown:ht,tabIndex:0,role:"slider"}))}),g=function(nt){return nt.filter(Boolean).join(" ")},p$1=function(nt){var _e=nt.color,et=nt.left,rt=nt.top,it=rt===void 0?.5:rt,st=g(["react-colorful__pointer",nt.className]);return React.createElement("div",{className:st,style:{top:100*it+"%",left:100*et+"%"}},React.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:_e}}))},b=function(nt,_e,et){return _e===void 0&&(_e=0),et===void 0&&(et=Math.pow(10,_e)),Math.round(et*nt)/et},y=function(nt){var _e=nt.s,et=nt.v,rt=nt.a,it=(200-_e)*et/100;return{h:b(nt.h),s:b(it>0&&it<200?_e*et/100/(it<=100?it:200-it)*100:0),l:b(it/2),a:b(rt,2)}},q=function(nt){var _e=y(nt);return"hsl("+_e.h+", "+_e.s+"%, "+_e.l+"%)"},k=function(nt){var _e=y(nt);return"hsla("+_e.h+", "+_e.s+"%, "+_e.l+"%, "+_e.a+")"},I$1=function(nt){var _e=nt.h,et=nt.s,rt=nt.v,it=nt.a;_e=_e/360*6,et/=100,rt/=100;var st=Math.floor(_e),ot=rt*(1-et),at=rt*(1-(_e-st)*et),lt=rt*(1-(1-_e+st)*et),ct=st%6;return{r:b(255*[rt,at,ot,ot,lt,rt][ct]),g:b(255*[lt,rt,rt,at,ot,ot][ct]),b:b(255*[ot,ot,lt,rt,rt,at][ct]),a:b(it,2)}},L$1=function(nt){var _e=nt.r,et=nt.g,rt=nt.b,it=nt.a,st=Math.max(_e,et,rt),ot=st-Math.min(_e,et,rt),at=ot?st===_e?(et-rt)/ot:st===et?2+(rt-_e)/ot:4+(_e-et)/ot:0;return{h:b(60*(at<0?at+6:at)),s:b(st?ot/st*100:0),v:b(st/255*100),a:it}},S=React.memo(function(nt){var _e=nt.hue,et=nt.onChange,rt=g(["react-colorful__hue",nt.className]);return React.createElement("div",{className:rt},React.createElement(m,{onMove:function(it){et({h:360*it.left})},onKey:function(it){et({h:s$1(_e+360*it.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(_e),"aria-valuemax":"360","aria-valuemin":"0"},React.createElement(p$1,{className:"react-colorful__hue-pointer",left:_e/360,color:q({h:_e,s:100,v:100,a:1})})))}),T=React.memo(function(nt){var _e=nt.hsva,et=nt.onChange,rt={backgroundColor:q({h:_e.h,s:100,v:100,a:1})};return React.createElement("div",{className:"react-colorful__saturation",style:rt},React.createElement(m,{onMove:function(it){et({s:100*it.left,v:100-100*it.top})},onKey:function(it){et({s:s$1(_e.s+100*it.left,0,100),v:s$1(_e.v-100*it.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(_e.s)+"%, Brightness "+b(_e.v)+"%"},React.createElement(p$1,{className:"react-colorful__saturation-pointer",top:1-_e.v/100,left:_e.s/100,color:q(_e)})))}),F=function(nt,_e){if(nt===_e)return!0;for(var et in nt)if(nt[et]!==_e[et])return!1;return!0};function Y$1(nt,_e,et){var rt=i$3(et),it=reactExports.useState(function(){return nt.toHsva(_e)}),st=it[0],ot=it[1],at=reactExports.useRef({color:_e,hsva:st});reactExports.useEffect(function(){if(!nt.equal(_e,at.current.color)){var ct=nt.toHsva(_e);at.current={hsva:ct,color:_e},ot(ct)}},[_e,nt]),reactExports.useEffect(function(){var ct;F(st,at.current.hsva)||nt.equal(ct=nt.fromHsva(st),at.current.color)||(at.current={hsva:st,color:ct},rt(ct))},[st,nt,rt]);var lt=reactExports.useCallback(function(ct){ot(function(ut){return Object.assign({},ut,ct)})},[]);return[st,lt]}var V$1=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,$=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},J=new Map,Q$1=function(nt){V$1(function(){var _e=nt.current?nt.current.ownerDocument:document;if(_e!==void 0&&!J.has(_e)){var et=_e.createElement("style");et.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,J.set(_e,et);var rt=$();rt&&et.setAttribute("nonce",rt),_e.head.appendChild(et)}},[])},U$1=function(nt){var _e=nt.className,et=nt.colorModel,rt=nt.color,it=rt===void 0?et.defaultColor:rt,st=nt.onChange,ot=c(nt,["className","colorModel","color","onChange"]),at=reactExports.useRef(null);Q$1(at);var lt=Y$1(et,it,st),ct=lt[0],ut=lt[1],ht=g(["react-colorful",_e]);return React.createElement("div",u$1({},ot,{ref:at,className:ht}),React.createElement(T,{hsva:ct,onChange:ut}),React.createElement(S,{hue:ct.h,onChange:ut,className:"react-colorful__last-control"}))},ee=function(nt){var _e=nt.className,et=nt.hsva,rt=nt.onChange,it={backgroundImage:"linear-gradient(90deg, "+k(Object.assign({},et,{a:0}))+", "+k(Object.assign({},et,{a:1}))+")"},st=g(["react-colorful__alpha",_e]),ot=b(100*et.a);return React.createElement("div",{className:st},React.createElement("div",{className:"react-colorful__alpha-gradient",style:it}),React.createElement(m,{onMove:function(at){rt({a:at.left})},onKey:function(at){rt({a:s$1(et.a+at.left)})},"aria-label":"Alpha","aria-valuetext":ot+"%","aria-valuenow":ot,"aria-valuemin":"0","aria-valuemax":"100"},React.createElement(p$1,{className:"react-colorful__alpha-pointer",left:et.a,color:k(et)})))},re$1=function(nt){var _e=nt.className,et=nt.colorModel,rt=nt.color,it=rt===void 0?et.defaultColor:rt,st=nt.onChange,ot=c(nt,["className","colorModel","color","onChange"]),at=reactExports.useRef(null);Q$1(at);var lt=Y$1(et,it,st),ct=lt[0],ut=lt[1],ht=g(["react-colorful",_e]);return React.createElement("div",u$1({},ot,{ref:at,className:ht}),React.createElement(T,{hsva:ct,onChange:ut}),React.createElement(S,{hue:ct.h,onChange:ut}),React.createElement(ee,{hsva:ct,onChange:ut,className:"react-colorful__last-control"}))},xe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:L$1,fromHsva:I$1,equal:F},Ce=function(nt){return React.createElement(re$1,u$1({},nt,{colorModel:xe}))},Me={defaultColor:{r:0,g:0,b:0},toHsva:function(nt){return L$1({r:nt.r,g:nt.g,b:nt.b,a:1})},fromHsva:function(nt){return{r:(_e=I$1(nt)).r,g:_e.g,b:_e.b};var _e},equal:F},Ne=function(nt){return React.createElement(U$1,u$1({},nt,{colorModel:Me}))},propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function nt(rt,it,st,ot,at,lt){if(lt!==ReactPropTypesSecret){var ct=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ct.name="Invariant Violation",ct}}nt.isRequired=nt;function _e(){return nt}var et={array:nt,bigint:nt,bool:nt,func:nt,number:nt,object:nt,string:nt,symbol:nt,any:nt,arrayOf:_e,element:nt,elementType:nt,instanceOf:_e,node:nt,objectOf:_e,oneOf:_e,oneOfType:_e,shape:_e,exact:_e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return et.PropTypes=et,et};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs$1(propTypesExports);function __awaiter(nt,_e,et,rt){function it(st){return st instanceof et?st:new et(function(ot){ot(st)})}return new(et||(et=Promise))(function(st,ot){function at(ut){try{ct(rt.next(ut))}catch(ht){ot(ht)}}function lt(ut){try{ct(rt.throw(ut))}catch(ht){ot(ht)}}function ct(ut){ut.done?st(ut.value):it(ut.value).then(at,lt)}ct((rt=rt.apply(nt,_e||[])).next())})}function __generator(nt,_e){var et={label:0,sent:function(){if(st[0]&1)throw st[1];return st[1]},trys:[],ops:[]},rt,it,st,ot=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return ot.next=at(0),ot.throw=at(1),ot.return=at(2),typeof Symbol=="function"&&(ot[Symbol.iterator]=function(){return this}),ot;function at(ct){return function(ut){return lt([ct,ut])}}function lt(ct){if(rt)throw new TypeError("Generator is already executing.");for(;ot&&(ot=0,ct[0]&&(et=0)),et;)try{if(rt=1,it&&(st=ct[0]&2?it.return:ct[0]?it.throw||((st=it.return)&&st.call(it),0):it.next)&&!(st=st.call(it,ct[1])).done)return st;switch(it=0,st&&(ct=[ct[0]&2,st.value]),ct[0]){case 0:case 1:st=ct;break;case 4:return et.label++,{value:ct[1],done:!1};case 5:et.label++,it=ct[1],ct=[0];continue;case 7:ct=et.ops.pop(),et.trys.pop();continue;default:if(st=et.trys,!(st=st.length>0&&st[st.length-1])&&(ct[0]===6||ct[0]===2)){et=0;continue}if(ct[0]===3&&(!st||ct[1]>st[0]&&ct[1]<st[3])){et.label=ct[1];break}if(ct[0]===6&&et.label<st[1]){et.label=st[1],st=ct;break}if(st&&et.label<st[2]){et.label=st[2],et.ops.push(ct);break}st[2]&&et.ops.pop(),et.trys.pop();continue}ct=_e.call(nt,et)}catch(ut){ct=[6,ut],it=0}finally{rt=st=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}}function __read(nt,_e){var et=typeof Symbol=="function"&&nt[Symbol.iterator];if(!et)return nt;var rt=et.call(nt),it,st=[],ot;try{for(;(_e===void 0||_e-- >0)&&!(it=rt.next()).done;)st.push(it.value)}catch(at){ot={error:at}}finally{try{it&&!it.done&&(et=rt.return)&&et.call(rt)}finally{if(ot)throw ot.error}}return st}function __spread(){for(var nt=[],_e=0;_e<arguments.length;_e++)nt=nt.concat(__read(arguments[_e]));return nt}typeof SuppressedError=="function"&&SuppressedError;var COMMON_MIME_TYPES=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(nt,_e){var et=withMimeType(nt);if(typeof et.path!="string"){var rt=nt.webkitRelativePath;Object.defineProperty(et,"path",{value:typeof _e=="string"?_e:typeof rt=="string"&&rt.length>0?rt:nt.name,writable:!1,configurable:!1,enumerable:!0})}return et}function withMimeType(nt){var _e=nt.name,et=_e&&_e.lastIndexOf(".")!==-1;if(et&&!nt.type){var rt=_e.split(".").pop().toLowerCase(),it=COMMON_MIME_TYPES.get(rt);it&&Object.defineProperty(nt,"type",{value:it,writable:!1,configurable:!1,enumerable:!0})}return nt}var FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(nt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return isObject$8(nt)&&isDataTransfer(nt)?[2,getDataTransferFiles(nt.dataTransfer,nt.type)]:isChangeEvt(nt)?[2,getInputFiles(nt)]:Array.isArray(nt)&&nt.every(function(et){return"getFile"in et&&typeof et.getFile=="function"})?[2,getFsHandleFiles(nt)]:[2,[]]})})}function isDataTransfer(nt){return isObject$8(nt.dataTransfer)}function isChangeEvt(nt){return isObject$8(nt)&&isObject$8(nt.target)}function isObject$8(nt){return typeof nt=="object"&&nt!==null}function getInputFiles(nt){return fromList(nt.target.files).map(function(_e){return toFileWithPath(_e)})}function getFsHandleFiles(nt){return __awaiter(this,void 0,void 0,function(){var _e;return __generator(this,function(et){switch(et.label){case 0:return[4,Promise.all(nt.map(function(rt){return rt.getFile()}))];case 1:return _e=et.sent(),[2,_e.map(function(rt){return toFileWithPath(rt)})]}})})}function getDataTransferFiles(nt,_e){return __awaiter(this,void 0,void 0,function(){var et,rt;return __generator(this,function(it){switch(it.label){case 0:return nt===null?[2,[]]:nt.items?(et=fromList(nt.items).filter(function(st){return st.kind==="file"}),_e!=="drop"?[2,et]:[4,Promise.all(et.map(toFilePromises))]):[3,2];case 1:return rt=it.sent(),[2,noIgnoredFiles(flatten$3(rt))];case 2:return[2,noIgnoredFiles(fromList(nt.files).map(function(st){return toFileWithPath(st)}))]}})})}function noIgnoredFiles(nt){return nt.filter(function(_e){return FILES_TO_IGNORE.indexOf(_e.name)===-1})}function fromList(nt){if(nt===null)return[];for(var _e=[],et=0;et<nt.length;et++){var rt=nt[et];_e.push(rt)}return _e}function toFilePromises(nt){if(typeof nt.webkitGetAsEntry!="function")return fromDataTransferItem(nt);var _e=nt.webkitGetAsEntry();return _e&&_e.isDirectory?fromDirEntry(_e):fromDataTransferItem(nt)}function flatten$3(nt){return nt.reduce(function(_e,et){return __spread(_e,Array.isArray(et)?flatten$3(et):[et])},[])}function fromDataTransferItem(nt){var _e=nt.getAsFile();if(!_e)return Promise.reject(nt+" is not a File");var et=toFileWithPath(_e);return Promise.resolve(et)}function fromEntry(nt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return[2,nt.isDirectory?fromDirEntry(nt):fromFileEntry(nt)]})})}function fromDirEntry(nt){var _e=nt.createReader();return new Promise(function(et,rt){var it=[];function st(){var ot=this;_e.readEntries(function(at){return __awaiter(ot,void 0,void 0,function(){var lt,ct,ut;return __generator(this,function(ht){switch(ht.label){case 0:if(at.length)return[3,5];ht.label=1;case 1:return ht.trys.push([1,3,,4]),[4,Promise.all(it)];case 2:return lt=ht.sent(),et(lt),[3,4];case 3:return ct=ht.sent(),rt(ct),[3,4];case 4:return[3,6];case 5:ut=Promise.all(at.map(fromEntry)),it.push(ut),st(),ht.label=6;case 6:return[2]}})})},function(at){rt(at)})}st()})}function fromFileEntry(nt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return[2,new Promise(function(et,rt){nt.file(function(it){var st=toFileWithPath(it,nt.fullPath);et(st)},function(it){rt(it)})})]})})}var _default=function(nt,_e){if(nt&&_e){var et=Array.isArray(_e)?_e:_e.split(",");if(et.length===0)return!0;var rt=nt.name||"",it=(nt.type||"").toLowerCase(),st=it.replace(/\/.*$/,"");return et.some(function(ot){var at=ot.trim().toLowerCase();return at.charAt(0)==="."?rt.toLowerCase().endsWith(at):at.endsWith("/*")?st===at.replace(/\/.*$/,""):it===at})}return!0};function ownKeys$5(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread$1(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$5(Object(et),!0).forEach(function(rt){_defineProperty$8(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$5(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}function _defineProperty$8(nt,_e,et){return _e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _slicedToArray$a(nt,_e){return _arrayWithHoles$a(nt)||_iterableToArrayLimit$a(nt,_e)||_unsupportedIterableToArray$c(nt,_e)||_nonIterableRest$a()}function _nonIterableRest$a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$c(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$c(nt,_e);var et=Object.prototype.toString.call(nt).slice(8,-1);if(et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set")return Array.from(nt);if(et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et))return _arrayLikeToArray$c(nt,_e)}}function _arrayLikeToArray$c(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=new Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _iterableToArrayLimit$a(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt=[],it=!0,st=!1,ot,at;try{for(et=et.call(nt);!(it=(ot=et.next()).done)&&(rt.push(ot.value),!(_e&&rt.length===_e));it=!0);}catch(lt){st=!0,at=lt}finally{try{!it&&et.return!=null&&et.return()}finally{if(st)throw at}}return rt}}function _arrayWithHoles$a(nt){if(Array.isArray(nt))return nt}var FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(_e){_e=Array.isArray(_e)&&_e.length===1?_e[0]:_e;var et=Array.isArray(_e)?"one of ".concat(_e.join(", ")):_e;return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(et)}},getTooLargeRejectionErr=function(_e){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(_e," ").concat(_e===1?"byte":"bytes")}},getTooSmallRejectionErr=function(_e){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(_e," ").concat(_e===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(nt,_e){var et=nt.type==="application/x-moz-file"||_default(nt,_e);return[et,et?null:getInvalidTypeRejectionErr(_e)]}function fileMatchSize(nt,_e,et){if(isDefined(nt.size))if(isDefined(_e)&&isDefined(et)){if(nt.size>et)return[!1,getTooLargeRejectionErr(et)];if(nt.size<_e)return[!1,getTooSmallRejectionErr(_e)]}else{if(isDefined(_e)&&nt.size<_e)return[!1,getTooSmallRejectionErr(_e)];if(isDefined(et)&&nt.size>et)return[!1,getTooLargeRejectionErr(et)]}return[!0,null]}function isDefined(nt){return nt!=null}function allFilesAccepted(nt){var _e=nt.files,et=nt.accept,rt=nt.minSize,it=nt.maxSize,st=nt.multiple,ot=nt.maxFiles;return!st&&_e.length>1||st&&ot>=1&&_e.length>ot?!1:_e.every(function(at){var lt=fileAccepted(at,et),ct=_slicedToArray$a(lt,1),ut=ct[0],ht=fileMatchSize(at,rt,it),dt=_slicedToArray$a(ht,1),ft=dt[0];return ut&&ft})}function isPropagationStopped(nt){return typeof nt.isPropagationStopped=="function"?nt.isPropagationStopped():typeof nt.cancelBubble<"u"?nt.cancelBubble:!1}function isEvtWithFiles(nt){return nt.dataTransfer?Array.prototype.some.call(nt.dataTransfer.types,function(_e){return _e==="Files"||_e==="application/x-moz-file"}):!!nt.target&&!!nt.target.files}function onDocumentDragOver(nt){nt.preventDefault()}function isIe(nt){return nt.indexOf("MSIE")!==-1||nt.indexOf("Trident/")!==-1}function isEdge(nt){return nt.indexOf("Edge/")!==-1}function isIeOrEdge(){var nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(nt)||isEdge(nt)}function composeEventHandlers(){for(var nt=arguments.length,_e=new Array(nt),et=0;et<nt;et++)_e[et]=arguments[et];return function(rt){for(var it=arguments.length,st=new Array(it>1?it-1:0),ot=1;ot<it;ot++)st[ot-1]=arguments[ot];return _e.some(function(at){return!isPropagationStopped(rt)&&at&&at.apply(void 0,[rt].concat(st)),isPropagationStopped(rt)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function filePickerOptionsTypes(nt){return nt=typeof nt=="string"?nt.split(","):nt,[{description:"everything",accept:Array.isArray(nt)?nt.filter(function(_e){return _e==="audio/*"||_e==="video/*"||_e==="image/*"||_e==="text/*"||/\w+\/[-+.\w]+/g.test(_e)}).reduce(function(_e,et){return _objectSpread$1(_objectSpread$1({},_e),{},_defineProperty$8({},et,[]))},{}):{}}]}function isAbort(nt){return nt instanceof DOMException&&(nt.name==="AbortError"||nt.code===nt.ABORT_ERR)}function isSecurityError(nt){return nt instanceof DOMException&&(nt.name==="SecurityError"||nt.code===nt.SECURITY_ERR)}var _excluded$8=["children"],_excluded2$2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray$9(nt){return _arrayWithoutHoles$9(nt)||_iterableToArray$9(nt)||_unsupportedIterableToArray$b(nt)||_nonIterableSpread$9()}function _nonIterableSpread$9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$9(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _arrayWithoutHoles$9(nt){if(Array.isArray(nt))return _arrayLikeToArray$b(nt)}function _slicedToArray$9(nt,_e){return _arrayWithHoles$9(nt)||_iterableToArrayLimit$9(nt,_e)||_unsupportedIterableToArray$b(nt,_e)||_nonIterableRest$9()}function _nonIterableRest$9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$b(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$b(nt,_e);var et=Object.prototype.toString.call(nt).slice(8,-1);if(et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set")return Array.from(nt);if(et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et))return _arrayLikeToArray$b(nt,_e)}}function _arrayLikeToArray$b(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=new Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _iterableToArrayLimit$9(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt=[],it=!0,st=!1,ot,at;try{for(et=et.call(nt);!(it=(ot=et.next()).done)&&(rt.push(ot.value),!(_e&&rt.length===_e));it=!0);}catch(lt){st=!0,at=lt}finally{try{!it&&et.return!=null&&et.return()}finally{if(st)throw at}}return rt}}function _arrayWithHoles$9(nt){if(Array.isArray(nt))return nt}function ownKeys$4(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$4(Object(et),!0).forEach(function(rt){_defineProperty$7(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$4(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}function _defineProperty$7(nt,_e,et){return _e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _objectWithoutProperties$4(nt,_e){if(nt==null)return{};var et=_objectWithoutPropertiesLoose$4(nt,_e),rt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(it=0;it<st.length;it++)rt=st[it],!(_e.indexOf(rt)>=0)&&Object.prototype.propertyIsEnumerable.call(nt,rt)&&(et[rt]=nt[rt])}return et}function _objectWithoutPropertiesLoose$4(nt,_e){if(nt==null)return{};var et={},rt=Object.keys(nt),it,st;for(st=0;st<rt.length;st++)it=rt[st],!(_e.indexOf(it)>=0)&&(et[it]=nt[it]);return et}var Dropzone=reactExports.forwardRef(function(nt,_e){var et=nt.children,rt=_objectWithoutProperties$4(nt,_excluded$8),it=useDropzone(rt),st=it.open,ot=_objectWithoutProperties$4(it,_excluded2$2);return reactExports.useImperativeHandle(_e,function(){return{open:st}},[st]),React.createElement(reactExports.Fragment,null,et(_objectSpread(_objectSpread({},ot),{},{open:st})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function useDropzone(){var nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=_objectSpread(_objectSpread({},defaultProps),nt),et=_e.accept,rt=_e.disabled,it=_e.getFilesFromEvent,st=_e.maxSize,ot=_e.minSize,at=_e.multiple,lt=_e.maxFiles,ct=_e.onDragEnter,ut=_e.onDragLeave,ht=_e.onDragOver,dt=_e.onDrop,ft=_e.onDropAccepted,pt=_e.onDropRejected,mt=_e.onFileDialogCancel,At=_e.onFileDialogOpen,gt=_e.useFsAccessApi,bt=_e.preventDropOnDocument,Tt=_e.noClick,wt=_e.noKeyboard,Rt=_e.noDrag,It=_e.noDragEventsBubbling,Lt=_e.validator,$t=reactExports.useMemo(function(){return typeof At=="function"?At:noop$3},[At]),kt=reactExports.useMemo(function(){return typeof mt=="function"?mt:noop$3},[mt]),Dt=reactExports.useRef(null),Ot=reactExports.useRef(null),zt=reactExports.useReducer(reducer,initialState),Ht=_slicedToArray$9(zt,2),Yt=Ht[0],Xt=Ht[1],Zt=Yt.isFocused,rn=Yt.isFileDialogActive,Gt=Yt.draggedFiles,jt=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&gt&&canUseFileSystemAccessAPI()),Kt=function(){!jt.current&&rn&&setTimeout(function(){if(Ot.current){var Mn=Ot.current.files;Mn.length||(Xt({type:"closeDialog"}),kt())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",Kt,!1),function(){window.removeEventListener("focus",Kt,!1)}},[Ot,rn,kt,jt]);var Jt=reactExports.useRef([]),sn=function(Mn){Dt.current&&Dt.current.contains(Mn.target)||(Mn.preventDefault(),Jt.current=[])};reactExports.useEffect(function(){return bt&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",sn,!1)),function(){bt&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",sn))}},[Dt,bt]);var hn=reactExports.useCallback(function(gn){gn.preventDefault(),gn.persist(),Yn(gn),Jt.current=[].concat(_toConsumableArray$9(Jt.current),[gn.target]),isEvtWithFiles(gn)&&Promise.resolve(it(gn)).then(function(Mn){isPropagationStopped(gn)&&!It||(Xt({draggedFiles:Mn,isDragActive:!0,type:"setDraggedFiles"}),ct&&ct(gn))})},[it,ct,It]),an=reactExports.useCallback(function(gn){gn.preventDefault(),gn.persist(),Yn(gn);var Mn=isEvtWithFiles(gn);if(Mn&&gn.dataTransfer)try{gn.dataTransfer.dropEffect="copy"}catch{}return Mn&&ht&&ht(gn),!1},[ht,It]),pn=reactExports.useCallback(function(gn){gn.preventDefault(),gn.persist(),Yn(gn);var Mn=Jt.current.filter(function(gr){return Dt.current&&Dt.current.contains(gr)}),In=Mn.indexOf(gn.target);In!==-1&&Mn.splice(In,1),Jt.current=Mn,!(Mn.length>0)&&(Xt({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),isEvtWithFiles(gn)&&ut&&ut(gn))},[Dt,ut,It]),_n=reactExports.useCallback(function(gn,Mn){var In=[],gr=[];gn.forEach(function(jn){var hr=fileAccepted(jn,et),Tr=_slicedToArray$9(hr,2),cr=Tr[0],yr=Tr[1],Rr=fileMatchSize(jn,ot,st),br=_slicedToArray$9(Rr,2),pr=br[0],vn=br[1],qn=Lt?Lt(jn):null;if(cr&&pr&&!qn)In.push(jn);else{var vr=[yr,vn];qn&&(vr=vr.concat(qn)),gr.push({file:jn,errors:vr.filter(function(Sn){return Sn})})}}),(!at&&In.length>1||at&&lt>=1&&In.length>lt)&&(In.forEach(function(jn){gr.push({file:jn,errors:[TOO_MANY_FILES_REJECTION]})}),In.splice(0)),Xt({acceptedFiles:In,fileRejections:gr,type:"setFiles"}),dt&&dt(In,gr,Mn),gr.length>0&&pt&&pt(gr,Mn),In.length>0&&ft&&ft(In,Mn)},[Xt,at,et,ot,st,lt,dt,ft,pt,Lt]),yn=reactExports.useCallback(function(gn){gn.preventDefault(),gn.persist(),Yn(gn),Jt.current=[],isEvtWithFiles(gn)&&Promise.resolve(it(gn)).then(function(Mn){isPropagationStopped(gn)&&!It||_n(Mn,gn)}),Xt({type:"reset"})},[it,_n,It]),$n=reactExports.useCallback(function(){if(jt.current){Xt({type:"openDialog"}),$t();var gn={multiple:at,types:filePickerOptionsTypes(et)};window.showOpenFilePicker(gn).then(function(Mn){return it(Mn)}).then(function(Mn){_n(Mn,null),Xt({type:"closeDialog"})}).catch(function(Mn){isAbort(Mn)?(kt(Mn),Xt({type:"closeDialog"})):isSecurityError(Mn)&&(jt.current=!1,Ot.current&&(Ot.current.value=null,Ot.current.click()))});return}Ot.current&&(Xt({type:"openDialog"}),$t(),Ot.current.value=null,Ot.current.click())},[Xt,$t,kt,gt,_n,et,at]),Jn=reactExports.useCallback(function(gn){!Dt.current||!Dt.current.isEqualNode(gn.target)||(gn.key===" "||gn.key==="Enter"||gn.keyCode===32||gn.keyCode===13)&&(gn.preventDefault(),$n())},[Dt,$n]),Xn=reactExports.useCallback(function(){Xt({type:"focus"})},[]),Vn=reactExports.useCallback(function(){Xt({type:"blur"})},[]),En=reactExports.useCallback(function(){Tt||(isIeOrEdge()?setTimeout($n,0):$n())},[Tt,$n]),dn=function(Mn){return rt?null:Mn},rr=function(Mn){return wt?null:dn(Mn)},er=function(Mn){return Rt?null:dn(Mn)},Yn=function(Mn){It&&Mn.stopPropagation()},ir=reactExports.useMemo(function(){return function(){var gn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Mn=gn.refKey,In=Mn===void 0?"ref":Mn,gr=gn.role,jn=gn.onKeyDown,hr=gn.onFocus,Tr=gn.onBlur,cr=gn.onClick,yr=gn.onDragEnter,Rr=gn.onDragOver,br=gn.onDragLeave,pr=gn.onDrop,vn=_objectWithoutProperties$4(gn,_excluded3);return _objectSpread(_objectSpread(_defineProperty$7({onKeyDown:rr(composeEventHandlers(jn,Jn)),onFocus:rr(composeEventHandlers(hr,Xn)),onBlur:rr(composeEventHandlers(Tr,Vn)),onClick:dn(composeEventHandlers(cr,En)),onDragEnter:er(composeEventHandlers(yr,hn)),onDragOver:er(composeEventHandlers(Rr,an)),onDragLeave:er(composeEventHandlers(br,pn)),onDrop:er(composeEventHandlers(pr,yn)),role:typeof gr=="string"&&gr!==""?gr:"button"},In,Dt),!rt&&!wt?{tabIndex:0}:{}),vn)}},[Dt,Jn,Xn,Vn,En,hn,an,pn,yn,wt,Rt,rt]),Qn=reactExports.useCallback(function(gn){gn.stopPropagation()},[]),sr=reactExports.useMemo(function(){return function(){var gn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Mn=gn.refKey,In=Mn===void 0?"ref":Mn,gr=gn.onChange,jn=gn.onClick,hr=_objectWithoutProperties$4(gn,_excluded4),Tr=_defineProperty$7({accept:et,multiple:at,type:"file",style:{display:"none"},onChange:dn(composeEventHandlers(gr,yn)),onClick:dn(composeEventHandlers(jn,Qn)),tabIndex:-1},In,Ot);return _objectSpread(_objectSpread({},Tr),hr)}},[Ot,et,at,yn,rt]),un=Gt.length,en=un>0&&allFilesAccepted({files:Gt,accept:et,minSize:ot,maxSize:st,multiple:at,maxFiles:lt}),wn=un>0&&!en;return _objectSpread(_objectSpread({},Yt),{},{isDragAccept:en,isDragReject:wn,isFocused:Zt&&!rt,getRootProps:ir,getInputProps:sr,rootRef:Dt,inputRef:Ot,open:dn($n)})}function reducer(nt,_e){switch(_e.type){case"focus":return _objectSpread(_objectSpread({},nt),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},nt),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},nt),{},{isFileDialogActive:!1});case"setDraggedFiles":var et=_e.isDragActive,rt=_e.draggedFiles;return _objectSpread(_objectSpread({},nt),{},{draggedFiles:rt,isDragActive:et});case"setFiles":return _objectSpread(_objectSpread({},nt),{},{acceptedFiles:_e.acceptedFiles,fileRejections:_e.fileRejections});case"reset":return _objectSpread({},initialState);default:return nt}}function noop$3(){}function createStore$1(nt){let _e;const et=new Set,rt=(ct,ut)=>{const ht=typeof ct=="function"?ct(_e):ct;if(ht!==_e){const dt=_e;_e=ut?ht:Object.assign({},_e,ht),et.forEach(ft=>ft(_e,dt))}},it=()=>_e,st=(ct,ut=it,ht=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let dt=ut(_e);function ft(){const pt=ut(_e);if(!ht(dt,pt)){const mt=dt;ct(dt=pt,mt)}}return et.add(ft),()=>et.delete(ft)},lt={setState:rt,getState:it,subscribe:(ct,ut,ht)=>ut||ht?st(ct,ut,ht):(et.add(ct),()=>et.delete(ct)),destroy:()=>et.clear()};return _e=nt(rt,it,lt),lt}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$3=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create(nt){const _e=typeof nt=="function"?createStore$1(nt):nt,et=(rt=_e.getState,it=Object.is)=>{const[,st]=reactExports.useReducer(At=>At+1,0),ot=_e.getState(),at=reactExports.useRef(ot),lt=reactExports.useRef(rt),ct=reactExports.useRef(it),ut=reactExports.useRef(!1),ht=reactExports.useRef();ht.current===void 0&&(ht.current=rt(ot));let dt,ft=!1;(at.current!==ot||lt.current!==rt||ct.current!==it||ut.current)&&(dt=rt(ot),ft=!it(ht.current,dt)),useIsomorphicLayoutEffect$3(()=>{ft&&(ht.current=dt),at.current=ot,lt.current=rt,ct.current=it,ut.current=!1});const pt=reactExports.useRef(ot);useIsomorphicLayoutEffect$3(()=>{const At=()=>{try{const bt=_e.getState(),Tt=lt.current(bt);ct.current(ht.current,Tt)||(at.current=bt,ht.current=Tt,st())}catch{ut.current=!0,st()}},gt=_e.subscribe(At);return _e.getState()!==pt.current&&At(),gt},[]);const mt=ft?dt:ht.current;return reactExports.useDebugValue(mt),mt};return Object.assign(et,_e),et[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const rt=[et,_e];return{next(){const it=rt.length<=0;return{value:rt.shift(),done:it}}}},et}const subscribeWithSelector=nt=>(_e,et,rt)=>{const it=rt.subscribe;return rt.subscribe=(ot,at,lt)=>{let ct=ot;if(at){const ut=(lt==null?void 0:lt.equalityFn)||Object.is;let ht=ot(rt.getState());ct=dt=>{const ft=ot(dt);if(!ut(ht,ft)){const pt=ht;at(ht=ft,pt)}},lt!=null&&lt.fireImmediately&&at(ht,ht)}return it(ct)},nt(_e,et,rt)};/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isobject=function(_e){return _e!=null&&typeof _e=="object"&&Array.isArray(_e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isObject$7=isobject;function isObjectObject(nt){return isObject$7(nt)===!0&&Object.prototype.toString.call(nt)==="[object Object]"}var isPlainObject$2=function(_e){var et,rt;return!(isObjectObject(_e)===!1||(et=_e.constructor,typeof et!="function")||(rt=et.prototype,isObjectObject(rt)===!1)||rt.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isPlainObject$1=isPlainObject$2,isExtendable$4=function(_e){return isPlainObject$1(_e)||typeof _e=="function"||Array.isArray(_e)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var forIn$1=function(_e,et,rt){for(var it in _e)if(et.call(rt,_e[it],it,_e)===!1)break},isExtendable$3=isExtendable$4,forIn=forIn$1;function mixinDeep(nt,_e){for(var et=arguments.length,rt=0;++rt<et;){var it=arguments[rt];isObject$6(it)&&forIn(it,copy$1,nt)}return nt}function copy$1(nt,_e){if(isValidKey$1(_e)){var et=this[_e];isObject$6(nt)&&isObject$6(et)?mixinDeep(et,nt):this[_e]=nt}}function isObject$6(nt){return isExtendable$3(nt)&&!Array.isArray(nt)}function isValidKey$1(nt){return nt!=="__proto__"&&nt!=="constructor"&&nt!=="prototype"}var mixinDeep_1=mixinDeep;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var getValue$2=function(nt,_e,et,rt,it){if(!isObject$5(nt)||!_e)return nt;if(_e=toString(_e),et&&(_e+="."+toString(et)),rt&&(_e+="."+toString(rt)),it&&(_e+="."+toString(it)),_e in nt)return nt[_e];for(var st=_e.split("."),ot=st.length,at=-1;nt&&++at<ot;){for(var lt=st[at];lt[lt.length-1]==="\\";)lt=lt.slice(0,-1)+"."+st[++at];nt=nt[lt]}return nt};function isObject$5(nt){return nt!==null&&(typeof nt=="object"||typeof nt=="function")}function toString(nt){return nt?Array.isArray(nt)?nt.join("."):nt:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var assignSymbols$1=function(nt,_e){if(nt===null||typeof nt>"u")throw new TypeError("expected first argument to be an object.");if(typeof _e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return nt;for(var et=Object.prototype.propertyIsEnumerable,rt=Object(nt),it=arguments.length,st=0;++st<it;)for(var ot=Object(arguments[st]),at=Object.getOwnPropertySymbols(ot),lt=0;lt<at.length;lt++){var ct=at[lt];et.call(ot,ct)&&(rt[ct]=ot[ct])}return rt},isExtendable$2=isExtendable$4,assignSymbols=assignSymbols$1,extendShallow$1=Object.assign||function(nt){if(nt===null||typeof nt>"u")throw new TypeError("Cannot convert undefined or null to object");isObject$4(nt)||(nt={});for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e];isString(et)&&(et=toObject(et)),isObject$4(et)&&(assign$4(nt,et),assignSymbols(nt,et))}return nt};function assign$4(nt,_e){for(var et in _e)hasOwn$1(_e,et)&&(nt[et]=_e[et])}function isString(nt){return nt&&typeof nt=="string"}function toObject(nt){var _e={};for(var et in nt)_e[et]=nt[et];return _e}function isObject$4(nt){return nt&&typeof nt=="object"||isExtendable$2(nt)}function hasOwn$1(nt,_e){return Object.prototype.hasOwnProperty.call(nt,_e)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var extend$3=extendShallow$1,splitString=function(nt,_e,et){if(typeof nt!="string")throw new TypeError("expected a string");typeof _e=="function"&&(et=_e,_e=null),typeof _e=="string"&&(_e={sep:_e});var rt=extend$3({sep:"."},_e),it=rt.quotes||['"',"'","`"],st;rt.brackets===!0?st={"<":">","(":")","[":"]","{":"}"}:rt.brackets&&(st=rt.brackets);var ot=[],at=[],lt=[""],ct=rt.sep,ut=nt.length,ht=-1,dt;function ft(){if(st&&at.length)return st[at[at.length-1]]}for(;++ht<ut;){var pt=nt[ht],mt=nt[ht+1],At={val:pt,idx:ht,arr:lt,str:nt};if(ot.push(At),pt==="\\"){At.val=keepEscaping(rt,nt,ht)===!0?pt+mt:mt,At.escaped=!0,typeof et=="function"&&et(At),lt[lt.length-1]+=At.val,ht++;continue}if(st&&st[pt]){at.push(pt);var gt=ft(),bt=ht+1;if(nt.indexOf(gt,bt+1)!==-1)for(;at.length&&bt<ut;){var Tt=nt[++bt];if(Tt==="\\"){Tt++;continue}if(it.indexOf(Tt)!==-1){bt=getClosingQuote(nt,Tt,bt+1);continue}if(gt=ft(),at.length&&nt.indexOf(gt,bt+1)===-1)break;if(st[Tt]){at.push(Tt);continue}gt===Tt&&at.pop()}if(dt=bt,dt===-1){lt[lt.length-1]+=pt;continue}pt=nt.slice(ht,dt+1),At.val=pt,At.idx=ht=dt}if(it.indexOf(pt)!==-1){if(dt=getClosingQuote(nt,pt,ht+1),dt===-1){lt[lt.length-1]+=pt;continue}keepQuotes(pt,rt)===!0?pt=nt.slice(ht,dt+1):pt=nt.slice(ht+1,dt),At.val=pt,At.idx=ht=dt}if(typeof et=="function"&&(et(At,ot),pt=At.val,ht=At.idx),At.val===ct&&At.split!==!1){lt.push("");continue}lt[lt.length-1]+=At.val}return lt};function getClosingQuote(nt,_e,et,rt){var it=nt.indexOf(_e,et);return nt.charAt(it-1)==="\\"?getClosingQuote(nt,_e,it+1):it}function keepQuotes(nt,_e){return _e.keepDoubleQuotes===!0&&nt==='"'||_e.keepSingleQuotes===!0&&nt==="'"?!0:_e.keepQuotes}function keepEscaping(nt,_e,et){return typeof nt.keepEscaping=="function"?nt.keepEscaping(_e,et):nt.keepEscaping===!0||_e[et+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable$1=function(_e){return typeof _e<"u"&&_e!==null&&(typeof _e=="object"||typeof _e=="function")},isObject$3=isExtendable$1,extendShallow=function(_e){isObject$3(_e)||(_e={});for(var et=arguments.length,rt=1;rt<et;rt++){var it=arguments[rt];isObject$3(it)&&assign$3(_e,it)}return _e};function assign$3(nt,_e){for(var et in _e)hasOwn(_e,et)&&(nt[et]=_e[et])}function hasOwn(nt,_e){return Object.prototype.hasOwnProperty.call(nt,_e)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable=function(_e){return typeof _e<"u"&&_e!==null&&(typeof _e=="object"||typeof _e=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var split=splitString,extend$2=extendShallow,isPlainObject=isPlainObject$2,isObject$2=isExtendable,setValue=function(nt,_e,et){if(!isObject$2(nt)||(Array.isArray(_e)&&(_e=[].concat.apply([],_e).join(".")),typeof _e!="string"))return nt;for(var rt=split(_e,{sep:".",brackets:!0}).filter(isValidKey),it=rt.length,st=-1,ot=nt;++st<it;){var at=rt[st];if(st!==it-1){isObject$2(ot[at])||(ot[at]={}),ot=ot[at];continue}isPlainObject(ot[at])&&isPlainObject(et)?ot[at]=extend$2({},ot[at],et):ot[at]=et}return nt};function isValidKey(nt){return nt!=="__proto__"&&nt!=="constructor"&&nt!=="prototype"}var isObject$1=isExtendable$4,merge$1=mixinDeep_1,get=getValue$2,set=setValue,mergeValue=function(_e,et,rt){if(!isObject$1(_e))throw new TypeError("expected an object");if(typeof et!="string"||rt==null)return merge$1.apply(null,arguments);if(typeof rt=="string")return set(_e,et,rt),_e;var it=get(_e,et);return isObject$1(rt)&&isObject$1(it)&&(rt=merge$1({},it,rt)),set(_e,et,rt),_e};const merge$2=getDefaultExportFromCjs$1(mergeValue),join$1=(...nt)=>nt.filter(Boolean).join(".");function getKeyPath(nt){const _e=nt.split(".");return[_e.pop(),_e.join(".")||void 0]}function useToggle(nt){const _e=reactExports.useRef(null),et=reactExports.useRef(null),rt=reactExports.useRef(!0);return reactExports.useLayoutEffect(()=>{nt||(_e.current.style.height="0px",_e.current.style.overflow="hidden")},[]),reactExports.useEffect(()=>{if(rt.current){rt.current=!1;return}let it;const st=_e.current,ot=()=>{nt&&(st.style.removeProperty("height"),st.style.removeProperty("overflow"),et.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};st.addEventListener("transitionend",ot,{once:!0});const{height:at}=et.current.getBoundingClientRect();return st.style.height=at+"px",nt||(st.style.overflow="hidden",it=window.setTimeout(()=>st.style.height="0px",50)),()=>{st.removeEventListener("transitionend",ot),clearTimeout(it)}},[nt]),{wrapperRef:_e,contentRef:et}}const useVisiblePaths=nt=>{const[_e,et]=reactExports.useState(nt.getVisiblePaths());return reactExports.useEffect(()=>{et(nt.getVisiblePaths());const rt=nt.useStore.subscribe(nt.getVisiblePaths,et,{equalityFn:shallow});return()=>rt()},[nt]),_e};function usePopin(nt=3){const _e=reactExports.useRef(null),et=reactExports.useRef(null),[rt,it]=reactExports.useState(!1),st=reactExports.useCallback(()=>it(!0),[]),ot=reactExports.useCallback(()=>it(!1),[]);return reactExports.useLayoutEffect(()=>{if(rt){const{bottom:at,top:lt,left:ct}=_e.current.getBoundingClientRect(),{height:ut}=et.current.getBoundingClientRect(),ht=at+ut>window.innerHeight-40?"up":"down";et.current.style.position="fixed",et.current.style.zIndex="10000",et.current.style.left=ct+"px",ht==="down"?et.current.style.top=at+nt+"px":et.current.style.bottom=window.innerHeight-lt+nt+"px"}},[nt,rt]),{popinRef:_e,wrapperRef:et,shown:rt,show:st,hide:ot}}k$1([namesPlugin]);const convertMap={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};v8n.extend({color:()=>nt=>w(nt).isValid()});const schema$2=nt=>v8n().color().test(nt);function convert$1(nt,{format:_e,hasAlpha:et,isString:rt}){const it=convertMap[_e]+(rt&&_e!=="hex"?"String":""),st=nt[it]();return typeof st=="object"&&!et?omit$1(st,["a"]):st}const sanitize$2=(nt,_e)=>{const et=w(nt);if(!et.isValid())throw Error("Invalid color");return convert$1(et,_e)},format$1$1=(nt,_e)=>convert$1(w(nt),_objectSpread2$4(_objectSpread2$4({},_e),{},{isString:!0,format:"hex"})),normalize$3$1=({value:nt})=>{const _e=I$2(nt),et=_e==="name"?"hex":_e,rt=typeof nt=="object"?"a"in nt:_e==="hex"&&nt.length===8||/^(rgba)|(hsla)|(hsva)/.test(nt),it={format:et,hasAlpha:rt,isString:typeof nt=="string"};return{value:sanitize$2(nt,it),settings:it}};var props$2=Object.freeze({__proto__:null,schema:schema$2,sanitize:sanitize$2,format:format$1$1,normalize:normalize$3$1});const ColorPreview=styled("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),PickerContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),PickerWrapper=styled("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function convertToRgb(nt,_e){return _e!=="rgb"?w(nt).toRgb():nt}function Color$3({value:nt,displayValue:_e,settings:et,onUpdate:rt}){const{emitOnEditStart:it,emitOnEditEnd:st}=useInputContext(),{format:ot,hasAlpha:at}=et,{popinRef:lt,wrapperRef:ct,shown:ut,show:ht,hide:dt}=usePopin(),ft=reactExports.useRef(0),[pt,mt]=reactExports.useState(()=>convertToRgb(nt,ot)),At=at?Ce:Ne,gt=()=>{mt(convertToRgb(nt,ot)),ht(),it()},bt=()=>{dt(),st(),window.clearTimeout(ft.current)},Tt=()=>{ft.current=window.setTimeout(bt,500)};return reactExports.useEffect(()=>()=>window.clearTimeout(ft.current),[]),React.createElement(React.Fragment,null,React.createElement(ColorPreview,{ref:lt,active:ut,onClick:()=>gt(),style:{color:_e}}),ut&&React.createElement(Portal$1,null,React.createElement(Overlay,{onPointerUp:bt}),React.createElement(PickerWrapper,{ref:ct,onMouseEnter:()=>window.clearTimeout(ft.current),onMouseLeave:wt=>wt.buttons===0&&Tt()},React.createElement(At,{color:pt,onChange:rt}))))}function ColorComponent(){const{value:nt,displayValue:_e,label:et,onChange:rt,onUpdate:it,settings:st}=useInputContext();return React.createElement(Row$1,{input:!0},React.createElement(Label,null,et),React.createElement(PickerContainer,null,React.createElement(Color$3,{value:nt,displayValue:_e,onChange:rt,onUpdate:it,settings:st}),React.createElement(ValueInput,{value:_e,onChange:rt,onUpdate:it})))}var color$4=_objectSpread2$4({component:ColorComponent},props$2);function Vector3dComponent(){const{label:nt,displayValue:_e,onUpdate:et,settings:rt}=useInputContext();return React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(Vector,{value:_e,settings:rt,onUpdate:et}))}var vector3d=_objectSpread2$4({component:Vector3dComponent},getVectorPlugin(["x","y","z"]));const JoystickTrigger=styled("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),JoystickPlayground=styled("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Joystick({value:nt,settings:_e,onUpdate:et}){const rt=reactExports.useRef(),it=reactExports.useRef(0),st=reactExports.useRef(0),ot=reactExports.useRef(1),[at,lt]=reactExports.useState(!1),[ct,ut]=reactExports.useState(!1),[ht,dt]=useTransform(),ft=reactExports.useRef(null),pt=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{if(at){const{top:zt,left:Ht,width:Yt,height:Xt}=ft.current.getBoundingClientRect();pt.current.style.left=Ht+Yt/2+"px",pt.current.style.top=zt+Xt/2+"px"}},[at]);const{keys:[mt,At],joystick:gt}=_e,bt=gt==="invertY"?1:-1,{[mt]:{step:Tt},[At]:{step:wt}}=_e,Rt=useTh("sizes","joystickWidth"),It=useTh("sizes","joystickHeight"),Lt=parseFloat(Rt)*.8/2,$t=parseFloat(It)*.8/2,kt=reactExports.useCallback(()=>{rt.current||(ut(!0),it.current&&dt({x:it.current*Lt}),st.current&&dt({y:st.current*-$t}),rt.current=window.setInterval(()=>{et(zt=>{const Ht=Tt*it.current*ot.current,Yt=bt*wt*st.current*ot.current;return Array.isArray(zt)?{[mt]:zt[0]+Ht,[At]:zt[1]+Yt}:{[mt]:zt[mt]+Ht,[At]:zt[At]+Yt}})},16))},[Lt,$t,et,dt,Tt,wt,mt,At,bt]),Dt=reactExports.useCallback(()=>{window.clearTimeout(rt.current),rt.current=void 0,ut(!1)},[]);reactExports.useEffect(()=>{function zt(Ht){ot.current=multiplyStep(Ht)}return window.addEventListener("keydown",zt),window.addEventListener("keyup",zt),()=>{window.clearTimeout(rt.current),window.removeEventListener("keydown",zt),window.removeEventListener("keyup",zt)}},[]);const Ot=useDrag(({first:zt,active:Ht,delta:[Yt,Xt],movement:[Zt,rn]})=>{zt&&lt(!0);const Gt=clamp$6(Zt,-Lt,Lt),jt=clamp$6(rn,-$t,$t);it.current=Math.abs(Zt)>Math.abs(Gt)?Math.sign(Zt-Gt):0,st.current=Math.abs(rn)>Math.abs(jt)?Math.sign(jt-rn):0;let Kt=nt[mt],Jt=nt[At];Ht?(it.current||(Kt+=Yt*Tt*ot.current,dt({x:Gt})),st.current||(Jt-=bt*Xt*wt*ot.current,dt({y:jt})),it.current||st.current?kt():Dt(),et({[mt]:Kt,[At]:Jt})):(lt(!1),it.current=0,st.current=0,dt({x:0,y:0}),Dt())});return React.createElement(JoystickTrigger,_extends$3({ref:ft},Ot()),at&&React.createElement(Portal$1,null,React.createElement(JoystickPlayground,{ref:pt,isOutOfBounds:ct},React.createElement("div",null),React.createElement("span",{ref:ht}))))}const Container$1=styled("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Vector2dComponent(){const{label:nt,displayValue:_e,onUpdate:et,settings:rt}=useInputContext();return React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(Container$1,{withJoystick:!!rt.joystick},rt.joystick&&React.createElement(Joystick,{value:_e,settings:rt,onUpdate:et}),React.createElement(Vector,{value:_e,settings:rt,onUpdate:et})))}const _excluded$7=["joystick"],plugin=getVectorPlugin(["x","y"]),normalize$2$1=nt=>{let{joystick:_e=!0}=nt,et=_objectWithoutProperties$5(nt,_excluded$7);const{value:rt,settings:it}=plugin.normalize(et);return{value:rt,settings:_objectSpread2$4(_objectSpread2$4({},it),{},{joystick:_e})}};var vector2d=_objectSpread2$4(_objectSpread2$4({component:Vector2dComponent},plugin),{},{normalize:normalize$2$1});const sanitize$1=nt=>{if(nt!==void 0){if(nt instanceof File)try{return URL.createObjectURL(nt)}catch{return}if(typeof nt=="string"&&nt.indexOf("blob:")===0)return nt;throw Error("Invalid image format [undefined | blob |File].")}},schema$1=(nt,_e)=>typeof _e=="object"&&"image"in _e,normalize$1$1=({image:nt})=>({value:nt});var props$1=Object.freeze({__proto__:null,sanitize:sanitize$1,schema:schema$1,normalize:normalize$1$1});const ImageContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),DropZone=styled("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),ImagePreview=styled("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),ImageLargePreview=styled("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),Instructions=styled("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),Remove=styled("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function ImageComponent(){const{label:nt,value:_e,onUpdate:et,disabled:rt}=useInputContext(),{popinRef:it,wrapperRef:st,shown:ot,show:at,hide:lt}=usePopin(),ct=reactExports.useCallback(pt=>{pt.length&&et(pt[0])},[et]),ut=reactExports.useCallback(pt=>{pt.stopPropagation(),et(void 0)},[et]),{getRootProps:ht,getInputProps:dt,isDragAccept:ft}=useDropzone({maxFiles:1,accept:"image/*",onDrop:ct,disabled:rt});return React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(ImageContainer,null,React.createElement(ImagePreview,{ref:it,hasImage:!!_e,onPointerDown:()=>!!_e&&at(),onPointerUp:lt,style:{backgroundImage:_e?`url(${_e})`:"none"}}),ot&&!!_e&&React.createElement(Portal$1,null,React.createElement(Overlay,{onPointerUp:lt,style:{cursor:"pointer"}}),React.createElement(ImageLargePreview,{ref:st,style:{backgroundImage:`url(${_e})`}})),React.createElement(DropZone,ht({isDragAccept:ft}),React.createElement("input",dt()),React.createElement(Instructions,null,ft?"drop image":"click or drop")),React.createElement(Remove,{onClick:ut,disabled:!_e})))}var image=_objectSpread2$4({component:ImageComponent},props$1);const number$3=v8n().number(),schema=(nt,_e)=>v8n().array().length(2).every.number().test(nt)&&v8n().schema({min:number$3,max:number$3}).test(_e),format$2=nt=>({min:nt[0],max:nt[1]}),sanitize$3=(nt,{bounds:[_e,et]},rt)=>{const it=Array.isArray(nt)?format$2(nt):nt,st={min:rt[0],max:rt[1]},{min:ot,max:at}=_objectSpread2$4(_objectSpread2$4({},st),it);return[clamp$6(Number(ot),_e,Math.max(_e,at)),clamp$6(Number(at),Math.min(et,ot),et)]},normalize$5=({value:nt,min:_e,max:et})=>{const rt={min:_e,max:et},it=normalizeKeyedNumberSettings(format$2(nt),{min:rt,max:rt}),st=[_e,et],ot=_objectSpread2$4(_objectSpread2$4({},it),{},{bounds:st});return{value:sanitize$3(format$2(nt),ot,nt),settings:ot}};var props=Object.freeze({__proto__:null,schema,format:format$2,sanitize:sanitize$3,normalize:normalize$5});const _excluded$6=["value","bounds","onDrag"],_excluded2$1=["bounds"],Container$2=styled("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function IntervalSlider(nt){let{value:_e,bounds:[et,rt],onDrag:it}=nt,st=_objectWithoutProperties$5(nt,_excluded$6);const ot=reactExports.useRef(null),at=reactExports.useRef(null),lt=reactExports.useRef(null),ct=reactExports.useRef(0),ut=useTh("sizes","scrubberWidth"),ht=useDrag(({event:pt,first:mt,xy:[At],movement:[gt],memo:bt={}})=>{if(mt){const{width:wt,left:Rt}=ot.current.getBoundingClientRect();ct.current=wt-parseFloat(ut);const It=(pt==null?void 0:pt.target)===at.current||(pt==null?void 0:pt.target)===lt.current;bt.pos=invertedRange((At-Rt)/wt,et,rt);const Lt=Math.abs(bt.pos-_e.min)-Math.abs(bt.pos-_e.max);bt.key=Lt<0||Lt===0&&bt.pos<=_e.min?"min":"max",It&&(bt.pos=_e[bt.key])}const Tt=bt.pos+invertedRange(gt/ct.current,0,rt-et);return it({[bt.key]:sanitizeStep(Tt,st[bt.key])}),bt}),dt=`calc(${range$2(_e.min,et,rt)} * (100% - ${ut} - 8px) + 4px)`,ft=`calc(${1-range$2(_e.max,et,rt)} * (100% - ${ut} - 8px) + 4px)`;return React.createElement(RangeWrapper,_extends$3({ref:ot},ht()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:dt,right:ft}})),React.createElement(Scrubber,{position:"left",ref:at,style:{left:dt}}),React.createElement(Scrubber,{position:"right",ref:lt,style:{right:ft}}))}function IntervalComponent(){const{label:nt,displayValue:_e,onUpdate:et,settings:rt}=useInputContext(),it=_objectWithoutProperties$5(rt,_excluded2$1);return React.createElement(React.Fragment,null,React.createElement(Row$1,{input:!0},React.createElement(Label,null,nt),React.createElement(Container$2,null,React.createElement(IntervalSlider,_extends$3({value:_e},rt,{onDrag:et})),React.createElement(Vector,{value:_e,settings:it,onUpdate:et,innerLabelTrim:0}))))}var interval=_objectSpread2$4({component:IntervalComponent},props);const createEventEmitter=()=>{const nt=new Map;return{on:(_e,et)=>{let rt=nt.get(_e);rt===void 0&&(rt=new Set,nt.set(_e,rt)),rt.add(et)},off:(_e,et)=>{const rt=nt.get(_e);rt!==void 0&&(rt.delete(et),rt.size===0&&nt.delete(_e))},emit:(_e,...et)=>{const rt=nt.get(_e);if(rt!==void 0)for(const it of rt)it(...et)}}},_excluded$5=["type","value"],_excluded2=["onChange","transient","onEditStart","onEditEnd"],Store=function(){const _e=create(subscribeWithSelector(()=>({data:{}}))),et=createEventEmitter();this.storeId=getUid(),this.useStore=_e;const rt={},it=new Set;this.getVisiblePaths=()=>{const ot=this.getData(),at=Object.keys(ot),lt=[];Object.entries(rt).forEach(([ut,ht])=>{ht.render&&at.some(dt=>dt.indexOf(ut)===0)&&!ht.render(this.get)&&lt.push(ut+".")});const ct=[];return it.forEach(ut=>{ut in ot&&ot[ut].__refCount>0&&lt.every(ht=>ut.indexOf(ht)===-1)&&(!ot[ut].render||ot[ut].render(this.get))&&ct.push(ut)}),ct},this.setOrderedPaths=ot=>{ot.forEach(at=>it.add(at))},this.orderPaths=ot=>(this.setOrderedPaths(ot),ot),this.disposePaths=ot=>{_e.setState(at=>{const lt=at.data;return ot.forEach(ct=>{if(ct in lt){const ut=lt[ct];ut.__refCount--,ut.__refCount===0&&ut.type in SpecialInputs&&delete lt[ct]}}),{data:lt}})},this.dispose=()=>{_e.setState(()=>({data:{}}))},this.getFolderSettings=ot=>rt[ot]||{},this.getData=()=>_e.getState().data,this.addData=(ot,at)=>{_e.setState(lt=>{const ct=lt.data;return Object.entries(ot).forEach(([ut,ht])=>{let dt=ct[ut];if(dt){const{type:ft,value:pt}=ht,mt=_objectWithoutProperties$5(ht,_excluded$5);ft!==dt.type?warn(LevaErrors.INPUT_TYPE_OVERRIDE,ft):((dt.__refCount===0||at)&&Object.assign(dt,mt),dt.__refCount++)}else ct[ut]=_objectSpread2$4(_objectSpread2$4({},ht),{},{__refCount:1})}),{data:ct}})},this.setValueAtPath=(ot,at,lt)=>{_e.setState(ct=>{const ut=ct.data;return updateInput(ut[ot],at,ot,this,lt),{data:ut}})},this.setSettingsAtPath=(ot,at)=>{_e.setState(lt=>{const ct=lt.data;return ct[ot].settings=_objectSpread2$4(_objectSpread2$4({},ct[ot].settings),at),{data:ct}})},this.disableInputAtPath=(ot,at)=>{_e.setState(lt=>{const ct=lt.data;return ct[ot].disabled=at,{data:ct}})},this.set=(ot,at)=>{_e.setState(lt=>{const ct=lt.data;return Object.entries(ot).forEach(([ut,ht])=>{try{updateInput(ct[ut],ht,void 0,void 0,at)}catch{}}),{data:ct}})},this.getInput=ot=>{try{return this.getData()[ot]}catch{warn(LevaErrors.PATH_DOESNT_EXIST,ot)}},this.get=ot=>{var at;return(at=this.getInput(ot))===null||at===void 0?void 0:at.value},this.emitOnEditStart=ot=>{et.emit(`onEditStart:${ot}`,this.get(ot),ot,_objectSpread2$4(_objectSpread2$4({},this.getInput(ot)),{},{get:this.get}))},this.emitOnEditEnd=ot=>{et.emit(`onEditEnd:${ot}`,this.get(ot),ot,_objectSpread2$4(_objectSpread2$4({},this.getInput(ot)),{},{get:this.get}))},this.subscribeToEditStart=(ot,at)=>{const lt=`onEditStart:${ot}`;return et.on(lt,at),()=>et.off(lt,at)},this.subscribeToEditEnd=(ot,at)=>{const lt=`onEditEnd:${ot}`;return et.on(lt,at),()=>et.off(lt,at)};const st=(ot,at,lt)=>{const ct={};return Object.entries(ot).forEach(([ut,ht])=>{if(ut==="")return warn(LevaErrors.EMPTY_KEY);let dt=join$1(at,ut);if(ht.type===SpecialInputs.FOLDER){const ft=st(ht.schema,dt,lt);Object.assign(ct,ft),dt in rt||(rt[dt]=ht.settings)}else if(ut in lt)warn(LevaErrors.DUPLICATE_KEYS,ut,dt,lt[ut].path);else{const ft=normalizeInput(ht,ut,dt,ct);if(ft){const{type:pt,options:mt,input:At}=ft,{onChange:gt,transient:bt,onEditStart:Tt,onEditEnd:wt}=mt,Rt=_objectWithoutProperties$5(mt,_excluded2);ct[dt]=_objectSpread2$4(_objectSpread2$4(_objectSpread2$4({type:pt},Rt),At),{},{fromPanel:!0}),lt[ut]={path:dt,onChange:gt,transient:bt,onEditStart:Tt,onEditEnd:wt}}else warn(LevaErrors.UNKNOWN_INPUT,dt,ht)}}),ct};this.getDataFromSchema=ot=>{const at={};return[st(ot,"",at),at]}};new Store;const isInput=nt=>"__levaInput"in nt,buildTree=(nt,_e)=>{const et={},rt=_e?_e.toLowerCase():null;return nt.forEach(it=>{const[st,ot]=getKeyPath(it);(!rt||st.toLowerCase().indexOf(rt)>-1)&&merge$2(et,ot,{[st]:{__levaInput:!0,path:it}})}),et},_excluded$4=["type","label","path","valueKey","value","settings","setValue","disabled"];function ControlInput(nt){let{type:_e,label:et,path:rt,valueKey:it,value:st,settings:ot,setValue:at,disabled:lt}=nt,ct=_objectWithoutProperties$5(nt,_excluded$4);const{displayValue:ut,onChange:ht,onUpdate:dt}=useInputSetters({type:_e,value:st,settings:ot,setValue:at}),ft=Plugins[_e].component;return ft?React.createElement(InputContext.Provider,{value:_objectSpread2$4({key:it,path:rt,id:""+rt,label:et,displayValue:ut,value:st,onChange:ht,onUpdate:dt,settings:ot,setValue:at,disabled:lt},ct)},React.createElement(StyledInputWrapper$1,{disabled:lt},React.createElement(ft,null))):(warn(LevaErrors.NO_COMPONENT_FOR_TYPE,_e,rt),null)}const StyledButton=styled("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Button$1({onClick:nt,settings:_e,label:et}){const rt=useStoreContext();return React.createElement(Row$1,null,React.createElement(StyledButton,{disabled:_e.disabled,onClick:()=>nt(rt.get)},et))}const StyledButtonGroup=styled("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),StyledButtonGroupButton=styled("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),getOpts=({label:nt,opts:_e})=>{let et=typeof nt=="string"&&nt.trim()===""?null:nt,rt=_e;return typeof _e.opts=="object"&&(rt.label!==void 0&&(et=_e.label),rt=_e.opts),{label:et,opts:rt}};function ButtonGroup(nt){const{label:_e,opts:et}=getOpts(nt),rt=useStoreContext();return React.createElement(Row$1,{input:!!_e},_e&&React.createElement(Label,null,_e),React.createElement(StyledButtonGroup,null,Object.entries(et).map(([it,st])=>React.createElement(StyledButtonGroupButton,{key:it,onClick:()=>st(rt.get)},it))))}const Canvas$1=styled("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),POINTS=100;function push$1(nt,_e){nt.push(_e),nt.length>POINTS&&nt.shift()}const MonitorCanvas=reactExports.forwardRef(function({initialValue:nt},_e){const et=useTh("colors","highlight3"),rt=useTh("colors","elevation2"),it=useTh("colors","highlight1"),[st,ot]=reactExports.useMemo(()=>[w(it).alpha(.4).toRgbString(),w(it).alpha(.1).toRgbString()],[it]),at=reactExports.useRef([nt]),lt=reactExports.useRef(nt),ct=reactExports.useRef(nt),ut=reactExports.useRef(),ht=reactExports.useCallback((pt,mt)=>{if(!pt)return;const{width:At,height:gt}=pt,bt=new Path2D,Tt=At/POINTS,wt=gt*.05;for(let Lt=0;Lt<at.current.length;Lt++){const $t=range$2(at.current[Lt],lt.current,ct.current),kt=Tt*Lt,Dt=gt-$t*(gt-wt*2)-wt;bt.lineTo(kt,Dt)}mt.clearRect(0,0,At,gt);const Rt=new Path2D(bt);Rt.lineTo(Tt*(at.current.length+1),gt),Rt.lineTo(0,gt),Rt.lineTo(0,0);const It=mt.createLinearGradient(0,0,0,gt);It.addColorStop(0,st),It.addColorStop(1,ot),mt.fillStyle=It,mt.fill(Rt),mt.strokeStyle=rt,mt.lineJoin="round",mt.lineWidth=14,mt.stroke(bt),mt.strokeStyle=et,mt.lineWidth=2,mt.stroke(bt)},[et,rt,st,ot]),[dt,ft]=useCanvas2d(ht);return reactExports.useImperativeHandle(_e,()=>({frame:pt=>{(lt.current===void 0||pt<lt.current)&&(lt.current=pt),(ct.current===void 0||pt>ct.current)&&(ct.current=pt),push$1(at.current,pt),ut.current=requestAnimationFrame(()=>ht(dt.current,ft.current))}}),[dt,ft,ht]),reactExports.useEffect(()=>()=>cancelAnimationFrame(ut.current),[]),React.createElement(Canvas$1,{ref:dt})}),parse$2=nt=>Number.isFinite(nt)?nt.toPrecision(2):nt.toString(),MonitorLog=reactExports.forwardRef(function({initialValue:nt},_e){const[et,rt]=reactExports.useState(parse$2(nt));return reactExports.useImperativeHandle(_e,()=>({frame:it=>rt(parse$2(it))}),[]),React.createElement("div",null,et)});function getValue$1(nt){return typeof nt=="function"?nt():nt.current}function Monitor({label:nt,objectOrFn:_e,settings:et}){const rt=reactExports.useRef(),it=reactExports.useRef(getValue$1(_e));return reactExports.useEffect(()=>{const st=window.setInterval(()=>{var ot;document.hidden||(ot=rt.current)===null||ot===void 0||ot.frame(getValue$1(_e))},et.interval);return()=>window.clearInterval(st)},[_e,et.interval]),React.createElement(Row$1,{input:!0},React.createElement(Label,{align:"top"},nt),et.graph?React.createElement(MonitorCanvas,{ref:rt,initialValue:it.current}):React.createElement(MonitorLog,{ref:rt,initialValue:it.current}))}const _excluded$3=["type","label","key"],specialComponents={[SpecialInputs.BUTTON]:Button$1,[SpecialInputs.BUTTON_GROUP]:ButtonGroup,[SpecialInputs.MONITOR]:Monitor},Control=React.memo(({path:nt})=>{const[_e,{set:et,setSettings:rt,disable:it,storeId:st,emitOnEditStart:ot,emitOnEditEnd:at}]=useInput(nt);if(!_e)return null;const{type:lt,label:ct,key:ut}=_e,ht=_objectWithoutProperties$5(_e,_excluded$3);if(lt in SpecialInputs){const dt=specialComponents[lt];return React.createElement(dt,_extends$3({label:ct,path:nt},ht))}return lt in Plugins?React.createElement(ControlInput,_extends$3({key:st+nt,type:lt,label:ct,storeId:st,path:nt,valueKey:ut,setValue:et,setSettings:rt,disable:it,emitOnEditStart:ot,emitOnEditEnd:at},ht)):(log$1(LevaErrors.UNSUPPORTED_INPUT,lt,nt),null)});function FolderTitle({toggle:nt,toggled:_e,name:et}){return React.createElement(StyledTitle,{onClick:()=>nt()},React.createElement(Chevron,{toggled:_e}),React.createElement("div",null,et))}const Folder=({name:nt,path:_e,tree:et})=>{const rt=useStoreContext(),it=join$1(_e,nt),{collapsed:st,color:ot}=rt.getFolderSettings(it),[at,lt]=reactExports.useState(!st),ct=reactExports.useRef(null),ut=useTh("colors","folderWidgetColor"),ht=useTh("colors","folderTextColor");return reactExports.useLayoutEffect(()=>{ct.current.style.setProperty("--leva-colors-folderWidgetColor",ot||ut),ct.current.style.setProperty("--leva-colors-folderTextColor",ot||ht)},[ot,ut,ht]),React.createElement(StyledFolder,{ref:ct},React.createElement(FolderTitle,{name:nt,toggled:at,toggle:()=>lt(dt=>!dt)}),React.createElement(TreeWrapper,{parent:it,tree:et,toggled:at}))},TreeWrapper=React.memo(({isRoot:nt=!1,fill:_e=!1,flat:et=!1,parent:rt,tree:it,toggled:st})=>{const{wrapperRef:ot,contentRef:at}=useToggle(st),lt=useStoreContext(),ct=([ht,dt])=>{var ft;return(isInput(dt)?(ft=lt.getInput(dt.path))===null||ft===void 0?void 0:ft.order:lt.getFolderSettings(join$1(rt,ht)).order)||0},ut=Object.entries(it).sort((ht,dt)=>ct(ht)-ct(dt));return React.createElement(StyledWrapper,{ref:ot,isRoot:nt,fill:_e,flat:et},React.createElement(StyledContent,{ref:at,isRoot:nt,toggled:st},ut.map(([ht,dt])=>isInput(dt)?React.createElement(Control,{key:dt.path,valueKey:dt.valueKey,path:dt.path}):React.createElement(Folder,{key:ht,name:ht,path:rt,tree:dt}))))}),StyledRoot=styled("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${StyledInputRow}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),iconWidth=40,Icon$1=styled("i",{$flexCenter:"",width:iconWidth,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),StyledTitleWithFilter=styled("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),FilterWrapper=styled("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${Icon$1}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),StyledFilterInput=styled("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),TitleContainer=styled("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:iconWidth}}}}),FilterInput=React.forwardRef(({setFilter:nt,toggle:_e},et)=>{const[rt,it]=reactExports.useState(""),st=reactExports.useMemo(()=>debounce$2(nt,250),[nt]),ot=()=>{nt(""),it("")},at=lt=>{const ct=lt.currentTarget.value;_e(!0),it(ct)};return reactExports.useEffect(()=>{st(rt)},[rt,st]),React.createElement(React.Fragment,null,React.createElement(StyledFilterInput,{ref:et,value:rt,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:lt=>lt.stopPropagation(),onChange:at}),React.createElement(Icon$1,{onClick:()=>ot(),style:{visibility:rt?"visible":"hidden"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function TitleWithFilter({setFilter:nt,onDrag:_e,onDragStart:et,onDragEnd:rt,toggle:it,toggled:st,title:ot,drag:at,filterEnabled:lt,from:ct}){const[ut,ht]=reactExports.useState(!1),dt=reactExports.useRef(null);reactExports.useEffect(()=>{var pt,mt;ut?(pt=dt.current)===null||pt===void 0||pt.focus():(mt=dt.current)===null||mt===void 0||mt.blur()},[ut]);const ft=useDrag(({offset:[pt,mt],first:At,last:gt})=>{_e({x:pt,y:mt}),At&&et({x:pt,y:mt}),gt&&rt({x:pt,y:mt})},{filterTaps:!0,from:({offset:[pt,mt]})=>[(ct==null?void 0:ct.x)||pt,(ct==null?void 0:ct.y)||mt]});return reactExports.useEffect(()=>{const pt=mt=>{mt.key==="L"&&mt.shiftKey&&mt.metaKey&&ht(At=>!At)};return window.addEventListener("keydown",pt),()=>window.removeEventListener("keydown",pt)},[]),React.createElement(React.Fragment,null,React.createElement(StyledTitleWithFilter,{mode:at?"drag":void 0},React.createElement(Icon$1,{active:!st,onClick:()=>it()},React.createElement(Chevron,{toggled:st,width:12,height:8})),React.createElement(TitleContainer,_extends$3({},at?ft():{},{drag:at,filterEnabled:lt}),ot===void 0&&at?React.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},React.createElement("circle",{cx:"2",cy:"2",r:"2"}),React.createElement("circle",{cx:"14",cy:"2",r:"2"}),React.createElement("circle",{cx:"26",cy:"2",r:"2"}),React.createElement("circle",{cx:"2",cy:"12",r:"2"}),React.createElement("circle",{cx:"14",cy:"12",r:"2"}),React.createElement("circle",{cx:"26",cy:"12",r:"2"})):ot),lt&&React.createElement(Icon$1,{active:ut,onClick:()=>ht(pt=>!pt)},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},React.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),React.createElement(FilterWrapper,{toggled:ut},React.createElement(FilterInput,{ref:dt,setFilter:nt,toggle:it})))}React.memo(({store:nt,rootClass:_e,fill:et=!1,flat:rt=!1,neverHide:it=!1,oneLineLabels:st=!1,titleBar:ot={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:at=!1,toggled:lt,setToggle:ct})=>{var ut,ht;const dt=useVisiblePaths(nt),[ft,pt]=reactExports.useState(""),mt=reactExports.useMemo(()=>buildTree(dt,ft),[dt,ft]),[At,gt]=useTransform(),bt=it||dt.length>0,Tt=typeof ot=="object"&&ot.title||void 0,wt=typeof ot=="object"&&(ut=ot.drag)!==null&&ut!==void 0?ut:!0,Rt=typeof ot=="object"&&(ht=ot.filter)!==null&&ht!==void 0?ht:!0,It=typeof ot=="object"&&ot.position||void 0,Lt=typeof ot=="object"&&ot.onDrag||void 0,$t=typeof ot=="object"&&ot.onDragStart||void 0,kt=typeof ot=="object"&&ot.onDragEnd||void 0;return React.useEffect(()=>{gt({x:It==null?void 0:It.x,y:It==null?void 0:It.y})},[It,gt]),globalStyles(),React.createElement(PanelSettingsContext.Provider,{value:{hideCopyButton:at}},React.createElement(StyledRoot,{ref:At,className:_e,fill:et,flat:rt,oneLineLabels:st,hideTitleBar:!ot,style:{display:bt?"block":"none"}},ot&&React.createElement(TitleWithFilter,{onDrag:Dt=>{gt(Dt),Lt==null||Lt(Dt)},onDragStart:Dt=>$t==null?void 0:$t(Dt),onDragEnd:Dt=>kt==null?void 0:kt(Dt),setFilter:pt,toggle:Dt=>ct(Ot=>Dt??!Ot),toggled:lt,title:Tt,drag:wt,filterEnabled:Rt,from:It}),bt&&React.createElement(StoreContext.Provider,{value:nt},React.createElement(TreeWrapper,{isRoot:!0,fill:et,flat:rt,tree:mt,toggled:lt}))))});register(LevaInputs.SELECT,select$1);register(LevaInputs.IMAGE,image);register(LevaInputs.NUMBER,number$4);register(LevaInputs.COLOR,color$4);register(LevaInputs.STRING,string$1);register(LevaInputs.BOOLEAN,boolean);register(LevaInputs.INTERVAL,interval);register(LevaInputs.VECTOR3D,vector3d);register(LevaInputs.VECTOR2D,vector2d);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION$1="169",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone$1=0,CullFaceBack$1=1,CullFaceFront$1=2,CullFaceFrontBack=3,BasicShadowMap$1=0,PCFShadowMap$2=1,PCFSoftShadowMap$1=2,VSMShadowMap$1=3,FrontSide$1=0,BackSide$1=1,DoubleSide$1=2,NoBlending$1=0,NormalBlending$1=1,AdditiveBlending$1=2,SubtractiveBlending$1=3,MultiplyBlending$1=4,CustomBlending$1=5,AddEquation$1=100,SubtractEquation$1=101,ReverseSubtractEquation$1=102,MinEquation$1=103,MaxEquation$1=104,ZeroFactor$1=200,OneFactor$1=201,SrcColorFactor$1=202,OneMinusSrcColorFactor$1=203,SrcAlphaFactor$1=204,OneMinusSrcAlphaFactor$1=205,DstAlphaFactor$1=206,OneMinusDstAlphaFactor$1=207,DstColorFactor$1=208,OneMinusDstColorFactor$1=209,SrcAlphaSaturateFactor$1=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth$1=0,AlwaysDepth$1=1,LessDepth$1=2,LessEqualDepth$1=3,EqualDepth$1=4,GreaterEqualDepth$1=5,GreaterDepth$1=6,NotEqualDepth$1=7,MultiplyOperation$1=0,MixOperation$1=1,AddOperation$1=2,NoToneMapping$1=0,LinearToneMapping$1=1,ReinhardToneMapping$1=2,CineonToneMapping$1=3,ACESFilmicToneMapping$1=4,CustomToneMapping=5,AgXToneMapping$1=6,NeutralToneMapping$1=7,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping$1=300,CubeReflectionMapping$1=301,CubeRefractionMapping$1=302,EquirectangularReflectionMapping$1=303,EquirectangularRefractionMapping$1=304,CubeUVReflectionMapping$1=306,RepeatWrapping$1=1e3,ClampToEdgeWrapping$1=1001,MirroredRepeatWrapping$1=1002,NearestFilter$1=1003,NearestMipmapNearestFilter$1=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter$1=1005,NearestMipMapLinearFilter=1005,LinearFilter$1=1006,LinearMipmapNearestFilter$1=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter$1=1008,LinearMipMapLinearFilter=1008,UnsignedByteType$1=1009,ByteType$1=1010,ShortType$1=1011,UnsignedShortType$1=1012,IntType$1=1013,UnsignedIntType$1=1014,FloatType$1=1015,HalfFloatType$1=1016,UnsignedShort4444Type$1=1017,UnsignedShort5551Type$1=1018,UnsignedInt248Type$1=1020,UnsignedInt5999Type$1=35902,AlphaFormat$1=1021,RGBFormat$1=1022,RGBAFormat$1=1023,LuminanceFormat$1=1024,LuminanceAlphaFormat$1=1025,DepthFormat$1=1026,DepthStencilFormat$1=1027,RedFormat$1=1028,RedIntegerFormat$1=1029,RGFormat$1=1030,RGIntegerFormat$1=1031,RGBIntegerFormat$1=1032,RGBAIntegerFormat$1=1033,RGB_S3TC_DXT1_Format$1=33776,RGBA_S3TC_DXT1_Format$1=33777,RGBA_S3TC_DXT3_Format$1=33778,RGBA_S3TC_DXT5_Format$1=33779,RGB_PVRTC_4BPPV1_Format$1=35840,RGB_PVRTC_2BPPV1_Format$1=35841,RGBA_PVRTC_4BPPV1_Format$1=35842,RGBA_PVRTC_2BPPV1_Format$1=35843,RGB_ETC1_Format$1=36196,RGB_ETC2_Format$1=37492,RGBA_ETC2_EAC_Format$1=37496,RGBA_ASTC_4x4_Format$1=37808,RGBA_ASTC_5x4_Format$1=37809,RGBA_ASTC_5x5_Format$1=37810,RGBA_ASTC_6x5_Format$1=37811,RGBA_ASTC_6x6_Format$1=37812,RGBA_ASTC_8x5_Format$1=37813,RGBA_ASTC_8x6_Format$1=37814,RGBA_ASTC_8x8_Format$1=37815,RGBA_ASTC_10x5_Format$1=37816,RGBA_ASTC_10x6_Format$1=37817,RGBA_ASTC_10x8_Format$1=37818,RGBA_ASTC_10x10_Format$1=37819,RGBA_ASTC_12x10_Format$1=37820,RGBA_ASTC_12x12_Format$1=37821,RGBA_BPTC_Format$1=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format$1=36283,SIGNED_RED_RGTC1_Format$1=36284,RED_GREEN_RGTC2_Format$1=36285,SIGNED_RED_GREEN_RGTC2_Format$1=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,BasicDepthPacking=3200,RGBADepthPacking=3201,RGBDepthPacking=3202,RGDepthPacking=3203,TangentSpaceNormalMap$1=0,ObjectSpaceNormalMap$1=1,NoColorSpace$1="",SRGBColorSpace$2="srgb",LinearSRGBColorSpace$2="srgb-linear",DisplayP3ColorSpace$1="display-p3",LinearDisplayP3ColorSpace$1="display-p3-linear",LinearTransfer$1="linear",SRGBTransfer$1="srgb",Rec709Primaries$1="rec709",P3Primaries$1="p3",ZeroStencilOp$1=0,KeepStencilOp$1=7680,ReplaceStencilOp$1=7681,IncrementStencilOp$1=7682,DecrementStencilOp$1=7683,IncrementWrapStencilOp$1=34055,DecrementWrapStencilOp$1=34056,InvertStencilOp$1=5386,NeverStencilFunc$1=512,LessStencilFunc$1=513,EqualStencilFunc$1=514,LessEqualStencilFunc$1=515,GreaterStencilFunc$1=516,NotEqualStencilFunc$1=517,GreaterEqualStencilFunc$1=518,AlwaysStencilFunc$1=519,NeverCompare$1=512,LessCompare$1=513,EqualCompare$1=514,LessEqualCompare$1=515,GreaterCompare$1=516,NotEqualCompare$1=517,GreaterEqualCompare$1=518,AlwaysCompare$1=519,StaticDrawUsage$1=35044,DynamicDrawUsage$1=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",WebGLCoordinateSystem$1=2e3,WebGPUCoordinateSystem$1=2001;let EventDispatcher$1=class{addEventListener(_e,et){this._listeners===void 0&&(this._listeners={});const rt=this._listeners;rt[_e]===void 0&&(rt[_e]=[]),rt[_e].indexOf(et)===-1&&rt[_e].push(et)}hasEventListener(_e,et){if(this._listeners===void 0)return!1;const rt=this._listeners;return rt[_e]!==void 0&&rt[_e].indexOf(et)!==-1}removeEventListener(_e,et){if(this._listeners===void 0)return;const it=this._listeners[_e];if(it!==void 0){const st=it.indexOf(et);st!==-1&&it.splice(st,1)}}dispatchEvent(_e){if(this._listeners===void 0)return;const rt=this._listeners[_e.type];if(rt!==void 0){_e.target=this;const it=rt.slice(0);for(let st=0,ot=it.length;st<ot;st++)it[st].call(this,_e);_e.target=null}}};const _lut$2=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed$1=1234567;const DEG2RAD$1=Math.PI/180,RAD2DEG$1=180/Math.PI;function generateUUID$2(){const nt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,et=Math.random()*4294967295|0,rt=Math.random()*4294967295|0;return(_lut$2[nt&255]+_lut$2[nt>>8&255]+_lut$2[nt>>16&255]+_lut$2[nt>>24&255]+"-"+_lut$2[_e&255]+_lut$2[_e>>8&255]+"-"+_lut$2[_e>>16&15|64]+_lut$2[_e>>24&255]+"-"+_lut$2[et&63|128]+_lut$2[et>>8&255]+"-"+_lut$2[et>>16&255]+_lut$2[et>>24&255]+_lut$2[rt&255]+_lut$2[rt>>8&255]+_lut$2[rt>>16&255]+_lut$2[rt>>24&255]).toLowerCase()}function clamp$5(nt,_e,et){return Math.max(_e,Math.min(et,nt))}function euclideanModulo$1(nt,_e){return(nt%_e+_e)%_e}function mapLinear$1(nt,_e,et,rt,it){return rt+(nt-_e)*(it-rt)/(et-_e)}function inverseLerp$1(nt,_e,et){return nt!==_e?(et-nt)/(_e-nt):0}function lerp$1(nt,_e,et){return(1-et)*nt+et*_e}function damp$2(nt,_e,et,rt){return lerp$1(nt,_e,1-Math.exp(-et*rt))}function pingpong$1(nt,_e=1){return _e-Math.abs(euclideanModulo$1(nt,_e*2)-_e)}function smoothstep$2(nt,_e,et){return nt<=_e?0:nt>=et?1:(nt=(nt-_e)/(et-_e),nt*nt*(3-2*nt))}function smootherstep$1(nt,_e,et){return nt<=_e?0:nt>=et?1:(nt=(nt-_e)/(et-_e),nt*nt*nt*(nt*(nt*6-15)+10))}function randInt$1(nt,_e){return nt+Math.floor(Math.random()*(_e-nt+1))}function randFloat$1(nt,_e){return nt+Math.random()*(_e-nt)}function randFloatSpread$1(nt){return nt*(.5-Math.random())}function seededRandom$1(nt){nt!==void 0&&(_seed$1=nt);let _e=_seed$1+=1831565813;return _e=Math.imul(_e^_e>>>15,_e|1),_e^=_e+Math.imul(_e^_e>>>7,_e|61),((_e^_e>>>14)>>>0)/4294967296}function degToRad$1(nt){return nt*DEG2RAD$1}function radToDeg$1(nt){return nt*RAD2DEG$1}function isPowerOfTwo$1(nt){return(nt&nt-1)===0&&nt!==0}function ceilPowerOfTwo$1(nt){return Math.pow(2,Math.ceil(Math.log(nt)/Math.LN2))}function floorPowerOfTwo$1(nt){return Math.pow(2,Math.floor(Math.log(nt)/Math.LN2))}function setQuaternionFromProperEuler$1(nt,_e,et,rt,it){const st=Math.cos,ot=Math.sin,at=st(et/2),lt=ot(et/2),ct=st((_e+rt)/2),ut=ot((_e+rt)/2),ht=st((_e-rt)/2),dt=ot((_e-rt)/2),ft=st((rt-_e)/2),pt=ot((rt-_e)/2);switch(it){case"XYX":nt.set(at*ut,lt*ht,lt*dt,at*ct);break;case"YZY":nt.set(lt*dt,at*ut,lt*ht,at*ct);break;case"ZXZ":nt.set(lt*ht,lt*dt,at*ut,at*ct);break;case"XZX":nt.set(at*ut,lt*pt,lt*ft,at*ct);break;case"YXY":nt.set(lt*ft,at*ut,lt*pt,at*ct);break;case"ZYZ":nt.set(lt*pt,lt*ft,at*ut,at*ct);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+it)}}function denormalize$1(nt,_e){switch(_e.constructor){case Float32Array:return nt;case Uint32Array:return nt/4294967295;case Uint16Array:return nt/65535;case Uint8Array:return nt/255;case Int32Array:return Math.max(nt/2147483647,-1);case Int16Array:return Math.max(nt/32767,-1);case Int8Array:return Math.max(nt/127,-1);default:throw new Error("Invalid component type.")}}function normalize$4(nt,_e){switch(_e.constructor){case Float32Array:return nt;case Uint32Array:return Math.round(nt*4294967295);case Uint16Array:return Math.round(nt*65535);case Uint8Array:return Math.round(nt*255);case Int32Array:return Math.round(nt*2147483647);case Int16Array:return Math.round(nt*32767);case Int8Array:return Math.round(nt*127);default:throw new Error("Invalid component type.")}}const MathUtils$1={DEG2RAD:DEG2RAD$1,RAD2DEG:RAD2DEG$1,generateUUID:generateUUID$2,clamp:clamp$5,euclideanModulo:euclideanModulo$1,mapLinear:mapLinear$1,inverseLerp:inverseLerp$1,lerp:lerp$1,damp:damp$2,pingpong:pingpong$1,smoothstep:smoothstep$2,smootherstep:smootherstep$1,randInt:randInt$1,randFloat:randFloat$1,randFloatSpread:randFloatSpread$1,seededRandom:seededRandom$1,degToRad:degToRad$1,radToDeg:radToDeg$1,isPowerOfTwo:isPowerOfTwo$1,ceilPowerOfTwo:ceilPowerOfTwo$1,floorPowerOfTwo:floorPowerOfTwo$1,setQuaternionFromProperEuler:setQuaternionFromProperEuler$1,normalize:normalize$4,denormalize:denormalize$1};let Vector2$1=class l0{constructor(_e=0,et=0){l0.prototype.isVector2=!0,this.x=_e,this.y=et}get width(){return this.x}set width(_e){this.x=_e}get height(){return this.y}set height(_e){this.y=_e}set(_e,et){return this.x=_e,this.y=et,this}setScalar(_e){return this.x=_e,this.y=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setComponent(_e,et){switch(_e){case 0:this.x=et;break;case 1:this.y=et;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y)}copy(_e){return this.x=_e.x,this.y=_e.y,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this}addScalar(_e){return this.x+=_e,this.y+=_e,this}addVectors(_e,et){return this.x=_e.x+et.x,this.y=_e.y+et.y,this}addScaledVector(_e,et){return this.x+=_e.x*et,this.y+=_e.y*et,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this}subScalar(_e){return this.x-=_e,this.y-=_e,this}subVectors(_e,et){return this.x=_e.x-et.x,this.y=_e.y-et.y,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this}divide(_e){return this.x/=_e.x,this.y/=_e.y,this}divideScalar(_e){return this.multiplyScalar(1/_e)}applyMatrix3(_e){const et=this.x,rt=this.y,it=_e.elements;return this.x=it[0]*et+it[3]*rt+it[6],this.y=it[1]*et+it[4]*rt+it[7],this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this}clamp(_e,et){return this.x=Math.max(_e.x,Math.min(et.x,this.x)),this.y=Math.max(_e.y,Math.min(et.y,this.y)),this}clampScalar(_e,et){return this.x=Math.max(_e,Math.min(et,this.x)),this.y=Math.max(_e,Math.min(et,this.y)),this}clampLength(_e,et){const rt=this.length();return this.divideScalar(rt||1).multiplyScalar(Math.max(_e,Math.min(et,rt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_e){return this.x*_e.x+this.y*_e.y}cross(_e){return this.x*_e.y-this.y*_e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_e){const et=Math.sqrt(this.lengthSq()*_e.lengthSq());if(et===0)return Math.PI/2;const rt=this.dot(_e)/et;return Math.acos(clamp$5(rt,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const et=this.x-_e.x,rt=this.y-_e.y;return et*et+rt*rt}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,et){return this.x+=(_e.x-this.x)*et,this.y+=(_e.y-this.y)*et,this}lerpVectors(_e,et,rt){return this.x=_e.x+(et.x-_e.x)*rt,this.y=_e.y+(et.y-_e.y)*rt,this}equals(_e){return _e.x===this.x&&_e.y===this.y}fromArray(_e,et=0){return this.x=_e[et],this.y=_e[et+1],this}toArray(_e=[],et=0){return _e[et]=this.x,_e[et+1]=this.y,_e}fromBufferAttribute(_e,et){return this.x=_e.getX(et),this.y=_e.getY(et),this}rotateAround(_e,et){const rt=Math.cos(et),it=Math.sin(et),st=this.x-_e.x,ot=this.y-_e.y;return this.x=st*rt-ot*it+_e.x,this.y=st*it+ot*rt+_e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Matrix3$1=class c0{constructor(_e,et,rt,it,st,ot,at,lt,ct){c0.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_e!==void 0&&this.set(_e,et,rt,it,st,ot,at,lt,ct)}set(_e,et,rt,it,st,ot,at,lt,ct){const ut=this.elements;return ut[0]=_e,ut[1]=it,ut[2]=at,ut[3]=et,ut[4]=st,ut[5]=lt,ut[6]=rt,ut[7]=ot,ut[8]=ct,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_e){const et=this.elements,rt=_e.elements;return et[0]=rt[0],et[1]=rt[1],et[2]=rt[2],et[3]=rt[3],et[4]=rt[4],et[5]=rt[5],et[6]=rt[6],et[7]=rt[7],et[8]=rt[8],this}extractBasis(_e,et,rt){return _e.setFromMatrix3Column(this,0),et.setFromMatrix3Column(this,1),rt.setFromMatrix3Column(this,2),this}setFromMatrix4(_e){const et=_e.elements;return this.set(et[0],et[4],et[8],et[1],et[5],et[9],et[2],et[6],et[10]),this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,et){const rt=_e.elements,it=et.elements,st=this.elements,ot=rt[0],at=rt[3],lt=rt[6],ct=rt[1],ut=rt[4],ht=rt[7],dt=rt[2],ft=rt[5],pt=rt[8],mt=it[0],At=it[3],gt=it[6],bt=it[1],Tt=it[4],wt=it[7],Rt=it[2],It=it[5],Lt=it[8];return st[0]=ot*mt+at*bt+lt*Rt,st[3]=ot*At+at*Tt+lt*It,st[6]=ot*gt+at*wt+lt*Lt,st[1]=ct*mt+ut*bt+ht*Rt,st[4]=ct*At+ut*Tt+ht*It,st[7]=ct*gt+ut*wt+ht*Lt,st[2]=dt*mt+ft*bt+pt*Rt,st[5]=dt*At+ft*Tt+pt*It,st[8]=dt*gt+ft*wt+pt*Lt,this}multiplyScalar(_e){const et=this.elements;return et[0]*=_e,et[3]*=_e,et[6]*=_e,et[1]*=_e,et[4]*=_e,et[7]*=_e,et[2]*=_e,et[5]*=_e,et[8]*=_e,this}determinant(){const _e=this.elements,et=_e[0],rt=_e[1],it=_e[2],st=_e[3],ot=_e[4],at=_e[5],lt=_e[6],ct=_e[7],ut=_e[8];return et*ot*ut-et*at*ct-rt*st*ut+rt*at*lt+it*st*ct-it*ot*lt}invert(){const _e=this.elements,et=_e[0],rt=_e[1],it=_e[2],st=_e[3],ot=_e[4],at=_e[5],lt=_e[6],ct=_e[7],ut=_e[8],ht=ut*ot-at*ct,dt=at*lt-ut*st,ft=ct*st-ot*lt,pt=et*ht+rt*dt+it*ft;if(pt===0)return this.set(0,0,0,0,0,0,0,0,0);const mt=1/pt;return _e[0]=ht*mt,_e[1]=(it*ct-ut*rt)*mt,_e[2]=(at*rt-it*ot)*mt,_e[3]=dt*mt,_e[4]=(ut*et-it*lt)*mt,_e[5]=(it*st-at*et)*mt,_e[6]=ft*mt,_e[7]=(rt*lt-ct*et)*mt,_e[8]=(ot*et-rt*st)*mt,this}transpose(){let _e;const et=this.elements;return _e=et[1],et[1]=et[3],et[3]=_e,_e=et[2],et[2]=et[6],et[6]=_e,_e=et[5],et[5]=et[7],et[7]=_e,this}getNormalMatrix(_e){return this.setFromMatrix4(_e).invert().transpose()}transposeIntoArray(_e){const et=this.elements;return _e[0]=et[0],_e[1]=et[3],_e[2]=et[6],_e[3]=et[1],_e[4]=et[4],_e[5]=et[7],_e[6]=et[2],_e[7]=et[5],_e[8]=et[8],this}setUvTransform(_e,et,rt,it,st,ot,at){const lt=Math.cos(st),ct=Math.sin(st);return this.set(rt*lt,rt*ct,-rt*(lt*ot+ct*at)+ot+_e,-it*ct,it*lt,-it*(-ct*ot+lt*at)+at+et,0,0,1),this}scale(_e,et){return this.premultiply(_m3$1.makeScale(_e,et)),this}rotate(_e){return this.premultiply(_m3$1.makeRotation(-_e)),this}translate(_e,et){return this.premultiply(_m3$1.makeTranslation(_e,et)),this}makeTranslation(_e,et){return _e.isVector2?this.set(1,0,_e.x,0,1,_e.y,0,0,1):this.set(1,0,_e,0,1,et,0,0,1),this}makeRotation(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(et,-rt,0,rt,et,0,0,0,1),this}makeScale(_e,et){return this.set(_e,0,0,0,et,0,0,0,1),this}equals(_e){const et=this.elements,rt=_e.elements;for(let it=0;it<9;it++)if(et[it]!==rt[it])return!1;return!0}fromArray(_e,et=0){for(let rt=0;rt<9;rt++)this.elements[rt]=_e[rt+et];return this}toArray(_e=[],et=0){const rt=this.elements;return _e[et]=rt[0],_e[et+1]=rt[1],_e[et+2]=rt[2],_e[et+3]=rt[3],_e[et+4]=rt[4],_e[et+5]=rt[5],_e[et+6]=rt[6],_e[et+7]=rt[7],_e[et+8]=rt[8],_e}clone(){return new this.constructor().fromArray(this.elements)}};const _m3$1=new Matrix3$1;function arrayNeedsUint32$2(nt){for(let _e=nt.length-1;_e>=0;--_e)if(nt[_e]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(nt,_e){return new TYPED_ARRAYS[nt](_e)}function createElementNS$1(nt){return document.createElementNS("http://www.w3.org/1999/xhtml",nt)}function createCanvasElement$1(){const nt=createElementNS$1("canvas");return nt.style.display="block",nt}const _cache$3={};function warnOnce$1(nt){nt in _cache$3||(_cache$3[nt]=!0,console.warn(nt))}function probeAsync(nt,_e,et){return new Promise(function(rt,it){function st(){switch(nt.clientWaitSync(_e,nt.SYNC_FLUSH_COMMANDS_BIT,0)){case nt.WAIT_FAILED:it();break;case nt.TIMEOUT_EXPIRED:setTimeout(st,et);break;default:rt()}}setTimeout(st,et)})}function toNormalizedProjectionMatrix(nt){const _e=nt.elements;_e[2]=.5*_e[2]+.5*_e[3],_e[6]=.5*_e[6]+.5*_e[7],_e[10]=.5*_e[10]+.5*_e[11],_e[14]=.5*_e[14]+.5*_e[15]}function toReversedProjectionMatrix(nt){const _e=nt.elements;_e[11]===-1?(_e[10]=-_e[10]-1,_e[14]=-_e[14]):(_e[10]=-_e[10],_e[14]=-_e[14]+1)}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3$1=new Matrix3$1().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB$1=new Matrix3$1().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES$1={[LinearSRGBColorSpace$2]:{transfer:LinearTransfer$1,primaries:Rec709Primaries$1,luminanceCoefficients:[.2126,.7152,.0722],toReference:nt=>nt,fromReference:nt=>nt},[SRGBColorSpace$2]:{transfer:SRGBTransfer$1,primaries:Rec709Primaries$1,luminanceCoefficients:[.2126,.7152,.0722],toReference:nt=>nt.convertSRGBToLinear(),fromReference:nt=>nt.convertLinearToSRGB()},[LinearDisplayP3ColorSpace$1]:{transfer:LinearTransfer$1,primaries:P3Primaries$1,luminanceCoefficients:[.2289,.6917,.0793],toReference:nt=>nt.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB$1),fromReference:nt=>nt.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3$1)},[DisplayP3ColorSpace$1]:{transfer:SRGBTransfer$1,primaries:P3Primaries$1,luminanceCoefficients:[.2289,.6917,.0793],toReference:nt=>nt.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB$1),fromReference:nt=>nt.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3$1).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES$1=new Set([LinearSRGBColorSpace$2,LinearDisplayP3ColorSpace$1]),ColorManagement$1={enabled:!0,_workingColorSpace:LinearSRGBColorSpace$2,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(nt){if(!SUPPORTED_WORKING_COLOR_SPACES$1.has(nt))throw new Error(`Unsupported working color space, "${nt}".`);this._workingColorSpace=nt},convert:function(nt,_e,et){if(this.enabled===!1||_e===et||!_e||!et)return nt;const rt=COLOR_SPACES$1[_e].toReference,it=COLOR_SPACES$1[et].fromReference;return it(rt(nt))},fromWorkingColorSpace:function(nt,_e){return this.convert(nt,this._workingColorSpace,_e)},toWorkingColorSpace:function(nt,_e){return this.convert(nt,_e,this._workingColorSpace)},getPrimaries:function(nt){return COLOR_SPACES$1[nt].primaries},getTransfer:function(nt){return nt===NoColorSpace$1?LinearTransfer$1:COLOR_SPACES$1[nt].transfer},getLuminanceCoefficients:function(nt,_e=this._workingColorSpace){return nt.fromArray(COLOR_SPACES$1[_e].luminanceCoefficients)}};function SRGBToLinear$1(nt){return nt<.04045?nt*.0773993808:Math.pow(nt*.9478672986+.0521327014,2.4)}function LinearToSRGB$1(nt){return nt<.0031308?nt*12.92:1.055*Math.pow(nt,.41666)-.055}let _canvas$1,ImageUtils$1=class{static getDataURL(_e){if(/^data:/i.test(_e.src)||typeof HTMLCanvasElement>"u")return _e.src;let et;if(_e instanceof HTMLCanvasElement)et=_e;else{_canvas$1===void 0&&(_canvas$1=createElementNS$1("canvas")),_canvas$1.width=_e.width,_canvas$1.height=_e.height;const rt=_canvas$1.getContext("2d");_e instanceof ImageData?rt.putImageData(_e,0,0):rt.drawImage(_e,0,0,_e.width,_e.height),et=_canvas$1}return et.width>2048||et.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_e),et.toDataURL("image/jpeg",.6)):et.toDataURL("image/png")}static sRGBToLinear(_e){if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){const et=createElementNS$1("canvas");et.width=_e.width,et.height=_e.height;const rt=et.getContext("2d");rt.drawImage(_e,0,0,_e.width,_e.height);const it=rt.getImageData(0,0,_e.width,_e.height),st=it.data;for(let ot=0;ot<st.length;ot++)st[ot]=SRGBToLinear$1(st[ot]/255)*255;return rt.putImageData(it,0,0),et}else if(_e.data){const et=_e.data.slice(0);for(let rt=0;rt<et.length;rt++)et instanceof Uint8Array||et instanceof Uint8ClampedArray?et[rt]=Math.floor(SRGBToLinear$1(et[rt]/255)*255):et[rt]=SRGBToLinear$1(et[rt]);return{data:et,width:_e.width,height:_e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_e}},_sourceId$1=0,Source$1=class{constructor(_e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId$1++}),this.uuid=generateUUID$2(),this.data=_e,this.dataReady=!0,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}toJSON(_e){const et=_e===void 0||typeof _e=="string";if(!et&&_e.images[this.uuid]!==void 0)return _e.images[this.uuid];const rt={uuid:this.uuid,url:""},it=this.data;if(it!==null){let st;if(Array.isArray(it)){st=[];for(let ot=0,at=it.length;ot<at;ot++)it[ot].isDataTexture?st.push(serializeImage$1(it[ot].image)):st.push(serializeImage$1(it[ot]))}else st=serializeImage$1(it);rt.url=st}return et||(_e.images[this.uuid]=rt),rt}};function serializeImage$1(nt){return typeof HTMLImageElement<"u"&&nt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&nt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&nt instanceof ImageBitmap?ImageUtils$1.getDataURL(nt):nt.data?{data:Array.from(nt.data),width:nt.width,height:nt.height,type:nt.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId$1=0,Texture$1=class Am extends EventDispatcher$1{constructor(_e=Am.DEFAULT_IMAGE,et=Am.DEFAULT_MAPPING,rt=ClampToEdgeWrapping$1,it=ClampToEdgeWrapping$1,st=LinearFilter$1,ot=LinearMipmapLinearFilter$1,at=RGBAFormat$1,lt=UnsignedByteType$1,ct=Am.DEFAULT_ANISOTROPY,ut=NoColorSpace$1){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId$1++}),this.uuid=generateUUID$2(),this.name="",this.source=new Source$1(_e),this.mipmaps=[],this.mapping=et,this.channel=0,this.wrapS=rt,this.wrapT=it,this.magFilter=st,this.minFilter=ot,this.anisotropy=ct,this.format=at,this.internalFormat=null,this.type=lt,this.offset=new Vector2$1(0,0),this.repeat=new Vector2$1(1,1),this.center=new Vector2$1(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3$1,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ut,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_e=null){this.source.data=_e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_e){return this.name=_e.name,this.source=_e.source,this.mipmaps=_e.mipmaps.slice(0),this.mapping=_e.mapping,this.channel=_e.channel,this.wrapS=_e.wrapS,this.wrapT=_e.wrapT,this.magFilter=_e.magFilter,this.minFilter=_e.minFilter,this.anisotropy=_e.anisotropy,this.format=_e.format,this.internalFormat=_e.internalFormat,this.type=_e.type,this.offset.copy(_e.offset),this.repeat.copy(_e.repeat),this.center.copy(_e.center),this.rotation=_e.rotation,this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrix.copy(_e.matrix),this.generateMipmaps=_e.generateMipmaps,this.premultiplyAlpha=_e.premultiplyAlpha,this.flipY=_e.flipY,this.unpackAlignment=_e.unpackAlignment,this.colorSpace=_e.colorSpace,this.userData=JSON.parse(JSON.stringify(_e.userData)),this.needsUpdate=!0,this}toJSON(_e){const et=_e===void 0||typeof _e=="string";if(!et&&_e.textures[this.uuid]!==void 0)return _e.textures[this.uuid];const rt={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(rt.userData=this.userData),et||(_e.textures[this.uuid]=rt),rt}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_e){if(this.mapping!==UVMapping$1)return _e;if(_e.applyMatrix3(this.matrix),_e.x<0||_e.x>1)switch(this.wrapS){case RepeatWrapping$1:_e.x=_e.x-Math.floor(_e.x);break;case ClampToEdgeWrapping$1:_e.x=_e.x<0?0:1;break;case MirroredRepeatWrapping$1:Math.abs(Math.floor(_e.x)%2)===1?_e.x=Math.ceil(_e.x)-_e.x:_e.x=_e.x-Math.floor(_e.x);break}if(_e.y<0||_e.y>1)switch(this.wrapT){case RepeatWrapping$1:_e.y=_e.y-Math.floor(_e.y);break;case ClampToEdgeWrapping$1:_e.y=_e.y<0?0:1;break;case MirroredRepeatWrapping$1:Math.abs(Math.floor(_e.y)%2)===1?_e.y=Math.ceil(_e.y)-_e.y:_e.y=_e.y-Math.floor(_e.y);break}return this.flipY&&(_e.y=1-_e.y),_e}set needsUpdate(_e){_e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_e){_e===!0&&this.pmremVersion++}};Texture$1.DEFAULT_IMAGE=null;Texture$1.DEFAULT_MAPPING=UVMapping$1;Texture$1.DEFAULT_ANISOTROPY=1;let Vector4$1=class u0{constructor(_e=0,et=0,rt=0,it=1){u0.prototype.isVector4=!0,this.x=_e,this.y=et,this.z=rt,this.w=it}get width(){return this.z}set width(_e){this.z=_e}get height(){return this.w}set height(_e){this.w=_e}set(_e,et,rt,it){return this.x=_e,this.y=et,this.z=rt,this.w=it,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this.w=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setW(_e){return this.w=_e,this}setComponent(_e,et){switch(_e){case 0:this.x=et;break;case 1:this.y=et;break;case 2:this.z=et;break;case 3:this.w=et;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this.w=_e.w!==void 0?_e.w:1,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this.w+=_e.w,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this.w+=_e,this}addVectors(_e,et){return this.x=_e.x+et.x,this.y=_e.y+et.y,this.z=_e.z+et.z,this.w=_e.w+et.w,this}addScaledVector(_e,et){return this.x+=_e.x*et,this.y+=_e.y*et,this.z+=_e.z*et,this.w+=_e.w*et,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this.w-=_e.w,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this.w-=_e,this}subVectors(_e,et){return this.x=_e.x-et.x,this.y=_e.y-et.y,this.z=_e.z-et.z,this.w=_e.w-et.w,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this.w*=_e.w,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this.w*=_e,this}applyMatrix4(_e){const et=this.x,rt=this.y,it=this.z,st=this.w,ot=_e.elements;return this.x=ot[0]*et+ot[4]*rt+ot[8]*it+ot[12]*st,this.y=ot[1]*et+ot[5]*rt+ot[9]*it+ot[13]*st,this.z=ot[2]*et+ot[6]*rt+ot[10]*it+ot[14]*st,this.w=ot[3]*et+ot[7]*rt+ot[11]*it+ot[15]*st,this}divideScalar(_e){return this.multiplyScalar(1/_e)}setAxisAngleFromQuaternion(_e){this.w=2*Math.acos(_e.w);const et=Math.sqrt(1-_e.w*_e.w);return et<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_e.x/et,this.y=_e.y/et,this.z=_e.z/et),this}setAxisAngleFromRotationMatrix(_e){let et,rt,it,st;const lt=_e.elements,ct=lt[0],ut=lt[4],ht=lt[8],dt=lt[1],ft=lt[5],pt=lt[9],mt=lt[2],At=lt[6],gt=lt[10];if(Math.abs(ut-dt)<.01&&Math.abs(ht-mt)<.01&&Math.abs(pt-At)<.01){if(Math.abs(ut+dt)<.1&&Math.abs(ht+mt)<.1&&Math.abs(pt+At)<.1&&Math.abs(ct+ft+gt-3)<.1)return this.set(1,0,0,0),this;et=Math.PI;const Tt=(ct+1)/2,wt=(ft+1)/2,Rt=(gt+1)/2,It=(ut+dt)/4,Lt=(ht+mt)/4,$t=(pt+At)/4;return Tt>wt&&Tt>Rt?Tt<.01?(rt=0,it=.707106781,st=.707106781):(rt=Math.sqrt(Tt),it=It/rt,st=Lt/rt):wt>Rt?wt<.01?(rt=.707106781,it=0,st=.707106781):(it=Math.sqrt(wt),rt=It/it,st=$t/it):Rt<.01?(rt=.707106781,it=.707106781,st=0):(st=Math.sqrt(Rt),rt=Lt/st,it=$t/st),this.set(rt,it,st,et),this}let bt=Math.sqrt((At-pt)*(At-pt)+(ht-mt)*(ht-mt)+(dt-ut)*(dt-ut));return Math.abs(bt)<.001&&(bt=1),this.x=(At-pt)/bt,this.y=(ht-mt)/bt,this.z=(dt-ut)/bt,this.w=Math.acos((ct+ft+gt-1)/2),this}setFromMatrixPosition(_e){const et=_e.elements;return this.x=et[12],this.y=et[13],this.z=et[14],this.w=et[15],this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this.w=Math.min(this.w,_e.w),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this.w=Math.max(this.w,_e.w),this}clamp(_e,et){return this.x=Math.max(_e.x,Math.min(et.x,this.x)),this.y=Math.max(_e.y,Math.min(et.y,this.y)),this.z=Math.max(_e.z,Math.min(et.z,this.z)),this.w=Math.max(_e.w,Math.min(et.w,this.w)),this}clampScalar(_e,et){return this.x=Math.max(_e,Math.min(et,this.x)),this.y=Math.max(_e,Math.min(et,this.y)),this.z=Math.max(_e,Math.min(et,this.z)),this.w=Math.max(_e,Math.min(et,this.w)),this}clampLength(_e,et){const rt=this.length();return this.divideScalar(rt||1).multiplyScalar(Math.max(_e,Math.min(et,rt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z+this.w*_e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,et){return this.x+=(_e.x-this.x)*et,this.y+=(_e.y-this.y)*et,this.z+=(_e.z-this.z)*et,this.w+=(_e.w-this.w)*et,this}lerpVectors(_e,et,rt){return this.x=_e.x+(et.x-_e.x)*rt,this.y=_e.y+(et.y-_e.y)*rt,this.z=_e.z+(et.z-_e.z)*rt,this.w=_e.w+(et.w-_e.w)*rt,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z&&_e.w===this.w}fromArray(_e,et=0){return this.x=_e[et],this.y=_e[et+1],this.z=_e[et+2],this.w=_e[et+3],this}toArray(_e=[],et=0){return _e[et]=this.x,_e[et+1]=this.y,_e[et+2]=this.z,_e[et+3]=this.w,_e}fromBufferAttribute(_e,et){return this.x=_e.getX(et),this.y=_e.getY(et),this.z=_e.getZ(et),this.w=_e.getW(et),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},RenderTarget$1=class extends EventDispatcher$1{constructor(_e=1,et=1,rt={}){super(),this.isRenderTarget=!0,this.width=_e,this.height=et,this.depth=1,this.scissor=new Vector4$1(0,0,_e,et),this.scissorTest=!1,this.viewport=new Vector4$1(0,0,_e,et);const it={width:_e,height:et,depth:1};rt=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter$1,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},rt);const st=new Texture$1(it,rt.mapping,rt.wrapS,rt.wrapT,rt.magFilter,rt.minFilter,rt.format,rt.type,rt.anisotropy,rt.colorSpace);st.flipY=!1,st.generateMipmaps=rt.generateMipmaps,st.internalFormat=rt.internalFormat,this.textures=[];const ot=rt.count;for(let at=0;at<ot;at++)this.textures[at]=st.clone(),this.textures[at].isRenderTargetTexture=!0;this.depthBuffer=rt.depthBuffer,this.stencilBuffer=rt.stencilBuffer,this.resolveDepthBuffer=rt.resolveDepthBuffer,this.resolveStencilBuffer=rt.resolveStencilBuffer,this.depthTexture=rt.depthTexture,this.samples=rt.samples}get texture(){return this.textures[0]}set texture(_e){this.textures[0]=_e}setSize(_e,et,rt=1){if(this.width!==_e||this.height!==et||this.depth!==rt){this.width=_e,this.height=et,this.depth=rt;for(let it=0,st=this.textures.length;it<st;it++)this.textures[it].image.width=_e,this.textures[it].image.height=et,this.textures[it].image.depth=rt;this.dispose()}this.viewport.set(0,0,_e,et),this.scissor.set(0,0,_e,et)}clone(){return new this.constructor().copy(this)}copy(_e){this.width=_e.width,this.height=_e.height,this.depth=_e.depth,this.scissor.copy(_e.scissor),this.scissorTest=_e.scissorTest,this.viewport.copy(_e.viewport),this.textures.length=0;for(let rt=0,it=_e.textures.length;rt<it;rt++)this.textures[rt]=_e.textures[rt].clone(),this.textures[rt].isRenderTargetTexture=!0;const et=Object.assign({},_e.texture.image);return this.texture.source=new Source$1(et),this.depthBuffer=_e.depthBuffer,this.stencilBuffer=_e.stencilBuffer,this.resolveDepthBuffer=_e.resolveDepthBuffer,this.resolveStencilBuffer=_e.resolveStencilBuffer,_e.depthTexture!==null&&(this.depthTexture=_e.depthTexture.clone()),this.samples=_e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},WebGLRenderTarget$1=class extends RenderTarget$1{constructor(_e=1,et=1,rt={}){super(_e,et,rt),this.isWebGLRenderTarget=!0}},DataArrayTexture$1=class extends Texture$1{constructor(_e=null,et=1,rt=1,it=1){super(null),this.isDataArrayTexture=!0,this.image={data:_e,width:et,height:rt,depth:it},this.magFilter=NearestFilter$1,this.minFilter=NearestFilter$1,this.wrapR=ClampToEdgeWrapping$1,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(_e){this.layerUpdates.add(_e)}clearLayerUpdates(){this.layerUpdates.clear()}};class WebGLArrayRenderTarget extends WebGLRenderTarget$1{constructor(_e=1,et=1,rt=1,it={}){super(_e,et,it),this.isWebGLArrayRenderTarget=!0,this.depth=rt,this.texture=new DataArrayTexture$1(null,_e,et,rt),this.texture.isRenderTargetTexture=!0}}class Data3DTexture extends Texture$1{constructor(_e=null,et=1,rt=1,it=1){super(null),this.isData3DTexture=!0,this.image={data:_e,width:et,height:rt,depth:it},this.magFilter=NearestFilter$1,this.minFilter=NearestFilter$1,this.wrapR=ClampToEdgeWrapping$1,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget$1{constructor(_e=1,et=1,rt=1,it={}){super(_e,et,it),this.isWebGL3DRenderTarget=!0,this.depth=rt,this.texture=new Data3DTexture(null,_e,et,rt),this.texture.isRenderTargetTexture=!0}}let Quaternion$1=class{constructor(_e=0,et=0,rt=0,it=1){this.isQuaternion=!0,this._x=_e,this._y=et,this._z=rt,this._w=it}static slerpFlat(_e,et,rt,it,st,ot,at){let lt=rt[it+0],ct=rt[it+1],ut=rt[it+2],ht=rt[it+3];const dt=st[ot+0],ft=st[ot+1],pt=st[ot+2],mt=st[ot+3];if(at===0){_e[et+0]=lt,_e[et+1]=ct,_e[et+2]=ut,_e[et+3]=ht;return}if(at===1){_e[et+0]=dt,_e[et+1]=ft,_e[et+2]=pt,_e[et+3]=mt;return}if(ht!==mt||lt!==dt||ct!==ft||ut!==pt){let At=1-at;const gt=lt*dt+ct*ft+ut*pt+ht*mt,bt=gt>=0?1:-1,Tt=1-gt*gt;if(Tt>Number.EPSILON){const Rt=Math.sqrt(Tt),It=Math.atan2(Rt,gt*bt);At=Math.sin(At*It)/Rt,at=Math.sin(at*It)/Rt}const wt=at*bt;if(lt=lt*At+dt*wt,ct=ct*At+ft*wt,ut=ut*At+pt*wt,ht=ht*At+mt*wt,At===1-at){const Rt=1/Math.sqrt(lt*lt+ct*ct+ut*ut+ht*ht);lt*=Rt,ct*=Rt,ut*=Rt,ht*=Rt}}_e[et]=lt,_e[et+1]=ct,_e[et+2]=ut,_e[et+3]=ht}static multiplyQuaternionsFlat(_e,et,rt,it,st,ot){const at=rt[it],lt=rt[it+1],ct=rt[it+2],ut=rt[it+3],ht=st[ot],dt=st[ot+1],ft=st[ot+2],pt=st[ot+3];return _e[et]=at*pt+ut*ht+lt*ft-ct*dt,_e[et+1]=lt*pt+ut*dt+ct*ht-at*ft,_e[et+2]=ct*pt+ut*ft+at*dt-lt*ht,_e[et+3]=ut*pt-at*ht-lt*dt-ct*ft,_e}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get w(){return this._w}set w(_e){this._w=_e,this._onChangeCallback()}set(_e,et,rt,it){return this._x=_e,this._y=et,this._z=rt,this._w=it,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_e){return this._x=_e.x,this._y=_e.y,this._z=_e.z,this._w=_e.w,this._onChangeCallback(),this}setFromEuler(_e,et=!0){const rt=_e._x,it=_e._y,st=_e._z,ot=_e._order,at=Math.cos,lt=Math.sin,ct=at(rt/2),ut=at(it/2),ht=at(st/2),dt=lt(rt/2),ft=lt(it/2),pt=lt(st/2);switch(ot){case"XYZ":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"YXZ":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;case"ZXY":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"ZYX":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;case"YZX":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"XZY":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+ot)}return et===!0&&this._onChangeCallback(),this}setFromAxisAngle(_e,et){const rt=et/2,it=Math.sin(rt);return this._x=_e.x*it,this._y=_e.y*it,this._z=_e.z*it,this._w=Math.cos(rt),this._onChangeCallback(),this}setFromRotationMatrix(_e){const et=_e.elements,rt=et[0],it=et[4],st=et[8],ot=et[1],at=et[5],lt=et[9],ct=et[2],ut=et[6],ht=et[10],dt=rt+at+ht;if(dt>0){const ft=.5/Math.sqrt(dt+1);this._w=.25/ft,this._x=(ut-lt)*ft,this._y=(st-ct)*ft,this._z=(ot-it)*ft}else if(rt>at&&rt>ht){const ft=2*Math.sqrt(1+rt-at-ht);this._w=(ut-lt)/ft,this._x=.25*ft,this._y=(it+ot)/ft,this._z=(st+ct)/ft}else if(at>ht){const ft=2*Math.sqrt(1+at-rt-ht);this._w=(st-ct)/ft,this._x=(it+ot)/ft,this._y=.25*ft,this._z=(lt+ut)/ft}else{const ft=2*Math.sqrt(1+ht-rt-at);this._w=(ot-it)/ft,this._x=(st+ct)/ft,this._y=(lt+ut)/ft,this._z=.25*ft}return this._onChangeCallback(),this}setFromUnitVectors(_e,et){let rt=_e.dot(et)+1;return rt<Number.EPSILON?(rt=0,Math.abs(_e.x)>Math.abs(_e.z)?(this._x=-_e.y,this._y=_e.x,this._z=0,this._w=rt):(this._x=0,this._y=-_e.z,this._z=_e.y,this._w=rt)):(this._x=_e.y*et.z-_e.z*et.y,this._y=_e.z*et.x-_e.x*et.z,this._z=_e.x*et.y-_e.y*et.x,this._w=rt),this.normalize()}angleTo(_e){return 2*Math.acos(Math.abs(clamp$5(this.dot(_e),-1,1)))}rotateTowards(_e,et){const rt=this.angleTo(_e);if(rt===0)return this;const it=Math.min(1,et/rt);return this.slerp(_e,it),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_e){return this._x*_e._x+this._y*_e._y+this._z*_e._z+this._w*_e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _e=this.length();return _e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_e=1/_e,this._x=this._x*_e,this._y=this._y*_e,this._z=this._z*_e,this._w=this._w*_e),this._onChangeCallback(),this}multiply(_e){return this.multiplyQuaternions(this,_e)}premultiply(_e){return this.multiplyQuaternions(_e,this)}multiplyQuaternions(_e,et){const rt=_e._x,it=_e._y,st=_e._z,ot=_e._w,at=et._x,lt=et._y,ct=et._z,ut=et._w;return this._x=rt*ut+ot*at+it*ct-st*lt,this._y=it*ut+ot*lt+st*at-rt*ct,this._z=st*ut+ot*ct+rt*lt-it*at,this._w=ot*ut-rt*at-it*lt-st*ct,this._onChangeCallback(),this}slerp(_e,et){if(et===0)return this;if(et===1)return this.copy(_e);const rt=this._x,it=this._y,st=this._z,ot=this._w;let at=ot*_e._w+rt*_e._x+it*_e._y+st*_e._z;if(at<0?(this._w=-_e._w,this._x=-_e._x,this._y=-_e._y,this._z=-_e._z,at=-at):this.copy(_e),at>=1)return this._w=ot,this._x=rt,this._y=it,this._z=st,this;const lt=1-at*at;if(lt<=Number.EPSILON){const ft=1-et;return this._w=ft*ot+et*this._w,this._x=ft*rt+et*this._x,this._y=ft*it+et*this._y,this._z=ft*st+et*this._z,this.normalize(),this}const ct=Math.sqrt(lt),ut=Math.atan2(ct,at),ht=Math.sin((1-et)*ut)/ct,dt=Math.sin(et*ut)/ct;return this._w=ot*ht+this._w*dt,this._x=rt*ht+this._x*dt,this._y=it*ht+this._y*dt,this._z=st*ht+this._z*dt,this._onChangeCallback(),this}slerpQuaternions(_e,et,rt){return this.copy(_e).slerp(et,rt)}random(){const _e=2*Math.PI*Math.random(),et=2*Math.PI*Math.random(),rt=Math.random(),it=Math.sqrt(1-rt),st=Math.sqrt(rt);return this.set(it*Math.sin(_e),it*Math.cos(_e),st*Math.sin(et),st*Math.cos(et))}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._w===this._w}fromArray(_e,et=0){return this._x=_e[et],this._y=_e[et+1],this._z=_e[et+2],this._w=_e[et+3],this._onChangeCallback(),this}toArray(_e=[],et=0){return _e[et]=this._x,_e[et+1]=this._y,_e[et+2]=this._z,_e[et+3]=this._w,_e}fromBufferAttribute(_e,et){return this._x=_e.getX(et),this._y=_e.getY(et),this._z=_e.getZ(et),this._w=_e.getW(et),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Vector3$1=class d0{constructor(_e=0,et=0,rt=0){d0.prototype.isVector3=!0,this.x=_e,this.y=et,this.z=rt}set(_e,et,rt){return rt===void 0&&(rt=this.z),this.x=_e,this.y=et,this.z=rt,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setComponent(_e,et){switch(_e){case 0:this.x=et;break;case 1:this.y=et;break;case 2:this.z=et;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this}addVectors(_e,et){return this.x=_e.x+et.x,this.y=_e.y+et.y,this.z=_e.z+et.z,this}addScaledVector(_e,et){return this.x+=_e.x*et,this.y+=_e.y*et,this.z+=_e.z*et,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this}subVectors(_e,et){return this.x=_e.x-et.x,this.y=_e.y-et.y,this.z=_e.z-et.z,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this}multiplyVectors(_e,et){return this.x=_e.x*et.x,this.y=_e.y*et.y,this.z=_e.z*et.z,this}applyEuler(_e){return this.applyQuaternion(_quaternion$4$1.setFromEuler(_e))}applyAxisAngle(_e,et){return this.applyQuaternion(_quaternion$4$1.setFromAxisAngle(_e,et))}applyMatrix3(_e){const et=this.x,rt=this.y,it=this.z,st=_e.elements;return this.x=st[0]*et+st[3]*rt+st[6]*it,this.y=st[1]*et+st[4]*rt+st[7]*it,this.z=st[2]*et+st[5]*rt+st[8]*it,this}applyNormalMatrix(_e){return this.applyMatrix3(_e).normalize()}applyMatrix4(_e){const et=this.x,rt=this.y,it=this.z,st=_e.elements,ot=1/(st[3]*et+st[7]*rt+st[11]*it+st[15]);return this.x=(st[0]*et+st[4]*rt+st[8]*it+st[12])*ot,this.y=(st[1]*et+st[5]*rt+st[9]*it+st[13])*ot,this.z=(st[2]*et+st[6]*rt+st[10]*it+st[14])*ot,this}applyQuaternion(_e){const et=this.x,rt=this.y,it=this.z,st=_e.x,ot=_e.y,at=_e.z,lt=_e.w,ct=2*(ot*it-at*rt),ut=2*(at*et-st*it),ht=2*(st*rt-ot*et);return this.x=et+lt*ct+ot*ht-at*ut,this.y=rt+lt*ut+at*ct-st*ht,this.z=it+lt*ht+st*ut-ot*ct,this}project(_e){return this.applyMatrix4(_e.matrixWorldInverse).applyMatrix4(_e.projectionMatrix)}unproject(_e){return this.applyMatrix4(_e.projectionMatrixInverse).applyMatrix4(_e.matrixWorld)}transformDirection(_e){const et=this.x,rt=this.y,it=this.z,st=_e.elements;return this.x=st[0]*et+st[4]*rt+st[8]*it,this.y=st[1]*et+st[5]*rt+st[9]*it,this.z=st[2]*et+st[6]*rt+st[10]*it,this.normalize()}divide(_e){return this.x/=_e.x,this.y/=_e.y,this.z/=_e.z,this}divideScalar(_e){return this.multiplyScalar(1/_e)}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this}clamp(_e,et){return this.x=Math.max(_e.x,Math.min(et.x,this.x)),this.y=Math.max(_e.y,Math.min(et.y,this.y)),this.z=Math.max(_e.z,Math.min(et.z,this.z)),this}clampScalar(_e,et){return this.x=Math.max(_e,Math.min(et,this.x)),this.y=Math.max(_e,Math.min(et,this.y)),this.z=Math.max(_e,Math.min(et,this.z)),this}clampLength(_e,et){const rt=this.length();return this.divideScalar(rt||1).multiplyScalar(Math.max(_e,Math.min(et,rt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,et){return this.x+=(_e.x-this.x)*et,this.y+=(_e.y-this.y)*et,this.z+=(_e.z-this.z)*et,this}lerpVectors(_e,et,rt){return this.x=_e.x+(et.x-_e.x)*rt,this.y=_e.y+(et.y-_e.y)*rt,this.z=_e.z+(et.z-_e.z)*rt,this}cross(_e){return this.crossVectors(this,_e)}crossVectors(_e,et){const rt=_e.x,it=_e.y,st=_e.z,ot=et.x,at=et.y,lt=et.z;return this.x=it*lt-st*at,this.y=st*ot-rt*lt,this.z=rt*at-it*ot,this}projectOnVector(_e){const et=_e.lengthSq();if(et===0)return this.set(0,0,0);const rt=_e.dot(this)/et;return this.copy(_e).multiplyScalar(rt)}projectOnPlane(_e){return _vector$c$1.copy(this).projectOnVector(_e),this.sub(_vector$c$1)}reflect(_e){return this.sub(_vector$c$1.copy(_e).multiplyScalar(2*this.dot(_e)))}angleTo(_e){const et=Math.sqrt(this.lengthSq()*_e.lengthSq());if(et===0)return Math.PI/2;const rt=this.dot(_e)/et;return Math.acos(clamp$5(rt,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const et=this.x-_e.x,rt=this.y-_e.y,it=this.z-_e.z;return et*et+rt*rt+it*it}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)+Math.abs(this.z-_e.z)}setFromSpherical(_e){return this.setFromSphericalCoords(_e.radius,_e.phi,_e.theta)}setFromSphericalCoords(_e,et,rt){const it=Math.sin(et)*_e;return this.x=it*Math.sin(rt),this.y=Math.cos(et)*_e,this.z=it*Math.cos(rt),this}setFromCylindrical(_e){return this.setFromCylindricalCoords(_e.radius,_e.theta,_e.y)}setFromCylindricalCoords(_e,et,rt){return this.x=_e*Math.sin(et),this.y=rt,this.z=_e*Math.cos(et),this}setFromMatrixPosition(_e){const et=_e.elements;return this.x=et[12],this.y=et[13],this.z=et[14],this}setFromMatrixScale(_e){const et=this.setFromMatrixColumn(_e,0).length(),rt=this.setFromMatrixColumn(_e,1).length(),it=this.setFromMatrixColumn(_e,2).length();return this.x=et,this.y=rt,this.z=it,this}setFromMatrixColumn(_e,et){return this.fromArray(_e.elements,et*4)}setFromMatrix3Column(_e,et){return this.fromArray(_e.elements,et*3)}setFromEuler(_e){return this.x=_e._x,this.y=_e._y,this.z=_e._z,this}setFromColor(_e){return this.x=_e.r,this.y=_e.g,this.z=_e.b,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z}fromArray(_e,et=0){return this.x=_e[et],this.y=_e[et+1],this.z=_e[et+2],this}toArray(_e=[],et=0){return _e[et]=this.x,_e[et+1]=this.y,_e[et+2]=this.z,_e}fromBufferAttribute(_e,et){return this.x=_e.getX(et),this.y=_e.getY(et),this.z=_e.getZ(et),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _e=Math.random()*Math.PI*2,et=Math.random()*2-1,rt=Math.sqrt(1-et*et);return this.x=rt*Math.cos(_e),this.y=et,this.z=rt*Math.sin(_e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const _vector$c$1=new Vector3$1,_quaternion$4$1=new Quaternion$1;let Box3$1=class{constructor(_e=new Vector3$1(1/0,1/0,1/0),et=new Vector3$1(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_e,this.max=et}set(_e,et){return this.min.copy(_e),this.max.copy(et),this}setFromArray(_e){this.makeEmpty();for(let et=0,rt=_e.length;et<rt;et+=3)this.expandByPoint(_vector$b$1.fromArray(_e,et));return this}setFromBufferAttribute(_e){this.makeEmpty();for(let et=0,rt=_e.count;et<rt;et++)this.expandByPoint(_vector$b$1.fromBufferAttribute(_e,et));return this}setFromPoints(_e){this.makeEmpty();for(let et=0,rt=_e.length;et<rt;et++)this.expandByPoint(_e[et]);return this}setFromCenterAndSize(_e,et){const rt=_vector$b$1.copy(et).multiplyScalar(.5);return this.min.copy(_e).sub(rt),this.max.copy(_e).add(rt),this}setFromObject(_e,et=!1){return this.makeEmpty(),this.expandByObject(_e,et)}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_e){return this.isEmpty()?_e.set(0,0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}expandByObject(_e,et=!1){_e.updateWorldMatrix(!1,!1);const rt=_e.geometry;if(rt!==void 0){const st=rt.getAttribute("position");if(et===!0&&st!==void 0&&_e.isInstancedMesh!==!0)for(let ot=0,at=st.count;ot<at;ot++)_e.isMesh===!0?_e.getVertexPosition(ot,_vector$b$1):_vector$b$1.fromBufferAttribute(st,ot),_vector$b$1.applyMatrix4(_e.matrixWorld),this.expandByPoint(_vector$b$1);else _e.boundingBox!==void 0?(_e.boundingBox===null&&_e.computeBoundingBox(),_box$4$1.copy(_e.boundingBox)):(rt.boundingBox===null&&rt.computeBoundingBox(),_box$4$1.copy(rt.boundingBox)),_box$4$1.applyMatrix4(_e.matrixWorld),this.union(_box$4$1)}const it=_e.children;for(let st=0,ot=it.length;st<ot;st++)this.expandByObject(it[st],et);return this}containsPoint(_e){return _e.x>=this.min.x&&_e.x<=this.max.x&&_e.y>=this.min.y&&_e.y<=this.max.y&&_e.z>=this.min.z&&_e.z<=this.max.z}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y&&this.min.z<=_e.min.z&&_e.max.z<=this.max.z}getParameter(_e,et){return et.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y),(_e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_e){return _e.max.x>=this.min.x&&_e.min.x<=this.max.x&&_e.max.y>=this.min.y&&_e.min.y<=this.max.y&&_e.max.z>=this.min.z&&_e.min.z<=this.max.z}intersectsSphere(_e){return this.clampPoint(_e.center,_vector$b$1),_vector$b$1.distanceToSquared(_e.center)<=_e.radius*_e.radius}intersectsPlane(_e){let et,rt;return _e.normal.x>0?(et=_e.normal.x*this.min.x,rt=_e.normal.x*this.max.x):(et=_e.normal.x*this.max.x,rt=_e.normal.x*this.min.x),_e.normal.y>0?(et+=_e.normal.y*this.min.y,rt+=_e.normal.y*this.max.y):(et+=_e.normal.y*this.max.y,rt+=_e.normal.y*this.min.y),_e.normal.z>0?(et+=_e.normal.z*this.min.z,rt+=_e.normal.z*this.max.z):(et+=_e.normal.z*this.max.z,rt+=_e.normal.z*this.min.z),et<=-_e.constant&&rt>=-_e.constant}intersectsTriangle(_e){if(this.isEmpty())return!1;this.getCenter(_center$1),_extents$1.subVectors(this.max,_center$1),_v0$3.subVectors(_e.a,_center$1),_v1$7$1.subVectors(_e.b,_center$1),_v2$4$1.subVectors(_e.c,_center$1),_f0$1.subVectors(_v1$7$1,_v0$3),_f1$1.subVectors(_v2$4$1,_v1$7$1),_f2$1.subVectors(_v0$3,_v2$4$1);let et=[0,-_f0$1.z,_f0$1.y,0,-_f1$1.z,_f1$1.y,0,-_f2$1.z,_f2$1.y,_f0$1.z,0,-_f0$1.x,_f1$1.z,0,-_f1$1.x,_f2$1.z,0,-_f2$1.x,-_f0$1.y,_f0$1.x,0,-_f1$1.y,_f1$1.x,0,-_f2$1.y,_f2$1.x,0];return!satForAxes$1(et,_v0$3,_v1$7$1,_v2$4$1,_extents$1)||(et=[1,0,0,0,1,0,0,0,1],!satForAxes$1(et,_v0$3,_v1$7$1,_v2$4$1,_extents$1))?!1:(_triangleNormal$1.crossVectors(_f0$1,_f1$1),et=[_triangleNormal$1.x,_triangleNormal$1.y,_triangleNormal$1.z],satForAxes$1(et,_v0$3,_v1$7$1,_v2$4$1,_extents$1))}clampPoint(_e,et){return et.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$b$1).distanceTo(_e)}getBoundingSphere(_e){return this.isEmpty()?_e.makeEmpty():(this.getCenter(_e.center),_e.radius=this.getSize(_vector$b$1).length()*.5),_e}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}applyMatrix4(_e){return this.isEmpty()?this:(_points$2[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_e),_points$2[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_e),_points$2[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_e),_points$2[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_e),_points$2[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_e),_points$2[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_e),_points$2[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_e),_points$2[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_e),this.setFromPoints(_points$2),this)}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}};const _points$2=[new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1],_vector$b$1=new Vector3$1,_box$4$1=new Box3$1,_v0$3=new Vector3$1,_v1$7$1=new Vector3$1,_v2$4$1=new Vector3$1,_f0$1=new Vector3$1,_f1$1=new Vector3$1,_f2$1=new Vector3$1,_center$1=new Vector3$1,_extents$1=new Vector3$1,_triangleNormal$1=new Vector3$1,_testAxis$1=new Vector3$1;function satForAxes$1(nt,_e,et,rt,it){for(let st=0,ot=nt.length-3;st<=ot;st+=3){_testAxis$1.fromArray(nt,st);const at=it.x*Math.abs(_testAxis$1.x)+it.y*Math.abs(_testAxis$1.y)+it.z*Math.abs(_testAxis$1.z),lt=_e.dot(_testAxis$1),ct=et.dot(_testAxis$1),ut=rt.dot(_testAxis$1);if(Math.max(-Math.max(lt,ct,ut),Math.min(lt,ct,ut))>at)return!1}return!0}const _box$3$1=new Box3$1,_v1$6$1=new Vector3$1,_v2$3$1=new Vector3$1;let Sphere$1=class{constructor(_e=new Vector3$1,et=-1){this.isSphere=!0,this.center=_e,this.radius=et}set(_e,et){return this.center.copy(_e),this.radius=et,this}setFromPoints(_e,et){const rt=this.center;et!==void 0?rt.copy(et):_box$3$1.setFromPoints(_e).getCenter(rt);let it=0;for(let st=0,ot=_e.length;st<ot;st++)it=Math.max(it,rt.distanceToSquared(_e[st]));return this.radius=Math.sqrt(it),this}copy(_e){return this.center.copy(_e.center),this.radius=_e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_e){return _e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_e){return _e.distanceTo(this.center)-this.radius}intersectsSphere(_e){const et=this.radius+_e.radius;return _e.center.distanceToSquared(this.center)<=et*et}intersectsBox(_e){return _e.intersectsSphere(this)}intersectsPlane(_e){return Math.abs(_e.distanceToPoint(this.center))<=this.radius}clampPoint(_e,et){const rt=this.center.distanceToSquared(_e);return et.copy(_e),rt>this.radius*this.radius&&(et.sub(this.center).normalize(),et.multiplyScalar(this.radius).add(this.center)),et}getBoundingBox(_e){return this.isEmpty()?(_e.makeEmpty(),_e):(_e.set(this.center,this.center),_e.expandByScalar(this.radius),_e)}applyMatrix4(_e){return this.center.applyMatrix4(_e),this.radius=this.radius*_e.getMaxScaleOnAxis(),this}translate(_e){return this.center.add(_e),this}expandByPoint(_e){if(this.isEmpty())return this.center.copy(_e),this.radius=0,this;_v1$6$1.subVectors(_e,this.center);const et=_v1$6$1.lengthSq();if(et>this.radius*this.radius){const rt=Math.sqrt(et),it=(rt-this.radius)*.5;this.center.addScaledVector(_v1$6$1,it/rt),this.radius+=it}return this}union(_e){return _e.isEmpty()?this:this.isEmpty()?(this.copy(_e),this):(this.center.equals(_e.center)===!0?this.radius=Math.max(this.radius,_e.radius):(_v2$3$1.subVectors(_e.center,this.center).setLength(_e.radius),this.expandByPoint(_v1$6$1.copy(_e.center).add(_v2$3$1)),this.expandByPoint(_v1$6$1.copy(_e.center).sub(_v2$3$1))),this)}equals(_e){return _e.center.equals(this.center)&&_e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const _vector$a$1=new Vector3$1,_segCenter$1=new Vector3$1,_segDir$1=new Vector3$1,_diff$1=new Vector3$1,_edge1$1=new Vector3$1,_edge2$1=new Vector3$1,_normal$1=new Vector3$1;let Ray$1=class{constructor(_e=new Vector3$1,et=new Vector3$1(0,0,-1)){this.origin=_e,this.direction=et}set(_e,et){return this.origin.copy(_e),this.direction.copy(et),this}copy(_e){return this.origin.copy(_e.origin),this.direction.copy(_e.direction),this}at(_e,et){return et.copy(this.origin).addScaledVector(this.direction,_e)}lookAt(_e){return this.direction.copy(_e).sub(this.origin).normalize(),this}recast(_e){return this.origin.copy(this.at(_e,_vector$a$1)),this}closestPointToPoint(_e,et){et.subVectors(_e,this.origin);const rt=et.dot(this.direction);return rt<0?et.copy(this.origin):et.copy(this.origin).addScaledVector(this.direction,rt)}distanceToPoint(_e){return Math.sqrt(this.distanceSqToPoint(_e))}distanceSqToPoint(_e){const et=_vector$a$1.subVectors(_e,this.origin).dot(this.direction);return et<0?this.origin.distanceToSquared(_e):(_vector$a$1.copy(this.origin).addScaledVector(this.direction,et),_vector$a$1.distanceToSquared(_e))}distanceSqToSegment(_e,et,rt,it){_segCenter$1.copy(_e).add(et).multiplyScalar(.5),_segDir$1.copy(et).sub(_e).normalize(),_diff$1.copy(this.origin).sub(_segCenter$1);const st=_e.distanceTo(et)*.5,ot=-this.direction.dot(_segDir$1),at=_diff$1.dot(this.direction),lt=-_diff$1.dot(_segDir$1),ct=_diff$1.lengthSq(),ut=Math.abs(1-ot*ot);let ht,dt,ft,pt;if(ut>0)if(ht=ot*lt-at,dt=ot*at-lt,pt=st*ut,ht>=0)if(dt>=-pt)if(dt<=pt){const mt=1/ut;ht*=mt,dt*=mt,ft=ht*(ht+ot*dt+2*at)+dt*(ot*ht+dt+2*lt)+ct}else dt=st,ht=Math.max(0,-(ot*dt+at)),ft=-ht*ht+dt*(dt+2*lt)+ct;else dt=-st,ht=Math.max(0,-(ot*dt+at)),ft=-ht*ht+dt*(dt+2*lt)+ct;else dt<=-pt?(ht=Math.max(0,-(-ot*st+at)),dt=ht>0?-st:Math.min(Math.max(-st,-lt),st),ft=-ht*ht+dt*(dt+2*lt)+ct):dt<=pt?(ht=0,dt=Math.min(Math.max(-st,-lt),st),ft=dt*(dt+2*lt)+ct):(ht=Math.max(0,-(ot*st+at)),dt=ht>0?st:Math.min(Math.max(-st,-lt),st),ft=-ht*ht+dt*(dt+2*lt)+ct);else dt=ot>0?-st:st,ht=Math.max(0,-(ot*dt+at)),ft=-ht*ht+dt*(dt+2*lt)+ct;return rt&&rt.copy(this.origin).addScaledVector(this.direction,ht),it&&it.copy(_segCenter$1).addScaledVector(_segDir$1,dt),ft}intersectSphere(_e,et){_vector$a$1.subVectors(_e.center,this.origin);const rt=_vector$a$1.dot(this.direction),it=_vector$a$1.dot(_vector$a$1)-rt*rt,st=_e.radius*_e.radius;if(it>st)return null;const ot=Math.sqrt(st-it),at=rt-ot,lt=rt+ot;return lt<0?null:at<0?this.at(lt,et):this.at(at,et)}intersectsSphere(_e){return this.distanceSqToPoint(_e.center)<=_e.radius*_e.radius}distanceToPlane(_e){const et=_e.normal.dot(this.direction);if(et===0)return _e.distanceToPoint(this.origin)===0?0:null;const rt=-(this.origin.dot(_e.normal)+_e.constant)/et;return rt>=0?rt:null}intersectPlane(_e,et){const rt=this.distanceToPlane(_e);return rt===null?null:this.at(rt,et)}intersectsPlane(_e){const et=_e.distanceToPoint(this.origin);return et===0||_e.normal.dot(this.direction)*et<0}intersectBox(_e,et){let rt,it,st,ot,at,lt;const ct=1/this.direction.x,ut=1/this.direction.y,ht=1/this.direction.z,dt=this.origin;return ct>=0?(rt=(_e.min.x-dt.x)*ct,it=(_e.max.x-dt.x)*ct):(rt=(_e.max.x-dt.x)*ct,it=(_e.min.x-dt.x)*ct),ut>=0?(st=(_e.min.y-dt.y)*ut,ot=(_e.max.y-dt.y)*ut):(st=(_e.max.y-dt.y)*ut,ot=(_e.min.y-dt.y)*ut),rt>ot||st>it||((st>rt||isNaN(rt))&&(rt=st),(ot<it||isNaN(it))&&(it=ot),ht>=0?(at=(_e.min.z-dt.z)*ht,lt=(_e.max.z-dt.z)*ht):(at=(_e.max.z-dt.z)*ht,lt=(_e.min.z-dt.z)*ht),rt>lt||at>it)||((at>rt||rt!==rt)&&(rt=at),(lt<it||it!==it)&&(it=lt),it<0)?null:this.at(rt>=0?rt:it,et)}intersectsBox(_e){return this.intersectBox(_e,_vector$a$1)!==null}intersectTriangle(_e,et,rt,it,st){_edge1$1.subVectors(et,_e),_edge2$1.subVectors(rt,_e),_normal$1.crossVectors(_edge1$1,_edge2$1);let ot=this.direction.dot(_normal$1),at;if(ot>0){if(it)return null;at=1}else if(ot<0)at=-1,ot=-ot;else return null;_diff$1.subVectors(this.origin,_e);const lt=at*this.direction.dot(_edge2$1.crossVectors(_diff$1,_edge2$1));if(lt<0)return null;const ct=at*this.direction.dot(_edge1$1.cross(_diff$1));if(ct<0||lt+ct>ot)return null;const ut=-at*_diff$1.dot(_normal$1);return ut<0?null:this.at(ut/ot,st)}applyMatrix4(_e){return this.origin.applyMatrix4(_e),this.direction.transformDirection(_e),this}equals(_e){return _e.origin.equals(this.origin)&&_e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Matrix4$1=class Um{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At){Um.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e!==void 0&&this.set(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At)}set(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At){const gt=this.elements;return gt[0]=_e,gt[4]=et,gt[8]=rt,gt[12]=it,gt[1]=st,gt[5]=ot,gt[9]=at,gt[13]=lt,gt[2]=ct,gt[6]=ut,gt[10]=ht,gt[14]=dt,gt[3]=ft,gt[7]=pt,gt[11]=mt,gt[15]=At,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Um().fromArray(this.elements)}copy(_e){const et=this.elements,rt=_e.elements;return et[0]=rt[0],et[1]=rt[1],et[2]=rt[2],et[3]=rt[3],et[4]=rt[4],et[5]=rt[5],et[6]=rt[6],et[7]=rt[7],et[8]=rt[8],et[9]=rt[9],et[10]=rt[10],et[11]=rt[11],et[12]=rt[12],et[13]=rt[13],et[14]=rt[14],et[15]=rt[15],this}copyPosition(_e){const et=this.elements,rt=_e.elements;return et[12]=rt[12],et[13]=rt[13],et[14]=rt[14],this}setFromMatrix3(_e){const et=_e.elements;return this.set(et[0],et[3],et[6],0,et[1],et[4],et[7],0,et[2],et[5],et[8],0,0,0,0,1),this}extractBasis(_e,et,rt){return _e.setFromMatrixColumn(this,0),et.setFromMatrixColumn(this,1),rt.setFromMatrixColumn(this,2),this}makeBasis(_e,et,rt){return this.set(_e.x,et.x,rt.x,0,_e.y,et.y,rt.y,0,_e.z,et.z,rt.z,0,0,0,0,1),this}extractRotation(_e){const et=this.elements,rt=_e.elements,it=1/_v1$5$1.setFromMatrixColumn(_e,0).length(),st=1/_v1$5$1.setFromMatrixColumn(_e,1).length(),ot=1/_v1$5$1.setFromMatrixColumn(_e,2).length();return et[0]=rt[0]*it,et[1]=rt[1]*it,et[2]=rt[2]*it,et[3]=0,et[4]=rt[4]*st,et[5]=rt[5]*st,et[6]=rt[6]*st,et[7]=0,et[8]=rt[8]*ot,et[9]=rt[9]*ot,et[10]=rt[10]*ot,et[11]=0,et[12]=0,et[13]=0,et[14]=0,et[15]=1,this}makeRotationFromEuler(_e){const et=this.elements,rt=_e.x,it=_e.y,st=_e.z,ot=Math.cos(rt),at=Math.sin(rt),lt=Math.cos(it),ct=Math.sin(it),ut=Math.cos(st),ht=Math.sin(st);if(_e.order==="XYZ"){const dt=ot*ut,ft=ot*ht,pt=at*ut,mt=at*ht;et[0]=lt*ut,et[4]=-lt*ht,et[8]=ct,et[1]=ft+pt*ct,et[5]=dt-mt*ct,et[9]=-at*lt,et[2]=mt-dt*ct,et[6]=pt+ft*ct,et[10]=ot*lt}else if(_e.order==="YXZ"){const dt=lt*ut,ft=lt*ht,pt=ct*ut,mt=ct*ht;et[0]=dt+mt*at,et[4]=pt*at-ft,et[8]=ot*ct,et[1]=ot*ht,et[5]=ot*ut,et[9]=-at,et[2]=ft*at-pt,et[6]=mt+dt*at,et[10]=ot*lt}else if(_e.order==="ZXY"){const dt=lt*ut,ft=lt*ht,pt=ct*ut,mt=ct*ht;et[0]=dt-mt*at,et[4]=-ot*ht,et[8]=pt+ft*at,et[1]=ft+pt*at,et[5]=ot*ut,et[9]=mt-dt*at,et[2]=-ot*ct,et[6]=at,et[10]=ot*lt}else if(_e.order==="ZYX"){const dt=ot*ut,ft=ot*ht,pt=at*ut,mt=at*ht;et[0]=lt*ut,et[4]=pt*ct-ft,et[8]=dt*ct+mt,et[1]=lt*ht,et[5]=mt*ct+dt,et[9]=ft*ct-pt,et[2]=-ct,et[6]=at*lt,et[10]=ot*lt}else if(_e.order==="YZX"){const dt=ot*lt,ft=ot*ct,pt=at*lt,mt=at*ct;et[0]=lt*ut,et[4]=mt-dt*ht,et[8]=pt*ht+ft,et[1]=ht,et[5]=ot*ut,et[9]=-at*ut,et[2]=-ct*ut,et[6]=ft*ht+pt,et[10]=dt-mt*ht}else if(_e.order==="XZY"){const dt=ot*lt,ft=ot*ct,pt=at*lt,mt=at*ct;et[0]=lt*ut,et[4]=-ht,et[8]=ct*ut,et[1]=dt*ht+mt,et[5]=ot*ut,et[9]=ft*ht-pt,et[2]=pt*ht-ft,et[6]=at*ut,et[10]=mt*ht+dt}return et[3]=0,et[7]=0,et[11]=0,et[12]=0,et[13]=0,et[14]=0,et[15]=1,this}makeRotationFromQuaternion(_e){return this.compose(_zero$1,_e,_one$1)}lookAt(_e,et,rt){const it=this.elements;return _z$1.subVectors(_e,et),_z$1.lengthSq()===0&&(_z$1.z=1),_z$1.normalize(),_x$1.crossVectors(rt,_z$1),_x$1.lengthSq()===0&&(Math.abs(rt.z)===1?_z$1.x+=1e-4:_z$1.z+=1e-4,_z$1.normalize(),_x$1.crossVectors(rt,_z$1)),_x$1.normalize(),_y$1.crossVectors(_z$1,_x$1),it[0]=_x$1.x,it[4]=_y$1.x,it[8]=_z$1.x,it[1]=_x$1.y,it[5]=_y$1.y,it[9]=_z$1.y,it[2]=_x$1.z,it[6]=_y$1.z,it[10]=_z$1.z,this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,et){const rt=_e.elements,it=et.elements,st=this.elements,ot=rt[0],at=rt[4],lt=rt[8],ct=rt[12],ut=rt[1],ht=rt[5],dt=rt[9],ft=rt[13],pt=rt[2],mt=rt[6],At=rt[10],gt=rt[14],bt=rt[3],Tt=rt[7],wt=rt[11],Rt=rt[15],It=it[0],Lt=it[4],$t=it[8],kt=it[12],Dt=it[1],Ot=it[5],zt=it[9],Ht=it[13],Yt=it[2],Xt=it[6],Zt=it[10],rn=it[14],Gt=it[3],jt=it[7],Kt=it[11],Jt=it[15];return st[0]=ot*It+at*Dt+lt*Yt+ct*Gt,st[4]=ot*Lt+at*Ot+lt*Xt+ct*jt,st[8]=ot*$t+at*zt+lt*Zt+ct*Kt,st[12]=ot*kt+at*Ht+lt*rn+ct*Jt,st[1]=ut*It+ht*Dt+dt*Yt+ft*Gt,st[5]=ut*Lt+ht*Ot+dt*Xt+ft*jt,st[9]=ut*$t+ht*zt+dt*Zt+ft*Kt,st[13]=ut*kt+ht*Ht+dt*rn+ft*Jt,st[2]=pt*It+mt*Dt+At*Yt+gt*Gt,st[6]=pt*Lt+mt*Ot+At*Xt+gt*jt,st[10]=pt*$t+mt*zt+At*Zt+gt*Kt,st[14]=pt*kt+mt*Ht+At*rn+gt*Jt,st[3]=bt*It+Tt*Dt+wt*Yt+Rt*Gt,st[7]=bt*Lt+Tt*Ot+wt*Xt+Rt*jt,st[11]=bt*$t+Tt*zt+wt*Zt+Rt*Kt,st[15]=bt*kt+Tt*Ht+wt*rn+Rt*Jt,this}multiplyScalar(_e){const et=this.elements;return et[0]*=_e,et[4]*=_e,et[8]*=_e,et[12]*=_e,et[1]*=_e,et[5]*=_e,et[9]*=_e,et[13]*=_e,et[2]*=_e,et[6]*=_e,et[10]*=_e,et[14]*=_e,et[3]*=_e,et[7]*=_e,et[11]*=_e,et[15]*=_e,this}determinant(){const _e=this.elements,et=_e[0],rt=_e[4],it=_e[8],st=_e[12],ot=_e[1],at=_e[5],lt=_e[9],ct=_e[13],ut=_e[2],ht=_e[6],dt=_e[10],ft=_e[14],pt=_e[3],mt=_e[7],At=_e[11],gt=_e[15];return pt*(+st*lt*ht-it*ct*ht-st*at*dt+rt*ct*dt+it*at*ft-rt*lt*ft)+mt*(+et*lt*ft-et*ct*dt+st*ot*dt-it*ot*ft+it*ct*ut-st*lt*ut)+At*(+et*ct*ht-et*at*ft-st*ot*ht+rt*ot*ft+st*at*ut-rt*ct*ut)+gt*(-it*at*ut-et*lt*ht+et*at*dt+it*ot*ht-rt*ot*dt+rt*lt*ut)}transpose(){const _e=this.elements;let et;return et=_e[1],_e[1]=_e[4],_e[4]=et,et=_e[2],_e[2]=_e[8],_e[8]=et,et=_e[6],_e[6]=_e[9],_e[9]=et,et=_e[3],_e[3]=_e[12],_e[12]=et,et=_e[7],_e[7]=_e[13],_e[13]=et,et=_e[11],_e[11]=_e[14],_e[14]=et,this}setPosition(_e,et,rt){const it=this.elements;return _e.isVector3?(it[12]=_e.x,it[13]=_e.y,it[14]=_e.z):(it[12]=_e,it[13]=et,it[14]=rt),this}invert(){const _e=this.elements,et=_e[0],rt=_e[1],it=_e[2],st=_e[3],ot=_e[4],at=_e[5],lt=_e[6],ct=_e[7],ut=_e[8],ht=_e[9],dt=_e[10],ft=_e[11],pt=_e[12],mt=_e[13],At=_e[14],gt=_e[15],bt=ht*At*ct-mt*dt*ct+mt*lt*ft-at*At*ft-ht*lt*gt+at*dt*gt,Tt=pt*dt*ct-ut*At*ct-pt*lt*ft+ot*At*ft+ut*lt*gt-ot*dt*gt,wt=ut*mt*ct-pt*ht*ct+pt*at*ft-ot*mt*ft-ut*at*gt+ot*ht*gt,Rt=pt*ht*lt-ut*mt*lt-pt*at*dt+ot*mt*dt+ut*at*At-ot*ht*At,It=et*bt+rt*Tt+it*wt+st*Rt;if(It===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Lt=1/It;return _e[0]=bt*Lt,_e[1]=(mt*dt*st-ht*At*st-mt*it*ft+rt*At*ft+ht*it*gt-rt*dt*gt)*Lt,_e[2]=(at*At*st-mt*lt*st+mt*it*ct-rt*At*ct-at*it*gt+rt*lt*gt)*Lt,_e[3]=(ht*lt*st-at*dt*st-ht*it*ct+rt*dt*ct+at*it*ft-rt*lt*ft)*Lt,_e[4]=Tt*Lt,_e[5]=(ut*At*st-pt*dt*st+pt*it*ft-et*At*ft-ut*it*gt+et*dt*gt)*Lt,_e[6]=(pt*lt*st-ot*At*st-pt*it*ct+et*At*ct+ot*it*gt-et*lt*gt)*Lt,_e[7]=(ot*dt*st-ut*lt*st+ut*it*ct-et*dt*ct-ot*it*ft+et*lt*ft)*Lt,_e[8]=wt*Lt,_e[9]=(pt*ht*st-ut*mt*st-pt*rt*ft+et*mt*ft+ut*rt*gt-et*ht*gt)*Lt,_e[10]=(ot*mt*st-pt*at*st+pt*rt*ct-et*mt*ct-ot*rt*gt+et*at*gt)*Lt,_e[11]=(ut*at*st-ot*ht*st-ut*rt*ct+et*ht*ct+ot*rt*ft-et*at*ft)*Lt,_e[12]=Rt*Lt,_e[13]=(ut*mt*it-pt*ht*it+pt*rt*dt-et*mt*dt-ut*rt*At+et*ht*At)*Lt,_e[14]=(pt*at*it-ot*mt*it-pt*rt*lt+et*mt*lt+ot*rt*At-et*at*At)*Lt,_e[15]=(ot*ht*it-ut*at*it+ut*rt*lt-et*ht*lt-ot*rt*dt+et*at*dt)*Lt,this}scale(_e){const et=this.elements,rt=_e.x,it=_e.y,st=_e.z;return et[0]*=rt,et[4]*=it,et[8]*=st,et[1]*=rt,et[5]*=it,et[9]*=st,et[2]*=rt,et[6]*=it,et[10]*=st,et[3]*=rt,et[7]*=it,et[11]*=st,this}getMaxScaleOnAxis(){const _e=this.elements,et=_e[0]*_e[0]+_e[1]*_e[1]+_e[2]*_e[2],rt=_e[4]*_e[4]+_e[5]*_e[5]+_e[6]*_e[6],it=_e[8]*_e[8]+_e[9]*_e[9]+_e[10]*_e[10];return Math.sqrt(Math.max(et,rt,it))}makeTranslation(_e,et,rt){return _e.isVector3?this.set(1,0,0,_e.x,0,1,0,_e.y,0,0,1,_e.z,0,0,0,1):this.set(1,0,0,_e,0,1,0,et,0,0,1,rt,0,0,0,1),this}makeRotationX(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(1,0,0,0,0,et,-rt,0,0,rt,et,0,0,0,0,1),this}makeRotationY(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(et,0,rt,0,0,1,0,0,-rt,0,et,0,0,0,0,1),this}makeRotationZ(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(et,-rt,0,0,rt,et,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_e,et){const rt=Math.cos(et),it=Math.sin(et),st=1-rt,ot=_e.x,at=_e.y,lt=_e.z,ct=st*ot,ut=st*at;return this.set(ct*ot+rt,ct*at-it*lt,ct*lt+it*at,0,ct*at+it*lt,ut*at+rt,ut*lt-it*ot,0,ct*lt-it*at,ut*lt+it*ot,st*lt*lt+rt,0,0,0,0,1),this}makeScale(_e,et,rt){return this.set(_e,0,0,0,0,et,0,0,0,0,rt,0,0,0,0,1),this}makeShear(_e,et,rt,it,st,ot){return this.set(1,rt,st,0,_e,1,ot,0,et,it,1,0,0,0,0,1),this}compose(_e,et,rt){const it=this.elements,st=et._x,ot=et._y,at=et._z,lt=et._w,ct=st+st,ut=ot+ot,ht=at+at,dt=st*ct,ft=st*ut,pt=st*ht,mt=ot*ut,At=ot*ht,gt=at*ht,bt=lt*ct,Tt=lt*ut,wt=lt*ht,Rt=rt.x,It=rt.y,Lt=rt.z;return it[0]=(1-(mt+gt))*Rt,it[1]=(ft+wt)*Rt,it[2]=(pt-Tt)*Rt,it[3]=0,it[4]=(ft-wt)*It,it[5]=(1-(dt+gt))*It,it[6]=(At+bt)*It,it[7]=0,it[8]=(pt+Tt)*Lt,it[9]=(At-bt)*Lt,it[10]=(1-(dt+mt))*Lt,it[11]=0,it[12]=_e.x,it[13]=_e.y,it[14]=_e.z,it[15]=1,this}decompose(_e,et,rt){const it=this.elements;let st=_v1$5$1.set(it[0],it[1],it[2]).length();const ot=_v1$5$1.set(it[4],it[5],it[6]).length(),at=_v1$5$1.set(it[8],it[9],it[10]).length();this.determinant()<0&&(st=-st),_e.x=it[12],_e.y=it[13],_e.z=it[14],_m1$4.copy(this);const ct=1/st,ut=1/ot,ht=1/at;return _m1$4.elements[0]*=ct,_m1$4.elements[1]*=ct,_m1$4.elements[2]*=ct,_m1$4.elements[4]*=ut,_m1$4.elements[5]*=ut,_m1$4.elements[6]*=ut,_m1$4.elements[8]*=ht,_m1$4.elements[9]*=ht,_m1$4.elements[10]*=ht,et.setFromRotationMatrix(_m1$4),rt.x=st,rt.y=ot,rt.z=at,this}makePerspective(_e,et,rt,it,st,ot,at=WebGLCoordinateSystem$1){const lt=this.elements,ct=2*st/(et-_e),ut=2*st/(rt-it),ht=(et+_e)/(et-_e),dt=(rt+it)/(rt-it);let ft,pt;if(at===WebGLCoordinateSystem$1)ft=-(ot+st)/(ot-st),pt=-2*ot*st/(ot-st);else if(at===WebGPUCoordinateSystem$1)ft=-ot/(ot-st),pt=-ot*st/(ot-st);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+at);return lt[0]=ct,lt[4]=0,lt[8]=ht,lt[12]=0,lt[1]=0,lt[5]=ut,lt[9]=dt,lt[13]=0,lt[2]=0,lt[6]=0,lt[10]=ft,lt[14]=pt,lt[3]=0,lt[7]=0,lt[11]=-1,lt[15]=0,this}makeOrthographic(_e,et,rt,it,st,ot,at=WebGLCoordinateSystem$1){const lt=this.elements,ct=1/(et-_e),ut=1/(rt-it),ht=1/(ot-st),dt=(et+_e)*ct,ft=(rt+it)*ut;let pt,mt;if(at===WebGLCoordinateSystem$1)pt=(ot+st)*ht,mt=-2*ht;else if(at===WebGPUCoordinateSystem$1)pt=st*ht,mt=-1*ht;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+at);return lt[0]=2*ct,lt[4]=0,lt[8]=0,lt[12]=-dt,lt[1]=0,lt[5]=2*ut,lt[9]=0,lt[13]=-ft,lt[2]=0,lt[6]=0,lt[10]=mt,lt[14]=-pt,lt[3]=0,lt[7]=0,lt[11]=0,lt[15]=1,this}equals(_e){const et=this.elements,rt=_e.elements;for(let it=0;it<16;it++)if(et[it]!==rt[it])return!1;return!0}fromArray(_e,et=0){for(let rt=0;rt<16;rt++)this.elements[rt]=_e[rt+et];return this}toArray(_e=[],et=0){const rt=this.elements;return _e[et]=rt[0],_e[et+1]=rt[1],_e[et+2]=rt[2],_e[et+3]=rt[3],_e[et+4]=rt[4],_e[et+5]=rt[5],_e[et+6]=rt[6],_e[et+7]=rt[7],_e[et+8]=rt[8],_e[et+9]=rt[9],_e[et+10]=rt[10],_e[et+11]=rt[11],_e[et+12]=rt[12],_e[et+13]=rt[13],_e[et+14]=rt[14],_e[et+15]=rt[15],_e}};const _v1$5$1=new Vector3$1,_m1$4=new Matrix4$1,_zero$1=new Vector3$1(0,0,0),_one$1=new Vector3$1(1,1,1),_x$1=new Vector3$1,_y$1=new Vector3$1,_z$1=new Vector3$1,_matrix$2$1=new Matrix4$1,_quaternion$3$1=new Quaternion$1;let Euler$1=class f0{constructor(_e=0,et=0,rt=0,it=f0.DEFAULT_ORDER){this.isEuler=!0,this._x=_e,this._y=et,this._z=rt,this._order=it}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get order(){return this._order}set order(_e){this._order=_e,this._onChangeCallback()}set(_e,et,rt,it=this._order){return this._x=_e,this._y=et,this._z=rt,this._order=it,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_e){return this._x=_e._x,this._y=_e._y,this._z=_e._z,this._order=_e._order,this._onChangeCallback(),this}setFromRotationMatrix(_e,et=this._order,rt=!0){const it=_e.elements,st=it[0],ot=it[4],at=it[8],lt=it[1],ct=it[5],ut=it[9],ht=it[2],dt=it[6],ft=it[10];switch(et){case"XYZ":this._y=Math.asin(clamp$5(at,-1,1)),Math.abs(at)<.9999999?(this._x=Math.atan2(-ut,ft),this._z=Math.atan2(-ot,st)):(this._x=Math.atan2(dt,ct),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$5(ut,-1,1)),Math.abs(ut)<.9999999?(this._y=Math.atan2(at,ft),this._z=Math.atan2(lt,ct)):(this._y=Math.atan2(-ht,st),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$5(dt,-1,1)),Math.abs(dt)<.9999999?(this._y=Math.atan2(-ht,ft),this._z=Math.atan2(-ot,ct)):(this._y=0,this._z=Math.atan2(lt,st));break;case"ZYX":this._y=Math.asin(-clamp$5(ht,-1,1)),Math.abs(ht)<.9999999?(this._x=Math.atan2(dt,ft),this._z=Math.atan2(lt,st)):(this._x=0,this._z=Math.atan2(-ot,ct));break;case"YZX":this._z=Math.asin(clamp$5(lt,-1,1)),Math.abs(lt)<.9999999?(this._x=Math.atan2(-ut,ct),this._y=Math.atan2(-ht,st)):(this._x=0,this._y=Math.atan2(at,ft));break;case"XZY":this._z=Math.asin(-clamp$5(ot,-1,1)),Math.abs(ot)<.9999999?(this._x=Math.atan2(dt,ct),this._y=Math.atan2(at,st)):(this._x=Math.atan2(-ut,ft),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+et)}return this._order=et,rt===!0&&this._onChangeCallback(),this}setFromQuaternion(_e,et,rt){return _matrix$2$1.makeRotationFromQuaternion(_e),this.setFromRotationMatrix(_matrix$2$1,et,rt)}setFromVector3(_e,et=this._order){return this.set(_e.x,_e.y,_e.z,et)}reorder(_e){return _quaternion$3$1.setFromEuler(this),this.setFromQuaternion(_quaternion$3$1,_e)}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._order===this._order}fromArray(_e){return this._x=_e[0],this._y=_e[1],this._z=_e[2],_e[3]!==void 0&&(this._order=_e[3]),this._onChangeCallback(),this}toArray(_e=[],et=0){return _e[et]=this._x,_e[et+1]=this._y,_e[et+2]=this._z,_e[et+3]=this._order,_e}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Euler$1.DEFAULT_ORDER="XYZ";let Layers$1=class{constructor(){this.mask=1}set(_e){this.mask=(1<<_e|0)>>>0}enable(_e){this.mask|=1<<_e|0}enableAll(){this.mask=-1}toggle(_e){this.mask^=1<<_e|0}disable(_e){this.mask&=~(1<<_e|0)}disableAll(){this.mask=0}test(_e){return(this.mask&_e.mask)!==0}isEnabled(_e){return(this.mask&(1<<_e|0))!==0}},_object3DId$1=0;const _v1$4$1=new Vector3$1,_q1$2=new Quaternion$1,_m1$3$1=new Matrix4$1,_target=new Vector3$1,_position$3$1=new Vector3$1,_scale$2$1=new Vector3$1,_quaternion$2$1=new Quaternion$1,_xAxis$1=new Vector3$1(1,0,0),_yAxis$1=new Vector3$1(0,1,0),_zAxis$1=new Vector3$1(0,0,1),_addedEvent$1={type:"added"},_removedEvent$1={type:"removed"},_childaddedEvent$1={type:"childadded",child:null},_childremovedEvent$1={type:"childremoved",child:null};let Object3D$1=class gm extends EventDispatcher$1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId$1++}),this.uuid=generateUUID$2(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=gm.DEFAULT_UP.clone();const _e=new Vector3$1,et=new Euler$1,rt=new Quaternion$1,it=new Vector3$1(1,1,1);function st(){rt.setFromEuler(et,!1)}function ot(){et.setFromQuaternion(rt,void 0,!1)}et._onChange(st),rt._onChange(ot),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_e},rotation:{configurable:!0,enumerable:!0,value:et},quaternion:{configurable:!0,enumerable:!0,value:rt},scale:{configurable:!0,enumerable:!0,value:it},modelViewMatrix:{value:new Matrix4$1},normalMatrix:{value:new Matrix3$1}}),this.matrix=new Matrix4$1,this.matrixWorld=new Matrix4$1,this.matrixAutoUpdate=gm.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=gm.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers$1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_e){return this.quaternion.premultiply(_e),this}setRotationFromAxisAngle(_e,et){this.quaternion.setFromAxisAngle(_e,et)}setRotationFromEuler(_e){this.quaternion.setFromEuler(_e,!0)}setRotationFromMatrix(_e){this.quaternion.setFromRotationMatrix(_e)}setRotationFromQuaternion(_e){this.quaternion.copy(_e)}rotateOnAxis(_e,et){return _q1$2.setFromAxisAngle(_e,et),this.quaternion.multiply(_q1$2),this}rotateOnWorldAxis(_e,et){return _q1$2.setFromAxisAngle(_e,et),this.quaternion.premultiply(_q1$2),this}rotateX(_e){return this.rotateOnAxis(_xAxis$1,_e)}rotateY(_e){return this.rotateOnAxis(_yAxis$1,_e)}rotateZ(_e){return this.rotateOnAxis(_zAxis$1,_e)}translateOnAxis(_e,et){return _v1$4$1.copy(_e).applyQuaternion(this.quaternion),this.position.add(_v1$4$1.multiplyScalar(et)),this}translateX(_e){return this.translateOnAxis(_xAxis$1,_e)}translateY(_e){return this.translateOnAxis(_yAxis$1,_e)}translateZ(_e){return this.translateOnAxis(_zAxis$1,_e)}localToWorld(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(this.matrixWorld)}worldToLocal(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(_m1$3$1.copy(this.matrixWorld).invert())}lookAt(_e,et,rt){_e.isVector3?_target.copy(_e):_target.set(_e,et,rt);const it=this.parent;this.updateWorldMatrix(!0,!1),_position$3$1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$3$1.lookAt(_position$3$1,_target,this.up):_m1$3$1.lookAt(_target,_position$3$1,this.up),this.quaternion.setFromRotationMatrix(_m1$3$1),it&&(_m1$3$1.extractRotation(it.matrixWorld),_q1$2.setFromRotationMatrix(_m1$3$1),this.quaternion.premultiply(_q1$2.invert()))}add(_e){if(arguments.length>1){for(let et=0;et<arguments.length;et++)this.add(arguments[et]);return this}return _e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_e),this):(_e&&_e.isObject3D?(_e.removeFromParent(),_e.parent=this,this.children.push(_e),_e.dispatchEvent(_addedEvent$1),_childaddedEvent$1.child=_e,this.dispatchEvent(_childaddedEvent$1),_childaddedEvent$1.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_e),this)}remove(_e){if(arguments.length>1){for(let rt=0;rt<arguments.length;rt++)this.remove(arguments[rt]);return this}const et=this.children.indexOf(_e);return et!==-1&&(_e.parent=null,this.children.splice(et,1),_e.dispatchEvent(_removedEvent$1),_childremovedEvent$1.child=_e,this.dispatchEvent(_childremovedEvent$1),_childremovedEvent$1.child=null),this}removeFromParent(){const _e=this.parent;return _e!==null&&_e.remove(this),this}clear(){return this.remove(...this.children)}attach(_e){return this.updateWorldMatrix(!0,!1),_m1$3$1.copy(this.matrixWorld).invert(),_e.parent!==null&&(_e.parent.updateWorldMatrix(!0,!1),_m1$3$1.multiply(_e.parent.matrixWorld)),_e.applyMatrix4(_m1$3$1),_e.removeFromParent(),_e.parent=this,this.children.push(_e),_e.updateWorldMatrix(!1,!0),_e.dispatchEvent(_addedEvent$1),_childaddedEvent$1.child=_e,this.dispatchEvent(_childaddedEvent$1),_childaddedEvent$1.child=null,this}getObjectById(_e){return this.getObjectByProperty("id",_e)}getObjectByName(_e){return this.getObjectByProperty("name",_e)}getObjectByProperty(_e,et){if(this[_e]===et)return this;for(let rt=0,it=this.children.length;rt<it;rt++){const ot=this.children[rt].getObjectByProperty(_e,et);if(ot!==void 0)return ot}}getObjectsByProperty(_e,et,rt=[]){this[_e]===et&&rt.push(this);const it=this.children;for(let st=0,ot=it.length;st<ot;st++)it[st].getObjectsByProperty(_e,et,rt);return rt}getWorldPosition(_e){return this.updateWorldMatrix(!0,!1),_e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3$1,_e,_scale$2$1),_e}getWorldScale(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3$1,_quaternion$2$1,_e),_e}getWorldDirection(_e){this.updateWorldMatrix(!0,!1);const et=this.matrixWorld.elements;return _e.set(et[8],et[9],et[10]).normalize()}raycast(){}traverse(_e){_e(this);const et=this.children;for(let rt=0,it=et.length;rt<it;rt++)et[rt].traverse(_e)}traverseVisible(_e){if(this.visible===!1)return;_e(this);const et=this.children;for(let rt=0,it=et.length;rt<it;rt++)et[rt].traverseVisible(_e)}traverseAncestors(_e){const et=this.parent;et!==null&&(_e(et),et.traverseAncestors(_e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_e=!0);const et=this.children;for(let rt=0,it=et.length;rt<it;rt++)et[rt].updateMatrixWorld(_e)}updateWorldMatrix(_e,et){const rt=this.parent;if(_e===!0&&rt!==null&&rt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),et===!0){const it=this.children;for(let st=0,ot=it.length;st<ot;st++)it[st].updateWorldMatrix(!1,!0)}}toJSON(_e){const et=_e===void 0||typeof _e=="string",rt={};et&&(_e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},rt.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const it={};it.uuid=this.uuid,it.type=this.type,this.name!==""&&(it.name=this.name),this.castShadow===!0&&(it.castShadow=!0),this.receiveShadow===!0&&(it.receiveShadow=!0),this.visible===!1&&(it.visible=!1),this.frustumCulled===!1&&(it.frustumCulled=!1),this.renderOrder!==0&&(it.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(it.userData=this.userData),it.layers=this.layers.mask,it.matrix=this.matrix.toArray(),it.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(it.matrixAutoUpdate=!1),this.isInstancedMesh&&(it.type="InstancedMesh",it.count=this.count,it.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(it.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(it.type="BatchedMesh",it.perObjectFrustumCulled=this.perObjectFrustumCulled,it.sortObjects=this.sortObjects,it.drawRanges=this._drawRanges,it.reservedRanges=this._reservedRanges,it.visibility=this._visibility,it.active=this._active,it.bounds=this._bounds.map(at=>({boxInitialized:at.boxInitialized,boxMin:at.box.min.toArray(),boxMax:at.box.max.toArray(),sphereInitialized:at.sphereInitialized,sphereRadius:at.sphere.radius,sphereCenter:at.sphere.center.toArray()})),it.maxInstanceCount=this._maxInstanceCount,it.maxVertexCount=this._maxVertexCount,it.maxIndexCount=this._maxIndexCount,it.geometryInitialized=this._geometryInitialized,it.geometryCount=this._geometryCount,it.matricesTexture=this._matricesTexture.toJSON(_e),this._colorsTexture!==null&&(it.colorsTexture=this._colorsTexture.toJSON(_e)),this.boundingSphere!==null&&(it.boundingSphere={center:it.boundingSphere.center.toArray(),radius:it.boundingSphere.radius}),this.boundingBox!==null&&(it.boundingBox={min:it.boundingBox.min.toArray(),max:it.boundingBox.max.toArray()}));function st(at,lt){return at[lt.uuid]===void 0&&(at[lt.uuid]=lt.toJSON(_e)),lt.uuid}if(this.isScene)this.background&&(this.background.isColor?it.background=this.background.toJSON():this.background.isTexture&&(it.background=this.background.toJSON(_e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(it.environment=this.environment.toJSON(_e).uuid);else if(this.isMesh||this.isLine||this.isPoints){it.geometry=st(_e.geometries,this.geometry);const at=this.geometry.parameters;if(at!==void 0&&at.shapes!==void 0){const lt=at.shapes;if(Array.isArray(lt))for(let ct=0,ut=lt.length;ct<ut;ct++){const ht=lt[ct];st(_e.shapes,ht)}else st(_e.shapes,lt)}}if(this.isSkinnedMesh&&(it.bindMode=this.bindMode,it.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(st(_e.skeletons,this.skeleton),it.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const at=[];for(let lt=0,ct=this.material.length;lt<ct;lt++)at.push(st(_e.materials,this.material[lt]));it.material=at}else it.material=st(_e.materials,this.material);if(this.children.length>0){it.children=[];for(let at=0;at<this.children.length;at++)it.children.push(this.children[at].toJSON(_e).object)}if(this.animations.length>0){it.animations=[];for(let at=0;at<this.animations.length;at++){const lt=this.animations[at];it.animations.push(st(_e.animations,lt))}}if(et){const at=ot(_e.geometries),lt=ot(_e.materials),ct=ot(_e.textures),ut=ot(_e.images),ht=ot(_e.shapes),dt=ot(_e.skeletons),ft=ot(_e.animations),pt=ot(_e.nodes);at.length>0&&(rt.geometries=at),lt.length>0&&(rt.materials=lt),ct.length>0&&(rt.textures=ct),ut.length>0&&(rt.images=ut),ht.length>0&&(rt.shapes=ht),dt.length>0&&(rt.skeletons=dt),ft.length>0&&(rt.animations=ft),pt.length>0&&(rt.nodes=pt)}return rt.object=it,rt;function ot(at){const lt=[];for(const ct in at){const ut=at[ct];delete ut.metadata,lt.push(ut)}return lt}}clone(_e){return new this.constructor().copy(this,_e)}copy(_e,et=!0){if(this.name=_e.name,this.up.copy(_e.up),this.position.copy(_e.position),this.rotation.order=_e.rotation.order,this.quaternion.copy(_e.quaternion),this.scale.copy(_e.scale),this.matrix.copy(_e.matrix),this.matrixWorld.copy(_e.matrixWorld),this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrixWorldAutoUpdate=_e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_e.matrixWorldNeedsUpdate,this.layers.mask=_e.layers.mask,this.visible=_e.visible,this.castShadow=_e.castShadow,this.receiveShadow=_e.receiveShadow,this.frustumCulled=_e.frustumCulled,this.renderOrder=_e.renderOrder,this.animations=_e.animations.slice(),this.userData=JSON.parse(JSON.stringify(_e.userData)),et===!0)for(let rt=0;rt<_e.children.length;rt++){const it=_e.children[rt];this.add(it.clone())}return this}};Object3D$1.DEFAULT_UP=new Vector3$1(0,1,0);Object3D$1.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D$1.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$2$1=new Vector3$1,_v1$3$1=new Vector3$1,_v2$2$1=new Vector3$1,_v3$2$1=new Vector3$1,_vab$1=new Vector3$1,_vac$1=new Vector3$1,_vbc$1=new Vector3$1,_vap$1=new Vector3$1,_vbp$1=new Vector3$1,_vcp$1=new Vector3$1,_v40$1=new Vector4$1,_v41$1=new Vector4$1,_v42$1=new Vector4$1;let Triangle$1=class ap{constructor(_e=new Vector3$1,et=new Vector3$1,rt=new Vector3$1){this.a=_e,this.b=et,this.c=rt}static getNormal(_e,et,rt,it){it.subVectors(rt,et),_v0$2$1.subVectors(_e,et),it.cross(_v0$2$1);const st=it.lengthSq();return st>0?it.multiplyScalar(1/Math.sqrt(st)):it.set(0,0,0)}static getBarycoord(_e,et,rt,it,st){_v0$2$1.subVectors(it,et),_v1$3$1.subVectors(rt,et),_v2$2$1.subVectors(_e,et);const ot=_v0$2$1.dot(_v0$2$1),at=_v0$2$1.dot(_v1$3$1),lt=_v0$2$1.dot(_v2$2$1),ct=_v1$3$1.dot(_v1$3$1),ut=_v1$3$1.dot(_v2$2$1),ht=ot*ct-at*at;if(ht===0)return st.set(0,0,0),null;const dt=1/ht,ft=(ct*lt-at*ut)*dt,pt=(ot*ut-at*lt)*dt;return st.set(1-ft-pt,pt,ft)}static containsPoint(_e,et,rt,it){return this.getBarycoord(_e,et,rt,it,_v3$2$1)===null?!1:_v3$2$1.x>=0&&_v3$2$1.y>=0&&_v3$2$1.x+_v3$2$1.y<=1}static getInterpolation(_e,et,rt,it,st,ot,at,lt){return this.getBarycoord(_e,et,rt,it,_v3$2$1)===null?(lt.x=0,lt.y=0,"z"in lt&&(lt.z=0),"w"in lt&&(lt.w=0),null):(lt.setScalar(0),lt.addScaledVector(st,_v3$2$1.x),lt.addScaledVector(ot,_v3$2$1.y),lt.addScaledVector(at,_v3$2$1.z),lt)}static getInterpolatedAttribute(_e,et,rt,it,st,ot){return _v40$1.setScalar(0),_v41$1.setScalar(0),_v42$1.setScalar(0),_v40$1.fromBufferAttribute(_e,et),_v41$1.fromBufferAttribute(_e,rt),_v42$1.fromBufferAttribute(_e,it),ot.setScalar(0),ot.addScaledVector(_v40$1,st.x),ot.addScaledVector(_v41$1,st.y),ot.addScaledVector(_v42$1,st.z),ot}static isFrontFacing(_e,et,rt,it){return _v0$2$1.subVectors(rt,et),_v1$3$1.subVectors(_e,et),_v0$2$1.cross(_v1$3$1).dot(it)<0}set(_e,et,rt){return this.a.copy(_e),this.b.copy(et),this.c.copy(rt),this}setFromPointsAndIndices(_e,et,rt,it){return this.a.copy(_e[et]),this.b.copy(_e[rt]),this.c.copy(_e[it]),this}setFromAttributeAndIndices(_e,et,rt,it){return this.a.fromBufferAttribute(_e,et),this.b.fromBufferAttribute(_e,rt),this.c.fromBufferAttribute(_e,it),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.a.copy(_e.a),this.b.copy(_e.b),this.c.copy(_e.c),this}getArea(){return _v0$2$1.subVectors(this.c,this.b),_v1$3$1.subVectors(this.a,this.b),_v0$2$1.cross(_v1$3$1).length()*.5}getMidpoint(_e){return _e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_e){return ap.getNormal(this.a,this.b,this.c,_e)}getPlane(_e){return _e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_e,et){return ap.getBarycoord(_e,this.a,this.b,this.c,et)}getInterpolation(_e,et,rt,it,st){return ap.getInterpolation(_e,this.a,this.b,this.c,et,rt,it,st)}containsPoint(_e){return ap.containsPoint(_e,this.a,this.b,this.c)}isFrontFacing(_e){return ap.isFrontFacing(this.a,this.b,this.c,_e)}intersectsBox(_e){return _e.intersectsTriangle(this)}closestPointToPoint(_e,et){const rt=this.a,it=this.b,st=this.c;let ot,at;_vab$1.subVectors(it,rt),_vac$1.subVectors(st,rt),_vap$1.subVectors(_e,rt);const lt=_vab$1.dot(_vap$1),ct=_vac$1.dot(_vap$1);if(lt<=0&&ct<=0)return et.copy(rt);_vbp$1.subVectors(_e,it);const ut=_vab$1.dot(_vbp$1),ht=_vac$1.dot(_vbp$1);if(ut>=0&&ht<=ut)return et.copy(it);const dt=lt*ht-ut*ct;if(dt<=0&&lt>=0&&ut<=0)return ot=lt/(lt-ut),et.copy(rt).addScaledVector(_vab$1,ot);_vcp$1.subVectors(_e,st);const ft=_vab$1.dot(_vcp$1),pt=_vac$1.dot(_vcp$1);if(pt>=0&&ft<=pt)return et.copy(st);const mt=ft*ct-lt*pt;if(mt<=0&&ct>=0&&pt<=0)return at=ct/(ct-pt),et.copy(rt).addScaledVector(_vac$1,at);const At=ut*pt-ft*ht;if(At<=0&&ht-ut>=0&&ft-pt>=0)return _vbc$1.subVectors(st,it),at=(ht-ut)/(ht-ut+(ft-pt)),et.copy(it).addScaledVector(_vbc$1,at);const gt=1/(At+mt+dt);return ot=mt*gt,at=dt*gt,et.copy(rt).addScaledVector(_vab$1,ot).addScaledVector(_vac$1,at)}equals(_e){return _e.a.equals(this.a)&&_e.b.equals(this.b)&&_e.c.equals(this.c)}};const _colorKeywords$1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA$1={h:0,s:0,l:0},_hslB$1={h:0,s:0,l:0};function hue2rgb$1(nt,_e,et){return et<0&&(et+=1),et>1&&(et-=1),et<1/6?nt+(_e-nt)*6*et:et<1/2?_e:et<2/3?nt+(_e-nt)*6*(2/3-et):nt}let Color$2=class{constructor(_e,et,rt){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_e,et,rt)}set(_e,et,rt){if(et===void 0&&rt===void 0){const it=_e;it&&it.isColor?this.copy(it):typeof it=="number"?this.setHex(it):typeof it=="string"&&this.setStyle(it)}else this.setRGB(_e,et,rt);return this}setScalar(_e){return this.r=_e,this.g=_e,this.b=_e,this}setHex(_e,et=SRGBColorSpace$2){return _e=Math.floor(_e),this.r=(_e>>16&255)/255,this.g=(_e>>8&255)/255,this.b=(_e&255)/255,ColorManagement$1.toWorkingColorSpace(this,et),this}setRGB(_e,et,rt,it=ColorManagement$1.workingColorSpace){return this.r=_e,this.g=et,this.b=rt,ColorManagement$1.toWorkingColorSpace(this,it),this}setHSL(_e,et,rt,it=ColorManagement$1.workingColorSpace){if(_e=euclideanModulo$1(_e,1),et=clamp$5(et,0,1),rt=clamp$5(rt,0,1),et===0)this.r=this.g=this.b=rt;else{const st=rt<=.5?rt*(1+et):rt+et-rt*et,ot=2*rt-st;this.r=hue2rgb$1(ot,st,_e+1/3),this.g=hue2rgb$1(ot,st,_e),this.b=hue2rgb$1(ot,st,_e-1/3)}return ColorManagement$1.toWorkingColorSpace(this,it),this}setStyle(_e,et=SRGBColorSpace$2){function rt(st){st!==void 0&&parseFloat(st)<1&&console.warn("THREE.Color: Alpha component of "+_e+" will be ignored.")}let it;if(it=/^(\w+)\(([^\)]*)\)/.exec(_e)){let st;const ot=it[1],at=it[2];switch(ot){case"rgb":case"rgba":if(st=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(at))return rt(st[4]),this.setRGB(Math.min(255,parseInt(st[1],10))/255,Math.min(255,parseInt(st[2],10))/255,Math.min(255,parseInt(st[3],10))/255,et);if(st=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(at))return rt(st[4]),this.setRGB(Math.min(100,parseInt(st[1],10))/100,Math.min(100,parseInt(st[2],10))/100,Math.min(100,parseInt(st[3],10))/100,et);break;case"hsl":case"hsla":if(st=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(at))return rt(st[4]),this.setHSL(parseFloat(st[1])/360,parseFloat(st[2])/100,parseFloat(st[3])/100,et);break;default:console.warn("THREE.Color: Unknown color model "+_e)}}else if(it=/^\#([A-Fa-f\d]+)$/.exec(_e)){const st=it[1],ot=st.length;if(ot===3)return this.setRGB(parseInt(st.charAt(0),16)/15,parseInt(st.charAt(1),16)/15,parseInt(st.charAt(2),16)/15,et);if(ot===6)return this.setHex(parseInt(st,16),et);console.warn("THREE.Color: Invalid hex color "+_e)}else if(_e&&_e.length>0)return this.setColorName(_e,et);return this}setColorName(_e,et=SRGBColorSpace$2){const rt=_colorKeywords$1[_e.toLowerCase()];return rt!==void 0?this.setHex(rt,et):console.warn("THREE.Color: Unknown color "+_e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_e){return this.r=_e.r,this.g=_e.g,this.b=_e.b,this}copySRGBToLinear(_e){return this.r=SRGBToLinear$1(_e.r),this.g=SRGBToLinear$1(_e.g),this.b=SRGBToLinear$1(_e.b),this}copyLinearToSRGB(_e){return this.r=LinearToSRGB$1(_e.r),this.g=LinearToSRGB$1(_e.g),this.b=LinearToSRGB$1(_e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_e=SRGBColorSpace$2){return ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),_e),Math.round(clamp$5(_color$1.r*255,0,255))*65536+Math.round(clamp$5(_color$1.g*255,0,255))*256+Math.round(clamp$5(_color$1.b*255,0,255))}getHexString(_e=SRGBColorSpace$2){return("000000"+this.getHex(_e).toString(16)).slice(-6)}getHSL(_e,et=ColorManagement$1.workingColorSpace){ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),et);const rt=_color$1.r,it=_color$1.g,st=_color$1.b,ot=Math.max(rt,it,st),at=Math.min(rt,it,st);let lt,ct;const ut=(at+ot)/2;if(at===ot)lt=0,ct=0;else{const ht=ot-at;switch(ct=ut<=.5?ht/(ot+at):ht/(2-ot-at),ot){case rt:lt=(it-st)/ht+(it<st?6:0);break;case it:lt=(st-rt)/ht+2;break;case st:lt=(rt-it)/ht+4;break}lt/=6}return _e.h=lt,_e.s=ct,_e.l=ut,_e}getRGB(_e,et=ColorManagement$1.workingColorSpace){return ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),et),_e.r=_color$1.r,_e.g=_color$1.g,_e.b=_color$1.b,_e}getStyle(_e=SRGBColorSpace$2){ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),_e);const et=_color$1.r,rt=_color$1.g,it=_color$1.b;return _e!==SRGBColorSpace$2?`color(${_e} ${et.toFixed(3)} ${rt.toFixed(3)} ${it.toFixed(3)})`:`rgb(${Math.round(et*255)},${Math.round(rt*255)},${Math.round(it*255)})`}offsetHSL(_e,et,rt){return this.getHSL(_hslA$1),this.setHSL(_hslA$1.h+_e,_hslA$1.s+et,_hslA$1.l+rt)}add(_e){return this.r+=_e.r,this.g+=_e.g,this.b+=_e.b,this}addColors(_e,et){return this.r=_e.r+et.r,this.g=_e.g+et.g,this.b=_e.b+et.b,this}addScalar(_e){return this.r+=_e,this.g+=_e,this.b+=_e,this}sub(_e){return this.r=Math.max(0,this.r-_e.r),this.g=Math.max(0,this.g-_e.g),this.b=Math.max(0,this.b-_e.b),this}multiply(_e){return this.r*=_e.r,this.g*=_e.g,this.b*=_e.b,this}multiplyScalar(_e){return this.r*=_e,this.g*=_e,this.b*=_e,this}lerp(_e,et){return this.r+=(_e.r-this.r)*et,this.g+=(_e.g-this.g)*et,this.b+=(_e.b-this.b)*et,this}lerpColors(_e,et,rt){return this.r=_e.r+(et.r-_e.r)*rt,this.g=_e.g+(et.g-_e.g)*rt,this.b=_e.b+(et.b-_e.b)*rt,this}lerpHSL(_e,et){this.getHSL(_hslA$1),_e.getHSL(_hslB$1);const rt=lerp$1(_hslA$1.h,_hslB$1.h,et),it=lerp$1(_hslA$1.s,_hslB$1.s,et),st=lerp$1(_hslA$1.l,_hslB$1.l,et);return this.setHSL(rt,it,st),this}setFromVector3(_e){return this.r=_e.x,this.g=_e.y,this.b=_e.z,this}applyMatrix3(_e){const et=this.r,rt=this.g,it=this.b,st=_e.elements;return this.r=st[0]*et+st[3]*rt+st[6]*it,this.g=st[1]*et+st[4]*rt+st[7]*it,this.b=st[2]*et+st[5]*rt+st[8]*it,this}equals(_e){return _e.r===this.r&&_e.g===this.g&&_e.b===this.b}fromArray(_e,et=0){return this.r=_e[et],this.g=_e[et+1],this.b=_e[et+2],this}toArray(_e=[],et=0){return _e[et]=this.r,_e[et+1]=this.g,_e[et+2]=this.b,_e}fromBufferAttribute(_e,et){return this.r=_e.getX(et),this.g=_e.getY(et),this.b=_e.getZ(et),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color$1=new Color$2;Color$2.NAMES=_colorKeywords$1;let _materialId$1=0,Material$1=class extends EventDispatcher$1{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId$1++}),this.uuid=generateUUID$2(),this.name="",this.type="Material",this.blending=NormalBlending$1,this.side=FrontSide$1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor$1,this.blendDst=OneMinusSrcAlphaFactor$1,this.blendEquation=AddEquation$1,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color$2(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth$1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc$1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp$1,this.stencilZFail=KeepStencilOp$1,this.stencilZPass=KeepStencilOp$1,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_e){this._alphaTest>0!=_e>0&&this.version++,this._alphaTest=_e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_e){if(_e!==void 0)for(const et in _e){const rt=_e[et];if(rt===void 0){console.warn(`THREE.Material: parameter '${et}' has value of undefined.`);continue}const it=this[et];if(it===void 0){console.warn(`THREE.Material: '${et}' is not a property of THREE.${this.type}.`);continue}it&&it.isColor?it.set(rt):it&&it.isVector3&&rt&&rt.isVector3?it.copy(rt):this[et]=rt}}toJSON(_e){const et=_e===void 0||typeof _e=="string";et&&(_e={textures:{},images:{}});const rt={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};rt.uuid=this.uuid,rt.type=this.type,this.name!==""&&(rt.name=this.name),this.color&&this.color.isColor&&(rt.color=this.color.getHex()),this.roughness!==void 0&&(rt.roughness=this.roughness),this.metalness!==void 0&&(rt.metalness=this.metalness),this.sheen!==void 0&&(rt.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(rt.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(rt.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(rt.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(rt.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(rt.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(rt.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(rt.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(rt.shininess=this.shininess),this.clearcoat!==void 0&&(rt.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(rt.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(rt.clearcoatMap=this.clearcoatMap.toJSON(_e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(rt.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(rt.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_e).uuid,rt.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(rt.dispersion=this.dispersion),this.iridescence!==void 0&&(rt.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(rt.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(rt.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(rt.iridescenceMap=this.iridescenceMap.toJSON(_e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(rt.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_e).uuid),this.anisotropy!==void 0&&(rt.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(rt.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(rt.anisotropyMap=this.anisotropyMap.toJSON(_e).uuid),this.map&&this.map.isTexture&&(rt.map=this.map.toJSON(_e).uuid),this.matcap&&this.matcap.isTexture&&(rt.matcap=this.matcap.toJSON(_e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(rt.alphaMap=this.alphaMap.toJSON(_e).uuid),this.lightMap&&this.lightMap.isTexture&&(rt.lightMap=this.lightMap.toJSON(_e).uuid,rt.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(rt.aoMap=this.aoMap.toJSON(_e).uuid,rt.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(rt.bumpMap=this.bumpMap.toJSON(_e).uuid,rt.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(rt.normalMap=this.normalMap.toJSON(_e).uuid,rt.normalMapType=this.normalMapType,rt.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(rt.displacementMap=this.displacementMap.toJSON(_e).uuid,rt.displacementScale=this.displacementScale,rt.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(rt.roughnessMap=this.roughnessMap.toJSON(_e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(rt.metalnessMap=this.metalnessMap.toJSON(_e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(rt.emissiveMap=this.emissiveMap.toJSON(_e).uuid),this.specularMap&&this.specularMap.isTexture&&(rt.specularMap=this.specularMap.toJSON(_e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(rt.specularIntensityMap=this.specularIntensityMap.toJSON(_e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(rt.specularColorMap=this.specularColorMap.toJSON(_e).uuid),this.envMap&&this.envMap.isTexture&&(rt.envMap=this.envMap.toJSON(_e).uuid,this.combine!==void 0&&(rt.combine=this.combine)),this.envMapRotation!==void 0&&(rt.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(rt.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(rt.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(rt.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(rt.gradientMap=this.gradientMap.toJSON(_e).uuid),this.transmission!==void 0&&(rt.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(rt.transmissionMap=this.transmissionMap.toJSON(_e).uuid),this.thickness!==void 0&&(rt.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(rt.thicknessMap=this.thicknessMap.toJSON(_e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(rt.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(rt.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(rt.size=this.size),this.shadowSide!==null&&(rt.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(rt.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending$1&&(rt.blending=this.blending),this.side!==FrontSide$1&&(rt.side=this.side),this.vertexColors===!0&&(rt.vertexColors=!0),this.opacity<1&&(rt.opacity=this.opacity),this.transparent===!0&&(rt.transparent=!0),this.blendSrc!==SrcAlphaFactor$1&&(rt.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor$1&&(rt.blendDst=this.blendDst),this.blendEquation!==AddEquation$1&&(rt.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(rt.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(rt.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(rt.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(rt.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(rt.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth$1&&(rt.depthFunc=this.depthFunc),this.depthTest===!1&&(rt.depthTest=this.depthTest),this.depthWrite===!1&&(rt.depthWrite=this.depthWrite),this.colorWrite===!1&&(rt.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(rt.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc$1&&(rt.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(rt.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(rt.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp$1&&(rt.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp$1&&(rt.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp$1&&(rt.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(rt.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(rt.rotation=this.rotation),this.polygonOffset===!0&&(rt.polygonOffset=!0),this.polygonOffsetFactor!==0&&(rt.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(rt.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(rt.linewidth=this.linewidth),this.dashSize!==void 0&&(rt.dashSize=this.dashSize),this.gapSize!==void 0&&(rt.gapSize=this.gapSize),this.scale!==void 0&&(rt.scale=this.scale),this.dithering===!0&&(rt.dithering=!0),this.alphaTest>0&&(rt.alphaTest=this.alphaTest),this.alphaHash===!0&&(rt.alphaHash=!0),this.alphaToCoverage===!0&&(rt.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(rt.premultipliedAlpha=!0),this.forceSinglePass===!0&&(rt.forceSinglePass=!0),this.wireframe===!0&&(rt.wireframe=!0),this.wireframeLinewidth>1&&(rt.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(rt.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(rt.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(rt.flatShading=!0),this.visible===!1&&(rt.visible=!1),this.toneMapped===!1&&(rt.toneMapped=!1),this.fog===!1&&(rt.fog=!1),Object.keys(this.userData).length>0&&(rt.userData=this.userData);function it(st){const ot=[];for(const at in st){const lt=st[at];delete lt.metadata,ot.push(lt)}return ot}if(et){const st=it(_e.textures),ot=it(_e.images);st.length>0&&(rt.textures=st),ot.length>0&&(rt.images=ot)}return rt}clone(){return new this.constructor().copy(this)}copy(_e){this.name=_e.name,this.blending=_e.blending,this.side=_e.side,this.vertexColors=_e.vertexColors,this.opacity=_e.opacity,this.transparent=_e.transparent,this.blendSrc=_e.blendSrc,this.blendDst=_e.blendDst,this.blendEquation=_e.blendEquation,this.blendSrcAlpha=_e.blendSrcAlpha,this.blendDstAlpha=_e.blendDstAlpha,this.blendEquationAlpha=_e.blendEquationAlpha,this.blendColor.copy(_e.blendColor),this.blendAlpha=_e.blendAlpha,this.depthFunc=_e.depthFunc,this.depthTest=_e.depthTest,this.depthWrite=_e.depthWrite,this.stencilWriteMask=_e.stencilWriteMask,this.stencilFunc=_e.stencilFunc,this.stencilRef=_e.stencilRef,this.stencilFuncMask=_e.stencilFuncMask,this.stencilFail=_e.stencilFail,this.stencilZFail=_e.stencilZFail,this.stencilZPass=_e.stencilZPass,this.stencilWrite=_e.stencilWrite;const et=_e.clippingPlanes;let rt=null;if(et!==null){const it=et.length;rt=new Array(it);for(let st=0;st!==it;++st)rt[st]=et[st].clone()}return this.clippingPlanes=rt,this.clipIntersection=_e.clipIntersection,this.clipShadows=_e.clipShadows,this.shadowSide=_e.shadowSide,this.colorWrite=_e.colorWrite,this.precision=_e.precision,this.polygonOffset=_e.polygonOffset,this.polygonOffsetFactor=_e.polygonOffsetFactor,this.polygonOffsetUnits=_e.polygonOffsetUnits,this.dithering=_e.dithering,this.alphaTest=_e.alphaTest,this.alphaHash=_e.alphaHash,this.alphaToCoverage=_e.alphaToCoverage,this.premultipliedAlpha=_e.premultipliedAlpha,this.forceSinglePass=_e.forceSinglePass,this.visible=_e.visible,this.toneMapped=_e.toneMapped,this.userData=JSON.parse(JSON.stringify(_e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_e){_e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},MeshBasicMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$2(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler$1,this.combine=MultiplyOperation$1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}};const _tables$1=_generateTables$1();function _generateTables$1(){const nt=new ArrayBuffer(4),_e=new Float32Array(nt),et=new Uint32Array(nt),rt=new Uint32Array(512),it=new Uint32Array(512);for(let lt=0;lt<256;++lt){const ct=lt-127;ct<-27?(rt[lt]=0,rt[lt|256]=32768,it[lt]=24,it[lt|256]=24):ct<-14?(rt[lt]=1024>>-ct-14,rt[lt|256]=1024>>-ct-14|32768,it[lt]=-ct-1,it[lt|256]=-ct-1):ct<=15?(rt[lt]=ct+15<<10,rt[lt|256]=ct+15<<10|32768,it[lt]=13,it[lt|256]=13):ct<128?(rt[lt]=31744,rt[lt|256]=64512,it[lt]=24,it[lt|256]=24):(rt[lt]=31744,rt[lt|256]=64512,it[lt]=13,it[lt|256]=13)}const st=new Uint32Array(2048),ot=new Uint32Array(64),at=new Uint32Array(64);for(let lt=1;lt<1024;++lt){let ct=lt<<13,ut=0;for(;!(ct&8388608);)ct<<=1,ut-=8388608;ct&=-8388609,ut+=947912704,st[lt]=ct|ut}for(let lt=1024;lt<2048;++lt)st[lt]=939524096+(lt-1024<<13);for(let lt=1;lt<31;++lt)ot[lt]=lt<<23;ot[31]=1199570944,ot[32]=2147483648;for(let lt=33;lt<63;++lt)ot[lt]=2147483648+(lt-32<<23);ot[63]=3347054592;for(let lt=1;lt<64;++lt)lt!==32&&(at[lt]=1024);return{floatView:_e,uint32View:et,baseTable:rt,shiftTable:it,mantissaTable:st,exponentTable:ot,offsetTable:at}}function toHalfFloat$1(nt){Math.abs(nt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),nt=clamp$5(nt,-65504,65504),_tables$1.floatView[0]=nt;const _e=_tables$1.uint32View[0],et=_e>>23&511;return _tables$1.baseTable[et]+((_e&8388607)>>_tables$1.shiftTable[et])}function fromHalfFloat$1(nt){const _e=nt>>10;return _tables$1.uint32View[0]=_tables$1.mantissaTable[_tables$1.offsetTable[_e]+(nt&1023)]+_tables$1.exponentTable[_e],_tables$1.floatView[0]}const DataUtils={toHalfFloat:toHalfFloat$1,fromHalfFloat:fromHalfFloat$1},_vector$9$1=new Vector3$1,_vector2$1$1=new Vector2$1;let BufferAttribute$1=class{constructor(_e,et,rt=!1){if(Array.isArray(_e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_e,this.itemSize=et,this.count=_e!==void 0?_e.length/et:0,this.normalized=rt,this.usage=StaticDrawUsage$1,this.updateRanges=[],this.gpuType=FloatType$1,this.version=0}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}addUpdateRange(_e,et){this.updateRanges.push({start:_e,count:et})}clearUpdateRanges(){this.updateRanges.length=0}copy(_e){return this.name=_e.name,this.array=new _e.array.constructor(_e.array),this.itemSize=_e.itemSize,this.count=_e.count,this.normalized=_e.normalized,this.usage=_e.usage,this.gpuType=_e.gpuType,this}copyAt(_e,et,rt){_e*=this.itemSize,rt*=et.itemSize;for(let it=0,st=this.itemSize;it<st;it++)this.array[_e+it]=et.array[rt+it];return this}copyArray(_e){return this.array.set(_e),this}applyMatrix3(_e){if(this.itemSize===2)for(let et=0,rt=this.count;et<rt;et++)_vector2$1$1.fromBufferAttribute(this,et),_vector2$1$1.applyMatrix3(_e),this.setXY(et,_vector2$1$1.x,_vector2$1$1.y);else if(this.itemSize===3)for(let et=0,rt=this.count;et<rt;et++)_vector$9$1.fromBufferAttribute(this,et),_vector$9$1.applyMatrix3(_e),this.setXYZ(et,_vector$9$1.x,_vector$9$1.y,_vector$9$1.z);return this}applyMatrix4(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$9$1.fromBufferAttribute(this,et),_vector$9$1.applyMatrix4(_e),this.setXYZ(et,_vector$9$1.x,_vector$9$1.y,_vector$9$1.z);return this}applyNormalMatrix(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$9$1.fromBufferAttribute(this,et),_vector$9$1.applyNormalMatrix(_e),this.setXYZ(et,_vector$9$1.x,_vector$9$1.y,_vector$9$1.z);return this}transformDirection(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$9$1.fromBufferAttribute(this,et),_vector$9$1.transformDirection(_e),this.setXYZ(et,_vector$9$1.x,_vector$9$1.y,_vector$9$1.z);return this}set(_e,et=0){return this.array.set(_e,et),this}getComponent(_e,et){let rt=this.array[_e*this.itemSize+et];return this.normalized&&(rt=denormalize$1(rt,this.array)),rt}setComponent(_e,et,rt){return this.normalized&&(rt=normalize$4(rt,this.array)),this.array[_e*this.itemSize+et]=rt,this}getX(_e){let et=this.array[_e*this.itemSize];return this.normalized&&(et=denormalize$1(et,this.array)),et}setX(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize]=et,this}getY(_e){let et=this.array[_e*this.itemSize+1];return this.normalized&&(et=denormalize$1(et,this.array)),et}setY(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize+1]=et,this}getZ(_e){let et=this.array[_e*this.itemSize+2];return this.normalized&&(et=denormalize$1(et,this.array)),et}setZ(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize+2]=et,this}getW(_e){let et=this.array[_e*this.itemSize+3];return this.normalized&&(et=denormalize$1(et,this.array)),et}setW(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize+3]=et,this}setXY(_e,et,rt){return _e*=this.itemSize,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array)),this.array[_e+0]=et,this.array[_e+1]=rt,this}setXYZ(_e,et,rt,it){return _e*=this.itemSize,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array),it=normalize$4(it,this.array)),this.array[_e+0]=et,this.array[_e+1]=rt,this.array[_e+2]=it,this}setXYZW(_e,et,rt,it,st){return _e*=this.itemSize,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array),it=normalize$4(it,this.array),st=normalize$4(st,this.array)),this.array[_e+0]=et,this.array[_e+1]=rt,this.array[_e+2]=it,this.array[_e+3]=st,this}onUpload(_e){return this.onUploadCallback=_e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_e.name=this.name),this.usage!==StaticDrawUsage$1&&(_e.usage=this.usage),_e}};class Int8BufferAttribute extends BufferAttribute$1{constructor(_e,et,rt){super(new Int8Array(_e),et,rt)}}class Uint8BufferAttribute extends BufferAttribute$1{constructor(_e,et,rt){super(new Uint8Array(_e),et,rt)}}class Uint8ClampedBufferAttribute extends BufferAttribute$1{constructor(_e,et,rt){super(new Uint8ClampedArray(_e),et,rt)}}class Int16BufferAttribute extends BufferAttribute$1{constructor(_e,et,rt){super(new Int16Array(_e),et,rt)}}let Uint16BufferAttribute$1=class extends BufferAttribute$1{constructor(_e,et,rt){super(new Uint16Array(_e),et,rt)}};class Int32BufferAttribute extends BufferAttribute$1{constructor(_e,et,rt){super(new Int32Array(_e),et,rt)}}let Uint32BufferAttribute$1=class extends BufferAttribute$1{constructor(_e,et,rt){super(new Uint32Array(_e),et,rt)}},Float16BufferAttribute$1=class extends BufferAttribute$1{constructor(_e,et,rt){super(new Uint16Array(_e),et,rt),this.isFloat16BufferAttribute=!0}getX(_e){let et=fromHalfFloat$1(this.array[_e*this.itemSize]);return this.normalized&&(et=denormalize$1(et,this.array)),et}setX(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize]=toHalfFloat$1(et),this}getY(_e){let et=fromHalfFloat$1(this.array[_e*this.itemSize+1]);return this.normalized&&(et=denormalize$1(et,this.array)),et}setY(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize+1]=toHalfFloat$1(et),this}getZ(_e){let et=fromHalfFloat$1(this.array[_e*this.itemSize+2]);return this.normalized&&(et=denormalize$1(et,this.array)),et}setZ(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize+2]=toHalfFloat$1(et),this}getW(_e){let et=fromHalfFloat$1(this.array[_e*this.itemSize+3]);return this.normalized&&(et=denormalize$1(et,this.array)),et}setW(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.array[_e*this.itemSize+3]=toHalfFloat$1(et),this}setXY(_e,et,rt){return _e*=this.itemSize,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array)),this.array[_e+0]=toHalfFloat$1(et),this.array[_e+1]=toHalfFloat$1(rt),this}setXYZ(_e,et,rt,it){return _e*=this.itemSize,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array),it=normalize$4(it,this.array)),this.array[_e+0]=toHalfFloat$1(et),this.array[_e+1]=toHalfFloat$1(rt),this.array[_e+2]=toHalfFloat$1(it),this}setXYZW(_e,et,rt,it,st){return _e*=this.itemSize,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array),it=normalize$4(it,this.array),st=normalize$4(st,this.array)),this.array[_e+0]=toHalfFloat$1(et),this.array[_e+1]=toHalfFloat$1(rt),this.array[_e+2]=toHalfFloat$1(it),this.array[_e+3]=toHalfFloat$1(st),this}},Float32BufferAttribute$1=class extends BufferAttribute$1{constructor(_e,et,rt){super(new Float32Array(_e),et,rt)}},_id$2$1=0;const _m1$2$1=new Matrix4$1,_obj$1=new Object3D$1,_offset$1=new Vector3$1,_box$2$1=new Box3$1,_boxMorphTargets$1=new Box3$1,_vector$8$1=new Vector3$1;let BufferGeometry$1=class m0 extends EventDispatcher$1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2$1++}),this.uuid=generateUUID$2(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_e){return Array.isArray(_e)?this.index=new(arrayNeedsUint32$2(_e)?Uint32BufferAttribute$1:Uint16BufferAttribute$1)(_e,1):this.index=_e,this}getAttribute(_e){return this.attributes[_e]}setAttribute(_e,et){return this.attributes[_e]=et,this}deleteAttribute(_e){return delete this.attributes[_e],this}hasAttribute(_e){return this.attributes[_e]!==void 0}addGroup(_e,et,rt=0){this.groups.push({start:_e,count:et,materialIndex:rt})}clearGroups(){this.groups=[]}setDrawRange(_e,et){this.drawRange.start=_e,this.drawRange.count=et}applyMatrix4(_e){const et=this.attributes.position;et!==void 0&&(et.applyMatrix4(_e),et.needsUpdate=!0);const rt=this.attributes.normal;if(rt!==void 0){const st=new Matrix3$1().getNormalMatrix(_e);rt.applyNormalMatrix(st),rt.needsUpdate=!0}const it=this.attributes.tangent;return it!==void 0&&(it.transformDirection(_e),it.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_e){return _m1$2$1.makeRotationFromQuaternion(_e),this.applyMatrix4(_m1$2$1),this}rotateX(_e){return _m1$2$1.makeRotationX(_e),this.applyMatrix4(_m1$2$1),this}rotateY(_e){return _m1$2$1.makeRotationY(_e),this.applyMatrix4(_m1$2$1),this}rotateZ(_e){return _m1$2$1.makeRotationZ(_e),this.applyMatrix4(_m1$2$1),this}translate(_e,et,rt){return _m1$2$1.makeTranslation(_e,et,rt),this.applyMatrix4(_m1$2$1),this}scale(_e,et,rt){return _m1$2$1.makeScale(_e,et,rt),this.applyMatrix4(_m1$2$1),this}lookAt(_e){return _obj$1.lookAt(_e),_obj$1.updateMatrix(),this.applyMatrix4(_obj$1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset$1).negate(),this.translate(_offset$1.x,_offset$1.y,_offset$1.z),this}setFromPoints(_e){const et=[];for(let rt=0,it=_e.length;rt<it;rt++){const st=_e[rt];et.push(st.x,st.y,st.z||0)}return this.setAttribute("position",new Float32BufferAttribute$1(et,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3$1);const _e=this.attributes.position,et=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3$1(-1/0,-1/0,-1/0),new Vector3$1(1/0,1/0,1/0));return}if(_e!==void 0){if(this.boundingBox.setFromBufferAttribute(_e),et)for(let rt=0,it=et.length;rt<it;rt++){const st=et[rt];_box$2$1.setFromBufferAttribute(st),this.morphTargetsRelative?(_vector$8$1.addVectors(this.boundingBox.min,_box$2$1.min),this.boundingBox.expandByPoint(_vector$8$1),_vector$8$1.addVectors(this.boundingBox.max,_box$2$1.max),this.boundingBox.expandByPoint(_vector$8$1)):(this.boundingBox.expandByPoint(_box$2$1.min),this.boundingBox.expandByPoint(_box$2$1.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$1);const _e=this.attributes.position,et=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3$1,1/0);return}if(_e){const rt=this.boundingSphere.center;if(_box$2$1.setFromBufferAttribute(_e),et)for(let st=0,ot=et.length;st<ot;st++){const at=et[st];_boxMorphTargets$1.setFromBufferAttribute(at),this.morphTargetsRelative?(_vector$8$1.addVectors(_box$2$1.min,_boxMorphTargets$1.min),_box$2$1.expandByPoint(_vector$8$1),_vector$8$1.addVectors(_box$2$1.max,_boxMorphTargets$1.max),_box$2$1.expandByPoint(_vector$8$1)):(_box$2$1.expandByPoint(_boxMorphTargets$1.min),_box$2$1.expandByPoint(_boxMorphTargets$1.max))}_box$2$1.getCenter(rt);let it=0;for(let st=0,ot=_e.count;st<ot;st++)_vector$8$1.fromBufferAttribute(_e,st),it=Math.max(it,rt.distanceToSquared(_vector$8$1));if(et)for(let st=0,ot=et.length;st<ot;st++){const at=et[st],lt=this.morphTargetsRelative;for(let ct=0,ut=at.count;ct<ut;ct++)_vector$8$1.fromBufferAttribute(at,ct),lt&&(_offset$1.fromBufferAttribute(_e,ct),_vector$8$1.add(_offset$1)),it=Math.max(it,rt.distanceToSquared(_vector$8$1))}this.boundingSphere.radius=Math.sqrt(it),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _e=this.index,et=this.attributes;if(_e===null||et.position===void 0||et.normal===void 0||et.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const rt=et.position,it=et.normal,st=et.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute$1(new Float32Array(4*rt.count),4));const ot=this.getAttribute("tangent"),at=[],lt=[];for(let $t=0;$t<rt.count;$t++)at[$t]=new Vector3$1,lt[$t]=new Vector3$1;const ct=new Vector3$1,ut=new Vector3$1,ht=new Vector3$1,dt=new Vector2$1,ft=new Vector2$1,pt=new Vector2$1,mt=new Vector3$1,At=new Vector3$1;function gt($t,kt,Dt){ct.fromBufferAttribute(rt,$t),ut.fromBufferAttribute(rt,kt),ht.fromBufferAttribute(rt,Dt),dt.fromBufferAttribute(st,$t),ft.fromBufferAttribute(st,kt),pt.fromBufferAttribute(st,Dt),ut.sub(ct),ht.sub(ct),ft.sub(dt),pt.sub(dt);const Ot=1/(ft.x*pt.y-pt.x*ft.y);isFinite(Ot)&&(mt.copy(ut).multiplyScalar(pt.y).addScaledVector(ht,-ft.y).multiplyScalar(Ot),At.copy(ht).multiplyScalar(ft.x).addScaledVector(ut,-pt.x).multiplyScalar(Ot),at[$t].add(mt),at[kt].add(mt),at[Dt].add(mt),lt[$t].add(At),lt[kt].add(At),lt[Dt].add(At))}let bt=this.groups;bt.length===0&&(bt=[{start:0,count:_e.count}]);for(let $t=0,kt=bt.length;$t<kt;++$t){const Dt=bt[$t],Ot=Dt.start,zt=Dt.count;for(let Ht=Ot,Yt=Ot+zt;Ht<Yt;Ht+=3)gt(_e.getX(Ht+0),_e.getX(Ht+1),_e.getX(Ht+2))}const Tt=new Vector3$1,wt=new Vector3$1,Rt=new Vector3$1,It=new Vector3$1;function Lt($t){Rt.fromBufferAttribute(it,$t),It.copy(Rt);const kt=at[$t];Tt.copy(kt),Tt.sub(Rt.multiplyScalar(Rt.dot(kt))).normalize(),wt.crossVectors(It,kt);const Ot=wt.dot(lt[$t])<0?-1:1;ot.setXYZW($t,Tt.x,Tt.y,Tt.z,Ot)}for(let $t=0,kt=bt.length;$t<kt;++$t){const Dt=bt[$t],Ot=Dt.start,zt=Dt.count;for(let Ht=Ot,Yt=Ot+zt;Ht<Yt;Ht+=3)Lt(_e.getX(Ht+0)),Lt(_e.getX(Ht+1)),Lt(_e.getX(Ht+2))}}computeVertexNormals(){const _e=this.index,et=this.getAttribute("position");if(et!==void 0){let rt=this.getAttribute("normal");if(rt===void 0)rt=new BufferAttribute$1(new Float32Array(et.count*3),3),this.setAttribute("normal",rt);else for(let dt=0,ft=rt.count;dt<ft;dt++)rt.setXYZ(dt,0,0,0);const it=new Vector3$1,st=new Vector3$1,ot=new Vector3$1,at=new Vector3$1,lt=new Vector3$1,ct=new Vector3$1,ut=new Vector3$1,ht=new Vector3$1;if(_e)for(let dt=0,ft=_e.count;dt<ft;dt+=3){const pt=_e.getX(dt+0),mt=_e.getX(dt+1),At=_e.getX(dt+2);it.fromBufferAttribute(et,pt),st.fromBufferAttribute(et,mt),ot.fromBufferAttribute(et,At),ut.subVectors(ot,st),ht.subVectors(it,st),ut.cross(ht),at.fromBufferAttribute(rt,pt),lt.fromBufferAttribute(rt,mt),ct.fromBufferAttribute(rt,At),at.add(ut),lt.add(ut),ct.add(ut),rt.setXYZ(pt,at.x,at.y,at.z),rt.setXYZ(mt,lt.x,lt.y,lt.z),rt.setXYZ(At,ct.x,ct.y,ct.z)}else for(let dt=0,ft=et.count;dt<ft;dt+=3)it.fromBufferAttribute(et,dt+0),st.fromBufferAttribute(et,dt+1),ot.fromBufferAttribute(et,dt+2),ut.subVectors(ot,st),ht.subVectors(it,st),ut.cross(ht),rt.setXYZ(dt+0,ut.x,ut.y,ut.z),rt.setXYZ(dt+1,ut.x,ut.y,ut.z),rt.setXYZ(dt+2,ut.x,ut.y,ut.z);this.normalizeNormals(),rt.needsUpdate=!0}}normalizeNormals(){const _e=this.attributes.normal;for(let et=0,rt=_e.count;et<rt;et++)_vector$8$1.fromBufferAttribute(_e,et),_vector$8$1.normalize(),_e.setXYZ(et,_vector$8$1.x,_vector$8$1.y,_vector$8$1.z)}toNonIndexed(){function _e(at,lt){const ct=at.array,ut=at.itemSize,ht=at.normalized,dt=new ct.constructor(lt.length*ut);let ft=0,pt=0;for(let mt=0,At=lt.length;mt<At;mt++){at.isInterleavedBufferAttribute?ft=lt[mt]*at.data.stride+at.offset:ft=lt[mt]*ut;for(let gt=0;gt<ut;gt++)dt[pt++]=ct[ft++]}return new BufferAttribute$1(dt,ut,ht)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const et=new m0,rt=this.index.array,it=this.attributes;for(const at in it){const lt=it[at],ct=_e(lt,rt);et.setAttribute(at,ct)}const st=this.morphAttributes;for(const at in st){const lt=[],ct=st[at];for(let ut=0,ht=ct.length;ut<ht;ut++){const dt=ct[ut],ft=_e(dt,rt);lt.push(ft)}et.morphAttributes[at]=lt}et.morphTargetsRelative=this.morphTargetsRelative;const ot=this.groups;for(let at=0,lt=ot.length;at<lt;at++){const ct=ot[at];et.addGroup(ct.start,ct.count,ct.materialIndex)}return et}toJSON(){const _e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_e.uuid=this.uuid,_e.type=this.type,this.name!==""&&(_e.name=this.name),Object.keys(this.userData).length>0&&(_e.userData=this.userData),this.parameters!==void 0){const lt=this.parameters;for(const ct in lt)lt[ct]!==void 0&&(_e[ct]=lt[ct]);return _e}_e.data={attributes:{}};const et=this.index;et!==null&&(_e.data.index={type:et.array.constructor.name,array:Array.prototype.slice.call(et.array)});const rt=this.attributes;for(const lt in rt){const ct=rt[lt];_e.data.attributes[lt]=ct.toJSON(_e.data)}const it={};let st=!1;for(const lt in this.morphAttributes){const ct=this.morphAttributes[lt],ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const ft=ct[ht];ut.push(ft.toJSON(_e.data))}ut.length>0&&(it[lt]=ut,st=!0)}st&&(_e.data.morphAttributes=it,_e.data.morphTargetsRelative=this.morphTargetsRelative);const ot=this.groups;ot.length>0&&(_e.data.groups=JSON.parse(JSON.stringify(ot)));const at=this.boundingSphere;return at!==null&&(_e.data.boundingSphere={center:at.center.toArray(),radius:at.radius}),_e}clone(){return new this.constructor().copy(this)}copy(_e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const et={};this.name=_e.name;const rt=_e.index;rt!==null&&this.setIndex(rt.clone(et));const it=_e.attributes;for(const ct in it){const ut=it[ct];this.setAttribute(ct,ut.clone(et))}const st=_e.morphAttributes;for(const ct in st){const ut=[],ht=st[ct];for(let dt=0,ft=ht.length;dt<ft;dt++)ut.push(ht[dt].clone(et));this.morphAttributes[ct]=ut}this.morphTargetsRelative=_e.morphTargetsRelative;const ot=_e.groups;for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];this.addGroup(ht.start,ht.count,ht.materialIndex)}const at=_e.boundingBox;at!==null&&(this.boundingBox=at.clone());const lt=_e.boundingSphere;return lt!==null&&(this.boundingSphere=lt.clone()),this.drawRange.start=_e.drawRange.start,this.drawRange.count=_e.drawRange.count,this.userData=_e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const _inverseMatrix$3$1=new Matrix4$1,_ray$3$1=new Ray$1,_sphere$6$1=new Sphere$1,_sphereHitAt$1=new Vector3$1,_vA$1$1=new Vector3$1,_vB$1$1=new Vector3$1,_vC$1$1=new Vector3$1,_tempA$1=new Vector3$1,_morphA$1=new Vector3$1,_intersectionPoint$1=new Vector3$1,_intersectionPointWorld$1=new Vector3$1;let Mesh$1=class extends Object3D$1{constructor(_e=new BufferGeometry$1,et=new MeshBasicMaterial$1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_e,this.material=et,this.updateMorphTargets()}copy(_e,et){return super.copy(_e,et),_e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_e.morphTargetInfluences.slice()),_e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_e.morphTargetDictionary)),this.material=Array.isArray(_e.material)?_e.material.slice():_e.material,this.geometry=_e.geometry,this}updateMorphTargets(){const et=this.geometry.morphAttributes,rt=Object.keys(et);if(rt.length>0){const it=et[rt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const at=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[at]=st}}}}getVertexPosition(_e,et){const rt=this.geometry,it=rt.attributes.position,st=rt.morphAttributes.position,ot=rt.morphTargetsRelative;et.fromBufferAttribute(it,_e);const at=this.morphTargetInfluences;if(st&&at){_morphA$1.set(0,0,0);for(let lt=0,ct=st.length;lt<ct;lt++){const ut=at[lt],ht=st[lt];ut!==0&&(_tempA$1.fromBufferAttribute(ht,_e),ot?_morphA$1.addScaledVector(_tempA$1,ut):_morphA$1.addScaledVector(_tempA$1.sub(et),ut))}et.add(_morphA$1)}return et}raycast(_e,et){const rt=this.geometry,it=this.material,st=this.matrixWorld;it!==void 0&&(rt.boundingSphere===null&&rt.computeBoundingSphere(),_sphere$6$1.copy(rt.boundingSphere),_sphere$6$1.applyMatrix4(st),_ray$3$1.copy(_e.ray).recast(_e.near),!(_sphere$6$1.containsPoint(_ray$3$1.origin)===!1&&(_ray$3$1.intersectSphere(_sphere$6$1,_sphereHitAt$1)===null||_ray$3$1.origin.distanceToSquared(_sphereHitAt$1)>(_e.far-_e.near)**2))&&(_inverseMatrix$3$1.copy(st).invert(),_ray$3$1.copy(_e.ray).applyMatrix4(_inverseMatrix$3$1),!(rt.boundingBox!==null&&_ray$3$1.intersectsBox(rt.boundingBox)===!1)&&this._computeIntersections(_e,et,_ray$3$1)))}_computeIntersections(_e,et,rt){let it;const st=this.geometry,ot=this.material,at=st.index,lt=st.attributes.position,ct=st.attributes.uv,ut=st.attributes.uv1,ht=st.attributes.normal,dt=st.groups,ft=st.drawRange;if(at!==null)if(Array.isArray(ot))for(let pt=0,mt=dt.length;pt<mt;pt++){const At=dt[pt],gt=ot[At.materialIndex],bt=Math.max(At.start,ft.start),Tt=Math.min(at.count,Math.min(At.start+At.count,ft.start+ft.count));for(let wt=bt,Rt=Tt;wt<Rt;wt+=3){const It=at.getX(wt),Lt=at.getX(wt+1),$t=at.getX(wt+2);it=checkGeometryIntersection$1(this,gt,_e,rt,ct,ut,ht,It,Lt,$t),it&&(it.faceIndex=Math.floor(wt/3),it.face.materialIndex=At.materialIndex,et.push(it))}}else{const pt=Math.max(0,ft.start),mt=Math.min(at.count,ft.start+ft.count);for(let At=pt,gt=mt;At<gt;At+=3){const bt=at.getX(At),Tt=at.getX(At+1),wt=at.getX(At+2);it=checkGeometryIntersection$1(this,ot,_e,rt,ct,ut,ht,bt,Tt,wt),it&&(it.faceIndex=Math.floor(At/3),et.push(it))}}else if(lt!==void 0)if(Array.isArray(ot))for(let pt=0,mt=dt.length;pt<mt;pt++){const At=dt[pt],gt=ot[At.materialIndex],bt=Math.max(At.start,ft.start),Tt=Math.min(lt.count,Math.min(At.start+At.count,ft.start+ft.count));for(let wt=bt,Rt=Tt;wt<Rt;wt+=3){const It=wt,Lt=wt+1,$t=wt+2;it=checkGeometryIntersection$1(this,gt,_e,rt,ct,ut,ht,It,Lt,$t),it&&(it.faceIndex=Math.floor(wt/3),it.face.materialIndex=At.materialIndex,et.push(it))}}else{const pt=Math.max(0,ft.start),mt=Math.min(lt.count,ft.start+ft.count);for(let At=pt,gt=mt;At<gt;At+=3){const bt=At,Tt=At+1,wt=At+2;it=checkGeometryIntersection$1(this,ot,_e,rt,ct,ut,ht,bt,Tt,wt),it&&(it.faceIndex=Math.floor(At/3),et.push(it))}}}};function checkIntersection$1$1(nt,_e,et,rt,it,st,ot,at){let lt;if(_e.side===BackSide$1?lt=rt.intersectTriangle(ot,st,it,!0,at):lt=rt.intersectTriangle(it,st,ot,_e.side===FrontSide$1,at),lt===null)return null;_intersectionPointWorld$1.copy(at),_intersectionPointWorld$1.applyMatrix4(nt.matrixWorld);const ct=et.ray.origin.distanceTo(_intersectionPointWorld$1);return ct<et.near||ct>et.far?null:{distance:ct,point:_intersectionPointWorld$1.clone(),object:nt}}function checkGeometryIntersection$1(nt,_e,et,rt,it,st,ot,at,lt,ct){nt.getVertexPosition(at,_vA$1$1),nt.getVertexPosition(lt,_vB$1$1),nt.getVertexPosition(ct,_vC$1$1);const ut=checkIntersection$1$1(nt,_e,et,rt,_vA$1$1,_vB$1$1,_vC$1$1,_intersectionPoint$1);if(ut){const ht=new Vector3$1;Triangle$1.getBarycoord(_intersectionPoint$1,_vA$1$1,_vB$1$1,_vC$1$1,ht),it&&(ut.uv=Triangle$1.getInterpolatedAttribute(it,at,lt,ct,ht,new Vector2$1)),st&&(ut.uv1=Triangle$1.getInterpolatedAttribute(st,at,lt,ct,ht,new Vector2$1)),ot&&(ut.normal=Triangle$1.getInterpolatedAttribute(ot,at,lt,ct,ht,new Vector3$1),ut.normal.dot(rt.direction)>0&&ut.normal.multiplyScalar(-1));const dt={a:at,b:lt,c:ct,normal:new Vector3$1,materialIndex:0};Triangle$1.getNormal(_vA$1$1,_vB$1$1,_vC$1$1,dt.normal),ut.face=dt,ut.barycoord=ht}return ut}let BoxGeometry$1=class A0 extends BufferGeometry$1{constructor(_e=1,et=1,rt=1,it=1,st=1,ot=1){super(),this.type="BoxGeometry",this.parameters={width:_e,height:et,depth:rt,widthSegments:it,heightSegments:st,depthSegments:ot};const at=this;it=Math.floor(it),st=Math.floor(st),ot=Math.floor(ot);const lt=[],ct=[],ut=[],ht=[];let dt=0,ft=0;pt("z","y","x",-1,-1,rt,et,_e,ot,st,0),pt("z","y","x",1,-1,rt,et,-_e,ot,st,1),pt("x","z","y",1,1,_e,rt,et,it,ot,2),pt("x","z","y",1,-1,_e,rt,-et,it,ot,3),pt("x","y","z",1,-1,_e,et,rt,it,st,4),pt("x","y","z",-1,-1,_e,et,-rt,it,st,5),this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute$1(ct,3)),this.setAttribute("normal",new Float32BufferAttribute$1(ut,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ht,2));function pt(mt,At,gt,bt,Tt,wt,Rt,It,Lt,$t,kt){const Dt=wt/Lt,Ot=Rt/$t,zt=wt/2,Ht=Rt/2,Yt=It/2,Xt=Lt+1,Zt=$t+1;let rn=0,Gt=0;const jt=new Vector3$1;for(let Kt=0;Kt<Zt;Kt++){const Jt=Kt*Ot-Ht;for(let sn=0;sn<Xt;sn++){const hn=sn*Dt-zt;jt[mt]=hn*bt,jt[At]=Jt*Tt,jt[gt]=Yt,ct.push(jt.x,jt.y,jt.z),jt[mt]=0,jt[At]=0,jt[gt]=It>0?1:-1,ut.push(jt.x,jt.y,jt.z),ht.push(sn/Lt),ht.push(1-Kt/$t),rn+=1}}for(let Kt=0;Kt<$t;Kt++)for(let Jt=0;Jt<Lt;Jt++){const sn=dt+Jt+Xt*Kt,hn=dt+Jt+Xt*(Kt+1),an=dt+(Jt+1)+Xt*(Kt+1),pn=dt+(Jt+1)+Xt*Kt;lt.push(sn,hn,pn),lt.push(hn,an,pn),Gt+=6}at.addGroup(ft,Gt,kt),ft+=Gt,dt+=rn}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new A0(_e.width,_e.height,_e.depth,_e.widthSegments,_e.heightSegments,_e.depthSegments)}};function cloneUniforms$1(nt){const _e={};for(const et in nt){_e[et]={};for(const rt in nt[et]){const it=nt[et][rt];it&&(it.isColor||it.isMatrix3||it.isMatrix4||it.isVector2||it.isVector3||it.isVector4||it.isTexture||it.isQuaternion)?it.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_e[et][rt]=null):_e[et][rt]=it.clone():Array.isArray(it)?_e[et][rt]=it.slice():_e[et][rt]=it}}return _e}function mergeUniforms(nt){const _e={};for(let et=0;et<nt.length;et++){const rt=cloneUniforms$1(nt[et]);for(const it in rt)_e[it]=rt[it]}return _e}function cloneUniformsGroups$1(nt){const _e=[];for(let et=0;et<nt.length;et++)_e.push(nt[et].clone());return _e}function getUnlitUniformColorSpace(nt){const _e=nt.getRenderTarget();return _e===null?nt.outputColorSpace:_e.isXRRenderTarget===!0?_e.texture.colorSpace:ColorManagement$1.workingColorSpace}const UniformsUtils={clone:cloneUniforms$1,merge:mergeUniforms};var default_vertex$1=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment$1=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;let ShaderMaterial$1=class extends Material$1{constructor(_e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex$1,this.fragmentShader=default_fragment$1,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_e!==void 0&&this.setValues(_e)}copy(_e){return super.copy(_e),this.fragmentShader=_e.fragmentShader,this.vertexShader=_e.vertexShader,this.uniforms=cloneUniforms$1(_e.uniforms),this.uniformsGroups=cloneUniformsGroups$1(_e.uniformsGroups),this.defines=Object.assign({},_e.defines),this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.fog=_e.fog,this.lights=_e.lights,this.clipping=_e.clipping,this.extensions=Object.assign({},_e.extensions),this.glslVersion=_e.glslVersion,this}toJSON(_e){const et=super.toJSON(_e);et.glslVersion=this.glslVersion,et.uniforms={};for(const it in this.uniforms){const ot=this.uniforms[it].value;ot&&ot.isTexture?et.uniforms[it]={type:"t",value:ot.toJSON(_e).uuid}:ot&&ot.isColor?et.uniforms[it]={type:"c",value:ot.getHex()}:ot&&ot.isVector2?et.uniforms[it]={type:"v2",value:ot.toArray()}:ot&&ot.isVector3?et.uniforms[it]={type:"v3",value:ot.toArray()}:ot&&ot.isVector4?et.uniforms[it]={type:"v4",value:ot.toArray()}:ot&&ot.isMatrix3?et.uniforms[it]={type:"m3",value:ot.toArray()}:ot&&ot.isMatrix4?et.uniforms[it]={type:"m4",value:ot.toArray()}:et.uniforms[it]={value:ot}}Object.keys(this.defines).length>0&&(et.defines=this.defines),et.vertexShader=this.vertexShader,et.fragmentShader=this.fragmentShader,et.lights=this.lights,et.clipping=this.clipping;const rt={};for(const it in this.extensions)this.extensions[it]===!0&&(rt[it]=!0);return Object.keys(rt).length>0&&(et.extensions=rt),et}},Camera$1=class extends Object3D$1{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4$1,this.projectionMatrix=new Matrix4$1,this.projectionMatrixInverse=new Matrix4$1,this.coordinateSystem=WebGLCoordinateSystem$1}copy(_e,et){return super.copy(_e,et),this.matrixWorldInverse.copy(_e.matrixWorldInverse),this.projectionMatrix.copy(_e.projectionMatrix),this.projectionMatrixInverse.copy(_e.projectionMatrixInverse),this.coordinateSystem=_e.coordinateSystem,this}getWorldDirection(_e){return super.getWorldDirection(_e).negate()}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_e,et){super.updateWorldMatrix(_e,et),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const _v3$1$1=new Vector3$1,_minTarget$1=new Vector2$1,_maxTarget$1=new Vector2$1;let PerspectiveCamera$2=class extends Camera$1{constructor(_e=50,et=1,rt=.1,it=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_e,this.zoom=1,this.near=rt,this.far=it,this.focus=10,this.aspect=et,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_e,et){return super.copy(_e,et),this.fov=_e.fov,this.zoom=_e.zoom,this.near=_e.near,this.far=_e.far,this.focus=_e.focus,this.aspect=_e.aspect,this.view=_e.view===null?null:Object.assign({},_e.view),this.filmGauge=_e.filmGauge,this.filmOffset=_e.filmOffset,this}setFocalLength(_e){const et=.5*this.getFilmHeight()/_e;this.fov=RAD2DEG$1*2*Math.atan(et),this.updateProjectionMatrix()}getFocalLength(){const _e=Math.tan(DEG2RAD$1*.5*this.fov);return .5*this.getFilmHeight()/_e}getEffectiveFOV(){return RAD2DEG$1*2*Math.atan(Math.tan(DEG2RAD$1*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_e,et,rt){_v3$1$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),et.set(_v3$1$1.x,_v3$1$1.y).multiplyScalar(-_e/_v3$1$1.z),_v3$1$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),rt.set(_v3$1$1.x,_v3$1$1.y).multiplyScalar(-_e/_v3$1$1.z)}getViewSize(_e,et){return this.getViewBounds(_e,_minTarget$1,_maxTarget$1),et.subVectors(_maxTarget$1,_minTarget$1)}setViewOffset(_e,et,rt,it,st,ot){this.aspect=_e/et,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=et,this.view.offsetX=rt,this.view.offsetY=it,this.view.width=st,this.view.height=ot,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=this.near;let et=_e*Math.tan(DEG2RAD$1*.5*this.fov)/this.zoom,rt=2*et,it=this.aspect*rt,st=-.5*it;const ot=this.view;if(this.view!==null&&this.view.enabled){const lt=ot.fullWidth,ct=ot.fullHeight;st+=ot.offsetX*it/lt,et-=ot.offsetY*rt/ct,it*=ot.width/lt,rt*=ot.height/ct}const at=this.filmOffset;at!==0&&(st+=_e*at/this.getFilmWidth()),this.projectionMatrix.makePerspective(st,st+it,et,et-rt,_e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const et=super.toJSON(_e);return et.object.fov=this.fov,et.object.zoom=this.zoom,et.object.near=this.near,et.object.far=this.far,et.object.focus=this.focus,et.object.aspect=this.aspect,this.view!==null&&(et.object.view=Object.assign({},this.view)),et.object.filmGauge=this.filmGauge,et.object.filmOffset=this.filmOffset,et}};const fov$1=-90,aspect$1=1;let CubeCamera$1=class extends Object3D$1{constructor(_e,et,rt){super(),this.type="CubeCamera",this.renderTarget=rt,this.coordinateSystem=null,this.activeMipmapLevel=0;const it=new PerspectiveCamera$2(fov$1,aspect$1,_e,et);it.layers=this.layers,this.add(it);const st=new PerspectiveCamera$2(fov$1,aspect$1,_e,et);st.layers=this.layers,this.add(st);const ot=new PerspectiveCamera$2(fov$1,aspect$1,_e,et);ot.layers=this.layers,this.add(ot);const at=new PerspectiveCamera$2(fov$1,aspect$1,_e,et);at.layers=this.layers,this.add(at);const lt=new PerspectiveCamera$2(fov$1,aspect$1,_e,et);lt.layers=this.layers,this.add(lt);const ct=new PerspectiveCamera$2(fov$1,aspect$1,_e,et);ct.layers=this.layers,this.add(ct)}updateCoordinateSystem(){const _e=this.coordinateSystem,et=this.children.concat(),[rt,it,st,ot,at,lt]=et;for(const ct of et)this.remove(ct);if(_e===WebGLCoordinateSystem$1)rt.up.set(0,1,0),rt.lookAt(1,0,0),it.up.set(0,1,0),it.lookAt(-1,0,0),st.up.set(0,0,-1),st.lookAt(0,1,0),ot.up.set(0,0,1),ot.lookAt(0,-1,0),at.up.set(0,1,0),at.lookAt(0,0,1),lt.up.set(0,1,0),lt.lookAt(0,0,-1);else if(_e===WebGPUCoordinateSystem$1)rt.up.set(0,-1,0),rt.lookAt(-1,0,0),it.up.set(0,-1,0),it.lookAt(1,0,0),st.up.set(0,0,1),st.lookAt(0,1,0),ot.up.set(0,0,-1),ot.lookAt(0,-1,0),at.up.set(0,-1,0),at.lookAt(0,0,1),lt.up.set(0,-1,0),lt.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_e);for(const ct of et)this.add(ct),ct.updateMatrixWorld()}update(_e,et){this.parent===null&&this.updateMatrixWorld();const{renderTarget:rt,activeMipmapLevel:it}=this;this.coordinateSystem!==_e.coordinateSystem&&(this.coordinateSystem=_e.coordinateSystem,this.updateCoordinateSystem());const[st,ot,at,lt,ct,ut]=this.children,ht=_e.getRenderTarget(),dt=_e.getActiveCubeFace(),ft=_e.getActiveMipmapLevel(),pt=_e.xr.enabled;_e.xr.enabled=!1;const mt=rt.texture.generateMipmaps;rt.texture.generateMipmaps=!1,_e.setRenderTarget(rt,0,it),_e.render(et,st),_e.setRenderTarget(rt,1,it),_e.render(et,ot),_e.setRenderTarget(rt,2,it),_e.render(et,at),_e.setRenderTarget(rt,3,it),_e.render(et,lt),_e.setRenderTarget(rt,4,it),_e.render(et,ct),rt.texture.generateMipmaps=mt,_e.setRenderTarget(rt,5,it),_e.render(et,ut),_e.setRenderTarget(ht,dt,ft),_e.xr.enabled=pt,rt.texture.needsPMREMUpdate=!0}},CubeTexture$1=class extends Texture$1{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut){_e=_e!==void 0?_e:[],et=et!==void 0?et:CubeReflectionMapping$1,super(_e,et,rt,it,st,ot,at,lt,ct,ut),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_e){this.image=_e}},WebGLCubeRenderTarget$1=class extends WebGLRenderTarget$1{constructor(_e=1,et={}){super(_e,_e,et),this.isWebGLCubeRenderTarget=!0;const rt={width:_e,height:_e,depth:1},it=[rt,rt,rt,rt,rt,rt];this.texture=new CubeTexture$1(it,et.mapping,et.wrapS,et.wrapT,et.magFilter,et.minFilter,et.format,et.type,et.anisotropy,et.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=et.generateMipmaps!==void 0?et.generateMipmaps:!1,this.texture.minFilter=et.minFilter!==void 0?et.minFilter:LinearFilter$1}fromEquirectangularTexture(_e,et){this.texture.type=et.type,this.texture.colorSpace=et.colorSpace,this.texture.generateMipmaps=et.generateMipmaps,this.texture.minFilter=et.minFilter,this.texture.magFilter=et.magFilter;const rt={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},it=new BoxGeometry$1(5,5,5),st=new ShaderMaterial$1({name:"CubemapFromEquirect",uniforms:cloneUniforms$1(rt.uniforms),vertexShader:rt.vertexShader,fragmentShader:rt.fragmentShader,side:BackSide$1,blending:NoBlending$1});st.uniforms.tEquirect.value=et;const ot=new Mesh$1(it,st),at=et.minFilter;return et.minFilter===LinearMipmapLinearFilter$1&&(et.minFilter=LinearFilter$1),new CubeCamera$1(1,10,this).update(_e,ot),et.minFilter=at,ot.geometry.dispose(),ot.material.dispose(),this}clear(_e,et,rt,it){const st=_e.getRenderTarget();for(let ot=0;ot<6;ot++)_e.setRenderTarget(this,ot),_e.clear(et,rt,it);_e.setRenderTarget(st)}};const _vector1$1=new Vector3$1,_vector2$2=new Vector3$1,_normalMatrix$1=new Matrix3$1;let Plane$1=class{constructor(_e=new Vector3$1(1,0,0),et=0){this.isPlane=!0,this.normal=_e,this.constant=et}set(_e,et){return this.normal.copy(_e),this.constant=et,this}setComponents(_e,et,rt,it){return this.normal.set(_e,et,rt),this.constant=it,this}setFromNormalAndCoplanarPoint(_e,et){return this.normal.copy(_e),this.constant=-et.dot(this.normal),this}setFromCoplanarPoints(_e,et,rt){const it=_vector1$1.subVectors(rt,et).cross(_vector2$2.subVectors(_e,et)).normalize();return this.setFromNormalAndCoplanarPoint(it,_e),this}copy(_e){return this.normal.copy(_e.normal),this.constant=_e.constant,this}normalize(){const _e=1/this.normal.length();return this.normal.multiplyScalar(_e),this.constant*=_e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_e){return this.normal.dot(_e)+this.constant}distanceToSphere(_e){return this.distanceToPoint(_e.center)-_e.radius}projectPoint(_e,et){return et.copy(_e).addScaledVector(this.normal,-this.distanceToPoint(_e))}intersectLine(_e,et){const rt=_e.delta(_vector1$1),it=this.normal.dot(rt);if(it===0)return this.distanceToPoint(_e.start)===0?et.copy(_e.start):null;const st=-(_e.start.dot(this.normal)+this.constant)/it;return st<0||st>1?null:et.copy(_e.start).addScaledVector(rt,st)}intersectsLine(_e){const et=this.distanceToPoint(_e.start),rt=this.distanceToPoint(_e.end);return et<0&&rt>0||rt<0&&et>0}intersectsBox(_e){return _e.intersectsPlane(this)}intersectsSphere(_e){return _e.intersectsPlane(this)}coplanarPoint(_e){return _e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_e,et){const rt=et||_normalMatrix$1.getNormalMatrix(_e),it=this.coplanarPoint(_vector1$1).applyMatrix4(_e),st=this.normal.applyMatrix3(rt).normalize();return this.constant=-it.dot(st),this}translate(_e){return this.constant-=_e.dot(this.normal),this}equals(_e){return _e.normal.equals(this.normal)&&_e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const _sphere$5=new Sphere$1,_vector$7$1=new Vector3$1;let Frustum$1=class{constructor(_e=new Plane$1,et=new Plane$1,rt=new Plane$1,it=new Plane$1,st=new Plane$1,ot=new Plane$1){this.planes=[_e,et,rt,it,st,ot]}set(_e,et,rt,it,st,ot){const at=this.planes;return at[0].copy(_e),at[1].copy(et),at[2].copy(rt),at[3].copy(it),at[4].copy(st),at[5].copy(ot),this}copy(_e){const et=this.planes;for(let rt=0;rt<6;rt++)et[rt].copy(_e.planes[rt]);return this}setFromProjectionMatrix(_e,et=WebGLCoordinateSystem$1){const rt=this.planes,it=_e.elements,st=it[0],ot=it[1],at=it[2],lt=it[3],ct=it[4],ut=it[5],ht=it[6],dt=it[7],ft=it[8],pt=it[9],mt=it[10],At=it[11],gt=it[12],bt=it[13],Tt=it[14],wt=it[15];if(rt[0].setComponents(lt-st,dt-ct,At-ft,wt-gt).normalize(),rt[1].setComponents(lt+st,dt+ct,At+ft,wt+gt).normalize(),rt[2].setComponents(lt+ot,dt+ut,At+pt,wt+bt).normalize(),rt[3].setComponents(lt-ot,dt-ut,At-pt,wt-bt).normalize(),rt[4].setComponents(lt-at,dt-ht,At-mt,wt-Tt).normalize(),et===WebGLCoordinateSystem$1)rt[5].setComponents(lt+at,dt+ht,At+mt,wt+Tt).normalize();else if(et===WebGPUCoordinateSystem$1)rt[5].setComponents(at,ht,mt,Tt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+et);return this}intersectsObject(_e){if(_e.boundingSphere!==void 0)_e.boundingSphere===null&&_e.computeBoundingSphere(),_sphere$5.copy(_e.boundingSphere).applyMatrix4(_e.matrixWorld);else{const et=_e.geometry;et.boundingSphere===null&&et.computeBoundingSphere(),_sphere$5.copy(et.boundingSphere).applyMatrix4(_e.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(_e){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(_e.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(_e){const et=this.planes,rt=_e.center,it=-_e.radius;for(let st=0;st<6;st++)if(et[st].distanceToPoint(rt)<it)return!1;return!0}intersectsBox(_e){const et=this.planes;for(let rt=0;rt<6;rt++){const it=et[rt];if(_vector$7$1.x=it.normal.x>0?_e.max.x:_e.min.x,_vector$7$1.y=it.normal.y>0?_e.max.y:_e.min.y,_vector$7$1.z=it.normal.z>0?_e.max.z:_e.min.z,it.distanceToPoint(_vector$7$1)<0)return!1}return!0}containsPoint(_e){const et=this.planes;for(let rt=0;rt<6;rt++)if(et[rt].distanceToPoint(_e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function WebGLAnimation(){let nt=null,_e=!1,et=null,rt=null;function it(st,ot){et(st,ot),rt=nt.requestAnimationFrame(it)}return{start:function(){_e!==!0&&et!==null&&(rt=nt.requestAnimationFrame(it),_e=!0)},stop:function(){nt.cancelAnimationFrame(rt),_e=!1},setAnimationLoop:function(st){et=st},setContext:function(st){nt=st}}}function WebGLAttributes(nt){const _e=new WeakMap;function et(at,lt){const ct=at.array,ut=at.usage,ht=ct.byteLength,dt=nt.createBuffer();nt.bindBuffer(lt,dt),nt.bufferData(lt,ct,ut),at.onUploadCallback();let ft;if(ct instanceof Float32Array)ft=nt.FLOAT;else if(ct instanceof Uint16Array)at.isFloat16BufferAttribute?ft=nt.HALF_FLOAT:ft=nt.UNSIGNED_SHORT;else if(ct instanceof Int16Array)ft=nt.SHORT;else if(ct instanceof Uint32Array)ft=nt.UNSIGNED_INT;else if(ct instanceof Int32Array)ft=nt.INT;else if(ct instanceof Int8Array)ft=nt.BYTE;else if(ct instanceof Uint8Array)ft=nt.UNSIGNED_BYTE;else if(ct instanceof Uint8ClampedArray)ft=nt.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+ct);return{buffer:dt,type:ft,bytesPerElement:ct.BYTES_PER_ELEMENT,version:at.version,size:ht}}function rt(at,lt,ct){const ut=lt.array,ht=lt.updateRanges;if(nt.bindBuffer(ct,at),ht.length===0)nt.bufferSubData(ct,0,ut);else{ht.sort((ft,pt)=>ft.start-pt.start);let dt=0;for(let ft=1;ft<ht.length;ft++){const pt=ht[dt],mt=ht[ft];mt.start<=pt.start+pt.count+1?pt.count=Math.max(pt.count,mt.start+mt.count-pt.start):(++dt,ht[dt]=mt)}ht.length=dt+1;for(let ft=0,pt=ht.length;ft<pt;ft++){const mt=ht[ft];nt.bufferSubData(ct,mt.start*ut.BYTES_PER_ELEMENT,ut,mt.start,mt.count)}lt.clearUpdateRanges()}lt.onUploadCallback()}function it(at){return at.isInterleavedBufferAttribute&&(at=at.data),_e.get(at)}function st(at){at.isInterleavedBufferAttribute&&(at=at.data);const lt=_e.get(at);lt&&(nt.deleteBuffer(lt.buffer),_e.delete(at))}function ot(at,lt){if(at.isInterleavedBufferAttribute&&(at=at.data),at.isGLBufferAttribute){const ut=_e.get(at);(!ut||ut.version<at.version)&&_e.set(at,{buffer:at.buffer,type:at.type,bytesPerElement:at.elementSize,version:at.version});return}const ct=_e.get(at);if(ct===void 0)_e.set(at,et(at,lt));else if(ct.version<at.version){if(ct.size!==at.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");rt(ct.buffer,at,lt),ct.version=at.version}}return{get:it,remove:st,update:ot}}class PlaneGeometry extends BufferGeometry$1{constructor(_e=1,et=1,rt=1,it=1){super(),this.type="PlaneGeometry",this.parameters={width:_e,height:et,widthSegments:rt,heightSegments:it};const st=_e/2,ot=et/2,at=Math.floor(rt),lt=Math.floor(it),ct=at+1,ut=lt+1,ht=_e/at,dt=et/lt,ft=[],pt=[],mt=[],At=[];for(let gt=0;gt<ut;gt++){const bt=gt*dt-ot;for(let Tt=0;Tt<ct;Tt++){const wt=Tt*ht-st;pt.push(wt,-bt,0),mt.push(0,0,1),At.push(Tt/at),At.push(1-gt/lt)}}for(let gt=0;gt<lt;gt++)for(let bt=0;bt<at;bt++){const Tt=bt+ct*gt,wt=bt+ct*(gt+1),Rt=bt+1+ct*(gt+1),It=bt+1+ct*gt;ft.push(Tt,wt,It),ft.push(wt,Rt,It)}this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute$1(pt,3)),this.setAttribute("normal",new Float32BufferAttribute$1(mt,3)),this.setAttribute("uv",new Float32BufferAttribute$1(At,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new PlaneGeometry(_e.width,_e.height,_e.widthSegments,_e.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphinstance_vertex=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$2(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3$1},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3$1},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3$1}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3$1},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3$1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3$1}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3$1},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3$1},normalScale:{value:new Vector2$1(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3$1},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3$1}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3$1}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3$1}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$2(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$2(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3$1},alphaTest:{value:0},uvTransform:{value:new Matrix3$1}},sprite:{diffuse:{value:new Color$2(16777215)},opacity:{value:1},center:{value:new Vector2$1(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3$1},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3$1},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$2(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$2(0)},specular:{value:new Color$2(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$2(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$2(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3$1},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3$1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3$1},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$2(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3$1},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3$1},clearcoatNormalScale:{value:new Vector2$1(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3$1},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3$1},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3$1},sheen:{value:0},sheenColor:{value:new Color$2(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3$1},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3$1},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3$1},transmissionSamplerSize:{value:new Vector2$1},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3$1},attenuationDistance:{value:0},attenuationColor:{value:new Color$2(0)},specularColor:{value:new Color$2(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3$1},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3$1},anisotropyVector:{value:new Vector2$1},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3$1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler$1,_m1$1$1=new Matrix4$1;function WebGLBackground(nt,_e,et,rt,it,st,ot){const at=new Color$2(0);let lt=st===!0?0:1,ct,ut,ht=null,dt=0,ft=null;function pt(bt){let Tt=bt.isScene===!0?bt.background:null;return Tt&&Tt.isTexture&&(Tt=(bt.backgroundBlurriness>0?et:_e).get(Tt)),Tt}function mt(bt){let Tt=!1;const wt=pt(bt);wt===null?gt(at,lt):wt&&wt.isColor&&(gt(wt,1),Tt=!0);const Rt=nt.xr.getEnvironmentBlendMode();Rt==="additive"?rt.buffers.color.setClear(0,0,0,1,ot):Rt==="alpha-blend"&&rt.buffers.color.setClear(0,0,0,0,ot),(nt.autoClear||Tt)&&(rt.buffers.depth.setTest(!0),rt.buffers.depth.setMask(!0),rt.buffers.color.setMask(!0),nt.clear(nt.autoClearColor,nt.autoClearDepth,nt.autoClearStencil))}function At(bt,Tt){const wt=pt(Tt);wt&&(wt.isCubeTexture||wt.mapping===CubeUVReflectionMapping$1)?(ut===void 0&&(ut=new Mesh$1(new BoxGeometry$1(1,1,1),new ShaderMaterial$1({name:"BackgroundCubeMaterial",uniforms:cloneUniforms$1(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide$1,depthTest:!1,depthWrite:!1,fog:!1})),ut.geometry.deleteAttribute("normal"),ut.geometry.deleteAttribute("uv"),ut.onBeforeRender=function(Rt,It,Lt){this.matrixWorld.copyPosition(Lt.matrixWorld)},Object.defineProperty(ut.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),it.update(ut)),_e1$1.copy(Tt.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,wt.isCubeTexture&&wt.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),ut.material.uniforms.envMap.value=wt,ut.material.uniforms.flipEnvMap.value=wt.isCubeTexture&&wt.isRenderTargetTexture===!1?-1:1,ut.material.uniforms.backgroundBlurriness.value=Tt.backgroundBlurriness,ut.material.uniforms.backgroundIntensity.value=Tt.backgroundIntensity,ut.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1$1.makeRotationFromEuler(_e1$1)),ut.material.toneMapped=ColorManagement$1.getTransfer(wt.colorSpace)!==SRGBTransfer$1,(ht!==wt||dt!==wt.version||ft!==nt.toneMapping)&&(ut.material.needsUpdate=!0,ht=wt,dt=wt.version,ft=nt.toneMapping),ut.layers.enableAll(),bt.unshift(ut,ut.geometry,ut.material,0,0,null)):wt&&wt.isTexture&&(ct===void 0&&(ct=new Mesh$1(new PlaneGeometry(2,2),new ShaderMaterial$1({name:"BackgroundMaterial",uniforms:cloneUniforms$1(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide$1,depthTest:!1,depthWrite:!1,fog:!1})),ct.geometry.deleteAttribute("normal"),Object.defineProperty(ct.material,"map",{get:function(){return this.uniforms.t2D.value}}),it.update(ct)),ct.material.uniforms.t2D.value=wt,ct.material.uniforms.backgroundIntensity.value=Tt.backgroundIntensity,ct.material.toneMapped=ColorManagement$1.getTransfer(wt.colorSpace)!==SRGBTransfer$1,wt.matrixAutoUpdate===!0&&wt.updateMatrix(),ct.material.uniforms.uvTransform.value.copy(wt.matrix),(ht!==wt||dt!==wt.version||ft!==nt.toneMapping)&&(ct.material.needsUpdate=!0,ht=wt,dt=wt.version,ft=nt.toneMapping),ct.layers.enableAll(),bt.unshift(ct,ct.geometry,ct.material,0,0,null))}function gt(bt,Tt){bt.getRGB(_rgb,getUnlitUniformColorSpace(nt)),rt.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,Tt,ot)}return{getClearColor:function(){return at},setClearColor:function(bt,Tt=1){at.set(bt),lt=Tt,gt(at,lt)},getClearAlpha:function(){return lt},setClearAlpha:function(bt){lt=bt,gt(at,lt)},render:mt,addToRenderList:At}}function WebGLBindingStates(nt,_e){const et=nt.getParameter(nt.MAX_VERTEX_ATTRIBS),rt={},it=dt(null);let st=it,ot=!1;function at(Dt,Ot,zt,Ht,Yt){let Xt=!1;const Zt=ht(Ht,zt,Ot);st!==Zt&&(st=Zt,ct(st.object)),Xt=ft(Dt,Ht,zt,Yt),Xt&&pt(Dt,Ht,zt,Yt),Yt!==null&&_e.update(Yt,nt.ELEMENT_ARRAY_BUFFER),(Xt||ot)&&(ot=!1,wt(Dt,Ot,zt,Ht),Yt!==null&&nt.bindBuffer(nt.ELEMENT_ARRAY_BUFFER,_e.get(Yt).buffer))}function lt(){return nt.createVertexArray()}function ct(Dt){return nt.bindVertexArray(Dt)}function ut(Dt){return nt.deleteVertexArray(Dt)}function ht(Dt,Ot,zt){const Ht=zt.wireframe===!0;let Yt=rt[Dt.id];Yt===void 0&&(Yt={},rt[Dt.id]=Yt);let Xt=Yt[Ot.id];Xt===void 0&&(Xt={},Yt[Ot.id]=Xt);let Zt=Xt[Ht];return Zt===void 0&&(Zt=dt(lt()),Xt[Ht]=Zt),Zt}function dt(Dt){const Ot=[],zt=[],Ht=[];for(let Yt=0;Yt<et;Yt++)Ot[Yt]=0,zt[Yt]=0,Ht[Yt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ot,enabledAttributes:zt,attributeDivisors:Ht,object:Dt,attributes:{},index:null}}function ft(Dt,Ot,zt,Ht){const Yt=st.attributes,Xt=Ot.attributes;let Zt=0;const rn=zt.getAttributes();for(const Gt in rn)if(rn[Gt].location>=0){const Kt=Yt[Gt];let Jt=Xt[Gt];if(Jt===void 0&&(Gt==="instanceMatrix"&&Dt.instanceMatrix&&(Jt=Dt.instanceMatrix),Gt==="instanceColor"&&Dt.instanceColor&&(Jt=Dt.instanceColor)),Kt===void 0||Kt.attribute!==Jt||Jt&&Kt.data!==Jt.data)return!0;Zt++}return st.attributesNum!==Zt||st.index!==Ht}function pt(Dt,Ot,zt,Ht){const Yt={},Xt=Ot.attributes;let Zt=0;const rn=zt.getAttributes();for(const Gt in rn)if(rn[Gt].location>=0){let Kt=Xt[Gt];Kt===void 0&&(Gt==="instanceMatrix"&&Dt.instanceMatrix&&(Kt=Dt.instanceMatrix),Gt==="instanceColor"&&Dt.instanceColor&&(Kt=Dt.instanceColor));const Jt={};Jt.attribute=Kt,Kt&&Kt.data&&(Jt.data=Kt.data),Yt[Gt]=Jt,Zt++}st.attributes=Yt,st.attributesNum=Zt,st.index=Ht}function mt(){const Dt=st.newAttributes;for(let Ot=0,zt=Dt.length;Ot<zt;Ot++)Dt[Ot]=0}function At(Dt){gt(Dt,0)}function gt(Dt,Ot){const zt=st.newAttributes,Ht=st.enabledAttributes,Yt=st.attributeDivisors;zt[Dt]=1,Ht[Dt]===0&&(nt.enableVertexAttribArray(Dt),Ht[Dt]=1),Yt[Dt]!==Ot&&(nt.vertexAttribDivisor(Dt,Ot),Yt[Dt]=Ot)}function bt(){const Dt=st.newAttributes,Ot=st.enabledAttributes;for(let zt=0,Ht=Ot.length;zt<Ht;zt++)Ot[zt]!==Dt[zt]&&(nt.disableVertexAttribArray(zt),Ot[zt]=0)}function Tt(Dt,Ot,zt,Ht,Yt,Xt,Zt){Zt===!0?nt.vertexAttribIPointer(Dt,Ot,zt,Yt,Xt):nt.vertexAttribPointer(Dt,Ot,zt,Ht,Yt,Xt)}function wt(Dt,Ot,zt,Ht){mt();const Yt=Ht.attributes,Xt=zt.getAttributes(),Zt=Ot.defaultAttributeValues;for(const rn in Xt){const Gt=Xt[rn];if(Gt.location>=0){let jt=Yt[rn];if(jt===void 0&&(rn==="instanceMatrix"&&Dt.instanceMatrix&&(jt=Dt.instanceMatrix),rn==="instanceColor"&&Dt.instanceColor&&(jt=Dt.instanceColor)),jt!==void 0){const Kt=jt.normalized,Jt=jt.itemSize,sn=_e.get(jt);if(sn===void 0)continue;const hn=sn.buffer,an=sn.type,pn=sn.bytesPerElement,_n=an===nt.INT||an===nt.UNSIGNED_INT||jt.gpuType===IntType$1;if(jt.isInterleavedBufferAttribute){const yn=jt.data,$n=yn.stride,Jn=jt.offset;if(yn.isInstancedInterleavedBuffer){for(let Xn=0;Xn<Gt.locationSize;Xn++)gt(Gt.location+Xn,yn.meshPerAttribute);Dt.isInstancedMesh!==!0&&Ht._maxInstanceCount===void 0&&(Ht._maxInstanceCount=yn.meshPerAttribute*yn.count)}else for(let Xn=0;Xn<Gt.locationSize;Xn++)At(Gt.location+Xn);nt.bindBuffer(nt.ARRAY_BUFFER,hn);for(let Xn=0;Xn<Gt.locationSize;Xn++)Tt(Gt.location+Xn,Jt/Gt.locationSize,an,Kt,$n*pn,(Jn+Jt/Gt.locationSize*Xn)*pn,_n)}else{if(jt.isInstancedBufferAttribute){for(let yn=0;yn<Gt.locationSize;yn++)gt(Gt.location+yn,jt.meshPerAttribute);Dt.isInstancedMesh!==!0&&Ht._maxInstanceCount===void 0&&(Ht._maxInstanceCount=jt.meshPerAttribute*jt.count)}else for(let yn=0;yn<Gt.locationSize;yn++)At(Gt.location+yn);nt.bindBuffer(nt.ARRAY_BUFFER,hn);for(let yn=0;yn<Gt.locationSize;yn++)Tt(Gt.location+yn,Jt/Gt.locationSize,an,Kt,Jt*pn,Jt/Gt.locationSize*yn*pn,_n)}}else if(Zt!==void 0){const Kt=Zt[rn];if(Kt!==void 0)switch(Kt.length){case 2:nt.vertexAttrib2fv(Gt.location,Kt);break;case 3:nt.vertexAttrib3fv(Gt.location,Kt);break;case 4:nt.vertexAttrib4fv(Gt.location,Kt);break;default:nt.vertexAttrib1fv(Gt.location,Kt)}}}}bt()}function Rt(){$t();for(const Dt in rt){const Ot=rt[Dt];for(const zt in Ot){const Ht=Ot[zt];for(const Yt in Ht)ut(Ht[Yt].object),delete Ht[Yt];delete Ot[zt]}delete rt[Dt]}}function It(Dt){if(rt[Dt.id]===void 0)return;const Ot=rt[Dt.id];for(const zt in Ot){const Ht=Ot[zt];for(const Yt in Ht)ut(Ht[Yt].object),delete Ht[Yt];delete Ot[zt]}delete rt[Dt.id]}function Lt(Dt){for(const Ot in rt){const zt=rt[Ot];if(zt[Dt.id]===void 0)continue;const Ht=zt[Dt.id];for(const Yt in Ht)ut(Ht[Yt].object),delete Ht[Yt];delete zt[Dt.id]}}function $t(){kt(),ot=!0,st!==it&&(st=it,ct(st.object))}function kt(){it.geometry=null,it.program=null,it.wireframe=!1}return{setup:at,reset:$t,resetDefaultState:kt,dispose:Rt,releaseStatesOfGeometry:It,releaseStatesOfProgram:Lt,initAttributes:mt,enableAttribute:At,disableUnusedAttributes:bt}}function WebGLBufferRenderer$1(nt,_e,et){let rt;function it(ct){rt=ct}function st(ct,ut){nt.drawArrays(rt,ct,ut),et.update(ut,rt,1)}function ot(ct,ut,ht){ht!==0&&(nt.drawArraysInstanced(rt,ct,ut,ht),et.update(ut,rt,ht))}function at(ct,ut,ht){if(ht===0)return;_e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(rt,ct,0,ut,0,ht);let ft=0;for(let pt=0;pt<ht;pt++)ft+=ut[pt];et.update(ft,rt,1)}function lt(ct,ut,ht,dt){if(ht===0)return;const ft=_e.get("WEBGL_multi_draw");if(ft===null)for(let pt=0;pt<ct.length;pt++)ot(ct[pt],ut[pt],dt[pt]);else{ft.multiDrawArraysInstancedWEBGL(rt,ct,0,ut,0,dt,0,ht);let pt=0;for(let mt=0;mt<ht;mt++)pt+=ut[mt];for(let mt=0;mt<dt.length;mt++)et.update(pt,rt,dt[mt])}}this.setMode=it,this.render=st,this.renderInstances=ot,this.renderMultiDraw=at,this.renderMultiDrawInstances=lt}function WebGLCapabilities$1(nt,_e,et,rt){let it;function st(){if(it!==void 0)return it;if(_e.has("EXT_texture_filter_anisotropic")===!0){const Lt=_e.get("EXT_texture_filter_anisotropic");it=nt.getParameter(Lt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else it=0;return it}function ot(Lt){return!(Lt!==RGBAFormat$1&&rt.convert(Lt)!==nt.getParameter(nt.IMPLEMENTATION_COLOR_READ_FORMAT))}function at(Lt){const $t=Lt===HalfFloatType$1&&(_e.has("EXT_color_buffer_half_float")||_e.has("EXT_color_buffer_float"));return!(Lt!==UnsignedByteType$1&&rt.convert(Lt)!==nt.getParameter(nt.IMPLEMENTATION_COLOR_READ_TYPE)&&Lt!==FloatType$1&&!$t)}function lt(Lt){if(Lt==="highp"){if(nt.getShaderPrecisionFormat(nt.VERTEX_SHADER,nt.HIGH_FLOAT).precision>0&&nt.getShaderPrecisionFormat(nt.FRAGMENT_SHADER,nt.HIGH_FLOAT).precision>0)return"highp";Lt="mediump"}return Lt==="mediump"&&nt.getShaderPrecisionFormat(nt.VERTEX_SHADER,nt.MEDIUM_FLOAT).precision>0&&nt.getShaderPrecisionFormat(nt.FRAGMENT_SHADER,nt.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let ct=et.precision!==void 0?et.precision:"highp";const ut=lt(ct);ut!==ct&&(console.warn("THREE.WebGLRenderer:",ct,"not supported, using",ut,"instead."),ct=ut);const ht=et.logarithmicDepthBuffer===!0,dt=et.reverseDepthBuffer===!0&&_e.has("EXT_clip_control");if(dt===!0){const Lt=_e.get("EXT_clip_control");Lt.clipControlEXT(Lt.LOWER_LEFT_EXT,Lt.ZERO_TO_ONE_EXT)}const ft=nt.getParameter(nt.MAX_TEXTURE_IMAGE_UNITS),pt=nt.getParameter(nt.MAX_VERTEX_TEXTURE_IMAGE_UNITS),mt=nt.getParameter(nt.MAX_TEXTURE_SIZE),At=nt.getParameter(nt.MAX_CUBE_MAP_TEXTURE_SIZE),gt=nt.getParameter(nt.MAX_VERTEX_ATTRIBS),bt=nt.getParameter(nt.MAX_VERTEX_UNIFORM_VECTORS),Tt=nt.getParameter(nt.MAX_VARYING_VECTORS),wt=nt.getParameter(nt.MAX_FRAGMENT_UNIFORM_VECTORS),Rt=pt>0,It=nt.getParameter(nt.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:st,getMaxPrecision:lt,textureFormatReadable:ot,textureTypeReadable:at,precision:ct,logarithmicDepthBuffer:ht,reverseDepthBuffer:dt,maxTextures:ft,maxVertexTextures:pt,maxTextureSize:mt,maxCubemapSize:At,maxAttributes:gt,maxVertexUniforms:bt,maxVaryings:Tt,maxFragmentUniforms:wt,vertexTextures:Rt,maxSamples:It}}function WebGLClipping(nt){const _e=this;let et=null,rt=0,it=!1,st=!1;const ot=new Plane$1,at=new Matrix3$1,lt={value:null,needsUpdate:!1};this.uniform=lt,this.numPlanes=0,this.numIntersection=0,this.init=function(ht,dt){const ft=ht.length!==0||dt||rt!==0||it;return it=dt,rt=ht.length,ft},this.beginShadows=function(){st=!0,ut(null)},this.endShadows=function(){st=!1},this.setGlobalState=function(ht,dt){et=ut(ht,dt,0)},this.setState=function(ht,dt,ft){const pt=ht.clippingPlanes,mt=ht.clipIntersection,At=ht.clipShadows,gt=nt.get(ht);if(!it||pt===null||pt.length===0||st&&!At)st?ut(null):ct();else{const bt=st?0:rt,Tt=bt*4;let wt=gt.clippingState||null;lt.value=wt,wt=ut(pt,dt,Tt,ft);for(let Rt=0;Rt!==Tt;++Rt)wt[Rt]=et[Rt];gt.clippingState=wt,this.numIntersection=mt?this.numPlanes:0,this.numPlanes+=bt}};function ct(){lt.value!==et&&(lt.value=et,lt.needsUpdate=rt>0),_e.numPlanes=rt,_e.numIntersection=0}function ut(ht,dt,ft,pt){const mt=ht!==null?ht.length:0;let At=null;if(mt!==0){if(At=lt.value,pt!==!0||At===null){const gt=ft+mt*4,bt=dt.matrixWorldInverse;at.getNormalMatrix(bt),(At===null||At.length<gt)&&(At=new Float32Array(gt));for(let Tt=0,wt=ft;Tt!==mt;++Tt,wt+=4)ot.copy(ht[Tt]).applyMatrix4(bt,at),ot.normal.toArray(At,wt),At[wt+3]=ot.constant}lt.value=At,lt.needsUpdate=!0}return _e.numPlanes=mt,_e.numIntersection=0,At}}function WebGLCubeMaps(nt){let _e=new WeakMap;function et(ot,at){return at===EquirectangularReflectionMapping$1?ot.mapping=CubeReflectionMapping$1:at===EquirectangularRefractionMapping$1&&(ot.mapping=CubeRefractionMapping$1),ot}function rt(ot){if(ot&&ot.isTexture){const at=ot.mapping;if(at===EquirectangularReflectionMapping$1||at===EquirectangularRefractionMapping$1)if(_e.has(ot)){const lt=_e.get(ot).texture;return et(lt,ot.mapping)}else{const lt=ot.image;if(lt&&lt.height>0){const ct=new WebGLCubeRenderTarget$1(lt.height);return ct.fromEquirectangularTexture(nt,ot),_e.set(ot,ct),ot.addEventListener("dispose",it),et(ct.texture,ot.mapping)}else return null}}return ot}function it(ot){const at=ot.target;at.removeEventListener("dispose",it);const lt=_e.get(at);lt!==void 0&&(_e.delete(at),lt.dispose())}function st(){_e=new WeakMap}return{get:rt,dispose:st}}let OrthographicCamera$1=class extends Camera$1{constructor(_e=-1,et=1,rt=1,it=-1,st=.1,ot=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_e,this.right=et,this.top=rt,this.bottom=it,this.near=st,this.far=ot,this.updateProjectionMatrix()}copy(_e,et){return super.copy(_e,et),this.left=_e.left,this.right=_e.right,this.top=_e.top,this.bottom=_e.bottom,this.near=_e.near,this.far=_e.far,this.zoom=_e.zoom,this.view=_e.view===null?null:Object.assign({},_e.view),this}setViewOffset(_e,et,rt,it,st,ot){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=et,this.view.offsetX=rt,this.view.offsetY=it,this.view.width=st,this.view.height=ot,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=(this.right-this.left)/(2*this.zoom),et=(this.top-this.bottom)/(2*this.zoom),rt=(this.right+this.left)/2,it=(this.top+this.bottom)/2;let st=rt-_e,ot=rt+_e,at=it+et,lt=it-et;if(this.view!==null&&this.view.enabled){const ct=(this.right-this.left)/this.view.fullWidth/this.zoom,ut=(this.top-this.bottom)/this.view.fullHeight/this.zoom;st+=ct*this.view.offsetX,ot=st+ct*this.view.width,at-=ut*this.view.offsetY,lt=at-ut*this.view.height}this.projectionMatrix.makeOrthographic(st,ot,at,lt,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const et=super.toJSON(_e);return et.object.zoom=this.zoom,et.object.left=this.left,et.object.right=this.right,et.object.top=this.top,et.object.bottom=this.bottom,et.object.near=this.near,et.object.far=this.far,this.view!==null&&(et.object.view=Object.assign({},this.view)),et}};const LOD_MIN$1=4,EXTRA_LOD_SIGMA$1=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES$1=20,_flatCamera$1=new OrthographicCamera$1,_clearColor$1=new Color$2;let _oldTarget$1=null,_oldActiveCubeFace$1=0,_oldActiveMipmapLevel$1=0,_oldXrEnabled=!1;const PHI$1=(1+Math.sqrt(5))/2,INV_PHI$1=1/PHI$1,_axisDirections$1=[new Vector3$1(-PHI$1,INV_PHI$1,0),new Vector3$1(PHI$1,INV_PHI$1,0),new Vector3$1(-INV_PHI$1,0,PHI$1),new Vector3$1(INV_PHI$1,0,PHI$1),new Vector3$1(0,PHI$1,-INV_PHI$1),new Vector3$1(0,PHI$1,INV_PHI$1),new Vector3$1(-1,1,-1),new Vector3$1(1,1,-1),new Vector3$1(-1,1,1),new Vector3$1(1,1,1)];let PMREMGenerator$1=class{constructor(_e){this._renderer=_e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_e,et=0,rt=.1,it=100){_oldTarget$1=this._renderer.getRenderTarget(),_oldActiveCubeFace$1=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel$1=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const st=this._allocateTargets();return st.depthBuffer=!0,this._sceneToCubeUV(_e,rt,it,st),et>0&&this._blur(st,0,0,et),this._applyPMREM(st),this._cleanup(st),st}fromEquirectangular(_e,et=null){return this._fromTexture(_e,et)}fromCubemap(_e,et=null){return this._fromTexture(_e,et)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial$1(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial$1(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_e){this._lodMax=Math.floor(Math.log2(_e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _e=0;_e<this._lodPlanes.length;_e++)this._lodPlanes[_e].dispose()}_cleanup(_e){this._renderer.setRenderTarget(_oldTarget$1,_oldActiveCubeFace$1,_oldActiveMipmapLevel$1),this._renderer.xr.enabled=_oldXrEnabled,_e.scissorTest=!1,_setViewport$1(_e,0,0,_e.width,_e.height)}_fromTexture(_e,et){_e.mapping===CubeReflectionMapping$1||_e.mapping===CubeRefractionMapping$1?this._setSize(_e.image.length===0?16:_e.image[0].width||_e.image[0].image.width):this._setSize(_e.image.width/4),_oldTarget$1=this._renderer.getRenderTarget(),_oldActiveCubeFace$1=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel$1=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const rt=et||this._allocateTargets();return this._textureToCubeUV(_e,rt),this._applyPMREM(rt),this._cleanup(rt),rt}_allocateTargets(){const _e=3*Math.max(this._cubeSize,112),et=4*this._cubeSize,rt={magFilter:LinearFilter$1,minFilter:LinearFilter$1,generateMipmaps:!1,type:HalfFloatType$1,format:RGBAFormat$1,colorSpace:LinearSRGBColorSpace$2,depthBuffer:!1},it=_createRenderTarget$1(_e,et,rt);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_e||this._pingPongRenderTarget.height!==et){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget$1(_e,et,rt);const{_lodMax:st}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes$1(st)),this._blurMaterial=_getBlurShader$1(st,_e,et)}return it}_compileMaterial(_e){const et=new Mesh$1(this._lodPlanes[0],_e);this._renderer.compile(et,_flatCamera$1)}_sceneToCubeUV(_e,et,rt,it){const at=new PerspectiveCamera$2(90,1,et,rt),lt=[1,-1,1,1,1,1],ct=[1,1,1,-1,-1,-1],ut=this._renderer,ht=ut.autoClear,dt=ut.toneMapping;ut.getClearColor(_clearColor$1),ut.toneMapping=NoToneMapping$1,ut.autoClear=!1;const ft=new MeshBasicMaterial$1({name:"PMREM.Background",side:BackSide$1,depthWrite:!1,depthTest:!1}),pt=new Mesh$1(new BoxGeometry$1,ft);let mt=!1;const At=_e.background;At?At.isColor&&(ft.color.copy(At),_e.background=null,mt=!0):(ft.color.copy(_clearColor$1),mt=!0);for(let gt=0;gt<6;gt++){const bt=gt%3;bt===0?(at.up.set(0,lt[gt],0),at.lookAt(ct[gt],0,0)):bt===1?(at.up.set(0,0,lt[gt]),at.lookAt(0,ct[gt],0)):(at.up.set(0,lt[gt],0),at.lookAt(0,0,ct[gt]));const Tt=this._cubeSize;_setViewport$1(it,bt*Tt,gt>2?Tt:0,Tt,Tt),ut.setRenderTarget(it),mt&&ut.render(pt,at),ut.render(_e,at)}pt.geometry.dispose(),pt.material.dispose(),ut.toneMapping=dt,ut.autoClear=ht,_e.background=At}_textureToCubeUV(_e,et){const rt=this._renderer,it=_e.mapping===CubeReflectionMapping$1||_e.mapping===CubeRefractionMapping$1;it?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial$1()),this._cubemapMaterial.uniforms.flipEnvMap.value=_e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial$1());const st=it?this._cubemapMaterial:this._equirectMaterial,ot=new Mesh$1(this._lodPlanes[0],st),at=st.uniforms;at.envMap.value=_e;const lt=this._cubeSize;_setViewport$1(et,0,0,3*lt,2*lt),rt.setRenderTarget(et),rt.render(ot,_flatCamera$1)}_applyPMREM(_e){const et=this._renderer,rt=et.autoClear;et.autoClear=!1;const it=this._lodPlanes.length;for(let st=1;st<it;st++){const ot=Math.sqrt(this._sigmas[st]*this._sigmas[st]-this._sigmas[st-1]*this._sigmas[st-1]),at=_axisDirections$1[(it-st-1)%_axisDirections$1.length];this._blur(_e,st-1,st,ot,at)}et.autoClear=rt}_blur(_e,et,rt,it,st){const ot=this._pingPongRenderTarget;this._halfBlur(_e,ot,et,rt,it,"latitudinal",st),this._halfBlur(ot,_e,rt,rt,it,"longitudinal",st)}_halfBlur(_e,et,rt,it,st,ot,at){const lt=this._renderer,ct=this._blurMaterial;ot!=="latitudinal"&&ot!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ut=3,ht=new Mesh$1(this._lodPlanes[it],ct),dt=ct.uniforms,ft=this._sizeLods[rt]-1,pt=isFinite(st)?Math.PI/(2*ft):2*Math.PI/(2*MAX_SAMPLES$1-1),mt=st/pt,At=isFinite(st)?1+Math.floor(ut*mt):MAX_SAMPLES$1;At>MAX_SAMPLES$1&&console.warn(`sigmaRadians, ${st}, is too large and will clip, as it requested ${At} samples when the maximum is set to ${MAX_SAMPLES$1}`);const gt=[];let bt=0;for(let Lt=0;Lt<MAX_SAMPLES$1;++Lt){const $t=Lt/mt,kt=Math.exp(-$t*$t/2);gt.push(kt),Lt===0?bt+=kt:Lt<At&&(bt+=2*kt)}for(let Lt=0;Lt<gt.length;Lt++)gt[Lt]=gt[Lt]/bt;dt.envMap.value=_e.texture,dt.samples.value=At,dt.weights.value=gt,dt.latitudinal.value=ot==="latitudinal",at&&(dt.poleAxis.value=at);const{_lodMax:Tt}=this;dt.dTheta.value=pt,dt.mipInt.value=Tt-rt;const wt=this._sizeLods[it],Rt=3*wt*(it>Tt-LOD_MIN$1?it-Tt+LOD_MIN$1:0),It=4*(this._cubeSize-wt);_setViewport$1(et,Rt,It,3*wt,2*wt),lt.setRenderTarget(et),lt.render(ht,_flatCamera$1)}};function _createPlanes$1(nt){const _e=[],et=[],rt=[];let it=nt;const st=nt-LOD_MIN$1+1+EXTRA_LOD_SIGMA$1.length;for(let ot=0;ot<st;ot++){const at=Math.pow(2,it);et.push(at);let lt=1/at;ot>nt-LOD_MIN$1?lt=EXTRA_LOD_SIGMA$1[ot-nt+LOD_MIN$1-1]:ot===0&&(lt=0),rt.push(lt);const ct=1/(at-2),ut=-ct,ht=1+ct,dt=[ut,ut,ht,ut,ht,ht,ut,ut,ht,ht,ut,ht],ft=6,pt=6,mt=3,At=2,gt=1,bt=new Float32Array(mt*pt*ft),Tt=new Float32Array(At*pt*ft),wt=new Float32Array(gt*pt*ft);for(let It=0;It<ft;It++){const Lt=It%3*2/3-1,$t=It>2?0:-1,kt=[Lt,$t,0,Lt+2/3,$t,0,Lt+2/3,$t+1,0,Lt,$t,0,Lt+2/3,$t+1,0,Lt,$t+1,0];bt.set(kt,mt*pt*It),Tt.set(dt,At*pt*It);const Dt=[It,It,It,It,It,It];wt.set(Dt,gt*pt*It)}const Rt=new BufferGeometry$1;Rt.setAttribute("position",new BufferAttribute$1(bt,mt)),Rt.setAttribute("uv",new BufferAttribute$1(Tt,At)),Rt.setAttribute("faceIndex",new BufferAttribute$1(wt,gt)),_e.push(Rt),it>LOD_MIN$1&&it--}return{lodPlanes:_e,sizeLods:et,sigmas:rt}}function _createRenderTarget$1(nt,_e,et){const rt=new WebGLRenderTarget$1(nt,_e,et);return rt.texture.mapping=CubeUVReflectionMapping$1,rt.texture.name="PMREM.cubeUv",rt.scissorTest=!0,rt}function _setViewport$1(nt,_e,et,rt,it){nt.viewport.set(_e,et,rt,it),nt.scissor.set(_e,et,rt,it)}function _getBlurShader$1(nt,_e,et){const rt=new Float32Array(MAX_SAMPLES$1),it=new Vector3$1(0,1,0);return new ShaderMaterial$1({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES$1,CUBEUV_TEXEL_WIDTH:1/_e,CUBEUV_TEXEL_HEIGHT:1/et,CUBEUV_MAX_MIP:`${nt}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:rt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:it}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending$1,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial$1(){return new ShaderMaterial$1({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending$1,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial$1(){return new ShaderMaterial$1({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending$1,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(nt){let _e=new WeakMap,et=null;function rt(at){if(at&&at.isTexture){const lt=at.mapping,ct=lt===EquirectangularReflectionMapping$1||lt===EquirectangularRefractionMapping$1,ut=lt===CubeReflectionMapping$1||lt===CubeRefractionMapping$1;if(ct||ut){let ht=_e.get(at);const dt=ht!==void 0?ht.texture.pmremVersion:0;if(at.isRenderTargetTexture&&at.pmremVersion!==dt)return et===null&&(et=new PMREMGenerator$1(nt)),ht=ct?et.fromEquirectangular(at,ht):et.fromCubemap(at,ht),ht.texture.pmremVersion=at.pmremVersion,_e.set(at,ht),ht.texture;if(ht!==void 0)return ht.texture;{const ft=at.image;return ct&&ft&&ft.height>0||ut&&ft&&it(ft)?(et===null&&(et=new PMREMGenerator$1(nt)),ht=ct?et.fromEquirectangular(at):et.fromCubemap(at),ht.texture.pmremVersion=at.pmremVersion,_e.set(at,ht),at.addEventListener("dispose",st),ht.texture):null}}}return at}function it(at){let lt=0;const ct=6;for(let ut=0;ut<ct;ut++)at[ut]!==void 0&&lt++;return lt===ct}function st(at){const lt=at.target;lt.removeEventListener("dispose",st);const ct=_e.get(lt);ct!==void 0&&(_e.delete(lt),ct.dispose())}function ot(){_e=new WeakMap,et!==null&&(et.dispose(),et=null)}return{get:rt,dispose:ot}}function WebGLExtensions$1(nt){const _e={};function et(rt){if(_e[rt]!==void 0)return _e[rt];let it;switch(rt){case"WEBGL_depth_texture":it=nt.getExtension("WEBGL_depth_texture")||nt.getExtension("MOZ_WEBGL_depth_texture")||nt.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":it=nt.getExtension("EXT_texture_filter_anisotropic")||nt.getExtension("MOZ_EXT_texture_filter_anisotropic")||nt.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":it=nt.getExtension("WEBGL_compressed_texture_s3tc")||nt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||nt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":it=nt.getExtension("WEBGL_compressed_texture_pvrtc")||nt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:it=nt.getExtension(rt)}return _e[rt]=it,it}return{has:function(rt){return et(rt)!==null},init:function(){et("EXT_color_buffer_float"),et("WEBGL_clip_cull_distance"),et("OES_texture_float_linear"),et("EXT_color_buffer_half_float"),et("WEBGL_multisampled_render_to_texture"),et("WEBGL_render_shared_exponent")},get:function(rt){const it=et(rt);return it===null&&warnOnce$1("THREE.WebGLRenderer: "+rt+" extension not supported."),it}}}function WebGLGeometries(nt,_e,et,rt){const it={},st=new WeakMap;function ot(ht){const dt=ht.target;dt.index!==null&&_e.remove(dt.index);for(const pt in dt.attributes)_e.remove(dt.attributes[pt]);for(const pt in dt.morphAttributes){const mt=dt.morphAttributes[pt];for(let At=0,gt=mt.length;At<gt;At++)_e.remove(mt[At])}dt.removeEventListener("dispose",ot),delete it[dt.id];const ft=st.get(dt);ft&&(_e.remove(ft),st.delete(dt)),rt.releaseStatesOfGeometry(dt),dt.isInstancedBufferGeometry===!0&&delete dt._maxInstanceCount,et.memory.geometries--}function at(ht,dt){return it[dt.id]===!0||(dt.addEventListener("dispose",ot),it[dt.id]=!0,et.memory.geometries++),dt}function lt(ht){const dt=ht.attributes;for(const pt in dt)_e.update(dt[pt],nt.ARRAY_BUFFER);const ft=ht.morphAttributes;for(const pt in ft){const mt=ft[pt];for(let At=0,gt=mt.length;At<gt;At++)_e.update(mt[At],nt.ARRAY_BUFFER)}}function ct(ht){const dt=[],ft=ht.index,pt=ht.attributes.position;let mt=0;if(ft!==null){const bt=ft.array;mt=ft.version;for(let Tt=0,wt=bt.length;Tt<wt;Tt+=3){const Rt=bt[Tt+0],It=bt[Tt+1],Lt=bt[Tt+2];dt.push(Rt,It,It,Lt,Lt,Rt)}}else if(pt!==void 0){const bt=pt.array;mt=pt.version;for(let Tt=0,wt=bt.length/3-1;Tt<wt;Tt+=3){const Rt=Tt+0,It=Tt+1,Lt=Tt+2;dt.push(Rt,It,It,Lt,Lt,Rt)}}else return;const At=new(arrayNeedsUint32$2(dt)?Uint32BufferAttribute$1:Uint16BufferAttribute$1)(dt,1);At.version=mt;const gt=st.get(ht);gt&&_e.remove(gt),st.set(ht,At)}function ut(ht){const dt=st.get(ht);if(dt){const ft=ht.index;ft!==null&&dt.version<ft.version&&ct(ht)}else ct(ht);return st.get(ht)}return{get:at,update:lt,getWireframeAttribute:ut}}function WebGLIndexedBufferRenderer(nt,_e,et){let rt;function it(dt){rt=dt}let st,ot;function at(dt){st=dt.type,ot=dt.bytesPerElement}function lt(dt,ft){nt.drawElements(rt,ft,st,dt*ot),et.update(ft,rt,1)}function ct(dt,ft,pt){pt!==0&&(nt.drawElementsInstanced(rt,ft,st,dt*ot,pt),et.update(ft,rt,pt))}function ut(dt,ft,pt){if(pt===0)return;_e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(rt,ft,0,st,dt,0,pt);let At=0;for(let gt=0;gt<pt;gt++)At+=ft[gt];et.update(At,rt,1)}function ht(dt,ft,pt,mt){if(pt===0)return;const At=_e.get("WEBGL_multi_draw");if(At===null)for(let gt=0;gt<dt.length;gt++)ct(dt[gt]/ot,ft[gt],mt[gt]);else{At.multiDrawElementsInstancedWEBGL(rt,ft,0,st,dt,0,mt,0,pt);let gt=0;for(let bt=0;bt<pt;bt++)gt+=ft[bt];for(let bt=0;bt<mt.length;bt++)et.update(gt,rt,mt[bt])}}this.setMode=it,this.setIndex=at,this.render=lt,this.renderInstances=ct,this.renderMultiDraw=ut,this.renderMultiDrawInstances=ht}function WebGLInfo(nt){const _e={geometries:0,textures:0},et={frame:0,calls:0,triangles:0,points:0,lines:0};function rt(st,ot,at){switch(et.calls++,ot){case nt.TRIANGLES:et.triangles+=at*(st/3);break;case nt.LINES:et.lines+=at*(st/2);break;case nt.LINE_STRIP:et.lines+=at*(st-1);break;case nt.LINE_LOOP:et.lines+=at*st;break;case nt.POINTS:et.points+=at*st;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",ot);break}}function it(){et.calls=0,et.triangles=0,et.points=0,et.lines=0}return{memory:_e,render:et,programs:null,autoReset:!0,reset:it,update:rt}}function WebGLMorphtargets(nt,_e,et){const rt=new WeakMap,it=new Vector4$1;function st(ot,at,lt){const ct=ot.morphTargetInfluences,ut=at.morphAttributes.position||at.morphAttributes.normal||at.morphAttributes.color,ht=ut!==void 0?ut.length:0;let dt=rt.get(at);if(dt===void 0||dt.count!==ht){let Dt=function(){$t.dispose(),rt.delete(at),at.removeEventListener("dispose",Dt)};var ft=Dt;dt!==void 0&&dt.texture.dispose();const pt=at.morphAttributes.position!==void 0,mt=at.morphAttributes.normal!==void 0,At=at.morphAttributes.color!==void 0,gt=at.morphAttributes.position||[],bt=at.morphAttributes.normal||[],Tt=at.morphAttributes.color||[];let wt=0;pt===!0&&(wt=1),mt===!0&&(wt=2),At===!0&&(wt=3);let Rt=at.attributes.position.count*wt,It=1;Rt>_e.maxTextureSize&&(It=Math.ceil(Rt/_e.maxTextureSize),Rt=_e.maxTextureSize);const Lt=new Float32Array(Rt*It*4*ht),$t=new DataArrayTexture$1(Lt,Rt,It,ht);$t.type=FloatType$1,$t.needsUpdate=!0;const kt=wt*4;for(let Ot=0;Ot<ht;Ot++){const zt=gt[Ot],Ht=bt[Ot],Yt=Tt[Ot],Xt=Rt*It*4*Ot;for(let Zt=0;Zt<zt.count;Zt++){const rn=Zt*kt;pt===!0&&(it.fromBufferAttribute(zt,Zt),Lt[Xt+rn+0]=it.x,Lt[Xt+rn+1]=it.y,Lt[Xt+rn+2]=it.z,Lt[Xt+rn+3]=0),mt===!0&&(it.fromBufferAttribute(Ht,Zt),Lt[Xt+rn+4]=it.x,Lt[Xt+rn+5]=it.y,Lt[Xt+rn+6]=it.z,Lt[Xt+rn+7]=0),At===!0&&(it.fromBufferAttribute(Yt,Zt),Lt[Xt+rn+8]=it.x,Lt[Xt+rn+9]=it.y,Lt[Xt+rn+10]=it.z,Lt[Xt+rn+11]=Yt.itemSize===4?it.w:1)}}dt={count:ht,texture:$t,size:new Vector2$1(Rt,It)},rt.set(at,dt),at.addEventListener("dispose",Dt)}if(ot.isInstancedMesh===!0&&ot.morphTexture!==null)lt.getUniforms().setValue(nt,"morphTexture",ot.morphTexture,et);else{let pt=0;for(let At=0;At<ct.length;At++)pt+=ct[At];const mt=at.morphTargetsRelative?1:1-pt;lt.getUniforms().setValue(nt,"morphTargetBaseInfluence",mt),lt.getUniforms().setValue(nt,"morphTargetInfluences",ct)}lt.getUniforms().setValue(nt,"morphTargetsTexture",dt.texture,et),lt.getUniforms().setValue(nt,"morphTargetsTextureSize",dt.size)}return{update:st}}function WebGLObjects(nt,_e,et,rt){let it=new WeakMap;function st(lt){const ct=rt.render.frame,ut=lt.geometry,ht=_e.get(lt,ut);if(it.get(ht)!==ct&&(_e.update(ht),it.set(ht,ct)),lt.isInstancedMesh&&(lt.hasEventListener("dispose",at)===!1&&lt.addEventListener("dispose",at),it.get(lt)!==ct&&(et.update(lt.instanceMatrix,nt.ARRAY_BUFFER),lt.instanceColor!==null&&et.update(lt.instanceColor,nt.ARRAY_BUFFER),it.set(lt,ct))),lt.isSkinnedMesh){const dt=lt.skeleton;it.get(dt)!==ct&&(dt.update(),it.set(dt,ct))}return ht}function ot(){it=new WeakMap}function at(lt){const ct=lt.target;ct.removeEventListener("dispose",at),et.remove(ct.instanceMatrix),ct.instanceColor!==null&&et.remove(ct.instanceColor)}return{update:st,dispose:ot}}let DepthTexture$1=class extends Texture$1{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut=DepthFormat$1){if(ut!==DepthFormat$1&&ut!==DepthStencilFormat$1)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");rt===void 0&&ut===DepthFormat$1&&(rt=UnsignedIntType$1),rt===void 0&&ut===DepthStencilFormat$1&&(rt=UnsignedInt248Type$1),super(null,it,st,ot,at,lt,ut,rt,ct),this.isDepthTexture=!0,this.image={width:_e,height:et},this.magFilter=at!==void 0?at:NearestFilter$1,this.minFilter=lt!==void 0?lt:NearestFilter$1,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_e){return super.copy(_e),this.compareFunction=_e.compareFunction,this}toJSON(_e){const et=super.toJSON(_e);return this.compareFunction!==null&&(et.compareFunction=this.compareFunction),et}};const emptyTexture=new Texture$1,emptyShadowTexture=new DepthTexture$1(1,1),emptyArrayTexture=new DataArrayTexture$1,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture$1,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten$2(nt,_e,et){const rt=nt[0];if(rt<=0||rt>0)return nt;const it=_e*et;let st=arrayCacheF32[it];if(st===void 0&&(st=new Float32Array(it),arrayCacheF32[it]=st),_e!==0){rt.toArray(st,0);for(let ot=1,at=0;ot!==_e;++ot)at+=et,nt[ot].toArray(st,at)}return st}function arraysEqual$1(nt,_e){if(nt.length!==_e.length)return!1;for(let et=0,rt=nt.length;et<rt;et++)if(nt[et]!==_e[et])return!1;return!0}function copyArray(nt,_e){for(let et=0,rt=_e.length;et<rt;et++)nt[et]=_e[et]}function allocTexUnits(nt,_e){let et=arrayCacheI32[_e];et===void 0&&(et=new Int32Array(_e),arrayCacheI32[_e]=et);for(let rt=0;rt!==_e;++rt)et[rt]=nt.allocateTextureUnit();return et}function setValueV1f(nt,_e){const et=this.cache;et[0]!==_e&&(nt.uniform1f(this.addr,_e),et[0]=_e)}function setValueV2f(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y)&&(nt.uniform2f(this.addr,_e.x,_e.y),et[0]=_e.x,et[1]=_e.y);else{if(arraysEqual$1(et,_e))return;nt.uniform2fv(this.addr,_e),copyArray(et,_e)}}function setValueV3f(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y||et[2]!==_e.z)&&(nt.uniform3f(this.addr,_e.x,_e.y,_e.z),et[0]=_e.x,et[1]=_e.y,et[2]=_e.z);else if(_e.r!==void 0)(et[0]!==_e.r||et[1]!==_e.g||et[2]!==_e.b)&&(nt.uniform3f(this.addr,_e.r,_e.g,_e.b),et[0]=_e.r,et[1]=_e.g,et[2]=_e.b);else{if(arraysEqual$1(et,_e))return;nt.uniform3fv(this.addr,_e),copyArray(et,_e)}}function setValueV4f(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y||et[2]!==_e.z||et[3]!==_e.w)&&(nt.uniform4f(this.addr,_e.x,_e.y,_e.z,_e.w),et[0]=_e.x,et[1]=_e.y,et[2]=_e.z,et[3]=_e.w);else{if(arraysEqual$1(et,_e))return;nt.uniform4fv(this.addr,_e),copyArray(et,_e)}}function setValueM2(nt,_e){const et=this.cache,rt=_e.elements;if(rt===void 0){if(arraysEqual$1(et,_e))return;nt.uniformMatrix2fv(this.addr,!1,_e),copyArray(et,_e)}else{if(arraysEqual$1(et,rt))return;mat2array.set(rt),nt.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(et,rt)}}function setValueM3(nt,_e){const et=this.cache,rt=_e.elements;if(rt===void 0){if(arraysEqual$1(et,_e))return;nt.uniformMatrix3fv(this.addr,!1,_e),copyArray(et,_e)}else{if(arraysEqual$1(et,rt))return;mat3array.set(rt),nt.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(et,rt)}}function setValueM4(nt,_e){const et=this.cache,rt=_e.elements;if(rt===void 0){if(arraysEqual$1(et,_e))return;nt.uniformMatrix4fv(this.addr,!1,_e),copyArray(et,_e)}else{if(arraysEqual$1(et,rt))return;mat4array.set(rt),nt.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(et,rt)}}function setValueV1i(nt,_e){const et=this.cache;et[0]!==_e&&(nt.uniform1i(this.addr,_e),et[0]=_e)}function setValueV2i(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y)&&(nt.uniform2i(this.addr,_e.x,_e.y),et[0]=_e.x,et[1]=_e.y);else{if(arraysEqual$1(et,_e))return;nt.uniform2iv(this.addr,_e),copyArray(et,_e)}}function setValueV3i(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y||et[2]!==_e.z)&&(nt.uniform3i(this.addr,_e.x,_e.y,_e.z),et[0]=_e.x,et[1]=_e.y,et[2]=_e.z);else{if(arraysEqual$1(et,_e))return;nt.uniform3iv(this.addr,_e),copyArray(et,_e)}}function setValueV4i(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y||et[2]!==_e.z||et[3]!==_e.w)&&(nt.uniform4i(this.addr,_e.x,_e.y,_e.z,_e.w),et[0]=_e.x,et[1]=_e.y,et[2]=_e.z,et[3]=_e.w);else{if(arraysEqual$1(et,_e))return;nt.uniform4iv(this.addr,_e),copyArray(et,_e)}}function setValueV1ui(nt,_e){const et=this.cache;et[0]!==_e&&(nt.uniform1ui(this.addr,_e),et[0]=_e)}function setValueV2ui(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y)&&(nt.uniform2ui(this.addr,_e.x,_e.y),et[0]=_e.x,et[1]=_e.y);else{if(arraysEqual$1(et,_e))return;nt.uniform2uiv(this.addr,_e),copyArray(et,_e)}}function setValueV3ui(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y||et[2]!==_e.z)&&(nt.uniform3ui(this.addr,_e.x,_e.y,_e.z),et[0]=_e.x,et[1]=_e.y,et[2]=_e.z);else{if(arraysEqual$1(et,_e))return;nt.uniform3uiv(this.addr,_e),copyArray(et,_e)}}function setValueV4ui(nt,_e){const et=this.cache;if(_e.x!==void 0)(et[0]!==_e.x||et[1]!==_e.y||et[2]!==_e.z||et[3]!==_e.w)&&(nt.uniform4ui(this.addr,_e.x,_e.y,_e.z,_e.w),et[0]=_e.x,et[1]=_e.y,et[2]=_e.z,et[3]=_e.w);else{if(arraysEqual$1(et,_e))return;nt.uniform4uiv(this.addr,_e),copyArray(et,_e)}}function setValueT1(nt,_e,et){const rt=this.cache,it=et.allocateTextureUnit();rt[0]!==it&&(nt.uniform1i(this.addr,it),rt[0]=it);let st;this.type===nt.SAMPLER_2D_SHADOW?(emptyShadowTexture.compareFunction=LessEqualCompare$1,st=emptyShadowTexture):st=emptyTexture,et.setTexture2D(_e||st,it)}function setValueT3D1(nt,_e,et){const rt=this.cache,it=et.allocateTextureUnit();rt[0]!==it&&(nt.uniform1i(this.addr,it),rt[0]=it),et.setTexture3D(_e||empty3dTexture,it)}function setValueT6(nt,_e,et){const rt=this.cache,it=et.allocateTextureUnit();rt[0]!==it&&(nt.uniform1i(this.addr,it),rt[0]=it),et.setTextureCube(_e||emptyCubeTexture,it)}function setValueT2DArray1(nt,_e,et){const rt=this.cache,it=et.allocateTextureUnit();rt[0]!==it&&(nt.uniform1i(this.addr,it),rt[0]=it),et.setTexture2DArray(_e||emptyArrayTexture,it)}function getSingularSetter(nt){switch(nt){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(nt,_e){nt.uniform1fv(this.addr,_e)}function setValueV2fArray(nt,_e){const et=flatten$2(_e,this.size,2);nt.uniform2fv(this.addr,et)}function setValueV3fArray(nt,_e){const et=flatten$2(_e,this.size,3);nt.uniform3fv(this.addr,et)}function setValueV4fArray(nt,_e){const et=flatten$2(_e,this.size,4);nt.uniform4fv(this.addr,et)}function setValueM2Array(nt,_e){const et=flatten$2(_e,this.size,4);nt.uniformMatrix2fv(this.addr,!1,et)}function setValueM3Array(nt,_e){const et=flatten$2(_e,this.size,9);nt.uniformMatrix3fv(this.addr,!1,et)}function setValueM4Array(nt,_e){const et=flatten$2(_e,this.size,16);nt.uniformMatrix4fv(this.addr,!1,et)}function setValueV1iArray(nt,_e){nt.uniform1iv(this.addr,_e)}function setValueV2iArray(nt,_e){nt.uniform2iv(this.addr,_e)}function setValueV3iArray(nt,_e){nt.uniform3iv(this.addr,_e)}function setValueV4iArray(nt,_e){nt.uniform4iv(this.addr,_e)}function setValueV1uiArray(nt,_e){nt.uniform1uiv(this.addr,_e)}function setValueV2uiArray(nt,_e){nt.uniform2uiv(this.addr,_e)}function setValueV3uiArray(nt,_e){nt.uniform3uiv(this.addr,_e)}function setValueV4uiArray(nt,_e){nt.uniform4uiv(this.addr,_e)}function setValueT1Array(nt,_e,et){const rt=this.cache,it=_e.length,st=allocTexUnits(et,it);arraysEqual$1(rt,st)||(nt.uniform1iv(this.addr,st),copyArray(rt,st));for(let ot=0;ot!==it;++ot)et.setTexture2D(_e[ot]||emptyTexture,st[ot])}function setValueT3DArray(nt,_e,et){const rt=this.cache,it=_e.length,st=allocTexUnits(et,it);arraysEqual$1(rt,st)||(nt.uniform1iv(this.addr,st),copyArray(rt,st));for(let ot=0;ot!==it;++ot)et.setTexture3D(_e[ot]||empty3dTexture,st[ot])}function setValueT6Array(nt,_e,et){const rt=this.cache,it=_e.length,st=allocTexUnits(et,it);arraysEqual$1(rt,st)||(nt.uniform1iv(this.addr,st),copyArray(rt,st));for(let ot=0;ot!==it;++ot)et.setTextureCube(_e[ot]||emptyCubeTexture,st[ot])}function setValueT2DArrayArray(nt,_e,et){const rt=this.cache,it=_e.length,st=allocTexUnits(et,it);arraysEqual$1(rt,st)||(nt.uniform1iv(this.addr,st),copyArray(rt,st));for(let ot=0;ot!==it;++ot)et.setTexture2DArray(_e[ot]||emptyArrayTexture,st[ot])}function getPureArraySetter(nt){switch(nt){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_e,et,rt){this.id=_e,this.addr=rt,this.cache=[],this.type=et.type,this.setValue=getSingularSetter(et.type)}}class PureArrayUniform{constructor(_e,et,rt){this.id=_e,this.addr=rt,this.cache=[],this.type=et.type,this.size=et.size,this.setValue=getPureArraySetter(et.type)}}class StructuredUniform{constructor(_e){this.id=_e,this.seq=[],this.map={}}setValue(_e,et,rt){const it=this.seq;for(let st=0,ot=it.length;st!==ot;++st){const at=it[st];at.setValue(_e,et[at.id],rt)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(nt,_e){nt.seq.push(_e),nt.map[_e.id]=_e}function parseUniform(nt,_e,et){const rt=nt.name,it=rt.length;for(RePathPart.lastIndex=0;;){const st=RePathPart.exec(rt),ot=RePathPart.lastIndex;let at=st[1];const lt=st[2]==="]",ct=st[3];if(lt&&(at=at|0),ct===void 0||ct==="["&&ot+2===it){addUniform(et,ct===void 0?new SingleUniform(at,nt,_e):new PureArrayUniform(at,nt,_e));break}else{let ht=et.map[at];ht===void 0&&(ht=new StructuredUniform(at),addUniform(et,ht)),et=ht}}}class WebGLUniforms{constructor(_e,et){this.seq=[],this.map={};const rt=_e.getProgramParameter(et,_e.ACTIVE_UNIFORMS);for(let it=0;it<rt;++it){const st=_e.getActiveUniform(et,it),ot=_e.getUniformLocation(et,st.name);parseUniform(st,ot,this)}}setValue(_e,et,rt,it){const st=this.map[et];st!==void 0&&st.setValue(_e,rt,it)}setOptional(_e,et,rt){const it=et[rt];it!==void 0&&this.setValue(_e,rt,it)}static upload(_e,et,rt,it){for(let st=0,ot=et.length;st!==ot;++st){const at=et[st],lt=rt[at.id];lt.needsUpdate!==!1&&at.setValue(_e,lt.value,it)}}static seqWithValue(_e,et){const rt=[];for(let it=0,st=_e.length;it!==st;++it){const ot=_e[it];ot.id in et&&rt.push(ot)}return rt}}function WebGLShader(nt,_e,et){const rt=nt.createShader(_e);return nt.shaderSource(rt,et),nt.compileShader(rt),rt}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(nt,_e){const et=nt.split(`
`),rt=[],it=Math.max(_e-6,0),st=Math.min(_e+6,et.length);for(let ot=it;ot<st;ot++){const at=ot+1;rt.push(`${at===_e?">":" "} ${at}: ${et[ot]}`)}return rt.join(`
`)}function getEncodingComponents(nt){const _e=ColorManagement$1.getPrimaries(ColorManagement$1.workingColorSpace),et=ColorManagement$1.getPrimaries(nt);let rt;switch(_e===et?rt="":_e===P3Primaries$1&&et===Rec709Primaries$1?rt="LinearDisplayP3ToLinearSRGB":_e===Rec709Primaries$1&&et===P3Primaries$1&&(rt="LinearSRGBToLinearDisplayP3"),nt){case LinearSRGBColorSpace$2:case LinearDisplayP3ColorSpace$1:return[rt,"LinearTransferOETF"];case SRGBColorSpace$2:case DisplayP3ColorSpace$1:return[rt,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",nt),[rt,"LinearTransferOETF"]}}function getShaderErrors(nt,_e,et){const rt=nt.getShaderParameter(_e,nt.COMPILE_STATUS),it=nt.getShaderInfoLog(_e).trim();if(rt&&it==="")return"";const st=/ERROR: 0:(\d+)/.exec(it);if(st){const ot=parseInt(st[1]);return et.toUpperCase()+`

`+it+`

`+handleSource(nt.getShaderSource(_e),ot)}else return it}function getTexelEncodingFunction(nt,_e){const et=getEncodingComponents(_e);return`vec4 ${nt}( vec4 value ) { return ${et[0]}( ${et[1]}( value ) ); }`}function getToneMappingFunction(nt,_e){let et;switch(_e){case LinearToneMapping$1:et="Linear";break;case ReinhardToneMapping$1:et="Reinhard";break;case CineonToneMapping$1:et="Cineon";break;case ACESFilmicToneMapping$1:et="ACESFilmic";break;case AgXToneMapping$1:et="AgX";break;case NeutralToneMapping$1:et="Neutral";break;case CustomToneMapping:et="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_e),et="Linear"}return"vec3 "+nt+"( vec3 color ) { return "+et+"ToneMapping( color ); }"}const _v0$1$1=new Vector3$1;function getLuminanceFunction(){ColorManagement$1.getLuminanceCoefficients(_v0$1$1);const nt=_v0$1$1.x.toFixed(4),_e=_v0$1$1.y.toFixed(4),et=_v0$1$1.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${nt}, ${_e}, ${et} );`,"	return dot( weights, rgb );","}"].join(`
`)}function generateVertexExtensions(nt){return[nt.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",nt.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(nt){const _e=[];for(const et in nt){const rt=nt[et];rt!==!1&&_e.push("#define "+et+" "+rt)}return _e.join(`
`)}function fetchAttributeLocations(nt,_e){const et={},rt=nt.getProgramParameter(_e,nt.ACTIVE_ATTRIBUTES);for(let it=0;it<rt;it++){const st=nt.getActiveAttrib(_e,it),ot=st.name;let at=1;st.type===nt.FLOAT_MAT2&&(at=2),st.type===nt.FLOAT_MAT3&&(at=3),st.type===nt.FLOAT_MAT4&&(at=4),et[ot]={type:st.type,location:nt.getAttribLocation(_e,ot),locationSize:at}}return et}function filterEmptyLine(nt){return nt!==""}function replaceLightNums(nt,_e){const et=_e.numSpotLightShadows+_e.numSpotLightMaps-_e.numSpotLightShadowsWithMaps;return nt.replace(/NUM_DIR_LIGHTS/g,_e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,et).replace(/NUM_RECT_AREA_LIGHTS/g,_e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_e.numPointLightShadows)}function replaceClippingPlaneNums(nt,_e){return nt.replace(/NUM_CLIPPING_PLANES/g,_e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_e.numClippingPlanes-_e.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(nt){return nt.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(nt,_e){let et=ShaderChunk[_e];if(et===void 0){const rt=shaderChunkMap.get(_e);if(rt!==void 0)et=ShaderChunk[rt],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_e,rt);else throw new Error("Can not resolve #include <"+_e+">")}return resolveIncludes(et)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(nt){return nt.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(nt,_e,et,rt){let it="";for(let st=parseInt(_e);st<parseInt(et);st++)it+=rt.replace(/\[\s*i\s*\]/g,"[ "+st+" ]").replace(/UNROLLED_LOOP_INDEX/g,st);return it}function generatePrecision(nt){let _e=`precision ${nt.precision} float;
	precision ${nt.precision} int;
	precision ${nt.precision} sampler2D;
	precision ${nt.precision} samplerCube;
	precision ${nt.precision} sampler3D;
	precision ${nt.precision} sampler2DArray;
	precision ${nt.precision} sampler2DShadow;
	precision ${nt.precision} samplerCubeShadow;
	precision ${nt.precision} sampler2DArrayShadow;
	precision ${nt.precision} isampler2D;
	precision ${nt.precision} isampler3D;
	precision ${nt.precision} isamplerCube;
	precision ${nt.precision} isampler2DArray;
	precision ${nt.precision} usampler2D;
	precision ${nt.precision} usampler3D;
	precision ${nt.precision} usamplerCube;
	precision ${nt.precision} usampler2DArray;
	`;return nt.precision==="highp"?_e+=`
#define HIGH_PRECISION`:nt.precision==="mediump"?_e+=`
#define MEDIUM_PRECISION`:nt.precision==="lowp"&&(_e+=`
#define LOW_PRECISION`),_e}function generateShadowMapTypeDefine(nt){let _e="SHADOWMAP_TYPE_BASIC";return nt.shadowMapType===PCFShadowMap$2?_e="SHADOWMAP_TYPE_PCF":nt.shadowMapType===PCFSoftShadowMap$1?_e="SHADOWMAP_TYPE_PCF_SOFT":nt.shadowMapType===VSMShadowMap$1&&(_e="SHADOWMAP_TYPE_VSM"),_e}function generateEnvMapTypeDefine(nt){let _e="ENVMAP_TYPE_CUBE";if(nt.envMap)switch(nt.envMapMode){case CubeReflectionMapping$1:case CubeRefractionMapping$1:_e="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping$1:_e="ENVMAP_TYPE_CUBE_UV";break}return _e}function generateEnvMapModeDefine(nt){let _e="ENVMAP_MODE_REFLECTION";if(nt.envMap)switch(nt.envMapMode){case CubeRefractionMapping$1:_e="ENVMAP_MODE_REFRACTION";break}return _e}function generateEnvMapBlendingDefine(nt){let _e="ENVMAP_BLENDING_NONE";if(nt.envMap)switch(nt.combine){case MultiplyOperation$1:_e="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation$1:_e="ENVMAP_BLENDING_MIX";break;case AddOperation$1:_e="ENVMAP_BLENDING_ADD";break}return _e}function generateCubeUVSize(nt){const _e=nt.envMapCubeUVHeight;if(_e===null)return null;const et=Math.log2(_e)-2,rt=1/_e;return{texelWidth:1/(3*Math.max(Math.pow(2,et),7*16)),texelHeight:rt,maxMip:et}}function WebGLProgram(nt,_e,et,rt){const it=nt.getContext(),st=et.defines;let ot=et.vertexShader,at=et.fragmentShader;const lt=generateShadowMapTypeDefine(et),ct=generateEnvMapTypeDefine(et),ut=generateEnvMapModeDefine(et),ht=generateEnvMapBlendingDefine(et),dt=generateCubeUVSize(et),ft=generateVertexExtensions(et),pt=generateDefines(st),mt=it.createProgram();let At,gt,bt=et.glslVersion?"#version "+et.glslVersion+`
`:"";et.isRawShaderMaterial?(At=["#define SHADER_TYPE "+et.shaderType,"#define SHADER_NAME "+et.shaderName,pt].filter(filterEmptyLine).join(`
`),At.length>0&&(At+=`
`),gt=["#define SHADER_TYPE "+et.shaderType,"#define SHADER_NAME "+et.shaderName,pt].filter(filterEmptyLine).join(`
`),gt.length>0&&(gt+=`
`)):(At=[generatePrecision(et),"#define SHADER_TYPE "+et.shaderType,"#define SHADER_NAME "+et.shaderName,pt,et.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",et.batching?"#define USE_BATCHING":"",et.batchingColor?"#define USE_BATCHING_COLOR":"",et.instancing?"#define USE_INSTANCING":"",et.instancingColor?"#define USE_INSTANCING_COLOR":"",et.instancingMorph?"#define USE_INSTANCING_MORPH":"",et.useFog&&et.fog?"#define USE_FOG":"",et.useFog&&et.fogExp2?"#define FOG_EXP2":"",et.map?"#define USE_MAP":"",et.envMap?"#define USE_ENVMAP":"",et.envMap?"#define "+ut:"",et.lightMap?"#define USE_LIGHTMAP":"",et.aoMap?"#define USE_AOMAP":"",et.bumpMap?"#define USE_BUMPMAP":"",et.normalMap?"#define USE_NORMALMAP":"",et.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",et.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",et.displacementMap?"#define USE_DISPLACEMENTMAP":"",et.emissiveMap?"#define USE_EMISSIVEMAP":"",et.anisotropy?"#define USE_ANISOTROPY":"",et.anisotropyMap?"#define USE_ANISOTROPYMAP":"",et.clearcoatMap?"#define USE_CLEARCOATMAP":"",et.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",et.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",et.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",et.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",et.specularMap?"#define USE_SPECULARMAP":"",et.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",et.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",et.roughnessMap?"#define USE_ROUGHNESSMAP":"",et.metalnessMap?"#define USE_METALNESSMAP":"",et.alphaMap?"#define USE_ALPHAMAP":"",et.alphaHash?"#define USE_ALPHAHASH":"",et.transmission?"#define USE_TRANSMISSION":"",et.transmissionMap?"#define USE_TRANSMISSIONMAP":"",et.thicknessMap?"#define USE_THICKNESSMAP":"",et.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",et.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",et.mapUv?"#define MAP_UV "+et.mapUv:"",et.alphaMapUv?"#define ALPHAMAP_UV "+et.alphaMapUv:"",et.lightMapUv?"#define LIGHTMAP_UV "+et.lightMapUv:"",et.aoMapUv?"#define AOMAP_UV "+et.aoMapUv:"",et.emissiveMapUv?"#define EMISSIVEMAP_UV "+et.emissiveMapUv:"",et.bumpMapUv?"#define BUMPMAP_UV "+et.bumpMapUv:"",et.normalMapUv?"#define NORMALMAP_UV "+et.normalMapUv:"",et.displacementMapUv?"#define DISPLACEMENTMAP_UV "+et.displacementMapUv:"",et.metalnessMapUv?"#define METALNESSMAP_UV "+et.metalnessMapUv:"",et.roughnessMapUv?"#define ROUGHNESSMAP_UV "+et.roughnessMapUv:"",et.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+et.anisotropyMapUv:"",et.clearcoatMapUv?"#define CLEARCOATMAP_UV "+et.clearcoatMapUv:"",et.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+et.clearcoatNormalMapUv:"",et.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+et.clearcoatRoughnessMapUv:"",et.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+et.iridescenceMapUv:"",et.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+et.iridescenceThicknessMapUv:"",et.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+et.sheenColorMapUv:"",et.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+et.sheenRoughnessMapUv:"",et.specularMapUv?"#define SPECULARMAP_UV "+et.specularMapUv:"",et.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+et.specularColorMapUv:"",et.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+et.specularIntensityMapUv:"",et.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+et.transmissionMapUv:"",et.thicknessMapUv?"#define THICKNESSMAP_UV "+et.thicknessMapUv:"",et.vertexTangents&&et.flatShading===!1?"#define USE_TANGENT":"",et.vertexColors?"#define USE_COLOR":"",et.vertexAlphas?"#define USE_COLOR_ALPHA":"",et.vertexUv1s?"#define USE_UV1":"",et.vertexUv2s?"#define USE_UV2":"",et.vertexUv3s?"#define USE_UV3":"",et.pointsUvs?"#define USE_POINTS_UV":"",et.flatShading?"#define FLAT_SHADED":"",et.skinning?"#define USE_SKINNING":"",et.morphTargets?"#define USE_MORPHTARGETS":"",et.morphNormals&&et.flatShading===!1?"#define USE_MORPHNORMALS":"",et.morphColors?"#define USE_MORPHCOLORS":"",et.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+et.morphTextureStride:"",et.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+et.morphTargetsCount:"",et.doubleSided?"#define DOUBLE_SIDED":"",et.flipSided?"#define FLIP_SIDED":"",et.shadowMapEnabled?"#define USE_SHADOWMAP":"",et.shadowMapEnabled?"#define "+lt:"",et.sizeAttenuation?"#define USE_SIZEATTENUATION":"",et.numLightProbes>0?"#define USE_LIGHT_PROBES":"",et.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",et.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),gt=[generatePrecision(et),"#define SHADER_TYPE "+et.shaderType,"#define SHADER_NAME "+et.shaderName,pt,et.useFog&&et.fog?"#define USE_FOG":"",et.useFog&&et.fogExp2?"#define FOG_EXP2":"",et.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",et.map?"#define USE_MAP":"",et.matcap?"#define USE_MATCAP":"",et.envMap?"#define USE_ENVMAP":"",et.envMap?"#define "+ct:"",et.envMap?"#define "+ut:"",et.envMap?"#define "+ht:"",dt?"#define CUBEUV_TEXEL_WIDTH "+dt.texelWidth:"",dt?"#define CUBEUV_TEXEL_HEIGHT "+dt.texelHeight:"",dt?"#define CUBEUV_MAX_MIP "+dt.maxMip+".0":"",et.lightMap?"#define USE_LIGHTMAP":"",et.aoMap?"#define USE_AOMAP":"",et.bumpMap?"#define USE_BUMPMAP":"",et.normalMap?"#define USE_NORMALMAP":"",et.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",et.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",et.emissiveMap?"#define USE_EMISSIVEMAP":"",et.anisotropy?"#define USE_ANISOTROPY":"",et.anisotropyMap?"#define USE_ANISOTROPYMAP":"",et.clearcoat?"#define USE_CLEARCOAT":"",et.clearcoatMap?"#define USE_CLEARCOATMAP":"",et.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",et.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",et.dispersion?"#define USE_DISPERSION":"",et.iridescence?"#define USE_IRIDESCENCE":"",et.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",et.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",et.specularMap?"#define USE_SPECULARMAP":"",et.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",et.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",et.roughnessMap?"#define USE_ROUGHNESSMAP":"",et.metalnessMap?"#define USE_METALNESSMAP":"",et.alphaMap?"#define USE_ALPHAMAP":"",et.alphaTest?"#define USE_ALPHATEST":"",et.alphaHash?"#define USE_ALPHAHASH":"",et.sheen?"#define USE_SHEEN":"",et.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",et.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",et.transmission?"#define USE_TRANSMISSION":"",et.transmissionMap?"#define USE_TRANSMISSIONMAP":"",et.thicknessMap?"#define USE_THICKNESSMAP":"",et.vertexTangents&&et.flatShading===!1?"#define USE_TANGENT":"",et.vertexColors||et.instancingColor||et.batchingColor?"#define USE_COLOR":"",et.vertexAlphas?"#define USE_COLOR_ALPHA":"",et.vertexUv1s?"#define USE_UV1":"",et.vertexUv2s?"#define USE_UV2":"",et.vertexUv3s?"#define USE_UV3":"",et.pointsUvs?"#define USE_POINTS_UV":"",et.gradientMap?"#define USE_GRADIENTMAP":"",et.flatShading?"#define FLAT_SHADED":"",et.doubleSided?"#define DOUBLE_SIDED":"",et.flipSided?"#define FLIP_SIDED":"",et.shadowMapEnabled?"#define USE_SHADOWMAP":"",et.shadowMapEnabled?"#define "+lt:"",et.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",et.numLightProbes>0?"#define USE_LIGHT_PROBES":"",et.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",et.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",et.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",et.toneMapping!==NoToneMapping$1?"#define TONE_MAPPING":"",et.toneMapping!==NoToneMapping$1?ShaderChunk.tonemapping_pars_fragment:"",et.toneMapping!==NoToneMapping$1?getToneMappingFunction("toneMapping",et.toneMapping):"",et.dithering?"#define DITHERING":"",et.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",et.outputColorSpace),getLuminanceFunction(),et.useDepthPacking?"#define DEPTH_PACKING "+et.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),ot=resolveIncludes(ot),ot=replaceLightNums(ot,et),ot=replaceClippingPlaneNums(ot,et),at=resolveIncludes(at),at=replaceLightNums(at,et),at=replaceClippingPlaneNums(at,et),ot=unrollLoops(ot),at=unrollLoops(at),et.isRawShaderMaterial!==!0&&(bt=`#version 300 es
`,At=[ft,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+At,gt=["#define varying in",et.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",et.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+gt);const Tt=bt+At+ot,wt=bt+gt+at,Rt=WebGLShader(it,it.VERTEX_SHADER,Tt),It=WebGLShader(it,it.FRAGMENT_SHADER,wt);it.attachShader(mt,Rt),it.attachShader(mt,It),et.index0AttributeName!==void 0?it.bindAttribLocation(mt,0,et.index0AttributeName):et.morphTargets===!0&&it.bindAttribLocation(mt,0,"position"),it.linkProgram(mt);function Lt(Ot){if(nt.debug.checkShaderErrors){const zt=it.getProgramInfoLog(mt).trim(),Ht=it.getShaderInfoLog(Rt).trim(),Yt=it.getShaderInfoLog(It).trim();let Xt=!0,Zt=!0;if(it.getProgramParameter(mt,it.LINK_STATUS)===!1)if(Xt=!1,typeof nt.debug.onShaderError=="function")nt.debug.onShaderError(it,mt,Rt,It);else{const rn=getShaderErrors(it,Rt,"vertex"),Gt=getShaderErrors(it,It,"fragment");console.error("THREE.WebGLProgram: Shader Error "+it.getError()+" - VALIDATE_STATUS "+it.getProgramParameter(mt,it.VALIDATE_STATUS)+`

Material Name: `+Ot.name+`
Material Type: `+Ot.type+`

Program Info Log: `+zt+`
`+rn+`
`+Gt)}else zt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",zt):(Ht===""||Yt==="")&&(Zt=!1);Zt&&(Ot.diagnostics={runnable:Xt,programLog:zt,vertexShader:{log:Ht,prefix:At},fragmentShader:{log:Yt,prefix:gt}})}it.deleteShader(Rt),it.deleteShader(It),$t=new WebGLUniforms(it,mt),kt=fetchAttributeLocations(it,mt)}let $t;this.getUniforms=function(){return $t===void 0&&Lt(this),$t};let kt;this.getAttributes=function(){return kt===void 0&&Lt(this),kt};let Dt=et.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Dt===!1&&(Dt=it.getProgramParameter(mt,COMPLETION_STATUS_KHR)),Dt},this.destroy=function(){rt.releaseStatesOfProgram(this),it.deleteProgram(mt),this.program=void 0},this.type=et.shaderType,this.name=et.shaderName,this.id=programIdCount++,this.cacheKey=_e,this.usedTimes=1,this.program=mt,this.vertexShader=Rt,this.fragmentShader=It,this}let _id$1$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_e){const et=_e.vertexShader,rt=_e.fragmentShader,it=this._getShaderStage(et),st=this._getShaderStage(rt),ot=this._getShaderCacheForMaterial(_e);return ot.has(it)===!1&&(ot.add(it),it.usedTimes++),ot.has(st)===!1&&(ot.add(st),st.usedTimes++),this}remove(_e){const et=this.materialCache.get(_e);for(const rt of et)rt.usedTimes--,rt.usedTimes===0&&this.shaderCache.delete(rt.code);return this.materialCache.delete(_e),this}getVertexShaderID(_e){return this._getShaderStage(_e.vertexShader).id}getFragmentShaderID(_e){return this._getShaderStage(_e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_e){const et=this.materialCache;let rt=et.get(_e);return rt===void 0&&(rt=new Set,et.set(_e,rt)),rt}_getShaderStage(_e){const et=this.shaderCache;let rt=et.get(_e);return rt===void 0&&(rt=new WebGLShaderStage(_e),et.set(_e,rt)),rt}}class WebGLShaderStage{constructor(_e){this.id=_id$1$1++,this.code=_e,this.usedTimes=0}}function WebGLPrograms(nt,_e,et,rt,it,st,ot){const at=new Layers$1,lt=new WebGLShaderCache,ct=new Set,ut=[],ht=it.logarithmicDepthBuffer,dt=it.reverseDepthBuffer,ft=it.vertexTextures;let pt=it.precision;const mt={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function At(Dt){return ct.add(Dt),Dt===0?"uv":`uv${Dt}`}function gt(Dt,Ot,zt,Ht,Yt){const Xt=Ht.fog,Zt=Yt.geometry,rn=Dt.isMeshStandardMaterial?Ht.environment:null,Gt=(Dt.isMeshStandardMaterial?et:_e).get(Dt.envMap||rn),jt=Gt&&Gt.mapping===CubeUVReflectionMapping$1?Gt.image.height:null,Kt=mt[Dt.type];Dt.precision!==null&&(pt=it.getMaxPrecision(Dt.precision),pt!==Dt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Dt.precision,"not supported, using",pt,"instead."));const Jt=Zt.morphAttributes.position||Zt.morphAttributes.normal||Zt.morphAttributes.color,sn=Jt!==void 0?Jt.length:0;let hn=0;Zt.morphAttributes.position!==void 0&&(hn=1),Zt.morphAttributes.normal!==void 0&&(hn=2),Zt.morphAttributes.color!==void 0&&(hn=3);let an,pn,_n,yn;if(Kt){const Wr=ShaderLib[Kt];an=Wr.vertexShader,pn=Wr.fragmentShader}else an=Dt.vertexShader,pn=Dt.fragmentShader,lt.update(Dt),_n=lt.getVertexShaderID(Dt),yn=lt.getFragmentShaderID(Dt);const $n=nt.getRenderTarget(),Jn=Yt.isInstancedMesh===!0,Xn=Yt.isBatchedMesh===!0,Vn=!!Dt.map,En=!!Dt.matcap,dn=!!Gt,rr=!!Dt.aoMap,er=!!Dt.lightMap,Yn=!!Dt.bumpMap,ir=!!Dt.normalMap,Qn=!!Dt.displacementMap,sr=!!Dt.emissiveMap,un=!!Dt.metalnessMap,en=!!Dt.roughnessMap,wn=Dt.anisotropy>0,gn=Dt.clearcoat>0,Mn=Dt.dispersion>0,In=Dt.iridescence>0,gr=Dt.sheen>0,jn=Dt.transmission>0,hr=wn&&!!Dt.anisotropyMap,Tr=gn&&!!Dt.clearcoatMap,cr=gn&&!!Dt.clearcoatNormalMap,yr=gn&&!!Dt.clearcoatRoughnessMap,Rr=In&&!!Dt.iridescenceMap,br=In&&!!Dt.iridescenceThicknessMap,pr=gr&&!!Dt.sheenColorMap,vn=gr&&!!Dt.sheenRoughnessMap,qn=!!Dt.specularMap,vr=!!Dt.specularColorMap,Sn=!!Dt.specularIntensityMap,Ar=jn&&!!Dt.transmissionMap,Nn=jn&&!!Dt.thicknessMap,nr=!!Dt.gradientMap,Ir=!!Dt.alphaMap,Dn=Dt.alphaTest>0,Pr=!!Dt.alphaHash,jr=!!Dt.extensions;let Jr=NoToneMapping$1;Dt.toneMapped&&($n===null||$n.isXRRenderTarget===!0)&&(Jr=nt.toneMapping);const Lr={shaderID:Kt,shaderType:Dt.type,shaderName:Dt.name,vertexShader:an,fragmentShader:pn,defines:Dt.defines,customVertexShaderID:_n,customFragmentShaderID:yn,isRawShaderMaterial:Dt.isRawShaderMaterial===!0,glslVersion:Dt.glslVersion,precision:pt,batching:Xn,batchingColor:Xn&&Yt._colorsTexture!==null,instancing:Jn,instancingColor:Jn&&Yt.instanceColor!==null,instancingMorph:Jn&&Yt.morphTexture!==null,supportsVertexTextures:ft,outputColorSpace:$n===null?nt.outputColorSpace:$n.isXRRenderTarget===!0?$n.texture.colorSpace:LinearSRGBColorSpace$2,alphaToCoverage:!!Dt.alphaToCoverage,map:Vn,matcap:En,envMap:dn,envMapMode:dn&&Gt.mapping,envMapCubeUVHeight:jt,aoMap:rr,lightMap:er,bumpMap:Yn,normalMap:ir,displacementMap:ft&&Qn,emissiveMap:sr,normalMapObjectSpace:ir&&Dt.normalMapType===ObjectSpaceNormalMap$1,normalMapTangentSpace:ir&&Dt.normalMapType===TangentSpaceNormalMap$1,metalnessMap:un,roughnessMap:en,anisotropy:wn,anisotropyMap:hr,clearcoat:gn,clearcoatMap:Tr,clearcoatNormalMap:cr,clearcoatRoughnessMap:yr,dispersion:Mn,iridescence:In,iridescenceMap:Rr,iridescenceThicknessMap:br,sheen:gr,sheenColorMap:pr,sheenRoughnessMap:vn,specularMap:qn,specularColorMap:vr,specularIntensityMap:Sn,transmission:jn,transmissionMap:Ar,thicknessMap:Nn,gradientMap:nr,opaque:Dt.transparent===!1&&Dt.blending===NormalBlending$1&&Dt.alphaToCoverage===!1,alphaMap:Ir,alphaTest:Dn,alphaHash:Pr,combine:Dt.combine,mapUv:Vn&&At(Dt.map.channel),aoMapUv:rr&&At(Dt.aoMap.channel),lightMapUv:er&&At(Dt.lightMap.channel),bumpMapUv:Yn&&At(Dt.bumpMap.channel),normalMapUv:ir&&At(Dt.normalMap.channel),displacementMapUv:Qn&&At(Dt.displacementMap.channel),emissiveMapUv:sr&&At(Dt.emissiveMap.channel),metalnessMapUv:un&&At(Dt.metalnessMap.channel),roughnessMapUv:en&&At(Dt.roughnessMap.channel),anisotropyMapUv:hr&&At(Dt.anisotropyMap.channel),clearcoatMapUv:Tr&&At(Dt.clearcoatMap.channel),clearcoatNormalMapUv:cr&&At(Dt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:yr&&At(Dt.clearcoatRoughnessMap.channel),iridescenceMapUv:Rr&&At(Dt.iridescenceMap.channel),iridescenceThicknessMapUv:br&&At(Dt.iridescenceThicknessMap.channel),sheenColorMapUv:pr&&At(Dt.sheenColorMap.channel),sheenRoughnessMapUv:vn&&At(Dt.sheenRoughnessMap.channel),specularMapUv:qn&&At(Dt.specularMap.channel),specularColorMapUv:vr&&At(Dt.specularColorMap.channel),specularIntensityMapUv:Sn&&At(Dt.specularIntensityMap.channel),transmissionMapUv:Ar&&At(Dt.transmissionMap.channel),thicknessMapUv:Nn&&At(Dt.thicknessMap.channel),alphaMapUv:Ir&&At(Dt.alphaMap.channel),vertexTangents:!!Zt.attributes.tangent&&(ir||wn),vertexColors:Dt.vertexColors,vertexAlphas:Dt.vertexColors===!0&&!!Zt.attributes.color&&Zt.attributes.color.itemSize===4,pointsUvs:Yt.isPoints===!0&&!!Zt.attributes.uv&&(Vn||Ir),fog:!!Xt,useFog:Dt.fog===!0,fogExp2:!!Xt&&Xt.isFogExp2,flatShading:Dt.flatShading===!0,sizeAttenuation:Dt.sizeAttenuation===!0,logarithmicDepthBuffer:ht,reverseDepthBuffer:dt,skinning:Yt.isSkinnedMesh===!0,morphTargets:Zt.morphAttributes.position!==void 0,morphNormals:Zt.morphAttributes.normal!==void 0,morphColors:Zt.morphAttributes.color!==void 0,morphTargetsCount:sn,morphTextureStride:hn,numDirLights:Ot.directional.length,numPointLights:Ot.point.length,numSpotLights:Ot.spot.length,numSpotLightMaps:Ot.spotLightMap.length,numRectAreaLights:Ot.rectArea.length,numHemiLights:Ot.hemi.length,numDirLightShadows:Ot.directionalShadowMap.length,numPointLightShadows:Ot.pointShadowMap.length,numSpotLightShadows:Ot.spotShadowMap.length,numSpotLightShadowsWithMaps:Ot.numSpotLightShadowsWithMaps,numLightProbes:Ot.numLightProbes,numClippingPlanes:ot.numPlanes,numClipIntersection:ot.numIntersection,dithering:Dt.dithering,shadowMapEnabled:nt.shadowMap.enabled&&zt.length>0,shadowMapType:nt.shadowMap.type,toneMapping:Jr,decodeVideoTexture:Vn&&Dt.map.isVideoTexture===!0&&ColorManagement$1.getTransfer(Dt.map.colorSpace)===SRGBTransfer$1,premultipliedAlpha:Dt.premultipliedAlpha,doubleSided:Dt.side===DoubleSide$1,flipSided:Dt.side===BackSide$1,useDepthPacking:Dt.depthPacking>=0,depthPacking:Dt.depthPacking||0,index0AttributeName:Dt.index0AttributeName,extensionClipCullDistance:jr&&Dt.extensions.clipCullDistance===!0&&rt.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(jr&&Dt.extensions.multiDraw===!0||Xn)&&rt.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:rt.has("KHR_parallel_shader_compile"),customProgramCacheKey:Dt.customProgramCacheKey()};return Lr.vertexUv1s=ct.has(1),Lr.vertexUv2s=ct.has(2),Lr.vertexUv3s=ct.has(3),ct.clear(),Lr}function bt(Dt){const Ot=[];if(Dt.shaderID?Ot.push(Dt.shaderID):(Ot.push(Dt.customVertexShaderID),Ot.push(Dt.customFragmentShaderID)),Dt.defines!==void 0)for(const zt in Dt.defines)Ot.push(zt),Ot.push(Dt.defines[zt]);return Dt.isRawShaderMaterial===!1&&(Tt(Ot,Dt),wt(Ot,Dt),Ot.push(nt.outputColorSpace)),Ot.push(Dt.customProgramCacheKey),Ot.join()}function Tt(Dt,Ot){Dt.push(Ot.precision),Dt.push(Ot.outputColorSpace),Dt.push(Ot.envMapMode),Dt.push(Ot.envMapCubeUVHeight),Dt.push(Ot.mapUv),Dt.push(Ot.alphaMapUv),Dt.push(Ot.lightMapUv),Dt.push(Ot.aoMapUv),Dt.push(Ot.bumpMapUv),Dt.push(Ot.normalMapUv),Dt.push(Ot.displacementMapUv),Dt.push(Ot.emissiveMapUv),Dt.push(Ot.metalnessMapUv),Dt.push(Ot.roughnessMapUv),Dt.push(Ot.anisotropyMapUv),Dt.push(Ot.clearcoatMapUv),Dt.push(Ot.clearcoatNormalMapUv),Dt.push(Ot.clearcoatRoughnessMapUv),Dt.push(Ot.iridescenceMapUv),Dt.push(Ot.iridescenceThicknessMapUv),Dt.push(Ot.sheenColorMapUv),Dt.push(Ot.sheenRoughnessMapUv),Dt.push(Ot.specularMapUv),Dt.push(Ot.specularColorMapUv),Dt.push(Ot.specularIntensityMapUv),Dt.push(Ot.transmissionMapUv),Dt.push(Ot.thicknessMapUv),Dt.push(Ot.combine),Dt.push(Ot.fogExp2),Dt.push(Ot.sizeAttenuation),Dt.push(Ot.morphTargetsCount),Dt.push(Ot.morphAttributeCount),Dt.push(Ot.numDirLights),Dt.push(Ot.numPointLights),Dt.push(Ot.numSpotLights),Dt.push(Ot.numSpotLightMaps),Dt.push(Ot.numHemiLights),Dt.push(Ot.numRectAreaLights),Dt.push(Ot.numDirLightShadows),Dt.push(Ot.numPointLightShadows),Dt.push(Ot.numSpotLightShadows),Dt.push(Ot.numSpotLightShadowsWithMaps),Dt.push(Ot.numLightProbes),Dt.push(Ot.shadowMapType),Dt.push(Ot.toneMapping),Dt.push(Ot.numClippingPlanes),Dt.push(Ot.numClipIntersection),Dt.push(Ot.depthPacking)}function wt(Dt,Ot){at.disableAll(),Ot.supportsVertexTextures&&at.enable(0),Ot.instancing&&at.enable(1),Ot.instancingColor&&at.enable(2),Ot.instancingMorph&&at.enable(3),Ot.matcap&&at.enable(4),Ot.envMap&&at.enable(5),Ot.normalMapObjectSpace&&at.enable(6),Ot.normalMapTangentSpace&&at.enable(7),Ot.clearcoat&&at.enable(8),Ot.iridescence&&at.enable(9),Ot.alphaTest&&at.enable(10),Ot.vertexColors&&at.enable(11),Ot.vertexAlphas&&at.enable(12),Ot.vertexUv1s&&at.enable(13),Ot.vertexUv2s&&at.enable(14),Ot.vertexUv3s&&at.enable(15),Ot.vertexTangents&&at.enable(16),Ot.anisotropy&&at.enable(17),Ot.alphaHash&&at.enable(18),Ot.batching&&at.enable(19),Ot.dispersion&&at.enable(20),Ot.batchingColor&&at.enable(21),Dt.push(at.mask),at.disableAll(),Ot.fog&&at.enable(0),Ot.useFog&&at.enable(1),Ot.flatShading&&at.enable(2),Ot.logarithmicDepthBuffer&&at.enable(3),Ot.reverseDepthBuffer&&at.enable(4),Ot.skinning&&at.enable(5),Ot.morphTargets&&at.enable(6),Ot.morphNormals&&at.enable(7),Ot.morphColors&&at.enable(8),Ot.premultipliedAlpha&&at.enable(9),Ot.shadowMapEnabled&&at.enable(10),Ot.doubleSided&&at.enable(11),Ot.flipSided&&at.enable(12),Ot.useDepthPacking&&at.enable(13),Ot.dithering&&at.enable(14),Ot.transmission&&at.enable(15),Ot.sheen&&at.enable(16),Ot.opaque&&at.enable(17),Ot.pointsUvs&&at.enable(18),Ot.decodeVideoTexture&&at.enable(19),Ot.alphaToCoverage&&at.enable(20),Dt.push(at.mask)}function Rt(Dt){const Ot=mt[Dt.type];let zt;if(Ot){const Ht=ShaderLib[Ot];zt=UniformsUtils.clone(Ht.uniforms)}else zt=Dt.uniforms;return zt}function It(Dt,Ot){let zt;for(let Ht=0,Yt=ut.length;Ht<Yt;Ht++){const Xt=ut[Ht];if(Xt.cacheKey===Ot){zt=Xt,++zt.usedTimes;break}}return zt===void 0&&(zt=new WebGLProgram(nt,Ot,Dt,st),ut.push(zt)),zt}function Lt(Dt){if(--Dt.usedTimes===0){const Ot=ut.indexOf(Dt);ut[Ot]=ut[ut.length-1],ut.pop(),Dt.destroy()}}function $t(Dt){lt.remove(Dt)}function kt(){lt.dispose()}return{getParameters:gt,getProgramCacheKey:bt,getUniforms:Rt,acquireProgram:It,releaseProgram:Lt,releaseShaderCache:$t,programs:ut,dispose:kt}}function WebGLProperties(){let nt=new WeakMap;function _e(ot){return nt.has(ot)}function et(ot){let at=nt.get(ot);return at===void 0&&(at={},nt.set(ot,at)),at}function rt(ot){nt.delete(ot)}function it(ot,at,lt){nt.get(ot)[at]=lt}function st(){nt=new WeakMap}return{has:_e,get:et,remove:rt,update:it,dispose:st}}function painterSortStable$1(nt,_e){return nt.groupOrder!==_e.groupOrder?nt.groupOrder-_e.groupOrder:nt.renderOrder!==_e.renderOrder?nt.renderOrder-_e.renderOrder:nt.material.id!==_e.material.id?nt.material.id-_e.material.id:nt.z!==_e.z?nt.z-_e.z:nt.id-_e.id}function reversePainterSortStable$1(nt,_e){return nt.groupOrder!==_e.groupOrder?nt.groupOrder-_e.groupOrder:nt.renderOrder!==_e.renderOrder?nt.renderOrder-_e.renderOrder:nt.z!==_e.z?_e.z-nt.z:nt.id-_e.id}function WebGLRenderList(){const nt=[];let _e=0;const et=[],rt=[],it=[];function st(){_e=0,et.length=0,rt.length=0,it.length=0}function ot(ht,dt,ft,pt,mt,At){let gt=nt[_e];return gt===void 0?(gt={id:ht.id,object:ht,geometry:dt,material:ft,groupOrder:pt,renderOrder:ht.renderOrder,z:mt,group:At},nt[_e]=gt):(gt.id=ht.id,gt.object=ht,gt.geometry=dt,gt.material=ft,gt.groupOrder=pt,gt.renderOrder=ht.renderOrder,gt.z=mt,gt.group=At),_e++,gt}function at(ht,dt,ft,pt,mt,At){const gt=ot(ht,dt,ft,pt,mt,At);ft.transmission>0?rt.push(gt):ft.transparent===!0?it.push(gt):et.push(gt)}function lt(ht,dt,ft,pt,mt,At){const gt=ot(ht,dt,ft,pt,mt,At);ft.transmission>0?rt.unshift(gt):ft.transparent===!0?it.unshift(gt):et.unshift(gt)}function ct(ht,dt){et.length>1&&et.sort(ht||painterSortStable$1),rt.length>1&&rt.sort(dt||reversePainterSortStable$1),it.length>1&&it.sort(dt||reversePainterSortStable$1)}function ut(){for(let ht=_e,dt=nt.length;ht<dt;ht++){const ft=nt[ht];if(ft.id===null)break;ft.id=null,ft.object=null,ft.geometry=null,ft.material=null,ft.group=null}}return{opaque:et,transmissive:rt,transparent:it,init:st,push:at,unshift:lt,finish:ut,sort:ct}}function WebGLRenderLists(){let nt=new WeakMap;function _e(rt,it){const st=nt.get(rt);let ot;return st===void 0?(ot=new WebGLRenderList,nt.set(rt,[ot])):it>=st.length?(ot=new WebGLRenderList,st.push(ot)):ot=st[it],ot}function et(){nt=new WeakMap}return{get:_e,dispose:et}}function UniformsCache(){const nt={};return{get:function(_e){if(nt[_e.id]!==void 0)return nt[_e.id];let et;switch(_e.type){case"DirectionalLight":et={direction:new Vector3$1,color:new Color$2};break;case"SpotLight":et={position:new Vector3$1,direction:new Vector3$1,color:new Color$2,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":et={position:new Vector3$1,color:new Color$2,distance:0,decay:0};break;case"HemisphereLight":et={direction:new Vector3$1,skyColor:new Color$2,groundColor:new Color$2};break;case"RectAreaLight":et={color:new Color$2,position:new Vector3$1,halfWidth:new Vector3$1,halfHeight:new Vector3$1};break}return nt[_e.id]=et,et}}}function ShadowUniformsCache(){const nt={};return{get:function(_e){if(nt[_e.id]!==void 0)return nt[_e.id];let et;switch(_e.type){case"DirectionalLight":et={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2$1};break;case"SpotLight":et={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2$1};break;case"PointLight":et={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2$1,shadowCameraNear:1,shadowCameraFar:1e3};break}return nt[_e.id]=et,et}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(nt,_e){return(_e.castShadow?2:0)-(nt.castShadow?2:0)+(_e.map?1:0)-(nt.map?1:0)}function WebGLLights(nt){const _e=new UniformsCache,et=ShadowUniformsCache(),rt={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let ct=0;ct<9;ct++)rt.probe.push(new Vector3$1);const it=new Vector3$1,st=new Matrix4$1,ot=new Matrix4$1;function at(ct){let ut=0,ht=0,dt=0;for(let kt=0;kt<9;kt++)rt.probe[kt].set(0,0,0);let ft=0,pt=0,mt=0,At=0,gt=0,bt=0,Tt=0,wt=0,Rt=0,It=0,Lt=0;ct.sort(shadowCastingAndTexturingLightsFirst);for(let kt=0,Dt=ct.length;kt<Dt;kt++){const Ot=ct[kt],zt=Ot.color,Ht=Ot.intensity,Yt=Ot.distance,Xt=Ot.shadow&&Ot.shadow.map?Ot.shadow.map.texture:null;if(Ot.isAmbientLight)ut+=zt.r*Ht,ht+=zt.g*Ht,dt+=zt.b*Ht;else if(Ot.isLightProbe){for(let Zt=0;Zt<9;Zt++)rt.probe[Zt].addScaledVector(Ot.sh.coefficients[Zt],Ht);Lt++}else if(Ot.isDirectionalLight){const Zt=_e.get(Ot);if(Zt.color.copy(Ot.color).multiplyScalar(Ot.intensity),Ot.castShadow){const rn=Ot.shadow,Gt=et.get(Ot);Gt.shadowIntensity=rn.intensity,Gt.shadowBias=rn.bias,Gt.shadowNormalBias=rn.normalBias,Gt.shadowRadius=rn.radius,Gt.shadowMapSize=rn.mapSize,rt.directionalShadow[ft]=Gt,rt.directionalShadowMap[ft]=Xt,rt.directionalShadowMatrix[ft]=Ot.shadow.matrix,bt++}rt.directional[ft]=Zt,ft++}else if(Ot.isSpotLight){const Zt=_e.get(Ot);Zt.position.setFromMatrixPosition(Ot.matrixWorld),Zt.color.copy(zt).multiplyScalar(Ht),Zt.distance=Yt,Zt.coneCos=Math.cos(Ot.angle),Zt.penumbraCos=Math.cos(Ot.angle*(1-Ot.penumbra)),Zt.decay=Ot.decay,rt.spot[mt]=Zt;const rn=Ot.shadow;if(Ot.map&&(rt.spotLightMap[Rt]=Ot.map,Rt++,rn.updateMatrices(Ot),Ot.castShadow&&It++),rt.spotLightMatrix[mt]=rn.matrix,Ot.castShadow){const Gt=et.get(Ot);Gt.shadowIntensity=rn.intensity,Gt.shadowBias=rn.bias,Gt.shadowNormalBias=rn.normalBias,Gt.shadowRadius=rn.radius,Gt.shadowMapSize=rn.mapSize,rt.spotShadow[mt]=Gt,rt.spotShadowMap[mt]=Xt,wt++}mt++}else if(Ot.isRectAreaLight){const Zt=_e.get(Ot);Zt.color.copy(zt).multiplyScalar(Ht),Zt.halfWidth.set(Ot.width*.5,0,0),Zt.halfHeight.set(0,Ot.height*.5,0),rt.rectArea[At]=Zt,At++}else if(Ot.isPointLight){const Zt=_e.get(Ot);if(Zt.color.copy(Ot.color).multiplyScalar(Ot.intensity),Zt.distance=Ot.distance,Zt.decay=Ot.decay,Ot.castShadow){const rn=Ot.shadow,Gt=et.get(Ot);Gt.shadowIntensity=rn.intensity,Gt.shadowBias=rn.bias,Gt.shadowNormalBias=rn.normalBias,Gt.shadowRadius=rn.radius,Gt.shadowMapSize=rn.mapSize,Gt.shadowCameraNear=rn.camera.near,Gt.shadowCameraFar=rn.camera.far,rt.pointShadow[pt]=Gt,rt.pointShadowMap[pt]=Xt,rt.pointShadowMatrix[pt]=Ot.shadow.matrix,Tt++}rt.point[pt]=Zt,pt++}else if(Ot.isHemisphereLight){const Zt=_e.get(Ot);Zt.skyColor.copy(Ot.color).multiplyScalar(Ht),Zt.groundColor.copy(Ot.groundColor).multiplyScalar(Ht),rt.hemi[gt]=Zt,gt++}}At>0&&(nt.has("OES_texture_float_linear")===!0?(rt.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,rt.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(rt.rectAreaLTC1=UniformsLib.LTC_HALF_1,rt.rectAreaLTC2=UniformsLib.LTC_HALF_2)),rt.ambient[0]=ut,rt.ambient[1]=ht,rt.ambient[2]=dt;const $t=rt.hash;($t.directionalLength!==ft||$t.pointLength!==pt||$t.spotLength!==mt||$t.rectAreaLength!==At||$t.hemiLength!==gt||$t.numDirectionalShadows!==bt||$t.numPointShadows!==Tt||$t.numSpotShadows!==wt||$t.numSpotMaps!==Rt||$t.numLightProbes!==Lt)&&(rt.directional.length=ft,rt.spot.length=mt,rt.rectArea.length=At,rt.point.length=pt,rt.hemi.length=gt,rt.directionalShadow.length=bt,rt.directionalShadowMap.length=bt,rt.pointShadow.length=Tt,rt.pointShadowMap.length=Tt,rt.spotShadow.length=wt,rt.spotShadowMap.length=wt,rt.directionalShadowMatrix.length=bt,rt.pointShadowMatrix.length=Tt,rt.spotLightMatrix.length=wt+Rt-It,rt.spotLightMap.length=Rt,rt.numSpotLightShadowsWithMaps=It,rt.numLightProbes=Lt,$t.directionalLength=ft,$t.pointLength=pt,$t.spotLength=mt,$t.rectAreaLength=At,$t.hemiLength=gt,$t.numDirectionalShadows=bt,$t.numPointShadows=Tt,$t.numSpotShadows=wt,$t.numSpotMaps=Rt,$t.numLightProbes=Lt,rt.version=nextVersion++)}function lt(ct,ut){let ht=0,dt=0,ft=0,pt=0,mt=0;const At=ut.matrixWorldInverse;for(let gt=0,bt=ct.length;gt<bt;gt++){const Tt=ct[gt];if(Tt.isDirectionalLight){const wt=rt.directional[ht];wt.direction.setFromMatrixPosition(Tt.matrixWorld),it.setFromMatrixPosition(Tt.target.matrixWorld),wt.direction.sub(it),wt.direction.transformDirection(At),ht++}else if(Tt.isSpotLight){const wt=rt.spot[ft];wt.position.setFromMatrixPosition(Tt.matrixWorld),wt.position.applyMatrix4(At),wt.direction.setFromMatrixPosition(Tt.matrixWorld),it.setFromMatrixPosition(Tt.target.matrixWorld),wt.direction.sub(it),wt.direction.transformDirection(At),ft++}else if(Tt.isRectAreaLight){const wt=rt.rectArea[pt];wt.position.setFromMatrixPosition(Tt.matrixWorld),wt.position.applyMatrix4(At),ot.identity(),st.copy(Tt.matrixWorld),st.premultiply(At),ot.extractRotation(st),wt.halfWidth.set(Tt.width*.5,0,0),wt.halfHeight.set(0,Tt.height*.5,0),wt.halfWidth.applyMatrix4(ot),wt.halfHeight.applyMatrix4(ot),pt++}else if(Tt.isPointLight){const wt=rt.point[dt];wt.position.setFromMatrixPosition(Tt.matrixWorld),wt.position.applyMatrix4(At),dt++}else if(Tt.isHemisphereLight){const wt=rt.hemi[mt];wt.direction.setFromMatrixPosition(Tt.matrixWorld),wt.direction.transformDirection(At),mt++}}}return{setup:at,setupView:lt,state:rt}}function WebGLRenderState(nt){const _e=new WebGLLights(nt),et=[],rt=[];function it(ut){ct.camera=ut,et.length=0,rt.length=0}function st(ut){et.push(ut)}function ot(ut){rt.push(ut)}function at(){_e.setup(et)}function lt(ut){_e.setupView(et,ut)}const ct={lightsArray:et,shadowsArray:rt,camera:null,lights:_e,transmissionRenderTarget:{}};return{init:it,state:ct,setupLights:at,setupLightsView:lt,pushLight:st,pushShadow:ot}}function WebGLRenderStates(nt){let _e=new WeakMap;function et(it,st=0){const ot=_e.get(it);let at;return ot===void 0?(at=new WebGLRenderState(nt),_e.set(it,[at])):st>=ot.length?(at=new WebGLRenderState(nt),ot.push(at)):at=ot[st],at}function rt(){_e=new WeakMap}return{get:et,dispose:rt}}class MeshDepthMaterial extends Material$1{constructor(_e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.depthPacking=_e.depthPacking,this.map=_e.map,this.alphaMap=_e.alphaMap,this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material$1{constructor(_e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_e)}copy(_e){return super.copy(_e),this.map=_e.map,this.alphaMap=_e.alphaMap,this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(nt,_e,et){let rt=new Frustum$1;const it=new Vector2$1,st=new Vector2$1,ot=new Vector4$1,at=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),lt=new MeshDistanceMaterial,ct={},ut=et.maxTextureSize,ht={[FrontSide$1]:BackSide$1,[BackSide$1]:FrontSide$1,[DoubleSide$1]:DoubleSide$1},dt=new ShaderMaterial$1({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2$1},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),ft=dt.clone();ft.defines.HORIZONTAL_PASS=1;const pt=new BufferGeometry$1;pt.setAttribute("position",new BufferAttribute$1(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const mt=new Mesh$1(pt,dt),At=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap$2;let gt=this.type;this.render=function(It,Lt,$t){if(At.enabled===!1||At.autoUpdate===!1&&At.needsUpdate===!1||It.length===0)return;const kt=nt.getRenderTarget(),Dt=nt.getActiveCubeFace(),Ot=nt.getActiveMipmapLevel(),zt=nt.state;zt.setBlending(NoBlending$1),zt.buffers.color.setClear(1,1,1,1),zt.buffers.depth.setTest(!0),zt.setScissorTest(!1);const Ht=gt!==VSMShadowMap$1&&this.type===VSMShadowMap$1,Yt=gt===VSMShadowMap$1&&this.type!==VSMShadowMap$1;for(let Xt=0,Zt=It.length;Xt<Zt;Xt++){const rn=It[Xt],Gt=rn.shadow;if(Gt===void 0){console.warn("THREE.WebGLShadowMap:",rn,"has no shadow.");continue}if(Gt.autoUpdate===!1&&Gt.needsUpdate===!1)continue;it.copy(Gt.mapSize);const jt=Gt.getFrameExtents();if(it.multiply(jt),st.copy(Gt.mapSize),(it.x>ut||it.y>ut)&&(it.x>ut&&(st.x=Math.floor(ut/jt.x),it.x=st.x*jt.x,Gt.mapSize.x=st.x),it.y>ut&&(st.y=Math.floor(ut/jt.y),it.y=st.y*jt.y,Gt.mapSize.y=st.y)),Gt.map===null||Ht===!0||Yt===!0){const Jt=this.type!==VSMShadowMap$1?{minFilter:NearestFilter$1,magFilter:NearestFilter$1}:{};Gt.map!==null&&Gt.map.dispose(),Gt.map=new WebGLRenderTarget$1(it.x,it.y,Jt),Gt.map.texture.name=rn.name+".shadowMap",Gt.camera.updateProjectionMatrix()}nt.setRenderTarget(Gt.map),nt.clear();const Kt=Gt.getViewportCount();for(let Jt=0;Jt<Kt;Jt++){const sn=Gt.getViewport(Jt);ot.set(st.x*sn.x,st.y*sn.y,st.x*sn.z,st.y*sn.w),zt.viewport(ot),Gt.updateMatrices(rn,Jt),rt=Gt.getFrustum(),wt(Lt,$t,Gt.camera,rn,this.type)}Gt.isPointLightShadow!==!0&&this.type===VSMShadowMap$1&&bt(Gt,$t),Gt.needsUpdate=!1}gt=this.type,At.needsUpdate=!1,nt.setRenderTarget(kt,Dt,Ot)};function bt(It,Lt){const $t=_e.update(mt);dt.defines.VSM_SAMPLES!==It.blurSamples&&(dt.defines.VSM_SAMPLES=It.blurSamples,ft.defines.VSM_SAMPLES=It.blurSamples,dt.needsUpdate=!0,ft.needsUpdate=!0),It.mapPass===null&&(It.mapPass=new WebGLRenderTarget$1(it.x,it.y)),dt.uniforms.shadow_pass.value=It.map.texture,dt.uniforms.resolution.value=It.mapSize,dt.uniforms.radius.value=It.radius,nt.setRenderTarget(It.mapPass),nt.clear(),nt.renderBufferDirect(Lt,null,$t,dt,mt,null),ft.uniforms.shadow_pass.value=It.mapPass.texture,ft.uniforms.resolution.value=It.mapSize,ft.uniforms.radius.value=It.radius,nt.setRenderTarget(It.map),nt.clear(),nt.renderBufferDirect(Lt,null,$t,ft,mt,null)}function Tt(It,Lt,$t,kt){let Dt=null;const Ot=$t.isPointLight===!0?It.customDistanceMaterial:It.customDepthMaterial;if(Ot!==void 0)Dt=Ot;else if(Dt=$t.isPointLight===!0?lt:at,nt.localClippingEnabled&&Lt.clipShadows===!0&&Array.isArray(Lt.clippingPlanes)&&Lt.clippingPlanes.length!==0||Lt.displacementMap&&Lt.displacementScale!==0||Lt.alphaMap&&Lt.alphaTest>0||Lt.map&&Lt.alphaTest>0){const zt=Dt.uuid,Ht=Lt.uuid;let Yt=ct[zt];Yt===void 0&&(Yt={},ct[zt]=Yt);let Xt=Yt[Ht];Xt===void 0&&(Xt=Dt.clone(),Yt[Ht]=Xt,Lt.addEventListener("dispose",Rt)),Dt=Xt}if(Dt.visible=Lt.visible,Dt.wireframe=Lt.wireframe,kt===VSMShadowMap$1?Dt.side=Lt.shadowSide!==null?Lt.shadowSide:Lt.side:Dt.side=Lt.shadowSide!==null?Lt.shadowSide:ht[Lt.side],Dt.alphaMap=Lt.alphaMap,Dt.alphaTest=Lt.alphaTest,Dt.map=Lt.map,Dt.clipShadows=Lt.clipShadows,Dt.clippingPlanes=Lt.clippingPlanes,Dt.clipIntersection=Lt.clipIntersection,Dt.displacementMap=Lt.displacementMap,Dt.displacementScale=Lt.displacementScale,Dt.displacementBias=Lt.displacementBias,Dt.wireframeLinewidth=Lt.wireframeLinewidth,Dt.linewidth=Lt.linewidth,$t.isPointLight===!0&&Dt.isMeshDistanceMaterial===!0){const zt=nt.properties.get(Dt);zt.light=$t}return Dt}function wt(It,Lt,$t,kt,Dt){if(It.visible===!1)return;if(It.layers.test(Lt.layers)&&(It.isMesh||It.isLine||It.isPoints)&&(It.castShadow||It.receiveShadow&&Dt===VSMShadowMap$1)&&(!It.frustumCulled||rt.intersectsObject(It))){It.modelViewMatrix.multiplyMatrices($t.matrixWorldInverse,It.matrixWorld);const Ht=_e.update(It),Yt=It.material;if(Array.isArray(Yt)){const Xt=Ht.groups;for(let Zt=0,rn=Xt.length;Zt<rn;Zt++){const Gt=Xt[Zt],jt=Yt[Gt.materialIndex];if(jt&&jt.visible){const Kt=Tt(It,jt,kt,Dt);It.onBeforeShadow(nt,It,Lt,$t,Ht,Kt,Gt),nt.renderBufferDirect($t,null,Ht,Kt,It,Gt),It.onAfterShadow(nt,It,Lt,$t,Ht,Kt,Gt)}}}else if(Yt.visible){const Xt=Tt(It,Yt,kt,Dt);It.onBeforeShadow(nt,It,Lt,$t,Ht,Xt,null),nt.renderBufferDirect($t,null,Ht,Xt,It,null),It.onAfterShadow(nt,It,Lt,$t,Ht,Xt,null)}}const zt=It.children;for(let Ht=0,Yt=zt.length;Ht<Yt;Ht++)wt(zt[Ht],Lt,$t,kt,Dt)}function Rt(It){It.target.removeEventListener("dispose",Rt);for(const $t in ct){const kt=ct[$t],Dt=It.target.uuid;Dt in kt&&(kt[Dt].dispose(),delete kt[Dt])}}}const reversedFuncs={[NeverDepth$1]:AlwaysDepth$1,[LessDepth$1]:GreaterDepth$1,[EqualDepth$1]:NotEqualDepth$1,[LessEqualDepth$1]:GreaterEqualDepth$1,[AlwaysDepth$1]:NeverDepth$1,[GreaterDepth$1]:LessDepth$1,[NotEqualDepth$1]:EqualDepth$1,[GreaterEqualDepth$1]:LessEqualDepth$1};function WebGLState$1(nt){function _e(){let Sn=!1;const Ar=new Vector4$1;let Nn=null;const nr=new Vector4$1(0,0,0,0);return{setMask:function(Ir){Nn!==Ir&&!Sn&&(nt.colorMask(Ir,Ir,Ir,Ir),Nn=Ir)},setLocked:function(Ir){Sn=Ir},setClear:function(Ir,Dn,Pr,jr,Jr){Jr===!0&&(Ir*=jr,Dn*=jr,Pr*=jr),Ar.set(Ir,Dn,Pr,jr),nr.equals(Ar)===!1&&(nt.clearColor(Ir,Dn,Pr,jr),nr.copy(Ar))},reset:function(){Sn=!1,Nn=null,nr.set(-1,0,0,0)}}}function et(){let Sn=!1,Ar=!1,Nn=null,nr=null,Ir=null;return{setReversed:function(Dn){Ar=Dn},setTest:function(Dn){Dn?_n(nt.DEPTH_TEST):yn(nt.DEPTH_TEST)},setMask:function(Dn){Nn!==Dn&&!Sn&&(nt.depthMask(Dn),Nn=Dn)},setFunc:function(Dn){if(Ar&&(Dn=reversedFuncs[Dn]),nr!==Dn){switch(Dn){case NeverDepth$1:nt.depthFunc(nt.NEVER);break;case AlwaysDepth$1:nt.depthFunc(nt.ALWAYS);break;case LessDepth$1:nt.depthFunc(nt.LESS);break;case LessEqualDepth$1:nt.depthFunc(nt.LEQUAL);break;case EqualDepth$1:nt.depthFunc(nt.EQUAL);break;case GreaterEqualDepth$1:nt.depthFunc(nt.GEQUAL);break;case GreaterDepth$1:nt.depthFunc(nt.GREATER);break;case NotEqualDepth$1:nt.depthFunc(nt.NOTEQUAL);break;default:nt.depthFunc(nt.LEQUAL)}nr=Dn}},setLocked:function(Dn){Sn=Dn},setClear:function(Dn){Ir!==Dn&&(nt.clearDepth(Dn),Ir=Dn)},reset:function(){Sn=!1,Nn=null,nr=null,Ir=null}}}function rt(){let Sn=!1,Ar=null,Nn=null,nr=null,Ir=null,Dn=null,Pr=null,jr=null,Jr=null;return{setTest:function(Lr){Sn||(Lr?_n(nt.STENCIL_TEST):yn(nt.STENCIL_TEST))},setMask:function(Lr){Ar!==Lr&&!Sn&&(nt.stencilMask(Lr),Ar=Lr)},setFunc:function(Lr,Wr,As){(Nn!==Lr||nr!==Wr||Ir!==As)&&(nt.stencilFunc(Lr,Wr,As),Nn=Lr,nr=Wr,Ir=As)},setOp:function(Lr,Wr,As){(Dn!==Lr||Pr!==Wr||jr!==As)&&(nt.stencilOp(Lr,Wr,As),Dn=Lr,Pr=Wr,jr=As)},setLocked:function(Lr){Sn=Lr},setClear:function(Lr){Jr!==Lr&&(nt.clearStencil(Lr),Jr=Lr)},reset:function(){Sn=!1,Ar=null,Nn=null,nr=null,Ir=null,Dn=null,Pr=null,jr=null,Jr=null}}}const it=new _e,st=new et,ot=new rt,at=new WeakMap,lt=new WeakMap;let ct={},ut={},ht=new WeakMap,dt=[],ft=null,pt=!1,mt=null,At=null,gt=null,bt=null,Tt=null,wt=null,Rt=null,It=new Color$2(0,0,0),Lt=0,$t=!1,kt=null,Dt=null,Ot=null,zt=null,Ht=null;const Yt=nt.getParameter(nt.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Xt=!1,Zt=0;const rn=nt.getParameter(nt.VERSION);rn.indexOf("WebGL")!==-1?(Zt=parseFloat(/^WebGL (\d)/.exec(rn)[1]),Xt=Zt>=1):rn.indexOf("OpenGL ES")!==-1&&(Zt=parseFloat(/^OpenGL ES (\d)/.exec(rn)[1]),Xt=Zt>=2);let Gt=null,jt={};const Kt=nt.getParameter(nt.SCISSOR_BOX),Jt=nt.getParameter(nt.VIEWPORT),sn=new Vector4$1().fromArray(Kt),hn=new Vector4$1().fromArray(Jt);function an(Sn,Ar,Nn,nr){const Ir=new Uint8Array(4),Dn=nt.createTexture();nt.bindTexture(Sn,Dn),nt.texParameteri(Sn,nt.TEXTURE_MIN_FILTER,nt.NEAREST),nt.texParameteri(Sn,nt.TEXTURE_MAG_FILTER,nt.NEAREST);for(let Pr=0;Pr<Nn;Pr++)Sn===nt.TEXTURE_3D||Sn===nt.TEXTURE_2D_ARRAY?nt.texImage3D(Ar,0,nt.RGBA,1,1,nr,0,nt.RGBA,nt.UNSIGNED_BYTE,Ir):nt.texImage2D(Ar+Pr,0,nt.RGBA,1,1,0,nt.RGBA,nt.UNSIGNED_BYTE,Ir);return Dn}const pn={};pn[nt.TEXTURE_2D]=an(nt.TEXTURE_2D,nt.TEXTURE_2D,1),pn[nt.TEXTURE_CUBE_MAP]=an(nt.TEXTURE_CUBE_MAP,nt.TEXTURE_CUBE_MAP_POSITIVE_X,6),pn[nt.TEXTURE_2D_ARRAY]=an(nt.TEXTURE_2D_ARRAY,nt.TEXTURE_2D_ARRAY,1,1),pn[nt.TEXTURE_3D]=an(nt.TEXTURE_3D,nt.TEXTURE_3D,1,1),it.setClear(0,0,0,1),st.setClear(1),ot.setClear(0),_n(nt.DEPTH_TEST),st.setFunc(LessEqualDepth$1),er(!1),Yn(CullFaceBack$1),_n(nt.CULL_FACE),dn(NoBlending$1);function _n(Sn){ct[Sn]!==!0&&(nt.enable(Sn),ct[Sn]=!0)}function yn(Sn){ct[Sn]!==!1&&(nt.disable(Sn),ct[Sn]=!1)}function $n(Sn,Ar){return ut[Sn]!==Ar?(nt.bindFramebuffer(Sn,Ar),ut[Sn]=Ar,Sn===nt.DRAW_FRAMEBUFFER&&(ut[nt.FRAMEBUFFER]=Ar),Sn===nt.FRAMEBUFFER&&(ut[nt.DRAW_FRAMEBUFFER]=Ar),!0):!1}function Jn(Sn,Ar){let Nn=dt,nr=!1;if(Sn){Nn=ht.get(Ar),Nn===void 0&&(Nn=[],ht.set(Ar,Nn));const Ir=Sn.textures;if(Nn.length!==Ir.length||Nn[0]!==nt.COLOR_ATTACHMENT0){for(let Dn=0,Pr=Ir.length;Dn<Pr;Dn++)Nn[Dn]=nt.COLOR_ATTACHMENT0+Dn;Nn.length=Ir.length,nr=!0}}else Nn[0]!==nt.BACK&&(Nn[0]=nt.BACK,nr=!0);nr&&nt.drawBuffers(Nn)}function Xn(Sn){return ft!==Sn?(nt.useProgram(Sn),ft=Sn,!0):!1}const Vn={[AddEquation$1]:nt.FUNC_ADD,[SubtractEquation$1]:nt.FUNC_SUBTRACT,[ReverseSubtractEquation$1]:nt.FUNC_REVERSE_SUBTRACT};Vn[MinEquation$1]=nt.MIN,Vn[MaxEquation$1]=nt.MAX;const En={[ZeroFactor$1]:nt.ZERO,[OneFactor$1]:nt.ONE,[SrcColorFactor$1]:nt.SRC_COLOR,[SrcAlphaFactor$1]:nt.SRC_ALPHA,[SrcAlphaSaturateFactor$1]:nt.SRC_ALPHA_SATURATE,[DstColorFactor$1]:nt.DST_COLOR,[DstAlphaFactor$1]:nt.DST_ALPHA,[OneMinusSrcColorFactor$1]:nt.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor$1]:nt.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor$1]:nt.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor$1]:nt.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:nt.CONSTANT_COLOR,[OneMinusConstantColorFactor]:nt.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:nt.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:nt.ONE_MINUS_CONSTANT_ALPHA};function dn(Sn,Ar,Nn,nr,Ir,Dn,Pr,jr,Jr,Lr){if(Sn===NoBlending$1){pt===!0&&(yn(nt.BLEND),pt=!1);return}if(pt===!1&&(_n(nt.BLEND),pt=!0),Sn!==CustomBlending$1){if(Sn!==mt||Lr!==$t){if((At!==AddEquation$1||Tt!==AddEquation$1)&&(nt.blendEquation(nt.FUNC_ADD),At=AddEquation$1,Tt=AddEquation$1),Lr)switch(Sn){case NormalBlending$1:nt.blendFuncSeparate(nt.ONE,nt.ONE_MINUS_SRC_ALPHA,nt.ONE,nt.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending$1:nt.blendFunc(nt.ONE,nt.ONE);break;case SubtractiveBlending$1:nt.blendFuncSeparate(nt.ZERO,nt.ONE_MINUS_SRC_COLOR,nt.ZERO,nt.ONE);break;case MultiplyBlending$1:nt.blendFuncSeparate(nt.ZERO,nt.SRC_COLOR,nt.ZERO,nt.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Sn);break}else switch(Sn){case NormalBlending$1:nt.blendFuncSeparate(nt.SRC_ALPHA,nt.ONE_MINUS_SRC_ALPHA,nt.ONE,nt.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending$1:nt.blendFunc(nt.SRC_ALPHA,nt.ONE);break;case SubtractiveBlending$1:nt.blendFuncSeparate(nt.ZERO,nt.ONE_MINUS_SRC_COLOR,nt.ZERO,nt.ONE);break;case MultiplyBlending$1:nt.blendFunc(nt.ZERO,nt.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Sn);break}gt=null,bt=null,wt=null,Rt=null,It.set(0,0,0),Lt=0,mt=Sn,$t=Lr}return}Ir=Ir||Ar,Dn=Dn||Nn,Pr=Pr||nr,(Ar!==At||Ir!==Tt)&&(nt.blendEquationSeparate(Vn[Ar],Vn[Ir]),At=Ar,Tt=Ir),(Nn!==gt||nr!==bt||Dn!==wt||Pr!==Rt)&&(nt.blendFuncSeparate(En[Nn],En[nr],En[Dn],En[Pr]),gt=Nn,bt=nr,wt=Dn,Rt=Pr),(jr.equals(It)===!1||Jr!==Lt)&&(nt.blendColor(jr.r,jr.g,jr.b,Jr),It.copy(jr),Lt=Jr),mt=Sn,$t=!1}function rr(Sn,Ar){Sn.side===DoubleSide$1?yn(nt.CULL_FACE):_n(nt.CULL_FACE);let Nn=Sn.side===BackSide$1;Ar&&(Nn=!Nn),er(Nn),Sn.blending===NormalBlending$1&&Sn.transparent===!1?dn(NoBlending$1):dn(Sn.blending,Sn.blendEquation,Sn.blendSrc,Sn.blendDst,Sn.blendEquationAlpha,Sn.blendSrcAlpha,Sn.blendDstAlpha,Sn.blendColor,Sn.blendAlpha,Sn.premultipliedAlpha),st.setFunc(Sn.depthFunc),st.setTest(Sn.depthTest),st.setMask(Sn.depthWrite),it.setMask(Sn.colorWrite);const nr=Sn.stencilWrite;ot.setTest(nr),nr&&(ot.setMask(Sn.stencilWriteMask),ot.setFunc(Sn.stencilFunc,Sn.stencilRef,Sn.stencilFuncMask),ot.setOp(Sn.stencilFail,Sn.stencilZFail,Sn.stencilZPass)),Qn(Sn.polygonOffset,Sn.polygonOffsetFactor,Sn.polygonOffsetUnits),Sn.alphaToCoverage===!0?_n(nt.SAMPLE_ALPHA_TO_COVERAGE):yn(nt.SAMPLE_ALPHA_TO_COVERAGE)}function er(Sn){kt!==Sn&&(Sn?nt.frontFace(nt.CW):nt.frontFace(nt.CCW),kt=Sn)}function Yn(Sn){Sn!==CullFaceNone$1?(_n(nt.CULL_FACE),Sn!==Dt&&(Sn===CullFaceBack$1?nt.cullFace(nt.BACK):Sn===CullFaceFront$1?nt.cullFace(nt.FRONT):nt.cullFace(nt.FRONT_AND_BACK))):yn(nt.CULL_FACE),Dt=Sn}function ir(Sn){Sn!==Ot&&(Xt&&nt.lineWidth(Sn),Ot=Sn)}function Qn(Sn,Ar,Nn){Sn?(_n(nt.POLYGON_OFFSET_FILL),(zt!==Ar||Ht!==Nn)&&(nt.polygonOffset(Ar,Nn),zt=Ar,Ht=Nn)):yn(nt.POLYGON_OFFSET_FILL)}function sr(Sn){Sn?_n(nt.SCISSOR_TEST):yn(nt.SCISSOR_TEST)}function un(Sn){Sn===void 0&&(Sn=nt.TEXTURE0+Yt-1),Gt!==Sn&&(nt.activeTexture(Sn),Gt=Sn)}function en(Sn,Ar,Nn){Nn===void 0&&(Gt===null?Nn=nt.TEXTURE0+Yt-1:Nn=Gt);let nr=jt[Nn];nr===void 0&&(nr={type:void 0,texture:void 0},jt[Nn]=nr),(nr.type!==Sn||nr.texture!==Ar)&&(Gt!==Nn&&(nt.activeTexture(Nn),Gt=Nn),nt.bindTexture(Sn,Ar||pn[Sn]),nr.type=Sn,nr.texture=Ar)}function wn(){const Sn=jt[Gt];Sn!==void 0&&Sn.type!==void 0&&(nt.bindTexture(Sn.type,null),Sn.type=void 0,Sn.texture=void 0)}function gn(){try{nt.compressedTexImage2D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function Mn(){try{nt.compressedTexImage3D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function In(){try{nt.texSubImage2D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function gr(){try{nt.texSubImage3D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function jn(){try{nt.compressedTexSubImage2D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function hr(){try{nt.compressedTexSubImage3D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function Tr(){try{nt.texStorage2D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function cr(){try{nt.texStorage3D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function yr(){try{nt.texImage2D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function Rr(){try{nt.texImage3D.apply(nt,arguments)}catch(Sn){console.error("THREE.WebGLState:",Sn)}}function br(Sn){sn.equals(Sn)===!1&&(nt.scissor(Sn.x,Sn.y,Sn.z,Sn.w),sn.copy(Sn))}function pr(Sn){hn.equals(Sn)===!1&&(nt.viewport(Sn.x,Sn.y,Sn.z,Sn.w),hn.copy(Sn))}function vn(Sn,Ar){let Nn=lt.get(Ar);Nn===void 0&&(Nn=new WeakMap,lt.set(Ar,Nn));let nr=Nn.get(Sn);nr===void 0&&(nr=nt.getUniformBlockIndex(Ar,Sn.name),Nn.set(Sn,nr))}function qn(Sn,Ar){const nr=lt.get(Ar).get(Sn);at.get(Ar)!==nr&&(nt.uniformBlockBinding(Ar,nr,Sn.__bindingPointIndex),at.set(Ar,nr))}function vr(){nt.disable(nt.BLEND),nt.disable(nt.CULL_FACE),nt.disable(nt.DEPTH_TEST),nt.disable(nt.POLYGON_OFFSET_FILL),nt.disable(nt.SCISSOR_TEST),nt.disable(nt.STENCIL_TEST),nt.disable(nt.SAMPLE_ALPHA_TO_COVERAGE),nt.blendEquation(nt.FUNC_ADD),nt.blendFunc(nt.ONE,nt.ZERO),nt.blendFuncSeparate(nt.ONE,nt.ZERO,nt.ONE,nt.ZERO),nt.blendColor(0,0,0,0),nt.colorMask(!0,!0,!0,!0),nt.clearColor(0,0,0,0),nt.depthMask(!0),nt.depthFunc(nt.LESS),nt.clearDepth(1),nt.stencilMask(4294967295),nt.stencilFunc(nt.ALWAYS,0,4294967295),nt.stencilOp(nt.KEEP,nt.KEEP,nt.KEEP),nt.clearStencil(0),nt.cullFace(nt.BACK),nt.frontFace(nt.CCW),nt.polygonOffset(0,0),nt.activeTexture(nt.TEXTURE0),nt.bindFramebuffer(nt.FRAMEBUFFER,null),nt.bindFramebuffer(nt.DRAW_FRAMEBUFFER,null),nt.bindFramebuffer(nt.READ_FRAMEBUFFER,null),nt.useProgram(null),nt.lineWidth(1),nt.scissor(0,0,nt.canvas.width,nt.canvas.height),nt.viewport(0,0,nt.canvas.width,nt.canvas.height),ct={},Gt=null,jt={},ut={},ht=new WeakMap,dt=[],ft=null,pt=!1,mt=null,At=null,gt=null,bt=null,Tt=null,wt=null,Rt=null,It=new Color$2(0,0,0),Lt=0,$t=!1,kt=null,Dt=null,Ot=null,zt=null,Ht=null,sn.set(0,0,nt.canvas.width,nt.canvas.height),hn.set(0,0,nt.canvas.width,nt.canvas.height),it.reset(),st.reset(),ot.reset()}return{buffers:{color:it,depth:st,stencil:ot},enable:_n,disable:yn,bindFramebuffer:$n,drawBuffers:Jn,useProgram:Xn,setBlending:dn,setMaterial:rr,setFlipSided:er,setCullFace:Yn,setLineWidth:ir,setPolygonOffset:Qn,setScissorTest:sr,activeTexture:un,bindTexture:en,unbindTexture:wn,compressedTexImage2D:gn,compressedTexImage3D:Mn,texImage2D:yr,texImage3D:Rr,updateUBOMapping:vn,uniformBlockBinding:qn,texStorage2D:Tr,texStorage3D:cr,texSubImage2D:In,texSubImage3D:gr,compressedTexSubImage2D:jn,compressedTexSubImage3D:hr,scissor:br,viewport:pr,reset:vr}}function contain(nt,_e){const et=nt.image&&nt.image.width?nt.image.width/nt.image.height:1;return et>_e?(nt.repeat.x=1,nt.repeat.y=et/_e,nt.offset.x=0,nt.offset.y=(1-nt.repeat.y)/2):(nt.repeat.x=_e/et,nt.repeat.y=1,nt.offset.x=(1-nt.repeat.x)/2,nt.offset.y=0),nt}function cover(nt,_e){const et=nt.image&&nt.image.width?nt.image.width/nt.image.height:1;return et>_e?(nt.repeat.x=_e/et,nt.repeat.y=1,nt.offset.x=(1-nt.repeat.x)/2,nt.offset.y=0):(nt.repeat.x=1,nt.repeat.y=et/_e,nt.offset.x=0,nt.offset.y=(1-nt.repeat.y)/2),nt}function fill(nt){return nt.repeat.x=1,nt.repeat.y=1,nt.offset.x=0,nt.offset.y=0,nt}function getByteLength(nt,_e,et,rt){const it=getTextureTypeByteLength(rt);switch(et){case AlphaFormat$1:return nt*_e;case LuminanceFormat$1:return nt*_e;case LuminanceAlphaFormat$1:return nt*_e*2;case RedFormat$1:return nt*_e/it.components*it.byteLength;case RedIntegerFormat$1:return nt*_e/it.components*it.byteLength;case RGFormat$1:return nt*_e*2/it.components*it.byteLength;case RGIntegerFormat$1:return nt*_e*2/it.components*it.byteLength;case RGBFormat$1:return nt*_e*3/it.components*it.byteLength;case RGBAFormat$1:return nt*_e*4/it.components*it.byteLength;case RGBAIntegerFormat$1:return nt*_e*4/it.components*it.byteLength;case RGB_S3TC_DXT1_Format$1:case RGBA_S3TC_DXT1_Format$1:return Math.floor((nt+3)/4)*Math.floor((_e+3)/4)*8;case RGBA_S3TC_DXT3_Format$1:case RGBA_S3TC_DXT5_Format$1:return Math.floor((nt+3)/4)*Math.floor((_e+3)/4)*16;case RGB_PVRTC_2BPPV1_Format$1:case RGBA_PVRTC_2BPPV1_Format$1:return Math.max(nt,16)*Math.max(_e,8)/4;case RGB_PVRTC_4BPPV1_Format$1:case RGBA_PVRTC_4BPPV1_Format$1:return Math.max(nt,8)*Math.max(_e,8)/2;case RGB_ETC1_Format$1:case RGB_ETC2_Format$1:return Math.floor((nt+3)/4)*Math.floor((_e+3)/4)*8;case RGBA_ETC2_EAC_Format$1:return Math.floor((nt+3)/4)*Math.floor((_e+3)/4)*16;case RGBA_ASTC_4x4_Format$1:return Math.floor((nt+3)/4)*Math.floor((_e+3)/4)*16;case RGBA_ASTC_5x4_Format$1:return Math.floor((nt+4)/5)*Math.floor((_e+3)/4)*16;case RGBA_ASTC_5x5_Format$1:return Math.floor((nt+4)/5)*Math.floor((_e+4)/5)*16;case RGBA_ASTC_6x5_Format$1:return Math.floor((nt+5)/6)*Math.floor((_e+4)/5)*16;case RGBA_ASTC_6x6_Format$1:return Math.floor((nt+5)/6)*Math.floor((_e+5)/6)*16;case RGBA_ASTC_8x5_Format$1:return Math.floor((nt+7)/8)*Math.floor((_e+4)/5)*16;case RGBA_ASTC_8x6_Format$1:return Math.floor((nt+7)/8)*Math.floor((_e+5)/6)*16;case RGBA_ASTC_8x8_Format$1:return Math.floor((nt+7)/8)*Math.floor((_e+7)/8)*16;case RGBA_ASTC_10x5_Format$1:return Math.floor((nt+9)/10)*Math.floor((_e+4)/5)*16;case RGBA_ASTC_10x6_Format$1:return Math.floor((nt+9)/10)*Math.floor((_e+5)/6)*16;case RGBA_ASTC_10x8_Format$1:return Math.floor((nt+9)/10)*Math.floor((_e+7)/8)*16;case RGBA_ASTC_10x10_Format$1:return Math.floor((nt+9)/10)*Math.floor((_e+9)/10)*16;case RGBA_ASTC_12x10_Format$1:return Math.floor((nt+11)/12)*Math.floor((_e+9)/10)*16;case RGBA_ASTC_12x12_Format$1:return Math.floor((nt+11)/12)*Math.floor((_e+11)/12)*16;case RGBA_BPTC_Format$1:case RGB_BPTC_SIGNED_Format:case RGB_BPTC_UNSIGNED_Format:return Math.ceil(nt/4)*Math.ceil(_e/4)*16;case RED_RGTC1_Format$1:case SIGNED_RED_RGTC1_Format$1:return Math.ceil(nt/4)*Math.ceil(_e/4)*8;case RED_GREEN_RGTC2_Format$1:case SIGNED_RED_GREEN_RGTC2_Format$1:return Math.ceil(nt/4)*Math.ceil(_e/4)*16}throw new Error(`Unable to determine texture byte length for ${et} format.`)}function getTextureTypeByteLength(nt){switch(nt){case UnsignedByteType$1:case ByteType$1:return{byteLength:1,components:1};case UnsignedShortType$1:case ShortType$1:case HalfFloatType$1:return{byteLength:2,components:1};case UnsignedShort4444Type$1:case UnsignedShort5551Type$1:return{byteLength:2,components:4};case UnsignedIntType$1:case IntType$1:case FloatType$1:return{byteLength:4,components:1};case UnsignedInt5999Type$1:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${nt}.`)}const TextureUtils={contain,cover,fill,getByteLength};function WebGLTextures(nt,_e,et,rt,it,st,ot){const at=_e.has("WEBGL_multisampled_render_to_texture")?_e.get("WEBGL_multisampled_render_to_texture"):null,lt=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ct=new Vector2$1,ut=new WeakMap;let ht;const dt=new WeakMap;let ft=!1;try{ft=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function pt(un,en){return ft?new OffscreenCanvas(un,en):createElementNS$1("canvas")}function mt(un,en,wn){let gn=1;const Mn=sr(un);if((Mn.width>wn||Mn.height>wn)&&(gn=wn/Math.max(Mn.width,Mn.height)),gn<1)if(typeof HTMLImageElement<"u"&&un instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&un instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&un instanceof ImageBitmap||typeof VideoFrame<"u"&&un instanceof VideoFrame){const In=Math.floor(gn*Mn.width),gr=Math.floor(gn*Mn.height);ht===void 0&&(ht=pt(In,gr));const jn=en?pt(In,gr):ht;return jn.width=In,jn.height=gr,jn.getContext("2d").drawImage(un,0,0,In,gr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Mn.width+"x"+Mn.height+") to ("+In+"x"+gr+")."),jn}else return"data"in un&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Mn.width+"x"+Mn.height+")."),un;return un}function At(un){return un.generateMipmaps&&un.minFilter!==NearestFilter$1&&un.minFilter!==LinearFilter$1}function gt(un){nt.generateMipmap(un)}function bt(un,en,wn,gn,Mn=!1){if(un!==null){if(nt[un]!==void 0)return nt[un];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+un+"'")}let In=en;if(en===nt.RED&&(wn===nt.FLOAT&&(In=nt.R32F),wn===nt.HALF_FLOAT&&(In=nt.R16F),wn===nt.UNSIGNED_BYTE&&(In=nt.R8)),en===nt.RED_INTEGER&&(wn===nt.UNSIGNED_BYTE&&(In=nt.R8UI),wn===nt.UNSIGNED_SHORT&&(In=nt.R16UI),wn===nt.UNSIGNED_INT&&(In=nt.R32UI),wn===nt.BYTE&&(In=nt.R8I),wn===nt.SHORT&&(In=nt.R16I),wn===nt.INT&&(In=nt.R32I)),en===nt.RG&&(wn===nt.FLOAT&&(In=nt.RG32F),wn===nt.HALF_FLOAT&&(In=nt.RG16F),wn===nt.UNSIGNED_BYTE&&(In=nt.RG8)),en===nt.RG_INTEGER&&(wn===nt.UNSIGNED_BYTE&&(In=nt.RG8UI),wn===nt.UNSIGNED_SHORT&&(In=nt.RG16UI),wn===nt.UNSIGNED_INT&&(In=nt.RG32UI),wn===nt.BYTE&&(In=nt.RG8I),wn===nt.SHORT&&(In=nt.RG16I),wn===nt.INT&&(In=nt.RG32I)),en===nt.RGB_INTEGER&&(wn===nt.UNSIGNED_BYTE&&(In=nt.RGB8UI),wn===nt.UNSIGNED_SHORT&&(In=nt.RGB16UI),wn===nt.UNSIGNED_INT&&(In=nt.RGB32UI),wn===nt.BYTE&&(In=nt.RGB8I),wn===nt.SHORT&&(In=nt.RGB16I),wn===nt.INT&&(In=nt.RGB32I)),en===nt.RGBA_INTEGER&&(wn===nt.UNSIGNED_BYTE&&(In=nt.RGBA8UI),wn===nt.UNSIGNED_SHORT&&(In=nt.RGBA16UI),wn===nt.UNSIGNED_INT&&(In=nt.RGBA32UI),wn===nt.BYTE&&(In=nt.RGBA8I),wn===nt.SHORT&&(In=nt.RGBA16I),wn===nt.INT&&(In=nt.RGBA32I)),en===nt.RGB&&wn===nt.UNSIGNED_INT_5_9_9_9_REV&&(In=nt.RGB9_E5),en===nt.RGBA){const gr=Mn?LinearTransfer$1:ColorManagement$1.getTransfer(gn);wn===nt.FLOAT&&(In=nt.RGBA32F),wn===nt.HALF_FLOAT&&(In=nt.RGBA16F),wn===nt.UNSIGNED_BYTE&&(In=gr===SRGBTransfer$1?nt.SRGB8_ALPHA8:nt.RGBA8),wn===nt.UNSIGNED_SHORT_4_4_4_4&&(In=nt.RGBA4),wn===nt.UNSIGNED_SHORT_5_5_5_1&&(In=nt.RGB5_A1)}return(In===nt.R16F||In===nt.R32F||In===nt.RG16F||In===nt.RG32F||In===nt.RGBA16F||In===nt.RGBA32F)&&_e.get("EXT_color_buffer_float"),In}function Tt(un,en){let wn;return un?en===null||en===UnsignedIntType$1||en===UnsignedInt248Type$1?wn=nt.DEPTH24_STENCIL8:en===FloatType$1?wn=nt.DEPTH32F_STENCIL8:en===UnsignedShortType$1&&(wn=nt.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):en===null||en===UnsignedIntType$1||en===UnsignedInt248Type$1?wn=nt.DEPTH_COMPONENT24:en===FloatType$1?wn=nt.DEPTH_COMPONENT32F:en===UnsignedShortType$1&&(wn=nt.DEPTH_COMPONENT16),wn}function wt(un,en){return At(un)===!0||un.isFramebufferTexture&&un.minFilter!==NearestFilter$1&&un.minFilter!==LinearFilter$1?Math.log2(Math.max(en.width,en.height))+1:un.mipmaps!==void 0&&un.mipmaps.length>0?un.mipmaps.length:un.isCompressedTexture&&Array.isArray(un.image)?en.mipmaps.length:1}function Rt(un){const en=un.target;en.removeEventListener("dispose",Rt),Lt(en),en.isVideoTexture&&ut.delete(en)}function It(un){const en=un.target;en.removeEventListener("dispose",It),kt(en)}function Lt(un){const en=rt.get(un);if(en.__webglInit===void 0)return;const wn=un.source,gn=dt.get(wn);if(gn){const Mn=gn[en.__cacheKey];Mn.usedTimes--,Mn.usedTimes===0&&$t(un),Object.keys(gn).length===0&&dt.delete(wn)}rt.remove(un)}function $t(un){const en=rt.get(un);nt.deleteTexture(en.__webglTexture);const wn=un.source,gn=dt.get(wn);delete gn[en.__cacheKey],ot.memory.textures--}function kt(un){const en=rt.get(un);if(un.depthTexture&&un.depthTexture.dispose(),un.isWebGLCubeRenderTarget)for(let gn=0;gn<6;gn++){if(Array.isArray(en.__webglFramebuffer[gn]))for(let Mn=0;Mn<en.__webglFramebuffer[gn].length;Mn++)nt.deleteFramebuffer(en.__webglFramebuffer[gn][Mn]);else nt.deleteFramebuffer(en.__webglFramebuffer[gn]);en.__webglDepthbuffer&&nt.deleteRenderbuffer(en.__webglDepthbuffer[gn])}else{if(Array.isArray(en.__webglFramebuffer))for(let gn=0;gn<en.__webglFramebuffer.length;gn++)nt.deleteFramebuffer(en.__webglFramebuffer[gn]);else nt.deleteFramebuffer(en.__webglFramebuffer);if(en.__webglDepthbuffer&&nt.deleteRenderbuffer(en.__webglDepthbuffer),en.__webglMultisampledFramebuffer&&nt.deleteFramebuffer(en.__webglMultisampledFramebuffer),en.__webglColorRenderbuffer)for(let gn=0;gn<en.__webglColorRenderbuffer.length;gn++)en.__webglColorRenderbuffer[gn]&&nt.deleteRenderbuffer(en.__webglColorRenderbuffer[gn]);en.__webglDepthRenderbuffer&&nt.deleteRenderbuffer(en.__webglDepthRenderbuffer)}const wn=un.textures;for(let gn=0,Mn=wn.length;gn<Mn;gn++){const In=rt.get(wn[gn]);In.__webglTexture&&(nt.deleteTexture(In.__webglTexture),ot.memory.textures--),rt.remove(wn[gn])}rt.remove(un)}let Dt=0;function Ot(){Dt=0}function zt(){const un=Dt;return un>=it.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+un+" texture units while this GPU supports only "+it.maxTextures),Dt+=1,un}function Ht(un){const en=[];return en.push(un.wrapS),en.push(un.wrapT),en.push(un.wrapR||0),en.push(un.magFilter),en.push(un.minFilter),en.push(un.anisotropy),en.push(un.internalFormat),en.push(un.format),en.push(un.type),en.push(un.generateMipmaps),en.push(un.premultiplyAlpha),en.push(un.flipY),en.push(un.unpackAlignment),en.push(un.colorSpace),en.join()}function Yt(un,en){const wn=rt.get(un);if(un.isVideoTexture&&ir(un),un.isRenderTargetTexture===!1&&un.version>0&&wn.__version!==un.version){const gn=un.image;if(gn===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(gn.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{hn(wn,un,en);return}}et.bindTexture(nt.TEXTURE_2D,wn.__webglTexture,nt.TEXTURE0+en)}function Xt(un,en){const wn=rt.get(un);if(un.version>0&&wn.__version!==un.version){hn(wn,un,en);return}et.bindTexture(nt.TEXTURE_2D_ARRAY,wn.__webglTexture,nt.TEXTURE0+en)}function Zt(un,en){const wn=rt.get(un);if(un.version>0&&wn.__version!==un.version){hn(wn,un,en);return}et.bindTexture(nt.TEXTURE_3D,wn.__webglTexture,nt.TEXTURE0+en)}function rn(un,en){const wn=rt.get(un);if(un.version>0&&wn.__version!==un.version){an(wn,un,en);return}et.bindTexture(nt.TEXTURE_CUBE_MAP,wn.__webglTexture,nt.TEXTURE0+en)}const Gt={[RepeatWrapping$1]:nt.REPEAT,[ClampToEdgeWrapping$1]:nt.CLAMP_TO_EDGE,[MirroredRepeatWrapping$1]:nt.MIRRORED_REPEAT},jt={[NearestFilter$1]:nt.NEAREST,[NearestMipmapNearestFilter$1]:nt.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter$1]:nt.NEAREST_MIPMAP_LINEAR,[LinearFilter$1]:nt.LINEAR,[LinearMipmapNearestFilter$1]:nt.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter$1]:nt.LINEAR_MIPMAP_LINEAR},Kt={[NeverCompare$1]:nt.NEVER,[AlwaysCompare$1]:nt.ALWAYS,[LessCompare$1]:nt.LESS,[LessEqualCompare$1]:nt.LEQUAL,[EqualCompare$1]:nt.EQUAL,[GreaterEqualCompare$1]:nt.GEQUAL,[GreaterCompare$1]:nt.GREATER,[NotEqualCompare$1]:nt.NOTEQUAL};function Jt(un,en){if(en.type===FloatType$1&&_e.has("OES_texture_float_linear")===!1&&(en.magFilter===LinearFilter$1||en.magFilter===LinearMipmapNearestFilter$1||en.magFilter===NearestMipmapLinearFilter$1||en.magFilter===LinearMipmapLinearFilter$1||en.minFilter===LinearFilter$1||en.minFilter===LinearMipmapNearestFilter$1||en.minFilter===NearestMipmapLinearFilter$1||en.minFilter===LinearMipmapLinearFilter$1)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),nt.texParameteri(un,nt.TEXTURE_WRAP_S,Gt[en.wrapS]),nt.texParameteri(un,nt.TEXTURE_WRAP_T,Gt[en.wrapT]),(un===nt.TEXTURE_3D||un===nt.TEXTURE_2D_ARRAY)&&nt.texParameteri(un,nt.TEXTURE_WRAP_R,Gt[en.wrapR]),nt.texParameteri(un,nt.TEXTURE_MAG_FILTER,jt[en.magFilter]),nt.texParameteri(un,nt.TEXTURE_MIN_FILTER,jt[en.minFilter]),en.compareFunction&&(nt.texParameteri(un,nt.TEXTURE_COMPARE_MODE,nt.COMPARE_REF_TO_TEXTURE),nt.texParameteri(un,nt.TEXTURE_COMPARE_FUNC,Kt[en.compareFunction])),_e.has("EXT_texture_filter_anisotropic")===!0){if(en.magFilter===NearestFilter$1||en.minFilter!==NearestMipmapLinearFilter$1&&en.minFilter!==LinearMipmapLinearFilter$1||en.type===FloatType$1&&_e.has("OES_texture_float_linear")===!1)return;if(en.anisotropy>1||rt.get(en).__currentAnisotropy){const wn=_e.get("EXT_texture_filter_anisotropic");nt.texParameterf(un,wn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(en.anisotropy,it.getMaxAnisotropy())),rt.get(en).__currentAnisotropy=en.anisotropy}}}function sn(un,en){let wn=!1;un.__webglInit===void 0&&(un.__webglInit=!0,en.addEventListener("dispose",Rt));const gn=en.source;let Mn=dt.get(gn);Mn===void 0&&(Mn={},dt.set(gn,Mn));const In=Ht(en);if(In!==un.__cacheKey){Mn[In]===void 0&&(Mn[In]={texture:nt.createTexture(),usedTimes:0},ot.memory.textures++,wn=!0),Mn[In].usedTimes++;const gr=Mn[un.__cacheKey];gr!==void 0&&(Mn[un.__cacheKey].usedTimes--,gr.usedTimes===0&&$t(en)),un.__cacheKey=In,un.__webglTexture=Mn[In].texture}return wn}function hn(un,en,wn){let gn=nt.TEXTURE_2D;(en.isDataArrayTexture||en.isCompressedArrayTexture)&&(gn=nt.TEXTURE_2D_ARRAY),en.isData3DTexture&&(gn=nt.TEXTURE_3D);const Mn=sn(un,en),In=en.source;et.bindTexture(gn,un.__webglTexture,nt.TEXTURE0+wn);const gr=rt.get(In);if(In.version!==gr.__version||Mn===!0){et.activeTexture(nt.TEXTURE0+wn);const jn=ColorManagement$1.getPrimaries(ColorManagement$1.workingColorSpace),hr=en.colorSpace===NoColorSpace$1?null:ColorManagement$1.getPrimaries(en.colorSpace),Tr=en.colorSpace===NoColorSpace$1||jn===hr?nt.NONE:nt.BROWSER_DEFAULT_WEBGL;nt.pixelStorei(nt.UNPACK_FLIP_Y_WEBGL,en.flipY),nt.pixelStorei(nt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,en.premultiplyAlpha),nt.pixelStorei(nt.UNPACK_ALIGNMENT,en.unpackAlignment),nt.pixelStorei(nt.UNPACK_COLORSPACE_CONVERSION_WEBGL,Tr);let cr=mt(en.image,!1,it.maxTextureSize);cr=Qn(en,cr);const yr=st.convert(en.format,en.colorSpace),Rr=st.convert(en.type);let br=bt(en.internalFormat,yr,Rr,en.colorSpace,en.isVideoTexture);Jt(gn,en);let pr;const vn=en.mipmaps,qn=en.isVideoTexture!==!0,vr=gr.__version===void 0||Mn===!0,Sn=In.dataReady,Ar=wt(en,cr);if(en.isDepthTexture)br=Tt(en.format===DepthStencilFormat$1,en.type),vr&&(qn?et.texStorage2D(nt.TEXTURE_2D,1,br,cr.width,cr.height):et.texImage2D(nt.TEXTURE_2D,0,br,cr.width,cr.height,0,yr,Rr,null));else if(en.isDataTexture)if(vn.length>0){qn&&vr&&et.texStorage2D(nt.TEXTURE_2D,Ar,br,vn[0].width,vn[0].height);for(let Nn=0,nr=vn.length;Nn<nr;Nn++)pr=vn[Nn],qn?Sn&&et.texSubImage2D(nt.TEXTURE_2D,Nn,0,0,pr.width,pr.height,yr,Rr,pr.data):et.texImage2D(nt.TEXTURE_2D,Nn,br,pr.width,pr.height,0,yr,Rr,pr.data);en.generateMipmaps=!1}else qn?(vr&&et.texStorage2D(nt.TEXTURE_2D,Ar,br,cr.width,cr.height),Sn&&et.texSubImage2D(nt.TEXTURE_2D,0,0,0,cr.width,cr.height,yr,Rr,cr.data)):et.texImage2D(nt.TEXTURE_2D,0,br,cr.width,cr.height,0,yr,Rr,cr.data);else if(en.isCompressedTexture)if(en.isCompressedArrayTexture){qn&&vr&&et.texStorage3D(nt.TEXTURE_2D_ARRAY,Ar,br,vn[0].width,vn[0].height,cr.depth);for(let Nn=0,nr=vn.length;Nn<nr;Nn++)if(pr=vn[Nn],en.format!==RGBAFormat$1)if(yr!==null)if(qn){if(Sn)if(en.layerUpdates.size>0){const Ir=getByteLength(pr.width,pr.height,en.format,en.type);for(const Dn of en.layerUpdates){const Pr=pr.data.subarray(Dn*Ir/pr.data.BYTES_PER_ELEMENT,(Dn+1)*Ir/pr.data.BYTES_PER_ELEMENT);et.compressedTexSubImage3D(nt.TEXTURE_2D_ARRAY,Nn,0,0,Dn,pr.width,pr.height,1,yr,Pr,0,0)}en.clearLayerUpdates()}else et.compressedTexSubImage3D(nt.TEXTURE_2D_ARRAY,Nn,0,0,0,pr.width,pr.height,cr.depth,yr,pr.data,0,0)}else et.compressedTexImage3D(nt.TEXTURE_2D_ARRAY,Nn,br,pr.width,pr.height,cr.depth,0,pr.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else qn?Sn&&et.texSubImage3D(nt.TEXTURE_2D_ARRAY,Nn,0,0,0,pr.width,pr.height,cr.depth,yr,Rr,pr.data):et.texImage3D(nt.TEXTURE_2D_ARRAY,Nn,br,pr.width,pr.height,cr.depth,0,yr,Rr,pr.data)}else{qn&&vr&&et.texStorage2D(nt.TEXTURE_2D,Ar,br,vn[0].width,vn[0].height);for(let Nn=0,nr=vn.length;Nn<nr;Nn++)pr=vn[Nn],en.format!==RGBAFormat$1?yr!==null?qn?Sn&&et.compressedTexSubImage2D(nt.TEXTURE_2D,Nn,0,0,pr.width,pr.height,yr,pr.data):et.compressedTexImage2D(nt.TEXTURE_2D,Nn,br,pr.width,pr.height,0,pr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):qn?Sn&&et.texSubImage2D(nt.TEXTURE_2D,Nn,0,0,pr.width,pr.height,yr,Rr,pr.data):et.texImage2D(nt.TEXTURE_2D,Nn,br,pr.width,pr.height,0,yr,Rr,pr.data)}else if(en.isDataArrayTexture)if(qn){if(vr&&et.texStorage3D(nt.TEXTURE_2D_ARRAY,Ar,br,cr.width,cr.height,cr.depth),Sn)if(en.layerUpdates.size>0){const Nn=getByteLength(cr.width,cr.height,en.format,en.type);for(const nr of en.layerUpdates){const Ir=cr.data.subarray(nr*Nn/cr.data.BYTES_PER_ELEMENT,(nr+1)*Nn/cr.data.BYTES_PER_ELEMENT);et.texSubImage3D(nt.TEXTURE_2D_ARRAY,0,0,0,nr,cr.width,cr.height,1,yr,Rr,Ir)}en.clearLayerUpdates()}else et.texSubImage3D(nt.TEXTURE_2D_ARRAY,0,0,0,0,cr.width,cr.height,cr.depth,yr,Rr,cr.data)}else et.texImage3D(nt.TEXTURE_2D_ARRAY,0,br,cr.width,cr.height,cr.depth,0,yr,Rr,cr.data);else if(en.isData3DTexture)qn?(vr&&et.texStorage3D(nt.TEXTURE_3D,Ar,br,cr.width,cr.height,cr.depth),Sn&&et.texSubImage3D(nt.TEXTURE_3D,0,0,0,0,cr.width,cr.height,cr.depth,yr,Rr,cr.data)):et.texImage3D(nt.TEXTURE_3D,0,br,cr.width,cr.height,cr.depth,0,yr,Rr,cr.data);else if(en.isFramebufferTexture){if(vr)if(qn)et.texStorage2D(nt.TEXTURE_2D,Ar,br,cr.width,cr.height);else{let Nn=cr.width,nr=cr.height;for(let Ir=0;Ir<Ar;Ir++)et.texImage2D(nt.TEXTURE_2D,Ir,br,Nn,nr,0,yr,Rr,null),Nn>>=1,nr>>=1}}else if(vn.length>0){if(qn&&vr){const Nn=sr(vn[0]);et.texStorage2D(nt.TEXTURE_2D,Ar,br,Nn.width,Nn.height)}for(let Nn=0,nr=vn.length;Nn<nr;Nn++)pr=vn[Nn],qn?Sn&&et.texSubImage2D(nt.TEXTURE_2D,Nn,0,0,yr,Rr,pr):et.texImage2D(nt.TEXTURE_2D,Nn,br,yr,Rr,pr);en.generateMipmaps=!1}else if(qn){if(vr){const Nn=sr(cr);et.texStorage2D(nt.TEXTURE_2D,Ar,br,Nn.width,Nn.height)}Sn&&et.texSubImage2D(nt.TEXTURE_2D,0,0,0,yr,Rr,cr)}else et.texImage2D(nt.TEXTURE_2D,0,br,yr,Rr,cr);At(en)&&gt(gn),gr.__version=In.version,en.onUpdate&&en.onUpdate(en)}un.__version=en.version}function an(un,en,wn){if(en.image.length!==6)return;const gn=sn(un,en),Mn=en.source;et.bindTexture(nt.TEXTURE_CUBE_MAP,un.__webglTexture,nt.TEXTURE0+wn);const In=rt.get(Mn);if(Mn.version!==In.__version||gn===!0){et.activeTexture(nt.TEXTURE0+wn);const gr=ColorManagement$1.getPrimaries(ColorManagement$1.workingColorSpace),jn=en.colorSpace===NoColorSpace$1?null:ColorManagement$1.getPrimaries(en.colorSpace),hr=en.colorSpace===NoColorSpace$1||gr===jn?nt.NONE:nt.BROWSER_DEFAULT_WEBGL;nt.pixelStorei(nt.UNPACK_FLIP_Y_WEBGL,en.flipY),nt.pixelStorei(nt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,en.premultiplyAlpha),nt.pixelStorei(nt.UNPACK_ALIGNMENT,en.unpackAlignment),nt.pixelStorei(nt.UNPACK_COLORSPACE_CONVERSION_WEBGL,hr);const Tr=en.isCompressedTexture||en.image[0].isCompressedTexture,cr=en.image[0]&&en.image[0].isDataTexture,yr=[];for(let nr=0;nr<6;nr++)!Tr&&!cr?yr[nr]=mt(en.image[nr],!0,it.maxCubemapSize):yr[nr]=cr?en.image[nr].image:en.image[nr],yr[nr]=Qn(en,yr[nr]);const Rr=yr[0],br=st.convert(en.format,en.colorSpace),pr=st.convert(en.type),vn=bt(en.internalFormat,br,pr,en.colorSpace),qn=en.isVideoTexture!==!0,vr=In.__version===void 0||gn===!0,Sn=Mn.dataReady;let Ar=wt(en,Rr);Jt(nt.TEXTURE_CUBE_MAP,en);let Nn;if(Tr){qn&&vr&&et.texStorage2D(nt.TEXTURE_CUBE_MAP,Ar,vn,Rr.width,Rr.height);for(let nr=0;nr<6;nr++){Nn=yr[nr].mipmaps;for(let Ir=0;Ir<Nn.length;Ir++){const Dn=Nn[Ir];en.format!==RGBAFormat$1?br!==null?qn?Sn&&et.compressedTexSubImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir,0,0,Dn.width,Dn.height,br,Dn.data):et.compressedTexImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir,vn,Dn.width,Dn.height,0,Dn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):qn?Sn&&et.texSubImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir,0,0,Dn.width,Dn.height,br,pr,Dn.data):et.texImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir,vn,Dn.width,Dn.height,0,br,pr,Dn.data)}}}else{if(Nn=en.mipmaps,qn&&vr){Nn.length>0&&Ar++;const nr=sr(yr[0]);et.texStorage2D(nt.TEXTURE_CUBE_MAP,Ar,vn,nr.width,nr.height)}for(let nr=0;nr<6;nr++)if(cr){qn?Sn&&et.texSubImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,0,0,0,yr[nr].width,yr[nr].height,br,pr,yr[nr].data):et.texImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,0,vn,yr[nr].width,yr[nr].height,0,br,pr,yr[nr].data);for(let Ir=0;Ir<Nn.length;Ir++){const Pr=Nn[Ir].image[nr].image;qn?Sn&&et.texSubImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir+1,0,0,Pr.width,Pr.height,br,pr,Pr.data):et.texImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir+1,vn,Pr.width,Pr.height,0,br,pr,Pr.data)}}else{qn?Sn&&et.texSubImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,0,0,0,br,pr,yr[nr]):et.texImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,0,vn,br,pr,yr[nr]);for(let Ir=0;Ir<Nn.length;Ir++){const Dn=Nn[Ir];qn?Sn&&et.texSubImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir+1,0,0,br,pr,Dn.image[nr]):et.texImage2D(nt.TEXTURE_CUBE_MAP_POSITIVE_X+nr,Ir+1,vn,br,pr,Dn.image[nr])}}}At(en)&&gt(nt.TEXTURE_CUBE_MAP),In.__version=Mn.version,en.onUpdate&&en.onUpdate(en)}un.__version=en.version}function pn(un,en,wn,gn,Mn,In){const gr=st.convert(wn.format,wn.colorSpace),jn=st.convert(wn.type),hr=bt(wn.internalFormat,gr,jn,wn.colorSpace);if(!rt.get(en).__hasExternalTextures){const cr=Math.max(1,en.width>>In),yr=Math.max(1,en.height>>In);Mn===nt.TEXTURE_3D||Mn===nt.TEXTURE_2D_ARRAY?et.texImage3D(Mn,In,hr,cr,yr,en.depth,0,gr,jn,null):et.texImage2D(Mn,In,hr,cr,yr,0,gr,jn,null)}et.bindFramebuffer(nt.FRAMEBUFFER,un),Yn(en)?at.framebufferTexture2DMultisampleEXT(nt.FRAMEBUFFER,gn,Mn,rt.get(wn).__webglTexture,0,er(en)):(Mn===nt.TEXTURE_2D||Mn>=nt.TEXTURE_CUBE_MAP_POSITIVE_X&&Mn<=nt.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&nt.framebufferTexture2D(nt.FRAMEBUFFER,gn,Mn,rt.get(wn).__webglTexture,In),et.bindFramebuffer(nt.FRAMEBUFFER,null)}function _n(un,en,wn){if(nt.bindRenderbuffer(nt.RENDERBUFFER,un),en.depthBuffer){const gn=en.depthTexture,Mn=gn&&gn.isDepthTexture?gn.type:null,In=Tt(en.stencilBuffer,Mn),gr=en.stencilBuffer?nt.DEPTH_STENCIL_ATTACHMENT:nt.DEPTH_ATTACHMENT,jn=er(en);Yn(en)?at.renderbufferStorageMultisampleEXT(nt.RENDERBUFFER,jn,In,en.width,en.height):wn?nt.renderbufferStorageMultisample(nt.RENDERBUFFER,jn,In,en.width,en.height):nt.renderbufferStorage(nt.RENDERBUFFER,In,en.width,en.height),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,gr,nt.RENDERBUFFER,un)}else{const gn=en.textures;for(let Mn=0;Mn<gn.length;Mn++){const In=gn[Mn],gr=st.convert(In.format,In.colorSpace),jn=st.convert(In.type),hr=bt(In.internalFormat,gr,jn,In.colorSpace),Tr=er(en);wn&&Yn(en)===!1?nt.renderbufferStorageMultisample(nt.RENDERBUFFER,Tr,hr,en.width,en.height):Yn(en)?at.renderbufferStorageMultisampleEXT(nt.RENDERBUFFER,Tr,hr,en.width,en.height):nt.renderbufferStorage(nt.RENDERBUFFER,hr,en.width,en.height)}}nt.bindRenderbuffer(nt.RENDERBUFFER,null)}function yn(un,en){if(en&&en.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(et.bindFramebuffer(nt.FRAMEBUFFER,un),!(en.depthTexture&&en.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!rt.get(en.depthTexture).__webglTexture||en.depthTexture.image.width!==en.width||en.depthTexture.image.height!==en.height)&&(en.depthTexture.image.width=en.width,en.depthTexture.image.height=en.height,en.depthTexture.needsUpdate=!0),Yt(en.depthTexture,0);const gn=rt.get(en.depthTexture).__webglTexture,Mn=er(en);if(en.depthTexture.format===DepthFormat$1)Yn(en)?at.framebufferTexture2DMultisampleEXT(nt.FRAMEBUFFER,nt.DEPTH_ATTACHMENT,nt.TEXTURE_2D,gn,0,Mn):nt.framebufferTexture2D(nt.FRAMEBUFFER,nt.DEPTH_ATTACHMENT,nt.TEXTURE_2D,gn,0);else if(en.depthTexture.format===DepthStencilFormat$1)Yn(en)?at.framebufferTexture2DMultisampleEXT(nt.FRAMEBUFFER,nt.DEPTH_STENCIL_ATTACHMENT,nt.TEXTURE_2D,gn,0,Mn):nt.framebufferTexture2D(nt.FRAMEBUFFER,nt.DEPTH_STENCIL_ATTACHMENT,nt.TEXTURE_2D,gn,0);else throw new Error("Unknown depthTexture format")}function $n(un){const en=rt.get(un),wn=un.isWebGLCubeRenderTarget===!0;if(en.__boundDepthTexture!==un.depthTexture){const gn=un.depthTexture;if(en.__depthDisposeCallback&&en.__depthDisposeCallback(),gn){const Mn=()=>{delete en.__boundDepthTexture,delete en.__depthDisposeCallback,gn.removeEventListener("dispose",Mn)};gn.addEventListener("dispose",Mn),en.__depthDisposeCallback=Mn}en.__boundDepthTexture=gn}if(un.depthTexture&&!en.__autoAllocateDepthBuffer){if(wn)throw new Error("target.depthTexture not supported in Cube render targets");yn(en.__webglFramebuffer,un)}else if(wn){en.__webglDepthbuffer=[];for(let gn=0;gn<6;gn++)if(et.bindFramebuffer(nt.FRAMEBUFFER,en.__webglFramebuffer[gn]),en.__webglDepthbuffer[gn]===void 0)en.__webglDepthbuffer[gn]=nt.createRenderbuffer(),_n(en.__webglDepthbuffer[gn],un,!1);else{const Mn=un.stencilBuffer?nt.DEPTH_STENCIL_ATTACHMENT:nt.DEPTH_ATTACHMENT,In=en.__webglDepthbuffer[gn];nt.bindRenderbuffer(nt.RENDERBUFFER,In),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,Mn,nt.RENDERBUFFER,In)}}else if(et.bindFramebuffer(nt.FRAMEBUFFER,en.__webglFramebuffer),en.__webglDepthbuffer===void 0)en.__webglDepthbuffer=nt.createRenderbuffer(),_n(en.__webglDepthbuffer,un,!1);else{const gn=un.stencilBuffer?nt.DEPTH_STENCIL_ATTACHMENT:nt.DEPTH_ATTACHMENT,Mn=en.__webglDepthbuffer;nt.bindRenderbuffer(nt.RENDERBUFFER,Mn),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,gn,nt.RENDERBUFFER,Mn)}et.bindFramebuffer(nt.FRAMEBUFFER,null)}function Jn(un,en,wn){const gn=rt.get(un);en!==void 0&&pn(gn.__webglFramebuffer,un,un.texture,nt.COLOR_ATTACHMENT0,nt.TEXTURE_2D,0),wn!==void 0&&$n(un)}function Xn(un){const en=un.texture,wn=rt.get(un),gn=rt.get(en);un.addEventListener("dispose",It);const Mn=un.textures,In=un.isWebGLCubeRenderTarget===!0,gr=Mn.length>1;if(gr||(gn.__webglTexture===void 0&&(gn.__webglTexture=nt.createTexture()),gn.__version=en.version,ot.memory.textures++),In){wn.__webglFramebuffer=[];for(let jn=0;jn<6;jn++)if(en.mipmaps&&en.mipmaps.length>0){wn.__webglFramebuffer[jn]=[];for(let hr=0;hr<en.mipmaps.length;hr++)wn.__webglFramebuffer[jn][hr]=nt.createFramebuffer()}else wn.__webglFramebuffer[jn]=nt.createFramebuffer()}else{if(en.mipmaps&&en.mipmaps.length>0){wn.__webglFramebuffer=[];for(let jn=0;jn<en.mipmaps.length;jn++)wn.__webglFramebuffer[jn]=nt.createFramebuffer()}else wn.__webglFramebuffer=nt.createFramebuffer();if(gr)for(let jn=0,hr=Mn.length;jn<hr;jn++){const Tr=rt.get(Mn[jn]);Tr.__webglTexture===void 0&&(Tr.__webglTexture=nt.createTexture(),ot.memory.textures++)}if(un.samples>0&&Yn(un)===!1){wn.__webglMultisampledFramebuffer=nt.createFramebuffer(),wn.__webglColorRenderbuffer=[],et.bindFramebuffer(nt.FRAMEBUFFER,wn.__webglMultisampledFramebuffer);for(let jn=0;jn<Mn.length;jn++){const hr=Mn[jn];wn.__webglColorRenderbuffer[jn]=nt.createRenderbuffer(),nt.bindRenderbuffer(nt.RENDERBUFFER,wn.__webglColorRenderbuffer[jn]);const Tr=st.convert(hr.format,hr.colorSpace),cr=st.convert(hr.type),yr=bt(hr.internalFormat,Tr,cr,hr.colorSpace,un.isXRRenderTarget===!0),Rr=er(un);nt.renderbufferStorageMultisample(nt.RENDERBUFFER,Rr,yr,un.width,un.height),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,nt.COLOR_ATTACHMENT0+jn,nt.RENDERBUFFER,wn.__webglColorRenderbuffer[jn])}nt.bindRenderbuffer(nt.RENDERBUFFER,null),un.depthBuffer&&(wn.__webglDepthRenderbuffer=nt.createRenderbuffer(),_n(wn.__webglDepthRenderbuffer,un,!0)),et.bindFramebuffer(nt.FRAMEBUFFER,null)}}if(In){et.bindTexture(nt.TEXTURE_CUBE_MAP,gn.__webglTexture),Jt(nt.TEXTURE_CUBE_MAP,en);for(let jn=0;jn<6;jn++)if(en.mipmaps&&en.mipmaps.length>0)for(let hr=0;hr<en.mipmaps.length;hr++)pn(wn.__webglFramebuffer[jn][hr],un,en,nt.COLOR_ATTACHMENT0,nt.TEXTURE_CUBE_MAP_POSITIVE_X+jn,hr);else pn(wn.__webglFramebuffer[jn],un,en,nt.COLOR_ATTACHMENT0,nt.TEXTURE_CUBE_MAP_POSITIVE_X+jn,0);At(en)&&gt(nt.TEXTURE_CUBE_MAP),et.unbindTexture()}else if(gr){for(let jn=0,hr=Mn.length;jn<hr;jn++){const Tr=Mn[jn],cr=rt.get(Tr);et.bindTexture(nt.TEXTURE_2D,cr.__webglTexture),Jt(nt.TEXTURE_2D,Tr),pn(wn.__webglFramebuffer,un,Tr,nt.COLOR_ATTACHMENT0+jn,nt.TEXTURE_2D,0),At(Tr)&&gt(nt.TEXTURE_2D)}et.unbindTexture()}else{let jn=nt.TEXTURE_2D;if((un.isWebGL3DRenderTarget||un.isWebGLArrayRenderTarget)&&(jn=un.isWebGL3DRenderTarget?nt.TEXTURE_3D:nt.TEXTURE_2D_ARRAY),et.bindTexture(jn,gn.__webglTexture),Jt(jn,en),en.mipmaps&&en.mipmaps.length>0)for(let hr=0;hr<en.mipmaps.length;hr++)pn(wn.__webglFramebuffer[hr],un,en,nt.COLOR_ATTACHMENT0,jn,hr);else pn(wn.__webglFramebuffer,un,en,nt.COLOR_ATTACHMENT0,jn,0);At(en)&&gt(jn),et.unbindTexture()}un.depthBuffer&&$n(un)}function Vn(un){const en=un.textures;for(let wn=0,gn=en.length;wn<gn;wn++){const Mn=en[wn];if(At(Mn)){const In=un.isWebGLCubeRenderTarget?nt.TEXTURE_CUBE_MAP:nt.TEXTURE_2D,gr=rt.get(Mn).__webglTexture;et.bindTexture(In,gr),gt(In),et.unbindTexture()}}}const En=[],dn=[];function rr(un){if(un.samples>0){if(Yn(un)===!1){const en=un.textures,wn=un.width,gn=un.height;let Mn=nt.COLOR_BUFFER_BIT;const In=un.stencilBuffer?nt.DEPTH_STENCIL_ATTACHMENT:nt.DEPTH_ATTACHMENT,gr=rt.get(un),jn=en.length>1;if(jn)for(let hr=0;hr<en.length;hr++)et.bindFramebuffer(nt.FRAMEBUFFER,gr.__webglMultisampledFramebuffer),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,nt.COLOR_ATTACHMENT0+hr,nt.RENDERBUFFER,null),et.bindFramebuffer(nt.FRAMEBUFFER,gr.__webglFramebuffer),nt.framebufferTexture2D(nt.DRAW_FRAMEBUFFER,nt.COLOR_ATTACHMENT0+hr,nt.TEXTURE_2D,null,0);et.bindFramebuffer(nt.READ_FRAMEBUFFER,gr.__webglMultisampledFramebuffer),et.bindFramebuffer(nt.DRAW_FRAMEBUFFER,gr.__webglFramebuffer);for(let hr=0;hr<en.length;hr++){if(un.resolveDepthBuffer&&(un.depthBuffer&&(Mn|=nt.DEPTH_BUFFER_BIT),un.stencilBuffer&&un.resolveStencilBuffer&&(Mn|=nt.STENCIL_BUFFER_BIT)),jn){nt.framebufferRenderbuffer(nt.READ_FRAMEBUFFER,nt.COLOR_ATTACHMENT0,nt.RENDERBUFFER,gr.__webglColorRenderbuffer[hr]);const Tr=rt.get(en[hr]).__webglTexture;nt.framebufferTexture2D(nt.DRAW_FRAMEBUFFER,nt.COLOR_ATTACHMENT0,nt.TEXTURE_2D,Tr,0)}nt.blitFramebuffer(0,0,wn,gn,0,0,wn,gn,Mn,nt.NEAREST),lt===!0&&(En.length=0,dn.length=0,En.push(nt.COLOR_ATTACHMENT0+hr),un.depthBuffer&&un.resolveDepthBuffer===!1&&(En.push(In),dn.push(In),nt.invalidateFramebuffer(nt.DRAW_FRAMEBUFFER,dn)),nt.invalidateFramebuffer(nt.READ_FRAMEBUFFER,En))}if(et.bindFramebuffer(nt.READ_FRAMEBUFFER,null),et.bindFramebuffer(nt.DRAW_FRAMEBUFFER,null),jn)for(let hr=0;hr<en.length;hr++){et.bindFramebuffer(nt.FRAMEBUFFER,gr.__webglMultisampledFramebuffer),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,nt.COLOR_ATTACHMENT0+hr,nt.RENDERBUFFER,gr.__webglColorRenderbuffer[hr]);const Tr=rt.get(en[hr]).__webglTexture;et.bindFramebuffer(nt.FRAMEBUFFER,gr.__webglFramebuffer),nt.framebufferTexture2D(nt.DRAW_FRAMEBUFFER,nt.COLOR_ATTACHMENT0+hr,nt.TEXTURE_2D,Tr,0)}et.bindFramebuffer(nt.DRAW_FRAMEBUFFER,gr.__webglMultisampledFramebuffer)}else if(un.depthBuffer&&un.resolveDepthBuffer===!1&&lt){const en=un.stencilBuffer?nt.DEPTH_STENCIL_ATTACHMENT:nt.DEPTH_ATTACHMENT;nt.invalidateFramebuffer(nt.DRAW_FRAMEBUFFER,[en])}}}function er(un){return Math.min(it.maxSamples,un.samples)}function Yn(un){const en=rt.get(un);return un.samples>0&&_e.has("WEBGL_multisampled_render_to_texture")===!0&&en.__useRenderToTexture!==!1}function ir(un){const en=ot.render.frame;ut.get(un)!==en&&(ut.set(un,en),un.update())}function Qn(un,en){const wn=un.colorSpace,gn=un.format,Mn=un.type;return un.isCompressedTexture===!0||un.isVideoTexture===!0||wn!==LinearSRGBColorSpace$2&&wn!==NoColorSpace$1&&(ColorManagement$1.getTransfer(wn)===SRGBTransfer$1?(gn!==RGBAFormat$1||Mn!==UnsignedByteType$1)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",wn)),en}function sr(un){return typeof HTMLImageElement<"u"&&un instanceof HTMLImageElement?(ct.width=un.naturalWidth||un.width,ct.height=un.naturalHeight||un.height):typeof VideoFrame<"u"&&un instanceof VideoFrame?(ct.width=un.displayWidth,ct.height=un.displayHeight):(ct.width=un.width,ct.height=un.height),ct}this.allocateTextureUnit=zt,this.resetTextureUnits=Ot,this.setTexture2D=Yt,this.setTexture2DArray=Xt,this.setTexture3D=Zt,this.setTextureCube=rn,this.rebindTextures=Jn,this.setupRenderTarget=Xn,this.updateRenderTargetMipmap=Vn,this.updateMultisampleRenderTarget=rr,this.setupDepthRenderbuffer=$n,this.setupFrameBufferTexture=pn,this.useMultisampledRTT=Yn}function WebGLUtils$1(nt,_e){function et(rt,it=NoColorSpace$1){let st;const ot=ColorManagement$1.getTransfer(it);if(rt===UnsignedByteType$1)return nt.UNSIGNED_BYTE;if(rt===UnsignedShort4444Type$1)return nt.UNSIGNED_SHORT_4_4_4_4;if(rt===UnsignedShort5551Type$1)return nt.UNSIGNED_SHORT_5_5_5_1;if(rt===UnsignedInt5999Type$1)return nt.UNSIGNED_INT_5_9_9_9_REV;if(rt===ByteType$1)return nt.BYTE;if(rt===ShortType$1)return nt.SHORT;if(rt===UnsignedShortType$1)return nt.UNSIGNED_SHORT;if(rt===IntType$1)return nt.INT;if(rt===UnsignedIntType$1)return nt.UNSIGNED_INT;if(rt===FloatType$1)return nt.FLOAT;if(rt===HalfFloatType$1)return nt.HALF_FLOAT;if(rt===AlphaFormat$1)return nt.ALPHA;if(rt===RGBFormat$1)return nt.RGB;if(rt===RGBAFormat$1)return nt.RGBA;if(rt===LuminanceFormat$1)return nt.LUMINANCE;if(rt===LuminanceAlphaFormat$1)return nt.LUMINANCE_ALPHA;if(rt===DepthFormat$1)return nt.DEPTH_COMPONENT;if(rt===DepthStencilFormat$1)return nt.DEPTH_STENCIL;if(rt===RedFormat$1)return nt.RED;if(rt===RedIntegerFormat$1)return nt.RED_INTEGER;if(rt===RGFormat$1)return nt.RG;if(rt===RGIntegerFormat$1)return nt.RG_INTEGER;if(rt===RGBAIntegerFormat$1)return nt.RGBA_INTEGER;if(rt===RGB_S3TC_DXT1_Format$1||rt===RGBA_S3TC_DXT1_Format$1||rt===RGBA_S3TC_DXT3_Format$1||rt===RGBA_S3TC_DXT5_Format$1)if(ot===SRGBTransfer$1)if(st=_e.get("WEBGL_compressed_texture_s3tc_srgb"),st!==null){if(rt===RGB_S3TC_DXT1_Format$1)return st.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(rt===RGBA_S3TC_DXT1_Format$1)return st.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(rt===RGBA_S3TC_DXT3_Format$1)return st.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(rt===RGBA_S3TC_DXT5_Format$1)return st.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(st=_e.get("WEBGL_compressed_texture_s3tc"),st!==null){if(rt===RGB_S3TC_DXT1_Format$1)return st.COMPRESSED_RGB_S3TC_DXT1_EXT;if(rt===RGBA_S3TC_DXT1_Format$1)return st.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(rt===RGBA_S3TC_DXT3_Format$1)return st.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(rt===RGBA_S3TC_DXT5_Format$1)return st.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(rt===RGB_PVRTC_4BPPV1_Format$1||rt===RGB_PVRTC_2BPPV1_Format$1||rt===RGBA_PVRTC_4BPPV1_Format$1||rt===RGBA_PVRTC_2BPPV1_Format$1)if(st=_e.get("WEBGL_compressed_texture_pvrtc"),st!==null){if(rt===RGB_PVRTC_4BPPV1_Format$1)return st.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(rt===RGB_PVRTC_2BPPV1_Format$1)return st.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(rt===RGBA_PVRTC_4BPPV1_Format$1)return st.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(rt===RGBA_PVRTC_2BPPV1_Format$1)return st.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(rt===RGB_ETC1_Format$1||rt===RGB_ETC2_Format$1||rt===RGBA_ETC2_EAC_Format$1)if(st=_e.get("WEBGL_compressed_texture_etc"),st!==null){if(rt===RGB_ETC1_Format$1||rt===RGB_ETC2_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ETC2:st.COMPRESSED_RGB8_ETC2;if(rt===RGBA_ETC2_EAC_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:st.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(rt===RGBA_ASTC_4x4_Format$1||rt===RGBA_ASTC_5x4_Format$1||rt===RGBA_ASTC_5x5_Format$1||rt===RGBA_ASTC_6x5_Format$1||rt===RGBA_ASTC_6x6_Format$1||rt===RGBA_ASTC_8x5_Format$1||rt===RGBA_ASTC_8x6_Format$1||rt===RGBA_ASTC_8x8_Format$1||rt===RGBA_ASTC_10x5_Format$1||rt===RGBA_ASTC_10x6_Format$1||rt===RGBA_ASTC_10x8_Format$1||rt===RGBA_ASTC_10x10_Format$1||rt===RGBA_ASTC_12x10_Format$1||rt===RGBA_ASTC_12x12_Format$1)if(st=_e.get("WEBGL_compressed_texture_astc"),st!==null){if(rt===RGBA_ASTC_4x4_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:st.COMPRESSED_RGBA_ASTC_4x4_KHR;if(rt===RGBA_ASTC_5x4_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:st.COMPRESSED_RGBA_ASTC_5x4_KHR;if(rt===RGBA_ASTC_5x5_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:st.COMPRESSED_RGBA_ASTC_5x5_KHR;if(rt===RGBA_ASTC_6x5_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:st.COMPRESSED_RGBA_ASTC_6x5_KHR;if(rt===RGBA_ASTC_6x6_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:st.COMPRESSED_RGBA_ASTC_6x6_KHR;if(rt===RGBA_ASTC_8x5_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:st.COMPRESSED_RGBA_ASTC_8x5_KHR;if(rt===RGBA_ASTC_8x6_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:st.COMPRESSED_RGBA_ASTC_8x6_KHR;if(rt===RGBA_ASTC_8x8_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:st.COMPRESSED_RGBA_ASTC_8x8_KHR;if(rt===RGBA_ASTC_10x5_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:st.COMPRESSED_RGBA_ASTC_10x5_KHR;if(rt===RGBA_ASTC_10x6_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:st.COMPRESSED_RGBA_ASTC_10x6_KHR;if(rt===RGBA_ASTC_10x8_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:st.COMPRESSED_RGBA_ASTC_10x8_KHR;if(rt===RGBA_ASTC_10x10_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:st.COMPRESSED_RGBA_ASTC_10x10_KHR;if(rt===RGBA_ASTC_12x10_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:st.COMPRESSED_RGBA_ASTC_12x10_KHR;if(rt===RGBA_ASTC_12x12_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:st.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(rt===RGBA_BPTC_Format$1||rt===RGB_BPTC_SIGNED_Format||rt===RGB_BPTC_UNSIGNED_Format)if(st=_e.get("EXT_texture_compression_bptc"),st!==null){if(rt===RGBA_BPTC_Format$1)return ot===SRGBTransfer$1?st.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:st.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(rt===RGB_BPTC_SIGNED_Format)return st.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(rt===RGB_BPTC_UNSIGNED_Format)return st.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(rt===RED_RGTC1_Format$1||rt===SIGNED_RED_RGTC1_Format$1||rt===RED_GREEN_RGTC2_Format$1||rt===SIGNED_RED_GREEN_RGTC2_Format$1)if(st=_e.get("EXT_texture_compression_rgtc"),st!==null){if(rt===RGBA_BPTC_Format$1)return st.COMPRESSED_RED_RGTC1_EXT;if(rt===SIGNED_RED_RGTC1_Format$1)return st.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(rt===RED_GREEN_RGTC2_Format$1)return st.COMPRESSED_RED_GREEN_RGTC2_EXT;if(rt===SIGNED_RED_GREEN_RGTC2_Format$1)return st.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return rt===UnsignedInt248Type$1?nt.UNSIGNED_INT_24_8:nt[rt]!==void 0?nt[rt]:null}return{convert:et}}class ArrayCamera extends PerspectiveCamera$2{constructor(_e=[]){super(),this.isArrayCamera=!0,this.cameras=_e}}let Group$1=class extends Object3D$1{constructor(){super(),this.isGroup=!0,this.type="Group"}};const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group$1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group$1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3$1,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3$1),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group$1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3$1,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3$1),this._grip}dispatchEvent(_e){return this._targetRay!==null&&this._targetRay.dispatchEvent(_e),this._grip!==null&&this._grip.dispatchEvent(_e),this._hand!==null&&this._hand.dispatchEvent(_e),this}connect(_e){if(_e&&_e.hand){const et=this._hand;if(et)for(const rt of _e.hand.values())this._getHandJoint(et,rt)}return this.dispatchEvent({type:"connected",data:_e}),this}disconnect(_e){return this.dispatchEvent({type:"disconnected",data:_e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_e,et,rt){let it=null,st=null,ot=null;const at=this._targetRay,lt=this._grip,ct=this._hand;if(_e&&et.session.visibilityState!=="visible-blurred"){if(ct&&_e.hand){ot=!0;for(const mt of _e.hand.values()){const At=et.getJointPose(mt,rt),gt=this._getHandJoint(ct,mt);At!==null&&(gt.matrix.fromArray(At.transform.matrix),gt.matrix.decompose(gt.position,gt.rotation,gt.scale),gt.matrixWorldNeedsUpdate=!0,gt.jointRadius=At.radius),gt.visible=At!==null}const ut=ct.joints["index-finger-tip"],ht=ct.joints["thumb-tip"],dt=ut.position.distanceTo(ht.position),ft=.02,pt=.005;ct.inputState.pinching&&dt>ft+pt?(ct.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_e.handedness,target:this})):!ct.inputState.pinching&&dt<=ft-pt&&(ct.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_e.handedness,target:this}))}else lt!==null&&_e.gripSpace&&(st=et.getPose(_e.gripSpace,rt),st!==null&&(lt.matrix.fromArray(st.transform.matrix),lt.matrix.decompose(lt.position,lt.rotation,lt.scale),lt.matrixWorldNeedsUpdate=!0,st.linearVelocity?(lt.hasLinearVelocity=!0,lt.linearVelocity.copy(st.linearVelocity)):lt.hasLinearVelocity=!1,st.angularVelocity?(lt.hasAngularVelocity=!0,lt.angularVelocity.copy(st.angularVelocity)):lt.hasAngularVelocity=!1));at!==null&&(it=et.getPose(_e.targetRaySpace,rt),it===null&&st!==null&&(it=st),it!==null&&(at.matrix.fromArray(it.transform.matrix),at.matrix.decompose(at.position,at.rotation,at.scale),at.matrixWorldNeedsUpdate=!0,it.linearVelocity?(at.hasLinearVelocity=!0,at.linearVelocity.copy(it.linearVelocity)):at.hasLinearVelocity=!1,it.angularVelocity?(at.hasAngularVelocity=!0,at.angularVelocity.copy(it.angularVelocity)):at.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return at!==null&&(at.visible=it!==null),lt!==null&&(lt.visible=st!==null),ct!==null&&(ct.visible=ot!==null),this}_getHandJoint(_e,et){if(_e.joints[et.jointName]===void 0){const rt=new Group$1;rt.matrixAutoUpdate=!1,rt.visible=!1,_e.joints[et.jointName]=rt,_e.add(rt)}return _e.joints[et.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(_e,et,rt){if(this.texture===null){const it=new Texture$1,st=_e.properties.get(it);st.__webglTexture=et.texture,(et.depthNear!=rt.depthNear||et.depthFar!=rt.depthFar)&&(this.depthNear=et.depthNear,this.depthFar=et.depthFar),this.texture=it}}getMesh(_e){if(this.texture!==null&&this.mesh===null){const et=_e.cameras[0].viewport,rt=new ShaderMaterial$1({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:et.z},depthHeight:{value:et.w}}});this.mesh=new Mesh$1(new PlaneGeometry(20,20),rt)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends EventDispatcher$1{constructor(_e,et){super();const rt=this;let it=null,st=1,ot=null,at="local-floor",lt=1,ct=null,ut=null,ht=null,dt=null,ft=null,pt=null;const mt=new WebXRDepthSensing,At=et.getContextAttributes();let gt=null,bt=null;const Tt=[],wt=[],Rt=new Vector2$1;let It=null;const Lt=new PerspectiveCamera$2;Lt.layers.enable(1),Lt.viewport=new Vector4$1;const $t=new PerspectiveCamera$2;$t.layers.enable(2),$t.viewport=new Vector4$1;const kt=[Lt,$t],Dt=new ArrayCamera;Dt.layers.enable(1),Dt.layers.enable(2);let Ot=null,zt=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(an){let pn=Tt[an];return pn===void 0&&(pn=new WebXRController,Tt[an]=pn),pn.getTargetRaySpace()},this.getControllerGrip=function(an){let pn=Tt[an];return pn===void 0&&(pn=new WebXRController,Tt[an]=pn),pn.getGripSpace()},this.getHand=function(an){let pn=Tt[an];return pn===void 0&&(pn=new WebXRController,Tt[an]=pn),pn.getHandSpace()};function Ht(an){const pn=wt.indexOf(an.inputSource);if(pn===-1)return;const _n=Tt[pn];_n!==void 0&&(_n.update(an.inputSource,an.frame,ct||ot),_n.dispatchEvent({type:an.type,data:an.inputSource}))}function Yt(){it.removeEventListener("select",Ht),it.removeEventListener("selectstart",Ht),it.removeEventListener("selectend",Ht),it.removeEventListener("squeeze",Ht),it.removeEventListener("squeezestart",Ht),it.removeEventListener("squeezeend",Ht),it.removeEventListener("end",Yt),it.removeEventListener("inputsourceschange",Xt);for(let an=0;an<Tt.length;an++){const pn=wt[an];pn!==null&&(wt[an]=null,Tt[an].disconnect(pn))}Ot=null,zt=null,mt.reset(),_e.setRenderTarget(gt),ft=null,dt=null,ht=null,it=null,bt=null,hn.stop(),rt.isPresenting=!1,_e.setPixelRatio(It),_e.setSize(Rt.width,Rt.height,!1),rt.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(an){st=an,rt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(an){at=an,rt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return ct||ot},this.setReferenceSpace=function(an){ct=an},this.getBaseLayer=function(){return dt!==null?dt:ft},this.getBinding=function(){return ht},this.getFrame=function(){return pt},this.getSession=function(){return it},this.setSession=async function(an){if(it=an,it!==null){if(gt=_e.getRenderTarget(),it.addEventListener("select",Ht),it.addEventListener("selectstart",Ht),it.addEventListener("selectend",Ht),it.addEventListener("squeeze",Ht),it.addEventListener("squeezestart",Ht),it.addEventListener("squeezeend",Ht),it.addEventListener("end",Yt),it.addEventListener("inputsourceschange",Xt),At.xrCompatible!==!0&&await et.makeXRCompatible(),It=_e.getPixelRatio(),_e.getSize(Rt),it.renderState.layers===void 0){const pn={antialias:At.antialias,alpha:!0,depth:At.depth,stencil:At.stencil,framebufferScaleFactor:st};ft=new XRWebGLLayer(it,et,pn),it.updateRenderState({baseLayer:ft}),_e.setPixelRatio(1),_e.setSize(ft.framebufferWidth,ft.framebufferHeight,!1),bt=new WebGLRenderTarget$1(ft.framebufferWidth,ft.framebufferHeight,{format:RGBAFormat$1,type:UnsignedByteType$1,colorSpace:_e.outputColorSpace,stencilBuffer:At.stencil})}else{let pn=null,_n=null,yn=null;At.depth&&(yn=At.stencil?et.DEPTH24_STENCIL8:et.DEPTH_COMPONENT24,pn=At.stencil?DepthStencilFormat$1:DepthFormat$1,_n=At.stencil?UnsignedInt248Type$1:UnsignedIntType$1);const $n={colorFormat:et.RGBA8,depthFormat:yn,scaleFactor:st};ht=new XRWebGLBinding(it,et),dt=ht.createProjectionLayer($n),it.updateRenderState({layers:[dt]}),_e.setPixelRatio(1),_e.setSize(dt.textureWidth,dt.textureHeight,!1),bt=new WebGLRenderTarget$1(dt.textureWidth,dt.textureHeight,{format:RGBAFormat$1,type:UnsignedByteType$1,depthTexture:new DepthTexture$1(dt.textureWidth,dt.textureHeight,_n,void 0,void 0,void 0,void 0,void 0,void 0,pn),stencilBuffer:At.stencil,colorSpace:_e.outputColorSpace,samples:At.antialias?4:0,resolveDepthBuffer:dt.ignoreDepthValues===!1})}bt.isXRRenderTarget=!0,this.setFoveation(lt),ct=null,ot=await it.requestReferenceSpace(at),hn.setContext(it),hn.start(),rt.isPresenting=!0,rt.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(it!==null)return it.environmentBlendMode},this.getDepthTexture=function(){return mt.getDepthTexture()};function Xt(an){for(let pn=0;pn<an.removed.length;pn++){const _n=an.removed[pn],yn=wt.indexOf(_n);yn>=0&&(wt[yn]=null,Tt[yn].disconnect(_n))}for(let pn=0;pn<an.added.length;pn++){const _n=an.added[pn];let yn=wt.indexOf(_n);if(yn===-1){for(let Jn=0;Jn<Tt.length;Jn++)if(Jn>=wt.length){wt.push(_n),yn=Jn;break}else if(wt[Jn]===null){wt[Jn]=_n,yn=Jn;break}if(yn===-1)break}const $n=Tt[yn];$n&&$n.connect(_n)}}const Zt=new Vector3$1,rn=new Vector3$1;function Gt(an,pn,_n){Zt.setFromMatrixPosition(pn.matrixWorld),rn.setFromMatrixPosition(_n.matrixWorld);const yn=Zt.distanceTo(rn),$n=pn.projectionMatrix.elements,Jn=_n.projectionMatrix.elements,Xn=$n[14]/($n[10]-1),Vn=$n[14]/($n[10]+1),En=($n[9]+1)/$n[5],dn=($n[9]-1)/$n[5],rr=($n[8]-1)/$n[0],er=(Jn[8]+1)/Jn[0],Yn=Xn*rr,ir=Xn*er,Qn=yn/(-rr+er),sr=Qn*-rr;if(pn.matrixWorld.decompose(an.position,an.quaternion,an.scale),an.translateX(sr),an.translateZ(Qn),an.matrixWorld.compose(an.position,an.quaternion,an.scale),an.matrixWorldInverse.copy(an.matrixWorld).invert(),$n[10]===-1)an.projectionMatrix.copy(pn.projectionMatrix),an.projectionMatrixInverse.copy(pn.projectionMatrixInverse);else{const un=Xn+Qn,en=Vn+Qn,wn=Yn-sr,gn=ir+(yn-sr),Mn=En*Vn/en*un,In=dn*Vn/en*un;an.projectionMatrix.makePerspective(wn,gn,Mn,In,un,en),an.projectionMatrixInverse.copy(an.projectionMatrix).invert()}}function jt(an,pn){pn===null?an.matrixWorld.copy(an.matrix):an.matrixWorld.multiplyMatrices(pn.matrixWorld,an.matrix),an.matrixWorldInverse.copy(an.matrixWorld).invert()}this.updateCamera=function(an){if(it===null)return;let pn=an.near,_n=an.far;mt.texture!==null&&(mt.depthNear>0&&(pn=mt.depthNear),mt.depthFar>0&&(_n=mt.depthFar)),Dt.near=$t.near=Lt.near=pn,Dt.far=$t.far=Lt.far=_n,(Ot!==Dt.near||zt!==Dt.far)&&(it.updateRenderState({depthNear:Dt.near,depthFar:Dt.far}),Ot=Dt.near,zt=Dt.far);const yn=an.parent,$n=Dt.cameras;jt(Dt,yn);for(let Jn=0;Jn<$n.length;Jn++)jt($n[Jn],yn);$n.length===2?Gt(Dt,Lt,$t):Dt.projectionMatrix.copy(Lt.projectionMatrix),Kt(an,Dt,yn)};function Kt(an,pn,_n){_n===null?an.matrix.copy(pn.matrixWorld):(an.matrix.copy(_n.matrixWorld),an.matrix.invert(),an.matrix.multiply(pn.matrixWorld)),an.matrix.decompose(an.position,an.quaternion,an.scale),an.updateMatrixWorld(!0),an.projectionMatrix.copy(pn.projectionMatrix),an.projectionMatrixInverse.copy(pn.projectionMatrixInverse),an.isPerspectiveCamera&&(an.fov=RAD2DEG$1*2*Math.atan(1/an.projectionMatrix.elements[5]),an.zoom=1)}this.getCamera=function(){return Dt},this.getFoveation=function(){if(!(dt===null&&ft===null))return lt},this.setFoveation=function(an){lt=an,dt!==null&&(dt.fixedFoveation=an),ft!==null&&ft.fixedFoveation!==void 0&&(ft.fixedFoveation=an)},this.hasDepthSensing=function(){return mt.texture!==null},this.getDepthSensingMesh=function(){return mt.getMesh(Dt)};let Jt=null;function sn(an,pn){if(ut=pn.getViewerPose(ct||ot),pt=pn,ut!==null){const _n=ut.views;ft!==null&&(_e.setRenderTargetFramebuffer(bt,ft.framebuffer),_e.setRenderTarget(bt));let yn=!1;_n.length!==Dt.cameras.length&&(Dt.cameras.length=0,yn=!0);for(let Jn=0;Jn<_n.length;Jn++){const Xn=_n[Jn];let Vn=null;if(ft!==null)Vn=ft.getViewport(Xn);else{const dn=ht.getViewSubImage(dt,Xn);Vn=dn.viewport,Jn===0&&(_e.setRenderTargetTextures(bt,dn.colorTexture,dt.ignoreDepthValues?void 0:dn.depthStencilTexture),_e.setRenderTarget(bt))}let En=kt[Jn];En===void 0&&(En=new PerspectiveCamera$2,En.layers.enable(Jn),En.viewport=new Vector4$1,kt[Jn]=En),En.matrix.fromArray(Xn.transform.matrix),En.matrix.decompose(En.position,En.quaternion,En.scale),En.projectionMatrix.fromArray(Xn.projectionMatrix),En.projectionMatrixInverse.copy(En.projectionMatrix).invert(),En.viewport.set(Vn.x,Vn.y,Vn.width,Vn.height),Jn===0&&(Dt.matrix.copy(En.matrix),Dt.matrix.decompose(Dt.position,Dt.quaternion,Dt.scale)),yn===!0&&Dt.cameras.push(En)}const $n=it.enabledFeatures;if($n&&$n.includes("depth-sensing")){const Jn=ht.getDepthInformation(_n[0]);Jn&&Jn.isValid&&Jn.texture&&mt.init(_e,Jn,it.renderState)}}for(let _n=0;_n<Tt.length;_n++){const yn=wt[_n],$n=Tt[_n];yn!==null&&$n!==void 0&&$n.update(yn,pn,ct||ot)}Jt&&Jt(an,pn),pn.detectedPlanes&&rt.dispatchEvent({type:"planesdetected",data:pn}),pt=null}const hn=new WebGLAnimation;hn.setAnimationLoop(sn),this.setAnimationLoop=function(an){Jt=an},this.dispose=function(){}}}const _e1=new Euler$1,_m1$5=new Matrix4$1;function WebGLMaterials(nt,_e){function et(At,gt){At.matrixAutoUpdate===!0&&At.updateMatrix(),gt.value.copy(At.matrix)}function rt(At,gt){gt.color.getRGB(At.fogColor.value,getUnlitUniformColorSpace(nt)),gt.isFog?(At.fogNear.value=gt.near,At.fogFar.value=gt.far):gt.isFogExp2&&(At.fogDensity.value=gt.density)}function it(At,gt,bt,Tt,wt){gt.isMeshBasicMaterial||gt.isMeshLambertMaterial?st(At,gt):gt.isMeshToonMaterial?(st(At,gt),ht(At,gt)):gt.isMeshPhongMaterial?(st(At,gt),ut(At,gt)):gt.isMeshStandardMaterial?(st(At,gt),dt(At,gt),gt.isMeshPhysicalMaterial&&ft(At,gt,wt)):gt.isMeshMatcapMaterial?(st(At,gt),pt(At,gt)):gt.isMeshDepthMaterial?st(At,gt):gt.isMeshDistanceMaterial?(st(At,gt),mt(At,gt)):gt.isMeshNormalMaterial?st(At,gt):gt.isLineBasicMaterial?(ot(At,gt),gt.isLineDashedMaterial&&at(At,gt)):gt.isPointsMaterial?lt(At,gt,bt,Tt):gt.isSpriteMaterial?ct(At,gt):gt.isShadowMaterial?(At.color.value.copy(gt.color),At.opacity.value=gt.opacity):gt.isShaderMaterial&&(gt.uniformsNeedUpdate=!1)}function st(At,gt){At.opacity.value=gt.opacity,gt.color&&At.diffuse.value.copy(gt.color),gt.emissive&&At.emissive.value.copy(gt.emissive).multiplyScalar(gt.emissiveIntensity),gt.map&&(At.map.value=gt.map,et(gt.map,At.mapTransform)),gt.alphaMap&&(At.alphaMap.value=gt.alphaMap,et(gt.alphaMap,At.alphaMapTransform)),gt.bumpMap&&(At.bumpMap.value=gt.bumpMap,et(gt.bumpMap,At.bumpMapTransform),At.bumpScale.value=gt.bumpScale,gt.side===BackSide$1&&(At.bumpScale.value*=-1)),gt.normalMap&&(At.normalMap.value=gt.normalMap,et(gt.normalMap,At.normalMapTransform),At.normalScale.value.copy(gt.normalScale),gt.side===BackSide$1&&At.normalScale.value.negate()),gt.displacementMap&&(At.displacementMap.value=gt.displacementMap,et(gt.displacementMap,At.displacementMapTransform),At.displacementScale.value=gt.displacementScale,At.displacementBias.value=gt.displacementBias),gt.emissiveMap&&(At.emissiveMap.value=gt.emissiveMap,et(gt.emissiveMap,At.emissiveMapTransform)),gt.specularMap&&(At.specularMap.value=gt.specularMap,et(gt.specularMap,At.specularMapTransform)),gt.alphaTest>0&&(At.alphaTest.value=gt.alphaTest);const bt=_e.get(gt),Tt=bt.envMap,wt=bt.envMapRotation;Tt&&(At.envMap.value=Tt,_e1.copy(wt),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,Tt.isCubeTexture&&Tt.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),At.envMapRotation.value.setFromMatrix4(_m1$5.makeRotationFromEuler(_e1)),At.flipEnvMap.value=Tt.isCubeTexture&&Tt.isRenderTargetTexture===!1?-1:1,At.reflectivity.value=gt.reflectivity,At.ior.value=gt.ior,At.refractionRatio.value=gt.refractionRatio),gt.lightMap&&(At.lightMap.value=gt.lightMap,At.lightMapIntensity.value=gt.lightMapIntensity,et(gt.lightMap,At.lightMapTransform)),gt.aoMap&&(At.aoMap.value=gt.aoMap,At.aoMapIntensity.value=gt.aoMapIntensity,et(gt.aoMap,At.aoMapTransform))}function ot(At,gt){At.diffuse.value.copy(gt.color),At.opacity.value=gt.opacity,gt.map&&(At.map.value=gt.map,et(gt.map,At.mapTransform))}function at(At,gt){At.dashSize.value=gt.dashSize,At.totalSize.value=gt.dashSize+gt.gapSize,At.scale.value=gt.scale}function lt(At,gt,bt,Tt){At.diffuse.value.copy(gt.color),At.opacity.value=gt.opacity,At.size.value=gt.size*bt,At.scale.value=Tt*.5,gt.map&&(At.map.value=gt.map,et(gt.map,At.uvTransform)),gt.alphaMap&&(At.alphaMap.value=gt.alphaMap,et(gt.alphaMap,At.alphaMapTransform)),gt.alphaTest>0&&(At.alphaTest.value=gt.alphaTest)}function ct(At,gt){At.diffuse.value.copy(gt.color),At.opacity.value=gt.opacity,At.rotation.value=gt.rotation,gt.map&&(At.map.value=gt.map,et(gt.map,At.mapTransform)),gt.alphaMap&&(At.alphaMap.value=gt.alphaMap,et(gt.alphaMap,At.alphaMapTransform)),gt.alphaTest>0&&(At.alphaTest.value=gt.alphaTest)}function ut(At,gt){At.specular.value.copy(gt.specular),At.shininess.value=Math.max(gt.shininess,1e-4)}function ht(At,gt){gt.gradientMap&&(At.gradientMap.value=gt.gradientMap)}function dt(At,gt){At.metalness.value=gt.metalness,gt.metalnessMap&&(At.metalnessMap.value=gt.metalnessMap,et(gt.metalnessMap,At.metalnessMapTransform)),At.roughness.value=gt.roughness,gt.roughnessMap&&(At.roughnessMap.value=gt.roughnessMap,et(gt.roughnessMap,At.roughnessMapTransform)),gt.envMap&&(At.envMapIntensity.value=gt.envMapIntensity)}function ft(At,gt,bt){At.ior.value=gt.ior,gt.sheen>0&&(At.sheenColor.value.copy(gt.sheenColor).multiplyScalar(gt.sheen),At.sheenRoughness.value=gt.sheenRoughness,gt.sheenColorMap&&(At.sheenColorMap.value=gt.sheenColorMap,et(gt.sheenColorMap,At.sheenColorMapTransform)),gt.sheenRoughnessMap&&(At.sheenRoughnessMap.value=gt.sheenRoughnessMap,et(gt.sheenRoughnessMap,At.sheenRoughnessMapTransform))),gt.clearcoat>0&&(At.clearcoat.value=gt.clearcoat,At.clearcoatRoughness.value=gt.clearcoatRoughness,gt.clearcoatMap&&(At.clearcoatMap.value=gt.clearcoatMap,et(gt.clearcoatMap,At.clearcoatMapTransform)),gt.clearcoatRoughnessMap&&(At.clearcoatRoughnessMap.value=gt.clearcoatRoughnessMap,et(gt.clearcoatRoughnessMap,At.clearcoatRoughnessMapTransform)),gt.clearcoatNormalMap&&(At.clearcoatNormalMap.value=gt.clearcoatNormalMap,et(gt.clearcoatNormalMap,At.clearcoatNormalMapTransform),At.clearcoatNormalScale.value.copy(gt.clearcoatNormalScale),gt.side===BackSide$1&&At.clearcoatNormalScale.value.negate())),gt.dispersion>0&&(At.dispersion.value=gt.dispersion),gt.iridescence>0&&(At.iridescence.value=gt.iridescence,At.iridescenceIOR.value=gt.iridescenceIOR,At.iridescenceThicknessMinimum.value=gt.iridescenceThicknessRange[0],At.iridescenceThicknessMaximum.value=gt.iridescenceThicknessRange[1],gt.iridescenceMap&&(At.iridescenceMap.value=gt.iridescenceMap,et(gt.iridescenceMap,At.iridescenceMapTransform)),gt.iridescenceThicknessMap&&(At.iridescenceThicknessMap.value=gt.iridescenceThicknessMap,et(gt.iridescenceThicknessMap,At.iridescenceThicknessMapTransform))),gt.transmission>0&&(At.transmission.value=gt.transmission,At.transmissionSamplerMap.value=bt.texture,At.transmissionSamplerSize.value.set(bt.width,bt.height),gt.transmissionMap&&(At.transmissionMap.value=gt.transmissionMap,et(gt.transmissionMap,At.transmissionMapTransform)),At.thickness.value=gt.thickness,gt.thicknessMap&&(At.thicknessMap.value=gt.thicknessMap,et(gt.thicknessMap,At.thicknessMapTransform)),At.attenuationDistance.value=gt.attenuationDistance,At.attenuationColor.value.copy(gt.attenuationColor)),gt.anisotropy>0&&(At.anisotropyVector.value.set(gt.anisotropy*Math.cos(gt.anisotropyRotation),gt.anisotropy*Math.sin(gt.anisotropyRotation)),gt.anisotropyMap&&(At.anisotropyMap.value=gt.anisotropyMap,et(gt.anisotropyMap,At.anisotropyMapTransform))),At.specularIntensity.value=gt.specularIntensity,At.specularColor.value.copy(gt.specularColor),gt.specularColorMap&&(At.specularColorMap.value=gt.specularColorMap,et(gt.specularColorMap,At.specularColorMapTransform)),gt.specularIntensityMap&&(At.specularIntensityMap.value=gt.specularIntensityMap,et(gt.specularIntensityMap,At.specularIntensityMapTransform))}function pt(At,gt){gt.matcap&&(At.matcap.value=gt.matcap)}function mt(At,gt){const bt=_e.get(gt).light;At.referencePosition.value.setFromMatrixPosition(bt.matrixWorld),At.nearDistance.value=bt.shadow.camera.near,At.farDistance.value=bt.shadow.camera.far}return{refreshFogUniforms:rt,refreshMaterialUniforms:it}}function WebGLUniformsGroups(nt,_e,et,rt){let it={},st={},ot=[];const at=nt.getParameter(nt.MAX_UNIFORM_BUFFER_BINDINGS);function lt(bt,Tt){const wt=Tt.program;rt.uniformBlockBinding(bt,wt)}function ct(bt,Tt){let wt=it[bt.id];wt===void 0&&(pt(bt),wt=ut(bt),it[bt.id]=wt,bt.addEventListener("dispose",At));const Rt=Tt.program;rt.updateUBOMapping(bt,Rt);const It=_e.render.frame;st[bt.id]!==It&&(dt(bt),st[bt.id]=It)}function ut(bt){const Tt=ht();bt.__bindingPointIndex=Tt;const wt=nt.createBuffer(),Rt=bt.__size,It=bt.usage;return nt.bindBuffer(nt.UNIFORM_BUFFER,wt),nt.bufferData(nt.UNIFORM_BUFFER,Rt,It),nt.bindBuffer(nt.UNIFORM_BUFFER,null),nt.bindBufferBase(nt.UNIFORM_BUFFER,Tt,wt),wt}function ht(){for(let bt=0;bt<at;bt++)if(ot.indexOf(bt)===-1)return ot.push(bt),bt;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function dt(bt){const Tt=it[bt.id],wt=bt.uniforms,Rt=bt.__cache;nt.bindBuffer(nt.UNIFORM_BUFFER,Tt);for(let It=0,Lt=wt.length;It<Lt;It++){const $t=Array.isArray(wt[It])?wt[It]:[wt[It]];for(let kt=0,Dt=$t.length;kt<Dt;kt++){const Ot=$t[kt];if(ft(Ot,It,kt,Rt)===!0){const zt=Ot.__offset,Ht=Array.isArray(Ot.value)?Ot.value:[Ot.value];let Yt=0;for(let Xt=0;Xt<Ht.length;Xt++){const Zt=Ht[Xt],rn=mt(Zt);typeof Zt=="number"||typeof Zt=="boolean"?(Ot.__data[0]=Zt,nt.bufferSubData(nt.UNIFORM_BUFFER,zt+Yt,Ot.__data)):Zt.isMatrix3?(Ot.__data[0]=Zt.elements[0],Ot.__data[1]=Zt.elements[1],Ot.__data[2]=Zt.elements[2],Ot.__data[3]=0,Ot.__data[4]=Zt.elements[3],Ot.__data[5]=Zt.elements[4],Ot.__data[6]=Zt.elements[5],Ot.__data[7]=0,Ot.__data[8]=Zt.elements[6],Ot.__data[9]=Zt.elements[7],Ot.__data[10]=Zt.elements[8],Ot.__data[11]=0):(Zt.toArray(Ot.__data,Yt),Yt+=rn.storage/Float32Array.BYTES_PER_ELEMENT)}nt.bufferSubData(nt.UNIFORM_BUFFER,zt,Ot.__data)}}}nt.bindBuffer(nt.UNIFORM_BUFFER,null)}function ft(bt,Tt,wt,Rt){const It=bt.value,Lt=Tt+"_"+wt;if(Rt[Lt]===void 0)return typeof It=="number"||typeof It=="boolean"?Rt[Lt]=It:Rt[Lt]=It.clone(),!0;{const $t=Rt[Lt];if(typeof It=="number"||typeof It=="boolean"){if($t!==It)return Rt[Lt]=It,!0}else if($t.equals(It)===!1)return $t.copy(It),!0}return!1}function pt(bt){const Tt=bt.uniforms;let wt=0;const Rt=16;for(let Lt=0,$t=Tt.length;Lt<$t;Lt++){const kt=Array.isArray(Tt[Lt])?Tt[Lt]:[Tt[Lt]];for(let Dt=0,Ot=kt.length;Dt<Ot;Dt++){const zt=kt[Dt],Ht=Array.isArray(zt.value)?zt.value:[zt.value];for(let Yt=0,Xt=Ht.length;Yt<Xt;Yt++){const Zt=Ht[Yt],rn=mt(Zt),Gt=wt%Rt,jt=Gt%rn.boundary,Kt=Gt+jt;wt+=jt,Kt!==0&&Rt-Kt<rn.storage&&(wt+=Rt-Kt),zt.__data=new Float32Array(rn.storage/Float32Array.BYTES_PER_ELEMENT),zt.__offset=wt,wt+=rn.storage}}}const It=wt%Rt;return It>0&&(wt+=Rt-It),bt.__size=wt,bt.__cache={},this}function mt(bt){const Tt={boundary:0,storage:0};return typeof bt=="number"||typeof bt=="boolean"?(Tt.boundary=4,Tt.storage=4):bt.isVector2?(Tt.boundary=8,Tt.storage=8):bt.isVector3||bt.isColor?(Tt.boundary=16,Tt.storage=12):bt.isVector4?(Tt.boundary=16,Tt.storage=16):bt.isMatrix3?(Tt.boundary=48,Tt.storage=48):bt.isMatrix4?(Tt.boundary=64,Tt.storage=64):bt.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",bt),Tt}function At(bt){const Tt=bt.target;Tt.removeEventListener("dispose",At);const wt=ot.indexOf(Tt.__bindingPointIndex);ot.splice(wt,1),nt.deleteBuffer(it[Tt.id]),delete it[Tt.id],delete st[Tt.id]}function gt(){for(const bt in it)nt.deleteBuffer(it[bt]);ot=[],it={},st={}}return{bind:lt,update:ct,dispose:gt}}class WebGLRenderer{constructor(_e={}){const{canvas:et=createCanvasElement$1(),context:rt=null,depth:it=!0,stencil:st=!1,alpha:ot=!1,antialias:at=!1,premultipliedAlpha:lt=!0,preserveDrawingBuffer:ct=!1,powerPreference:ut="default",failIfMajorPerformanceCaveat:ht=!1}=_e;this.isWebGLRenderer=!0;let dt;if(rt!==null){if(typeof WebGLRenderingContext<"u"&&rt instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");dt=rt.getContextAttributes().alpha}else dt=ot;const ft=new Uint32Array(4),pt=new Int32Array(4);let mt=null,At=null;const gt=[],bt=[];this.domElement=et,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace$2,this.toneMapping=NoToneMapping$1,this.toneMappingExposure=1;const Tt=this;let wt=!1,Rt=0,It=0,Lt=null,$t=-1,kt=null;const Dt=new Vector4$1,Ot=new Vector4$1;let zt=null;const Ht=new Color$2(0);let Yt=0,Xt=et.width,Zt=et.height,rn=1,Gt=null,jt=null;const Kt=new Vector4$1(0,0,Xt,Zt),Jt=new Vector4$1(0,0,Xt,Zt);let sn=!1;const hn=new Frustum$1;let an=!1,pn=!1;const _n=new Matrix4$1,yn=new Matrix4$1,$n=new Vector3$1,Jn=new Vector4$1,Xn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Vn=!1;function En(){return Lt===null?rn:1}let dn=rt;function rr(ln,Rn){return et.getContext(ln,Rn)}try{const ln={alpha:!0,depth:it,stencil:st,antialias:at,premultipliedAlpha:lt,preserveDrawingBuffer:ct,powerPreference:ut,failIfMajorPerformanceCaveat:ht};if("setAttribute"in et&&et.setAttribute("data-engine",`three.js r${REVISION$1}`),et.addEventListener("webglcontextlost",nr,!1),et.addEventListener("webglcontextrestored",Ir,!1),et.addEventListener("webglcontextcreationerror",Dn,!1),dn===null){const Rn="webgl2";if(dn=rr(Rn,ln),dn===null)throw rr(Rn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ln){throw console.error("THREE.WebGLRenderer: "+ln.message),ln}let er,Yn,ir,Qn,sr,un,en,wn,gn,Mn,In,gr,jn,hr,Tr,cr,yr,Rr,br,pr,vn,qn,vr,Sn;function Ar(){er=new WebGLExtensions$1(dn),er.init(),qn=new WebGLUtils$1(dn,er),Yn=new WebGLCapabilities$1(dn,er,_e,qn),ir=new WebGLState$1(dn),Yn.reverseDepthBuffer&&ir.buffers.depth.setReversed(!0),Qn=new WebGLInfo(dn),sr=new WebGLProperties,un=new WebGLTextures(dn,er,ir,sr,Yn,qn,Qn),en=new WebGLCubeMaps(Tt),wn=new WebGLCubeUVMaps(Tt),gn=new WebGLAttributes(dn),vr=new WebGLBindingStates(dn,gn),Mn=new WebGLGeometries(dn,gn,Qn,vr),In=new WebGLObjects(dn,Mn,gn,Qn),br=new WebGLMorphtargets(dn,Yn,un),cr=new WebGLClipping(sr),gr=new WebGLPrograms(Tt,en,wn,er,Yn,vr,cr),jn=new WebGLMaterials(Tt,sr),hr=new WebGLRenderLists,Tr=new WebGLRenderStates(er),Rr=new WebGLBackground(Tt,en,wn,ir,In,dt,lt),yr=new WebGLShadowMap(Tt,In,Yn),Sn=new WebGLUniformsGroups(dn,Qn,Yn,ir),pr=new WebGLBufferRenderer$1(dn,er,Qn),vn=new WebGLIndexedBufferRenderer(dn,er,Qn),Qn.programs=gr.programs,Tt.capabilities=Yn,Tt.extensions=er,Tt.properties=sr,Tt.renderLists=hr,Tt.shadowMap=yr,Tt.state=ir,Tt.info=Qn}Ar();const Nn=new WebXRManager(Tt,dn);this.xr=Nn,this.getContext=function(){return dn},this.getContextAttributes=function(){return dn.getContextAttributes()},this.forceContextLoss=function(){const ln=er.get("WEBGL_lose_context");ln&&ln.loseContext()},this.forceContextRestore=function(){const ln=er.get("WEBGL_lose_context");ln&&ln.restoreContext()},this.getPixelRatio=function(){return rn},this.setPixelRatio=function(ln){ln!==void 0&&(rn=ln,this.setSize(Xt,Zt,!1))},this.getSize=function(ln){return ln.set(Xt,Zt)},this.setSize=function(ln,Rn,Wn=!0){if(Nn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Xt=ln,Zt=Rn,et.width=Math.floor(ln*rn),et.height=Math.floor(Rn*rn),Wn===!0&&(et.style.width=ln+"px",et.style.height=Rn+"px"),this.setViewport(0,0,ln,Rn)},this.getDrawingBufferSize=function(ln){return ln.set(Xt*rn,Zt*rn).floor()},this.setDrawingBufferSize=function(ln,Rn,Wn){Xt=ln,Zt=Rn,rn=Wn,et.width=Math.floor(ln*Wn),et.height=Math.floor(Rn*Wn),this.setViewport(0,0,ln,Rn)},this.getCurrentViewport=function(ln){return ln.copy(Dt)},this.getViewport=function(ln){return ln.copy(Kt)},this.setViewport=function(ln,Rn,Wn,Un){ln.isVector4?Kt.set(ln.x,ln.y,ln.z,ln.w):Kt.set(ln,Rn,Wn,Un),ir.viewport(Dt.copy(Kt).multiplyScalar(rn).round())},this.getScissor=function(ln){return ln.copy(Jt)},this.setScissor=function(ln,Rn,Wn,Un){ln.isVector4?Jt.set(ln.x,ln.y,ln.z,ln.w):Jt.set(ln,Rn,Wn,Un),ir.scissor(Ot.copy(Jt).multiplyScalar(rn).round())},this.getScissorTest=function(){return sn},this.setScissorTest=function(ln){ir.setScissorTest(sn=ln)},this.setOpaqueSort=function(ln){Gt=ln},this.setTransparentSort=function(ln){jt=ln},this.getClearColor=function(ln){return ln.copy(Rr.getClearColor())},this.setClearColor=function(){Rr.setClearColor.apply(Rr,arguments)},this.getClearAlpha=function(){return Rr.getClearAlpha()},this.setClearAlpha=function(){Rr.setClearAlpha.apply(Rr,arguments)},this.clear=function(ln=!0,Rn=!0,Wn=!0){let Un=0;if(ln){let Cn=!1;if(Lt!==null){const xr=Lt.texture.format;Cn=xr===RGBAIntegerFormat$1||xr===RGIntegerFormat$1||xr===RedIntegerFormat$1}if(Cn){const xr=Lt.texture.type,Nr=xr===UnsignedByteType$1||xr===UnsignedIntType$1||xr===UnsignedShortType$1||xr===UnsignedInt248Type$1||xr===UnsignedShort4444Type$1||xr===UnsignedShort5551Type$1,fr=Rr.getClearColor(),Fr=Rr.getClearAlpha(),Gr=fr.r,zr=fr.g,kr=fr.b;Nr?(ft[0]=Gr,ft[1]=zr,ft[2]=kr,ft[3]=Fr,dn.clearBufferuiv(dn.COLOR,0,ft)):(pt[0]=Gr,pt[1]=zr,pt[2]=kr,pt[3]=Fr,dn.clearBufferiv(dn.COLOR,0,pt))}else Un|=dn.COLOR_BUFFER_BIT}Rn&&(Un|=dn.DEPTH_BUFFER_BIT,dn.clearDepth(this.capabilities.reverseDepthBuffer?0:1)),Wn&&(Un|=dn.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),dn.clear(Un)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){et.removeEventListener("webglcontextlost",nr,!1),et.removeEventListener("webglcontextrestored",Ir,!1),et.removeEventListener("webglcontextcreationerror",Dn,!1),hr.dispose(),Tr.dispose(),sr.dispose(),en.dispose(),wn.dispose(),In.dispose(),vr.dispose(),Sn.dispose(),gr.dispose(),Nn.dispose(),Nn.removeEventListener("sessionstart",ks),Nn.removeEventListener("sessionend",Ps),$s.stop()};function nr(ln){ln.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),wt=!0}function Ir(){console.log("THREE.WebGLRenderer: Context Restored."),wt=!1;const ln=Qn.autoReset,Rn=yr.enabled,Wn=yr.autoUpdate,Un=yr.needsUpdate,Cn=yr.type;Ar(),Qn.autoReset=ln,yr.enabled=Rn,yr.autoUpdate=Wn,yr.needsUpdate=Un,yr.type=Cn}function Dn(ln){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ln.statusMessage)}function Pr(ln){const Rn=ln.target;Rn.removeEventListener("dispose",Pr),jr(Rn)}function jr(ln){Jr(ln),sr.remove(ln)}function Jr(ln){const Rn=sr.get(ln).programs;Rn!==void 0&&(Rn.forEach(function(Wn){gr.releaseProgram(Wn)}),ln.isShaderMaterial&&gr.releaseShaderCache(ln))}this.renderBufferDirect=function(ln,Rn,Wn,Un,Cn,xr){Rn===null&&(Rn=Xn);const Nr=Cn.isMesh&&Cn.matrixWorld.determinant()<0,fr=os(ln,Rn,Wn,Un,Cn);ir.setMaterial(Un,Nr);let Fr=Wn.index,Gr=1;if(Un.wireframe===!0){if(Fr=Mn.getWireframeAttribute(Wn),Fr===void 0)return;Gr=2}const zr=Wn.drawRange,kr=Wn.attributes.position;let ls=zr.start*Gr,ds=(zr.start+zr.count)*Gr;xr!==null&&(ls=Math.max(ls,xr.start*Gr),ds=Math.min(ds,(xr.start+xr.count)*Gr)),Fr!==null?(ls=Math.max(ls,0),ds=Math.min(ds,Fr.count)):kr!=null&&(ls=Math.max(ls,0),ds=Math.min(ds,kr.count));const ns=ds-ls;if(ns<0||ns===1/0)return;vr.setup(Cn,Un,fr,Wn,Fr);let wr,cn=pr;if(Fr!==null&&(wr=gn.get(Fr),cn=vn,cn.setIndex(wr)),Cn.isMesh)Un.wireframe===!0?(ir.setLineWidth(Un.wireframeLinewidth*En()),cn.setMode(dn.LINES)):cn.setMode(dn.TRIANGLES);else if(Cn.isLine){let mr=Un.linewidth;mr===void 0&&(mr=1),ir.setLineWidth(mr*En()),Cn.isLineSegments?cn.setMode(dn.LINES):Cn.isLineLoop?cn.setMode(dn.LINE_LOOP):cn.setMode(dn.LINE_STRIP)}else Cn.isPoints?cn.setMode(dn.POINTS):Cn.isSprite&&cn.setMode(dn.TRIANGLES);if(Cn.isBatchedMesh)if(Cn._multiDrawInstances!==null)cn.renderMultiDrawInstances(Cn._multiDrawStarts,Cn._multiDrawCounts,Cn._multiDrawCount,Cn._multiDrawInstances);else if(er.get("WEBGL_multi_draw"))cn.renderMultiDraw(Cn._multiDrawStarts,Cn._multiDrawCounts,Cn._multiDrawCount);else{const mr=Cn._multiDrawStarts,cs=Cn._multiDrawCounts,Xr=Cn._multiDrawCount,Gs=Fr?gn.get(Fr).bytesPerElement:1,Ws=sr.get(Un).currentProgram.getUniforms();for(let ys=0;ys<Xr;ys++)Ws.setValue(dn,"_gl_DrawID",ys),cn.render(mr[ys]/Gs,cs[ys])}else if(Cn.isInstancedMesh)cn.renderInstances(ls,ns,Cn.count);else if(Wn.isInstancedBufferGeometry){const mr=Wn._maxInstanceCount!==void 0?Wn._maxInstanceCount:1/0,cs=Math.min(Wn.instanceCount,mr);cn.renderInstances(ls,ns,cs)}else cn.render(ls,ns)};function Lr(ln,Rn,Wn){ln.transparent===!0&&ln.side===DoubleSide$1&&ln.forceSinglePass===!1?(ln.side=BackSide$1,ln.needsUpdate=!0,Or(ln,Rn,Wn),ln.side=FrontSide$1,ln.needsUpdate=!0,Or(ln,Rn,Wn),ln.side=DoubleSide$1):Or(ln,Rn,Wn)}this.compile=function(ln,Rn,Wn=null){Wn===null&&(Wn=ln),At=Tr.get(Wn),At.init(Rn),bt.push(At),Wn.traverseVisible(function(Cn){Cn.isLight&&Cn.layers.test(Rn.layers)&&(At.pushLight(Cn),Cn.castShadow&&At.pushShadow(Cn))}),ln!==Wn&&ln.traverseVisible(function(Cn){Cn.isLight&&Cn.layers.test(Rn.layers)&&(At.pushLight(Cn),Cn.castShadow&&At.pushShadow(Cn))}),At.setupLights();const Un=new Set;return ln.traverse(function(Cn){if(!(Cn.isMesh||Cn.isPoints||Cn.isLine||Cn.isSprite))return;const xr=Cn.material;if(xr)if(Array.isArray(xr))for(let Nr=0;Nr<xr.length;Nr++){const fr=xr[Nr];Lr(fr,Wn,Cn),Un.add(fr)}else Lr(xr,Wn,Cn),Un.add(xr)}),bt.pop(),At=null,Un},this.compileAsync=function(ln,Rn,Wn=null){const Un=this.compile(ln,Rn,Wn);return new Promise(Cn=>{function xr(){if(Un.forEach(function(Nr){sr.get(Nr).currentProgram.isReady()&&Un.delete(Nr)}),Un.size===0){Cn(ln);return}setTimeout(xr,10)}er.get("KHR_parallel_shader_compile")!==null?xr():setTimeout(xr,10)})};let Wr=null;function As(ln){Wr&&Wr(ln)}function ks(){$s.stop()}function Ps(){$s.start()}const $s=new WebGLAnimation;$s.setAnimationLoop(As),typeof self<"u"&&$s.setContext(self),this.setAnimationLoop=function(ln){Wr=ln,Nn.setAnimationLoop(ln),ln===null?$s.stop():$s.start()},Nn.addEventListener("sessionstart",ks),Nn.addEventListener("sessionend",Ps),this.render=function(ln,Rn){if(Rn!==void 0&&Rn.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(wt===!0)return;if(ln.matrixWorldAutoUpdate===!0&&ln.updateMatrixWorld(),Rn.parent===null&&Rn.matrixWorldAutoUpdate===!0&&Rn.updateMatrixWorld(),Nn.enabled===!0&&Nn.isPresenting===!0&&(Nn.cameraAutoUpdate===!0&&Nn.updateCamera(Rn),Rn=Nn.getCamera()),ln.isScene===!0&&ln.onBeforeRender(Tt,ln,Rn,Lt),At=Tr.get(ln,bt.length),At.init(Rn),bt.push(At),yn.multiplyMatrices(Rn.projectionMatrix,Rn.matrixWorldInverse),hn.setFromProjectionMatrix(yn),pn=this.localClippingEnabled,an=cr.init(this.clippingPlanes,pn),mt=hr.get(ln,gt.length),mt.init(),gt.push(mt),Nn.enabled===!0&&Nn.isPresenting===!0){const xr=Tt.xr.getDepthSensingMesh();xr!==null&&eo(xr,Rn,-1/0,Tt.sortObjects)}eo(ln,Rn,0,Tt.sortObjects),mt.finish(),Tt.sortObjects===!0&&mt.sort(Gt,jt),Vn=Nn.enabled===!1||Nn.isPresenting===!1||Nn.hasDepthSensing()===!1,Vn&&Rr.addToRenderList(mt,ln),this.info.render.frame++,an===!0&&cr.beginShadows();const Wn=At.state.shadowsArray;yr.render(Wn,ln,Rn),an===!0&&cr.endShadows(),this.info.autoReset===!0&&this.info.reset();const Un=mt.opaque,Cn=mt.transmissive;if(At.setupLights(),Rn.isArrayCamera){const xr=Rn.cameras;if(Cn.length>0)for(let Nr=0,fr=xr.length;Nr<fr;Nr++){const Fr=xr[Nr];zn(Un,Cn,ln,Fr)}Vn&&Rr.render(ln);for(let Nr=0,fr=xr.length;Nr<fr;Nr++){const Fr=xr[Nr];Us(mt,ln,Fr,Fr.viewport)}}else Cn.length>0&&zn(Un,Cn,ln,Rn),Vn&&Rr.render(ln),Us(mt,ln,Rn);Lt!==null&&(un.updateMultisampleRenderTarget(Lt),un.updateRenderTargetMipmap(Lt)),ln.isScene===!0&&ln.onAfterRender(Tt,ln,Rn),vr.resetDefaultState(),$t=-1,kt=null,bt.pop(),bt.length>0?(At=bt[bt.length-1],an===!0&&cr.setGlobalState(Tt.clippingPlanes,At.state.camera)):At=null,gt.pop(),gt.length>0?mt=gt[gt.length-1]:mt=null};function eo(ln,Rn,Wn,Un){if(ln.visible===!1)return;if(ln.layers.test(Rn.layers)){if(ln.isGroup)Wn=ln.renderOrder;else if(ln.isLOD)ln.autoUpdate===!0&&ln.update(Rn);else if(ln.isLight)At.pushLight(ln),ln.castShadow&&At.pushShadow(ln);else if(ln.isSprite){if(!ln.frustumCulled||hn.intersectsSprite(ln)){Un&&Jn.setFromMatrixPosition(ln.matrixWorld).applyMatrix4(yn);const Nr=In.update(ln),fr=ln.material;fr.visible&&mt.push(ln,Nr,fr,Wn,Jn.z,null)}}else if((ln.isMesh||ln.isLine||ln.isPoints)&&(!ln.frustumCulled||hn.intersectsObject(ln))){const Nr=In.update(ln),fr=ln.material;if(Un&&(ln.boundingSphere!==void 0?(ln.boundingSphere===null&&ln.computeBoundingSphere(),Jn.copy(ln.boundingSphere.center)):(Nr.boundingSphere===null&&Nr.computeBoundingSphere(),Jn.copy(Nr.boundingSphere.center)),Jn.applyMatrix4(ln.matrixWorld).applyMatrix4(yn)),Array.isArray(fr)){const Fr=Nr.groups;for(let Gr=0,zr=Fr.length;Gr<zr;Gr++){const kr=Fr[Gr],ls=fr[kr.materialIndex];ls&&ls.visible&&mt.push(ln,Nr,ls,Wn,Jn.z,kr)}}else fr.visible&&mt.push(ln,Nr,fr,Wn,Jn.z,null)}}const xr=ln.children;for(let Nr=0,fr=xr.length;Nr<fr;Nr++)eo(xr[Nr],Rn,Wn,Un)}function Us(ln,Rn,Wn,Un){const Cn=ln.opaque,xr=ln.transmissive,Nr=ln.transparent;At.setupLightsView(Wn),an===!0&&cr.setGlobalState(Tt.clippingPlanes,Wn),Un&&ir.viewport(Dt.copy(Un)),Cn.length>0&&lr(Cn,Rn,Wn),xr.length>0&&lr(xr,Rn,Wn),Nr.length>0&&lr(Nr,Rn,Wn),ir.buffers.depth.setTest(!0),ir.buffers.depth.setMask(!0),ir.buffers.color.setMask(!0),ir.setPolygonOffset(!1)}function zn(ln,Rn,Wn,Un){if((Wn.isScene===!0?Wn.overrideMaterial:null)!==null)return;At.state.transmissionRenderTarget[Un.id]===void 0&&(At.state.transmissionRenderTarget[Un.id]=new WebGLRenderTarget$1(1,1,{generateMipmaps:!0,type:er.has("EXT_color_buffer_half_float")||er.has("EXT_color_buffer_float")?HalfFloatType$1:UnsignedByteType$1,minFilter:LinearMipmapLinearFilter$1,samples:4,stencilBuffer:st,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ColorManagement$1.workingColorSpace}));const xr=At.state.transmissionRenderTarget[Un.id],Nr=Un.viewport||Dt;xr.setSize(Nr.z,Nr.w);const fr=Tt.getRenderTarget();Tt.setRenderTarget(xr),Tt.getClearColor(Ht),Yt=Tt.getClearAlpha(),Yt<1&&Tt.setClearColor(16777215,.5),Tt.clear(),Vn&&Rr.render(Wn);const Fr=Tt.toneMapping;Tt.toneMapping=NoToneMapping$1;const Gr=Un.viewport;if(Un.viewport!==void 0&&(Un.viewport=void 0),At.setupLightsView(Un),an===!0&&cr.setGlobalState(Tt.clippingPlanes,Un),lr(ln,Wn,Un),un.updateMultisampleRenderTarget(xr),un.updateRenderTargetMipmap(xr),er.has("WEBGL_multisampled_render_to_texture")===!1){let zr=!1;for(let kr=0,ls=Rn.length;kr<ls;kr++){const ds=Rn[kr],ns=ds.object,wr=ds.geometry,cn=ds.material,mr=ds.group;if(cn.side===DoubleSide$1&&ns.layers.test(Un.layers)){const cs=cn.side;cn.side=BackSide$1,cn.needsUpdate=!0,Sr(ns,Wn,Un,wr,cn,mr),cn.side=cs,cn.needsUpdate=!0,zr=!0}}zr===!0&&(un.updateMultisampleRenderTarget(xr),un.updateRenderTargetMipmap(xr))}Tt.setRenderTarget(fr),Tt.setClearColor(Ht,Yt),Gr!==void 0&&(Un.viewport=Gr),Tt.toneMapping=Fr}function lr(ln,Rn,Wn){const Un=Rn.isScene===!0?Rn.overrideMaterial:null;for(let Cn=0,xr=ln.length;Cn<xr;Cn++){const Nr=ln[Cn],fr=Nr.object,Fr=Nr.geometry,Gr=Un===null?Nr.material:Un,zr=Nr.group;fr.layers.test(Wn.layers)&&Sr(fr,Rn,Wn,Fr,Gr,zr)}}function Sr(ln,Rn,Wn,Un,Cn,xr){ln.onBeforeRender(Tt,Rn,Wn,Un,Cn,xr),ln.modelViewMatrix.multiplyMatrices(Wn.matrixWorldInverse,ln.matrixWorld),ln.normalMatrix.getNormalMatrix(ln.modelViewMatrix),Cn.onBeforeRender(Tt,Rn,Wn,Un,ln,xr),Cn.transparent===!0&&Cn.side===DoubleSide$1&&Cn.forceSinglePass===!1?(Cn.side=BackSide$1,Cn.needsUpdate=!0,Tt.renderBufferDirect(Wn,Rn,Un,Cn,ln,xr),Cn.side=FrontSide$1,Cn.needsUpdate=!0,Tt.renderBufferDirect(Wn,Rn,Un,Cn,ln,xr),Cn.side=DoubleSide$1):Tt.renderBufferDirect(Wn,Rn,Un,Cn,ln,xr),ln.onAfterRender(Tt,Rn,Wn,Un,Cn,xr)}function Or(ln,Rn,Wn){Rn.isScene!==!0&&(Rn=Xn);const Un=sr.get(ln),Cn=At.state.lights,xr=At.state.shadowsArray,Nr=Cn.state.version,fr=gr.getParameters(ln,Cn.state,xr,Rn,Wn),Fr=gr.getProgramCacheKey(fr);let Gr=Un.programs;Un.environment=ln.isMeshStandardMaterial?Rn.environment:null,Un.fog=Rn.fog,Un.envMap=(ln.isMeshStandardMaterial?wn:en).get(ln.envMap||Un.environment),Un.envMapRotation=Un.environment!==null&&ln.envMap===null?Rn.environmentRotation:ln.envMapRotation,Gr===void 0&&(ln.addEventListener("dispose",Pr),Gr=new Map,Un.programs=Gr);let zr=Gr.get(Fr);if(zr!==void 0){if(Un.currentProgram===zr&&Un.lightsStateVersion===Nr)return mn(ln,fr),zr}else fr.uniforms=gr.getUniforms(ln),ln.onBeforeCompile(fr,Tt),zr=gr.acquireProgram(fr,Fr),Gr.set(Fr,zr),Un.uniforms=fr.uniforms;const kr=Un.uniforms;return(!ln.isShaderMaterial&&!ln.isRawShaderMaterial||ln.clipping===!0)&&(kr.clippingPlanes=cr.uniform),mn(ln,fr),Un.needsLights=Bs(ln),Un.lightsStateVersion=Nr,Un.needsLights&&(kr.ambientLightColor.value=Cn.state.ambient,kr.lightProbe.value=Cn.state.probe,kr.directionalLights.value=Cn.state.directional,kr.directionalLightShadows.value=Cn.state.directionalShadow,kr.spotLights.value=Cn.state.spot,kr.spotLightShadows.value=Cn.state.spotShadow,kr.rectAreaLights.value=Cn.state.rectArea,kr.ltc_1.value=Cn.state.rectAreaLTC1,kr.ltc_2.value=Cn.state.rectAreaLTC2,kr.pointLights.value=Cn.state.point,kr.pointLightShadows.value=Cn.state.pointShadow,kr.hemisphereLights.value=Cn.state.hemi,kr.directionalShadowMap.value=Cn.state.directionalShadowMap,kr.directionalShadowMatrix.value=Cn.state.directionalShadowMatrix,kr.spotShadowMap.value=Cn.state.spotShadowMap,kr.spotLightMatrix.value=Cn.state.spotLightMatrix,kr.spotLightMap.value=Cn.state.spotLightMap,kr.pointShadowMap.value=Cn.state.pointShadowMap,kr.pointShadowMatrix.value=Cn.state.pointShadowMatrix),Un.currentProgram=zr,Un.uniformsList=null,zr}function xt(ln){if(ln.uniformsList===null){const Rn=ln.currentProgram.getUniforms();ln.uniformsList=WebGLUniforms.seqWithValue(Rn.seq,ln.uniforms)}return ln.uniformsList}function mn(ln,Rn){const Wn=sr.get(ln);Wn.outputColorSpace=Rn.outputColorSpace,Wn.batching=Rn.batching,Wn.batchingColor=Rn.batchingColor,Wn.instancing=Rn.instancing,Wn.instancingColor=Rn.instancingColor,Wn.instancingMorph=Rn.instancingMorph,Wn.skinning=Rn.skinning,Wn.morphTargets=Rn.morphTargets,Wn.morphNormals=Rn.morphNormals,Wn.morphColors=Rn.morphColors,Wn.morphTargetsCount=Rn.morphTargetsCount,Wn.numClippingPlanes=Rn.numClippingPlanes,Wn.numIntersection=Rn.numClipIntersection,Wn.vertexAlphas=Rn.vertexAlphas,Wn.vertexTangents=Rn.vertexTangents,Wn.toneMapping=Rn.toneMapping}function os(ln,Rn,Wn,Un,Cn){Rn.isScene!==!0&&(Rn=Xn),un.resetTextureUnits();const xr=Rn.fog,Nr=Un.isMeshStandardMaterial?Rn.environment:null,fr=Lt===null?Tt.outputColorSpace:Lt.isXRRenderTarget===!0?Lt.texture.colorSpace:LinearSRGBColorSpace$2,Fr=(Un.isMeshStandardMaterial?wn:en).get(Un.envMap||Nr),Gr=Un.vertexColors===!0&&!!Wn.attributes.color&&Wn.attributes.color.itemSize===4,zr=!!Wn.attributes.tangent&&(!!Un.normalMap||Un.anisotropy>0),kr=!!Wn.morphAttributes.position,ls=!!Wn.morphAttributes.normal,ds=!!Wn.morphAttributes.color;let ns=NoToneMapping$1;Un.toneMapped&&(Lt===null||Lt.isXRRenderTarget===!0)&&(ns=Tt.toneMapping);const wr=Wn.morphAttributes.position||Wn.morphAttributes.normal||Wn.morphAttributes.color,cn=wr!==void 0?wr.length:0,mr=sr.get(Un),cs=At.state.lights;if(an===!0&&(pn===!0||ln!==kt)){const ws=ln===kt&&Un.id===$t;cr.setState(Un,ln,ws)}let Xr=!1;Un.version===mr.__version?(mr.needsLights&&mr.lightsStateVersion!==cs.state.version||mr.outputColorSpace!==fr||Cn.isBatchedMesh&&mr.batching===!1||!Cn.isBatchedMesh&&mr.batching===!0||Cn.isBatchedMesh&&mr.batchingColor===!0&&Cn.colorTexture===null||Cn.isBatchedMesh&&mr.batchingColor===!1&&Cn.colorTexture!==null||Cn.isInstancedMesh&&mr.instancing===!1||!Cn.isInstancedMesh&&mr.instancing===!0||Cn.isSkinnedMesh&&mr.skinning===!1||!Cn.isSkinnedMesh&&mr.skinning===!0||Cn.isInstancedMesh&&mr.instancingColor===!0&&Cn.instanceColor===null||Cn.isInstancedMesh&&mr.instancingColor===!1&&Cn.instanceColor!==null||Cn.isInstancedMesh&&mr.instancingMorph===!0&&Cn.morphTexture===null||Cn.isInstancedMesh&&mr.instancingMorph===!1&&Cn.morphTexture!==null||mr.envMap!==Fr||Un.fog===!0&&mr.fog!==xr||mr.numClippingPlanes!==void 0&&(mr.numClippingPlanes!==cr.numPlanes||mr.numIntersection!==cr.numIntersection)||mr.vertexAlphas!==Gr||mr.vertexTangents!==zr||mr.morphTargets!==kr||mr.morphNormals!==ls||mr.morphColors!==ds||mr.toneMapping!==ns||mr.morphTargetsCount!==cn)&&(Xr=!0):(Xr=!0,mr.__version=Un.version);let Gs=mr.currentProgram;Xr===!0&&(Gs=Or(Un,Rn,Cn));let Ws=!1,ys=!1,fn=!1;const Ts=Gs.getUniforms(),Ao=mr.uniforms;if(ir.useProgram(Gs.program)&&(Ws=!0,ys=!0,fn=!0),Un.id!==$t&&($t=Un.id,ys=!0),Ws||kt!==ln){Yn.reverseDepthBuffer?(_n.copy(ln.projectionMatrix),toNormalizedProjectionMatrix(_n),toReversedProjectionMatrix(_n),Ts.setValue(dn,"projectionMatrix",_n)):Ts.setValue(dn,"projectionMatrix",ln.projectionMatrix),Ts.setValue(dn,"viewMatrix",ln.matrixWorldInverse);const ws=Ts.map.cameraPosition;ws!==void 0&&ws.setValue(dn,$n.setFromMatrixPosition(ln.matrixWorld)),Yn.logarithmicDepthBuffer&&Ts.setValue(dn,"logDepthBufFC",2/(Math.log(ln.far+1)/Math.LN2)),(Un.isMeshPhongMaterial||Un.isMeshToonMaterial||Un.isMeshLambertMaterial||Un.isMeshBasicMaterial||Un.isMeshStandardMaterial||Un.isShaderMaterial)&&Ts.setValue(dn,"isOrthographic",ln.isOrthographicCamera===!0),kt!==ln&&(kt=ln,ys=!0,fn=!0)}if(Cn.isSkinnedMesh){Ts.setOptional(dn,Cn,"bindMatrix"),Ts.setOptional(dn,Cn,"bindMatrixInverse");const ws=Cn.skeleton;ws&&(ws.boneTexture===null&&ws.computeBoneTexture(),Ts.setValue(dn,"boneTexture",ws.boneTexture,un))}Cn.isBatchedMesh&&(Ts.setOptional(dn,Cn,"batchingTexture"),Ts.setValue(dn,"batchingTexture",Cn._matricesTexture,un),Ts.setOptional(dn,Cn,"batchingIdTexture"),Ts.setValue(dn,"batchingIdTexture",Cn._indirectTexture,un),Ts.setOptional(dn,Cn,"batchingColorTexture"),Cn._colorsTexture!==null&&Ts.setValue(dn,"batchingColorTexture",Cn._colorsTexture,un));const Io=Wn.morphAttributes;if((Io.position!==void 0||Io.normal!==void 0||Io.color!==void 0)&&br.update(Cn,Wn,Gs),(ys||mr.receiveShadow!==Cn.receiveShadow)&&(mr.receiveShadow=Cn.receiveShadow,Ts.setValue(dn,"receiveShadow",Cn.receiveShadow)),Un.isMeshGouraudMaterial&&Un.envMap!==null&&(Ao.envMap.value=Fr,Ao.flipEnvMap.value=Fr.isCubeTexture&&Fr.isRenderTargetTexture===!1?-1:1),Un.isMeshStandardMaterial&&Un.envMap===null&&Rn.environment!==null&&(Ao.envMapIntensity.value=Rn.environmentIntensity),ys&&(Ts.setValue(dn,"toneMappingExposure",Tt.toneMappingExposure),mr.needsLights&&gs(Ao,fn),xr&&Un.fog===!0&&jn.refreshFogUniforms(Ao,xr),jn.refreshMaterialUniforms(Ao,Un,rn,Zt,At.state.transmissionRenderTarget[ln.id]),WebGLUniforms.upload(dn,xt(mr),Ao,un)),Un.isShaderMaterial&&Un.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(dn,xt(mr),Ao,un),Un.uniformsNeedUpdate=!1),Un.isSpriteMaterial&&Ts.setValue(dn,"center",Cn.center),Ts.setValue(dn,"modelViewMatrix",Cn.modelViewMatrix),Ts.setValue(dn,"normalMatrix",Cn.normalMatrix),Ts.setValue(dn,"modelMatrix",Cn.matrixWorld),Un.isShaderMaterial||Un.isRawShaderMaterial){const ws=Un.uniformsGroups;for(let to=0,Pl=ws.length;to<Pl;to++){const Go=ws[to];Sn.update(Go,Gs),Sn.bind(Go,Gs)}}return Gs}function gs(ln,Rn){ln.ambientLightColor.needsUpdate=Rn,ln.lightProbe.needsUpdate=Rn,ln.directionalLights.needsUpdate=Rn,ln.directionalLightShadows.needsUpdate=Rn,ln.pointLights.needsUpdate=Rn,ln.pointLightShadows.needsUpdate=Rn,ln.spotLights.needsUpdate=Rn,ln.spotLightShadows.needsUpdate=Rn,ln.rectAreaLights.needsUpdate=Rn,ln.hemisphereLights.needsUpdate=Rn}function Bs(ln){return ln.isMeshLambertMaterial||ln.isMeshToonMaterial||ln.isMeshPhongMaterial||ln.isMeshStandardMaterial||ln.isShadowMaterial||ln.isShaderMaterial&&ln.lights===!0}this.getActiveCubeFace=function(){return Rt},this.getActiveMipmapLevel=function(){return It},this.getRenderTarget=function(){return Lt},this.setRenderTargetTextures=function(ln,Rn,Wn){sr.get(ln.texture).__webglTexture=Rn,sr.get(ln.depthTexture).__webglTexture=Wn;const Un=sr.get(ln);Un.__hasExternalTextures=!0,Un.__autoAllocateDepthBuffer=Wn===void 0,Un.__autoAllocateDepthBuffer||er.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Un.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(ln,Rn){const Wn=sr.get(ln);Wn.__webglFramebuffer=Rn,Wn.__useDefaultFramebuffer=Rn===void 0},this.setRenderTarget=function(ln,Rn=0,Wn=0){Lt=ln,Rt=Rn,It=Wn;let Un=!0,Cn=null,xr=!1,Nr=!1;if(ln){const Fr=sr.get(ln);if(Fr.__useDefaultFramebuffer!==void 0)ir.bindFramebuffer(dn.FRAMEBUFFER,null),Un=!1;else if(Fr.__webglFramebuffer===void 0)un.setupRenderTarget(ln);else if(Fr.__hasExternalTextures)un.rebindTextures(ln,sr.get(ln.texture).__webglTexture,sr.get(ln.depthTexture).__webglTexture);else if(ln.depthBuffer){const kr=ln.depthTexture;if(Fr.__boundDepthTexture!==kr){if(kr!==null&&sr.has(kr)&&(ln.width!==kr.image.width||ln.height!==kr.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");un.setupDepthRenderbuffer(ln)}}const Gr=ln.texture;(Gr.isData3DTexture||Gr.isDataArrayTexture||Gr.isCompressedArrayTexture)&&(Nr=!0);const zr=sr.get(ln).__webglFramebuffer;ln.isWebGLCubeRenderTarget?(Array.isArray(zr[Rn])?Cn=zr[Rn][Wn]:Cn=zr[Rn],xr=!0):ln.samples>0&&un.useMultisampledRTT(ln)===!1?Cn=sr.get(ln).__webglMultisampledFramebuffer:Array.isArray(zr)?Cn=zr[Wn]:Cn=zr,Dt.copy(ln.viewport),Ot.copy(ln.scissor),zt=ln.scissorTest}else Dt.copy(Kt).multiplyScalar(rn).floor(),Ot.copy(Jt).multiplyScalar(rn).floor(),zt=sn;if(ir.bindFramebuffer(dn.FRAMEBUFFER,Cn)&&Un&&ir.drawBuffers(ln,Cn),ir.viewport(Dt),ir.scissor(Ot),ir.setScissorTest(zt),xr){const Fr=sr.get(ln.texture);dn.framebufferTexture2D(dn.FRAMEBUFFER,dn.COLOR_ATTACHMENT0,dn.TEXTURE_CUBE_MAP_POSITIVE_X+Rn,Fr.__webglTexture,Wn)}else if(Nr){const Fr=sr.get(ln.texture),Gr=Rn||0;dn.framebufferTextureLayer(dn.FRAMEBUFFER,dn.COLOR_ATTACHMENT0,Fr.__webglTexture,Wn||0,Gr)}$t=-1},this.readRenderTargetPixels=function(ln,Rn,Wn,Un,Cn,xr,Nr){if(!(ln&&ln.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let fr=sr.get(ln).__webglFramebuffer;if(ln.isWebGLCubeRenderTarget&&Nr!==void 0&&(fr=fr[Nr]),fr){ir.bindFramebuffer(dn.FRAMEBUFFER,fr);try{const Fr=ln.texture,Gr=Fr.format,zr=Fr.type;if(!Yn.textureFormatReadable(Gr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Yn.textureTypeReadable(zr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Rn>=0&&Rn<=ln.width-Un&&Wn>=0&&Wn<=ln.height-Cn&&dn.readPixels(Rn,Wn,Un,Cn,qn.convert(Gr),qn.convert(zr),xr)}finally{const Fr=Lt!==null?sr.get(Lt).__webglFramebuffer:null;ir.bindFramebuffer(dn.FRAMEBUFFER,Fr)}}},this.readRenderTargetPixelsAsync=async function(ln,Rn,Wn,Un,Cn,xr,Nr){if(!(ln&&ln.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let fr=sr.get(ln).__webglFramebuffer;if(ln.isWebGLCubeRenderTarget&&Nr!==void 0&&(fr=fr[Nr]),fr){const Fr=ln.texture,Gr=Fr.format,zr=Fr.type;if(!Yn.textureFormatReadable(Gr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Yn.textureTypeReadable(zr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Rn>=0&&Rn<=ln.width-Un&&Wn>=0&&Wn<=ln.height-Cn){ir.bindFramebuffer(dn.FRAMEBUFFER,fr);const kr=dn.createBuffer();dn.bindBuffer(dn.PIXEL_PACK_BUFFER,kr),dn.bufferData(dn.PIXEL_PACK_BUFFER,xr.byteLength,dn.STREAM_READ),dn.readPixels(Rn,Wn,Un,Cn,qn.convert(Gr),qn.convert(zr),0);const ls=Lt!==null?sr.get(Lt).__webglFramebuffer:null;ir.bindFramebuffer(dn.FRAMEBUFFER,ls);const ds=dn.fenceSync(dn.SYNC_GPU_COMMANDS_COMPLETE,0);return dn.flush(),await probeAsync(dn,ds,4),dn.bindBuffer(dn.PIXEL_PACK_BUFFER,kr),dn.getBufferSubData(dn.PIXEL_PACK_BUFFER,0,xr),dn.deleteBuffer(kr),dn.deleteSync(ds),xr}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(ln,Rn=null,Wn=0){ln.isTexture!==!0&&(warnOnce$1("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Rn=arguments[0]||null,ln=arguments[1]);const Un=Math.pow(2,-Wn),Cn=Math.floor(ln.image.width*Un),xr=Math.floor(ln.image.height*Un),Nr=Rn!==null?Rn.x:0,fr=Rn!==null?Rn.y:0;un.setTexture2D(ln,0),dn.copyTexSubImage2D(dn.TEXTURE_2D,Wn,0,0,Nr,fr,Cn,xr),ir.unbindTexture()},this.copyTextureToTexture=function(ln,Rn,Wn=null,Un=null,Cn=0){ln.isTexture!==!0&&(warnOnce$1("WebGLRenderer: copyTextureToTexture function signature has changed."),Un=arguments[0]||null,ln=arguments[1],Rn=arguments[2],Cn=arguments[3]||0,Wn=null);let xr,Nr,fr,Fr,Gr,zr;Wn!==null?(xr=Wn.max.x-Wn.min.x,Nr=Wn.max.y-Wn.min.y,fr=Wn.min.x,Fr=Wn.min.y):(xr=ln.image.width,Nr=ln.image.height,fr=0,Fr=0),Un!==null?(Gr=Un.x,zr=Un.y):(Gr=0,zr=0);const kr=qn.convert(Rn.format),ls=qn.convert(Rn.type);un.setTexture2D(Rn,0),dn.pixelStorei(dn.UNPACK_FLIP_Y_WEBGL,Rn.flipY),dn.pixelStorei(dn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Rn.premultiplyAlpha),dn.pixelStorei(dn.UNPACK_ALIGNMENT,Rn.unpackAlignment);const ds=dn.getParameter(dn.UNPACK_ROW_LENGTH),ns=dn.getParameter(dn.UNPACK_IMAGE_HEIGHT),wr=dn.getParameter(dn.UNPACK_SKIP_PIXELS),cn=dn.getParameter(dn.UNPACK_SKIP_ROWS),mr=dn.getParameter(dn.UNPACK_SKIP_IMAGES),cs=ln.isCompressedTexture?ln.mipmaps[Cn]:ln.image;dn.pixelStorei(dn.UNPACK_ROW_LENGTH,cs.width),dn.pixelStorei(dn.UNPACK_IMAGE_HEIGHT,cs.height),dn.pixelStorei(dn.UNPACK_SKIP_PIXELS,fr),dn.pixelStorei(dn.UNPACK_SKIP_ROWS,Fr),ln.isDataTexture?dn.texSubImage2D(dn.TEXTURE_2D,Cn,Gr,zr,xr,Nr,kr,ls,cs.data):ln.isCompressedTexture?dn.compressedTexSubImage2D(dn.TEXTURE_2D,Cn,Gr,zr,cs.width,cs.height,kr,cs.data):dn.texSubImage2D(dn.TEXTURE_2D,Cn,Gr,zr,xr,Nr,kr,ls,cs),dn.pixelStorei(dn.UNPACK_ROW_LENGTH,ds),dn.pixelStorei(dn.UNPACK_IMAGE_HEIGHT,ns),dn.pixelStorei(dn.UNPACK_SKIP_PIXELS,wr),dn.pixelStorei(dn.UNPACK_SKIP_ROWS,cn),dn.pixelStorei(dn.UNPACK_SKIP_IMAGES,mr),Cn===0&&Rn.generateMipmaps&&dn.generateMipmap(dn.TEXTURE_2D),ir.unbindTexture()},this.copyTextureToTexture3D=function(ln,Rn,Wn=null,Un=null,Cn=0){ln.isTexture!==!0&&(warnOnce$1("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Wn=arguments[0]||null,Un=arguments[1]||null,ln=arguments[2],Rn=arguments[3],Cn=arguments[4]||0);let xr,Nr,fr,Fr,Gr,zr,kr,ls,ds;const ns=ln.isCompressedTexture?ln.mipmaps[Cn]:ln.image;Wn!==null?(xr=Wn.max.x-Wn.min.x,Nr=Wn.max.y-Wn.min.y,fr=Wn.max.z-Wn.min.z,Fr=Wn.min.x,Gr=Wn.min.y,zr=Wn.min.z):(xr=ns.width,Nr=ns.height,fr=ns.depth,Fr=0,Gr=0,zr=0),Un!==null?(kr=Un.x,ls=Un.y,ds=Un.z):(kr=0,ls=0,ds=0);const wr=qn.convert(Rn.format),cn=qn.convert(Rn.type);let mr;if(Rn.isData3DTexture)un.setTexture3D(Rn,0),mr=dn.TEXTURE_3D;else if(Rn.isDataArrayTexture||Rn.isCompressedArrayTexture)un.setTexture2DArray(Rn,0),mr=dn.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}dn.pixelStorei(dn.UNPACK_FLIP_Y_WEBGL,Rn.flipY),dn.pixelStorei(dn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Rn.premultiplyAlpha),dn.pixelStorei(dn.UNPACK_ALIGNMENT,Rn.unpackAlignment);const cs=dn.getParameter(dn.UNPACK_ROW_LENGTH),Xr=dn.getParameter(dn.UNPACK_IMAGE_HEIGHT),Gs=dn.getParameter(dn.UNPACK_SKIP_PIXELS),Ws=dn.getParameter(dn.UNPACK_SKIP_ROWS),ys=dn.getParameter(dn.UNPACK_SKIP_IMAGES);dn.pixelStorei(dn.UNPACK_ROW_LENGTH,ns.width),dn.pixelStorei(dn.UNPACK_IMAGE_HEIGHT,ns.height),dn.pixelStorei(dn.UNPACK_SKIP_PIXELS,Fr),dn.pixelStorei(dn.UNPACK_SKIP_ROWS,Gr),dn.pixelStorei(dn.UNPACK_SKIP_IMAGES,zr),ln.isDataTexture||ln.isData3DTexture?dn.texSubImage3D(mr,Cn,kr,ls,ds,xr,Nr,fr,wr,cn,ns.data):Rn.isCompressedArrayTexture?dn.compressedTexSubImage3D(mr,Cn,kr,ls,ds,xr,Nr,fr,wr,ns.data):dn.texSubImage3D(mr,Cn,kr,ls,ds,xr,Nr,fr,wr,cn,ns),dn.pixelStorei(dn.UNPACK_ROW_LENGTH,cs),dn.pixelStorei(dn.UNPACK_IMAGE_HEIGHT,Xr),dn.pixelStorei(dn.UNPACK_SKIP_PIXELS,Gs),dn.pixelStorei(dn.UNPACK_SKIP_ROWS,Ws),dn.pixelStorei(dn.UNPACK_SKIP_IMAGES,ys),Cn===0&&Rn.generateMipmaps&&dn.generateMipmap(mr),ir.unbindTexture()},this.initRenderTarget=function(ln){sr.get(ln).__webglFramebuffer===void 0&&un.setupRenderTarget(ln)},this.initTexture=function(ln){ln.isCubeTexture?un.setTextureCube(ln,0):ln.isData3DTexture?un.setTexture3D(ln,0):ln.isDataArrayTexture||ln.isCompressedArrayTexture?un.setTexture2DArray(ln,0):un.setTexture2D(ln,0),ir.unbindTexture()},this.resetState=function(){Rt=0,It=0,Lt=null,ir.reset(),vr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem$1}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(_e){this._outputColorSpace=_e;const et=this.getContext();et.drawingBufferColorSpace=_e===DisplayP3ColorSpace$1?"display-p3":"srgb",et.unpackColorSpace=ColorManagement$1.workingColorSpace===LinearDisplayP3ColorSpace$1?"display-p3":"srgb"}}class FogExp2{constructor(_e,et=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color$2(_e),this.density=et}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(_e,et=1,rt=1e3){this.isFog=!0,this.name="",this.color=new Color$2(_e),this.near=et,this.far=rt}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let Scene$1=class extends Object3D$1{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler$1,this.environmentIntensity=1,this.environmentRotation=new Euler$1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_e,et){return super.copy(_e,et),_e.background!==null&&(this.background=_e.background.clone()),_e.environment!==null&&(this.environment=_e.environment.clone()),_e.fog!==null&&(this.fog=_e.fog.clone()),this.backgroundBlurriness=_e.backgroundBlurriness,this.backgroundIntensity=_e.backgroundIntensity,this.backgroundRotation.copy(_e.backgroundRotation),this.environmentIntensity=_e.environmentIntensity,this.environmentRotation.copy(_e.environmentRotation),_e.overrideMaterial!==null&&(this.overrideMaterial=_e.overrideMaterial.clone()),this.matrixAutoUpdate=_e.matrixAutoUpdate,this}toJSON(_e){const et=super.toJSON(_e);return this.fog!==null&&(et.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(et.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(et.object.backgroundIntensity=this.backgroundIntensity),et.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(et.object.environmentIntensity=this.environmentIntensity),et.object.environmentRotation=this.environmentRotation.toArray(),et}},InterleavedBuffer$1=class{constructor(_e,et){this.isInterleavedBuffer=!0,this.array=_e,this.stride=et,this.count=_e!==void 0?_e.length/et:0,this.usage=StaticDrawUsage$1,this.updateRanges=[],this.version=0,this.uuid=generateUUID$2()}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}addUpdateRange(_e,et){this.updateRanges.push({start:_e,count:et})}clearUpdateRanges(){this.updateRanges.length=0}copy(_e){return this.array=new _e.array.constructor(_e.array),this.count=_e.count,this.stride=_e.stride,this.usage=_e.usage,this}copyAt(_e,et,rt){_e*=this.stride,rt*=et.stride;for(let it=0,st=this.stride;it<st;it++)this.array[_e+it]=et.array[rt+it];return this}set(_e,et=0){return this.array.set(_e,et),this}clone(_e){_e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$2()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const et=new this.array.constructor(_e.arrayBuffers[this.array.buffer._uuid]),rt=new this.constructor(et,this.stride);return rt.setUsage(this.usage),rt}onUpload(_e){return this.onUploadCallback=_e,this}toJSON(_e){return _e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$2()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};const _vector$6$1=new Vector3$1;let InterleavedBufferAttribute$1=class v0{constructor(_e,et,rt,it=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_e,this.itemSize=et,this.offset=rt,this.normalized=it}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_e){this.data.needsUpdate=_e}applyMatrix4(_e){for(let et=0,rt=this.data.count;et<rt;et++)_vector$6$1.fromBufferAttribute(this,et),_vector$6$1.applyMatrix4(_e),this.setXYZ(et,_vector$6$1.x,_vector$6$1.y,_vector$6$1.z);return this}applyNormalMatrix(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$6$1.fromBufferAttribute(this,et),_vector$6$1.applyNormalMatrix(_e),this.setXYZ(et,_vector$6$1.x,_vector$6$1.y,_vector$6$1.z);return this}transformDirection(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$6$1.fromBufferAttribute(this,et),_vector$6$1.transformDirection(_e),this.setXYZ(et,_vector$6$1.x,_vector$6$1.y,_vector$6$1.z);return this}getComponent(_e,et){let rt=this.array[_e*this.data.stride+this.offset+et];return this.normalized&&(rt=denormalize$1(rt,this.array)),rt}setComponent(_e,et,rt){return this.normalized&&(rt=normalize$4(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+et]=rt,this}setX(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.data.array[_e*this.data.stride+this.offset]=et,this}setY(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.data.array[_e*this.data.stride+this.offset+1]=et,this}setZ(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.data.array[_e*this.data.stride+this.offset+2]=et,this}setW(_e,et){return this.normalized&&(et=normalize$4(et,this.array)),this.data.array[_e*this.data.stride+this.offset+3]=et,this}getX(_e){let et=this.data.array[_e*this.data.stride+this.offset];return this.normalized&&(et=denormalize$1(et,this.array)),et}getY(_e){let et=this.data.array[_e*this.data.stride+this.offset+1];return this.normalized&&(et=denormalize$1(et,this.array)),et}getZ(_e){let et=this.data.array[_e*this.data.stride+this.offset+2];return this.normalized&&(et=denormalize$1(et,this.array)),et}getW(_e){let et=this.data.array[_e*this.data.stride+this.offset+3];return this.normalized&&(et=denormalize$1(et,this.array)),et}setXY(_e,et,rt){return _e=_e*this.data.stride+this.offset,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array)),this.data.array[_e+0]=et,this.data.array[_e+1]=rt,this}setXYZ(_e,et,rt,it){return _e=_e*this.data.stride+this.offset,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array),it=normalize$4(it,this.array)),this.data.array[_e+0]=et,this.data.array[_e+1]=rt,this.data.array[_e+2]=it,this}setXYZW(_e,et,rt,it,st){return _e=_e*this.data.stride+this.offset,this.normalized&&(et=normalize$4(et,this.array),rt=normalize$4(rt,this.array),it=normalize$4(it,this.array),st=normalize$4(st,this.array)),this.data.array[_e+0]=et,this.data.array[_e+1]=rt,this.data.array[_e+2]=it,this.data.array[_e+3]=st,this}clone(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const et=[];for(let rt=0;rt<this.count;rt++){const it=rt*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)et.push(this.data.array[it+st])}return new BufferAttribute$1(new this.array.constructor(et),this.itemSize,this.normalized)}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.clone(_e)),new v0(_e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const et=[];for(let rt=0;rt<this.count;rt++){const it=rt*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)et.push(this.data.array[it+st])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:et,normalized:this.normalized}}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.toJSON(_e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},SpriteMaterial$1=class extends Material$1{constructor(_e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color$2(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.rotation=_e.rotation,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}},_geometry$2;const _intersectPoint=new Vector3$1,_worldScale=new Vector3$1,_mvPosition=new Vector3$1,_alignedPosition=new Vector2$1,_rotatedPosition=new Vector2$1,_viewWorldMatrix=new Matrix4$1,_vA=new Vector3$1,_vB=new Vector3$1,_vC=new Vector3$1,_uvA=new Vector2$1,_uvB=new Vector2$1,_uvC=new Vector2$1;class Sprite extends Object3D$1{constructor(_e=new SpriteMaterial$1){if(super(),this.isSprite=!0,this.type="Sprite",_geometry$2===void 0){_geometry$2=new BufferGeometry$1;const et=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),rt=new InterleavedBuffer$1(et,5);_geometry$2.setIndex([0,1,2,0,2,3]),_geometry$2.setAttribute("position",new InterleavedBufferAttribute$1(rt,3,0,!1)),_geometry$2.setAttribute("uv",new InterleavedBufferAttribute$1(rt,2,3,!1))}this.geometry=_geometry$2,this.material=_e,this.center=new Vector2$1(.5,.5)}raycast(_e,et){_e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_e.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const rt=this.material.rotation;let it,st;rt!==0&&(st=Math.cos(rt),it=Math.sin(rt));const ot=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,ot,_worldScale,it,st),transformVertex(_vB.set(.5,-.5,0),_mvPosition,ot,_worldScale,it,st),transformVertex(_vC.set(.5,.5,0),_mvPosition,ot,_worldScale,it,st),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let at=_e.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(at===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,ot,_worldScale,it,st),_uvB.set(0,1),at=_e.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),at===null))return;const lt=_e.ray.origin.distanceTo(_intersectPoint);lt<_e.near||lt>_e.far||et.push({distance:lt,point:_intersectPoint.clone(),uv:Triangle$1.getInterpolation(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2$1),face:null,object:this})}copy(_e,et){return super.copy(_e,et),_e.center!==void 0&&this.center.copy(_e.center),this.material=_e.material,this}}function transformVertex(nt,_e,et,rt,it,st){_alignedPosition.subVectors(nt,et).addScalar(.5).multiply(rt),it!==void 0?(_rotatedPosition.x=st*_alignedPosition.x-it*_alignedPosition.y,_rotatedPosition.y=it*_alignedPosition.x+st*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),nt.copy(_e),nt.x+=_rotatedPosition.x,nt.y+=_rotatedPosition.y,nt.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3$1,_v2$1=new Vector3$1;class LOD extends Object3D$1{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_e){super.copy(_e,!1);const et=_e.levels;for(let rt=0,it=et.length;rt<it;rt++){const st=et[rt];this.addLevel(st.object.clone(),st.distance,st.hysteresis)}return this.autoUpdate=_e.autoUpdate,this}addLevel(_e,et=0,rt=0){et=Math.abs(et);const it=this.levels;let st;for(st=0;st<it.length&&!(et<it[st].distance);st++);return it.splice(st,0,{distance:et,hysteresis:rt,object:_e}),this.add(_e),this}removeLevel(_e){const et=this.levels;for(let rt=0;rt<et.length;rt++)if(et[rt].distance===_e){const it=et.splice(rt,1);return this.remove(it[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_e){const et=this.levels;if(et.length>0){let rt,it;for(rt=1,it=et.length;rt<it;rt++){let st=et[rt].distance;if(et[rt].object.visible&&(st-=st*et[rt].hysteresis),_e<st)break}return et[rt-1].object}return null}raycast(_e,et){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const it=_e.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(it).raycast(_e,et)}}update(_e){const et=this.levels;if(et.length>1){_v1$2.setFromMatrixPosition(_e.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const rt=_v1$2.distanceTo(_v2$1)/_e.zoom;et[0].object.visible=!0;let it,st;for(it=1,st=et.length;it<st;it++){let ot=et[it].distance;if(et[it].object.visible&&(ot-=ot*et[it].hysteresis),rt>=ot)et[it-1].object.visible=!1,et[it].object.visible=!0;else break}for(this._currentLevel=it-1;it<st;it++)et[it].object.visible=!1}}toJSON(_e){const et=super.toJSON(_e);this.autoUpdate===!1&&(et.object.autoUpdate=!1),et.object.levels=[];const rt=this.levels;for(let it=0,st=rt.length;it<st;it++){const ot=rt[it];et.object.levels.push({object:ot.object.uuid,distance:ot.distance,hysteresis:ot.hysteresis})}return et}}const _basePosition=new Vector3$1,_skinIndex=new Vector4$1,_skinWeight=new Vector4$1,_vector3=new Vector3$1,_matrix4=new Matrix4$1,_vertex=new Vector3$1,_sphere$4=new Sphere$1,_inverseMatrix$2=new Matrix4$1,_ray$2$1=new Ray$1;class SkinnedMesh extends Mesh$1{constructor(_e,et){super(_e,et),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4$1,this.bindMatrixInverse=new Matrix4$1,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3$1),this.boundingBox.makeEmpty();const et=_e.getAttribute("position");for(let rt=0;rt<et.count;rt++)this.getVertexPosition(rt,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere$1),this.boundingSphere.makeEmpty();const et=_e.getAttribute("position");for(let rt=0;rt<et.count;rt++)this.getVertexPosition(rt,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_e,et){return super.copy(_e,et),this.bindMode=_e.bindMode,this.bindMatrix.copy(_e.bindMatrix),this.bindMatrixInverse.copy(_e.bindMatrixInverse),this.skeleton=_e.skeleton,_e.boundingBox!==null&&(this.boundingBox=_e.boundingBox.clone()),_e.boundingSphere!==null&&(this.boundingSphere=_e.boundingSphere.clone()),this}raycast(_e,et){const rt=this.material,it=this.matrixWorld;rt!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(it),_e.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(it).invert(),_ray$2$1.copy(_e.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2$1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_e,et,_ray$2$1)))}getVertexPosition(_e,et){return super.getVertexPosition(_e,et),this.applyBoneTransform(_e,et),et}bind(_e,et){this.skeleton=_e,et===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),et=this.matrixWorld),this.bindMatrix.copy(et),this.bindMatrixInverse.copy(et).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _e=new Vector4$1,et=this.geometry.attributes.skinWeight;for(let rt=0,it=et.count;rt<it;rt++){_e.fromBufferAttribute(et,rt);const st=1/_e.manhattanLength();st!==1/0?_e.multiplyScalar(st):_e.set(1,0,0,0),et.setXYZW(rt,_e.x,_e.y,_e.z,_e.w)}}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_e,et){const rt=this.skeleton,it=this.geometry;_skinIndex.fromBufferAttribute(it.attributes.skinIndex,_e),_skinWeight.fromBufferAttribute(it.attributes.skinWeight,_e),_basePosition.copy(et).applyMatrix4(this.bindMatrix),et.set(0,0,0);for(let st=0;st<4;st++){const ot=_skinWeight.getComponent(st);if(ot!==0){const at=_skinIndex.getComponent(st);_matrix4.multiplyMatrices(rt.bones[at].matrixWorld,rt.boneInverses[at]),et.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),ot)}}return et.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D$1{constructor(){super(),this.isBone=!0,this.type="Bone"}}let DataTexture$1=class extends Texture$1{constructor(_e=null,et=1,rt=1,it,st,ot,at,lt,ct=NearestFilter$1,ut=NearestFilter$1,ht,dt){super(null,ot,at,lt,ct,ut,it,st,ht,dt),this.isDataTexture=!0,this.image={data:_e,width:et,height:rt},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const _offsetMatrix=new Matrix4$1,_identityMatrix$1=new Matrix4$1;class Skeleton{constructor(_e=[],et=[]){this.uuid=generateUUID$2(),this.bones=_e.slice(0),this.boneInverses=et,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const _e=this.bones,et=this.boneInverses;if(this.boneMatrices=new Float32Array(_e.length*16),et.length===0)this.calculateInverses();else if(_e.length!==et.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let rt=0,it=this.bones.length;rt<it;rt++)this.boneInverses.push(new Matrix4$1)}}calculateInverses(){this.boneInverses.length=0;for(let _e=0,et=this.bones.length;_e<et;_e++){const rt=new Matrix4$1;this.bones[_e]&&rt.copy(this.bones[_e].matrixWorld).invert(),this.boneInverses.push(rt)}}pose(){for(let _e=0,et=this.bones.length;_e<et;_e++){const rt=this.bones[_e];rt&&rt.matrixWorld.copy(this.boneInverses[_e]).invert()}for(let _e=0,et=this.bones.length;_e<et;_e++){const rt=this.bones[_e];rt&&(rt.parent&&rt.parent.isBone?(rt.matrix.copy(rt.parent.matrixWorld).invert(),rt.matrix.multiply(rt.matrixWorld)):rt.matrix.copy(rt.matrixWorld),rt.matrix.decompose(rt.position,rt.quaternion,rt.scale))}}update(){const _e=this.bones,et=this.boneInverses,rt=this.boneMatrices,it=this.boneTexture;for(let st=0,ot=_e.length;st<ot;st++){const at=_e[st]?_e[st].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(at,et[st]),_offsetMatrix.toArray(rt,st*16)}it!==null&&(it.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _e=Math.sqrt(this.bones.length*4);_e=Math.ceil(_e/4)*4,_e=Math.max(_e,4);const et=new Float32Array(_e*_e*4);et.set(this.boneMatrices);const rt=new DataTexture$1(et,_e,_e,RGBAFormat$1,FloatType$1);return rt.needsUpdate=!0,this.boneMatrices=et,this.boneTexture=rt,this}getBoneByName(_e){for(let et=0,rt=this.bones.length;et<rt;et++){const it=this.bones[et];if(it.name===_e)return it}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_e,et){this.uuid=_e.uuid;for(let rt=0,it=_e.bones.length;rt<it;rt++){const st=_e.bones[rt];let ot=et[st];ot===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",st),ot=new Bone),this.bones.push(ot),this.boneInverses.push(new Matrix4$1().fromArray(_e.boneInverses[rt]))}return this.init(),this}toJSON(){const _e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_e.uuid=this.uuid;const et=this.bones,rt=this.boneInverses;for(let it=0,st=et.length;it<st;it++){const ot=et[it];_e.bones.push(ot.uuid);const at=rt[it];_e.boneInverses.push(at.toArray())}return _e}}let InstancedBufferAttribute$1=class extends BufferAttribute$1{constructor(_e,et,rt,it=1){super(_e,et,rt),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=it}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}toJSON(){const _e=super.toJSON();return _e.meshPerAttribute=this.meshPerAttribute,_e.isInstancedBufferAttribute=!0,_e}};const _instanceLocalMatrix$1=new Matrix4$1,_instanceWorldMatrix$1=new Matrix4$1,_instanceIntersects$1=[],_box3=new Box3$1,_identity=new Matrix4$1,_mesh$1=new Mesh$1,_sphere$3$1=new Sphere$1;class InstancedMesh extends Mesh$1{constructor(_e,et,rt){super(_e,et),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute$1(new Float32Array(rt*16),16),this.instanceColor=null,this.morphTexture=null,this.count=rt,this.boundingBox=null,this.boundingSphere=null;for(let it=0;it<rt;it++)this.setMatrixAt(it,_identity)}computeBoundingBox(){const _e=this.geometry,et=this.count;this.boundingBox===null&&(this.boundingBox=new Box3$1),_e.boundingBox===null&&_e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let rt=0;rt<et;rt++)this.getMatrixAt(rt,_instanceLocalMatrix$1),_box3.copy(_e.boundingBox).applyMatrix4(_instanceLocalMatrix$1),this.boundingBox.union(_box3)}computeBoundingSphere(){const _e=this.geometry,et=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere$1),_e.boundingSphere===null&&_e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let rt=0;rt<et;rt++)this.getMatrixAt(rt,_instanceLocalMatrix$1),_sphere$3$1.copy(_e.boundingSphere).applyMatrix4(_instanceLocalMatrix$1),this.boundingSphere.union(_sphere$3$1)}copy(_e,et){return super.copy(_e,et),this.instanceMatrix.copy(_e.instanceMatrix),_e.morphTexture!==null&&(this.morphTexture=_e.morphTexture.clone()),_e.instanceColor!==null&&(this.instanceColor=_e.instanceColor.clone()),this.count=_e.count,_e.boundingBox!==null&&(this.boundingBox=_e.boundingBox.clone()),_e.boundingSphere!==null&&(this.boundingSphere=_e.boundingSphere.clone()),this}getColorAt(_e,et){et.fromArray(this.instanceColor.array,_e*3)}getMatrixAt(_e,et){et.fromArray(this.instanceMatrix.array,_e*16)}getMorphAt(_e,et){const rt=et.morphTargetInfluences,it=this.morphTexture.source.data.data,st=rt.length+1,ot=_e*st+1;for(let at=0;at<rt.length;at++)rt[at]=it[ot+at]}raycast(_e,et){const rt=this.matrixWorld,it=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3$1.copy(this.boundingSphere),_sphere$3$1.applyMatrix4(rt),_e.ray.intersectsSphere(_sphere$3$1)!==!1))for(let st=0;st<it;st++){this.getMatrixAt(st,_instanceLocalMatrix$1),_instanceWorldMatrix$1.multiplyMatrices(rt,_instanceLocalMatrix$1),_mesh$1.matrixWorld=_instanceWorldMatrix$1,_mesh$1.raycast(_e,_instanceIntersects$1);for(let ot=0,at=_instanceIntersects$1.length;ot<at;ot++){const lt=_instanceIntersects$1[ot];lt.instanceId=st,lt.object=this,et.push(lt)}_instanceIntersects$1.length=0}}setColorAt(_e,et){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute$1(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),et.toArray(this.instanceColor.array,_e*3)}setMatrixAt(_e,et){et.toArray(this.instanceMatrix.array,_e*16)}setMorphAt(_e,et){const rt=et.morphTargetInfluences,it=rt.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture$1(new Float32Array(it*this.count),it,this.count,RedFormat$1,FloatType$1));const st=this.morphTexture.source.data.data;let ot=0;for(let ct=0;ct<rt.length;ct++)ot+=rt[ct];const at=this.geometry.morphTargetsRelative?1:1-ot,lt=it*_e;st[lt]=at,st.set(rt,lt+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function sortOpaque(nt,_e){return nt.z-_e.z}function sortTransparent(nt,_e){return _e.z-nt.z}class MultiDrawRenderList{constructor(){this.index=0,this.pool=[],this.list=[]}push(_e,et,rt){const it=this.pool,st=this.list;this.index>=it.length&&it.push({start:-1,count:-1,z:-1,index:-1});const ot=it[this.index];st.push(ot),this.index++,ot.start=_e.start,ot.count=_e.count,ot.z=et,ot.index=rt}reset(){this.list.length=0,this.index=0}}const _matrix$1=new Matrix4$1,_invMatrixWorld=new Matrix4$1,_identityMatrix$2=new Matrix4$1,_whiteColor=new Color$2(1,1,1),_projScreenMatrix$2$1=new Matrix4$1,_frustum$1=new Frustum$1,_box$1$1=new Box3$1,_sphere$2=new Sphere$1,_vector$5=new Vector3$1,_forward=new Vector3$1,_temp=new Vector3$1,_renderList=new MultiDrawRenderList,_mesh$2=new Mesh$1,_batchIntersects=[];function copyAttributeData(nt,_e,et=0){const rt=_e.itemSize;if(nt.isInterleavedBufferAttribute||nt.array.constructor!==_e.array.constructor){const it=nt.count;for(let st=0;st<it;st++)for(let ot=0;ot<rt;ot++)_e.setComponent(st+et,ot,nt.getComponent(st,ot))}else _e.array.set(nt.array,et*rt);_e.needsUpdate=!0}class BatchedMesh extends Mesh$1{get maxInstanceCount(){return this._maxInstanceCount}constructor(_e,et,rt=et*2,it){super(new BufferGeometry$1,it),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._availableInstanceIds=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=_e,this._maxVertexCount=et,this._maxIndexCount=rt,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(_e),this._multiDrawStarts=new Int32Array(_e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let _e=Math.sqrt(this._maxInstanceCount*4);_e=Math.ceil(_e/4)*4,_e=Math.max(_e,4);const et=new Float32Array(_e*_e*4),rt=new DataTexture$1(et,_e,_e,RGBAFormat$1,FloatType$1);this._matricesTexture=rt}_initIndirectTexture(){let _e=Math.sqrt(this._maxInstanceCount);_e=Math.ceil(_e);const et=new Uint32Array(_e*_e),rt=new DataTexture$1(et,_e,_e,RedIntegerFormat$1,UnsignedIntType$1);this._indirectTexture=rt}_initColorsTexture(){let _e=Math.sqrt(this._maxInstanceCount);_e=Math.ceil(_e);const et=new Float32Array(_e*_e*4).fill(1),rt=new DataTexture$1(et,_e,_e,RGBAFormat$1,FloatType$1);rt.colorSpace=ColorManagement$1.workingColorSpace,this._colorsTexture=rt}_initializeGeometry(_e){const et=this.geometry,rt=this._maxVertexCount,it=this._maxIndexCount;if(this._geometryInitialized===!1){for(const st in _e.attributes){const ot=_e.getAttribute(st),{array:at,itemSize:lt,normalized:ct}=ot,ut=new at.constructor(rt*lt),ht=new BufferAttribute$1(ut,lt,ct);et.setAttribute(st,ht)}if(_e.getIndex()!==null){const st=rt>65535?new Uint32Array(it):new Uint16Array(it);et.setIndex(new BufferAttribute$1(st,1))}this._geometryInitialized=!0}}_validateGeometry(_e){const et=this.geometry;if(!!_e.getIndex()!=!!et.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const rt in et.attributes){if(!_e.hasAttribute(rt))throw new Error(`BatchedMesh: Added geometry missing "${rt}". All geometries must have consistent attributes.`);const it=_e.getAttribute(rt),st=et.getAttribute(rt);if(it.itemSize!==st.itemSize||it.normalized!==st.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(_e){return this.customSort=_e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3$1);const _e=this.boundingBox,et=this._drawInfo;_e.makeEmpty();for(let rt=0,it=et.length;rt<it;rt++){if(et[rt].active===!1)continue;const st=et[rt].geometryIndex;this.getMatrixAt(rt,_matrix$1),this.getBoundingBoxAt(st,_box$1$1).applyMatrix4(_matrix$1),_e.union(_box$1$1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$1);const _e=this.boundingSphere,et=this._drawInfo;_e.makeEmpty();for(let rt=0,it=et.length;rt<it;rt++){if(et[rt].active===!1)continue;const st=et[rt].geometryIndex;this.getMatrixAt(rt,_matrix$1),this.getBoundingSphereAt(st,_sphere$2).applyMatrix4(_matrix$1),_e.union(_sphere$2)}}addInstance(_e){if(this._drawInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("BatchedMesh: Maximum item count reached.");const rt={visible:!0,active:!0,geometryIndex:_e};let it=null;this._availableInstanceIds.length>0?(it=this._availableInstanceIds.pop(),this._drawInfo[it]=rt):(it=this._drawInfo.length,this._drawInfo.push(rt));const st=this._matricesTexture,ot=st.image.data;_identityMatrix$2.toArray(ot,it*16),st.needsUpdate=!0;const at=this._colorsTexture;return at&&(_whiteColor.toArray(at.image.data,it*4),at.needsUpdate=!0),it}addGeometry(_e,et=-1,rt=-1){if(this._initializeGeometry(_e),this._validateGeometry(_e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const it={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let st=null;const ot=this._reservedRanges,at=this._drawRanges,lt=this._bounds;this._geometryCount!==0&&(st=ot[ot.length-1]),et===-1?it.vertexCount=_e.getAttribute("position").count:it.vertexCount=et,st===null?it.vertexStart=0:it.vertexStart=st.vertexStart+st.vertexCount;const ct=_e.getIndex(),ut=ct!==null;if(ut&&(rt===-1?it.indexCount=ct.count:it.indexCount=rt,st===null?it.indexStart=0:it.indexStart=st.indexStart+st.indexCount),it.indexStart!==-1&&it.indexStart+it.indexCount>this._maxIndexCount||it.vertexStart+it.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const ht=this._geometryCount;return this._geometryCount++,ot.push(it),at.push({start:ut?it.indexStart:it.vertexStart,count:-1}),lt.push({boxInitialized:!1,box:new Box3$1,sphereInitialized:!1,sphere:new Sphere$1}),this.setGeometryAt(ht,_e),ht}setGeometryAt(_e,et){if(_e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(et);const rt=this.geometry,it=rt.getIndex()!==null,st=rt.getIndex(),ot=et.getIndex(),at=this._reservedRanges[_e];if(it&&ot.count>at.indexCount||et.attributes.position.count>at.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const lt=at.vertexStart,ct=at.vertexCount;for(const ft in rt.attributes){const pt=et.getAttribute(ft),mt=rt.getAttribute(ft);copyAttributeData(pt,mt,lt);const At=pt.itemSize;for(let gt=pt.count,bt=ct;gt<bt;gt++){const Tt=lt+gt;for(let wt=0;wt<At;wt++)mt.setComponent(Tt,wt,0)}mt.needsUpdate=!0,mt.addUpdateRange(lt*At,ct*At)}if(it){const ft=at.indexStart;for(let pt=0;pt<ot.count;pt++)st.setX(ft+pt,lt+ot.getX(pt));for(let pt=ot.count,mt=at.indexCount;pt<mt;pt++)st.setX(ft+pt,lt);st.needsUpdate=!0,st.addUpdateRange(ft,at.indexCount)}const ut=this._bounds[_e];et.boundingBox!==null?(ut.box.copy(et.boundingBox),ut.boxInitialized=!0):ut.boxInitialized=!1,et.boundingSphere!==null?(ut.sphere.copy(et.boundingSphere),ut.sphereInitialized=!0):ut.sphereInitialized=!1;const ht=this._drawRanges[_e],dt=et.getAttribute("position");return ht.count=it?ot.count:dt.count,this._visibilityChanged=!0,_e}deleteInstance(_e){const et=this._drawInfo;return _e>=et.length||et[_e].active===!1?this:(et[_e].active=!1,this._availableInstanceIds.push(_e),this._visibilityChanged=!0,this)}getBoundingBoxAt(_e,et){if(_e>=this._geometryCount)return null;const rt=this._bounds[_e],it=rt.box,st=this.geometry;if(rt.boxInitialized===!1){it.makeEmpty();const ot=st.index,at=st.attributes.position,lt=this._drawRanges[_e];for(let ct=lt.start,ut=lt.start+lt.count;ct<ut;ct++){let ht=ct;ot&&(ht=ot.getX(ht)),it.expandByPoint(_vector$5.fromBufferAttribute(at,ht))}rt.boxInitialized=!0}return et.copy(it),et}getBoundingSphereAt(_e,et){if(_e>=this._geometryCount)return null;const rt=this._bounds[_e],it=rt.sphere,st=this.geometry;if(rt.sphereInitialized===!1){it.makeEmpty(),this.getBoundingBoxAt(_e,_box$1$1),_box$1$1.getCenter(it.center);const ot=st.index,at=st.attributes.position,lt=this._drawRanges[_e];let ct=0;for(let ut=lt.start,ht=lt.start+lt.count;ut<ht;ut++){let dt=ut;ot&&(dt=ot.getX(dt)),_vector$5.fromBufferAttribute(at,dt),ct=Math.max(ct,it.center.distanceToSquared(_vector$5))}it.radius=Math.sqrt(ct),rt.sphereInitialized=!0}return et.copy(it),et}setMatrixAt(_e,et){const rt=this._drawInfo,it=this._matricesTexture,st=this._matricesTexture.image.data;return _e>=rt.length||rt[_e].active===!1?this:(et.toArray(st,_e*16),it.needsUpdate=!0,this)}getMatrixAt(_e,et){const rt=this._drawInfo,it=this._matricesTexture.image.data;return _e>=rt.length||rt[_e].active===!1?null:et.fromArray(it,_e*16)}setColorAt(_e,et){this._colorsTexture===null&&this._initColorsTexture();const rt=this._colorsTexture,it=this._colorsTexture.image.data,st=this._drawInfo;return _e>=st.length||st[_e].active===!1?this:(et.toArray(it,_e*4),rt.needsUpdate=!0,this)}getColorAt(_e,et){const rt=this._colorsTexture.image.data,it=this._drawInfo;return _e>=it.length||it[_e].active===!1?null:et.fromArray(rt,_e*4)}setVisibleAt(_e,et){const rt=this._drawInfo;return _e>=rt.length||rt[_e].active===!1||rt[_e].visible===et?this:(rt[_e].visible=et,this._visibilityChanged=!0,this)}getVisibleAt(_e){const et=this._drawInfo;return _e>=et.length||et[_e].active===!1?!1:et[_e].visible}setGeometryIdAt(_e,et){const rt=this._drawInfo;return _e>=rt.length||rt[_e].active===!1||et<0||et>=this._geometryCount?null:(rt[_e].geometryIndex=et,this)}getGeometryIdAt(_e){const et=this._drawInfo;return _e>=et.length||et[_e].active===!1?-1:et[_e].geometryIndex}getGeometryRangeAt(_e,et={}){if(_e<0||_e>=this._geometryCount)return null;const rt=this._drawRanges[_e];return et.start=rt.start,et.count=rt.count,et}raycast(_e,et){const rt=this._drawInfo,it=this._drawRanges,st=this.matrixWorld,ot=this.geometry;_mesh$2.material=this.material,_mesh$2.geometry.index=ot.index,_mesh$2.geometry.attributes=ot.attributes,_mesh$2.geometry.boundingBox===null&&(_mesh$2.geometry.boundingBox=new Box3$1),_mesh$2.geometry.boundingSphere===null&&(_mesh$2.geometry.boundingSphere=new Sphere$1);for(let at=0,lt=rt.length;at<lt;at++){if(!rt[at].visible||!rt[at].active)continue;const ct=rt[at].geometryIndex,ut=it[ct];_mesh$2.geometry.setDrawRange(ut.start,ut.count),this.getMatrixAt(at,_mesh$2.matrixWorld).premultiply(st),this.getBoundingBoxAt(ct,_mesh$2.geometry.boundingBox),this.getBoundingSphereAt(ct,_mesh$2.geometry.boundingSphere),_mesh$2.raycast(_e,_batchIntersects);for(let ht=0,dt=_batchIntersects.length;ht<dt;ht++){const ft=_batchIntersects[ht];ft.object=this,ft.batchId=at,et.push(ft)}_batchIntersects.length=0}_mesh$2.material=null,_mesh$2.geometry.index=null,_mesh$2.geometry.attributes={},_mesh$2.geometry.setDrawRange(0,1/0)}copy(_e){return super.copy(_e),this.geometry=_e.geometry.clone(),this.perObjectFrustumCulled=_e.perObjectFrustumCulled,this.sortObjects=_e.sortObjects,this.boundingBox=_e.boundingBox!==null?_e.boundingBox.clone():null,this.boundingSphere=_e.boundingSphere!==null?_e.boundingSphere.clone():null,this._drawRanges=_e._drawRanges.map(et=>({...et})),this._reservedRanges=_e._reservedRanges.map(et=>({...et})),this._drawInfo=_e._drawInfo.map(et=>({...et})),this._bounds=_e._bounds.map(et=>({boxInitialized:et.boxInitialized,box:et.box.clone(),sphereInitialized:et.sphereInitialized,sphere:et.sphere.clone()})),this._maxInstanceCount=_e._maxInstanceCount,this._maxVertexCount=_e._maxVertexCount,this._maxIndexCount=_e._maxIndexCount,this._geometryInitialized=_e._geometryInitialized,this._geometryCount=_e._geometryCount,this._multiDrawCounts=_e._multiDrawCounts.slice(),this._multiDrawStarts=_e._multiDrawStarts.slice(),this._matricesTexture=_e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=_e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(_e,et,rt,it,st){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const ot=it.getIndex(),at=ot===null?1:ot.array.BYTES_PER_ELEMENT,lt=this._drawInfo,ct=this._multiDrawStarts,ut=this._multiDrawCounts,ht=this._drawRanges,dt=this.perObjectFrustumCulled,ft=this._indirectTexture,pt=ft.image.data;dt&&(_projScreenMatrix$2$1.multiplyMatrices(rt.projectionMatrix,rt.matrixWorldInverse).multiply(this.matrixWorld),_frustum$1.setFromProjectionMatrix(_projScreenMatrix$2$1,_e.coordinateSystem));let mt=0;if(this.sortObjects){_invMatrixWorld.copy(this.matrixWorld).invert(),_vector$5.setFromMatrixPosition(rt.matrixWorld).applyMatrix4(_invMatrixWorld),_forward.set(0,0,-1).transformDirection(rt.matrixWorld).transformDirection(_invMatrixWorld);for(let bt=0,Tt=lt.length;bt<Tt;bt++)if(lt[bt].visible&&lt[bt].active){const wt=lt[bt].geometryIndex;this.getMatrixAt(bt,_matrix$1),this.getBoundingSphereAt(wt,_sphere$2).applyMatrix4(_matrix$1);let Rt=!1;if(dt&&(Rt=!_frustum$1.intersectsSphere(_sphere$2)),!Rt){const It=_temp.subVectors(_sphere$2.center,_vector$5).dot(_forward);_renderList.push(ht[wt],It,bt)}}const At=_renderList.list,gt=this.customSort;gt===null?At.sort(st.transparent?sortTransparent:sortOpaque):gt.call(this,At,rt);for(let bt=0,Tt=At.length;bt<Tt;bt++){const wt=At[bt];ct[mt]=wt.start*at,ut[mt]=wt.count,pt[mt]=wt.index,mt++}_renderList.reset()}else for(let At=0,gt=lt.length;At<gt;At++)if(lt[At].visible&&lt[At].active){const bt=lt[At].geometryIndex;let Tt=!1;if(dt&&(this.getMatrixAt(At,_matrix$1),this.getBoundingSphereAt(bt,_sphere$2).applyMatrix4(_matrix$1),Tt=!_frustum$1.intersectsSphere(_sphere$2)),!Tt){const wt=ht[bt];ct[mt]=wt.start*at,ut[mt]=wt.count,pt[mt]=At,mt++}}ft.needsUpdate=!0,this._multiDrawCount=mt,this._visibilityChanged=!1}onBeforeShadow(_e,et,rt,it,st,ot){this.onBeforeRender(_e,null,it,st,ot)}}let LineBasicMaterial$1=class extends Material$1{constructor(_e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color$2(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.linewidth=_e.linewidth,this.linecap=_e.linecap,this.linejoin=_e.linejoin,this.fog=_e.fog,this}};const _vStart=new Vector3$1,_vEnd=new Vector3$1,_inverseMatrix$1=new Matrix4$1,_ray$1$1=new Ray$1,_sphere$1=new Sphere$1,_intersectPointOnRay=new Vector3$1,_intersectPointOnSegment=new Vector3$1;class Line extends Object3D$1{constructor(_e=new BufferGeometry$1,et=new LineBasicMaterial$1){super(),this.isLine=!0,this.type="Line",this.geometry=_e,this.material=et,this.updateMorphTargets()}copy(_e,et){return super.copy(_e,et),this.material=Array.isArray(_e.material)?_e.material.slice():_e.material,this.geometry=_e.geometry,this}computeLineDistances(){const _e=this.geometry;if(_e.index===null){const et=_e.attributes.position,rt=[0];for(let it=1,st=et.count;it<st;it++)_vStart.fromBufferAttribute(et,it-1),_vEnd.fromBufferAttribute(et,it),rt[it]=rt[it-1],rt[it]+=_vStart.distanceTo(_vEnd);_e.setAttribute("lineDistance",new Float32BufferAttribute$1(rt,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_e,et){const rt=this.geometry,it=this.matrixWorld,st=_e.params.Line.threshold,ot=rt.drawRange;if(rt.boundingSphere===null&&rt.computeBoundingSphere(),_sphere$1.copy(rt.boundingSphere),_sphere$1.applyMatrix4(it),_sphere$1.radius+=st,_e.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(it).invert(),_ray$1$1.copy(_e.ray).applyMatrix4(_inverseMatrix$1);const at=st/((this.scale.x+this.scale.y+this.scale.z)/3),lt=at*at,ct=this.isLineSegments?2:1,ut=rt.index,dt=rt.attributes.position;if(ut!==null){const ft=Math.max(0,ot.start),pt=Math.min(ut.count,ot.start+ot.count);for(let mt=ft,At=pt-1;mt<At;mt+=ct){const gt=ut.getX(mt),bt=ut.getX(mt+1),Tt=checkIntersection(this,_e,_ray$1$1,lt,gt,bt);Tt&&et.push(Tt)}if(this.isLineLoop){const mt=ut.getX(pt-1),At=ut.getX(ft),gt=checkIntersection(this,_e,_ray$1$1,lt,mt,At);gt&&et.push(gt)}}else{const ft=Math.max(0,ot.start),pt=Math.min(dt.count,ot.start+ot.count);for(let mt=ft,At=pt-1;mt<At;mt+=ct){const gt=checkIntersection(this,_e,_ray$1$1,lt,mt,mt+1);gt&&et.push(gt)}if(this.isLineLoop){const mt=checkIntersection(this,_e,_ray$1$1,lt,pt-1,ft);mt&&et.push(mt)}}}updateMorphTargets(){const et=this.geometry.morphAttributes,rt=Object.keys(et);if(rt.length>0){const it=et[rt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const at=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[at]=st}}}}}function checkIntersection(nt,_e,et,rt,it,st){const ot=nt.geometry.attributes.position;if(_vStart.fromBufferAttribute(ot,it),_vEnd.fromBufferAttribute(ot,st),et.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>rt)return;_intersectPointOnRay.applyMatrix4(nt.matrixWorld);const lt=_e.ray.origin.distanceTo(_intersectPointOnRay);if(!(lt<_e.near||lt>_e.far))return{distance:lt,point:_intersectPointOnSegment.clone().applyMatrix4(nt.matrixWorld),index:it,face:null,faceIndex:null,barycoord:null,object:nt}}const _start$1=new Vector3$1,_end$1=new Vector3$1;class LineSegments extends Line{constructor(_e,et){super(_e,et),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _e=this.geometry;if(_e.index===null){const et=_e.attributes.position,rt=[];for(let it=0,st=et.count;it<st;it+=2)_start$1.fromBufferAttribute(et,it),_end$1.fromBufferAttribute(et,it+1),rt[it]=it===0?0:rt[it-1],rt[it+1]=rt[it]+_start$1.distanceTo(_end$1);_e.setAttribute("lineDistance",new Float32BufferAttribute$1(rt,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_e,et){super(_e,et),this.isLineLoop=!0,this.type="LineLoop"}}let PointsMaterial$1=class extends Material$1{constructor(_e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color$2(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.size=_e.size,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}};const _inverseMatrix=new Matrix4$1,_ray$4=new Ray$1,_sphere$7=new Sphere$1,_position$2=new Vector3$1;class Points extends Object3D$1{constructor(_e=new BufferGeometry$1,et=new PointsMaterial$1){super(),this.isPoints=!0,this.type="Points",this.geometry=_e,this.material=et,this.updateMorphTargets()}copy(_e,et){return super.copy(_e,et),this.material=Array.isArray(_e.material)?_e.material.slice():_e.material,this.geometry=_e.geometry,this}raycast(_e,et){const rt=this.geometry,it=this.matrixWorld,st=_e.params.Points.threshold,ot=rt.drawRange;if(rt.boundingSphere===null&&rt.computeBoundingSphere(),_sphere$7.copy(rt.boundingSphere),_sphere$7.applyMatrix4(it),_sphere$7.radius+=st,_e.ray.intersectsSphere(_sphere$7)===!1)return;_inverseMatrix.copy(it).invert(),_ray$4.copy(_e.ray).applyMatrix4(_inverseMatrix);const at=st/((this.scale.x+this.scale.y+this.scale.z)/3),lt=at*at,ct=rt.index,ht=rt.attributes.position;if(ct!==null){const dt=Math.max(0,ot.start),ft=Math.min(ct.count,ot.start+ot.count);for(let pt=dt,mt=ft;pt<mt;pt++){const At=ct.getX(pt);_position$2.fromBufferAttribute(ht,At),testPoint(_position$2,At,lt,it,_e,et,this)}}else{const dt=Math.max(0,ot.start),ft=Math.min(ht.count,ot.start+ot.count);for(let pt=dt,mt=ft;pt<mt;pt++)_position$2.fromBufferAttribute(ht,pt),testPoint(_position$2,pt,lt,it,_e,et,this)}}updateMorphTargets(){const et=this.geometry.morphAttributes,rt=Object.keys(et);if(rt.length>0){const it=et[rt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const at=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[at]=st}}}}}function testPoint(nt,_e,et,rt,it,st,ot){const at=_ray$4.distanceSqToPoint(nt);if(at<et){const lt=new Vector3$1;_ray$4.closestPointToPoint(nt,lt),lt.applyMatrix4(rt);const ct=it.ray.origin.distanceTo(lt);if(ct<it.near||ct>it.far)return;st.push({distance:ct,distanceToRay:Math.sqrt(at),point:lt,index:_e,face:null,faceIndex:null,barycoord:null,object:ot})}}class VideoTexture extends Texture$1{constructor(_e,et,rt,it,st,ot,at,lt,ct){super(_e,et,rt,it,st,ot,at,lt,ct),this.isVideoTexture=!0,this.minFilter=ot!==void 0?ot:LinearFilter$1,this.magFilter=st!==void 0?st:LinearFilter$1,this.generateMipmaps=!1;const ut=this;function ht(){ut.needsUpdate=!0,_e.requestVideoFrameCallback(ht)}"requestVideoFrameCallback"in _e&&_e.requestVideoFrameCallback(ht)}clone(){return new this.constructor(this.image).copy(this)}update(){const _e=this.image;"requestVideoFrameCallback"in _e===!1&&_e.readyState>=_e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}let FramebufferTexture$1=class extends Texture$1{constructor(_e,et){super({width:_e,height:et}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter$1,this.minFilter=NearestFilter$1,this.generateMipmaps=!1,this.needsUpdate=!0}};class CompressedTexture extends Texture$1{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt){super(null,ot,at,lt,ct,ut,it,st,ht,dt),this.isCompressedTexture=!0,this.image={width:et,height:rt},this.mipmaps=_e,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(_e,et,rt,it,st,ot){super(_e,et,rt,st,ot),this.isCompressedArrayTexture=!0,this.image.depth=it,this.wrapR=ClampToEdgeWrapping$1,this.layerUpdates=new Set}addLayerUpdate(_e){this.layerUpdates.add(_e)}clearLayerUpdates(){this.layerUpdates.clear()}}class CompressedCubeTexture extends CompressedTexture{constructor(_e,et,rt){super(void 0,_e[0].width,_e[0].height,et,rt,CubeReflectionMapping$1),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=_e}}class CanvasTexture extends Texture$1{constructor(_e,et,rt,it,st,ot,at,lt,ct){super(_e,et,rt,it,st,ot,at,lt,ct),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_e,et){const rt=this.getUtoTmapping(_e);return this.getPoint(rt,et)}getPoints(_e=5){const et=[];for(let rt=0;rt<=_e;rt++)et.push(this.getPoint(rt/_e));return et}getSpacedPoints(_e=5){const et=[];for(let rt=0;rt<=_e;rt++)et.push(this.getPointAt(rt/_e));return et}getLength(){const _e=this.getLengths();return _e[_e.length-1]}getLengths(_e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const et=[];let rt,it=this.getPoint(0),st=0;et.push(0);for(let ot=1;ot<=_e;ot++)rt=this.getPoint(ot/_e),st+=rt.distanceTo(it),et.push(st),it=rt;return this.cacheArcLengths=et,et}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_e,et){const rt=this.getLengths();let it=0;const st=rt.length;let ot;et?ot=et:ot=_e*rt[st-1];let at=0,lt=st-1,ct;for(;at<=lt;)if(it=Math.floor(at+(lt-at)/2),ct=rt[it]-ot,ct<0)at=it+1;else if(ct>0)lt=it-1;else{lt=it;break}if(it=lt,rt[it]===ot)return it/(st-1);const ut=rt[it],dt=rt[it+1]-ut,ft=(ot-ut)/dt;return(it+ft)/(st-1)}getTangent(_e,et){let it=_e-1e-4,st=_e+1e-4;it<0&&(it=0),st>1&&(st=1);const ot=this.getPoint(it),at=this.getPoint(st),lt=et||(ot.isVector2?new Vector2$1:new Vector3$1);return lt.copy(at).sub(ot).normalize(),lt}getTangentAt(_e,et){const rt=this.getUtoTmapping(_e);return this.getTangent(rt,et)}computeFrenetFrames(_e,et){const rt=new Vector3$1,it=[],st=[],ot=[],at=new Vector3$1,lt=new Matrix4$1;for(let ft=0;ft<=_e;ft++){const pt=ft/_e;it[ft]=this.getTangentAt(pt,new Vector3$1)}st[0]=new Vector3$1,ot[0]=new Vector3$1;let ct=Number.MAX_VALUE;const ut=Math.abs(it[0].x),ht=Math.abs(it[0].y),dt=Math.abs(it[0].z);ut<=ct&&(ct=ut,rt.set(1,0,0)),ht<=ct&&(ct=ht,rt.set(0,1,0)),dt<=ct&&rt.set(0,0,1),at.crossVectors(it[0],rt).normalize(),st[0].crossVectors(it[0],at),ot[0].crossVectors(it[0],st[0]);for(let ft=1;ft<=_e;ft++){if(st[ft]=st[ft-1].clone(),ot[ft]=ot[ft-1].clone(),at.crossVectors(it[ft-1],it[ft]),at.length()>Number.EPSILON){at.normalize();const pt=Math.acos(clamp$5(it[ft-1].dot(it[ft]),-1,1));st[ft].applyMatrix4(lt.makeRotationAxis(at,pt))}ot[ft].crossVectors(it[ft],st[ft])}if(et===!0){let ft=Math.acos(clamp$5(st[0].dot(st[_e]),-1,1));ft/=_e,it[0].dot(at.crossVectors(st[0],st[_e]))>0&&(ft=-ft);for(let pt=1;pt<=_e;pt++)st[pt].applyMatrix4(lt.makeRotationAxis(it[pt],ft*pt)),ot[pt].crossVectors(it[pt],st[pt])}return{tangents:it,normals:st,binormals:ot}}clone(){return new this.constructor().copy(this)}copy(_e){return this.arcLengthDivisions=_e.arcLengthDivisions,this}toJSON(){const _e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _e.arcLengthDivisions=this.arcLengthDivisions,_e.type=this.type,_e}fromJSON(_e){return this.arcLengthDivisions=_e.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_e=0,et=0,rt=1,it=1,st=0,ot=Math.PI*2,at=!1,lt=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_e,this.aY=et,this.xRadius=rt,this.yRadius=it,this.aStartAngle=st,this.aEndAngle=ot,this.aClockwise=at,this.aRotation=lt}getPoint(_e,et=new Vector2$1){const rt=et,it=Math.PI*2;let st=this.aEndAngle-this.aStartAngle;const ot=Math.abs(st)<Number.EPSILON;for(;st<0;)st+=it;for(;st>it;)st-=it;st<Number.EPSILON&&(ot?st=0:st=it),this.aClockwise===!0&&!ot&&(st===it?st=-it:st=st-it);const at=this.aStartAngle+_e*st;let lt=this.aX+this.xRadius*Math.cos(at),ct=this.aY+this.yRadius*Math.sin(at);if(this.aRotation!==0){const ut=Math.cos(this.aRotation),ht=Math.sin(this.aRotation),dt=lt-this.aX,ft=ct-this.aY;lt=dt*ut-ft*ht+this.aX,ct=dt*ht+ft*ut+this.aY}return rt.set(lt,ct)}copy(_e){return super.copy(_e),this.aX=_e.aX,this.aY=_e.aY,this.xRadius=_e.xRadius,this.yRadius=_e.yRadius,this.aStartAngle=_e.aStartAngle,this.aEndAngle=_e.aEndAngle,this.aClockwise=_e.aClockwise,this.aRotation=_e.aRotation,this}toJSON(){const _e=super.toJSON();return _e.aX=this.aX,_e.aY=this.aY,_e.xRadius=this.xRadius,_e.yRadius=this.yRadius,_e.aStartAngle=this.aStartAngle,_e.aEndAngle=this.aEndAngle,_e.aClockwise=this.aClockwise,_e.aRotation=this.aRotation,_e}fromJSON(_e){return super.fromJSON(_e),this.aX=_e.aX,this.aY=_e.aY,this.xRadius=_e.xRadius,this.yRadius=_e.yRadius,this.aStartAngle=_e.aStartAngle,this.aEndAngle=_e.aEndAngle,this.aClockwise=_e.aClockwise,this.aRotation=_e.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_e,et,rt,it,st,ot){super(_e,et,rt,rt,it,st,ot),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let nt=0,_e=0,et=0,rt=0;function it(st,ot,at,lt){nt=st,_e=at,et=-3*st+3*ot-2*at-lt,rt=2*st-2*ot+at+lt}return{initCatmullRom:function(st,ot,at,lt,ct){it(ot,at,ct*(at-st),ct*(lt-ot))},initNonuniformCatmullRom:function(st,ot,at,lt,ct,ut,ht){let dt=(ot-st)/ct-(at-st)/(ct+ut)+(at-ot)/ut,ft=(at-ot)/ut-(lt-ot)/(ut+ht)+(lt-at)/ht;dt*=ut,ft*=ut,it(ot,at,dt,ft)},calc:function(st){const ot=st*st,at=ot*st;return nt+_e*st+et*ot+rt*at}}}const tmp=new Vector3$1,px$1=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_e=[],et=!1,rt="centripetal",it=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_e,this.closed=et,this.curveType=rt,this.tension=it}getPoint(_e,et=new Vector3$1){const rt=et,it=this.points,st=it.length,ot=(st-(this.closed?0:1))*_e;let at=Math.floor(ot),lt=ot-at;this.closed?at+=at>0?0:(Math.floor(Math.abs(at)/st)+1)*st:lt===0&&at===st-1&&(at=st-2,lt=1);let ct,ut;this.closed||at>0?ct=it[(at-1)%st]:(tmp.subVectors(it[0],it[1]).add(it[0]),ct=tmp);const ht=it[at%st],dt=it[(at+1)%st];if(this.closed||at+2<st?ut=it[(at+2)%st]:(tmp.subVectors(it[st-1],it[st-2]).add(it[st-1]),ut=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ft=this.curveType==="chordal"?.5:.25;let pt=Math.pow(ct.distanceToSquared(ht),ft),mt=Math.pow(ht.distanceToSquared(dt),ft),At=Math.pow(dt.distanceToSquared(ut),ft);mt<1e-4&&(mt=1),pt<1e-4&&(pt=mt),At<1e-4&&(At=mt),px$1.initNonuniformCatmullRom(ct.x,ht.x,dt.x,ut.x,pt,mt,At),py.initNonuniformCatmullRom(ct.y,ht.y,dt.y,ut.y,pt,mt,At),pz.initNonuniformCatmullRom(ct.z,ht.z,dt.z,ut.z,pt,mt,At)}else this.curveType==="catmullrom"&&(px$1.initCatmullRom(ct.x,ht.x,dt.x,ut.x,this.tension),py.initCatmullRom(ct.y,ht.y,dt.y,ut.y,this.tension),pz.initCatmullRom(ct.z,ht.z,dt.z,ut.z,this.tension));return rt.set(px$1.calc(lt),py.calc(lt),pz.calc(lt)),rt}copy(_e){super.copy(_e),this.points=[];for(let et=0,rt=_e.points.length;et<rt;et++){const it=_e.points[et];this.points.push(it.clone())}return this.closed=_e.closed,this.curveType=_e.curveType,this.tension=_e.tension,this}toJSON(){const _e=super.toJSON();_e.points=[];for(let et=0,rt=this.points.length;et<rt;et++){const it=this.points[et];_e.points.push(it.toArray())}return _e.closed=this.closed,_e.curveType=this.curveType,_e.tension=this.tension,_e}fromJSON(_e){super.fromJSON(_e),this.points=[];for(let et=0,rt=_e.points.length;et<rt;et++){const it=_e.points[et];this.points.push(new Vector3$1().fromArray(it))}return this.closed=_e.closed,this.curveType=_e.curveType,this.tension=_e.tension,this}}function CatmullRom(nt,_e,et,rt,it){const st=(rt-_e)*.5,ot=(it-et)*.5,at=nt*nt,lt=nt*at;return(2*et-2*rt+st+ot)*lt+(-3*et+3*rt-2*st-ot)*at+st*nt+et}function QuadraticBezierP0(nt,_e){const et=1-nt;return et*et*_e}function QuadraticBezierP1(nt,_e){return 2*(1-nt)*nt*_e}function QuadraticBezierP2(nt,_e){return nt*nt*_e}function QuadraticBezier(nt,_e,et,rt){return QuadraticBezierP0(nt,_e)+QuadraticBezierP1(nt,et)+QuadraticBezierP2(nt,rt)}function CubicBezierP0(nt,_e){const et=1-nt;return et*et*et*_e}function CubicBezierP1(nt,_e){const et=1-nt;return 3*et*et*nt*_e}function CubicBezierP2(nt,_e){return 3*(1-nt)*nt*nt*_e}function CubicBezierP3(nt,_e){return nt*nt*nt*_e}function CubicBezier(nt,_e,et,rt,it){return CubicBezierP0(nt,_e)+CubicBezierP1(nt,et)+CubicBezierP2(nt,rt)+CubicBezierP3(nt,it)}class CubicBezierCurve extends Curve{constructor(_e=new Vector2$1,et=new Vector2$1,rt=new Vector2$1,it=new Vector2$1){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_e,this.v1=et,this.v2=rt,this.v3=it}getPoint(_e,et=new Vector2$1){const rt=et,it=this.v0,st=this.v1,ot=this.v2,at=this.v3;return rt.set(CubicBezier(_e,it.x,st.x,ot.x,at.x),CubicBezier(_e,it.y,st.y,ot.y,at.y)),rt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this.v3.copy(_e.v3),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e.v3=this.v3.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this.v3.fromArray(_e.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_e=new Vector3$1,et=new Vector3$1,rt=new Vector3$1,it=new Vector3$1){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_e,this.v1=et,this.v2=rt,this.v3=it}getPoint(_e,et=new Vector3$1){const rt=et,it=this.v0,st=this.v1,ot=this.v2,at=this.v3;return rt.set(CubicBezier(_e,it.x,st.x,ot.x,at.x),CubicBezier(_e,it.y,st.y,ot.y,at.y),CubicBezier(_e,it.z,st.z,ot.z,at.z)),rt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this.v3.copy(_e.v3),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e.v3=this.v3.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this.v3.fromArray(_e.v3),this}}class LineCurve extends Curve{constructor(_e=new Vector2$1,et=new Vector2$1){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_e,this.v2=et}getPoint(_e,et=new Vector2$1){const rt=et;return _e===1?rt.copy(this.v2):(rt.copy(this.v2).sub(this.v1),rt.multiplyScalar(_e).add(this.v1)),rt}getPointAt(_e,et){return this.getPoint(_e,et)}getTangent(_e,et=new Vector2$1){return et.subVectors(this.v2,this.v1).normalize()}getTangentAt(_e,et){return this.getTangent(_e,et)}copy(_e){return super.copy(_e),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class LineCurve3 extends Curve{constructor(_e=new Vector3$1,et=new Vector3$1){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_e,this.v2=et}getPoint(_e,et=new Vector3$1){const rt=et;return _e===1?rt.copy(this.v2):(rt.copy(this.v2).sub(this.v1),rt.multiplyScalar(_e).add(this.v1)),rt}getPointAt(_e,et){return this.getPoint(_e,et)}getTangent(_e,et=new Vector3$1){return et.subVectors(this.v2,this.v1).normalize()}getTangentAt(_e,et){return this.getTangent(_e,et)}copy(_e){return super.copy(_e),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_e=new Vector2$1,et=new Vector2$1,rt=new Vector2$1){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_e,this.v1=et,this.v2=rt}getPoint(_e,et=new Vector2$1){const rt=et,it=this.v0,st=this.v1,ot=this.v2;return rt.set(QuadraticBezier(_e,it.x,st.x,ot.x),QuadraticBezier(_e,it.y,st.y,ot.y)),rt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_e=new Vector3$1,et=new Vector3$1,rt=new Vector3$1){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_e,this.v1=et,this.v2=rt}getPoint(_e,et=new Vector3$1){const rt=et,it=this.v0,st=this.v1,ot=this.v2;return rt.set(QuadraticBezier(_e,it.x,st.x,ot.x),QuadraticBezier(_e,it.y,st.y,ot.y),QuadraticBezier(_e,it.z,st.z,ot.z)),rt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class SplineCurve extends Curve{constructor(_e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_e}getPoint(_e,et=new Vector2$1){const rt=et,it=this.points,st=(it.length-1)*_e,ot=Math.floor(st),at=st-ot,lt=it[ot===0?ot:ot-1],ct=it[ot],ut=it[ot>it.length-2?it.length-1:ot+1],ht=it[ot>it.length-3?it.length-1:ot+2];return rt.set(CatmullRom(at,lt.x,ct.x,ut.x,ht.x),CatmullRom(at,lt.y,ct.y,ut.y,ht.y)),rt}copy(_e){super.copy(_e),this.points=[];for(let et=0,rt=_e.points.length;et<rt;et++){const it=_e.points[et];this.points.push(it.clone())}return this}toJSON(){const _e=super.toJSON();_e.points=[];for(let et=0,rt=this.points.length;et<rt;et++){const it=this.points[et];_e.points.push(it.toArray())}return _e}fromJSON(_e){super.fromJSON(_e),this.points=[];for(let et=0,rt=_e.points.length;et<rt;et++){const it=_e.points[et];this.points.push(new Vector2$1().fromArray(it))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_e){this.curves.push(_e)}closePath(){const _e=this.curves[0].getPoint(0),et=this.curves[this.curves.length-1].getPoint(1);if(!_e.equals(et)){const rt=_e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Curves[rt](et,_e))}return this}getPoint(_e,et){const rt=_e*this.getLength(),it=this.getCurveLengths();let st=0;for(;st<it.length;){if(it[st]>=rt){const ot=it[st]-rt,at=this.curves[st],lt=at.getLength(),ct=lt===0?0:1-ot/lt;return at.getPointAt(ct,et)}st++}return null}getLength(){const _e=this.getCurveLengths();return _e[_e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _e=[];let et=0;for(let rt=0,it=this.curves.length;rt<it;rt++)et+=this.curves[rt].getLength(),_e.push(et);return this.cacheLengths=_e,_e}getSpacedPoints(_e=40){const et=[];for(let rt=0;rt<=_e;rt++)et.push(this.getPoint(rt/_e));return this.autoClose&&et.push(et[0]),et}getPoints(_e=12){const et=[];let rt;for(let it=0,st=this.curves;it<st.length;it++){const ot=st[it],at=ot.isEllipseCurve?_e*2:ot.isLineCurve||ot.isLineCurve3?1:ot.isSplineCurve?_e*ot.points.length:_e,lt=ot.getPoints(at);for(let ct=0;ct<lt.length;ct++){const ut=lt[ct];rt&&rt.equals(ut)||(et.push(ut),rt=ut)}}return this.autoClose&&et.length>1&&!et[et.length-1].equals(et[0])&&et.push(et[0]),et}copy(_e){super.copy(_e),this.curves=[];for(let et=0,rt=_e.curves.length;et<rt;et++){const it=_e.curves[et];this.curves.push(it.clone())}return this.autoClose=_e.autoClose,this}toJSON(){const _e=super.toJSON();_e.autoClose=this.autoClose,_e.curves=[];for(let et=0,rt=this.curves.length;et<rt;et++){const it=this.curves[et];_e.curves.push(it.toJSON())}return _e}fromJSON(_e){super.fromJSON(_e),this.autoClose=_e.autoClose,this.curves=[];for(let et=0,rt=_e.curves.length;et<rt;et++){const it=_e.curves[et];this.curves.push(new Curves[it.type]().fromJSON(it))}return this}}let Path$1=class extends CurvePath{constructor(_e){super(),this.type="Path",this.currentPoint=new Vector2$1,_e&&this.setFromPoints(_e)}setFromPoints(_e){this.moveTo(_e[0].x,_e[0].y);for(let et=1,rt=_e.length;et<rt;et++)this.lineTo(_e[et].x,_e[et].y);return this}moveTo(_e,et){return this.currentPoint.set(_e,et),this}lineTo(_e,et){const rt=new LineCurve(this.currentPoint.clone(),new Vector2$1(_e,et));return this.curves.push(rt),this.currentPoint.set(_e,et),this}quadraticCurveTo(_e,et,rt,it){const st=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2$1(_e,et),new Vector2$1(rt,it));return this.curves.push(st),this.currentPoint.set(rt,it),this}bezierCurveTo(_e,et,rt,it,st,ot){const at=new CubicBezierCurve(this.currentPoint.clone(),new Vector2$1(_e,et),new Vector2$1(rt,it),new Vector2$1(st,ot));return this.curves.push(at),this.currentPoint.set(st,ot),this}splineThru(_e){const et=[this.currentPoint.clone()].concat(_e),rt=new SplineCurve(et);return this.curves.push(rt),this.currentPoint.copy(_e[_e.length-1]),this}arc(_e,et,rt,it,st,ot){const at=this.currentPoint.x,lt=this.currentPoint.y;return this.absarc(_e+at,et+lt,rt,it,st,ot),this}absarc(_e,et,rt,it,st,ot){return this.absellipse(_e,et,rt,rt,it,st,ot),this}ellipse(_e,et,rt,it,st,ot,at,lt){const ct=this.currentPoint.x,ut=this.currentPoint.y;return this.absellipse(_e+ct,et+ut,rt,it,st,ot,at,lt),this}absellipse(_e,et,rt,it,st,ot,at,lt){const ct=new EllipseCurve(_e,et,rt,it,st,ot,at,lt);if(this.curves.length>0){const ht=ct.getPoint(0);ht.equals(this.currentPoint)||this.lineTo(ht.x,ht.y)}this.curves.push(ct);const ut=ct.getPoint(1);return this.currentPoint.copy(ut),this}copy(_e){return super.copy(_e),this.currentPoint.copy(_e.currentPoint),this}toJSON(){const _e=super.toJSON();return _e.currentPoint=this.currentPoint.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.currentPoint.fromArray(_e.currentPoint),this}};class LatheGeometry extends BufferGeometry$1{constructor(_e=[new Vector2$1(0,-.5),new Vector2$1(.5,0),new Vector2$1(0,.5)],et=12,rt=0,it=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_e,segments:et,phiStart:rt,phiLength:it},et=Math.floor(et),it=clamp$5(it,0,Math.PI*2);const st=[],ot=[],at=[],lt=[],ct=[],ut=1/et,ht=new Vector3$1,dt=new Vector2$1,ft=new Vector3$1,pt=new Vector3$1,mt=new Vector3$1;let At=0,gt=0;for(let bt=0;bt<=_e.length-1;bt++)switch(bt){case 0:At=_e[bt+1].x-_e[bt].x,gt=_e[bt+1].y-_e[bt].y,ft.x=gt*1,ft.y=-At,ft.z=gt*0,mt.copy(ft),ft.normalize(),lt.push(ft.x,ft.y,ft.z);break;case _e.length-1:lt.push(mt.x,mt.y,mt.z);break;default:At=_e[bt+1].x-_e[bt].x,gt=_e[bt+1].y-_e[bt].y,ft.x=gt*1,ft.y=-At,ft.z=gt*0,pt.copy(ft),ft.x+=mt.x,ft.y+=mt.y,ft.z+=mt.z,ft.normalize(),lt.push(ft.x,ft.y,ft.z),mt.copy(pt)}for(let bt=0;bt<=et;bt++){const Tt=rt+bt*ut*it,wt=Math.sin(Tt),Rt=Math.cos(Tt);for(let It=0;It<=_e.length-1;It++){ht.x=_e[It].x*wt,ht.y=_e[It].y,ht.z=_e[It].x*Rt,ot.push(ht.x,ht.y,ht.z),dt.x=bt/et,dt.y=It/(_e.length-1),at.push(dt.x,dt.y);const Lt=lt[3*It+0]*wt,$t=lt[3*It+1],kt=lt[3*It+0]*Rt;ct.push(Lt,$t,kt)}}for(let bt=0;bt<et;bt++)for(let Tt=0;Tt<_e.length-1;Tt++){const wt=Tt+bt*_e.length,Rt=wt,It=wt+_e.length,Lt=wt+_e.length+1,$t=wt+1;st.push(Rt,It,$t),st.push(Lt,$t,It)}this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute$1(ot,3)),this.setAttribute("uv",new Float32BufferAttribute$1(at,2)),this.setAttribute("normal",new Float32BufferAttribute$1(ct,3))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new LatheGeometry(_e.points,_e.segments,_e.phiStart,_e.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_e=1,et=1,rt=4,it=8){const st=new Path$1;st.absarc(0,-et/2,_e,Math.PI*1.5,0),st.absarc(0,et/2,_e,0,Math.PI*.5),super(st.getPoints(rt),it),this.type="CapsuleGeometry",this.parameters={radius:_e,length:et,capSegments:rt,radialSegments:it}}static fromJSON(_e){return new CapsuleGeometry(_e.radius,_e.length,_e.capSegments,_e.radialSegments)}}class CircleGeometry extends BufferGeometry$1{constructor(_e=1,et=32,rt=0,it=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_e,segments:et,thetaStart:rt,thetaLength:it},et=Math.max(3,et);const st=[],ot=[],at=[],lt=[],ct=new Vector3$1,ut=new Vector2$1;ot.push(0,0,0),at.push(0,0,1),lt.push(.5,.5);for(let ht=0,dt=3;ht<=et;ht++,dt+=3){const ft=rt+ht/et*it;ct.x=_e*Math.cos(ft),ct.y=_e*Math.sin(ft),ot.push(ct.x,ct.y,ct.z),at.push(0,0,1),ut.x=(ot[dt]/_e+1)/2,ut.y=(ot[dt+1]/_e+1)/2,lt.push(ut.x,ut.y)}for(let ht=1;ht<=et;ht++)st.push(ht,ht+1,0);this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute$1(ot,3)),this.setAttribute("normal",new Float32BufferAttribute$1(at,3)),this.setAttribute("uv",new Float32BufferAttribute$1(lt,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new CircleGeometry(_e.radius,_e.segments,_e.thetaStart,_e.thetaLength)}}class CylinderGeometry extends BufferGeometry$1{constructor(_e=1,et=1,rt=1,it=32,st=1,ot=!1,at=0,lt=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_e,radiusBottom:et,height:rt,radialSegments:it,heightSegments:st,openEnded:ot,thetaStart:at,thetaLength:lt};const ct=this;it=Math.floor(it),st=Math.floor(st);const ut=[],ht=[],dt=[],ft=[];let pt=0;const mt=[],At=rt/2;let gt=0;bt(),ot===!1&&(_e>0&&Tt(!0),et>0&&Tt(!1)),this.setIndex(ut),this.setAttribute("position",new Float32BufferAttribute$1(ht,3)),this.setAttribute("normal",new Float32BufferAttribute$1(dt,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ft,2));function bt(){const wt=new Vector3$1,Rt=new Vector3$1;let It=0;const Lt=(et-_e)/rt;for(let $t=0;$t<=st;$t++){const kt=[],Dt=$t/st,Ot=Dt*(et-_e)+_e;for(let zt=0;zt<=it;zt++){const Ht=zt/it,Yt=Ht*lt+at,Xt=Math.sin(Yt),Zt=Math.cos(Yt);Rt.x=Ot*Xt,Rt.y=-Dt*rt+At,Rt.z=Ot*Zt,ht.push(Rt.x,Rt.y,Rt.z),wt.set(Xt,Lt,Zt).normalize(),dt.push(wt.x,wt.y,wt.z),ft.push(Ht,1-Dt),kt.push(pt++)}mt.push(kt)}for(let $t=0;$t<it;$t++)for(let kt=0;kt<st;kt++){const Dt=mt[kt][$t],Ot=mt[kt+1][$t],zt=mt[kt+1][$t+1],Ht=mt[kt][$t+1];_e>0&&(ut.push(Dt,Ot,Ht),It+=3),et>0&&(ut.push(Ot,zt,Ht),It+=3)}ct.addGroup(gt,It,0),gt+=It}function Tt(wt){const Rt=pt,It=new Vector2$1,Lt=new Vector3$1;let $t=0;const kt=wt===!0?_e:et,Dt=wt===!0?1:-1;for(let zt=1;zt<=it;zt++)ht.push(0,At*Dt,0),dt.push(0,Dt,0),ft.push(.5,.5),pt++;const Ot=pt;for(let zt=0;zt<=it;zt++){const Yt=zt/it*lt+at,Xt=Math.cos(Yt),Zt=Math.sin(Yt);Lt.x=kt*Zt,Lt.y=At*Dt,Lt.z=kt*Xt,ht.push(Lt.x,Lt.y,Lt.z),dt.push(0,Dt,0),It.x=Xt*.5+.5,It.y=Zt*.5*Dt+.5,ft.push(It.x,It.y),pt++}for(let zt=0;zt<it;zt++){const Ht=Rt+zt,Yt=Ot+zt;wt===!0?ut.push(Yt,Yt+1,Ht):ut.push(Yt+1,Yt,Ht),$t+=3}ct.addGroup(gt,$t,wt===!0?1:2),gt+=$t}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new CylinderGeometry(_e.radiusTop,_e.radiusBottom,_e.height,_e.radialSegments,_e.heightSegments,_e.openEnded,_e.thetaStart,_e.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_e=1,et=1,rt=32,it=1,st=!1,ot=0,at=Math.PI*2){super(0,_e,et,rt,it,st,ot,at),this.type="ConeGeometry",this.parameters={radius:_e,height:et,radialSegments:rt,heightSegments:it,openEnded:st,thetaStart:ot,thetaLength:at}}static fromJSON(_e){return new ConeGeometry(_e.radius,_e.height,_e.radialSegments,_e.heightSegments,_e.openEnded,_e.thetaStart,_e.thetaLength)}}class PolyhedronGeometry extends BufferGeometry$1{constructor(_e=[],et=[],rt=1,it=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_e,indices:et,radius:rt,detail:it};const st=[],ot=[];at(it),ct(rt),ut(),this.setAttribute("position",new Float32BufferAttribute$1(st,3)),this.setAttribute("normal",new Float32BufferAttribute$1(st.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute$1(ot,2)),it===0?this.computeVertexNormals():this.normalizeNormals();function at(bt){const Tt=new Vector3$1,wt=new Vector3$1,Rt=new Vector3$1;for(let It=0;It<et.length;It+=3)ft(et[It+0],Tt),ft(et[It+1],wt),ft(et[It+2],Rt),lt(Tt,wt,Rt,bt)}function lt(bt,Tt,wt,Rt){const It=Rt+1,Lt=[];for(let $t=0;$t<=It;$t++){Lt[$t]=[];const kt=bt.clone().lerp(wt,$t/It),Dt=Tt.clone().lerp(wt,$t/It),Ot=It-$t;for(let zt=0;zt<=Ot;zt++)zt===0&&$t===It?Lt[$t][zt]=kt:Lt[$t][zt]=kt.clone().lerp(Dt,zt/Ot)}for(let $t=0;$t<It;$t++)for(let kt=0;kt<2*(It-$t)-1;kt++){const Dt=Math.floor(kt/2);kt%2===0?(dt(Lt[$t][Dt+1]),dt(Lt[$t+1][Dt]),dt(Lt[$t][Dt])):(dt(Lt[$t][Dt+1]),dt(Lt[$t+1][Dt+1]),dt(Lt[$t+1][Dt]))}}function ct(bt){const Tt=new Vector3$1;for(let wt=0;wt<st.length;wt+=3)Tt.x=st[wt+0],Tt.y=st[wt+1],Tt.z=st[wt+2],Tt.normalize().multiplyScalar(bt),st[wt+0]=Tt.x,st[wt+1]=Tt.y,st[wt+2]=Tt.z}function ut(){const bt=new Vector3$1;for(let Tt=0;Tt<st.length;Tt+=3){bt.x=st[Tt+0],bt.y=st[Tt+1],bt.z=st[Tt+2];const wt=At(bt)/2/Math.PI+.5,Rt=gt(bt)/Math.PI+.5;ot.push(wt,1-Rt)}pt(),ht()}function ht(){for(let bt=0;bt<ot.length;bt+=6){const Tt=ot[bt+0],wt=ot[bt+2],Rt=ot[bt+4],It=Math.max(Tt,wt,Rt),Lt=Math.min(Tt,wt,Rt);It>.9&&Lt<.1&&(Tt<.2&&(ot[bt+0]+=1),wt<.2&&(ot[bt+2]+=1),Rt<.2&&(ot[bt+4]+=1))}}function dt(bt){st.push(bt.x,bt.y,bt.z)}function ft(bt,Tt){const wt=bt*3;Tt.x=_e[wt+0],Tt.y=_e[wt+1],Tt.z=_e[wt+2]}function pt(){const bt=new Vector3$1,Tt=new Vector3$1,wt=new Vector3$1,Rt=new Vector3$1,It=new Vector2$1,Lt=new Vector2$1,$t=new Vector2$1;for(let kt=0,Dt=0;kt<st.length;kt+=9,Dt+=6){bt.set(st[kt+0],st[kt+1],st[kt+2]),Tt.set(st[kt+3],st[kt+4],st[kt+5]),wt.set(st[kt+6],st[kt+7],st[kt+8]),It.set(ot[Dt+0],ot[Dt+1]),Lt.set(ot[Dt+2],ot[Dt+3]),$t.set(ot[Dt+4],ot[Dt+5]),Rt.copy(bt).add(Tt).add(wt).divideScalar(3);const Ot=At(Rt);mt(It,Dt+0,bt,Ot),mt(Lt,Dt+2,Tt,Ot),mt($t,Dt+4,wt,Ot)}}function mt(bt,Tt,wt,Rt){Rt<0&&bt.x===1&&(ot[Tt]=bt.x-1),wt.x===0&&wt.z===0&&(ot[Tt]=Rt/2/Math.PI+.5)}function At(bt){return Math.atan2(bt.z,-bt.x)}function gt(bt){return Math.atan2(-bt.y,Math.sqrt(bt.x*bt.x+bt.z*bt.z))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new PolyhedronGeometry(_e.vertices,_e.indices,_e.radius,_e.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_e=1,et=0){const rt=(1+Math.sqrt(5))/2,it=1/rt,st=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-it,-rt,0,-it,rt,0,it,-rt,0,it,rt,-it,-rt,0,-it,rt,0,it,-rt,0,it,rt,0,-rt,0,-it,rt,0,-it,-rt,0,it,rt,0,it],ot=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(st,ot,_e,et),this.type="DodecahedronGeometry",this.parameters={radius:_e,detail:et}}static fromJSON(_e){return new DodecahedronGeometry(_e.radius,_e.detail)}}const _v0=new Vector3$1,_v1$1=new Vector3$1,_normal=new Vector3$1,_triangle=new Triangle$1;class EdgesGeometry extends BufferGeometry$1{constructor(_e=null,et=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_e,thresholdAngle:et},_e!==null){const it=Math.pow(10,4),st=Math.cos(DEG2RAD$1*et),ot=_e.getIndex(),at=_e.getAttribute("position"),lt=ot?ot.count:at.count,ct=[0,0,0],ut=["a","b","c"],ht=new Array(3),dt={},ft=[];for(let pt=0;pt<lt;pt+=3){ot?(ct[0]=ot.getX(pt),ct[1]=ot.getX(pt+1),ct[2]=ot.getX(pt+2)):(ct[0]=pt,ct[1]=pt+1,ct[2]=pt+2);const{a:mt,b:At,c:gt}=_triangle;if(mt.fromBufferAttribute(at,ct[0]),At.fromBufferAttribute(at,ct[1]),gt.fromBufferAttribute(at,ct[2]),_triangle.getNormal(_normal),ht[0]=`${Math.round(mt.x*it)},${Math.round(mt.y*it)},${Math.round(mt.z*it)}`,ht[1]=`${Math.round(At.x*it)},${Math.round(At.y*it)},${Math.round(At.z*it)}`,ht[2]=`${Math.round(gt.x*it)},${Math.round(gt.y*it)},${Math.round(gt.z*it)}`,!(ht[0]===ht[1]||ht[1]===ht[2]||ht[2]===ht[0]))for(let bt=0;bt<3;bt++){const Tt=(bt+1)%3,wt=ht[bt],Rt=ht[Tt],It=_triangle[ut[bt]],Lt=_triangle[ut[Tt]],$t=`${wt}_${Rt}`,kt=`${Rt}_${wt}`;kt in dt&&dt[kt]?(_normal.dot(dt[kt].normal)<=st&&(ft.push(It.x,It.y,It.z),ft.push(Lt.x,Lt.y,Lt.z)),dt[kt]=null):$t in dt||(dt[$t]={index0:ct[bt],index1:ct[Tt],normal:_normal.clone()})}}for(const pt in dt)if(dt[pt]){const{index0:mt,index1:At}=dt[pt];_v0.fromBufferAttribute(at,mt),_v1$1.fromBufferAttribute(at,At),ft.push(_v0.x,_v0.y,_v0.z),ft.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute$1(ft,3))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}}class Shape extends Path$1{constructor(_e){super(_e),this.uuid=generateUUID$2(),this.type="Shape",this.holes=[]}getPointsHoles(_e){const et=[];for(let rt=0,it=this.holes.length;rt<it;rt++)et[rt]=this.holes[rt].getPoints(_e);return et}extractPoints(_e){return{shape:this.getPoints(_e),holes:this.getPointsHoles(_e)}}copy(_e){super.copy(_e),this.holes=[];for(let et=0,rt=_e.holes.length;et<rt;et++){const it=_e.holes[et];this.holes.push(it.clone())}return this}toJSON(){const _e=super.toJSON();_e.uuid=this.uuid,_e.holes=[];for(let et=0,rt=this.holes.length;et<rt;et++){const it=this.holes[et];_e.holes.push(it.toJSON())}return _e}fromJSON(_e){super.fromJSON(_e),this.uuid=_e.uuid,this.holes=[];for(let et=0,rt=_e.holes.length;et<rt;et++){const it=_e.holes[et];this.holes.push(new Path$1().fromJSON(it))}return this}}const Earcut={triangulate:function(nt,_e,et=2){const rt=_e&&_e.length,it=rt?_e[0]*et:nt.length;let st=linkedList$1(nt,0,it,et,!0);const ot=[];if(!st||st.next===st.prev)return ot;let at,lt,ct,ut,ht,dt,ft;if(rt&&(st=eliminateHoles$1(nt,_e,st,et)),nt.length>80*et){at=ct=nt[0],lt=ut=nt[1];for(let pt=et;pt<it;pt+=et)ht=nt[pt],dt=nt[pt+1],ht<at&&(at=ht),dt<lt&&(lt=dt),ht>ct&&(ct=ht),dt>ut&&(ut=dt);ft=Math.max(ct-at,ut-lt),ft=ft!==0?32767/ft:0}return earcutLinked$1(st,ot,et,at,lt,ft,0),ot}};function linkedList$1(nt,_e,et,rt,it){let st,ot;if(it===signedArea$1(nt,_e,et,rt)>0)for(st=_e;st<et;st+=rt)ot=insertNode$1(st,nt[st],nt[st+1],ot);else for(st=et-rt;st>=_e;st-=rt)ot=insertNode$1(st,nt[st],nt[st+1],ot);return ot&&equals$2(ot,ot.next)&&(removeNode$1(ot),ot=ot.next),ot}function filterPoints$1(nt,_e){if(!nt)return nt;_e||(_e=nt);let et=nt,rt;do if(rt=!1,!et.steiner&&(equals$2(et,et.next)||area$1(et.prev,et,et.next)===0)){if(removeNode$1(et),et=_e=et.prev,et===et.next)break;rt=!0}else et=et.next;while(rt||et!==_e);return _e}function earcutLinked$1(nt,_e,et,rt,it,st,ot){if(!nt)return;!ot&&st&&indexCurve$1(nt,rt,it,st);let at=nt,lt,ct;for(;nt.prev!==nt.next;){if(lt=nt.prev,ct=nt.next,st?isEarHashed$1(nt,rt,it,st):isEar$1(nt)){_e.push(lt.i/et|0),_e.push(nt.i/et|0),_e.push(ct.i/et|0),removeNode$1(nt),nt=ct.next,at=ct.next;continue}if(nt=ct,nt===at){ot?ot===1?(nt=cureLocalIntersections$1(filterPoints$1(nt),_e,et),earcutLinked$1(nt,_e,et,rt,it,st,2)):ot===2&&splitEarcut$1(nt,_e,et,rt,it,st):earcutLinked$1(filterPoints$1(nt),_e,et,rt,it,st,1);break}}}function isEar$1(nt){const _e=nt.prev,et=nt,rt=nt.next;if(area$1(_e,et,rt)>=0)return!1;const it=_e.x,st=et.x,ot=rt.x,at=_e.y,lt=et.y,ct=rt.y,ut=it<st?it<ot?it:ot:st<ot?st:ot,ht=at<lt?at<ct?at:ct:lt<ct?lt:ct,dt=it>st?it>ot?it:ot:st>ot?st:ot,ft=at>lt?at>ct?at:ct:lt>ct?lt:ct;let pt=rt.next;for(;pt!==_e;){if(pt.x>=ut&&pt.x<=dt&&pt.y>=ht&&pt.y<=ft&&pointInTriangle$1(it,at,st,lt,ot,ct,pt.x,pt.y)&&area$1(pt.prev,pt,pt.next)>=0)return!1;pt=pt.next}return!0}function isEarHashed$1(nt,_e,et,rt){const it=nt.prev,st=nt,ot=nt.next;if(area$1(it,st,ot)>=0)return!1;const at=it.x,lt=st.x,ct=ot.x,ut=it.y,ht=st.y,dt=ot.y,ft=at<lt?at<ct?at:ct:lt<ct?lt:ct,pt=ut<ht?ut<dt?ut:dt:ht<dt?ht:dt,mt=at>lt?at>ct?at:ct:lt>ct?lt:ct,At=ut>ht?ut>dt?ut:dt:ht>dt?ht:dt,gt=zOrder$1(ft,pt,_e,et,rt),bt=zOrder$1(mt,At,_e,et,rt);let Tt=nt.prevZ,wt=nt.nextZ;for(;Tt&&Tt.z>=gt&&wt&&wt.z<=bt;){if(Tt.x>=ft&&Tt.x<=mt&&Tt.y>=pt&&Tt.y<=At&&Tt!==it&&Tt!==ot&&pointInTriangle$1(at,ut,lt,ht,ct,dt,Tt.x,Tt.y)&&area$1(Tt.prev,Tt,Tt.next)>=0||(Tt=Tt.prevZ,wt.x>=ft&&wt.x<=mt&&wt.y>=pt&&wt.y<=At&&wt!==it&&wt!==ot&&pointInTriangle$1(at,ut,lt,ht,ct,dt,wt.x,wt.y)&&area$1(wt.prev,wt,wt.next)>=0))return!1;wt=wt.nextZ}for(;Tt&&Tt.z>=gt;){if(Tt.x>=ft&&Tt.x<=mt&&Tt.y>=pt&&Tt.y<=At&&Tt!==it&&Tt!==ot&&pointInTriangle$1(at,ut,lt,ht,ct,dt,Tt.x,Tt.y)&&area$1(Tt.prev,Tt,Tt.next)>=0)return!1;Tt=Tt.prevZ}for(;wt&&wt.z<=bt;){if(wt.x>=ft&&wt.x<=mt&&wt.y>=pt&&wt.y<=At&&wt!==it&&wt!==ot&&pointInTriangle$1(at,ut,lt,ht,ct,dt,wt.x,wt.y)&&area$1(wt.prev,wt,wt.next)>=0)return!1;wt=wt.nextZ}return!0}function cureLocalIntersections$1(nt,_e,et){let rt=nt;do{const it=rt.prev,st=rt.next.next;!equals$2(it,st)&&intersects$1(it,rt,rt.next,st)&&locallyInside$1(it,st)&&locallyInside$1(st,it)&&(_e.push(it.i/et|0),_e.push(rt.i/et|0),_e.push(st.i/et|0),removeNode$1(rt),removeNode$1(rt.next),rt=nt=st),rt=rt.next}while(rt!==nt);return filterPoints$1(rt)}function splitEarcut$1(nt,_e,et,rt,it,st){let ot=nt;do{let at=ot.next.next;for(;at!==ot.prev;){if(ot.i!==at.i&&isValidDiagonal$1(ot,at)){let lt=splitPolygon$1(ot,at);ot=filterPoints$1(ot,ot.next),lt=filterPoints$1(lt,lt.next),earcutLinked$1(ot,_e,et,rt,it,st,0),earcutLinked$1(lt,_e,et,rt,it,st,0);return}at=at.next}ot=ot.next}while(ot!==nt)}function eliminateHoles$1(nt,_e,et,rt){const it=[];let st,ot,at,lt,ct;for(st=0,ot=_e.length;st<ot;st++)at=_e[st]*rt,lt=st<ot-1?_e[st+1]*rt:nt.length,ct=linkedList$1(nt,at,lt,rt,!1),ct===ct.next&&(ct.steiner=!0),it.push(getLeftmost$1(ct));for(it.sort(compareX$1),st=0;st<it.length;st++)et=eliminateHole$1(it[st],et);return et}function compareX$1(nt,_e){return nt.x-_e.x}function eliminateHole$1(nt,_e){const et=findHoleBridge$1(nt,_e);if(!et)return _e;const rt=splitPolygon$1(et,nt);return filterPoints$1(rt,rt.next),filterPoints$1(et,et.next)}function findHoleBridge$1(nt,_e){let et=_e,rt=-1/0,it;const st=nt.x,ot=nt.y;do{if(ot<=et.y&&ot>=et.next.y&&et.next.y!==et.y){const dt=et.x+(ot-et.y)*(et.next.x-et.x)/(et.next.y-et.y);if(dt<=st&&dt>rt&&(rt=dt,it=et.x<et.next.x?et:et.next,dt===st))return it}et=et.next}while(et!==_e);if(!it)return null;const at=it,lt=it.x,ct=it.y;let ut=1/0,ht;et=it;do st>=et.x&&et.x>=lt&&st!==et.x&&pointInTriangle$1(ot<ct?st:rt,ot,lt,ct,ot<ct?rt:st,ot,et.x,et.y)&&(ht=Math.abs(ot-et.y)/(st-et.x),locallyInside$1(et,nt)&&(ht<ut||ht===ut&&(et.x>it.x||et.x===it.x&&sectorContainsSector$1(it,et)))&&(it=et,ut=ht)),et=et.next;while(et!==at);return it}function sectorContainsSector$1(nt,_e){return area$1(nt.prev,nt,_e.prev)<0&&area$1(_e.next,nt,nt.next)<0}function indexCurve$1(nt,_e,et,rt){let it=nt;do it.z===0&&(it.z=zOrder$1(it.x,it.y,_e,et,rt)),it.prevZ=it.prev,it.nextZ=it.next,it=it.next;while(it!==nt);it.prevZ.nextZ=null,it.prevZ=null,sortLinked$1(it)}function sortLinked$1(nt){let _e,et,rt,it,st,ot,at,lt,ct=1;do{for(et=nt,nt=null,st=null,ot=0;et;){for(ot++,rt=et,at=0,_e=0;_e<ct&&(at++,rt=rt.nextZ,!!rt);_e++);for(lt=ct;at>0||lt>0&&rt;)at!==0&&(lt===0||!rt||et.z<=rt.z)?(it=et,et=et.nextZ,at--):(it=rt,rt=rt.nextZ,lt--),st?st.nextZ=it:nt=it,it.prevZ=st,st=it;et=rt}st.nextZ=null,ct*=2}while(ot>1);return nt}function zOrder$1(nt,_e,et,rt,it){return nt=(nt-et)*it|0,_e=(_e-rt)*it|0,nt=(nt|nt<<8)&16711935,nt=(nt|nt<<4)&252645135,nt=(nt|nt<<2)&858993459,nt=(nt|nt<<1)&1431655765,_e=(_e|_e<<8)&16711935,_e=(_e|_e<<4)&252645135,_e=(_e|_e<<2)&858993459,_e=(_e|_e<<1)&1431655765,nt|_e<<1}function getLeftmost$1(nt){let _e=nt,et=nt;do(_e.x<et.x||_e.x===et.x&&_e.y<et.y)&&(et=_e),_e=_e.next;while(_e!==nt);return et}function pointInTriangle$1(nt,_e,et,rt,it,st,ot,at){return(it-ot)*(_e-at)>=(nt-ot)*(st-at)&&(nt-ot)*(rt-at)>=(et-ot)*(_e-at)&&(et-ot)*(st-at)>=(it-ot)*(rt-at)}function isValidDiagonal$1(nt,_e){return nt.next.i!==_e.i&&nt.prev.i!==_e.i&&!intersectsPolygon$1(nt,_e)&&(locallyInside$1(nt,_e)&&locallyInside$1(_e,nt)&&middleInside$1(nt,_e)&&(area$1(nt.prev,nt,_e.prev)||area$1(nt,_e.prev,_e))||equals$2(nt,_e)&&area$1(nt.prev,nt,nt.next)>0&&area$1(_e.prev,_e,_e.next)>0)}function area$1(nt,_e,et){return(_e.y-nt.y)*(et.x-_e.x)-(_e.x-nt.x)*(et.y-_e.y)}function equals$2(nt,_e){return nt.x===_e.x&&nt.y===_e.y}function intersects$1(nt,_e,et,rt){const it=sign$4(area$1(nt,_e,et)),st=sign$4(area$1(nt,_e,rt)),ot=sign$4(area$1(et,rt,nt)),at=sign$4(area$1(et,rt,_e));return!!(it!==st&&ot!==at||it===0&&onSegment$1(nt,et,_e)||st===0&&onSegment$1(nt,rt,_e)||ot===0&&onSegment$1(et,nt,rt)||at===0&&onSegment$1(et,_e,rt))}function onSegment$1(nt,_e,et){return _e.x<=Math.max(nt.x,et.x)&&_e.x>=Math.min(nt.x,et.x)&&_e.y<=Math.max(nt.y,et.y)&&_e.y>=Math.min(nt.y,et.y)}function sign$4(nt){return nt>0?1:nt<0?-1:0}function intersectsPolygon$1(nt,_e){let et=nt;do{if(et.i!==nt.i&&et.next.i!==nt.i&&et.i!==_e.i&&et.next.i!==_e.i&&intersects$1(et,et.next,nt,_e))return!0;et=et.next}while(et!==nt);return!1}function locallyInside$1(nt,_e){return area$1(nt.prev,nt,nt.next)<0?area$1(nt,_e,nt.next)>=0&&area$1(nt,nt.prev,_e)>=0:area$1(nt,_e,nt.prev)<0||area$1(nt,nt.next,_e)<0}function middleInside$1(nt,_e){let et=nt,rt=!1;const it=(nt.x+_e.x)/2,st=(nt.y+_e.y)/2;do et.y>st!=et.next.y>st&&et.next.y!==et.y&&it<(et.next.x-et.x)*(st-et.y)/(et.next.y-et.y)+et.x&&(rt=!rt),et=et.next;while(et!==nt);return rt}function splitPolygon$1(nt,_e){const et=new Node$2(nt.i,nt.x,nt.y),rt=new Node$2(_e.i,_e.x,_e.y),it=nt.next,st=_e.prev;return nt.next=_e,_e.prev=nt,et.next=it,it.prev=et,rt.next=et,et.prev=rt,st.next=rt,rt.prev=st,rt}function insertNode$1(nt,_e,et,rt){const it=new Node$2(nt,_e,et);return rt?(it.next=rt.next,it.prev=rt,rt.next.prev=it,rt.next=it):(it.prev=it,it.next=it),it}function removeNode$1(nt){nt.next.prev=nt.prev,nt.prev.next=nt.next,nt.prevZ&&(nt.prevZ.nextZ=nt.nextZ),nt.nextZ&&(nt.nextZ.prevZ=nt.prevZ)}function Node$2(nt,_e,et){this.i=nt,this.x=_e,this.y=et,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea$1(nt,_e,et,rt){let it=0;for(let st=_e,ot=et-rt;st<et;st+=rt)it+=(nt[ot]-nt[st])*(nt[st+1]+nt[ot+1]),ot=st;return it}class ShapeUtils{static area(_e){const et=_e.length;let rt=0;for(let it=et-1,st=0;st<et;it=st++)rt+=_e[it].x*_e[st].y-_e[st].x*_e[it].y;return rt*.5}static isClockWise(_e){return ShapeUtils.area(_e)<0}static triangulateShape(_e,et){const rt=[],it=[],st=[];removeDupEndPts(_e),addContour(rt,_e);let ot=_e.length;et.forEach(removeDupEndPts);for(let lt=0;lt<et.length;lt++)it.push(ot),ot+=et[lt].length,addContour(rt,et[lt]);const at=Earcut.triangulate(rt,it);for(let lt=0;lt<at.length;lt+=3)st.push(at.slice(lt,lt+3));return st}}function removeDupEndPts(nt){const _e=nt.length;_e>2&&nt[_e-1].equals(nt[0])&&nt.pop()}function addContour(nt,_e){for(let et=0;et<_e.length;et++)nt.push(_e[et].x),nt.push(_e[et].y)}class ExtrudeGeometry extends BufferGeometry$1{constructor(_e=new Shape([new Vector2$1(.5,.5),new Vector2$1(-.5,.5),new Vector2$1(-.5,-.5),new Vector2$1(.5,-.5)]),et={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_e,options:et},_e=Array.isArray(_e)?_e:[_e];const rt=this,it=[],st=[];for(let at=0,lt=_e.length;at<lt;at++){const ct=_e[at];ot(ct)}this.setAttribute("position",new Float32BufferAttribute$1(it,3)),this.setAttribute("uv",new Float32BufferAttribute$1(st,2)),this.computeVertexNormals();function ot(at){const lt=[],ct=et.curveSegments!==void 0?et.curveSegments:12,ut=et.steps!==void 0?et.steps:1,ht=et.depth!==void 0?et.depth:1;let dt=et.bevelEnabled!==void 0?et.bevelEnabled:!0,ft=et.bevelThickness!==void 0?et.bevelThickness:.2,pt=et.bevelSize!==void 0?et.bevelSize:ft-.1,mt=et.bevelOffset!==void 0?et.bevelOffset:0,At=et.bevelSegments!==void 0?et.bevelSegments:3;const gt=et.extrudePath,bt=et.UVGenerator!==void 0?et.UVGenerator:WorldUVGenerator;let Tt,wt=!1,Rt,It,Lt,$t;gt&&(Tt=gt.getSpacedPoints(ut),wt=!0,dt=!1,Rt=gt.computeFrenetFrames(ut,!1),It=new Vector3$1,Lt=new Vector3$1,$t=new Vector3$1),dt||(At=0,ft=0,pt=0,mt=0);const kt=at.extractPoints(ct);let Dt=kt.shape;const Ot=kt.holes;if(!ShapeUtils.isClockWise(Dt)){Dt=Dt.reverse();for(let En=0,dn=Ot.length;En<dn;En++){const rr=Ot[En];ShapeUtils.isClockWise(rr)&&(Ot[En]=rr.reverse())}}const Ht=ShapeUtils.triangulateShape(Dt,Ot),Yt=Dt;for(let En=0,dn=Ot.length;En<dn;En++){const rr=Ot[En];Dt=Dt.concat(rr)}function Xt(En,dn,rr){return dn||console.error("THREE.ExtrudeGeometry: vec does not exist"),En.clone().addScaledVector(dn,rr)}const Zt=Dt.length,rn=Ht.length;function Gt(En,dn,rr){let er,Yn,ir;const Qn=En.x-dn.x,sr=En.y-dn.y,un=rr.x-En.x,en=rr.y-En.y,wn=Qn*Qn+sr*sr,gn=Qn*en-sr*un;if(Math.abs(gn)>Number.EPSILON){const Mn=Math.sqrt(wn),In=Math.sqrt(un*un+en*en),gr=dn.x-sr/Mn,jn=dn.y+Qn/Mn,hr=rr.x-en/In,Tr=rr.y+un/In,cr=((hr-gr)*en-(Tr-jn)*un)/(Qn*en-sr*un);er=gr+Qn*cr-En.x,Yn=jn+sr*cr-En.y;const yr=er*er+Yn*Yn;if(yr<=2)return new Vector2$1(er,Yn);ir=Math.sqrt(yr/2)}else{let Mn=!1;Qn>Number.EPSILON?un>Number.EPSILON&&(Mn=!0):Qn<-Number.EPSILON?un<-Number.EPSILON&&(Mn=!0):Math.sign(sr)===Math.sign(en)&&(Mn=!0),Mn?(er=-sr,Yn=Qn,ir=Math.sqrt(wn)):(er=Qn,Yn=sr,ir=Math.sqrt(wn/2))}return new Vector2$1(er/ir,Yn/ir)}const jt=[];for(let En=0,dn=Yt.length,rr=dn-1,er=En+1;En<dn;En++,rr++,er++)rr===dn&&(rr=0),er===dn&&(er=0),jt[En]=Gt(Yt[En],Yt[rr],Yt[er]);const Kt=[];let Jt,sn=jt.concat();for(let En=0,dn=Ot.length;En<dn;En++){const rr=Ot[En];Jt=[];for(let er=0,Yn=rr.length,ir=Yn-1,Qn=er+1;er<Yn;er++,ir++,Qn++)ir===Yn&&(ir=0),Qn===Yn&&(Qn=0),Jt[er]=Gt(rr[er],rr[ir],rr[Qn]);Kt.push(Jt),sn=sn.concat(Jt)}for(let En=0;En<At;En++){const dn=En/At,rr=ft*Math.cos(dn*Math.PI/2),er=pt*Math.sin(dn*Math.PI/2)+mt;for(let Yn=0,ir=Yt.length;Yn<ir;Yn++){const Qn=Xt(Yt[Yn],jt[Yn],er);yn(Qn.x,Qn.y,-rr)}for(let Yn=0,ir=Ot.length;Yn<ir;Yn++){const Qn=Ot[Yn];Jt=Kt[Yn];for(let sr=0,un=Qn.length;sr<un;sr++){const en=Xt(Qn[sr],Jt[sr],er);yn(en.x,en.y,-rr)}}}const hn=pt+mt;for(let En=0;En<Zt;En++){const dn=dt?Xt(Dt[En],sn[En],hn):Dt[En];wt?(Lt.copy(Rt.normals[0]).multiplyScalar(dn.x),It.copy(Rt.binormals[0]).multiplyScalar(dn.y),$t.copy(Tt[0]).add(Lt).add(It),yn($t.x,$t.y,$t.z)):yn(dn.x,dn.y,0)}for(let En=1;En<=ut;En++)for(let dn=0;dn<Zt;dn++){const rr=dt?Xt(Dt[dn],sn[dn],hn):Dt[dn];wt?(Lt.copy(Rt.normals[En]).multiplyScalar(rr.x),It.copy(Rt.binormals[En]).multiplyScalar(rr.y),$t.copy(Tt[En]).add(Lt).add(It),yn($t.x,$t.y,$t.z)):yn(rr.x,rr.y,ht/ut*En)}for(let En=At-1;En>=0;En--){const dn=En/At,rr=ft*Math.cos(dn*Math.PI/2),er=pt*Math.sin(dn*Math.PI/2)+mt;for(let Yn=0,ir=Yt.length;Yn<ir;Yn++){const Qn=Xt(Yt[Yn],jt[Yn],er);yn(Qn.x,Qn.y,ht+rr)}for(let Yn=0,ir=Ot.length;Yn<ir;Yn++){const Qn=Ot[Yn];Jt=Kt[Yn];for(let sr=0,un=Qn.length;sr<un;sr++){const en=Xt(Qn[sr],Jt[sr],er);wt?yn(en.x,en.y+Tt[ut-1].y,Tt[ut-1].x+rr):yn(en.x,en.y,ht+rr)}}}an(),pn();function an(){const En=it.length/3;if(dt){let dn=0,rr=Zt*dn;for(let er=0;er<rn;er++){const Yn=Ht[er];$n(Yn[2]+rr,Yn[1]+rr,Yn[0]+rr)}dn=ut+At*2,rr=Zt*dn;for(let er=0;er<rn;er++){const Yn=Ht[er];$n(Yn[0]+rr,Yn[1]+rr,Yn[2]+rr)}}else{for(let dn=0;dn<rn;dn++){const rr=Ht[dn];$n(rr[2],rr[1],rr[0])}for(let dn=0;dn<rn;dn++){const rr=Ht[dn];$n(rr[0]+Zt*ut,rr[1]+Zt*ut,rr[2]+Zt*ut)}}rt.addGroup(En,it.length/3-En,0)}function pn(){const En=it.length/3;let dn=0;_n(Yt,dn),dn+=Yt.length;for(let rr=0,er=Ot.length;rr<er;rr++){const Yn=Ot[rr];_n(Yn,dn),dn+=Yn.length}rt.addGroup(En,it.length/3-En,1)}function _n(En,dn){let rr=En.length;for(;--rr>=0;){const er=rr;let Yn=rr-1;Yn<0&&(Yn=En.length-1);for(let ir=0,Qn=ut+At*2;ir<Qn;ir++){const sr=Zt*ir,un=Zt*(ir+1),en=dn+er+sr,wn=dn+Yn+sr,gn=dn+Yn+un,Mn=dn+er+un;Jn(en,wn,gn,Mn)}}}function yn(En,dn,rr){lt.push(En),lt.push(dn),lt.push(rr)}function $n(En,dn,rr){Xn(En),Xn(dn),Xn(rr);const er=it.length/3,Yn=bt.generateTopUV(rt,it,er-3,er-2,er-1);Vn(Yn[0]),Vn(Yn[1]),Vn(Yn[2])}function Jn(En,dn,rr,er){Xn(En),Xn(dn),Xn(er),Xn(dn),Xn(rr),Xn(er);const Yn=it.length/3,ir=bt.generateSideWallUV(rt,it,Yn-6,Yn-3,Yn-2,Yn-1);Vn(ir[0]),Vn(ir[1]),Vn(ir[3]),Vn(ir[1]),Vn(ir[2]),Vn(ir[3])}function Xn(En){it.push(lt[En*3+0]),it.push(lt[En*3+1]),it.push(lt[En*3+2])}function Vn(En){st.push(En.x),st.push(En.y)}}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON(),et=this.parameters.shapes,rt=this.parameters.options;return toJSON$1(et,rt,_e)}static fromJSON(_e,et){const rt=[];for(let st=0,ot=_e.shapes.length;st<ot;st++){const at=et[_e.shapes[st]];rt.push(at)}const it=_e.options.extrudePath;return it!==void 0&&(_e.options.extrudePath=new Curves[it.type]().fromJSON(it)),new ExtrudeGeometry(rt,_e.options)}}const WorldUVGenerator={generateTopUV:function(nt,_e,et,rt,it){const st=_e[et*3],ot=_e[et*3+1],at=_e[rt*3],lt=_e[rt*3+1],ct=_e[it*3],ut=_e[it*3+1];return[new Vector2$1(st,ot),new Vector2$1(at,lt),new Vector2$1(ct,ut)]},generateSideWallUV:function(nt,_e,et,rt,it,st){const ot=_e[et*3],at=_e[et*3+1],lt=_e[et*3+2],ct=_e[rt*3],ut=_e[rt*3+1],ht=_e[rt*3+2],dt=_e[it*3],ft=_e[it*3+1],pt=_e[it*3+2],mt=_e[st*3],At=_e[st*3+1],gt=_e[st*3+2];return Math.abs(at-ut)<Math.abs(ot-ct)?[new Vector2$1(ot,1-lt),new Vector2$1(ct,1-ht),new Vector2$1(dt,1-pt),new Vector2$1(mt,1-gt)]:[new Vector2$1(at,1-lt),new Vector2$1(ut,1-ht),new Vector2$1(ft,1-pt),new Vector2$1(At,1-gt)]}};function toJSON$1(nt,_e,et){if(et.shapes=[],Array.isArray(nt))for(let rt=0,it=nt.length;rt<it;rt++){const st=nt[rt];et.shapes.push(st.uuid)}else et.shapes.push(nt.uuid);return et.options=Object.assign({},_e),_e.extrudePath!==void 0&&(et.options.extrudePath=_e.extrudePath.toJSON()),et}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_e=1,et=0){const rt=(1+Math.sqrt(5))/2,it=[-1,rt,0,1,rt,0,-1,-rt,0,1,-rt,0,0,-1,rt,0,1,rt,0,-1,-rt,0,1,-rt,rt,0,-1,rt,0,1,-rt,0,-1,-rt,0,1],st=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(it,st,_e,et),this.type="IcosahedronGeometry",this.parameters={radius:_e,detail:et}}static fromJSON(_e){return new IcosahedronGeometry(_e.radius,_e.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_e=1,et=0){const rt=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],it=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(rt,it,_e,et),this.type="OctahedronGeometry",this.parameters={radius:_e,detail:et}}static fromJSON(_e){return new OctahedronGeometry(_e.radius,_e.detail)}}class RingGeometry extends BufferGeometry$1{constructor(_e=.5,et=1,rt=32,it=1,st=0,ot=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_e,outerRadius:et,thetaSegments:rt,phiSegments:it,thetaStart:st,thetaLength:ot},rt=Math.max(3,rt),it=Math.max(1,it);const at=[],lt=[],ct=[],ut=[];let ht=_e;const dt=(et-_e)/it,ft=new Vector3$1,pt=new Vector2$1;for(let mt=0;mt<=it;mt++){for(let At=0;At<=rt;At++){const gt=st+At/rt*ot;ft.x=ht*Math.cos(gt),ft.y=ht*Math.sin(gt),lt.push(ft.x,ft.y,ft.z),ct.push(0,0,1),pt.x=(ft.x/et+1)/2,pt.y=(ft.y/et+1)/2,ut.push(pt.x,pt.y)}ht+=dt}for(let mt=0;mt<it;mt++){const At=mt*(rt+1);for(let gt=0;gt<rt;gt++){const bt=gt+At,Tt=bt,wt=bt+rt+1,Rt=bt+rt+2,It=bt+1;at.push(Tt,wt,It),at.push(wt,Rt,It)}}this.setIndex(at),this.setAttribute("position",new Float32BufferAttribute$1(lt,3)),this.setAttribute("normal",new Float32BufferAttribute$1(ct,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ut,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new RingGeometry(_e.innerRadius,_e.outerRadius,_e.thetaSegments,_e.phiSegments,_e.thetaStart,_e.thetaLength)}}class ShapeGeometry extends BufferGeometry$1{constructor(_e=new Shape([new Vector2$1(0,.5),new Vector2$1(-.5,-.5),new Vector2$1(.5,-.5)]),et=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_e,curveSegments:et};const rt=[],it=[],st=[],ot=[];let at=0,lt=0;if(Array.isArray(_e)===!1)ct(_e);else for(let ut=0;ut<_e.length;ut++)ct(_e[ut]),this.addGroup(at,lt,ut),at+=lt,lt=0;this.setIndex(rt),this.setAttribute("position",new Float32BufferAttribute$1(it,3)),this.setAttribute("normal",new Float32BufferAttribute$1(st,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ot,2));function ct(ut){const ht=it.length/3,dt=ut.extractPoints(et);let ft=dt.shape;const pt=dt.holes;ShapeUtils.isClockWise(ft)===!1&&(ft=ft.reverse());for(let At=0,gt=pt.length;At<gt;At++){const bt=pt[At];ShapeUtils.isClockWise(bt)===!0&&(pt[At]=bt.reverse())}const mt=ShapeUtils.triangulateShape(ft,pt);for(let At=0,gt=pt.length;At<gt;At++){const bt=pt[At];ft=ft.concat(bt)}for(let At=0,gt=ft.length;At<gt;At++){const bt=ft[At];it.push(bt.x,bt.y,0),st.push(0,0,1),ot.push(bt.x,bt.y)}for(let At=0,gt=mt.length;At<gt;At++){const bt=mt[At],Tt=bt[0]+ht,wt=bt[1]+ht,Rt=bt[2]+ht;rt.push(Tt,wt,Rt),lt+=3}}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON(),et=this.parameters.shapes;return toJSON(et,_e)}static fromJSON(_e,et){const rt=[];for(let it=0,st=_e.shapes.length;it<st;it++){const ot=et[_e.shapes[it]];rt.push(ot)}return new ShapeGeometry(rt,_e.curveSegments)}}function toJSON(nt,_e){if(_e.shapes=[],Array.isArray(nt))for(let et=0,rt=nt.length;et<rt;et++){const it=nt[et];_e.shapes.push(it.uuid)}else _e.shapes.push(nt.uuid);return _e}let SphereGeometry$1=class _0 extends BufferGeometry$1{constructor(_e=1,et=32,rt=16,it=0,st=Math.PI*2,ot=0,at=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_e,widthSegments:et,heightSegments:rt,phiStart:it,phiLength:st,thetaStart:ot,thetaLength:at},et=Math.max(3,Math.floor(et)),rt=Math.max(2,Math.floor(rt));const lt=Math.min(ot+at,Math.PI);let ct=0;const ut=[],ht=new Vector3$1,dt=new Vector3$1,ft=[],pt=[],mt=[],At=[];for(let gt=0;gt<=rt;gt++){const bt=[],Tt=gt/rt;let wt=0;gt===0&&ot===0?wt=.5/et:gt===rt&&lt===Math.PI&&(wt=-.5/et);for(let Rt=0;Rt<=et;Rt++){const It=Rt/et;ht.x=-_e*Math.cos(it+It*st)*Math.sin(ot+Tt*at),ht.y=_e*Math.cos(ot+Tt*at),ht.z=_e*Math.sin(it+It*st)*Math.sin(ot+Tt*at),pt.push(ht.x,ht.y,ht.z),dt.copy(ht).normalize(),mt.push(dt.x,dt.y,dt.z),At.push(It+wt,1-Tt),bt.push(ct++)}ut.push(bt)}for(let gt=0;gt<rt;gt++)for(let bt=0;bt<et;bt++){const Tt=ut[gt][bt+1],wt=ut[gt][bt],Rt=ut[gt+1][bt],It=ut[gt+1][bt+1];(gt!==0||ot>0)&&ft.push(Tt,wt,It),(gt!==rt-1||lt<Math.PI)&&ft.push(wt,Rt,It)}this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute$1(pt,3)),this.setAttribute("normal",new Float32BufferAttribute$1(mt,3)),this.setAttribute("uv",new Float32BufferAttribute$1(At,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new _0(_e.radius,_e.widthSegments,_e.heightSegments,_e.phiStart,_e.phiLength,_e.thetaStart,_e.thetaLength)}};class TetrahedronGeometry extends PolyhedronGeometry{constructor(_e=1,et=0){const rt=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],it=[2,1,0,0,3,2,1,3,0,2,3,1];super(rt,it,_e,et),this.type="TetrahedronGeometry",this.parameters={radius:_e,detail:et}}static fromJSON(_e){return new TetrahedronGeometry(_e.radius,_e.detail)}}class TorusGeometry extends BufferGeometry$1{constructor(_e=1,et=.4,rt=12,it=48,st=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_e,tube:et,radialSegments:rt,tubularSegments:it,arc:st},rt=Math.floor(rt),it=Math.floor(it);const ot=[],at=[],lt=[],ct=[],ut=new Vector3$1,ht=new Vector3$1,dt=new Vector3$1;for(let ft=0;ft<=rt;ft++)for(let pt=0;pt<=it;pt++){const mt=pt/it*st,At=ft/rt*Math.PI*2;ht.x=(_e+et*Math.cos(At))*Math.cos(mt),ht.y=(_e+et*Math.cos(At))*Math.sin(mt),ht.z=et*Math.sin(At),at.push(ht.x,ht.y,ht.z),ut.x=_e*Math.cos(mt),ut.y=_e*Math.sin(mt),dt.subVectors(ht,ut).normalize(),lt.push(dt.x,dt.y,dt.z),ct.push(pt/it),ct.push(ft/rt)}for(let ft=1;ft<=rt;ft++)for(let pt=1;pt<=it;pt++){const mt=(it+1)*ft+pt-1,At=(it+1)*(ft-1)+pt-1,gt=(it+1)*(ft-1)+pt,bt=(it+1)*ft+pt;ot.push(mt,At,bt),ot.push(At,gt,bt)}this.setIndex(ot),this.setAttribute("position",new Float32BufferAttribute$1(at,3)),this.setAttribute("normal",new Float32BufferAttribute$1(lt,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ct,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new TorusGeometry(_e.radius,_e.tube,_e.radialSegments,_e.tubularSegments,_e.arc)}}class TorusKnotGeometry extends BufferGeometry$1{constructor(_e=1,et=.4,rt=64,it=8,st=2,ot=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_e,tube:et,tubularSegments:rt,radialSegments:it,p:st,q:ot},rt=Math.floor(rt),it=Math.floor(it);const at=[],lt=[],ct=[],ut=[],ht=new Vector3$1,dt=new Vector3$1,ft=new Vector3$1,pt=new Vector3$1,mt=new Vector3$1,At=new Vector3$1,gt=new Vector3$1;for(let Tt=0;Tt<=rt;++Tt){const wt=Tt/rt*st*Math.PI*2;bt(wt,st,ot,_e,ft),bt(wt+.01,st,ot,_e,pt),At.subVectors(pt,ft),gt.addVectors(pt,ft),mt.crossVectors(At,gt),gt.crossVectors(mt,At),mt.normalize(),gt.normalize();for(let Rt=0;Rt<=it;++Rt){const It=Rt/it*Math.PI*2,Lt=-et*Math.cos(It),$t=et*Math.sin(It);ht.x=ft.x+(Lt*gt.x+$t*mt.x),ht.y=ft.y+(Lt*gt.y+$t*mt.y),ht.z=ft.z+(Lt*gt.z+$t*mt.z),lt.push(ht.x,ht.y,ht.z),dt.subVectors(ht,ft).normalize(),ct.push(dt.x,dt.y,dt.z),ut.push(Tt/rt),ut.push(Rt/it)}}for(let Tt=1;Tt<=rt;Tt++)for(let wt=1;wt<=it;wt++){const Rt=(it+1)*(Tt-1)+(wt-1),It=(it+1)*Tt+(wt-1),Lt=(it+1)*Tt+wt,$t=(it+1)*(Tt-1)+wt;at.push(Rt,It,$t),at.push(It,Lt,$t)}this.setIndex(at),this.setAttribute("position",new Float32BufferAttribute$1(lt,3)),this.setAttribute("normal",new Float32BufferAttribute$1(ct,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ut,2));function bt(Tt,wt,Rt,It,Lt){const $t=Math.cos(Tt),kt=Math.sin(Tt),Dt=Rt/wt*Tt,Ot=Math.cos(Dt);Lt.x=It*(2+Ot)*.5*$t,Lt.y=It*(2+Ot)*kt*.5,Lt.z=It*Math.sin(Dt)*.5}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new TorusKnotGeometry(_e.radius,_e.tube,_e.tubularSegments,_e.radialSegments,_e.p,_e.q)}}class TubeGeometry extends BufferGeometry$1{constructor(_e=new QuadraticBezierCurve3(new Vector3$1(-1,-1,0),new Vector3$1(-1,1,0),new Vector3$1(1,1,0)),et=64,rt=1,it=8,st=!1){super(),this.type="TubeGeometry",this.parameters={path:_e,tubularSegments:et,radius:rt,radialSegments:it,closed:st};const ot=_e.computeFrenetFrames(et,st);this.tangents=ot.tangents,this.normals=ot.normals,this.binormals=ot.binormals;const at=new Vector3$1,lt=new Vector3$1,ct=new Vector2$1;let ut=new Vector3$1;const ht=[],dt=[],ft=[],pt=[];mt(),this.setIndex(pt),this.setAttribute("position",new Float32BufferAttribute$1(ht,3)),this.setAttribute("normal",new Float32BufferAttribute$1(dt,3)),this.setAttribute("uv",new Float32BufferAttribute$1(ft,2));function mt(){for(let Tt=0;Tt<et;Tt++)At(Tt);At(st===!1?et:0),bt(),gt()}function At(Tt){ut=_e.getPointAt(Tt/et,ut);const wt=ot.normals[Tt],Rt=ot.binormals[Tt];for(let It=0;It<=it;It++){const Lt=It/it*Math.PI*2,$t=Math.sin(Lt),kt=-Math.cos(Lt);lt.x=kt*wt.x+$t*Rt.x,lt.y=kt*wt.y+$t*Rt.y,lt.z=kt*wt.z+$t*Rt.z,lt.normalize(),dt.push(lt.x,lt.y,lt.z),at.x=ut.x+rt*lt.x,at.y=ut.y+rt*lt.y,at.z=ut.z+rt*lt.z,ht.push(at.x,at.y,at.z)}}function gt(){for(let Tt=1;Tt<=et;Tt++)for(let wt=1;wt<=it;wt++){const Rt=(it+1)*(Tt-1)+(wt-1),It=(it+1)*Tt+(wt-1),Lt=(it+1)*Tt+wt,$t=(it+1)*(Tt-1)+wt;pt.push(Rt,It,$t),pt.push(It,Lt,$t)}}function bt(){for(let Tt=0;Tt<=et;Tt++)for(let wt=0;wt<=it;wt++)ct.x=Tt/et,ct.y=wt/it,ft.push(ct.x,ct.y)}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON();return _e.path=this.parameters.path.toJSON(),_e}static fromJSON(_e){return new TubeGeometry(new Curves[_e.path.type]().fromJSON(_e.path),_e.tubularSegments,_e.radius,_e.radialSegments,_e.closed)}}class WireframeGeometry extends BufferGeometry$1{constructor(_e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_e},_e!==null){const et=[],rt=new Set,it=new Vector3$1,st=new Vector3$1;if(_e.index!==null){const ot=_e.attributes.position,at=_e.index;let lt=_e.groups;lt.length===0&&(lt=[{start:0,count:at.count,materialIndex:0}]);for(let ct=0,ut=lt.length;ct<ut;++ct){const ht=lt[ct],dt=ht.start,ft=ht.count;for(let pt=dt,mt=dt+ft;pt<mt;pt+=3)for(let At=0;At<3;At++){const gt=at.getX(pt+At),bt=at.getX(pt+(At+1)%3);it.fromBufferAttribute(ot,gt),st.fromBufferAttribute(ot,bt),isUniqueEdge(it,st,rt)===!0&&(et.push(it.x,it.y,it.z),et.push(st.x,st.y,st.z))}}}else{const ot=_e.attributes.position;for(let at=0,lt=ot.count/3;at<lt;at++)for(let ct=0;ct<3;ct++){const ut=3*at+ct,ht=3*at+(ct+1)%3;it.fromBufferAttribute(ot,ut),st.fromBufferAttribute(ot,ht),isUniqueEdge(it,st,rt)===!0&&(et.push(it.x,it.y,it.z),et.push(st.x,st.y,st.z))}}this.setAttribute("position",new Float32BufferAttribute$1(et,3))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}}function isUniqueEdge(nt,_e,et){const rt=`${nt.x},${nt.y},${nt.z}-${_e.x},${_e.y},${_e.z}`,it=`${_e.x},${_e.y},${_e.z}-${nt.x},${nt.y},${nt.z}`;return et.has(rt)===!0||et.has(it)===!0?!1:(et.add(rt),et.add(it),!0)}var Geometries$1=Object.freeze({__proto__:null,BoxGeometry:BoxGeometry$1,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry:SphereGeometry$1,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});let ShadowMaterial$1=class extends Material$1{constructor(_e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color$2(0),this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.fog=_e.fog,this}};class RawShaderMaterial extends ShaderMaterial$1{constructor(_e){super(_e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}let MeshStandardMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color$2(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$2(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap$1,this.normalScale=new Vector2$1(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler$1,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={STANDARD:""},this.color.copy(_e.color),this.roughness=_e.roughness,this.metalness=_e.metalness,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.roughnessMap=_e.roughnessMap,this.metalnessMap=_e.metalnessMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.envMapIntensity=_e.envMapIntensity,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}},MeshPhysicalMaterial$1=class extends MeshStandardMaterial$1{constructor(_e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2$1(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$5(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(et){this.ior=(1+.4*et)/(1-.4*et)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color$2(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color$2(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color$2(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_e)}get anisotropy(){return this._anisotropy}set anisotropy(_e){this._anisotropy>0!=_e>0&&this.version++,this._anisotropy=_e}get clearcoat(){return this._clearcoat}set clearcoat(_e){this._clearcoat>0!=_e>0&&this.version++,this._clearcoat=_e}get iridescence(){return this._iridescence}set iridescence(_e){this._iridescence>0!=_e>0&&this.version++,this._iridescence=_e}get dispersion(){return this._dispersion}set dispersion(_e){this._dispersion>0!=_e>0&&this.version++,this._dispersion=_e}get sheen(){return this._sheen}set sheen(_e){this._sheen>0!=_e>0&&this.version++,this._sheen=_e}get transmission(){return this._transmission}set transmission(_e){this._transmission>0!=_e>0&&this.version++,this._transmission=_e}copy(_e){return super.copy(_e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_e.anisotropy,this.anisotropyRotation=_e.anisotropyRotation,this.anisotropyMap=_e.anisotropyMap,this.clearcoat=_e.clearcoat,this.clearcoatMap=_e.clearcoatMap,this.clearcoatRoughness=_e.clearcoatRoughness,this.clearcoatRoughnessMap=_e.clearcoatRoughnessMap,this.clearcoatNormalMap=_e.clearcoatNormalMap,this.clearcoatNormalScale.copy(_e.clearcoatNormalScale),this.dispersion=_e.dispersion,this.ior=_e.ior,this.iridescence=_e.iridescence,this.iridescenceMap=_e.iridescenceMap,this.iridescenceIOR=_e.iridescenceIOR,this.iridescenceThicknessRange=[..._e.iridescenceThicknessRange],this.iridescenceThicknessMap=_e.iridescenceThicknessMap,this.sheen=_e.sheen,this.sheenColor.copy(_e.sheenColor),this.sheenColorMap=_e.sheenColorMap,this.sheenRoughness=_e.sheenRoughness,this.sheenRoughnessMap=_e.sheenRoughnessMap,this.transmission=_e.transmission,this.transmissionMap=_e.transmissionMap,this.thickness=_e.thickness,this.thicknessMap=_e.thicknessMap,this.attenuationDistance=_e.attenuationDistance,this.attenuationColor.copy(_e.attenuationColor),this.specularIntensity=_e.specularIntensity,this.specularIntensityMap=_e.specularIntensityMap,this.specularColor.copy(_e.specularColor),this.specularColorMap=_e.specularColorMap,this}},MeshPhongMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color$2(16777215),this.specular=new Color$2(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$2(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap$1,this.normalScale=new Vector2$1(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler$1,this.combine=MultiplyOperation$1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.specular.copy(_e.specular),this.shininess=_e.shininess,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}},MeshToonMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color$2(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$2(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap$1,this.normalScale=new Vector2$1(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.gradientMap=_e.gradientMap,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}},MeshNormalMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap$1,this.normalScale=new Vector2$1(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_e)}copy(_e){return super.copy(_e),this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.flatShading=_e.flatShading,this}},MeshLambertMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color$2(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$2(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap$1,this.normalScale=new Vector2$1(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler$1,this.combine=MultiplyOperation$1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}},MeshMatcapMaterial$1=class extends Material$1{constructor(_e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color$2(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap$1,this.normalScale=new Vector2$1(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={MATCAP:""},this.color.copy(_e.color),this.matcap=_e.matcap,this.map=_e.map,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.flatShading=_e.flatShading,this.fog=_e.fog,this}},LineDashedMaterial$1=class extends LineBasicMaterial$1{constructor(_e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.scale=_e.scale,this.dashSize=_e.dashSize,this.gapSize=_e.gapSize,this}};function convertArray(nt,_e,et){return!nt||!et&&nt.constructor===_e?nt:typeof _e.BYTES_PER_ELEMENT=="number"?new _e(nt):Array.prototype.slice.call(nt)}function isTypedArray(nt){return ArrayBuffer.isView(nt)&&!(nt instanceof DataView)}function getKeyframeOrder(nt){function _e(it,st){return nt[it]-nt[st]}const et=nt.length,rt=new Array(et);for(let it=0;it!==et;++it)rt[it]=it;return rt.sort(_e),rt}function sortedArray(nt,_e,et){const rt=nt.length,it=new nt.constructor(rt);for(let st=0,ot=0;ot!==rt;++st){const at=et[st]*_e;for(let lt=0;lt!==_e;++lt)it[ot++]=nt[at+lt]}return it}function flattenJSON(nt,_e,et,rt){let it=1,st=nt[0];for(;st!==void 0&&st[rt]===void 0;)st=nt[it++];if(st===void 0)return;let ot=st[rt];if(ot!==void 0)if(Array.isArray(ot))do ot=st[rt],ot!==void 0&&(_e.push(st.time),et.push.apply(et,ot)),st=nt[it++];while(st!==void 0);else if(ot.toArray!==void 0)do ot=st[rt],ot!==void 0&&(_e.push(st.time),ot.toArray(et,et.length)),st=nt[it++];while(st!==void 0);else do ot=st[rt],ot!==void 0&&(_e.push(st.time),et.push(ot)),st=nt[it++];while(st!==void 0)}function subclip(nt,_e,et,rt,it=30){const st=nt.clone();st.name=_e;const ot=[];for(let lt=0;lt<st.tracks.length;++lt){const ct=st.tracks[lt],ut=ct.getValueSize(),ht=[],dt=[];for(let ft=0;ft<ct.times.length;++ft){const pt=ct.times[ft]*it;if(!(pt<et||pt>=rt)){ht.push(ct.times[ft]);for(let mt=0;mt<ut;++mt)dt.push(ct.values[ft*ut+mt])}}ht.length!==0&&(ct.times=convertArray(ht,ct.times.constructor),ct.values=convertArray(dt,ct.values.constructor),ot.push(ct))}st.tracks=ot;let at=1/0;for(let lt=0;lt<st.tracks.length;++lt)at>st.tracks[lt].times[0]&&(at=st.tracks[lt].times[0]);for(let lt=0;lt<st.tracks.length;++lt)st.tracks[lt].shift(-1*at);return st.resetDuration(),st}function makeClipAdditive(nt,_e=0,et=nt,rt=30){rt<=0&&(rt=30);const it=et.tracks.length,st=_e/rt;for(let ot=0;ot<it;++ot){const at=et.tracks[ot],lt=at.ValueTypeName;if(lt==="bool"||lt==="string")continue;const ct=nt.tracks.find(function(gt){return gt.name===at.name&&gt.ValueTypeName===lt});if(ct===void 0)continue;let ut=0;const ht=at.getValueSize();at.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ut=ht/3);let dt=0;const ft=ct.getValueSize();ct.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(dt=ft/3);const pt=at.times.length-1;let mt;if(st<=at.times[0]){const gt=ut,bt=ht-ut;mt=at.values.slice(gt,bt)}else if(st>=at.times[pt]){const gt=pt*ht+ut,bt=gt+ht-ut;mt=at.values.slice(gt,bt)}else{const gt=at.createInterpolant(),bt=ut,Tt=ht-ut;gt.evaluate(st),mt=gt.resultBuffer.slice(bt,Tt)}lt==="quaternion"&&new Quaternion$1().fromArray(mt).normalize().conjugate().toArray(mt);const At=ct.times.length;for(let gt=0;gt<At;++gt){const bt=gt*ft+dt;if(lt==="quaternion")Quaternion$1.multiplyQuaternionsFlat(ct.values,bt,mt,0,ct.values,bt);else{const Tt=ft-dt*2;for(let wt=0;wt<Tt;++wt)ct.values[bt+wt]-=mt[wt]}}}return nt.blendMode=AdditiveAnimationBlendMode,nt}const AnimationUtils={convertArray,isTypedArray,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_e,et,rt,it){this.parameterPositions=_e,this._cachedIndex=0,this.resultBuffer=it!==void 0?it:new et.constructor(rt),this.sampleValues=et,this.valueSize=rt,this.settings=null,this.DefaultSettings_={}}evaluate(_e){const et=this.parameterPositions;let rt=this._cachedIndex,it=et[rt],st=et[rt-1];e:{t:{let ot;n:{r:if(!(_e<it)){for(let at=rt+2;;){if(it===void 0){if(_e<st)break r;return rt=et.length,this._cachedIndex=rt,this.copySampleValue_(rt-1)}if(rt===at)break;if(st=it,it=et[++rt],_e<it)break t}ot=et.length;break n}if(!(_e>=st)){const at=et[1];_e<at&&(rt=2,st=at);for(let lt=rt-2;;){if(st===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(rt===lt)break;if(it=st,st=et[--rt-1],_e>=st)break t}ot=rt,rt=0;break n}break e}for(;rt<ot;){const at=rt+ot>>>1;_e<et[at]?ot=at:rt=at+1}if(it=et[rt],st=et[rt-1],st===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(it===void 0)return rt=et.length,this._cachedIndex=rt,this.copySampleValue_(rt-1)}this._cachedIndex=rt,this.intervalChanged_(rt,st,it)}return this.interpolate_(rt,st,_e,it)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_e){const et=this.resultBuffer,rt=this.sampleValues,it=this.valueSize,st=_e*it;for(let ot=0;ot!==it;++ot)et[ot]=rt[st+ot];return et}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_e,et,rt,it){super(_e,et,rt,it),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_e,et,rt){const it=this.parameterPositions;let st=_e-2,ot=_e+1,at=it[st],lt=it[ot];if(at===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:st=_e,at=2*et-rt;break;case WrapAroundEnding:st=it.length-2,at=et+it[st]-it[st+1];break;default:st=_e,at=rt}if(lt===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:ot=_e,lt=2*rt-et;break;case WrapAroundEnding:ot=1,lt=rt+it[1]-it[0];break;default:ot=_e-1,lt=et}const ct=(rt-et)*.5,ut=this.valueSize;this._weightPrev=ct/(et-at),this._weightNext=ct/(lt-rt),this._offsetPrev=st*ut,this._offsetNext=ot*ut}interpolate_(_e,et,rt,it){const st=this.resultBuffer,ot=this.sampleValues,at=this.valueSize,lt=_e*at,ct=lt-at,ut=this._offsetPrev,ht=this._offsetNext,dt=this._weightPrev,ft=this._weightNext,pt=(rt-et)/(it-et),mt=pt*pt,At=mt*pt,gt=-dt*At+2*dt*mt-dt*pt,bt=(1+dt)*At+(-1.5-2*dt)*mt+(-.5+dt)*pt+1,Tt=(-1-ft)*At+(1.5+ft)*mt+.5*pt,wt=ft*At-ft*mt;for(let Rt=0;Rt!==at;++Rt)st[Rt]=gt*ot[ut+Rt]+bt*ot[ct+Rt]+Tt*ot[lt+Rt]+wt*ot[ht+Rt];return st}}class LinearInterpolant extends Interpolant{constructor(_e,et,rt,it){super(_e,et,rt,it)}interpolate_(_e,et,rt,it){const st=this.resultBuffer,ot=this.sampleValues,at=this.valueSize,lt=_e*at,ct=lt-at,ut=(rt-et)/(it-et),ht=1-ut;for(let dt=0;dt!==at;++dt)st[dt]=ot[ct+dt]*ht+ot[lt+dt]*ut;return st}}class DiscreteInterpolant extends Interpolant{constructor(_e,et,rt,it){super(_e,et,rt,it)}interpolate_(_e){return this.copySampleValue_(_e-1)}}class KeyframeTrack{constructor(_e,et,rt,it){if(_e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(et===void 0||et.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_e);this.name=_e,this.times=convertArray(et,this.TimeBufferType),this.values=convertArray(rt,this.ValueBufferType),this.setInterpolation(it||this.DefaultInterpolation)}static toJSON(_e){const et=_e.constructor;let rt;if(et.toJSON!==this.toJSON)rt=et.toJSON(_e);else{rt={name:_e.name,times:convertArray(_e.times,Array),values:convertArray(_e.values,Array)};const it=_e.getInterpolation();it!==_e.DefaultInterpolation&&(rt.interpolation=it)}return rt.type=_e.ValueTypeName,rt}InterpolantFactoryMethodDiscrete(_e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_e)}InterpolantFactoryMethodLinear(_e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_e)}InterpolantFactoryMethodSmooth(_e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_e)}setInterpolation(_e){let et;switch(_e){case InterpolateDiscrete:et=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:et=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:et=this.InterpolantFactoryMethodSmooth;break}if(et===void 0){const rt="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(rt);return console.warn("THREE.KeyframeTrack:",rt),this}return this.createInterpolant=et,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_e){if(_e!==0){const et=this.times;for(let rt=0,it=et.length;rt!==it;++rt)et[rt]+=_e}return this}scale(_e){if(_e!==1){const et=this.times;for(let rt=0,it=et.length;rt!==it;++rt)et[rt]*=_e}return this}trim(_e,et){const rt=this.times,it=rt.length;let st=0,ot=it-1;for(;st!==it&&rt[st]<_e;)++st;for(;ot!==-1&&rt[ot]>et;)--ot;if(++ot,st!==0||ot!==it){st>=ot&&(ot=Math.max(ot,1),st=ot-1);const at=this.getValueSize();this.times=rt.slice(st,ot),this.values=this.values.slice(st*at,ot*at)}return this}validate(){let _e=!0;const et=this.getValueSize();et-Math.floor(et)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_e=!1);const rt=this.times,it=this.values,st=rt.length;st===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_e=!1);let ot=null;for(let at=0;at!==st;at++){const lt=rt[at];if(typeof lt=="number"&&isNaN(lt)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,at,lt),_e=!1;break}if(ot!==null&&ot>lt){console.error("THREE.KeyframeTrack: Out of order keys.",this,at,lt,ot),_e=!1;break}ot=lt}if(it!==void 0&&isTypedArray(it))for(let at=0,lt=it.length;at!==lt;++at){const ct=it[at];if(isNaN(ct)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,at,ct),_e=!1;break}}return _e}optimize(){const _e=this.times.slice(),et=this.values.slice(),rt=this.getValueSize(),it=this.getInterpolation()===InterpolateSmooth,st=_e.length-1;let ot=1;for(let at=1;at<st;++at){let lt=!1;const ct=_e[at],ut=_e[at+1];if(ct!==ut&&(at!==1||ct!==_e[0]))if(it)lt=!0;else{const ht=at*rt,dt=ht-rt,ft=ht+rt;for(let pt=0;pt!==rt;++pt){const mt=et[ht+pt];if(mt!==et[dt+pt]||mt!==et[ft+pt]){lt=!0;break}}}if(lt){if(at!==ot){_e[ot]=_e[at];const ht=at*rt,dt=ot*rt;for(let ft=0;ft!==rt;++ft)et[dt+ft]=et[ht+ft]}++ot}}if(st>0){_e[ot]=_e[st];for(let at=st*rt,lt=ot*rt,ct=0;ct!==rt;++ct)et[lt+ct]=et[at+ct];++ot}return ot!==_e.length?(this.times=_e.slice(0,ot),this.values=et.slice(0,ot*rt)):(this.times=_e,this.values=et),this}clone(){const _e=this.times.slice(),et=this.values.slice(),rt=this.constructor,it=new rt(this.name,_e,et);return it.createInterpolant=this.createInterpolant,it}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{constructor(_e,et,rt){super(_e,et,rt)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_e,et,rt,it){super(_e,et,rt,it)}interpolate_(_e,et,rt,it){const st=this.resultBuffer,ot=this.sampleValues,at=this.valueSize,lt=(rt-et)/(it-et);let ct=_e*at;for(let ut=ct+at;ct!==ut;ct+=4)Quaternion$1.slerpFlat(st,0,ot,ct-at,ot,ct,lt);return st}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_e)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(_e,et,rt){super(_e,et,rt)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_e="",et=-1,rt=[],it=NormalAnimationBlendMode){this.name=_e,this.tracks=rt,this.duration=et,this.blendMode=it,this.uuid=generateUUID$2(),this.duration<0&&this.resetDuration()}static parse(_e){const et=[],rt=_e.tracks,it=1/(_e.fps||1);for(let ot=0,at=rt.length;ot!==at;++ot)et.push(parseKeyframeTrack(rt[ot]).scale(it));const st=new this(_e.name,_e.duration,et,_e.blendMode);return st.uuid=_e.uuid,st}static toJSON(_e){const et=[],rt=_e.tracks,it={name:_e.name,duration:_e.duration,tracks:et,uuid:_e.uuid,blendMode:_e.blendMode};for(let st=0,ot=rt.length;st!==ot;++st)et.push(KeyframeTrack.toJSON(rt[st]));return it}static CreateFromMorphTargetSequence(_e,et,rt,it){const st=et.length,ot=[];for(let at=0;at<st;at++){let lt=[],ct=[];lt.push((at+st-1)%st,at,(at+1)%st),ct.push(0,1,0);const ut=getKeyframeOrder(lt);lt=sortedArray(lt,1,ut),ct=sortedArray(ct,1,ut),!it&&lt[0]===0&&(lt.push(st),ct.push(ct[0])),ot.push(new NumberKeyframeTrack(".morphTargetInfluences["+et[at].name+"]",lt,ct).scale(1/rt))}return new this(_e,-1,ot)}static findByName(_e,et){let rt=_e;if(!Array.isArray(_e)){const it=_e;rt=it.geometry&&it.geometry.animations||it.animations}for(let it=0;it<rt.length;it++)if(rt[it].name===et)return rt[it];return null}static CreateClipsFromMorphTargetSequences(_e,et,rt){const it={},st=/^([\w-]*?)([\d]+)$/;for(let at=0,lt=_e.length;at<lt;at++){const ct=_e[at],ut=ct.name.match(st);if(ut&&ut.length>1){const ht=ut[1];let dt=it[ht];dt||(it[ht]=dt=[]),dt.push(ct)}}const ot=[];for(const at in it)ot.push(this.CreateFromMorphTargetSequence(at,it[at],et,rt));return ot}static parseAnimation(_e,et){if(!_e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const rt=function(ht,dt,ft,pt,mt){if(ft.length!==0){const At=[],gt=[];flattenJSON(ft,At,gt,pt),At.length!==0&&mt.push(new ht(dt,At,gt))}},it=[],st=_e.name||"default",ot=_e.fps||30,at=_e.blendMode;let lt=_e.length||-1;const ct=_e.hierarchy||[];for(let ht=0;ht<ct.length;ht++){const dt=ct[ht].keys;if(!(!dt||dt.length===0))if(dt[0].morphTargets){const ft={};let pt;for(pt=0;pt<dt.length;pt++)if(dt[pt].morphTargets)for(let mt=0;mt<dt[pt].morphTargets.length;mt++)ft[dt[pt].morphTargets[mt]]=-1;for(const mt in ft){const At=[],gt=[];for(let bt=0;bt!==dt[pt].morphTargets.length;++bt){const Tt=dt[pt];At.push(Tt.time),gt.push(Tt.morphTarget===mt?1:0)}it.push(new NumberKeyframeTrack(".morphTargetInfluence["+mt+"]",At,gt))}lt=ft.length*ot}else{const ft=".bones["+et[ht].name+"]";rt(VectorKeyframeTrack,ft+".position",dt,"pos",it),rt(QuaternionKeyframeTrack,ft+".quaternion",dt,"rot",it),rt(VectorKeyframeTrack,ft+".scale",dt,"scl",it)}}return it.length===0?null:new this(st,lt,it,at)}resetDuration(){const _e=this.tracks;let et=0;for(let rt=0,it=_e.length;rt!==it;++rt){const st=this.tracks[rt];et=Math.max(et,st.times[st.times.length-1])}return this.duration=et,this}trim(){for(let _e=0;_e<this.tracks.length;_e++)this.tracks[_e].trim(0,this.duration);return this}validate(){let _e=!0;for(let et=0;et<this.tracks.length;et++)_e=_e&&this.tracks[et].validate();return _e}optimize(){for(let _e=0;_e<this.tracks.length;_e++)this.tracks[_e].optimize();return this}clone(){const _e=[];for(let et=0;et<this.tracks.length;et++)_e.push(this.tracks[et].clone());return new this.constructor(this.name,this.duration,_e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(nt){switch(nt.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+nt)}function parseKeyframeTrack(nt){if(nt.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _e=getTrackTypeForValueTypeName(nt.type);if(nt.times===void 0){const et=[],rt=[];flattenJSON(nt.keys,et,rt,"value"),nt.times=et,nt.values=rt}return _e.parse!==void 0?_e.parse(nt):new _e(nt.name,nt.times,nt.values,nt.interpolation)}const Cache={enabled:!1,files:{},add:function(nt,_e){this.enabled!==!1&&(this.files[nt]=_e)},get:function(nt){if(this.enabled!==!1)return this.files[nt]},remove:function(nt){delete this.files[nt]},clear:function(){this.files={}}};class LoadingManager{constructor(_e,et,rt){const it=this;let st=!1,ot=0,at=0,lt;const ct=[];this.onStart=void 0,this.onLoad=_e,this.onProgress=et,this.onError=rt,this.itemStart=function(ut){at++,st===!1&&it.onStart!==void 0&&it.onStart(ut,ot,at),st=!0},this.itemEnd=function(ut){ot++,it.onProgress!==void 0&&it.onProgress(ut,ot,at),ot===at&&(st=!1,it.onLoad!==void 0&&it.onLoad())},this.itemError=function(ut){it.onError!==void 0&&it.onError(ut)},this.resolveURL=function(ut){return lt?lt(ut):ut},this.setURLModifier=function(ut){return lt=ut,this},this.addHandler=function(ut,ht){return ct.push(ut,ht),this},this.removeHandler=function(ut){const ht=ct.indexOf(ut);return ht!==-1&&ct.splice(ht,2),this},this.getHandler=function(ut){for(let ht=0,dt=ct.length;ht<dt;ht+=2){const ft=ct[ht],pt=ct[ht+1];if(ft.global&&(ft.lastIndex=0),ft.test(ut))return pt}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_e){this.manager=_e!==void 0?_e:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_e,et){const rt=this;return new Promise(function(it,st){rt.load(_e,it,et,st)})}parse(){}setCrossOrigin(_e){return this.crossOrigin=_e,this}setWithCredentials(_e){return this.withCredentials=_e,this}setPath(_e){return this.path=_e,this}setResourcePath(_e){return this.resourcePath=_e,this}setRequestHeader(_e){return this.requestHeader=_e,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_e,et){super(_e),this.response=et}}class FileLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){_e===void 0&&(_e=""),this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=Cache.get(_e);if(st!==void 0)return this.manager.itemStart(_e),setTimeout(()=>{et&&et(st),this.manager.itemEnd(_e)},0),st;if(loading[_e]!==void 0){loading[_e].push({onLoad:et,onProgress:rt,onError:it});return}loading[_e]=[],loading[_e].push({onLoad:et,onProgress:rt,onError:it});const ot=new Request(_e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),at=this.mimeType,lt=this.responseType;fetch(ot).then(ct=>{if(ct.status===200||ct.status===0){if(ct.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||ct.body===void 0||ct.body.getReader===void 0)return ct;const ut=loading[_e],ht=ct.body.getReader(),dt=ct.headers.get("X-File-Size")||ct.headers.get("Content-Length"),ft=dt?parseInt(dt):0,pt=ft!==0;let mt=0;const At=new ReadableStream({start(gt){bt();function bt(){ht.read().then(({done:Tt,value:wt})=>{if(Tt)gt.close();else{mt+=wt.byteLength;const Rt=new ProgressEvent("progress",{lengthComputable:pt,loaded:mt,total:ft});for(let It=0,Lt=ut.length;It<Lt;It++){const $t=ut[It];$t.onProgress&&$t.onProgress(Rt)}gt.enqueue(wt),bt()}},Tt=>{gt.error(Tt)})}}});return new Response(At)}else throw new HttpError(`fetch for "${ct.url}" responded with ${ct.status}: ${ct.statusText}`,ct)}).then(ct=>{switch(lt){case"arraybuffer":return ct.arrayBuffer();case"blob":return ct.blob();case"document":return ct.text().then(ut=>new DOMParser().parseFromString(ut,at));case"json":return ct.json();default:if(at===void 0)return ct.text();{const ht=/charset="?([^;"\s]*)"?/i.exec(at),dt=ht&&ht[1]?ht[1].toLowerCase():void 0,ft=new TextDecoder(dt);return ct.arrayBuffer().then(pt=>ft.decode(pt))}}}).then(ct=>{Cache.add(_e,ct);const ut=loading[_e];delete loading[_e];for(let ht=0,dt=ut.length;ht<dt;ht++){const ft=ut[ht];ft.onLoad&&ft.onLoad(ct)}}).catch(ct=>{const ut=loading[_e];if(ut===void 0)throw this.manager.itemError(_e),ct;delete loading[_e];for(let ht=0,dt=ut.length;ht<dt;ht++){const ft=ut[ht];ft.onError&&ft.onError(ct)}this.manager.itemError(_e)}).finally(()=>{this.manager.itemEnd(_e)}),this.manager.itemStart(_e)}setResponseType(_e){return this.responseType=_e,this}setMimeType(_e){return this.mimeType=_e,this}}class AnimationLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=this,ot=new FileLoader(this.manager);ot.setPath(this.path),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(_e,function(at){try{et(st.parse(JSON.parse(at)))}catch(lt){it?it(lt):console.error(lt),st.manager.itemError(_e)}},rt,it)}parse(_e){const et=[];for(let rt=0;rt<_e.length;rt++){const it=AnimationClip.parse(_e[rt]);et.push(it)}return et}}class CompressedTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=this,ot=[],at=new CompressedTexture,lt=new FileLoader(this.manager);lt.setPath(this.path),lt.setResponseType("arraybuffer"),lt.setRequestHeader(this.requestHeader),lt.setWithCredentials(st.withCredentials);let ct=0;function ut(ht){lt.load(_e[ht],function(dt){const ft=st.parse(dt,!0);ot[ht]={width:ft.width,height:ft.height,format:ft.format,mipmaps:ft.mipmaps},ct+=1,ct===6&&(ft.mipmapCount===1&&(at.minFilter=LinearFilter$1),at.image=ot,at.format=ft.format,at.needsUpdate=!0,et&&et(at))},rt,it)}if(Array.isArray(_e))for(let ht=0,dt=_e.length;ht<dt;++ht)ut(ht);else lt.load(_e,function(ht){const dt=st.parse(ht,!0);if(dt.isCubemap){const ft=dt.mipmaps.length/dt.mipmapCount;for(let pt=0;pt<ft;pt++){ot[pt]={mipmaps:[]};for(let mt=0;mt<dt.mipmapCount;mt++)ot[pt].mipmaps.push(dt.mipmaps[pt*dt.mipmapCount+mt]),ot[pt].format=dt.format,ot[pt].width=dt.width,ot[pt].height=dt.height}at.image=ot}else at.image.width=dt.width,at.image.height=dt.height,at.mipmaps=dt.mipmaps;dt.mipmapCount===1&&(at.minFilter=LinearFilter$1),at.format=dt.format,at.needsUpdate=!0,et&&et(at)},rt,it);return at}}class ImageLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=this,ot=Cache.get(_e);if(ot!==void 0)return st.manager.itemStart(_e),setTimeout(function(){et&&et(ot),st.manager.itemEnd(_e)},0),ot;const at=createElementNS$1("img");function lt(){ut(),Cache.add(_e,this),et&&et(this),st.manager.itemEnd(_e)}function ct(ht){ut(),it&&it(ht),st.manager.itemError(_e),st.manager.itemEnd(_e)}function ut(){at.removeEventListener("load",lt,!1),at.removeEventListener("error",ct,!1)}return at.addEventListener("load",lt,!1),at.addEventListener("error",ct,!1),_e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(at.crossOrigin=this.crossOrigin),st.manager.itemStart(_e),at.src=_e,at}}class CubeTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=new CubeTexture$1;st.colorSpace=SRGBColorSpace$2;const ot=new ImageLoader(this.manager);ot.setCrossOrigin(this.crossOrigin),ot.setPath(this.path);let at=0;function lt(ct){ot.load(_e[ct],function(ut){st.images[ct]=ut,at++,at===6&&(st.needsUpdate=!0,et&&et(st))},void 0,it)}for(let ct=0;ct<_e.length;++ct)lt(ct);return st}}class DataTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=this,ot=new DataTexture$1,at=new FileLoader(this.manager);return at.setResponseType("arraybuffer"),at.setRequestHeader(this.requestHeader),at.setPath(this.path),at.setWithCredentials(st.withCredentials),at.load(_e,function(lt){let ct;try{ct=st.parse(lt)}catch(ut){if(it!==void 0)it(ut);else{console.error(ut);return}}ct.image!==void 0?ot.image=ct.image:ct.data!==void 0&&(ot.image.width=ct.width,ot.image.height=ct.height,ot.image.data=ct.data),ot.wrapS=ct.wrapS!==void 0?ct.wrapS:ClampToEdgeWrapping$1,ot.wrapT=ct.wrapT!==void 0?ct.wrapT:ClampToEdgeWrapping$1,ot.magFilter=ct.magFilter!==void 0?ct.magFilter:LinearFilter$1,ot.minFilter=ct.minFilter!==void 0?ct.minFilter:LinearFilter$1,ot.anisotropy=ct.anisotropy!==void 0?ct.anisotropy:1,ct.colorSpace!==void 0&&(ot.colorSpace=ct.colorSpace),ct.flipY!==void 0&&(ot.flipY=ct.flipY),ct.format!==void 0&&(ot.format=ct.format),ct.type!==void 0&&(ot.type=ct.type),ct.mipmaps!==void 0&&(ot.mipmaps=ct.mipmaps,ot.minFilter=LinearMipmapLinearFilter$1),ct.mipmapCount===1&&(ot.minFilter=LinearFilter$1),ct.generateMipmaps!==void 0&&(ot.generateMipmaps=ct.generateMipmaps),ot.needsUpdate=!0,et&&et(ot,ct)},rt,it),ot}}class TextureLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=new Texture$1,ot=new ImageLoader(this.manager);return ot.setCrossOrigin(this.crossOrigin),ot.setPath(this.path),ot.load(_e,function(at){st.image=at,st.needsUpdate=!0,et!==void 0&&et(st)},rt,it),st}}let Light$1=class extends Object3D$1{constructor(_e,et=1){super(),this.isLight=!0,this.type="Light",this.color=new Color$2(_e),this.intensity=et}dispose(){}copy(_e,et){return super.copy(_e,et),this.color.copy(_e.color),this.intensity=_e.intensity,this}toJSON(_e){const et=super.toJSON(_e);return et.object.color=this.color.getHex(),et.object.intensity=this.intensity,this.groundColor!==void 0&&(et.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(et.object.distance=this.distance),this.angle!==void 0&&(et.object.angle=this.angle),this.decay!==void 0&&(et.object.decay=this.decay),this.penumbra!==void 0&&(et.object.penumbra=this.penumbra),this.shadow!==void 0&&(et.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(et.object.target=this.target.uuid),et}},HemisphereLight$1=class extends Light$1{constructor(_e,et,rt){super(_e,rt),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D$1.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color$2(et)}copy(_e,et){return super.copy(_e,et),this.groundColor.copy(_e.groundColor),this}};const _projScreenMatrix$1$1=new Matrix4$1,_lightPositionWorld$1$1=new Vector3$1,_lookTarget$1$1=new Vector3$1;let LightShadow$1=class{constructor(_e){this.camera=_e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2$1(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4$1,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum$1,this._frameExtents=new Vector2$1(1,1),this._viewportCount=1,this._viewports=[new Vector4$1(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_e){const et=this.camera,rt=this.matrix;_lightPositionWorld$1$1.setFromMatrixPosition(_e.matrixWorld),et.position.copy(_lightPositionWorld$1$1),_lookTarget$1$1.setFromMatrixPosition(_e.target.matrixWorld),et.lookAt(_lookTarget$1$1),et.updateMatrixWorld(),_projScreenMatrix$1$1.multiplyMatrices(et.projectionMatrix,et.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1$1),rt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),rt.multiply(_projScreenMatrix$1$1)}getViewport(_e){return this._viewports[_e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_e){return this.camera=_e.camera.clone(),this.intensity=_e.intensity,this.bias=_e.bias,this.radius=_e.radius,this.mapSize.copy(_e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _e={};return this.intensity!==1&&(_e.intensity=this.intensity),this.bias!==0&&(_e.bias=this.bias),this.normalBias!==0&&(_e.normalBias=this.normalBias),this.radius!==1&&(_e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_e.mapSize=this.mapSize.toArray()),_e.camera=this.camera.toJSON(!1).object,delete _e.camera.matrix,_e}},SpotLightShadow$1=class extends LightShadow$1{constructor(){super(new PerspectiveCamera$2(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_e){const et=this.camera,rt=RAD2DEG$1*2*_e.angle*this.focus,it=this.mapSize.width/this.mapSize.height,st=_e.distance||et.far;(rt!==et.fov||it!==et.aspect||st!==et.far)&&(et.fov=rt,et.aspect=it,et.far=st,et.updateProjectionMatrix()),super.updateMatrices(_e)}copy(_e){return super.copy(_e),this.focus=_e.focus,this}},SpotLight$1=class extends Light$1{constructor(_e,et,rt=0,it=Math.PI/3,st=0,ot=2){super(_e,et),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D$1.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D$1,this.distance=rt,this.angle=it,this.penumbra=st,this.decay=ot,this.map=null,this.shadow=new SpotLightShadow$1}get power(){return this.intensity*Math.PI}set power(_e){this.intensity=_e/Math.PI}dispose(){this.shadow.dispose()}copy(_e,et){return super.copy(_e,et),this.distance=_e.distance,this.angle=_e.angle,this.penumbra=_e.penumbra,this.decay=_e.decay,this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}};const _projScreenMatrix$3=new Matrix4$1,_lightPositionWorld$2=new Vector3$1,_lookTarget$2=new Vector3$1;let PointLightShadow$1=class extends LightShadow$1{constructor(){super(new PerspectiveCamera$2(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2$1(4,2),this._viewportCount=6,this._viewports=[new Vector4$1(2,1,1,1),new Vector4$1(0,1,1,1),new Vector4$1(3,1,1,1),new Vector4$1(1,1,1,1),new Vector4$1(3,0,1,1),new Vector4$1(1,0,1,1)],this._cubeDirections=[new Vector3$1(1,0,0),new Vector3$1(-1,0,0),new Vector3$1(0,0,1),new Vector3$1(0,0,-1),new Vector3$1(0,1,0),new Vector3$1(0,-1,0)],this._cubeUps=[new Vector3$1(0,1,0),new Vector3$1(0,1,0),new Vector3$1(0,1,0),new Vector3$1(0,1,0),new Vector3$1(0,0,1),new Vector3$1(0,0,-1)]}updateMatrices(_e,et=0){const rt=this.camera,it=this.matrix,st=_e.distance||rt.far;st!==rt.far&&(rt.far=st,rt.updateProjectionMatrix()),_lightPositionWorld$2.setFromMatrixPosition(_e.matrixWorld),rt.position.copy(_lightPositionWorld$2),_lookTarget$2.copy(rt.position),_lookTarget$2.add(this._cubeDirections[et]),rt.up.copy(this._cubeUps[et]),rt.lookAt(_lookTarget$2),rt.updateMatrixWorld(),it.makeTranslation(-_lightPositionWorld$2.x,-_lightPositionWorld$2.y,-_lightPositionWorld$2.z),_projScreenMatrix$3.multiplyMatrices(rt.projectionMatrix,rt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$3)}},PointLight$1=class extends Light$1{constructor(_e,et,rt=0,it=2){super(_e,et),this.isPointLight=!0,this.type="PointLight",this.distance=rt,this.decay=it,this.shadow=new PointLightShadow$1}get power(){return this.intensity*4*Math.PI}set power(_e){this.intensity=_e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_e,et){return super.copy(_e,et),this.distance=_e.distance,this.decay=_e.decay,this.shadow=_e.shadow.clone(),this}},DirectionalLightShadow$1=class extends LightShadow$1{constructor(){super(new OrthographicCamera$1(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},DirectionalLight$1=class extends Light$1{constructor(_e,et){super(_e,et),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D$1.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D$1,this.shadow=new DirectionalLightShadow$1}dispose(){this.shadow.dispose()}copy(_e){return super.copy(_e),this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}},AmbientLight$1=class extends Light$1{constructor(_e,et){super(_e,et),this.isAmbientLight=!0,this.type="AmbientLight"}},RectAreaLight$1=class extends Light$1{constructor(_e,et,rt=10,it=10){super(_e,et),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=rt,this.height=it}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_e){this.intensity=_e/(this.width*this.height*Math.PI)}copy(_e){return super.copy(_e),this.width=_e.width,this.height=_e.height,this}toJSON(_e){const et=super.toJSON(_e);return et.object.width=this.width,et.object.height=this.height,et}},SphericalHarmonics3$1=class{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _e=0;_e<9;_e++)this.coefficients.push(new Vector3$1)}set(_e){for(let et=0;et<9;et++)this.coefficients[et].copy(_e[et]);return this}zero(){for(let _e=0;_e<9;_e++)this.coefficients[_e].set(0,0,0);return this}getAt(_e,et){const rt=_e.x,it=_e.y,st=_e.z,ot=this.coefficients;return et.copy(ot[0]).multiplyScalar(.282095),et.addScaledVector(ot[1],.488603*it),et.addScaledVector(ot[2],.488603*st),et.addScaledVector(ot[3],.488603*rt),et.addScaledVector(ot[4],1.092548*(rt*it)),et.addScaledVector(ot[5],1.092548*(it*st)),et.addScaledVector(ot[6],.315392*(3*st*st-1)),et.addScaledVector(ot[7],1.092548*(rt*st)),et.addScaledVector(ot[8],.546274*(rt*rt-it*it)),et}getIrradianceAt(_e,et){const rt=_e.x,it=_e.y,st=_e.z,ot=this.coefficients;return et.copy(ot[0]).multiplyScalar(.886227),et.addScaledVector(ot[1],2*.511664*it),et.addScaledVector(ot[2],2*.511664*st),et.addScaledVector(ot[3],2*.511664*rt),et.addScaledVector(ot[4],2*.429043*rt*it),et.addScaledVector(ot[5],2*.429043*it*st),et.addScaledVector(ot[6],.743125*st*st-.247708),et.addScaledVector(ot[7],2*.429043*rt*st),et.addScaledVector(ot[8],.429043*(rt*rt-it*it)),et}add(_e){for(let et=0;et<9;et++)this.coefficients[et].add(_e.coefficients[et]);return this}addScaledSH(_e,et){for(let rt=0;rt<9;rt++)this.coefficients[rt].addScaledVector(_e.coefficients[rt],et);return this}scale(_e){for(let et=0;et<9;et++)this.coefficients[et].multiplyScalar(_e);return this}lerp(_e,et){for(let rt=0;rt<9;rt++)this.coefficients[rt].lerp(_e.coefficients[rt],et);return this}equals(_e){for(let et=0;et<9;et++)if(!this.coefficients[et].equals(_e.coefficients[et]))return!1;return!0}copy(_e){return this.set(_e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_e,et=0){const rt=this.coefficients;for(let it=0;it<9;it++)rt[it].fromArray(_e,et+it*3);return this}toArray(_e=[],et=0){const rt=this.coefficients;for(let it=0;it<9;it++)rt[it].toArray(_e,et+it*3);return _e}static getBasisAt(_e,et){const rt=_e.x,it=_e.y,st=_e.z;et[0]=.282095,et[1]=.488603*it,et[2]=.488603*st,et[3]=.488603*rt,et[4]=1.092548*rt*it,et[5]=1.092548*it*st,et[6]=.315392*(3*st*st-1),et[7]=1.092548*rt*st,et[8]=.546274*(rt*rt-it*it)}},LightProbe$1=class extends Light$1{constructor(_e=new SphericalHarmonics3$1,et=1){super(void 0,et),this.isLightProbe=!0,this.sh=_e}copy(_e){return super.copy(_e),this.sh.copy(_e.sh),this}fromJSON(_e){return this.intensity=_e.intensity,this.sh.fromArray(_e.sh),this}toJSON(_e){const et=super.toJSON(_e);return et.object.sh=this.sh.toArray(),et}};class MaterialLoader extends Loader{constructor(_e){super(_e),this.textures={}}load(_e,et,rt,it){const st=this,ot=new FileLoader(st.manager);ot.setPath(st.path),ot.setRequestHeader(st.requestHeader),ot.setWithCredentials(st.withCredentials),ot.load(_e,function(at){try{et(st.parse(JSON.parse(at)))}catch(lt){it?it(lt):console.error(lt),st.manager.itemError(_e)}},rt,it)}parse(_e){const et=this.textures;function rt(st){return et[st]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",st),et[st]}const it=this.createMaterialFromType(_e.type);if(_e.uuid!==void 0&&(it.uuid=_e.uuid),_e.name!==void 0&&(it.name=_e.name),_e.color!==void 0&&it.color!==void 0&&it.color.setHex(_e.color),_e.roughness!==void 0&&(it.roughness=_e.roughness),_e.metalness!==void 0&&(it.metalness=_e.metalness),_e.sheen!==void 0&&(it.sheen=_e.sheen),_e.sheenColor!==void 0&&(it.sheenColor=new Color$2().setHex(_e.sheenColor)),_e.sheenRoughness!==void 0&&(it.sheenRoughness=_e.sheenRoughness),_e.emissive!==void 0&&it.emissive!==void 0&&it.emissive.setHex(_e.emissive),_e.specular!==void 0&&it.specular!==void 0&&it.specular.setHex(_e.specular),_e.specularIntensity!==void 0&&(it.specularIntensity=_e.specularIntensity),_e.specularColor!==void 0&&it.specularColor!==void 0&&it.specularColor.setHex(_e.specularColor),_e.shininess!==void 0&&(it.shininess=_e.shininess),_e.clearcoat!==void 0&&(it.clearcoat=_e.clearcoat),_e.clearcoatRoughness!==void 0&&(it.clearcoatRoughness=_e.clearcoatRoughness),_e.dispersion!==void 0&&(it.dispersion=_e.dispersion),_e.iridescence!==void 0&&(it.iridescence=_e.iridescence),_e.iridescenceIOR!==void 0&&(it.iridescenceIOR=_e.iridescenceIOR),_e.iridescenceThicknessRange!==void 0&&(it.iridescenceThicknessRange=_e.iridescenceThicknessRange),_e.transmission!==void 0&&(it.transmission=_e.transmission),_e.thickness!==void 0&&(it.thickness=_e.thickness),_e.attenuationDistance!==void 0&&(it.attenuationDistance=_e.attenuationDistance),_e.attenuationColor!==void 0&&it.attenuationColor!==void 0&&it.attenuationColor.setHex(_e.attenuationColor),_e.anisotropy!==void 0&&(it.anisotropy=_e.anisotropy),_e.anisotropyRotation!==void 0&&(it.anisotropyRotation=_e.anisotropyRotation),_e.fog!==void 0&&(it.fog=_e.fog),_e.flatShading!==void 0&&(it.flatShading=_e.flatShading),_e.blending!==void 0&&(it.blending=_e.blending),_e.combine!==void 0&&(it.combine=_e.combine),_e.side!==void 0&&(it.side=_e.side),_e.shadowSide!==void 0&&(it.shadowSide=_e.shadowSide),_e.opacity!==void 0&&(it.opacity=_e.opacity),_e.transparent!==void 0&&(it.transparent=_e.transparent),_e.alphaTest!==void 0&&(it.alphaTest=_e.alphaTest),_e.alphaHash!==void 0&&(it.alphaHash=_e.alphaHash),_e.depthFunc!==void 0&&(it.depthFunc=_e.depthFunc),_e.depthTest!==void 0&&(it.depthTest=_e.depthTest),_e.depthWrite!==void 0&&(it.depthWrite=_e.depthWrite),_e.colorWrite!==void 0&&(it.colorWrite=_e.colorWrite),_e.blendSrc!==void 0&&(it.blendSrc=_e.blendSrc),_e.blendDst!==void 0&&(it.blendDst=_e.blendDst),_e.blendEquation!==void 0&&(it.blendEquation=_e.blendEquation),_e.blendSrcAlpha!==void 0&&(it.blendSrcAlpha=_e.blendSrcAlpha),_e.blendDstAlpha!==void 0&&(it.blendDstAlpha=_e.blendDstAlpha),_e.blendEquationAlpha!==void 0&&(it.blendEquationAlpha=_e.blendEquationAlpha),_e.blendColor!==void 0&&it.blendColor!==void 0&&it.blendColor.setHex(_e.blendColor),_e.blendAlpha!==void 0&&(it.blendAlpha=_e.blendAlpha),_e.stencilWriteMask!==void 0&&(it.stencilWriteMask=_e.stencilWriteMask),_e.stencilFunc!==void 0&&(it.stencilFunc=_e.stencilFunc),_e.stencilRef!==void 0&&(it.stencilRef=_e.stencilRef),_e.stencilFuncMask!==void 0&&(it.stencilFuncMask=_e.stencilFuncMask),_e.stencilFail!==void 0&&(it.stencilFail=_e.stencilFail),_e.stencilZFail!==void 0&&(it.stencilZFail=_e.stencilZFail),_e.stencilZPass!==void 0&&(it.stencilZPass=_e.stencilZPass),_e.stencilWrite!==void 0&&(it.stencilWrite=_e.stencilWrite),_e.wireframe!==void 0&&(it.wireframe=_e.wireframe),_e.wireframeLinewidth!==void 0&&(it.wireframeLinewidth=_e.wireframeLinewidth),_e.wireframeLinecap!==void 0&&(it.wireframeLinecap=_e.wireframeLinecap),_e.wireframeLinejoin!==void 0&&(it.wireframeLinejoin=_e.wireframeLinejoin),_e.rotation!==void 0&&(it.rotation=_e.rotation),_e.linewidth!==void 0&&(it.linewidth=_e.linewidth),_e.dashSize!==void 0&&(it.dashSize=_e.dashSize),_e.gapSize!==void 0&&(it.gapSize=_e.gapSize),_e.scale!==void 0&&(it.scale=_e.scale),_e.polygonOffset!==void 0&&(it.polygonOffset=_e.polygonOffset),_e.polygonOffsetFactor!==void 0&&(it.polygonOffsetFactor=_e.polygonOffsetFactor),_e.polygonOffsetUnits!==void 0&&(it.polygonOffsetUnits=_e.polygonOffsetUnits),_e.dithering!==void 0&&(it.dithering=_e.dithering),_e.alphaToCoverage!==void 0&&(it.alphaToCoverage=_e.alphaToCoverage),_e.premultipliedAlpha!==void 0&&(it.premultipliedAlpha=_e.premultipliedAlpha),_e.forceSinglePass!==void 0&&(it.forceSinglePass=_e.forceSinglePass),_e.visible!==void 0&&(it.visible=_e.visible),_e.toneMapped!==void 0&&(it.toneMapped=_e.toneMapped),_e.userData!==void 0&&(it.userData=_e.userData),_e.vertexColors!==void 0&&(typeof _e.vertexColors=="number"?it.vertexColors=_e.vertexColors>0:it.vertexColors=_e.vertexColors),_e.uniforms!==void 0)for(const st in _e.uniforms){const ot=_e.uniforms[st];switch(it.uniforms[st]={},ot.type){case"t":it.uniforms[st].value=rt(ot.value);break;case"c":it.uniforms[st].value=new Color$2().setHex(ot.value);break;case"v2":it.uniforms[st].value=new Vector2$1().fromArray(ot.value);break;case"v3":it.uniforms[st].value=new Vector3$1().fromArray(ot.value);break;case"v4":it.uniforms[st].value=new Vector4$1().fromArray(ot.value);break;case"m3":it.uniforms[st].value=new Matrix3$1().fromArray(ot.value);break;case"m4":it.uniforms[st].value=new Matrix4$1().fromArray(ot.value);break;default:it.uniforms[st].value=ot.value}}if(_e.defines!==void 0&&(it.defines=_e.defines),_e.vertexShader!==void 0&&(it.vertexShader=_e.vertexShader),_e.fragmentShader!==void 0&&(it.fragmentShader=_e.fragmentShader),_e.glslVersion!==void 0&&(it.glslVersion=_e.glslVersion),_e.extensions!==void 0)for(const st in _e.extensions)it.extensions[st]=_e.extensions[st];if(_e.lights!==void 0&&(it.lights=_e.lights),_e.clipping!==void 0&&(it.clipping=_e.clipping),_e.size!==void 0&&(it.size=_e.size),_e.sizeAttenuation!==void 0&&(it.sizeAttenuation=_e.sizeAttenuation),_e.map!==void 0&&(it.map=rt(_e.map)),_e.matcap!==void 0&&(it.matcap=rt(_e.matcap)),_e.alphaMap!==void 0&&(it.alphaMap=rt(_e.alphaMap)),_e.bumpMap!==void 0&&(it.bumpMap=rt(_e.bumpMap)),_e.bumpScale!==void 0&&(it.bumpScale=_e.bumpScale),_e.normalMap!==void 0&&(it.normalMap=rt(_e.normalMap)),_e.normalMapType!==void 0&&(it.normalMapType=_e.normalMapType),_e.normalScale!==void 0){let st=_e.normalScale;Array.isArray(st)===!1&&(st=[st,st]),it.normalScale=new Vector2$1().fromArray(st)}return _e.displacementMap!==void 0&&(it.displacementMap=rt(_e.displacementMap)),_e.displacementScale!==void 0&&(it.displacementScale=_e.displacementScale),_e.displacementBias!==void 0&&(it.displacementBias=_e.displacementBias),_e.roughnessMap!==void 0&&(it.roughnessMap=rt(_e.roughnessMap)),_e.metalnessMap!==void 0&&(it.metalnessMap=rt(_e.metalnessMap)),_e.emissiveMap!==void 0&&(it.emissiveMap=rt(_e.emissiveMap)),_e.emissiveIntensity!==void 0&&(it.emissiveIntensity=_e.emissiveIntensity),_e.specularMap!==void 0&&(it.specularMap=rt(_e.specularMap)),_e.specularIntensityMap!==void 0&&(it.specularIntensityMap=rt(_e.specularIntensityMap)),_e.specularColorMap!==void 0&&(it.specularColorMap=rt(_e.specularColorMap)),_e.envMap!==void 0&&(it.envMap=rt(_e.envMap)),_e.envMapRotation!==void 0&&it.envMapRotation.fromArray(_e.envMapRotation),_e.envMapIntensity!==void 0&&(it.envMapIntensity=_e.envMapIntensity),_e.reflectivity!==void 0&&(it.reflectivity=_e.reflectivity),_e.refractionRatio!==void 0&&(it.refractionRatio=_e.refractionRatio),_e.lightMap!==void 0&&(it.lightMap=rt(_e.lightMap)),_e.lightMapIntensity!==void 0&&(it.lightMapIntensity=_e.lightMapIntensity),_e.aoMap!==void 0&&(it.aoMap=rt(_e.aoMap)),_e.aoMapIntensity!==void 0&&(it.aoMapIntensity=_e.aoMapIntensity),_e.gradientMap!==void 0&&(it.gradientMap=rt(_e.gradientMap)),_e.clearcoatMap!==void 0&&(it.clearcoatMap=rt(_e.clearcoatMap)),_e.clearcoatRoughnessMap!==void 0&&(it.clearcoatRoughnessMap=rt(_e.clearcoatRoughnessMap)),_e.clearcoatNormalMap!==void 0&&(it.clearcoatNormalMap=rt(_e.clearcoatNormalMap)),_e.clearcoatNormalScale!==void 0&&(it.clearcoatNormalScale=new Vector2$1().fromArray(_e.clearcoatNormalScale)),_e.iridescenceMap!==void 0&&(it.iridescenceMap=rt(_e.iridescenceMap)),_e.iridescenceThicknessMap!==void 0&&(it.iridescenceThicknessMap=rt(_e.iridescenceThicknessMap)),_e.transmissionMap!==void 0&&(it.transmissionMap=rt(_e.transmissionMap)),_e.thicknessMap!==void 0&&(it.thicknessMap=rt(_e.thicknessMap)),_e.anisotropyMap!==void 0&&(it.anisotropyMap=rt(_e.anisotropyMap)),_e.sheenColorMap!==void 0&&(it.sheenColorMap=rt(_e.sheenColorMap)),_e.sheenRoughnessMap!==void 0&&(it.sheenRoughnessMap=rt(_e.sheenRoughnessMap)),it}setTextures(_e){return this.textures=_e,this}createMaterialFromType(_e){return MaterialLoader.createMaterialFromType(_e)}static createMaterialFromType(_e){const et={ShadowMaterial:ShadowMaterial$1,SpriteMaterial:SpriteMaterial$1,RawShaderMaterial,ShaderMaterial:ShaderMaterial$1,PointsMaterial:PointsMaterial$1,MeshPhysicalMaterial:MeshPhysicalMaterial$1,MeshStandardMaterial:MeshStandardMaterial$1,MeshPhongMaterial:MeshPhongMaterial$1,MeshToonMaterial:MeshToonMaterial$1,MeshNormalMaterial:MeshNormalMaterial$1,MeshLambertMaterial:MeshLambertMaterial$1,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial:MeshBasicMaterial$1,MeshMatcapMaterial:MeshMatcapMaterial$1,LineDashedMaterial:LineDashedMaterial$1,LineBasicMaterial:LineBasicMaterial$1,Material:Material$1};return new et[_e]}}class LoaderUtils{static decodeText(_e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(_e);let et="";for(let rt=0,it=_e.length;rt<it;rt++)et+=String.fromCharCode(_e[rt]);try{return decodeURIComponent(escape(et))}catch{return et}}static extractUrlBase(_e){const et=_e.lastIndexOf("/");return et===-1?"./":_e.slice(0,et+1)}static resolveURL(_e,et){return typeof _e!="string"||_e===""?"":(/^https?:\/\//i.test(et)&&/^\//.test(_e)&&(et=et.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_e)||/^data:.*,.*$/i.test(_e)||/^blob:.*$/i.test(_e)?_e:et+_e)}}class InstancedBufferGeometry extends BufferGeometry$1{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_e){return super.copy(_e),this.instanceCount=_e.instanceCount,this}toJSON(){const _e=super.toJSON();return _e.instanceCount=this.instanceCount,_e.isInstancedBufferGeometry=!0,_e}}class BufferGeometryLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=this,ot=new FileLoader(st.manager);ot.setPath(st.path),ot.setRequestHeader(st.requestHeader),ot.setWithCredentials(st.withCredentials),ot.load(_e,function(at){try{et(st.parse(JSON.parse(at)))}catch(lt){it?it(lt):console.error(lt),st.manager.itemError(_e)}},rt,it)}parse(_e){const et={},rt={};function it(ft,pt){if(et[pt]!==void 0)return et[pt];const At=ft.interleavedBuffers[pt],gt=st(ft,At.buffer),bt=getTypedArray(At.type,gt),Tt=new InterleavedBuffer$1(bt,At.stride);return Tt.uuid=At.uuid,et[pt]=Tt,Tt}function st(ft,pt){if(rt[pt]!==void 0)return rt[pt];const At=ft.arrayBuffers[pt],gt=new Uint32Array(At).buffer;return rt[pt]=gt,gt}const ot=_e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry$1,at=_e.data.index;if(at!==void 0){const ft=getTypedArray(at.type,at.array);ot.setIndex(new BufferAttribute$1(ft,1))}const lt=_e.data.attributes;for(const ft in lt){const pt=lt[ft];let mt;if(pt.isInterleavedBufferAttribute){const At=it(_e.data,pt.data);mt=new InterleavedBufferAttribute$1(At,pt.itemSize,pt.offset,pt.normalized)}else{const At=getTypedArray(pt.type,pt.array),gt=pt.isInstancedBufferAttribute?InstancedBufferAttribute$1:BufferAttribute$1;mt=new gt(At,pt.itemSize,pt.normalized)}pt.name!==void 0&&(mt.name=pt.name),pt.usage!==void 0&&mt.setUsage(pt.usage),ot.setAttribute(ft,mt)}const ct=_e.data.morphAttributes;if(ct)for(const ft in ct){const pt=ct[ft],mt=[];for(let At=0,gt=pt.length;At<gt;At++){const bt=pt[At];let Tt;if(bt.isInterleavedBufferAttribute){const wt=it(_e.data,bt.data);Tt=new InterleavedBufferAttribute$1(wt,bt.itemSize,bt.offset,bt.normalized)}else{const wt=getTypedArray(bt.type,bt.array);Tt=new BufferAttribute$1(wt,bt.itemSize,bt.normalized)}bt.name!==void 0&&(Tt.name=bt.name),mt.push(Tt)}ot.morphAttributes[ft]=mt}_e.data.morphTargetsRelative&&(ot.morphTargetsRelative=!0);const ht=_e.data.groups||_e.data.drawcalls||_e.data.offsets;if(ht!==void 0)for(let ft=0,pt=ht.length;ft!==pt;++ft){const mt=ht[ft];ot.addGroup(mt.start,mt.count,mt.materialIndex)}const dt=_e.data.boundingSphere;if(dt!==void 0){const ft=new Vector3$1;dt.center!==void 0&&ft.fromArray(dt.center),ot.boundingSphere=new Sphere$1(ft,dt.radius)}return _e.name&&(ot.name=_e.name),_e.userData&&(ot.userData=_e.userData),ot}}class ObjectLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=this,ot=this.path===""?LoaderUtils.extractUrlBase(_e):this.path;this.resourcePath=this.resourcePath||ot;const at=new FileLoader(this.manager);at.setPath(this.path),at.setRequestHeader(this.requestHeader),at.setWithCredentials(this.withCredentials),at.load(_e,function(lt){let ct=null;try{ct=JSON.parse(lt)}catch(ht){it!==void 0&&it(ht),console.error("THREE:ObjectLoader: Can't parse "+_e+".",ht.message);return}const ut=ct.metadata;if(ut===void 0||ut.type===void 0||ut.type.toLowerCase()==="geometry"){it!==void 0&&it(new Error("THREE.ObjectLoader: Can't load "+_e)),console.error("THREE.ObjectLoader: Can't load "+_e);return}st.parse(ct,et)},rt,it)}async loadAsync(_e,et){const rt=this,it=this.path===""?LoaderUtils.extractUrlBase(_e):this.path;this.resourcePath=this.resourcePath||it;const st=new FileLoader(this.manager);st.setPath(this.path),st.setRequestHeader(this.requestHeader),st.setWithCredentials(this.withCredentials);const ot=await st.loadAsync(_e,et),at=JSON.parse(ot),lt=at.metadata;if(lt===void 0||lt.type===void 0||lt.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_e);return await rt.parseAsync(at)}parse(_e,et){const rt=this.parseAnimations(_e.animations),it=this.parseShapes(_e.shapes),st=this.parseGeometries(_e.geometries,it),ot=this.parseImages(_e.images,function(){et!==void 0&&et(ct)}),at=this.parseTextures(_e.textures,ot),lt=this.parseMaterials(_e.materials,at),ct=this.parseObject(_e.object,st,lt,at,rt),ut=this.parseSkeletons(_e.skeletons,ct);if(this.bindSkeletons(ct,ut),this.bindLightTargets(ct),et!==void 0){let ht=!1;for(const dt in ot)if(ot[dt].data instanceof HTMLImageElement){ht=!0;break}ht===!1&&et(ct)}return ct}async parseAsync(_e){const et=this.parseAnimations(_e.animations),rt=this.parseShapes(_e.shapes),it=this.parseGeometries(_e.geometries,rt),st=await this.parseImagesAsync(_e.images),ot=this.parseTextures(_e.textures,st),at=this.parseMaterials(_e.materials,ot),lt=this.parseObject(_e.object,it,at,ot,et),ct=this.parseSkeletons(_e.skeletons,lt);return this.bindSkeletons(lt,ct),this.bindLightTargets(lt),lt}parseShapes(_e){const et={};if(_e!==void 0)for(let rt=0,it=_e.length;rt<it;rt++){const st=new Shape().fromJSON(_e[rt]);et[st.uuid]=st}return et}parseSkeletons(_e,et){const rt={},it={};if(et.traverse(function(st){st.isBone&&(it[st.uuid]=st)}),_e!==void 0)for(let st=0,ot=_e.length;st<ot;st++){const at=new Skeleton().fromJSON(_e[st],it);rt[at.uuid]=at}return rt}parseGeometries(_e,et){const rt={};if(_e!==void 0){const it=new BufferGeometryLoader;for(let st=0,ot=_e.length;st<ot;st++){let at;const lt=_e[st];switch(lt.type){case"BufferGeometry":case"InstancedBufferGeometry":at=it.parse(lt);break;default:lt.type in Geometries$1?at=Geometries$1[lt.type].fromJSON(lt,et):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${lt.type}"`)}at.uuid=lt.uuid,lt.name!==void 0&&(at.name=lt.name),lt.userData!==void 0&&(at.userData=lt.userData),rt[lt.uuid]=at}}return rt}parseMaterials(_e,et){const rt={},it={};if(_e!==void 0){const st=new MaterialLoader;st.setTextures(et);for(let ot=0,at=_e.length;ot<at;ot++){const lt=_e[ot];rt[lt.uuid]===void 0&&(rt[lt.uuid]=st.parse(lt)),it[lt.uuid]=rt[lt.uuid]}}return it}parseAnimations(_e){const et={};if(_e!==void 0)for(let rt=0;rt<_e.length;rt++){const it=_e[rt],st=AnimationClip.parse(it);et[st.uuid]=st}return et}parseImages(_e,et){const rt=this,it={};let st;function ot(lt){return rt.manager.itemStart(lt),st.load(lt,function(){rt.manager.itemEnd(lt)},void 0,function(){rt.manager.itemError(lt),rt.manager.itemEnd(lt)})}function at(lt){if(typeof lt=="string"){const ct=lt,ut=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ct)?ct:rt.resourcePath+ct;return ot(ut)}else return lt.data?{data:getTypedArray(lt.type,lt.data),width:lt.width,height:lt.height}:null}if(_e!==void 0&&_e.length>0){const lt=new LoadingManager(et);st=new ImageLoader(lt),st.setCrossOrigin(this.crossOrigin);for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct],dt=ht.url;if(Array.isArray(dt)){const ft=[];for(let pt=0,mt=dt.length;pt<mt;pt++){const At=dt[pt],gt=at(At);gt!==null&&(gt instanceof HTMLImageElement?ft.push(gt):ft.push(new DataTexture$1(gt.data,gt.width,gt.height)))}it[ht.uuid]=new Source$1(ft)}else{const ft=at(ht.url);it[ht.uuid]=new Source$1(ft)}}}return it}async parseImagesAsync(_e){const et=this,rt={};let it;async function st(ot){if(typeof ot=="string"){const at=ot,lt=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(at)?at:et.resourcePath+at;return await it.loadAsync(lt)}else return ot.data?{data:getTypedArray(ot.type,ot.data),width:ot.width,height:ot.height}:null}if(_e!==void 0&&_e.length>0){it=new ImageLoader(this.manager),it.setCrossOrigin(this.crossOrigin);for(let ot=0,at=_e.length;ot<at;ot++){const lt=_e[ot],ct=lt.url;if(Array.isArray(ct)){const ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const ft=ct[ht],pt=await st(ft);pt!==null&&(pt instanceof HTMLImageElement?ut.push(pt):ut.push(new DataTexture$1(pt.data,pt.width,pt.height)))}rt[lt.uuid]=new Source$1(ut)}else{const ut=await st(lt.url);rt[lt.uuid]=new Source$1(ut)}}}return rt}parseTextures(_e,et){function rt(st,ot){return typeof st=="number"?st:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",st),ot[st])}const it={};if(_e!==void 0)for(let st=0,ot=_e.length;st<ot;st++){const at=_e[st];at.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',at.uuid),et[at.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",at.image);const lt=et[at.image],ct=lt.data;let ut;Array.isArray(ct)?(ut=new CubeTexture$1,ct.length===6&&(ut.needsUpdate=!0)):(ct&&ct.data?ut=new DataTexture$1:ut=new Texture$1,ct&&(ut.needsUpdate=!0)),ut.source=lt,ut.uuid=at.uuid,at.name!==void 0&&(ut.name=at.name),at.mapping!==void 0&&(ut.mapping=rt(at.mapping,TEXTURE_MAPPING)),at.channel!==void 0&&(ut.channel=at.channel),at.offset!==void 0&&ut.offset.fromArray(at.offset),at.repeat!==void 0&&ut.repeat.fromArray(at.repeat),at.center!==void 0&&ut.center.fromArray(at.center),at.rotation!==void 0&&(ut.rotation=at.rotation),at.wrap!==void 0&&(ut.wrapS=rt(at.wrap[0],TEXTURE_WRAPPING),ut.wrapT=rt(at.wrap[1],TEXTURE_WRAPPING)),at.format!==void 0&&(ut.format=at.format),at.internalFormat!==void 0&&(ut.internalFormat=at.internalFormat),at.type!==void 0&&(ut.type=at.type),at.colorSpace!==void 0&&(ut.colorSpace=at.colorSpace),at.minFilter!==void 0&&(ut.minFilter=rt(at.minFilter,TEXTURE_FILTER)),at.magFilter!==void 0&&(ut.magFilter=rt(at.magFilter,TEXTURE_FILTER)),at.anisotropy!==void 0&&(ut.anisotropy=at.anisotropy),at.flipY!==void 0&&(ut.flipY=at.flipY),at.generateMipmaps!==void 0&&(ut.generateMipmaps=at.generateMipmaps),at.premultiplyAlpha!==void 0&&(ut.premultiplyAlpha=at.premultiplyAlpha),at.unpackAlignment!==void 0&&(ut.unpackAlignment=at.unpackAlignment),at.compareFunction!==void 0&&(ut.compareFunction=at.compareFunction),at.userData!==void 0&&(ut.userData=at.userData),it[at.uuid]=ut}return it}parseObject(_e,et,rt,it,st){let ot;function at(dt){return et[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",dt),et[dt]}function lt(dt){if(dt!==void 0){if(Array.isArray(dt)){const ft=[];for(let pt=0,mt=dt.length;pt<mt;pt++){const At=dt[pt];rt[At]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",At),ft.push(rt[At])}return ft}return rt[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",dt),rt[dt]}}function ct(dt){return it[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",dt),it[dt]}let ut,ht;switch(_e.type){case"Scene":ot=new Scene$1,_e.background!==void 0&&(Number.isInteger(_e.background)?ot.background=new Color$2(_e.background):ot.background=ct(_e.background)),_e.environment!==void 0&&(ot.environment=ct(_e.environment)),_e.fog!==void 0&&(_e.fog.type==="Fog"?ot.fog=new Fog(_e.fog.color,_e.fog.near,_e.fog.far):_e.fog.type==="FogExp2"&&(ot.fog=new FogExp2(_e.fog.color,_e.fog.density)),_e.fog.name!==""&&(ot.fog.name=_e.fog.name)),_e.backgroundBlurriness!==void 0&&(ot.backgroundBlurriness=_e.backgroundBlurriness),_e.backgroundIntensity!==void 0&&(ot.backgroundIntensity=_e.backgroundIntensity),_e.backgroundRotation!==void 0&&ot.backgroundRotation.fromArray(_e.backgroundRotation),_e.environmentIntensity!==void 0&&(ot.environmentIntensity=_e.environmentIntensity),_e.environmentRotation!==void 0&&ot.environmentRotation.fromArray(_e.environmentRotation);break;case"PerspectiveCamera":ot=new PerspectiveCamera$2(_e.fov,_e.aspect,_e.near,_e.far),_e.focus!==void 0&&(ot.focus=_e.focus),_e.zoom!==void 0&&(ot.zoom=_e.zoom),_e.filmGauge!==void 0&&(ot.filmGauge=_e.filmGauge),_e.filmOffset!==void 0&&(ot.filmOffset=_e.filmOffset),_e.view!==void 0&&(ot.view=Object.assign({},_e.view));break;case"OrthographicCamera":ot=new OrthographicCamera$1(_e.left,_e.right,_e.top,_e.bottom,_e.near,_e.far),_e.zoom!==void 0&&(ot.zoom=_e.zoom),_e.view!==void 0&&(ot.view=Object.assign({},_e.view));break;case"AmbientLight":ot=new AmbientLight$1(_e.color,_e.intensity);break;case"DirectionalLight":ot=new DirectionalLight$1(_e.color,_e.intensity),ot.target=_e.target||"";break;case"PointLight":ot=new PointLight$1(_e.color,_e.intensity,_e.distance,_e.decay);break;case"RectAreaLight":ot=new RectAreaLight$1(_e.color,_e.intensity,_e.width,_e.height);break;case"SpotLight":ot=new SpotLight$1(_e.color,_e.intensity,_e.distance,_e.angle,_e.penumbra,_e.decay),ot.target=_e.target||"";break;case"HemisphereLight":ot=new HemisphereLight$1(_e.color,_e.groundColor,_e.intensity);break;case"LightProbe":ot=new LightProbe$1().fromJSON(_e);break;case"SkinnedMesh":ut=at(_e.geometry),ht=lt(_e.material),ot=new SkinnedMesh(ut,ht),_e.bindMode!==void 0&&(ot.bindMode=_e.bindMode),_e.bindMatrix!==void 0&&ot.bindMatrix.fromArray(_e.bindMatrix),_e.skeleton!==void 0&&(ot.skeleton=_e.skeleton);break;case"Mesh":ut=at(_e.geometry),ht=lt(_e.material),ot=new Mesh$1(ut,ht);break;case"InstancedMesh":ut=at(_e.geometry),ht=lt(_e.material);const dt=_e.count,ft=_e.instanceMatrix,pt=_e.instanceColor;ot=new InstancedMesh(ut,ht,dt),ot.instanceMatrix=new InstancedBufferAttribute$1(new Float32Array(ft.array),16),pt!==void 0&&(ot.instanceColor=new InstancedBufferAttribute$1(new Float32Array(pt.array),pt.itemSize));break;case"BatchedMesh":ut=at(_e.geometry),ht=lt(_e.material),ot=new BatchedMesh(_e.maxInstanceCount,_e.maxVertexCount,_e.maxIndexCount,ht),ot.geometry=ut,ot.perObjectFrustumCulled=_e.perObjectFrustumCulled,ot.sortObjects=_e.sortObjects,ot._drawRanges=_e.drawRanges,ot._reservedRanges=_e.reservedRanges,ot._visibility=_e.visibility,ot._active=_e.active,ot._bounds=_e.bounds.map(mt=>{const At=new Box3$1;At.min.fromArray(mt.boxMin),At.max.fromArray(mt.boxMax);const gt=new Sphere$1;return gt.radius=mt.sphereRadius,gt.center.fromArray(mt.sphereCenter),{boxInitialized:mt.boxInitialized,box:At,sphereInitialized:mt.sphereInitialized,sphere:gt}}),ot._maxInstanceCount=_e.maxInstanceCount,ot._maxVertexCount=_e.maxVertexCount,ot._maxIndexCount=_e.maxIndexCount,ot._geometryInitialized=_e.geometryInitialized,ot._geometryCount=_e.geometryCount,ot._matricesTexture=ct(_e.matricesTexture.uuid),_e.colorsTexture!==void 0&&(ot._colorsTexture=ct(_e.colorsTexture.uuid));break;case"LOD":ot=new LOD;break;case"Line":ot=new Line(at(_e.geometry),lt(_e.material));break;case"LineLoop":ot=new LineLoop(at(_e.geometry),lt(_e.material));break;case"LineSegments":ot=new LineSegments(at(_e.geometry),lt(_e.material));break;case"PointCloud":case"Points":ot=new Points(at(_e.geometry),lt(_e.material));break;case"Sprite":ot=new Sprite(lt(_e.material));break;case"Group":ot=new Group$1;break;case"Bone":ot=new Bone;break;default:ot=new Object3D$1}if(ot.uuid=_e.uuid,_e.name!==void 0&&(ot.name=_e.name),_e.matrix!==void 0?(ot.matrix.fromArray(_e.matrix),_e.matrixAutoUpdate!==void 0&&(ot.matrixAutoUpdate=_e.matrixAutoUpdate),ot.matrixAutoUpdate&&ot.matrix.decompose(ot.position,ot.quaternion,ot.scale)):(_e.position!==void 0&&ot.position.fromArray(_e.position),_e.rotation!==void 0&&ot.rotation.fromArray(_e.rotation),_e.quaternion!==void 0&&ot.quaternion.fromArray(_e.quaternion),_e.scale!==void 0&&ot.scale.fromArray(_e.scale)),_e.up!==void 0&&ot.up.fromArray(_e.up),_e.castShadow!==void 0&&(ot.castShadow=_e.castShadow),_e.receiveShadow!==void 0&&(ot.receiveShadow=_e.receiveShadow),_e.shadow&&(_e.shadow.intensity!==void 0&&(ot.shadow.intensity=_e.shadow.intensity),_e.shadow.bias!==void 0&&(ot.shadow.bias=_e.shadow.bias),_e.shadow.normalBias!==void 0&&(ot.shadow.normalBias=_e.shadow.normalBias),_e.shadow.radius!==void 0&&(ot.shadow.radius=_e.shadow.radius),_e.shadow.mapSize!==void 0&&ot.shadow.mapSize.fromArray(_e.shadow.mapSize),_e.shadow.camera!==void 0&&(ot.shadow.camera=this.parseObject(_e.shadow.camera))),_e.visible!==void 0&&(ot.visible=_e.visible),_e.frustumCulled!==void 0&&(ot.frustumCulled=_e.frustumCulled),_e.renderOrder!==void 0&&(ot.renderOrder=_e.renderOrder),_e.userData!==void 0&&(ot.userData=_e.userData),_e.layers!==void 0&&(ot.layers.mask=_e.layers),_e.children!==void 0){const dt=_e.children;for(let ft=0;ft<dt.length;ft++)ot.add(this.parseObject(dt[ft],et,rt,it,st))}if(_e.animations!==void 0){const dt=_e.animations;for(let ft=0;ft<dt.length;ft++){const pt=dt[ft];ot.animations.push(st[pt])}}if(_e.type==="LOD"){_e.autoUpdate!==void 0&&(ot.autoUpdate=_e.autoUpdate);const dt=_e.levels;for(let ft=0;ft<dt.length;ft++){const pt=dt[ft],mt=ot.getObjectByProperty("uuid",pt.object);mt!==void 0&&ot.addLevel(mt,pt.distance,pt.hysteresis)}}return ot}bindSkeletons(_e,et){Object.keys(et).length!==0&&_e.traverse(function(rt){if(rt.isSkinnedMesh===!0&&rt.skeleton!==void 0){const it=et[rt.skeleton];it===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",rt.skeleton):rt.bind(it,rt.bindMatrix)}})}bindLightTargets(_e){_e.traverse(function(et){if(et.isDirectionalLight||et.isSpotLight){const rt=et.target,it=_e.getObjectByProperty("uuid",rt);it!==void 0?et.target=it:et.target=new Object3D$1}})}}const TEXTURE_MAPPING={UVMapping:UVMapping$1,CubeReflectionMapping:CubeReflectionMapping$1,CubeRefractionMapping:CubeRefractionMapping$1,EquirectangularReflectionMapping:EquirectangularReflectionMapping$1,EquirectangularRefractionMapping:EquirectangularRefractionMapping$1,CubeUVReflectionMapping:CubeUVReflectionMapping$1},TEXTURE_WRAPPING={RepeatWrapping:RepeatWrapping$1,ClampToEdgeWrapping:ClampToEdgeWrapping$1,MirroredRepeatWrapping:MirroredRepeatWrapping$1},TEXTURE_FILTER={NearestFilter:NearestFilter$1,NearestMipmapNearestFilter:NearestMipmapNearestFilter$1,NearestMipmapLinearFilter:NearestMipmapLinearFilter$1,LinearFilter:LinearFilter$1,LinearMipmapNearestFilter:LinearMipmapNearestFilter$1,LinearMipmapLinearFilter:LinearMipmapLinearFilter$1};class ImageBitmapLoader extends Loader{constructor(_e){super(_e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_e){return this.options=_e,this}load(_e,et,rt,it){_e===void 0&&(_e=""),this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=this,ot=Cache.get(_e);if(ot!==void 0){if(st.manager.itemStart(_e),ot.then){ot.then(ct=>{et&&et(ct),st.manager.itemEnd(_e)}).catch(ct=>{it&&it(ct)});return}return setTimeout(function(){et&&et(ot),st.manager.itemEnd(_e)},0),ot}const at={};at.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",at.headers=this.requestHeader;const lt=fetch(_e,at).then(function(ct){return ct.blob()}).then(function(ct){return createImageBitmap(ct,Object.assign(st.options,{colorSpaceConversion:"none"}))}).then(function(ct){return Cache.add(_e,ct),et&&et(ct),st.manager.itemEnd(_e),ct}).catch(function(ct){it&&it(ct),Cache.remove(_e),st.manager.itemError(_e),st.manager.itemEnd(_e)});Cache.add(_e,lt),st.manager.itemStart(_e)}}let _context$1;class AudioContext{static getContext(){return _context$1===void 0&&(_context$1=new(window.AudioContext||window.webkitAudioContext)),_context$1}static setContext(_e){_context$1=_e}}class AudioLoader extends Loader{constructor(_e){super(_e)}load(_e,et,rt,it){const st=this,ot=new FileLoader(this.manager);ot.setResponseType("arraybuffer"),ot.setPath(this.path),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(_e,function(lt){try{const ct=lt.slice(0);AudioContext.getContext().decodeAudioData(ct,function(ht){et(ht)}).catch(at)}catch(ct){at(ct)}},rt,it);function at(lt){it?it(lt):console.error(lt),st.manager.itemError(_e)}}}const _eyeRight=new Matrix4$1,_eyeLeft=new Matrix4$1,_projectionMatrix=new Matrix4$1;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera$2,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera$2,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_e){const et=this._cache;if(et.focus!==_e.focus||et.fov!==_e.fov||et.aspect!==_e.aspect*this.aspect||et.near!==_e.near||et.far!==_e.far||et.zoom!==_e.zoom||et.eyeSep!==this.eyeSep){et.focus=_e.focus,et.fov=_e.fov,et.aspect=_e.aspect*this.aspect,et.near=_e.near,et.far=_e.far,et.zoom=_e.zoom,et.eyeSep=this.eyeSep,_projectionMatrix.copy(_e.projectionMatrix);const it=et.eyeSep/2,st=it*et.near/et.focus,ot=et.near*Math.tan(DEG2RAD$1*et.fov*.5)/et.zoom;let at,lt;_eyeLeft.elements[12]=-it,_eyeRight.elements[12]=it,at=-ot*et.aspect+st,lt=ot*et.aspect+st,_projectionMatrix.elements[0]=2*et.near/(lt-at),_projectionMatrix.elements[8]=(lt+at)/(lt-at),this.cameraL.projectionMatrix.copy(_projectionMatrix),at=-ot*et.aspect-st,lt=ot*et.aspect-st,_projectionMatrix.elements[0]=2*et.near/(lt-at),_projectionMatrix.elements[8]=(lt+at)/(lt-at),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_e.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(_e=!0){this.autoStart=_e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$5(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const et=now$5();_e=(et-this.oldTime)/1e3,this.oldTime=et,this.elapsedTime+=_e}return _e}}function now$5(){return performance.now()}const _position$1=new Vector3$1,_quaternion$1=new Quaternion$1,_scale$1=new Vector3$1,_orientation$1=new Vector3$1;class AudioListener extends Object3D$1{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_e){return this.gain.gain.setTargetAtTime(_e,this.context.currentTime,.01),this}updateMatrixWorld(_e){super.updateMatrixWorld(_e);const et=this.context.listener,rt=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),et.positionX){const it=this.context.currentTime+this.timeDelta;et.positionX.linearRampToValueAtTime(_position$1.x,it),et.positionY.linearRampToValueAtTime(_position$1.y,it),et.positionZ.linearRampToValueAtTime(_position$1.z,it),et.forwardX.linearRampToValueAtTime(_orientation$1.x,it),et.forwardY.linearRampToValueAtTime(_orientation$1.y,it),et.forwardZ.linearRampToValueAtTime(_orientation$1.z,it),et.upX.linearRampToValueAtTime(rt.x,it),et.upY.linearRampToValueAtTime(rt.y,it),et.upZ.linearRampToValueAtTime(rt.z,it)}else et.setPosition(_position$1.x,_position$1.y,_position$1.z),et.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,rt.x,rt.y,rt.z)}}class Audio extends Object3D$1{constructor(_e){super(),this.type="Audio",this.listener=_e,this.context=_e.context,this.gain=this.context.createGain(),this.gain.connect(_e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_e,this.connect(),this}setMediaElementSource(_e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_e),this.connect(),this}setMediaStreamSource(_e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_e),this.connect(),this}setBuffer(_e){return this.buffer=_e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_e;const et=this.context.createBufferSource();return et.buffer=this.buffer,et.loop=this.loop,et.loopStart=this.loopStart,et.loopEnd=this.loopEnd,et.onended=this.onEnded.bind(this),et.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=et,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(_e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+_e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _e=1,et=this.filters.length;_e<et;_e++)this.filters[_e-1].connect(this.filters[_e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _e=1,et=this.filters.length;_e<et;_e++)this.filters[_e-1].disconnect(this.filters[_e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(_e){return _e||(_e=[]),this._connected===!0?(this.disconnect(),this.filters=_e.slice(),this.connect()):this.filters=_e.slice(),this}setDetune(_e){return this.detune=_e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_e){return this.setFilters(_e?[_e]:[])}setPlaybackRate(_e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_e){return this.loopStart=_e,this}setLoopEnd(_e){return this.loopEnd=_e,this}getVolume(){return this.gain.gain.value}setVolume(_e){return this.gain.gain.setTargetAtTime(_e,this.context.currentTime,.01),this}}const _position$4=new Vector3$1,_quaternion$5=new Quaternion$1,_scale=new Vector3$1,_orientation=new Vector3$1;class PositionalAudio extends Audio{constructor(_e){super(_e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_e){return this.panner.refDistance=_e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_e){return this.panner.rolloffFactor=_e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_e){return this.panner.distanceModel=_e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_e){return this.panner.maxDistance=_e,this}setDirectionalCone(_e,et,rt){return this.panner.coneInnerAngle=_e,this.panner.coneOuterAngle=et,this.panner.coneOuterGain=rt,this}updateMatrixWorld(_e){if(super.updateMatrixWorld(_e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position$4,_quaternion$5,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion$5);const et=this.panner;if(et.positionX){const rt=this.context.currentTime+this.listener.timeDelta;et.positionX.linearRampToValueAtTime(_position$4.x,rt),et.positionY.linearRampToValueAtTime(_position$4.y,rt),et.positionZ.linearRampToValueAtTime(_position$4.z,rt),et.orientationX.linearRampToValueAtTime(_orientation.x,rt),et.orientationY.linearRampToValueAtTime(_orientation.y,rt),et.orientationZ.linearRampToValueAtTime(_orientation.z,rt)}else et.setPosition(_position$4.x,_position$4.y,_position$4.z),et.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_e,et=2048){this.analyser=_e.context.createAnalyser(),this.analyser.fftSize=et,this.data=new Uint8Array(this.analyser.frequencyBinCount),_e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _e=0;const et=this.getFrequencyData();for(let rt=0;rt<et.length;rt++)_e+=et[rt];return _e/et.length}}class PropertyMixer{constructor(_e,et,rt){this.binding=_e,this.valueSize=rt;let it,st,ot;switch(et){case"quaternion":it=this._slerp,st=this._slerpAdditive,ot=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(rt*6),this._workIndex=5;break;case"string":case"bool":it=this._select,st=this._select,ot=this._setAdditiveIdentityOther,this.buffer=new Array(rt*5);break;default:it=this._lerp,st=this._lerpAdditive,ot=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(rt*5)}this._mixBufferRegion=it,this._mixBufferRegionAdditive=st,this._setIdentity=ot,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_e,et){const rt=this.buffer,it=this.valueSize,st=_e*it+it;let ot=this.cumulativeWeight;if(ot===0){for(let at=0;at!==it;++at)rt[st+at]=rt[at];ot=et}else{ot+=et;const at=et/ot;this._mixBufferRegion(rt,st,0,at,it)}this.cumulativeWeight=ot}accumulateAdditive(_e){const et=this.buffer,rt=this.valueSize,it=rt*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(et,it,0,_e,rt),this.cumulativeWeightAdditive+=_e}apply(_e){const et=this.valueSize,rt=this.buffer,it=_e*et+et,st=this.cumulativeWeight,ot=this.cumulativeWeightAdditive,at=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,st<1){const lt=et*this._origIndex;this._mixBufferRegion(rt,it,lt,1-st,et)}ot>0&&this._mixBufferRegionAdditive(rt,it,this._addIndex*et,1,et);for(let lt=et,ct=et+et;lt!==ct;++lt)if(rt[lt]!==rt[lt+et]){at.setValue(rt,it);break}}saveOriginalState(){const _e=this.binding,et=this.buffer,rt=this.valueSize,it=rt*this._origIndex;_e.getValue(et,it);for(let st=rt,ot=it;st!==ot;++st)et[st]=et[it+st%rt];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _e=this.valueSize*3;this.binding.setValue(this.buffer,_e)}_setAdditiveIdentityNumeric(){const _e=this._addIndex*this.valueSize,et=_e+this.valueSize;for(let rt=_e;rt<et;rt++)this.buffer[rt]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _e=this._origIndex*this.valueSize,et=this._addIndex*this.valueSize;for(let rt=0;rt<this.valueSize;rt++)this.buffer[et+rt]=this.buffer[_e+rt]}_select(_e,et,rt,it,st){if(it>=.5)for(let ot=0;ot!==st;++ot)_e[et+ot]=_e[rt+ot]}_slerp(_e,et,rt,it){Quaternion$1.slerpFlat(_e,et,_e,et,_e,rt,it)}_slerpAdditive(_e,et,rt,it,st){const ot=this._workIndex*st;Quaternion$1.multiplyQuaternionsFlat(_e,ot,_e,et,_e,rt),Quaternion$1.slerpFlat(_e,et,_e,et,_e,ot,it)}_lerp(_e,et,rt,it,st){const ot=1-it;for(let at=0;at!==st;++at){const lt=et+at;_e[lt]=_e[lt]*ot+_e[rt+at]*it}}_lerpAdditive(_e,et,rt,it,st){for(let ot=0;ot!==st;++ot){const at=et+ot;_e[at]=_e[at]+_e[rt+ot]*it}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_e,et,rt){const it=rt||PropertyBinding.parseTrackName(et);this._targetGroup=_e,this._bindings=_e.subscribe_(et,it)}getValue(_e,et){this.bind();const rt=this._targetGroup.nCachedObjects_,it=this._bindings[rt];it!==void 0&&it.getValue(_e,et)}setValue(_e,et){const rt=this._bindings;for(let it=this._targetGroup.nCachedObjects_,st=rt.length;it!==st;++it)rt[it].setValue(_e,et)}bind(){const _e=this._bindings;for(let et=this._targetGroup.nCachedObjects_,rt=_e.length;et!==rt;++et)_e[et].bind()}unbind(){const _e=this._bindings;for(let et=this._targetGroup.nCachedObjects_,rt=_e.length;et!==rt;++et)_e[et].unbind()}}class PropertyBinding{constructor(_e,et,rt){this.path=et,this.parsedPath=rt||PropertyBinding.parseTrackName(et),this.node=PropertyBinding.findNode(_e,this.parsedPath.nodeName),this.rootNode=_e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_e,et,rt){return _e&&_e.isAnimationObjectGroup?new PropertyBinding.Composite(_e,et,rt):new PropertyBinding(_e,et,rt)}static sanitizeNodeName(_e){return _e.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_e){const et=_trackRe.exec(_e);if(et===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_e);const rt={nodeName:et[2],objectName:et[3],objectIndex:et[4],propertyName:et[5],propertyIndex:et[6]},it=rt.nodeName&&rt.nodeName.lastIndexOf(".");if(it!==void 0&&it!==-1){const st=rt.nodeName.substring(it+1);_supportedObjectNames.indexOf(st)!==-1&&(rt.nodeName=rt.nodeName.substring(0,it),rt.objectName=st)}if(rt.propertyName===null||rt.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_e);return rt}static findNode(_e,et){if(et===void 0||et===""||et==="."||et===-1||et===_e.name||et===_e.uuid)return _e;if(_e.skeleton){const rt=_e.skeleton.getBoneByName(et);if(rt!==void 0)return rt}if(_e.children){const rt=function(st){for(let ot=0;ot<st.length;ot++){const at=st[ot];if(at.name===et||at.uuid===et)return at;const lt=rt(at.children);if(lt)return lt}return null},it=rt(_e.children);if(it)return it}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_e,et){_e[et]=this.targetObject[this.propertyName]}_getValue_array(_e,et){const rt=this.resolvedProperty;for(let it=0,st=rt.length;it!==st;++it)_e[et++]=rt[it]}_getValue_arrayElement(_e,et){_e[et]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_e,et){this.resolvedProperty.toArray(_e,et)}_setValue_direct(_e,et){this.targetObject[this.propertyName]=_e[et]}_setValue_direct_setNeedsUpdate(_e,et){this.targetObject[this.propertyName]=_e[et],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_e,et){this.targetObject[this.propertyName]=_e[et],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_e,et){const rt=this.resolvedProperty;for(let it=0,st=rt.length;it!==st;++it)rt[it]=_e[et++]}_setValue_array_setNeedsUpdate(_e,et){const rt=this.resolvedProperty;for(let it=0,st=rt.length;it!==st;++it)rt[it]=_e[et++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_e,et){const rt=this.resolvedProperty;for(let it=0,st=rt.length;it!==st;++it)rt[it]=_e[et++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_e,et){this.resolvedProperty[this.propertyIndex]=_e[et]}_setValue_arrayElement_setNeedsUpdate(_e,et){this.resolvedProperty[this.propertyIndex]=_e[et],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_e,et){this.resolvedProperty[this.propertyIndex]=_e[et],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_e,et){this.resolvedProperty.fromArray(_e,et)}_setValue_fromArray_setNeedsUpdate(_e,et){this.resolvedProperty.fromArray(_e,et),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_e,et){this.resolvedProperty.fromArray(_e,et),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_e,et){this.bind(),this.getValue(_e,et)}_setValue_unbound(_e,et){this.bind(),this.setValue(_e,et)}bind(){let _e=this.node;const et=this.parsedPath,rt=et.objectName,it=et.propertyName;let st=et.propertyIndex;if(_e||(_e=PropertyBinding.findNode(this.rootNode,et.nodeName),this.node=_e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(rt){let ct=et.objectIndex;switch(rt){case"materials":if(!_e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_e=_e.material.materials;break;case"bones":if(!_e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_e=_e.skeleton.bones;for(let ut=0;ut<_e.length;ut++)if(_e[ut].name===ct){ct=ut;break}break;case"map":if("map"in _e){_e=_e.map;break}if(!_e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_e=_e.material.map;break;default:if(_e[rt]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_e=_e[rt]}if(ct!==void 0){if(_e[ct]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_e);return}_e=_e[ct]}}const ot=_e[it];if(ot===void 0){const ct=et.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+ct+"."+it+" but it wasn't found.",_e);return}let at=this.Versioning.None;this.targetObject=_e,_e.needsUpdate!==void 0?at=this.Versioning.NeedsUpdate:_e.matrixWorldNeedsUpdate!==void 0&&(at=this.Versioning.MatrixWorldNeedsUpdate);let lt=this.BindingType.Direct;if(st!==void 0){if(it==="morphTargetInfluences"){if(!_e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_e.morphTargetDictionary[st]!==void 0&&(st=_e.morphTargetDictionary[st])}lt=this.BindingType.ArrayElement,this.resolvedProperty=ot,this.propertyIndex=st}else ot.fromArray!==void 0&&ot.toArray!==void 0?(lt=this.BindingType.HasFromToArray,this.resolvedProperty=ot):Array.isArray(ot)?(lt=this.BindingType.EntireArray,this.resolvedProperty=ot):this.propertyName=it;this.getValue=this.GetterByBindingType[lt],this.setValue=this.SetterByBindingTypeAndVersioning[lt][at]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID$2(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _e={};this._indicesByUUID=_e;for(let rt=0,it=arguments.length;rt!==it;++rt)_e[arguments[rt].uuid]=rt;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const et=this;this.stats={objects:{get total(){return et._objects.length},get inUse(){return this.total-et.nCachedObjects_}},get bindingsPerObject(){return et._bindings.length}}}add(){const _e=this._objects,et=this._indicesByUUID,rt=this._paths,it=this._parsedPaths,st=this._bindings,ot=st.length;let at,lt=_e.length,ct=this.nCachedObjects_;for(let ut=0,ht=arguments.length;ut!==ht;++ut){const dt=arguments[ut],ft=dt.uuid;let pt=et[ft];if(pt===void 0){pt=lt++,et[ft]=pt,_e.push(dt);for(let mt=0,At=ot;mt!==At;++mt)st[mt].push(new PropertyBinding(dt,rt[mt],it[mt]))}else if(pt<ct){at=_e[pt];const mt=--ct,At=_e[mt];et[At.uuid]=pt,_e[pt]=At,et[ft]=mt,_e[mt]=dt;for(let gt=0,bt=ot;gt!==bt;++gt){const Tt=st[gt],wt=Tt[mt];let Rt=Tt[pt];Tt[pt]=wt,Rt===void 0&&(Rt=new PropertyBinding(dt,rt[gt],it[gt])),Tt[mt]=Rt}}else _e[pt]!==at&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=ct}remove(){const _e=this._objects,et=this._indicesByUUID,rt=this._bindings,it=rt.length;let st=this.nCachedObjects_;for(let ot=0,at=arguments.length;ot!==at;++ot){const lt=arguments[ot],ct=lt.uuid,ut=et[ct];if(ut!==void 0&&ut>=st){const ht=st++,dt=_e[ht];et[dt.uuid]=ut,_e[ut]=dt,et[ct]=ht,_e[ht]=lt;for(let ft=0,pt=it;ft!==pt;++ft){const mt=rt[ft],At=mt[ht],gt=mt[ut];mt[ut]=At,mt[ht]=gt}}}this.nCachedObjects_=st}uncache(){const _e=this._objects,et=this._indicesByUUID,rt=this._bindings,it=rt.length;let st=this.nCachedObjects_,ot=_e.length;for(let at=0,lt=arguments.length;at!==lt;++at){const ct=arguments[at],ut=ct.uuid,ht=et[ut];if(ht!==void 0)if(delete et[ut],ht<st){const dt=--st,ft=_e[dt],pt=--ot,mt=_e[pt];et[ft.uuid]=ht,_e[ht]=ft,et[mt.uuid]=dt,_e[dt]=mt,_e.pop();for(let At=0,gt=it;At!==gt;++At){const bt=rt[At],Tt=bt[dt],wt=bt[pt];bt[ht]=Tt,bt[dt]=wt,bt.pop()}}else{const dt=--ot,ft=_e[dt];dt>0&&(et[ft.uuid]=ht),_e[ht]=ft,_e.pop();for(let pt=0,mt=it;pt!==mt;++pt){const At=rt[pt];At[ht]=At[dt],At.pop()}}}this.nCachedObjects_=st}subscribe_(_e,et){const rt=this._bindingsIndicesByPath;let it=rt[_e];const st=this._bindings;if(it!==void 0)return st[it];const ot=this._paths,at=this._parsedPaths,lt=this._objects,ct=lt.length,ut=this.nCachedObjects_,ht=new Array(ct);it=st.length,rt[_e]=it,ot.push(_e),at.push(et),st.push(ht);for(let dt=ut,ft=lt.length;dt!==ft;++dt){const pt=lt[dt];ht[dt]=new PropertyBinding(pt,_e,et)}return ht}unsubscribe_(_e){const et=this._bindingsIndicesByPath,rt=et[_e];if(rt!==void 0){const it=this._paths,st=this._parsedPaths,ot=this._bindings,at=ot.length-1,lt=ot[at],ct=_e[at];et[ct]=rt,ot[rt]=lt,ot.pop(),st[rt]=st[at],st.pop(),it[rt]=it[at],it.pop()}}}class AnimationAction{constructor(_e,et,rt=null,it=et.blendMode){this._mixer=_e,this._clip=et,this._localRoot=rt,this.blendMode=it;const st=et.tracks,ot=st.length,at=new Array(ot),lt={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let ct=0;ct!==ot;++ct){const ut=st[ct].createInterpolant(null);at[ct]=ut,ut.settings=lt}this._interpolantSettings=lt,this._interpolants=at,this._propertyBindings=new Array(ot),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_e){return this._startTime=_e,this}setLoop(_e,et){return this.loop=_e,this.repetitions=et,this}setEffectiveWeight(_e){return this.weight=_e,this._effectiveWeight=this.enabled?_e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_e){return this._scheduleFading(_e,0,1)}fadeOut(_e){return this._scheduleFading(_e,1,0)}crossFadeFrom(_e,et,rt){if(_e.fadeOut(et),this.fadeIn(et),rt){const it=this._clip.duration,st=_e._clip.duration,ot=st/it,at=it/st;_e.warp(1,ot,et),this.warp(at,1,et)}return this}crossFadeTo(_e,et,rt){return _e.crossFadeFrom(this,et,rt)}stopFading(){const _e=this._weightInterpolant;return _e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_e)),this}setEffectiveTimeScale(_e){return this.timeScale=_e,this._effectiveTimeScale=this.paused?0:_e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_e){return this.timeScale=this._clip.duration/_e,this.stopWarping()}syncWith(_e){return this.time=_e.time,this.timeScale=_e.timeScale,this.stopWarping()}halt(_e){return this.warp(this._effectiveTimeScale,0,_e)}warp(_e,et,rt){const it=this._mixer,st=it.time,ot=this.timeScale;let at=this._timeScaleInterpolant;at===null&&(at=it._lendControlInterpolant(),this._timeScaleInterpolant=at);const lt=at.parameterPositions,ct=at.sampleValues;return lt[0]=st,lt[1]=st+rt,ct[0]=_e/ot,ct[1]=et/ot,this}stopWarping(){const _e=this._timeScaleInterpolant;return _e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_e,et,rt,it){if(!this.enabled){this._updateWeight(_e);return}const st=this._startTime;if(st!==null){const lt=(_e-st)*rt;lt<0||rt===0?et=0:(this._startTime=null,et=rt*lt)}et*=this._updateTimeScale(_e);const ot=this._updateTime(et),at=this._updateWeight(_e);if(at>0){const lt=this._interpolants,ct=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let ut=0,ht=lt.length;ut!==ht;++ut)lt[ut].evaluate(ot),ct[ut].accumulateAdditive(at);break;case NormalAnimationBlendMode:default:for(let ut=0,ht=lt.length;ut!==ht;++ut)lt[ut].evaluate(ot),ct[ut].accumulate(it,at)}}}_updateWeight(_e){let et=0;if(this.enabled){et=this.weight;const rt=this._weightInterpolant;if(rt!==null){const it=rt.evaluate(_e)[0];et*=it,_e>rt.parameterPositions[1]&&(this.stopFading(),it===0&&(this.enabled=!1))}}return this._effectiveWeight=et,et}_updateTimeScale(_e){let et=0;if(!this.paused){et=this.timeScale;const rt=this._timeScaleInterpolant;if(rt!==null){const it=rt.evaluate(_e)[0];et*=it,_e>rt.parameterPositions[1]&&(this.stopWarping(),et===0?this.paused=!0:this.timeScale=et)}}return this._effectiveTimeScale=et,et}_updateTime(_e){const et=this._clip.duration,rt=this.loop;let it=this.time+_e,st=this._loopCount;const ot=rt===LoopPingPong;if(_e===0)return st===-1?it:ot&&(st&1)===1?et-it:it;if(rt===LoopOnce){st===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(it>=et)it=et;else if(it<0)it=0;else{this.time=it;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=it,this._mixer.dispatchEvent({type:"finished",action:this,direction:_e<0?-1:1})}}else{if(st===-1&&(_e>=0?(st=0,this._setEndings(!0,this.repetitions===0,ot)):this._setEndings(this.repetitions===0,!0,ot)),it>=et||it<0){const at=Math.floor(it/et);it-=et*at,st+=Math.abs(at);const lt=this.repetitions-st;if(lt<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,it=_e>0?et:0,this.time=it,this._mixer.dispatchEvent({type:"finished",action:this,direction:_e>0?1:-1});else{if(lt===1){const ct=_e<0;this._setEndings(ct,!ct,ot)}else this._setEndings(!1,!1,ot);this._loopCount=st,this.time=it,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:at})}}else this.time=it;if(ot&&(st&1)===1)return et-it}return it}_setEndings(_e,et,rt){const it=this._interpolantSettings;rt?(it.endingStart=ZeroSlopeEnding,it.endingEnd=ZeroSlopeEnding):(_e?it.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:it.endingStart=WrapAroundEnding,et?it.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:it.endingEnd=WrapAroundEnding)}_scheduleFading(_e,et,rt){const it=this._mixer,st=it.time;let ot=this._weightInterpolant;ot===null&&(ot=it._lendControlInterpolant(),this._weightInterpolant=ot);const at=ot.parameterPositions,lt=ot.sampleValues;return at[0]=st,lt[0]=et,at[1]=st+_e,lt[1]=rt,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher$1{constructor(_e){super(),this._root=_e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_e,et){const rt=_e._localRoot||this._root,it=_e._clip.tracks,st=it.length,ot=_e._propertyBindings,at=_e._interpolants,lt=rt.uuid,ct=this._bindingsByRootAndName;let ut=ct[lt];ut===void 0&&(ut={},ct[lt]=ut);for(let ht=0;ht!==st;++ht){const dt=it[ht],ft=dt.name;let pt=ut[ft];if(pt!==void 0)++pt.referenceCount,ot[ht]=pt;else{if(pt=ot[ht],pt!==void 0){pt._cacheIndex===null&&(++pt.referenceCount,this._addInactiveBinding(pt,lt,ft));continue}const mt=et&&et._propertyBindings[ht].binding.parsedPath;pt=new PropertyMixer(PropertyBinding.create(rt,ft,mt),dt.ValueTypeName,dt.getValueSize()),++pt.referenceCount,this._addInactiveBinding(pt,lt,ft),ot[ht]=pt}at[ht].resultBuffer=pt.buffer}}_activateAction(_e){if(!this._isActiveAction(_e)){if(_e._cacheIndex===null){const rt=(_e._localRoot||this._root).uuid,it=_e._clip.uuid,st=this._actionsByClip[it];this._bindAction(_e,st&&st.knownActions[0]),this._addInactiveAction(_e,it,rt)}const et=_e._propertyBindings;for(let rt=0,it=et.length;rt!==it;++rt){const st=et[rt];st.useCount++===0&&(this._lendBinding(st),st.saveOriginalState())}this._lendAction(_e)}}_deactivateAction(_e){if(this._isActiveAction(_e)){const et=_e._propertyBindings;for(let rt=0,it=et.length;rt!==it;++rt){const st=et[rt];--st.useCount===0&&(st.restoreOriginalState(),this._takeBackBinding(st))}this._takeBackAction(_e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _e=this;this.stats={actions:{get total(){return _e._actions.length},get inUse(){return _e._nActiveActions}},bindings:{get total(){return _e._bindings.length},get inUse(){return _e._nActiveBindings}},controlInterpolants:{get total(){return _e._controlInterpolants.length},get inUse(){return _e._nActiveControlInterpolants}}}}_isActiveAction(_e){const et=_e._cacheIndex;return et!==null&&et<this._nActiveActions}_addInactiveAction(_e,et,rt){const it=this._actions,st=this._actionsByClip;let ot=st[et];if(ot===void 0)ot={knownActions:[_e],actionByRoot:{}},_e._byClipCacheIndex=0,st[et]=ot;else{const at=ot.knownActions;_e._byClipCacheIndex=at.length,at.push(_e)}_e._cacheIndex=it.length,it.push(_e),ot.actionByRoot[rt]=_e}_removeInactiveAction(_e){const et=this._actions,rt=et[et.length-1],it=_e._cacheIndex;rt._cacheIndex=it,et[it]=rt,et.pop(),_e._cacheIndex=null;const st=_e._clip.uuid,ot=this._actionsByClip,at=ot[st],lt=at.knownActions,ct=lt[lt.length-1],ut=_e._byClipCacheIndex;ct._byClipCacheIndex=ut,lt[ut]=ct,lt.pop(),_e._byClipCacheIndex=null;const ht=at.actionByRoot,dt=(_e._localRoot||this._root).uuid;delete ht[dt],lt.length===0&&delete ot[st],this._removeInactiveBindingsForAction(_e)}_removeInactiveBindingsForAction(_e){const et=_e._propertyBindings;for(let rt=0,it=et.length;rt!==it;++rt){const st=et[rt];--st.referenceCount===0&&this._removeInactiveBinding(st)}}_lendAction(_e){const et=this._actions,rt=_e._cacheIndex,it=this._nActiveActions++,st=et[it];_e._cacheIndex=it,et[it]=_e,st._cacheIndex=rt,et[rt]=st}_takeBackAction(_e){const et=this._actions,rt=_e._cacheIndex,it=--this._nActiveActions,st=et[it];_e._cacheIndex=it,et[it]=_e,st._cacheIndex=rt,et[rt]=st}_addInactiveBinding(_e,et,rt){const it=this._bindingsByRootAndName,st=this._bindings;let ot=it[et];ot===void 0&&(ot={},it[et]=ot),ot[rt]=_e,_e._cacheIndex=st.length,st.push(_e)}_removeInactiveBinding(_e){const et=this._bindings,rt=_e.binding,it=rt.rootNode.uuid,st=rt.path,ot=this._bindingsByRootAndName,at=ot[it],lt=et[et.length-1],ct=_e._cacheIndex;lt._cacheIndex=ct,et[ct]=lt,et.pop(),delete at[st],Object.keys(at).length===0&&delete ot[it]}_lendBinding(_e){const et=this._bindings,rt=_e._cacheIndex,it=this._nActiveBindings++,st=et[it];_e._cacheIndex=it,et[it]=_e,st._cacheIndex=rt,et[rt]=st}_takeBackBinding(_e){const et=this._bindings,rt=_e._cacheIndex,it=--this._nActiveBindings,st=et[it];_e._cacheIndex=it,et[it]=_e,st._cacheIndex=rt,et[rt]=st}_lendControlInterpolant(){const _e=this._controlInterpolants,et=this._nActiveControlInterpolants++;let rt=_e[et];return rt===void 0&&(rt=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),rt.__cacheIndex=et,_e[et]=rt),rt}_takeBackControlInterpolant(_e){const et=this._controlInterpolants,rt=_e.__cacheIndex,it=--this._nActiveControlInterpolants,st=et[it];_e.__cacheIndex=it,et[it]=_e,st.__cacheIndex=rt,et[rt]=st}clipAction(_e,et,rt){const it=et||this._root,st=it.uuid;let ot=typeof _e=="string"?AnimationClip.findByName(it,_e):_e;const at=ot!==null?ot.uuid:_e,lt=this._actionsByClip[at];let ct=null;if(rt===void 0&&(ot!==null?rt=ot.blendMode:rt=NormalAnimationBlendMode),lt!==void 0){const ht=lt.actionByRoot[st];if(ht!==void 0&&ht.blendMode===rt)return ht;ct=lt.knownActions[0],ot===null&&(ot=ct._clip)}if(ot===null)return null;const ut=new AnimationAction(this,ot,et,rt);return this._bindAction(ut,ct),this._addInactiveAction(ut,at,st),ut}existingAction(_e,et){const rt=et||this._root,it=rt.uuid,st=typeof _e=="string"?AnimationClip.findByName(rt,_e):_e,ot=st?st.uuid:_e,at=this._actionsByClip[ot];return at!==void 0&&at.actionByRoot[it]||null}stopAllAction(){const _e=this._actions,et=this._nActiveActions;for(let rt=et-1;rt>=0;--rt)_e[rt].stop();return this}update(_e){_e*=this.timeScale;const et=this._actions,rt=this._nActiveActions,it=this.time+=_e,st=Math.sign(_e),ot=this._accuIndex^=1;for(let ct=0;ct!==rt;++ct)et[ct]._update(it,_e,st,ot);const at=this._bindings,lt=this._nActiveBindings;for(let ct=0;ct!==lt;++ct)at[ct].apply(ot);return this}setTime(_e){this.time=0;for(let et=0;et<this._actions.length;et++)this._actions[et].time=0;return this.update(_e)}getRoot(){return this._root}uncacheClip(_e){const et=this._actions,rt=_e.uuid,it=this._actionsByClip,st=it[rt];if(st!==void 0){const ot=st.knownActions;for(let at=0,lt=ot.length;at!==lt;++at){const ct=ot[at];this._deactivateAction(ct);const ut=ct._cacheIndex,ht=et[et.length-1];ct._cacheIndex=null,ct._byClipCacheIndex=null,ht._cacheIndex=ut,et[ut]=ht,et.pop(),this._removeInactiveBindingsForAction(ct)}delete it[rt]}}uncacheRoot(_e){const et=_e.uuid,rt=this._actionsByClip;for(const ot in rt){const at=rt[ot].actionByRoot,lt=at[et];lt!==void 0&&(this._deactivateAction(lt),this._removeInactiveAction(lt))}const it=this._bindingsByRootAndName,st=it[et];if(st!==void 0)for(const ot in st){const at=st[ot];at.restoreOriginalState(),this._removeInactiveBinding(at)}}uncacheAction(_e,et){const rt=this.existingAction(_e,et);rt!==null&&(this._deactivateAction(rt),this._removeInactiveAction(rt))}}let Uniform$1=class b0{constructor(_e){this.value=_e}clone(){return new b0(this.value.clone===void 0?this.value:this.value.clone())}},_id$8=0,UniformsGroup$1=class extends EventDispatcher$1{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_id$8++}),this.name="",this.usage=StaticDrawUsage$1,this.uniforms=[]}add(_e){return this.uniforms.push(_e),this}remove(_e){const et=this.uniforms.indexOf(_e);return et!==-1&&this.uniforms.splice(et,1),this}setName(_e){return this.name=_e,this}setUsage(_e){return this.usage=_e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_e){this.name=_e.name,this.usage=_e.usage;const et=_e.uniforms;this.uniforms.length=0;for(let rt=0,it=et.length;rt<it;rt++){const st=Array.isArray(et[rt])?et[rt]:[et[rt]];for(let ot=0;ot<st.length;ot++)this.uniforms.push(st[ot].clone())}return this}clone(){return new this.constructor().copy(this)}},InstancedInterleavedBuffer$1=class extends InterleavedBuffer$1{constructor(_e,et,rt=1){super(_e,et),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=rt}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}clone(_e){const et=super.clone(_e);return et.meshPerAttribute=this.meshPerAttribute,et}toJSON(_e){const et=super.toJSON(_e);return et.isInstancedInterleavedBuffer=!0,et.meshPerAttribute=this.meshPerAttribute,et}};class GLBufferAttribute{constructor(_e,et,rt,it,st){this.isGLBufferAttribute=!0,this.name="",this.buffer=_e,this.type=et,this.itemSize=rt,this.elementSize=it,this.count=st,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}setBuffer(_e){return this.buffer=_e,this}setType(_e,et){return this.type=_e,this.elementSize=et,this}setItemSize(_e){return this.itemSize=_e,this}setCount(_e){return this.count=_e,this}}const _matrix=new Matrix4$1;class Raycaster{constructor(_e,et,rt=0,it=1/0){this.ray=new Ray$1(_e,et),this.near=rt,this.far=it,this.camera=null,this.layers=new Layers$1,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_e,et){this.ray.set(_e,et)}setFromCamera(_e,et){et.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(et.matrixWorld),this.ray.direction.set(_e.x,_e.y,.5).unproject(et).sub(this.ray.origin).normalize(),this.camera=et):et.isOrthographicCamera?(this.ray.origin.set(_e.x,_e.y,(et.near+et.far)/(et.near-et.far)).unproject(et),this.ray.direction.set(0,0,-1).transformDirection(et.matrixWorld),this.camera=et):console.error("THREE.Raycaster: Unsupported camera type: "+et.type)}setFromXRController(_e){return _matrix.identity().extractRotation(_e.matrixWorld),this.ray.origin.setFromMatrixPosition(_e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_matrix),this}intersectObject(_e,et=!0,rt=[]){return intersect(_e,this,rt,et),rt.sort(ascSort),rt}intersectObjects(_e,et=!0,rt=[]){for(let it=0,st=_e.length;it<st;it++)intersect(_e[it],this,rt,et);return rt.sort(ascSort),rt}}function ascSort(nt,_e){return nt.distance-_e.distance}function intersect(nt,_e,et,rt){let it=!0;if(nt.layers.test(_e.layers)&&nt.raycast(_e,et)===!1&&(it=!1),it===!0&&rt===!0){const st=nt.children;for(let ot=0,at=st.length;ot<at;ot++)intersect(st[ot],_e,et,!0)}}class Spherical{constructor(_e=1,et=0,rt=0){return this.radius=_e,this.phi=et,this.theta=rt,this}set(_e,et,rt){return this.radius=_e,this.phi=et,this.theta=rt,this}copy(_e){return this.radius=_e.radius,this.phi=_e.phi,this.theta=_e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_e){return this.setFromCartesianCoords(_e.x,_e.y,_e.z)}setFromCartesianCoords(_e,et,rt){return this.radius=Math.sqrt(_e*_e+et*et+rt*rt),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_e,rt),this.phi=Math.acos(clamp$5(et/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_e=1,et=0,rt=0){return this.radius=_e,this.theta=et,this.y=rt,this}set(_e,et,rt){return this.radius=_e,this.theta=et,this.y=rt,this}copy(_e){return this.radius=_e.radius,this.theta=_e.theta,this.y=_e.y,this}setFromVector3(_e){return this.setFromCartesianCoords(_e.x,_e.y,_e.z)}setFromCartesianCoords(_e,et,rt){return this.radius=Math.sqrt(_e*_e+rt*rt),this.theta=Math.atan2(_e,rt),this.y=et,this}clone(){return new this.constructor().copy(this)}}class Matrix2{constructor(_e,et,rt,it){Matrix2.prototype.isMatrix2=!0,this.elements=[1,0,0,1],_e!==void 0&&this.set(_e,et,rt,it)}identity(){return this.set(1,0,0,1),this}fromArray(_e,et=0){for(let rt=0;rt<4;rt++)this.elements[rt]=_e[rt+et];return this}set(_e,et,rt,it){const st=this.elements;return st[0]=_e,st[2]=et,st[1]=rt,st[3]=it,this}}const _vector$4=new Vector2$1;class Box2{constructor(_e=new Vector2$1(1/0,1/0),et=new Vector2$1(-1/0,-1/0)){this.isBox2=!0,this.min=_e,this.max=et}set(_e,et){return this.min.copy(_e),this.max.copy(et),this}setFromPoints(_e){this.makeEmpty();for(let et=0,rt=_e.length;et<rt;et++)this.expandByPoint(_e[et]);return this}setFromCenterAndSize(_e,et){const rt=_vector$4.copy(et).multiplyScalar(.5);return this.min.copy(_e).sub(rt),this.max.copy(_e).add(rt),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_e){return this.isEmpty()?_e.set(0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}containsPoint(_e){return _e.x>=this.min.x&&_e.x<=this.max.x&&_e.y>=this.min.y&&_e.y<=this.max.y}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y}getParameter(_e,et){return et.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_e){return _e.max.x>=this.min.x&&_e.min.x<=this.max.x&&_e.max.y>=this.min.y&&_e.min.y<=this.max.y}clampPoint(_e,et){return et.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$4).distanceTo(_e)}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}}const _startP=new Vector3$1,_startEnd=new Vector3$1;class Line3{constructor(_e=new Vector3$1,et=new Vector3$1){this.start=_e,this.end=et}set(_e,et){return this.start.copy(_e),this.end.copy(et),this}copy(_e){return this.start.copy(_e.start),this.end.copy(_e.end),this}getCenter(_e){return _e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_e){return _e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_e,et){return this.delta(et).multiplyScalar(_e).add(this.start)}closestPointToPointParameter(_e,et){_startP.subVectors(_e,this.start),_startEnd.subVectors(this.end,this.start);const rt=_startEnd.dot(_startEnd);let st=_startEnd.dot(_startP)/rt;return et&&(st=clamp$5(st,0,1)),st}closestPointToPoint(_e,et,rt){const it=this.closestPointToPointParameter(_e,et);return this.delta(rt).multiplyScalar(it).add(this.start)}applyMatrix4(_e){return this.start.applyMatrix4(_e),this.end.applyMatrix4(_e),this}equals(_e){return _e.start.equals(this.start)&&_e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3$1;class SpotLightHelper extends Object3D$1{constructor(_e,et){super(),this.light=_e,this.matrixAutoUpdate=!1,this.color=et,this.type="SpotLightHelper";const rt=new BufferGeometry$1,it=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let ot=0,at=1,lt=32;ot<lt;ot++,at++){const ct=ot/lt*Math.PI*2,ut=at/lt*Math.PI*2;it.push(Math.cos(ct),Math.sin(ct),1,Math.cos(ut),Math.sin(ut),1)}rt.setAttribute("position",new Float32BufferAttribute$1(it,3));const st=new LineBasicMaterial$1({fog:!1,toneMapped:!1});this.cone=new LineSegments(rt,st),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const _e=this.light.distance?this.light.distance:1e3,et=_e*Math.tan(this.light.angle);this.cone.scale.set(et,et,_e),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3$1,_boneMatrix=new Matrix4$1,_matrixWorldInv=new Matrix4$1;class SkeletonHelper extends LineSegments{constructor(_e){const et=getBoneList(_e),rt=new BufferGeometry$1,it=[],st=[],ot=new Color$2(0,0,1),at=new Color$2(0,1,0);for(let ct=0;ct<et.length;ct++){const ut=et[ct];ut.parent&&ut.parent.isBone&&(it.push(0,0,0),it.push(0,0,0),st.push(ot.r,ot.g,ot.b),st.push(at.r,at.g,at.b))}rt.setAttribute("position",new Float32BufferAttribute$1(it,3)),rt.setAttribute("color",new Float32BufferAttribute$1(st,3));const lt=new LineBasicMaterial$1({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(rt,lt),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_e,this.bones=et,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_e){const et=this.bones,rt=this.geometry,it=rt.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let st=0,ot=0;st<et.length;st++){const at=et[st];at.parent&&at.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,at.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),it.setXYZ(ot,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,at.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),it.setXYZ(ot+1,_vector$2.x,_vector$2.y,_vector$2.z),ot+=2)}rt.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(nt){const _e=[];nt.isBone===!0&&_e.push(nt);for(let et=0;et<nt.children.length;et++)_e.push.apply(_e,getBoneList(nt.children[et]));return _e}class PointLightHelper extends Mesh$1{constructor(_e,et,rt){const it=new SphereGeometry$1(et,4,2),st=new MeshBasicMaterial$1({wireframe:!0,fog:!1,toneMapped:!1});super(it,st),this.light=_e,this.color=rt,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1$1=new Vector3$1,_color1=new Color$2,_color2=new Color$2;class HemisphereLightHelper extends Object3D$1{constructor(_e,et,rt){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=rt,this.type="HemisphereLightHelper";const it=new OctahedronGeometry(et);it.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial$1({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const st=it.getAttribute("position"),ot=new Float32Array(st.count*3);it.setAttribute("color",new BufferAttribute$1(ot,3)),this.add(new Mesh$1(it,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const et=_e.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let rt=0,it=et.count;rt<it;rt++){const st=rt<it/2?_color1:_color2;et.setXYZ(rt,st.r,st.g,st.b)}et.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_e.lookAt(_vector$1$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_e=10,et=10,rt=4473924,it=8947848){rt=new Color$2(rt),it=new Color$2(it);const st=et/2,ot=_e/et,at=_e/2,lt=[],ct=[];for(let dt=0,ft=0,pt=-at;dt<=et;dt++,pt+=ot){lt.push(-at,0,pt,at,0,pt),lt.push(pt,0,-at,pt,0,at);const mt=dt===st?rt:it;mt.toArray(ct,ft),ft+=3,mt.toArray(ct,ft),ft+=3,mt.toArray(ct,ft),ft+=3,mt.toArray(ct,ft),ft+=3}const ut=new BufferGeometry$1;ut.setAttribute("position",new Float32BufferAttribute$1(lt,3)),ut.setAttribute("color",new Float32BufferAttribute$1(ct,3));const ht=new LineBasicMaterial$1({vertexColors:!0,toneMapped:!1});super(ut,ht),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_e=10,et=16,rt=8,it=64,st=4473924,ot=8947848){st=new Color$2(st),ot=new Color$2(ot);const at=[],lt=[];if(et>1)for(let ht=0;ht<et;ht++){const dt=ht/et*(Math.PI*2),ft=Math.sin(dt)*_e,pt=Math.cos(dt)*_e;at.push(0,0,0),at.push(ft,0,pt);const mt=ht&1?st:ot;lt.push(mt.r,mt.g,mt.b),lt.push(mt.r,mt.g,mt.b)}for(let ht=0;ht<rt;ht++){const dt=ht&1?st:ot,ft=_e-_e/rt*ht;for(let pt=0;pt<it;pt++){let mt=pt/it*(Math.PI*2),At=Math.sin(mt)*ft,gt=Math.cos(mt)*ft;at.push(At,0,gt),lt.push(dt.r,dt.g,dt.b),mt=(pt+1)/it*(Math.PI*2),At=Math.sin(mt)*ft,gt=Math.cos(mt)*ft,at.push(At,0,gt),lt.push(dt.r,dt.g,dt.b)}}const ct=new BufferGeometry$1;ct.setAttribute("position",new Float32BufferAttribute$1(at,3)),ct.setAttribute("color",new Float32BufferAttribute$1(lt,3));const ut=new LineBasicMaterial$1({vertexColors:!0,toneMapped:!1});super(ct,ut),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3$1,_v2$5=new Vector3$1,_v3=new Vector3$1;class DirectionalLightHelper extends Object3D$1{constructor(_e,et,rt){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=rt,this.type="DirectionalLightHelper",et===void 0&&(et=1);let it=new BufferGeometry$1;it.setAttribute("position",new Float32BufferAttribute$1([-et,et,0,et,et,0,et,-et,0,-et,-et,0,-et,et,0],3));const st=new LineBasicMaterial$1({fog:!1,toneMapped:!1});this.lightPlane=new Line(it,st),this.add(this.lightPlane),it=new BufferGeometry$1,it.setAttribute("position",new Float32BufferAttribute$1([0,0,0,0,0,1],3)),this.targetLine=new Line(it,st),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2$5.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2$5,_v1),this.lightPlane.lookAt(_v2$5),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2$5),this.targetLine.scale.z=_v3.length()}}const _vector$d=new Vector3$1,_camera$2=new Camera$1;class CameraHelper extends LineSegments{constructor(_e){const et=new BufferGeometry$1,rt=new LineBasicMaterial$1({color:16777215,vertexColors:!0,toneMapped:!1}),it=[],st=[],ot={};at("n1","n2"),at("n2","n4"),at("n4","n3"),at("n3","n1"),at("f1","f2"),at("f2","f4"),at("f4","f3"),at("f3","f1"),at("n1","f1"),at("n2","f2"),at("n3","f3"),at("n4","f4"),at("p","n1"),at("p","n2"),at("p","n3"),at("p","n4"),at("u1","u2"),at("u2","u3"),at("u3","u1"),at("c","t"),at("p","c"),at("cn1","cn2"),at("cn3","cn4"),at("cf1","cf2"),at("cf3","cf4");function at(pt,mt){lt(pt),lt(mt)}function lt(pt){it.push(0,0,0),st.push(0,0,0),ot[pt]===void 0&&(ot[pt]=[]),ot[pt].push(it.length/3-1)}et.setAttribute("position",new Float32BufferAttribute$1(it,3)),et.setAttribute("color",new Float32BufferAttribute$1(st,3)),super(et,rt),this.type="CameraHelper",this.camera=_e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=ot,this.update();const ct=new Color$2(16755200),ut=new Color$2(16711680),ht=new Color$2(43775),dt=new Color$2(16777215),ft=new Color$2(3355443);this.setColors(ct,ut,ht,dt,ft)}setColors(_e,et,rt,it,st){const at=this.geometry.getAttribute("color");at.setXYZ(0,_e.r,_e.g,_e.b),at.setXYZ(1,_e.r,_e.g,_e.b),at.setXYZ(2,_e.r,_e.g,_e.b),at.setXYZ(3,_e.r,_e.g,_e.b),at.setXYZ(4,_e.r,_e.g,_e.b),at.setXYZ(5,_e.r,_e.g,_e.b),at.setXYZ(6,_e.r,_e.g,_e.b),at.setXYZ(7,_e.r,_e.g,_e.b),at.setXYZ(8,_e.r,_e.g,_e.b),at.setXYZ(9,_e.r,_e.g,_e.b),at.setXYZ(10,_e.r,_e.g,_e.b),at.setXYZ(11,_e.r,_e.g,_e.b),at.setXYZ(12,_e.r,_e.g,_e.b),at.setXYZ(13,_e.r,_e.g,_e.b),at.setXYZ(14,_e.r,_e.g,_e.b),at.setXYZ(15,_e.r,_e.g,_e.b),at.setXYZ(16,_e.r,_e.g,_e.b),at.setXYZ(17,_e.r,_e.g,_e.b),at.setXYZ(18,_e.r,_e.g,_e.b),at.setXYZ(19,_e.r,_e.g,_e.b),at.setXYZ(20,_e.r,_e.g,_e.b),at.setXYZ(21,_e.r,_e.g,_e.b),at.setXYZ(22,_e.r,_e.g,_e.b),at.setXYZ(23,_e.r,_e.g,_e.b),at.setXYZ(24,et.r,et.g,et.b),at.setXYZ(25,et.r,et.g,et.b),at.setXYZ(26,et.r,et.g,et.b),at.setXYZ(27,et.r,et.g,et.b),at.setXYZ(28,et.r,et.g,et.b),at.setXYZ(29,et.r,et.g,et.b),at.setXYZ(30,et.r,et.g,et.b),at.setXYZ(31,et.r,et.g,et.b),at.setXYZ(32,rt.r,rt.g,rt.b),at.setXYZ(33,rt.r,rt.g,rt.b),at.setXYZ(34,rt.r,rt.g,rt.b),at.setXYZ(35,rt.r,rt.g,rt.b),at.setXYZ(36,rt.r,rt.g,rt.b),at.setXYZ(37,rt.r,rt.g,rt.b),at.setXYZ(38,it.r,it.g,it.b),at.setXYZ(39,it.r,it.g,it.b),at.setXYZ(40,st.r,st.g,st.b),at.setXYZ(41,st.r,st.g,st.b),at.setXYZ(42,st.r,st.g,st.b),at.setXYZ(43,st.r,st.g,st.b),at.setXYZ(44,st.r,st.g,st.b),at.setXYZ(45,st.r,st.g,st.b),at.setXYZ(46,st.r,st.g,st.b),at.setXYZ(47,st.r,st.g,st.b),at.setXYZ(48,st.r,st.g,st.b),at.setXYZ(49,st.r,st.g,st.b),at.needsUpdate=!0}update(){const _e=this.geometry,et=this.pointMap,rt=1,it=1;_camera$2.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",et,_e,_camera$2,0,0,-1),setPoint("t",et,_e,_camera$2,0,0,1),setPoint("n1",et,_e,_camera$2,-rt,-it,-1),setPoint("n2",et,_e,_camera$2,rt,-it,-1),setPoint("n3",et,_e,_camera$2,-rt,it,-1),setPoint("n4",et,_e,_camera$2,rt,it,-1),setPoint("f1",et,_e,_camera$2,-rt,-it,1),setPoint("f2",et,_e,_camera$2,rt,-it,1),setPoint("f3",et,_e,_camera$2,-rt,it,1),setPoint("f4",et,_e,_camera$2,rt,it,1),setPoint("u1",et,_e,_camera$2,rt*.7,it*1.1,-1),setPoint("u2",et,_e,_camera$2,-rt*.7,it*1.1,-1),setPoint("u3",et,_e,_camera$2,0,it*2,-1),setPoint("cf1",et,_e,_camera$2,-rt,0,1),setPoint("cf2",et,_e,_camera$2,rt,0,1),setPoint("cf3",et,_e,_camera$2,0,-it,1),setPoint("cf4",et,_e,_camera$2,0,it,1),setPoint("cn1",et,_e,_camera$2,-rt,0,-1),setPoint("cn2",et,_e,_camera$2,rt,0,-1),setPoint("cn3",et,_e,_camera$2,0,-it,-1),setPoint("cn4",et,_e,_camera$2,0,it,-1),_e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(nt,_e,et,rt,it,st,ot){_vector$d.set(it,st,ot).unproject(rt);const at=_e[nt];if(at!==void 0){const lt=et.getAttribute("position");for(let ct=0,ut=at.length;ct<ut;ct++)lt.setXYZ(at[ct],_vector$d.x,_vector$d.y,_vector$d.z)}}const _box$5=new Box3$1;class BoxHelper extends LineSegments{constructor(_e,et=16776960){const rt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),it=new Float32Array(8*3),st=new BufferGeometry$1;st.setIndex(new BufferAttribute$1(rt,1)),st.setAttribute("position",new BufferAttribute$1(it,3)),super(st,new LineBasicMaterial$1({color:et,toneMapped:!1})),this.object=_e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_e){if(_e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box$5.setFromObject(this.object),_box$5.isEmpty())return;const et=_box$5.min,rt=_box$5.max,it=this.geometry.attributes.position,st=it.array;st[0]=rt.x,st[1]=rt.y,st[2]=rt.z,st[3]=et.x,st[4]=rt.y,st[5]=rt.z,st[6]=et.x,st[7]=et.y,st[8]=rt.z,st[9]=rt.x,st[10]=et.y,st[11]=rt.z,st[12]=rt.x,st[13]=rt.y,st[14]=et.z,st[15]=et.x,st[16]=rt.y,st[17]=et.z,st[18]=et.x,st[19]=et.y,st[20]=et.z,st[21]=rt.x,st[22]=et.y,st[23]=et.z,it.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_e){return this.object=_e,this.update(),this}copy(_e,et){return super.copy(_e,et),this.object=_e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_e,et=16776960){const rt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),it=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],st=new BufferGeometry$1;st.setIndex(new BufferAttribute$1(rt,1)),st.setAttribute("position",new Float32BufferAttribute$1(it,3)),super(st,new LineBasicMaterial$1({color:et,toneMapped:!1})),this.box=_e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_e){const et=this.box;et.isEmpty()||(et.getCenter(this.position),et.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(_e,et=1,rt=16776960){const it=rt,st=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],ot=new BufferGeometry$1;ot.setAttribute("position",new Float32BufferAttribute$1(st,3)),ot.computeBoundingSphere(),super(ot,new LineBasicMaterial$1({color:it,toneMapped:!1})),this.type="PlaneHelper",this.plane=_e,this.size=et;const at=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],lt=new BufferGeometry$1;lt.setAttribute("position",new Float32BufferAttribute$1(at,3)),lt.computeBoundingSphere(),this.add(new Mesh$1(lt,new MeshBasicMaterial$1({color:it,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis$1=new Vector3$1;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D$1{constructor(_e=new Vector3$1(0,0,1),et=new Vector3$1(0,0,0),rt=1,it=16776960,st=rt*.2,ot=st*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry$1,_lineGeometry.setAttribute("position",new Float32BufferAttribute$1([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(et),this.line=new Line(_lineGeometry,new LineBasicMaterial$1({color:it,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh$1(_coneGeometry,new MeshBasicMaterial$1({color:it,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_e),this.setLength(rt,st,ot)}setDirection(_e){if(_e.y>.99999)this.quaternion.set(0,0,0,1);else if(_e.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis$1.set(_e.z,0,-_e.x).normalize();const et=Math.acos(_e.y);this.quaternion.setFromAxisAngle(_axis$1,et)}}setLength(_e,et=_e*.2,rt=et*.2){this.line.scale.set(1,Math.max(1e-4,_e-et),1),this.line.updateMatrix(),this.cone.scale.set(rt,et,rt),this.cone.position.y=_e,this.cone.updateMatrix()}setColor(_e){this.line.material.color.set(_e),this.cone.material.color.set(_e)}copy(_e){return super.copy(_e,!1),this.line.copy(_e.line),this.cone.copy(_e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_e=1){const et=[0,0,0,_e,0,0,0,0,0,0,_e,0,0,0,0,0,0,_e],rt=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],it=new BufferGeometry$1;it.setAttribute("position",new Float32BufferAttribute$1(et,3)),it.setAttribute("color",new Float32BufferAttribute$1(rt,3));const st=new LineBasicMaterial$1({vertexColors:!0,toneMapped:!1});super(it,st),this.type="AxesHelper"}setColors(_e,et,rt){const it=new Color$2,st=this.geometry.attributes.color.array;return it.set(_e),it.toArray(st,0),it.toArray(st,3),it.set(et),it.toArray(st,6),it.toArray(st,9),it.set(rt),it.toArray(st,12),it.toArray(st,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color$2,this.subPaths=[],this.currentPath=null}moveTo(_e,et){return this.currentPath=new Path$1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_e,et),this}lineTo(_e,et){return this.currentPath.lineTo(_e,et),this}quadraticCurveTo(_e,et,rt,it){return this.currentPath.quadraticCurveTo(_e,et,rt,it),this}bezierCurveTo(_e,et,rt,it,st,ot){return this.currentPath.bezierCurveTo(_e,et,rt,it,st,ot),this}splineThru(_e){return this.currentPath.splineThru(_e),this}toShapes(_e){function et(gt){const bt=[];for(let Tt=0,wt=gt.length;Tt<wt;Tt++){const Rt=gt[Tt],It=new Shape;It.curves=Rt.curves,bt.push(It)}return bt}function rt(gt,bt){const Tt=bt.length;let wt=!1;for(let Rt=Tt-1,It=0;It<Tt;Rt=It++){let Lt=bt[Rt],$t=bt[It],kt=$t.x-Lt.x,Dt=$t.y-Lt.y;if(Math.abs(Dt)>Number.EPSILON){if(Dt<0&&(Lt=bt[It],kt=-kt,$t=bt[Rt],Dt=-Dt),gt.y<Lt.y||gt.y>$t.y)continue;if(gt.y===Lt.y){if(gt.x===Lt.x)return!0}else{const Ot=Dt*(gt.x-Lt.x)-kt*(gt.y-Lt.y);if(Ot===0)return!0;if(Ot<0)continue;wt=!wt}}else{if(gt.y!==Lt.y)continue;if($t.x<=gt.x&&gt.x<=Lt.x||Lt.x<=gt.x&&gt.x<=$t.x)return!0}}return wt}const it=ShapeUtils.isClockWise,st=this.subPaths;if(st.length===0)return[];let ot,at,lt;const ct=[];if(st.length===1)return at=st[0],lt=new Shape,lt.curves=at.curves,ct.push(lt),ct;let ut=!it(st[0].getPoints());ut=_e?!ut:ut;const ht=[],dt=[];let ft=[],pt=0,mt;dt[pt]=void 0,ft[pt]=[];for(let gt=0,bt=st.length;gt<bt;gt++)at=st[gt],mt=at.getPoints(),ot=it(mt),ot=_e?!ot:ot,ot?(!ut&&dt[pt]&&pt++,dt[pt]={s:new Shape,p:mt},dt[pt].s.curves=at.curves,ut&&pt++,ft[pt]=[]):ft[pt].push({h:at,p:mt[0]});if(!dt[0])return et(st);if(dt.length>1){let gt=!1,bt=0;for(let Tt=0,wt=dt.length;Tt<wt;Tt++)ht[Tt]=[];for(let Tt=0,wt=dt.length;Tt<wt;Tt++){const Rt=ft[Tt];for(let It=0;It<Rt.length;It++){const Lt=Rt[It];let $t=!0;for(let kt=0;kt<dt.length;kt++)rt(Lt.p,dt[kt].p)&&(Tt!==kt&&bt++,$t?($t=!1,ht[kt].push(Lt)):gt=!0);$t&&ht[Tt].push(Lt)}}bt>0&&gt===!1&&(ft=ht)}let At;for(let gt=0,bt=dt.length;gt<bt;gt++){lt=dt[gt].s,ct.push(lt),At=ft[gt];for(let Tt=0,wt=At.length;Tt<wt;Tt++)lt.holes.push(At[Tt].h)}return ct}}class Controls extends EventDispatcher$1{constructor(_e,et=null){super(),this.object=_e,this.domElement=et,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}class WebGLMultipleRenderTargets extends WebGLRenderTarget$1{constructor(_e=1,et=1,rt=1,it={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(_e,et,{...it,count:rt}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION$1}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION$1);const THREE$l=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:ACESFilmicToneMapping$1,AddEquation:AddEquation$1,AddOperation:AddOperation$1,AdditiveAnimationBlendMode,AdditiveBlending:AdditiveBlending$1,AgXToneMapping:AgXToneMapping$1,AlphaFormat:AlphaFormat$1,AlwaysCompare:AlwaysCompare$1,AlwaysDepth:AlwaysDepth$1,AlwaysStencilFunc:AlwaysStencilFunc$1,AmbientLight:AmbientLight$1,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide:BackSide$1,BasicDepthPacking,BasicShadowMap:BasicShadowMap$1,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3:Box3$1,Box3Helper,BoxGeometry:BoxGeometry$1,BoxHelper,BufferAttribute:BufferAttribute$1,BufferGeometry:BufferGeometry$1,BufferGeometryLoader,ByteType:ByteType$1,Cache,Camera:Camera$1,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping:CineonToneMapping$1,CircleGeometry,ClampToEdgeWrapping:ClampToEdgeWrapping$1,Clock,Color:Color$2,ColorKeyframeTrack,ColorManagement:ColorManagement$1,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,Controls,CubeCamera:CubeCamera$1,CubeReflectionMapping:CubeReflectionMapping$1,CubeRefractionMapping:CubeRefractionMapping$1,CubeTexture:CubeTexture$1,CubeTextureLoader,CubeUVReflectionMapping:CubeUVReflectionMapping$1,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack:CullFaceBack$1,CullFaceFront:CullFaceFront$1,CullFaceFrontBack,CullFaceNone:CullFaceNone$1,Curve,CurvePath,CustomBlending:CustomBlending$1,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture,DataArrayTexture:DataArrayTexture$1,DataTexture:DataTexture$1,DataTextureLoader,DataUtils,DecrementStencilOp:DecrementStencilOp$1,DecrementWrapStencilOp:DecrementWrapStencilOp$1,DefaultLoadingManager,DepthFormat:DepthFormat$1,DepthStencilFormat:DepthStencilFormat$1,DepthTexture:DepthTexture$1,DetachedBindMode,DirectionalLight:DirectionalLight$1,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace:DisplayP3ColorSpace$1,DodecahedronGeometry,DoubleSide:DoubleSide$1,DstAlphaFactor:DstAlphaFactor$1,DstColorFactor:DstColorFactor$1,DynamicCopyUsage,DynamicDrawUsage:DynamicDrawUsage$1,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare:EqualCompare$1,EqualDepth:EqualDepth$1,EqualStencilFunc:EqualStencilFunc$1,EquirectangularReflectionMapping:EquirectangularReflectionMapping$1,EquirectangularRefractionMapping:EquirectangularRefractionMapping$1,Euler:Euler$1,EventDispatcher:EventDispatcher$1,ExtrudeGeometry,FileLoader,Float16BufferAttribute:Float16BufferAttribute$1,Float32BufferAttribute:Float32BufferAttribute$1,FloatType:FloatType$1,Fog,FogExp2,FramebufferTexture:FramebufferTexture$1,FrontSide:FrontSide$1,Frustum:Frustum$1,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare:GreaterCompare$1,GreaterDepth:GreaterDepth$1,GreaterEqualCompare:GreaterEqualCompare$1,GreaterEqualDepth:GreaterEqualDepth$1,GreaterEqualStencilFunc:GreaterEqualStencilFunc$1,GreaterStencilFunc:GreaterStencilFunc$1,GridHelper,Group:Group$1,HalfFloatType:HalfFloatType$1,HemisphereLight:HemisphereLight$1,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils:ImageUtils$1,IncrementStencilOp:IncrementStencilOp$1,IncrementWrapStencilOp:IncrementWrapStencilOp$1,InstancedBufferAttribute:InstancedBufferAttribute$1,InstancedBufferGeometry,InstancedInterleavedBuffer:InstancedInterleavedBuffer$1,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType:IntType$1,InterleavedBuffer:InterleavedBuffer$1,InterleavedBufferAttribute:InterleavedBufferAttribute$1,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp:InvertStencilOp$1,KeepStencilOp:KeepStencilOp$1,KeyframeTrack,LOD,LatheGeometry,Layers:Layers$1,LessCompare:LessCompare$1,LessDepth:LessDepth$1,LessEqualCompare:LessEqualCompare$1,LessEqualDepth:LessEqualDepth$1,LessEqualStencilFunc:LessEqualStencilFunc$1,LessStencilFunc:LessStencilFunc$1,Light:Light$1,LightProbe:LightProbe$1,Line,Line3,LineBasicMaterial:LineBasicMaterial$1,LineCurve,LineCurve3,LineDashedMaterial:LineDashedMaterial$1,LineLoop,LineSegments,LinearDisplayP3ColorSpace:LinearDisplayP3ColorSpace$1,LinearFilter:LinearFilter$1,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter:LinearMipmapLinearFilter$1,LinearMipmapNearestFilter:LinearMipmapNearestFilter$1,LinearSRGBColorSpace:LinearSRGBColorSpace$2,LinearToneMapping:LinearToneMapping$1,LinearTransfer:LinearTransfer$1,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat:LuminanceAlphaFormat$1,LuminanceFormat:LuminanceFormat$1,MOUSE,Material:Material$1,MaterialLoader,MathUtils:MathUtils$1,Matrix2,Matrix3:Matrix3$1,Matrix4:Matrix4$1,MaxEquation:MaxEquation$1,Mesh:Mesh$1,MeshBasicMaterial:MeshBasicMaterial$1,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial:MeshLambertMaterial$1,MeshMatcapMaterial:MeshMatcapMaterial$1,MeshNormalMaterial:MeshNormalMaterial$1,MeshPhongMaterial:MeshPhongMaterial$1,MeshPhysicalMaterial:MeshPhysicalMaterial$1,MeshStandardMaterial:MeshStandardMaterial$1,MeshToonMaterial:MeshToonMaterial$1,MinEquation:MinEquation$1,MirroredRepeatWrapping:MirroredRepeatWrapping$1,MixOperation:MixOperation$1,MultiplyBlending:MultiplyBlending$1,MultiplyOperation:MultiplyOperation$1,NearestFilter:NearestFilter$1,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter:NearestMipmapLinearFilter$1,NearestMipmapNearestFilter:NearestMipmapNearestFilter$1,NeutralToneMapping:NeutralToneMapping$1,NeverCompare:NeverCompare$1,NeverDepth:NeverDepth$1,NeverStencilFunc:NeverStencilFunc$1,NoBlending:NoBlending$1,NoColorSpace:NoColorSpace$1,NoToneMapping:NoToneMapping$1,NormalAnimationBlendMode,NormalBlending:NormalBlending$1,NotEqualCompare:NotEqualCompare$1,NotEqualDepth:NotEqualDepth$1,NotEqualStencilFunc:NotEqualStencilFunc$1,NumberKeyframeTrack,Object3D:Object3D$1,ObjectLoader,ObjectSpaceNormalMap:ObjectSpaceNormalMap$1,OctahedronGeometry,OneFactor:OneFactor$1,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,OneMinusDstAlphaFactor:OneMinusDstAlphaFactor$1,OneMinusDstColorFactor:OneMinusDstColorFactor$1,OneMinusSrcAlphaFactor:OneMinusSrcAlphaFactor$1,OneMinusSrcColorFactor:OneMinusSrcColorFactor$1,OrthographicCamera:OrthographicCamera$1,P3Primaries:P3Primaries$1,PCFShadowMap:PCFShadowMap$2,PCFSoftShadowMap:PCFSoftShadowMap$1,PMREMGenerator:PMREMGenerator$1,Path:Path$1,PerspectiveCamera:PerspectiveCamera$2,Plane:Plane$1,PlaneGeometry,PlaneHelper,PointLight:PointLight$1,PointLightHelper,Points,PointsMaterial:PointsMaterial$1,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion:Quaternion$1,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format:RED_GREEN_RGTC2_Format$1,RED_RGTC1_Format:RED_RGTC1_Format$1,REVISION:REVISION$1,RGBADepthPacking,RGBAFormat:RGBAFormat$1,RGBAIntegerFormat:RGBAIntegerFormat$1,RGBA_ASTC_10x10_Format:RGBA_ASTC_10x10_Format$1,RGBA_ASTC_10x5_Format:RGBA_ASTC_10x5_Format$1,RGBA_ASTC_10x6_Format:RGBA_ASTC_10x6_Format$1,RGBA_ASTC_10x8_Format:RGBA_ASTC_10x8_Format$1,RGBA_ASTC_12x10_Format:RGBA_ASTC_12x10_Format$1,RGBA_ASTC_12x12_Format:RGBA_ASTC_12x12_Format$1,RGBA_ASTC_4x4_Format:RGBA_ASTC_4x4_Format$1,RGBA_ASTC_5x4_Format:RGBA_ASTC_5x4_Format$1,RGBA_ASTC_5x5_Format:RGBA_ASTC_5x5_Format$1,RGBA_ASTC_6x5_Format:RGBA_ASTC_6x5_Format$1,RGBA_ASTC_6x6_Format:RGBA_ASTC_6x6_Format$1,RGBA_ASTC_8x5_Format:RGBA_ASTC_8x5_Format$1,RGBA_ASTC_8x6_Format:RGBA_ASTC_8x6_Format$1,RGBA_ASTC_8x8_Format:RGBA_ASTC_8x8_Format$1,RGBA_BPTC_Format:RGBA_BPTC_Format$1,RGBA_ETC2_EAC_Format:RGBA_ETC2_EAC_Format$1,RGBA_PVRTC_2BPPV1_Format:RGBA_PVRTC_2BPPV1_Format$1,RGBA_PVRTC_4BPPV1_Format:RGBA_PVRTC_4BPPV1_Format$1,RGBA_S3TC_DXT1_Format:RGBA_S3TC_DXT1_Format$1,RGBA_S3TC_DXT3_Format:RGBA_S3TC_DXT3_Format$1,RGBA_S3TC_DXT5_Format:RGBA_S3TC_DXT5_Format$1,RGBDepthPacking,RGBFormat:RGBFormat$1,RGBIntegerFormat:RGBIntegerFormat$1,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format:RGB_ETC1_Format$1,RGB_ETC2_Format:RGB_ETC2_Format$1,RGB_PVRTC_2BPPV1_Format:RGB_PVRTC_2BPPV1_Format$1,RGB_PVRTC_4BPPV1_Format:RGB_PVRTC_4BPPV1_Format$1,RGB_S3TC_DXT1_Format:RGB_S3TC_DXT1_Format$1,RGDepthPacking,RGFormat:RGFormat$1,RGIntegerFormat:RGIntegerFormat$1,RawShaderMaterial,Ray:Ray$1,Raycaster,Rec709Primaries:Rec709Primaries$1,RectAreaLight:RectAreaLight$1,RedFormat:RedFormat$1,RedIntegerFormat:RedIntegerFormat$1,ReinhardToneMapping:ReinhardToneMapping$1,RenderTarget:RenderTarget$1,RepeatWrapping:RepeatWrapping$1,ReplaceStencilOp:ReplaceStencilOp$1,ReverseSubtractEquation:ReverseSubtractEquation$1,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format:SIGNED_RED_GREEN_RGTC2_Format$1,SIGNED_RED_RGTC1_Format:SIGNED_RED_RGTC1_Format$1,SRGBColorSpace:SRGBColorSpace$2,SRGBTransfer:SRGBTransfer$1,Scene:Scene$1,ShaderChunk,ShaderLib,ShaderMaterial:ShaderMaterial$1,ShadowMaterial:ShadowMaterial$1,Shape,ShapeGeometry,ShapePath,ShapeUtils,ShortType:ShortType$1,Skeleton,SkeletonHelper,SkinnedMesh,Source:Source$1,Sphere:Sphere$1,SphereGeometry:SphereGeometry$1,Spherical,SphericalHarmonics3:SphericalHarmonics3$1,SplineCurve,SpotLight:SpotLight$1,SpotLightHelper,Sprite,SpriteMaterial:SpriteMaterial$1,SrcAlphaFactor:SrcAlphaFactor$1,SrcAlphaSaturateFactor:SrcAlphaSaturateFactor$1,SrcColorFactor:SrcColorFactor$1,StaticCopyUsage,StaticDrawUsage:StaticDrawUsage$1,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation:SubtractEquation$1,SubtractiveBlending:SubtractiveBlending$1,TOUCH,TangentSpaceNormalMap:TangentSpaceNormalMap$1,TetrahedronGeometry,Texture:Texture$1,TextureLoader,TextureUtils,TorusGeometry,TorusKnotGeometry,Triangle:Triangle$1,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping:UVMapping$1,Uint16BufferAttribute:Uint16BufferAttribute$1,Uint32BufferAttribute:Uint32BufferAttribute$1,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform:Uniform$1,UniformsGroup:UniformsGroup$1,UniformsLib,UniformsUtils,UnsignedByteType:UnsignedByteType$1,UnsignedInt248Type:UnsignedInt248Type$1,UnsignedInt5999Type:UnsignedInt5999Type$1,UnsignedIntType:UnsignedIntType$1,UnsignedShort4444Type:UnsignedShort4444Type$1,UnsignedShort5551Type:UnsignedShort5551Type$1,UnsignedShortType:UnsignedShortType$1,VSMShadowMap:VSMShadowMap$1,Vector2:Vector2$1,Vector3:Vector3$1,Vector4:Vector4$1,VectorKeyframeTrack,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem:WebGLCoordinateSystem$1,WebGLCubeRenderTarget:WebGLCubeRenderTarget$1,WebGLMultipleRenderTargets,WebGLRenderTarget:WebGLRenderTarget$1,WebGLRenderer,WebGLUtils:WebGLUtils$1,WebGPUCoordinateSystem:WebGPUCoordinateSystem$1,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor:ZeroFactor$1,ZeroSlopeEnding,ZeroStencilOp:ZeroStencilOp$1,createCanvasElement:createCanvasElement$1},Symbol.toStringTag,{value:"Module"}));var constants$1={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants$1.exports=reactReconcilerConstants_production_min;var constantsExports=constants$1.exports;const isPromise$1=nt=>typeof nt=="object"&&typeof nt.then=="function",globalCache=[];function shallowEqualArrays(nt,_e,et=(rt,it)=>rt===it){if(nt===_e)return!0;if(!nt||!_e)return!1;const rt=nt.length;if(_e.length!==rt)return!1;for(let it=0;it<rt;it++)if(!et(nt[it],_e[it]))return!1;return!0}function query(nt,_e=null,et=!1,rt={}){_e===null&&(_e=[nt]);for(const st of globalCache)if(shallowEqualArrays(_e,st.keys,st.equal)){if(et)return;if(Object.prototype.hasOwnProperty.call(st,"error"))throw st.error;if(Object.prototype.hasOwnProperty.call(st,"response"))return rt.lifespan&&rt.lifespan>0&&(st.timeout&&clearTimeout(st.timeout),st.timeout=setTimeout(st.remove,rt.lifespan)),st.response;if(!et)throw st.promise}const it={keys:_e,equal:rt.equal,remove:()=>{const st=globalCache.indexOf(it);st!==-1&&globalCache.splice(st,1)},promise:(isPromise$1(nt)?nt:nt(..._e)).then(st=>{it.response=st,rt.lifespan&&rt.lifespan>0&&(it.timeout=setTimeout(it.remove,rt.lifespan))}).catch(st=>it.error=st)};if(globalCache.push(it),!et)throw it.promise}const suspend=(nt,_e,et)=>query(nt,_e,!1,et),preload=(nt,_e,et)=>void query(nt,_e,!0,et),clear=nt=>{if(nt===void 0||nt.length===0)globalCache.splice(0,globalCache.length);else{const _e=globalCache.find(et=>shallowEqualArrays(nt,et.keys,et.equal));_e&&_e.remove()}};var reactReconciler={exports:{}},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(nt){function _e(Gt,jt){var Kt=Gt.length;Gt.push(jt);e:for(;0<Kt;){var Jt=Kt-1>>>1,sn=Gt[Jt];if(0<it(sn,jt))Gt[Jt]=jt,Gt[Kt]=sn,Kt=Jt;else break e}}function et(Gt){return Gt.length===0?null:Gt[0]}function rt(Gt){if(Gt.length===0)return null;var jt=Gt[0],Kt=Gt.pop();if(Kt!==jt){Gt[0]=Kt;e:for(var Jt=0,sn=Gt.length,hn=sn>>>1;Jt<hn;){var an=2*(Jt+1)-1,pn=Gt[an],_n=an+1,yn=Gt[_n];if(0>it(pn,Kt))_n<sn&&0>it(yn,pn)?(Gt[Jt]=yn,Gt[_n]=Kt,Jt=_n):(Gt[Jt]=pn,Gt[an]=Kt,Jt=an);else if(_n<sn&&0>it(yn,Kt))Gt[Jt]=yn,Gt[_n]=Kt,Jt=_n;else break e}}return jt}function it(Gt,jt){var Kt=Gt.sortIndex-jt.sortIndex;return Kt!==0?Kt:Gt.id-jt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;nt.unstable_now=function(){return st.now()}}else{var ot=Date,at=ot.now();nt.unstable_now=function(){return ot.now()-at}}var lt=[],ct=[],ut=1,ht=null,dt=3,ft=!1,pt=!1,mt=!1,At=typeof setTimeout=="function"?setTimeout:null,gt=typeof clearTimeout=="function"?clearTimeout:null,bt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Tt(Gt){for(var jt=et(ct);jt!==null;){if(jt.callback===null)rt(ct);else if(jt.startTime<=Gt)rt(ct),jt.sortIndex=jt.expirationTime,_e(lt,jt);else break;jt=et(ct)}}function wt(Gt){if(mt=!1,Tt(Gt),!pt)if(et(lt)!==null)pt=!0,Zt(Rt);else{var jt=et(ct);jt!==null&&rn(wt,jt.startTime-Gt)}}function Rt(Gt,jt){pt=!1,mt&&(mt=!1,gt($t),$t=-1),ft=!0;var Kt=dt;try{for(Tt(jt),ht=et(lt);ht!==null&&(!(ht.expirationTime>jt)||Gt&&!Ot());){var Jt=ht.callback;if(typeof Jt=="function"){ht.callback=null,dt=ht.priorityLevel;var sn=Jt(ht.expirationTime<=jt);jt=nt.unstable_now(),typeof sn=="function"?ht.callback=sn:ht===et(lt)&&rt(lt),Tt(jt)}else rt(lt);ht=et(lt)}if(ht!==null)var hn=!0;else{var an=et(ct);an!==null&&rn(wt,an.startTime-jt),hn=!1}return hn}finally{ht=null,dt=Kt,ft=!1}}var It=!1,Lt=null,$t=-1,kt=5,Dt=-1;function Ot(){return!(nt.unstable_now()-Dt<kt)}function zt(){if(Lt!==null){var Gt=nt.unstable_now();Dt=Gt;var jt=!0;try{jt=Lt(!0,Gt)}finally{jt?Ht():(It=!1,Lt=null)}}else It=!1}var Ht;if(typeof bt=="function")Ht=function(){bt(zt)};else if(typeof MessageChannel<"u"){var Yt=new MessageChannel,Xt=Yt.port2;Yt.port1.onmessage=zt,Ht=function(){Xt.postMessage(null)}}else Ht=function(){At(zt,0)};function Zt(Gt){Lt=Gt,It||(It=!0,Ht())}function rn(Gt,jt){$t=At(function(){Gt(nt.unstable_now())},jt)}nt.unstable_IdlePriority=5,nt.unstable_ImmediatePriority=1,nt.unstable_LowPriority=4,nt.unstable_NormalPriority=3,nt.unstable_Profiling=null,nt.unstable_UserBlockingPriority=2,nt.unstable_cancelCallback=function(Gt){Gt.callback=null},nt.unstable_continueExecution=function(){pt||ft||(pt=!0,Zt(Rt))},nt.unstable_forceFrameRate=function(Gt){0>Gt||125<Gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<Gt?Math.floor(1e3/Gt):5},nt.unstable_getCurrentPriorityLevel=function(){return dt},nt.unstable_getFirstCallbackNode=function(){return et(lt)},nt.unstable_next=function(Gt){switch(dt){case 1:case 2:case 3:var jt=3;break;default:jt=dt}var Kt=dt;dt=jt;try{return Gt()}finally{dt=Kt}},nt.unstable_pauseExecution=function(){},nt.unstable_requestPaint=function(){},nt.unstable_runWithPriority=function(Gt,jt){switch(Gt){case 1:case 2:case 3:case 4:case 5:break;default:Gt=3}var Kt=dt;dt=Gt;try{return jt()}finally{dt=Kt}},nt.unstable_scheduleCallback=function(Gt,jt,Kt){var Jt=nt.unstable_now();switch(typeof Kt=="object"&&Kt!==null?(Kt=Kt.delay,Kt=typeof Kt=="number"&&0<Kt?Jt+Kt:Jt):Kt=Jt,Gt){case 1:var sn=-1;break;case 2:sn=250;break;case 5:sn=1073741823;break;case 4:sn=1e4;break;default:sn=5e3}return sn=Kt+sn,Gt={id:ut++,callback:jt,priorityLevel:Gt,startTime:Kt,expirationTime:sn,sortIndex:-1},Kt>Jt?(Gt.sortIndex=Kt,_e(ct,Gt),et(lt)===null&&Gt===et(ct)&&(mt?(gt($t),$t=-1):mt=!0,rn(wt,Kt-Jt))):(Gt.sortIndex=sn,_e(lt,Gt),pt||ft||(pt=!0,Zt(Rt))),Gt},nt.unstable_shouldYield=Ot,nt.unstable_wrapCallback=function(Gt){var jt=dt;return function(){var Kt=dt;dt=jt;try{return Gt.apply(this,arguments)}finally{dt=Kt}}}}(scheduler_production_min$1)),scheduler_production_min$1}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler$1.exports=requireScheduler_production_min()),scheduler$1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function(_e){var et={},rt=reactExports,it=requireScheduler(),st=Object.assign;function ot(St){for(var Et="https://reactjs.org/docs/error-decoder.html?invariant="+St,Bt=1;Bt<arguments.length;Bt++)Et+="&args[]="+encodeURIComponent(arguments[Bt]);return"Minified React error #"+St+"; visit "+Et+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var at=rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lt=Symbol.for("react.element"),ct=Symbol.for("react.portal"),ut=Symbol.for("react.fragment"),ht=Symbol.for("react.strict_mode"),dt=Symbol.for("react.profiler"),ft=Symbol.for("react.provider"),pt=Symbol.for("react.context"),mt=Symbol.for("react.forward_ref"),At=Symbol.for("react.suspense"),gt=Symbol.for("react.suspense_list"),bt=Symbol.for("react.memo"),Tt=Symbol.for("react.lazy"),wt=Symbol.for("react.offscreen"),Rt=Symbol.iterator;function It(St){return St===null||typeof St!="object"?null:(St=Rt&&St[Rt]||St["@@iterator"],typeof St=="function"?St:null)}function Lt(St){if(St==null)return null;if(typeof St=="function")return St.displayName||St.name||null;if(typeof St=="string")return St;switch(St){case ut:return"Fragment";case ct:return"Portal";case dt:return"Profiler";case ht:return"StrictMode";case At:return"Suspense";case gt:return"SuspenseList"}if(typeof St=="object")switch(St.$$typeof){case pt:return(St.displayName||"Context")+".Consumer";case ft:return(St._context.displayName||"Context")+".Provider";case mt:var Et=St.render;return St=St.displayName,St||(St=Et.displayName||Et.name||"",St=St!==""?"ForwardRef("+St+")":"ForwardRef"),St;case bt:return Et=St.displayName||null,Et!==null?Et:Lt(St.type)||"Memo";case Tt:Et=St._payload,St=St._init;try{return Lt(St(Et))}catch{}}return null}function $t(St){var Et=St.type;switch(St.tag){case 24:return"Cache";case 9:return(Et.displayName||"Context")+".Consumer";case 10:return(Et._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return St=Et.render,St=St.displayName||St.name||"",Et.displayName||(St!==""?"ForwardRef("+St+")":"ForwardRef");case 7:return"Fragment";case 5:return Et;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lt(Et);case 8:return Et===ht?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Et=="function")return Et.displayName||Et.name||null;if(typeof Et=="string")return Et}return null}function kt(St){var Et=St,Bt=St;if(St.alternate)for(;Et.return;)Et=Et.return;else{St=Et;do Et=St,Et.flags&4098&&(Bt=Et.return),St=Et.return;while(St)}return Et.tag===3?Bt:null}function Dt(St){if(kt(St)!==St)throw Error(ot(188))}function Ot(St){var Et=St.alternate;if(!Et){if(Et=kt(St),Et===null)throw Error(ot(188));return Et!==St?null:St}for(var Bt=St,Ut=Et;;){var Wt=Bt.return;if(Wt===null)break;var nn=Wt.alternate;if(nn===null){if(Ut=Wt.return,Ut!==null){Bt=Ut;continue}break}if(Wt.child===nn.child){for(nn=Wt.child;nn;){if(nn===Bt)return Dt(Wt),St;if(nn===Ut)return Dt(Wt),Et;nn=nn.sibling}throw Error(ot(188))}if(Bt.return!==Ut.return)Bt=Wt,Ut=nn;else{for(var xn=!1,On=Wt.child;On;){if(On===Bt){xn=!0,Bt=Wt,Ut=nn;break}if(On===Ut){xn=!0,Ut=Wt,Bt=nn;break}On=On.sibling}if(!xn){for(On=nn.child;On;){if(On===Bt){xn=!0,Bt=nn,Ut=Wt;break}if(On===Ut){xn=!0,Ut=nn,Bt=Wt;break}On=On.sibling}if(!xn)throw Error(ot(189))}}if(Bt.alternate!==Ut)throw Error(ot(190))}if(Bt.tag!==3)throw Error(ot(188));return Bt.stateNode.current===Bt?St:Et}function zt(St){return St=Ot(St),St!==null?Ht(St):null}function Ht(St){if(St.tag===5||St.tag===6)return St;for(St=St.child;St!==null;){var Et=Ht(St);if(Et!==null)return Et;St=St.sibling}return null}function Yt(St){if(St.tag===5||St.tag===6)return St;for(St=St.child;St!==null;){if(St.tag!==4){var Et=Yt(St);if(Et!==null)return Et}St=St.sibling}return null}var Xt=Array.isArray,Zt=_e.getPublicInstance,rn=_e.getRootHostContext,Gt=_e.getChildHostContext,jt=_e.prepareForCommit,Kt=_e.resetAfterCommit,Jt=_e.createInstance,sn=_e.appendInitialChild,hn=_e.finalizeInitialChildren,an=_e.prepareUpdate,pn=_e.shouldSetTextContent,_n=_e.createTextInstance,yn=_e.scheduleTimeout,$n=_e.cancelTimeout,Jn=_e.noTimeout,Xn=_e.isPrimaryRenderer,Vn=_e.supportsMutation,En=_e.supportsPersistence,dn=_e.supportsHydration,rr=_e.getInstanceFromNode,er=_e.preparePortalMount,Yn=_e.getCurrentEventPriority,ir=_e.detachDeletedInstance,Qn=_e.supportsMicrotasks,sr=_e.scheduleMicrotask,un=_e.supportsTestSelectors,en=_e.findFiberRoot,wn=_e.getBoundingRect,gn=_e.getTextContent,Mn=_e.isHiddenSubtree,In=_e.matchAccessibilityRole,gr=_e.setFocusIfFocusable,jn=_e.setupIntersectionObserver,hr=_e.appendChild,Tr=_e.appendChildToContainer,cr=_e.commitTextUpdate,yr=_e.commitMount,Rr=_e.commitUpdate,br=_e.insertBefore,pr=_e.insertInContainerBefore,vn=_e.removeChild,qn=_e.removeChildFromContainer,vr=_e.resetTextContent,Sn=_e.hideInstance,Ar=_e.hideTextInstance,Nn=_e.unhideInstance,nr=_e.unhideTextInstance,Ir=_e.clearContainer,Dn=_e.cloneInstance,Pr=_e.createContainerChildSet,jr=_e.appendChildToContainerChildSet,Jr=_e.finalizeContainerChildren,Lr=_e.replaceContainerChildren,Wr=_e.cloneHiddenInstance,As=_e.cloneHiddenTextInstance,ks=_e.canHydrateInstance,Ps=_e.canHydrateTextInstance,$s=_e.canHydrateSuspenseInstance,eo=_e.isSuspenseInstancePending,Us=_e.isSuspenseInstanceFallback,zn=_e.registerSuspenseInstanceRetry,lr=_e.getNextHydratableSibling,Sr=_e.getFirstHydratableChild,Or=_e.getFirstHydratableChildWithinContainer,xt=_e.getFirstHydratableChildWithinSuspenseInstance,mn=_e.hydrateInstance,os=_e.hydrateTextInstance,gs=_e.hydrateSuspenseInstance,Bs=_e.getNextHydratableInstanceAfterSuspenseInstance,ln=_e.commitHydratedContainer,Rn=_e.commitHydratedSuspenseInstance,Wn=_e.clearSuspenseBoundary,Un=_e.clearSuspenseBoundaryFromContainer,Cn=_e.shouldDeleteUnhydratedTailInstances,xr=_e.didNotMatchHydratedContainerTextInstance,Nr=_e.didNotMatchHydratedTextInstance,fr;function Fr(St){if(fr===void 0)try{throw Error()}catch(Bt){var Et=Bt.stack.trim().match(/\n( *(at )?)/);fr=Et&&Et[1]||""}return`
`+fr+St}var Gr=!1;function zr(St,Et){if(!St||Gr)return"";Gr=!0;var Bt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Et)if(Et=function(){throw Error()},Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(Mr){var Ut=Mr}Reflect.construct(St,[],Et)}else{try{Et.call()}catch(Mr){Ut=Mr}St.call(Et.prototype)}else{try{throw Error()}catch(Mr){Ut=Mr}St()}}catch(Mr){if(Mr&&Ut&&typeof Mr.stack=="string"){for(var Wt=Mr.stack.split(`
`),nn=Ut.stack.split(`
`),xn=Wt.length-1,On=nn.length-1;1<=xn&&0<=On&&Wt[xn]!==nn[On];)On--;for(;1<=xn&&0<=On;xn--,On--)if(Wt[xn]!==nn[On]){if(xn!==1||On!==1)do if(xn--,On--,0>On||Wt[xn]!==nn[On]){var dr=`
`+Wt[xn].replace(" at new "," at ");return St.displayName&&dr.includes("<anonymous>")&&(dr=dr.replace("<anonymous>",St.displayName)),dr}while(1<=xn&&0<=On);break}}}finally{Gr=!1,Error.prepareStackTrace=Bt}return(St=St?St.displayName||St.name:"")?Fr(St):""}var kr=Object.prototype.hasOwnProperty,ls=[],ds=-1;function ns(St){return{current:St}}function wr(St){0>ds||(St.current=ls[ds],ls[ds]=null,ds--)}function cn(St,Et){ds++,ls[ds]=St.current,St.current=Et}var mr={},cs=ns(mr),Xr=ns(!1),Gs=mr;function Ws(St,Et){var Bt=St.type.contextTypes;if(!Bt)return mr;var Ut=St.stateNode;if(Ut&&Ut.__reactInternalMemoizedUnmaskedChildContext===Et)return Ut.__reactInternalMemoizedMaskedChildContext;var Wt={},nn;for(nn in Bt)Wt[nn]=Et[nn];return Ut&&(St=St.stateNode,St.__reactInternalMemoizedUnmaskedChildContext=Et,St.__reactInternalMemoizedMaskedChildContext=Wt),Wt}function ys(St){return St=St.childContextTypes,St!=null}function fn(){wr(Xr),wr(cs)}function Ts(St,Et,Bt){if(cs.current!==mr)throw Error(ot(168));cn(cs,Et),cn(Xr,Bt)}function Ao(St,Et,Bt){var Ut=St.stateNode;if(Et=Et.childContextTypes,typeof Ut.getChildContext!="function")return Bt;Ut=Ut.getChildContext();for(var Wt in Ut)if(!(Wt in Et))throw Error(ot(108,$t(St)||"Unknown",Wt));return st({},Bt,Ut)}function Io(St){return St=(St=St.stateNode)&&St.__reactInternalMemoizedMergedChildContext||mr,Gs=cs.current,cn(cs,St),cn(Xr,Xr.current),!0}function ws(St,Et,Bt){var Ut=St.stateNode;if(!Ut)throw Error(ot(169));Bt?(St=Ao(St,Et,Gs),Ut.__reactInternalMemoizedMergedChildContext=St,wr(Xr),wr(cs),cn(cs,St)):wr(Xr),cn(Xr,Bt)}var to=Math.clz32?Math.clz32:Su,Pl=Math.log,Go=Math.LN2;function Su(St){return St>>>=0,St===0?32:31-(Pl(St)/Go|0)|0}var Wo=64,no=4194304;function Cs(St){switch(St&-St){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return St&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return St&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return St}}function $a(St,Et){var Bt=St.pendingLanes;if(Bt===0)return 0;var Ut=0,Wt=St.suspendedLanes,nn=St.pingedLanes,xn=Bt&268435455;if(xn!==0){var On=xn&~Wt;On!==0?Ut=Cs(On):(nn&=xn,nn!==0&&(Ut=Cs(nn)))}else xn=Bt&~Wt,xn!==0?Ut=Cs(xn):nn!==0&&(Ut=Cs(nn));if(Ut===0)return 0;if(Et!==0&&Et!==Ut&&!(Et&Wt)&&(Wt=Ut&-Ut,nn=Et&-Et,Wt>=nn||Wt===16&&(nn&4194240)!==0))return Et;if(Ut&4&&(Ut|=Bt&16),Et=St.entangledLanes,Et!==0)for(St=St.entanglements,Et&=Ut;0<Et;)Bt=31-to(Et),Wt=1<<Bt,Ut|=St[Bt],Et&=~Wt;return Ut}function Vu(St,Et){switch(St){case 1:case 2:case 4:return Et+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Et+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tu(St,Et){for(var Bt=St.suspendedLanes,Ut=St.pingedLanes,Wt=St.expirationTimes,nn=St.pendingLanes;0<nn;){var xn=31-to(nn),On=1<<xn,dr=Wt[xn];dr===-1?(!(On&Bt)||On&Ut)&&(Wt[xn]=Vu(On,Et)):dr<=Et&&(St.expiredLanes|=On),nn&=~On}}function Ko(St){return St=St.pendingLanes&-1073741825,St!==0?St:St&1073741824?1073741824:0}function _c(St){for(var Et=[],Bt=0;31>Bt;Bt++)Et.push(St);return Et}function Xo(St,Et,Bt){St.pendingLanes|=Et,Et!==536870912&&(St.suspendedLanes=0,St.pingedLanes=0),St=St.eventTimes,Et=31-to(Et),St[Et]=Bt}function Ll(St,Et){var Bt=St.pendingLanes&~Et;St.pendingLanes=Et,St.suspendedLanes=0,St.pingedLanes=0,St.expiredLanes&=Et,St.mutableReadLanes&=Et,St.entangledLanes&=Et,Et=St.entanglements;var Ut=St.eventTimes;for(St=St.expirationTimes;0<Bt;){var Wt=31-to(Bt),nn=1<<Wt;Et[Wt]=0,Ut[Wt]=-1,St[Wt]=-1,Bt&=~nn}}function ps(St,Et){var Bt=St.entangledLanes|=Et;for(St=St.entanglements;Bt;){var Ut=31-to(Bt),Wt=1<<Ut;Wt&Et|St[Ut]&Et&&(St[Ut]|=Et),Bt&=~Wt}}var as=0;function eu(St){return St&=-St,1<St?4<St?St&268435455?16:536870912:4:1}var Al=it.unstable_scheduleCallback,tu=it.unstable_cancelCallback,Eu=it.unstable_shouldYield,Mu=it.unstable_requestPaint,Ls=it.unstable_now,yl=it.unstable_ImmediatePriority,zu=it.unstable_UserBlockingPriority,go=it.unstable_NormalPriority,nu=it.unstable_IdlePriority,Il=null,xo=null;function wu(St){if(xo&&typeof xo.onCommitFiberRoot=="function")try{xo.onCommitFiberRoot(Il,St,void 0,(St.current.flags&128)===128)}catch{}}function Hu(St,Et){return St===Et&&(St!==0||1/St===1/Et)||St!==St&&Et!==Et}var Eo=typeof Object.is=="function"?Object.is:Hu,_s=null,oo=!1,Rs=!1;function Ul(St){_s===null?_s=[St]:_s.push(St)}function ru(St){oo=!0,Ul(St)}function ro(){if(!Rs&&_s!==null){Rs=!0;var St=0,Et=as;try{var Bt=_s;for(as=1;St<Bt.length;St++){var Ut=Bt[St];do Ut=Ut(!0);while(Ut!==null)}_s=null,oo=!1}catch(Wt){throw _s!==null&&(_s=_s.slice(St+1)),Al(yl,ro),Wt}finally{as=Et,Rs=!1}}return null}var Gl=at.ReactCurrentBatchConfig;function Vl(St,Et){if(Eo(St,Et))return!0;if(typeof St!="object"||St===null||typeof Et!="object"||Et===null)return!1;var Bt=Object.keys(St),Ut=Object.keys(Et);if(Bt.length!==Ut.length)return!1;for(Ut=0;Ut<Bt.length;Ut++){var Wt=Bt[Ut];if(!kr.call(Et,Wt)||!Eo(St[Wt],Et[Wt]))return!1}return!0}function zl(St){switch(St.tag){case 5:return Fr(St.type);case 16:return Fr("Lazy");case 13:return Fr("Suspense");case 19:return Fr("SuspenseList");case 0:case 2:case 15:return St=zr(St.type,!1),St;case 11:return St=zr(St.type.render,!1),St;case 1:return St=zr(St.type,!0),St;default:return""}}function ao(St,Et){if(St&&St.defaultProps){Et=st({},Et),St=St.defaultProps;for(var Bt in St)Et[Bt]===void 0&&(Et[Bt]=St[Bt]);return Et}return Et}var Hs=ns(null),Do=null,$o=null,xl=null;function _l(){xl=$o=Do=null}function Yo(St,Et,Bt){Xn?(cn(Hs,Et._currentValue),Et._currentValue=Bt):(cn(Hs,Et._currentValue2),Et._currentValue2=Bt)}function Is(St){var Et=Hs.current;wr(Hs),Xn?St._currentValue=Et:St._currentValue2=Et}function lo(St,Et,Bt){for(;St!==null;){var Ut=St.alternate;if((St.childLanes&Et)!==Et?(St.childLanes|=Et,Ut!==null&&(Ut.childLanes|=Et)):Ut!==null&&(Ut.childLanes&Et)!==Et&&(Ut.childLanes|=Et),St===Bt)break;St=St.return}}function Vs(St,Et){Do=St,xl=$o=null,St=St.dependencies,St!==null&&St.firstContext!==null&&(St.lanes&Et&&(Qs=!0),St.firstContext=null)}function Fs(St){var Et=Xn?St._currentValue:St._currentValue2;if(xl!==St)if(St={context:St,memoizedValue:Et,next:null},$o===null){if(Do===null)throw Error(ot(308));$o=St,Do.dependencies={lanes:0,firstContext:St}}else $o=$o.next=St;return Et}var Mo=null,Dl=!1;function ju(St){St.updateQueue={baseState:St.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ep(St,Et){St=St.updateQueue,Et.updateQueue===St&&(Et.updateQueue={baseState:St.baseState,firstBaseUpdate:St.firstBaseUpdate,lastBaseUpdate:St.lastBaseUpdate,shared:St.shared,effects:St.effects})}function Sl(St,Et){return{eventTime:St,lane:Et,tag:0,payload:null,callback:null,next:null}}function $l(St,Et){var Bt=St.updateQueue;Bt!==null&&(Bt=Bt.shared,Js!==null&&St.mode&1&&!(hs&2)?(St=Bt.interleaved,St===null?(Et.next=Et,Mo===null?Mo=[Bt]:Mo.push(Bt)):(Et.next=St.next,St.next=Et),Bt.interleaved=Et):(St=Bt.pending,St===null?Et.next=Et:(Et.next=St.next,St.next=Et),Bt.pending=Et))}function qu(St,Et,Bt){if(Et=Et.updateQueue,Et!==null&&(Et=Et.shared,(Bt&4194240)!==0)){var Ut=Et.lanes;Ut&=St.pendingLanes,Bt|=Ut,Et.lanes=Bt,ps(St,Bt)}}function Mp(St,Et){var Bt=St.updateQueue,Ut=St.alternate;if(Ut!==null&&(Ut=Ut.updateQueue,Bt===Ut)){var Wt=null,nn=null;if(Bt=Bt.firstBaseUpdate,Bt!==null){do{var xn={eventTime:Bt.eventTime,lane:Bt.lane,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null};nn===null?Wt=nn=xn:nn=nn.next=xn,Bt=Bt.next}while(Bt!==null);nn===null?Wt=nn=Et:nn=nn.next=Et}else Wt=nn=Et;Bt={baseState:Ut.baseState,firstBaseUpdate:Wt,lastBaseUpdate:nn,shared:Ut.shared,effects:Ut.effects},St.updateQueue=Bt;return}St=Bt.lastBaseUpdate,St===null?Bt.firstBaseUpdate=Et:St.next=Et,Bt.lastBaseUpdate=Et}function Wu(St,Et,Bt,Ut){var Wt=St.updateQueue;Dl=!1;var nn=Wt.firstBaseUpdate,xn=Wt.lastBaseUpdate,On=Wt.shared.pending;if(On!==null){Wt.shared.pending=null;var dr=On,Mr=dr.next;dr.next=null,xn===null?nn=Mr:xn.next=Mr,xn=dr;var Vr=St.alternate;Vr!==null&&(Vr=Vr.updateQueue,On=Vr.lastBaseUpdate,On!==xn&&(On===null?Vr.firstBaseUpdate=Mr:On.next=Mr,Vr.lastBaseUpdate=dr))}if(nn!==null){var rs=Wt.baseState;xn=0,Vr=Mr=dr=null,On=nn;do{var Kr=On.lane,Ds=On.eventTime;if((Ut&Kr)===Kr){Vr!==null&&(Vr=Vr.next={eventTime:Ds,lane:0,tag:On.tag,payload:On.payload,callback:On.callback,next:null});e:{var qr=St,To=On;switch(Kr=Et,Ds=Bt,To.tag){case 1:if(qr=To.payload,typeof qr=="function"){rs=qr.call(Ds,rs,Kr);break e}rs=qr;break e;case 3:qr.flags=qr.flags&-65537|128;case 0:if(qr=To.payload,Kr=typeof qr=="function"?qr.call(Ds,rs,Kr):qr,Kr==null)break e;rs=st({},rs,Kr);break e;case 2:Dl=!0}}On.callback!==null&&On.lane!==0&&(St.flags|=64,Kr=Wt.effects,Kr===null?Wt.effects=[On]:Kr.push(On))}else Ds={eventTime:Ds,lane:Kr,tag:On.tag,payload:On.payload,callback:On.callback,next:null},Vr===null?(Mr=Vr=Ds,dr=rs):Vr=Vr.next=Ds,xn|=Kr;if(On=On.next,On===null){if(On=Wt.shared.pending,On===null)break;Kr=On,On=Kr.next,Kr.next=null,Wt.lastBaseUpdate=Kr,Wt.shared.pending=null}}while(!0);if(Vr===null&&(dr=rs),Wt.baseState=dr,Wt.firstBaseUpdate=Mr,Wt.lastBaseUpdate=Vr,Et=Wt.shared.interleaved,Et!==null){Wt=Et;do xn|=Wt.lane,Wt=Wt.next;while(Wt!==Et)}else nn===null&&(Wt.shared.lanes=0);sp|=xn,St.lanes=xn,St.memoizedState=rs}}function wp(St,Et,Bt){if(St=Et.effects,Et.effects=null,St!==null)for(Et=0;Et<St.length;Et++){var Ut=St[Et],Wt=Ut.callback;if(Wt!==null){if(Ut.callback=null,Ut=Bt,typeof Wt!="function")throw Error(ot(191,Wt));Wt.call(Ut)}}}var Cp=new rt.Component().refs;function iu(St,Et,Bt,Ut){Et=St.memoizedState,Bt=Bt(Ut,Et),Bt=Bt==null?Et:st({},Et,Bt),St.memoizedState=Bt,St.lanes===0&&(St.updateQueue.baseState=Bt)}var Ku={isMounted:function(St){return(St=St._reactInternals)?kt(St)===St:!1},enqueueSetState:function(St,Et,Bt){St=St._reactInternals;var Ut=Lo(),Wt=vu(St),nn=Sl(Ut,Wt);nn.payload=Et,Bt!=null&&(nn.callback=Bt),$l(St,nn),Et=ga(St,Wt,Ut),Et!==null&&qu(Et,St,Wt)},enqueueReplaceState:function(St,Et,Bt){St=St._reactInternals;var Ut=Lo(),Wt=vu(St),nn=Sl(Ut,Wt);nn.tag=1,nn.payload=Et,Bt!=null&&(nn.callback=Bt),$l(St,nn),Et=ga(St,Wt,Ut),Et!==null&&qu(Et,St,Wt)},enqueueForceUpdate:function(St,Et){St=St._reactInternals;var Bt=Lo(),Ut=vu(St),Wt=Sl(Bt,Ut);Wt.tag=2,Et!=null&&(Wt.callback=Et),$l(St,Wt),Et=ga(St,Ut,Bt),Et!==null&&qu(Et,St,Ut)}};function Rp(St,Et,Bt,Ut,Wt,nn,xn){return St=St.stateNode,typeof St.shouldComponentUpdate=="function"?St.shouldComponentUpdate(Ut,nn,xn):Et.prototype&&Et.prototype.isPureReactComponent?!Vl(Bt,Ut)||!Vl(Wt,nn):!0}function Pp(St,Et,Bt){var Ut=!1,Wt=mr,nn=Et.contextType;return typeof nn=="object"&&nn!==null?nn=Fs(nn):(Wt=ys(Et)?Gs:cs.current,Ut=Et.contextTypes,nn=(Ut=Ut!=null)?Ws(St,Wt):mr),Et=new Et(Bt,nn),St.memoizedState=Et.state!==null&&Et.state!==void 0?Et.state:null,Et.updater=Ku,St.stateNode=Et,Et._reactInternals=St,Ut&&(St=St.stateNode,St.__reactInternalMemoizedUnmaskedChildContext=Wt,St.__reactInternalMemoizedMaskedChildContext=nn),Et}function su(St,Et,Bt,Ut){St=Et.state,typeof Et.componentWillReceiveProps=="function"&&Et.componentWillReceiveProps(Bt,Ut),typeof Et.UNSAFE_componentWillReceiveProps=="function"&&Et.UNSAFE_componentWillReceiveProps(Bt,Ut),Et.state!==St&&Ku.enqueueReplaceState(Et,Et.state,null)}function lp(St,Et,Bt,Ut){var Wt=St.stateNode;Wt.props=Bt,Wt.state=St.memoizedState,Wt.refs=Cp,ju(St);var nn=Et.contextType;typeof nn=="object"&&nn!==null?Wt.context=Fs(nn):(nn=ys(Et)?Gs:cs.current,Wt.context=Ws(St,nn)),Wt.state=St.memoizedState,nn=Et.getDerivedStateFromProps,typeof nn=="function"&&(iu(St,Et,nn,Bt),Wt.state=St.memoizedState),typeof Et.getDerivedStateFromProps=="function"||typeof Wt.getSnapshotBeforeUpdate=="function"||typeof Wt.UNSAFE_componentWillMount!="function"&&typeof Wt.componentWillMount!="function"||(Et=Wt.state,typeof Wt.componentWillMount=="function"&&Wt.componentWillMount(),typeof Wt.UNSAFE_componentWillMount=="function"&&Wt.UNSAFE_componentWillMount(),Et!==Wt.state&&Ku.enqueueReplaceState(Wt,Wt.state,null),Wu(St,Bt,Wt,Ut),Wt.state=St.memoizedState),typeof Wt.componentDidMount=="function"&&(St.flags|=4194308)}var Nl=[],Hl=0,Tl=null,Xu=0,_o=[],wo=0,Wl=null,Qo=1,Vo="";function El(St,Et){Nl[Hl++]=Xu,Nl[Hl++]=Tl,Tl=St,Xu=Et}function Cu(St,Et,Bt){_o[wo++]=Qo,_o[wo++]=Vo,_o[wo++]=Wl,Wl=St;var Ut=Qo;St=Vo;var Wt=32-to(Ut)-1;Ut&=~(1<<Wt),Bt+=1;var nn=32-to(Et)+Wt;if(30<nn){var xn=Wt-Wt%5;nn=(Ut&(1<<xn)-1).toString(32),Ut>>=xn,Wt-=xn,Qo=1<<32-to(Et)+Wt|Bt<<Wt|Ut,Vo=nn+St}else Qo=1<<nn|Bt<<Wt|Ut,Vo=St}function Es(St){St.return!==null&&(El(St,1),Cu(St,1,0))}function cp(St){for(;St===Tl;)Tl=Nl[--Hl],Nl[Hl]=null,Xu=Nl[--Hl],Nl[Hl]=null;for(;St===Wl;)Wl=_o[--wo],_o[wo]=null,Vo=_o[--wo],_o[wo]=null,Qo=_o[--wo],_o[wo]=null}var Co=null,Ro=null,Ns=!1,Ru=!1,zo=null;function Lp(St,Et){var Bt=xa(5,null,null,0);Bt.elementType="DELETED",Bt.stateNode=Et,Bt.return=St,Et=St.deletions,Et===null?(St.deletions=[Bt],St.flags|=16):Et.push(Bt)}function yo(St,Et){switch(St.tag){case 5:return Et=ks(Et,St.type,St.pendingProps),Et!==null?(St.stateNode=Et,Co=St,Ro=Sr(Et),!0):!1;case 6:return Et=Ps(Et,St.pendingProps),Et!==null?(St.stateNode=Et,Co=St,Ro=null,!0):!1;case 13:if(Et=$s(Et),Et!==null){var Bt=Wl!==null?{id:Qo,overflow:Vo}:null;return St.memoizedState={dehydrated:Et,treeContext:Bt,retryLane:1073741824},Bt=xa(18,null,null,0),Bt.stateNode=Et,Bt.return=St,St.child=Bt,Co=St,Ro=null,!0}return!1;default:return!1}}function Pu(St){return(St.mode&1)!==0&&(St.flags&128)===0}function Ml(St){if(Ns){var Et=Ro;if(Et){var Bt=Et;if(!yo(St,Et)){if(Pu(St))throw Error(ot(418));Et=lr(Bt);var Ut=Co;Et&&yo(St,Et)?Lp(Ut,Bt):(St.flags=St.flags&-4097|2,Ns=!1,Co=St)}}else{if(Pu(St))throw Error(ot(418));St.flags=St.flags&-4097|2,Ns=!1,Co=St}}}function Ip(St){for(St=St.return;St!==null&&St.tag!==5&&St.tag!==3&&St.tag!==13;)St=St.return;Co=St}function Kl(St){if(!dn||St!==Co)return!1;if(!Ns)return Ip(St),Ns=!0,!1;if(St.tag!==3&&(St.tag!==5||Cn(St.type)&&!pn(St.type,St.memoizedProps))){var Et=Ro;if(Et){if(Pu(St)){for(St=Ro;St;)St=lr(St);throw Error(ot(418))}for(;Et;)Lp(St,Et),Et=lr(Et)}}if(Ip(St),St.tag===13){if(!dn)throw Error(ot(316));if(St=St.memoizedState,St=St!==null?St.dehydrated:null,!St)throw Error(ot(317));Ro=Bs(St)}else Ro=Co?lr(St.stateNode):null;return!0}function ou(){dn&&(Ro=Co=null,Ru=Ns=!1)}function bo(St){zo===null?zo=[St]:zo.push(St)}function au(St,Et,Bt){if(St=Bt.ref,St!==null&&typeof St!="function"&&typeof St!="object"){if(Bt._owner){if(Bt=Bt._owner,Bt){if(Bt.tag!==1)throw Error(ot(309));var Ut=Bt.stateNode}if(!Ut)throw Error(ot(147,St));var Wt=Ut,nn=""+St;return Et!==null&&Et.ref!==null&&typeof Et.ref=="function"&&Et.ref._stringRef===nn?Et.ref:(Et=function(xn){var On=Wt.refs;On===Cp&&(On=Wt.refs={}),xn===null?delete On[nn]:On[nn]=xn},Et._stringRef=nn,Et)}if(typeof St!="string")throw Error(ot(284));if(!Bt._owner)throw Error(ot(290,St))}return St}function lu(St,Et){throw St=Object.prototype.toString.call(Et),Error(ot(31,St==="[object Object]"?"object with keys {"+Object.keys(Et).join(", ")+"}":St))}function Xl(St){var Et=St._init;return Et(St._payload)}function cu(St){function Et(Zn,Gn){if(St){var ar=Zn.deletions;ar===null?(Zn.deletions=[Gn],Zn.flags|=16):ar.push(Gn)}}function Bt(Zn,Gn){if(!St)return null;for(;Gn!==null;)Et(Zn,Gn),Gn=Gn.sibling;return null}function Ut(Zn,Gn){for(Zn=new Map;Gn!==null;)Gn.key!==null?Zn.set(Gn.key,Gn):Zn.set(Gn.index,Gn),Gn=Gn.sibling;return Zn}function Wt(Zn,Gn){return Zn=_u(Zn,Gn),Zn.index=0,Zn.sibling=null,Zn}function nn(Zn,Gn,ar){return Zn.index=ar,St?(ar=Zn.alternate,ar!==null?(ar=ar.index,ar<Gn?(Zn.flags|=2,Gn):ar):(Zn.flags|=2,Gn)):(Zn.flags|=1048576,Gn)}function xn(Zn){return St&&Zn.alternate===null&&(Zn.flags|=2),Zn}function On(Zn,Gn,ar,Ur){return Gn===null||Gn.tag!==6?(Gn=Fm(ar,Zn.mode,Ur),Gn.return=Zn,Gn):(Gn=Wt(Gn,ar),Gn.return=Zn,Gn)}function dr(Zn,Gn,ar,Ur){var Hr=ar.type;return Hr===ut?Vr(Zn,Gn,ar.props.children,Ur,ar.key):Gn!==null&&(Gn.elementType===Hr||typeof Hr=="object"&&Hr!==null&&Hr.$$typeof===Tt&&Xl(Hr)===Gn.type)?(Ur=Wt(Gn,ar.props),Ur.ref=au(Zn,Gn,ar),Ur.return=Zn,Ur):(Ur=pm(ar.type,ar.key,ar.props,null,Zn.mode,Ur),Ur.ref=au(Zn,Gn,ar),Ur.return=Zn,Ur)}function Mr(Zn,Gn,ar,Ur){return Gn===null||Gn.tag!==4||Gn.stateNode.containerInfo!==ar.containerInfo||Gn.stateNode.implementation!==ar.implementation?(Gn=Om(ar,Zn.mode,Ur),Gn.return=Zn,Gn):(Gn=Wt(Gn,ar.children||[]),Gn.return=Zn,Gn)}function Vr(Zn,Gn,ar,Ur,Hr){return Gn===null||Gn.tag!==7?(Gn=Gu(ar,Zn.mode,Ur,Hr),Gn.return=Zn,Gn):(Gn=Wt(Gn,ar),Gn.return=Zn,Gn)}function rs(Zn,Gn,ar){if(typeof Gn=="string"&&Gn!==""||typeof Gn=="number")return Gn=Fm(""+Gn,Zn.mode,ar),Gn.return=Zn,Gn;if(typeof Gn=="object"&&Gn!==null){switch(Gn.$$typeof){case lt:return ar=pm(Gn.type,Gn.key,Gn.props,null,Zn.mode,ar),ar.ref=au(Zn,null,Gn),ar.return=Zn,ar;case ct:return Gn=Om(Gn,Zn.mode,ar),Gn.return=Zn,Gn;case Tt:var Ur=Gn._init;return rs(Zn,Ur(Gn._payload),ar)}if(Xt(Gn)||It(Gn))return Gn=Gu(Gn,Zn.mode,ar,null),Gn.return=Zn,Gn;lu(Zn,Gn)}return null}function Kr(Zn,Gn,ar,Ur){var Hr=Gn!==null?Gn.key:null;if(typeof ar=="string"&&ar!==""||typeof ar=="number")return Hr!==null?null:On(Zn,Gn,""+ar,Ur);if(typeof ar=="object"&&ar!==null){switch(ar.$$typeof){case lt:return ar.key===Hr?dr(Zn,Gn,ar,Ur):null;case ct:return ar.key===Hr?Mr(Zn,Gn,ar,Ur):null;case Tt:return Hr=ar._init,Kr(Zn,Gn,Hr(ar._payload),Ur)}if(Xt(ar)||It(ar))return Hr!==null?null:Vr(Zn,Gn,ar,Ur,null);lu(Zn,ar)}return null}function Ds(Zn,Gn,ar,Ur,Hr){if(typeof Ur=="string"&&Ur!==""||typeof Ur=="number")return Zn=Zn.get(ar)||null,On(Gn,Zn,""+Ur,Hr);if(typeof Ur=="object"&&Ur!==null){switch(Ur.$$typeof){case lt:return Zn=Zn.get(Ur.key===null?ar:Ur.key)||null,dr(Gn,Zn,Ur,Hr);case ct:return Zn=Zn.get(Ur.key===null?ar:Ur.key)||null,Mr(Gn,Zn,Ur,Hr);case Tt:var us=Ur._init;return Ds(Zn,Gn,ar,us(Ur._payload),Hr)}if(Xt(Ur)||It(Ur))return Zn=Zn.get(ar)||null,Vr(Gn,Zn,Ur,Hr,null);lu(Gn,Ur)}return null}function qr(Zn,Gn,ar,Ur){for(var Hr=null,us=null,ss=Gn,bs=Gn=0,mo=null;ss!==null&&bs<ar.length;bs++){ss.index>bs?(mo=ss,ss=null):mo=ss.sibling;var Ss=Kr(Zn,ss,ar[bs],Ur);if(Ss===null){ss===null&&(ss=mo);break}St&&ss&&Ss.alternate===null&&Et(Zn,ss),Gn=nn(Ss,Gn,bs),us===null?Hr=Ss:us.sibling=Ss,us=Ss,ss=mo}if(bs===ar.length)return Bt(Zn,ss),Ns&&El(Zn,bs),Hr;if(ss===null){for(;bs<ar.length;bs++)ss=rs(Zn,ar[bs],Ur),ss!==null&&(Gn=nn(ss,Gn,bs),us===null?Hr=ss:us.sibling=ss,us=ss);return Ns&&El(Zn,bs),Hr}for(ss=Ut(Zn,ss);bs<ar.length;bs++)mo=Ds(ss,Zn,bs,ar[bs],Ur),mo!==null&&(St&&mo.alternate!==null&&ss.delete(mo.key===null?bs:mo.key),Gn=nn(mo,Gn,bs),us===null?Hr=mo:us.sibling=mo,us=mo);return St&&ss.forEach(function(bu){return Et(Zn,bu)}),Ns&&El(Zn,bs),Hr}function To(Zn,Gn,ar,Ur){var Hr=It(ar);if(typeof Hr!="function")throw Error(ot(150));if(ar=Hr.call(ar),ar==null)throw Error(ot(151));for(var us=Hr=null,ss=Gn,bs=Gn=0,mo=null,Ss=ar.next();ss!==null&&!Ss.done;bs++,Ss=ar.next()){ss.index>bs?(mo=ss,ss=null):mo=ss.sibling;var bu=Kr(Zn,ss,Ss.value,Ur);if(bu===null){ss===null&&(ss=mo);break}St&&ss&&bu.alternate===null&&Et(Zn,ss),Gn=nn(bu,Gn,bs),us===null?Hr=bu:us.sibling=bu,us=bu,ss=mo}if(Ss.done)return Bt(Zn,ss),Ns&&El(Zn,bs),Hr;if(ss===null){for(;!Ss.done;bs++,Ss=ar.next())Ss=rs(Zn,Ss.value,Ur),Ss!==null&&(Gn=nn(Ss,Gn,bs),us===null?Hr=Ss:us.sibling=Ss,us=Ss);return Ns&&El(Zn,bs),Hr}for(ss=Ut(Zn,ss);!Ss.done;bs++,Ss=ar.next())Ss=Ds(ss,Zn,bs,Ss.value,Ur),Ss!==null&&(St&&Ss.alternate!==null&&ss.delete(Ss.key===null?bs:Ss.key),Gn=nn(Ss,Gn,bs),us===null?Hr=Ss:us.sibling=Ss,us=Ss);return St&&ss.forEach(function(k0){return Et(Zn,k0)}),Ns&&El(Zn,bs),Hr}function ba(Zn,Gn,ar,Ur){if(typeof ar=="object"&&ar!==null&&ar.type===ut&&ar.key===null&&(ar=ar.props.children),typeof ar=="object"&&ar!==null){switch(ar.$$typeof){case lt:e:{for(var Hr=ar.key,us=Gn;us!==null;){if(us.key===Hr){if(Hr=ar.type,Hr===ut){if(us.tag===7){Bt(Zn,us.sibling),Gn=Wt(us,ar.props.children),Gn.return=Zn,Zn=Gn;break e}}else if(us.elementType===Hr||typeof Hr=="object"&&Hr!==null&&Hr.$$typeof===Tt&&Xl(Hr)===us.type){Bt(Zn,us.sibling),Gn=Wt(us,ar.props),Gn.ref=au(Zn,us,ar),Gn.return=Zn,Zn=Gn;break e}Bt(Zn,us);break}else Et(Zn,us);us=us.sibling}ar.type===ut?(Gn=Gu(ar.props.children,Zn.mode,Ur,ar.key),Gn.return=Zn,Zn=Gn):(Ur=pm(ar.type,ar.key,ar.props,null,Zn.mode,Ur),Ur.ref=au(Zn,Gn,ar),Ur.return=Zn,Zn=Ur)}return xn(Zn);case ct:e:{for(us=ar.key;Gn!==null;){if(Gn.key===us)if(Gn.tag===4&&Gn.stateNode.containerInfo===ar.containerInfo&&Gn.stateNode.implementation===ar.implementation){Bt(Zn,Gn.sibling),Gn=Wt(Gn,ar.children||[]),Gn.return=Zn,Zn=Gn;break e}else{Bt(Zn,Gn);break}else Et(Zn,Gn);Gn=Gn.sibling}Gn=Om(ar,Zn.mode,Ur),Gn.return=Zn,Zn=Gn}return xn(Zn);case Tt:return us=ar._init,ba(Zn,Gn,us(ar._payload),Ur)}if(Xt(ar))return qr(Zn,Gn,ar,Ur);if(It(ar))return To(Zn,Gn,ar,Ur);lu(Zn,ar)}return typeof ar=="string"&&ar!==""||typeof ar=="number"?(ar=""+ar,Gn!==null&&Gn.tag===6?(Bt(Zn,Gn.sibling),Gn=Wt(Gn,ar),Gn.return=Zn,Zn=Gn):(Bt(Zn,Gn),Gn=Fm(ar,Zn.mode,Ur),Gn.return=Zn,Zn=Gn),xn(Zn)):Bt(Zn,Gn)}return ba}var Jo=cu(!0),Dp=cu(!1),uu={},No=ns(uu),Yl=ns(uu),hu=ns(uu);function Zo(St){if(St===uu)throw Error(ot(174));return St}function Yu(St,Et){cn(hu,Et),cn(Yl,St),cn(No,uu),St=rn(Et),wr(No),cn(No,St)}function Ql(){wr(No),wr(Yl),wr(hu)}function du(St){var Et=Zo(hu.current),Bt=Zo(No.current);Et=Gt(Bt,St.type,Et),Bt!==Et&&(cn(Yl,St),cn(No,Et))}function Bl(St){Yl.current===St&&(wr(No),wr(Yl))}var Os=ns(0);function Fl(St){for(var Et=St;Et!==null;){if(Et.tag===13){var Bt=Et.memoizedState;if(Bt!==null&&(Bt=Bt.dehydrated,Bt===null||eo(Bt)||Us(Bt)))return Et}else if(Et.tag===19&&Et.memoizedProps.revealOrder!==void 0){if(Et.flags&128)return Et}else if(Et.child!==null){Et.child.return=Et,Et=Et.child;continue}if(Et===St)break;for(;Et.sibling===null;){if(Et.return===null||Et.return===St)return null;Et=Et.return}Et.sibling.return=Et.return,Et=Et.sibling}return null}var up=[];function hp(){for(var St=0;St<up.length;St++){var Et=up[St];Xn?Et._workInProgressVersionPrimary=null:Et._workInProgressVersionSecondary=null}up.length=0}var Qu=at.ReactCurrentDispatcher,Bo=at.ReactCurrentBatchConfig,fu=0,zs=null,co=null,js=null,Lu=!1,Jl=!1,Iu=0,ym=0;function uo(){throw Error(ot(321))}function dp(St,Et){if(Et===null)return!1;for(var Bt=0;Bt<Et.length&&Bt<St.length;Bt++)if(!Eo(St[Bt],Et[Bt]))return!1;return!0}function fp(St,Et,Bt,Ut,Wt,nn){if(fu=nn,zs=Et,Et.memoizedState=null,Et.updateQueue=null,Et.lanes=0,Qu.current=St===null||St.memoizedState===null?xm:Kp,St=Bt(Ut,Wt),Jl){nn=0;do{if(Jl=!1,Iu=0,25<=nn)throw Error(ot(301));nn+=1,js=co=null,Et.updateQueue=null,Qu.current=Xp,St=Bt(Ut,Wt)}while(Jl)}if(Qu.current=_h,Et=co!==null&&co.next!==null,fu=0,js=co=zs=null,Lu=!1,Et)throw Error(ot(300));return St}function pp(){var St=Iu!==0;return Iu=0,St}function wl(){var St={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return js===null?zs.memoizedState=js=St:js=js.next=St,js}function Ho(){if(co===null){var St=zs.alternate;St=St!==null?St.memoizedState:null}else St=co.next;var Et=js===null?zs.memoizedState:js.next;if(Et!==null)js=Et,co=St;else{if(St===null)throw Error(ot(310));co=St,St={memoizedState:co.memoizedState,baseState:co.baseState,baseQueue:co.baseQueue,queue:co.queue,next:null},js===null?zs.memoizedState=js=St:js=js.next=St}return js}function Zl(St,Et){return typeof Et=="function"?Et(St):Et}function Du(St){var Et=Ho(),Bt=Et.queue;if(Bt===null)throw Error(ot(311));Bt.lastRenderedReducer=St;var Ut=co,Wt=Ut.baseQueue,nn=Bt.pending;if(nn!==null){if(Wt!==null){var xn=Wt.next;Wt.next=nn.next,nn.next=xn}Ut.baseQueue=Wt=nn,Bt.pending=null}if(Wt!==null){nn=Wt.next,Ut=Ut.baseState;var On=xn=null,dr=null,Mr=nn;do{var Vr=Mr.lane;if((fu&Vr)===Vr)dr!==null&&(dr=dr.next={lane:0,action:Mr.action,hasEagerState:Mr.hasEagerState,eagerState:Mr.eagerState,next:null}),Ut=Mr.hasEagerState?Mr.eagerState:St(Ut,Mr.action);else{var rs={lane:Vr,action:Mr.action,hasEagerState:Mr.hasEagerState,eagerState:Mr.eagerState,next:null};dr===null?(On=dr=rs,xn=Ut):dr=dr.next=rs,zs.lanes|=Vr,sp|=Vr}Mr=Mr.next}while(Mr!==null&&Mr!==nn);dr===null?xn=Ut:dr.next=On,Eo(Ut,Et.memoizedState)||(Qs=!0),Et.memoizedState=Ut,Et.baseState=xn,Et.baseQueue=dr,Bt.lastRenderedState=Ut}if(St=Bt.interleaved,St!==null){Wt=St;do nn=Wt.lane,zs.lanes|=nn,sp|=nn,Wt=Wt.next;while(Wt!==St)}else Wt===null&&(Bt.lanes=0);return[Et.memoizedState,Bt.dispatch]}function Fo(St){var Et=Ho(),Bt=Et.queue;if(Bt===null)throw Error(ot(311));Bt.lastRenderedReducer=St;var Ut=Bt.dispatch,Wt=Bt.pending,nn=Et.memoizedState;if(Wt!==null){Bt.pending=null;var xn=Wt=Wt.next;do nn=St(nn,xn.action),xn=xn.next;while(xn!==Wt);Eo(nn,Et.memoizedState)||(Qs=!0),Et.memoizedState=nn,Et.baseQueue===null&&(Et.baseState=nn),Bt.lastRenderedState=nn}return[nn,Ut]}function mp(){}function $p(St,Et){var Bt=zs,Ut=Ho(),Wt=Et(),nn=!Eo(Ut.memoizedState,Wt);if(nn&&(Ut.memoizedState=Wt,Qs=!0),Ut=Ut.queue,$u(Fp.bind(null,Bt,Ut,St),[St]),Ut.getSnapshot!==Et||nn||js!==null&&js.memoizedState.tag&1){if(Bt.flags|=2048,pu(9,Bp.bind(null,Bt,Ut,Wt,Et),void 0,null),Js===null)throw Error(ot(349));fu&30||Np(Bt,Et,Wt)}return Wt}function Np(St,Et,Bt){St.flags|=16384,St={getSnapshot:Et,value:Bt},Et=zs.updateQueue,Et===null?(Et={lastEffect:null,stores:null},zs.updateQueue=Et,Et.stores=[St]):(Bt=Et.stores,Bt===null?Et.stores=[St]:Bt.push(St))}function Bp(St,Et,Bt,Ut){Et.value=Bt,Et.getSnapshot=Ut,Op(Et)&&ga(St,1,-1)}function Fp(St,Et,Bt){return Bt(function(){Op(Et)&&ga(St,1,-1)})}function Op(St){var Et=St.getSnapshot;St=St.value;try{var Bt=Et();return!Eo(St,Bt)}catch{return!0}}function na(St){var Et=wl();return typeof St=="function"&&(St=St()),Et.memoizedState=Et.baseState=St,St={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zl,lastRenderedState:St},Et.queue=St,St=St.dispatch=vm.bind(null,zs,St),[Et.memoizedState,St]}function pu(St,Et,Bt,Ut){return St={tag:St,create:Et,destroy:Bt,deps:Ut,next:null},Et=zs.updateQueue,Et===null?(Et={lastEffect:null,stores:null},zs.updateQueue=Et,Et.lastEffect=St.next=St):(Bt=Et.lastEffect,Bt===null?Et.lastEffect=St.next=St:(Ut=Bt.next,Bt.next=St,St.next=Ut,Et.lastEffect=St)),St}function Ap(){return Ho().memoizedState}function Ju(St,Et,Bt,Ut){var Wt=wl();zs.flags|=St,Wt.memoizedState=pu(1|Et,Bt,void 0,Ut===void 0?null:Ut)}function Zu(St,Et,Bt,Ut){var Wt=Ho();Ut=Ut===void 0?null:Ut;var nn=void 0;if(co!==null){var xn=co.memoizedState;if(nn=xn.destroy,Ut!==null&&dp(Ut,xn.deps)){Wt.memoizedState=pu(Et,Bt,nn,Ut);return}}zs.flags|=St,Wt.memoizedState=pu(1|Et,Bt,nn,Ut)}function gp(St,Et){return Ju(8390656,8,St,Et)}function $u(St,Et){return Zu(2048,8,St,Et)}function kp(St,Et){return Zu(4,2,St,Et)}function Up(St,Et){return Zu(4,4,St,Et)}function Gp(St,Et){if(typeof Et=="function")return St=St(),Et(St),function(){Et(null)};if(Et!=null)return St=St(),Et.current=St,function(){Et.current=null}}function Vp(St,Et,Bt){return Bt=Bt!=null?Bt.concat([St]):null,Zu(4,4,Gp.bind(null,Et,St),Bt)}function yp(){}function zp(St,Et){var Bt=Ho();Et=Et===void 0?null:Et;var Ut=Bt.memoizedState;return Ut!==null&&Et!==null&&dp(Et,Ut[1])?Ut[0]:(Bt.memoizedState=[St,Et],St)}function Hp(St,Et){var Bt=Ho();Et=Et===void 0?null:Et;var Ut=Bt.memoizedState;return Ut!==null&&Et!==null&&dp(Et,Ut[1])?Ut[0]:(St=St(),Bt.memoizedState=[St,Et],St)}function jp(St,Et){var Bt=as;as=Bt!==0&&4>Bt?Bt:4,St(!0);var Ut=Bo.transition;Bo.transition={};try{St(!1),Et()}finally{as=Bt,Bo.transition=Ut}}function vp(){return Ho().memoizedState}function qs(St,Et,Bt){var Ut=vu(St);Bt={lane:Ut,action:Bt,hasEagerState:!1,eagerState:null,next:null},qp(St)?mu(Et,Bt):(Po(St,Et,Bt),Bt=Lo(),St=ga(St,Ut,Bt),St!==null&&Wp(St,Et,Ut))}function vm(St,Et,Bt){var Ut=vu(St),Wt={lane:Ut,action:Bt,hasEagerState:!1,eagerState:null,next:null};if(qp(St))mu(Et,Wt);else{Po(St,Et,Wt);var nn=St.alternate;if(St.lanes===0&&(nn===null||nn.lanes===0)&&(nn=Et.lastRenderedReducer,nn!==null))try{var xn=Et.lastRenderedState,On=nn(xn,Bt);if(Wt.hasEagerState=!0,Wt.eagerState=On,Eo(On,xn))return}catch{}finally{}Bt=Lo(),St=ga(St,Ut,Bt),St!==null&&Wp(St,Et,Ut)}}function qp(St){var Et=St.alternate;return St===zs||Et!==null&&Et===zs}function mu(St,Et){Jl=Lu=!0;var Bt=St.pending;Bt===null?Et.next=Et:(Et.next=Bt.next,Bt.next=Et),St.pending=Et}function Po(St,Et,Bt){Js!==null&&St.mode&1&&!(hs&2)?(St=Et.interleaved,St===null?(Bt.next=Bt,Mo===null?Mo=[Et]:Mo.push(Et)):(Bt.next=St.next,St.next=Bt),Et.interleaved=Bt):(St=Et.pending,St===null?Bt.next=Bt:(Bt.next=St.next,St.next=Bt),Et.pending=Bt)}function Wp(St,Et,Bt){if(Bt&4194240){var Ut=Et.lanes;Ut&=St.pendingLanes,Bt|=Ut,Et.lanes=Bt,ps(St,Bt)}}var _h={readContext:Fs,useCallback:uo,useContext:uo,useEffect:uo,useImperativeHandle:uo,useInsertionEffect:uo,useLayoutEffect:uo,useMemo:uo,useReducer:uo,useRef:uo,useState:uo,useDebugValue:uo,useDeferredValue:uo,useTransition:uo,useMutableSource:uo,useSyncExternalStore:uo,useId:uo,unstable_isNewReconciler:!1},xm={readContext:Fs,useCallback:function(St,Et){return wl().memoizedState=[St,Et===void 0?null:Et],St},useContext:Fs,useEffect:gp,useImperativeHandle:function(St,Et,Bt){return Bt=Bt!=null?Bt.concat([St]):null,Ju(4194308,4,Gp.bind(null,Et,St),Bt)},useLayoutEffect:function(St,Et){return Ju(4194308,4,St,Et)},useInsertionEffect:function(St,Et){return Ju(4,2,St,Et)},useMemo:function(St,Et){var Bt=wl();return Et=Et===void 0?null:Et,St=St(),Bt.memoizedState=[St,Et],St},useReducer:function(St,Et,Bt){var Ut=wl();return Et=Bt!==void 0?Bt(Et):Et,Ut.memoizedState=Ut.baseState=Et,St={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:St,lastRenderedState:Et},Ut.queue=St,St=St.dispatch=qs.bind(null,zs,St),[Ut.memoizedState,St]},useRef:function(St){var Et=wl();return St={current:St},Et.memoizedState=St},useState:na,useDebugValue:yp,useDeferredValue:function(St){var Et=na(St),Bt=Et[0],Ut=Et[1];return gp(function(){var Wt=Bo.transition;Bo.transition={};try{Ut(St)}finally{Bo.transition=Wt}},[St]),Bt},useTransition:function(){var St=na(!1),Et=St[0];return St=jp.bind(null,St[1]),wl().memoizedState=St,[Et,St]},useMutableSource:function(){},useSyncExternalStore:function(St,Et,Bt){var Ut=zs,Wt=wl();if(Ns){if(Bt===void 0)throw Error(ot(407));Bt=Bt()}else{if(Bt=Et(),Js===null)throw Error(ot(349));fu&30||Np(Ut,Et,Bt)}Wt.memoizedState=Bt;var nn={value:Bt,getSnapshot:Et};return Wt.queue=nn,gp(Fp.bind(null,Ut,nn,St),[St]),Ut.flags|=2048,pu(9,Bp.bind(null,Ut,nn,Bt,Et),void 0,null),Bt},useId:function(){var St=wl(),Et=Js.identifierPrefix;if(Ns){var Bt=Vo,Ut=Qo;Bt=(Ut&~(1<<32-to(Ut)-1)).toString(32)+Bt,Et=":"+Et+"R"+Bt,Bt=Iu++,0<Bt&&(Et+="H"+Bt.toString(32)),Et+=":"}else Bt=ym++,Et=":"+Et+"r"+Bt.toString(32)+":";return St.memoizedState=Et},unstable_isNewReconciler:!1},Kp={readContext:Fs,useCallback:zp,useContext:Fs,useEffect:$u,useImperativeHandle:Vp,useInsertionEffect:kp,useLayoutEffect:Up,useMemo:Hp,useReducer:Du,useRef:Ap,useState:function(){return Du(Zl)},useDebugValue:yp,useDeferredValue:function(St){var Et=Du(Zl),Bt=Et[0],Ut=Et[1];return $u(function(){var Wt=Bo.transition;Bo.transition={};try{Ut(St)}finally{Bo.transition=Wt}},[St]),Bt},useTransition:function(){var St=Du(Zl)[0],Et=Ho().memoizedState;return[St,Et]},useMutableSource:mp,useSyncExternalStore:$p,useId:vp,unstable_isNewReconciler:!1},Xp={readContext:Fs,useCallback:zp,useContext:Fs,useEffect:$u,useImperativeHandle:Vp,useInsertionEffect:kp,useLayoutEffect:Up,useMemo:Hp,useReducer:Fo,useRef:Ap,useState:function(){return Fo(Zl)},useDebugValue:yp,useDeferredValue:function(St){var Et=Fo(Zl),Bt=Et[0],Ut=Et[1];return $u(function(){var Wt=Bo.transition;Bo.transition={};try{Ut(St)}finally{Bo.transition=Wt}},[St]),Bt},useTransition:function(){var St=Fo(Zl)[0],Et=Ho().memoizedState;return[St,Et]},useMutableSource:mp,useSyncExternalStore:$p,useId:vp,unstable_isNewReconciler:!1};function _d(St,Et){try{var Bt="",Ut=Et;do Bt+=zl(Ut),Ut=Ut.return;while(Ut);var Wt=Bt}catch(nn){Wt=`
Error generating stack: `+nn.message+`
`+nn.stack}return{value:St,source:Et,stack:Wt}}function _f(St,Et){try{console.error(Et.value)}catch(Bt){setTimeout(function(){throw Bt})}}var _m=typeof WeakMap=="function"?WeakMap:Map;function Yp(St,Et,Bt){Bt=Sl(-1,Bt),Bt.tag=3,Bt.payload={element:null};var Ut=Et.value;return Bt.callback=function(){am||(am=!0,Pm=Ut),_f(St,Et)},Bt}function Qp(St,Et,Bt){Bt=Sl(-1,Bt),Bt.tag=3;var Ut=St.type.getDerivedStateFromError;if(typeof Ut=="function"){var Wt=Et.value;Bt.payload=function(){return Ut(Wt)},Bt.callback=function(){_f(St,Et)}}var nn=St.stateNode;return nn!==null&&typeof nn.componentDidCatch=="function"&&(Bt.callback=function(){_f(St,Et),typeof Ut!="function"&&(gu===null?gu=new Set([this]):gu.add(this));var xn=Et.stack;this.componentDidCatch(Et.value,{componentStack:xn!==null?xn:""})}),Bt}function Jp(St,Et,Bt){var Ut=St.pingCache;if(Ut===null){Ut=St.pingCache=new _m;var Wt=new Set;Ut.set(Et,Wt)}else Wt=Ut.get(Et),Wt===void 0&&(Wt=new Set,Ut.set(Et,Wt));Wt.has(Bt)||(Wt.add(Bt),St=L0.bind(null,St,Et,Bt),Et.then(St,St))}function Zp(St){do{var Et;if((Et=St.tag===13)&&(Et=St.memoizedState,Et=Et!==null?Et.dehydrated!==null:!0),Et)return St;St=St.return}while(St!==null);return null}function Cl(St,Et,Bt,Ut,Wt){return St.mode&1?(St.flags|=65536,St.lanes=Wt,St):(St===Et?St.flags|=65536:(St.flags|=128,Bt.flags|=131072,Bt.flags&=-52805,Bt.tag===1&&(Bt.alternate===null?Bt.tag=17:(Et=Sl(-1,1),Et.tag=2,$l(Bt,Et))),Bt.lanes|=1),St)}function Ks(St){St.flags|=4}function Qr(St,Et){if(St!==null&&St.child===Et.child)return!0;if(Et.flags&16)return!1;for(St=Et.child;St!==null;){if(St.flags&12854||St.subtreeFlags&12854)return!1;St=St.sibling}return!0}var So,ts,Xs,Nu;if(Vn)So=function(St,Et){for(var Bt=Et.child;Bt!==null;){if(Bt.tag===5||Bt.tag===6)sn(St,Bt.stateNode);else if(Bt.tag!==4&&Bt.child!==null){Bt.child.return=Bt,Bt=Bt.child;continue}if(Bt===Et)break;for(;Bt.sibling===null;){if(Bt.return===null||Bt.return===Et)return;Bt=Bt.return}Bt.sibling.return=Bt.return,Bt=Bt.sibling}},ts=function(){},Xs=function(St,Et,Bt,Ut,Wt){if(St=St.memoizedProps,St!==Ut){var nn=Et.stateNode,xn=Zo(No.current);Bt=an(nn,Bt,St,Ut,Wt,xn),(Et.updateQueue=Bt)&&Ks(Et)}},Nu=function(St,Et,Bt,Ut){Bt!==Ut&&Ks(Et)};else if(En){So=function(St,Et,Bt,Ut){for(var Wt=Et.child;Wt!==null;){if(Wt.tag===5){var nn=Wt.stateNode;Bt&&Ut&&(nn=Wr(nn,Wt.type,Wt.memoizedProps,Wt)),sn(St,nn)}else if(Wt.tag===6)nn=Wt.stateNode,Bt&&Ut&&(nn=As(nn,Wt.memoizedProps,Wt)),sn(St,nn);else if(Wt.tag!==4){if(Wt.tag===22&&Wt.memoizedState!==null)nn=Wt.child,nn!==null&&(nn.return=Wt),So(St,Wt,!0,!0);else if(Wt.child!==null){Wt.child.return=Wt,Wt=Wt.child;continue}}if(Wt===Et)break;for(;Wt.sibling===null;){if(Wt.return===null||Wt.return===Et)return;Wt=Wt.return}Wt.sibling.return=Wt.return,Wt=Wt.sibling}};var ep=function(St,Et,Bt,Ut){for(var Wt=Et.child;Wt!==null;){if(Wt.tag===5){var nn=Wt.stateNode;Bt&&Ut&&(nn=Wr(nn,Wt.type,Wt.memoizedProps,Wt)),jr(St,nn)}else if(Wt.tag===6)nn=Wt.stateNode,Bt&&Ut&&(nn=As(nn,Wt.memoizedProps,Wt)),jr(St,nn);else if(Wt.tag!==4){if(Wt.tag===22&&Wt.memoizedState!==null)nn=Wt.child,nn!==null&&(nn.return=Wt),ep(St,Wt,!0,!0);else if(Wt.child!==null){Wt.child.return=Wt,Wt=Wt.child;continue}}if(Wt===Et)break;for(;Wt.sibling===null;){if(Wt.return===null||Wt.return===Et)return;Wt=Wt.return}Wt.sibling.return=Wt.return,Wt=Wt.sibling}};ts=function(St,Et){var Bt=Et.stateNode;if(!Qr(St,Et)){St=Bt.containerInfo;var Ut=Pr(St);ep(Ut,Et,!1,!1),Bt.pendingChildren=Ut,Ks(Et),Jr(St,Ut)}},Xs=function(St,Et,Bt,Ut,Wt){var nn=St.stateNode,xn=St.memoizedProps;if((St=Qr(St,Et))&&xn===Ut)Et.stateNode=nn;else{var On=Et.stateNode,dr=Zo(No.current),Mr=null;xn!==Ut&&(Mr=an(On,Bt,xn,Ut,Wt,dr)),St&&Mr===null?Et.stateNode=nn:(nn=Dn(nn,Mr,Bt,xn,Ut,Et,St,On),hn(nn,Bt,Ut,Wt,dr)&&Ks(Et),Et.stateNode=nn,St?Ks(Et):So(nn,Et,!1,!1))}},Nu=function(St,Et,Bt,Ut){Bt!==Ut?(St=Zo(hu.current),Bt=Zo(No.current),Et.stateNode=_n(Ut,St,Bt,Et),Ks(Et)):Et.stateNode=St.stateNode}}else ts=function(){},Xs=function(){},Nu=function(){};function jo(St,Et){if(!Ns)switch(St.tailMode){case"hidden":Et=St.tail;for(var Bt=null;Et!==null;)Et.alternate!==null&&(Bt=Et),Et=Et.sibling;Bt===null?St.tail=null:Bt.sibling=null;break;case"collapsed":Bt=St.tail;for(var Ut=null;Bt!==null;)Bt.alternate!==null&&(Ut=Bt),Bt=Bt.sibling;Ut===null?Et||St.tail===null?St.tail=null:St.tail.sibling=null:Ut.sibling=null}}function ho(St){var Et=St.alternate!==null&&St.alternate.child===St.child,Bt=0,Ut=0;if(Et)for(var Wt=St.child;Wt!==null;)Bt|=Wt.lanes|Wt.childLanes,Ut|=Wt.subtreeFlags&14680064,Ut|=Wt.flags&14680064,Wt.return=St,Wt=Wt.sibling;else for(Wt=St.child;Wt!==null;)Bt|=Wt.lanes|Wt.childLanes,Ut|=Wt.subtreeFlags,Ut|=Wt.flags,Wt.return=St,Wt=Wt.sibling;return St.subtreeFlags|=Ut,St.childLanes=Bt,Et}function fo(St,Et,Bt){var Ut=Et.pendingProps;switch(cp(Et),Et.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ho(Et),null;case 1:return ys(Et.type)&&fn(),ho(Et),null;case 3:return Ut=Et.stateNode,Ql(),wr(Xr),wr(cs),hp(),Ut.pendingContext&&(Ut.context=Ut.pendingContext,Ut.pendingContext=null),(St===null||St.child===null)&&(Kl(Et)?Ks(Et):St===null||St.memoizedState.isDehydrated&&!(Et.flags&256)||(Et.flags|=1024,zo!==null&&(Dm(zo),zo=null))),ts(St,Et),ho(Et),null;case 5:Bl(Et),Bt=Zo(hu.current);var Wt=Et.type;if(St!==null&&Et.stateNode!=null)Xs(St,Et,Wt,Ut,Bt),St.ref!==Et.ref&&(Et.flags|=512,Et.flags|=2097152);else{if(!Ut){if(Et.stateNode===null)throw Error(ot(166));return ho(Et),null}if(St=Zo(No.current),Kl(Et)){if(!dn)throw Error(ot(175));St=mn(Et.stateNode,Et.type,Et.memoizedProps,Bt,St,Et,!Ru),Et.updateQueue=St,St!==null&&Ks(Et)}else{var nn=Jt(Wt,Ut,Bt,St,Et);So(nn,Et,!1,!1),Et.stateNode=nn,hn(nn,Wt,Ut,Bt,St)&&Ks(Et)}Et.ref!==null&&(Et.flags|=512,Et.flags|=2097152)}return ho(Et),null;case 6:if(St&&Et.stateNode!=null)Nu(St,Et,St.memoizedProps,Ut);else{if(typeof Ut!="string"&&Et.stateNode===null)throw Error(ot(166));if(St=Zo(hu.current),Bt=Zo(No.current),Kl(Et)){if(!dn)throw Error(ot(176));if(St=Et.stateNode,Ut=Et.memoizedProps,(Bt=os(St,Ut,Et,!Ru))&&(Wt=Co,Wt!==null))switch(nn=(Wt.mode&1)!==0,Wt.tag){case 3:xr(Wt.stateNode.containerInfo,St,Ut,nn);break;case 5:Nr(Wt.type,Wt.memoizedProps,Wt.stateNode,St,Ut,nn)}Bt&&Ks(Et)}else Et.stateNode=_n(Ut,St,Bt,Et)}return ho(Et),null;case 13:if(wr(Os),Ut=Et.memoizedState,Ns&&Ro!==null&&Et.mode&1&&!(Et.flags&128)){for(St=Ro;St;)St=lr(St);return ou(),Et.flags|=98560,Et}if(Ut!==null&&Ut.dehydrated!==null){if(Ut=Kl(Et),St===null){if(!Ut)throw Error(ot(318));if(!dn)throw Error(ot(344));if(St=Et.memoizedState,St=St!==null?St.dehydrated:null,!St)throw Error(ot(317));gs(St,Et)}else ou(),!(Et.flags&128)&&(Et.memoizedState=null),Et.flags|=4;return ho(Et),null}return zo!==null&&(Dm(zo),zo=null),Et.flags&128?(Et.lanes=Bt,Et):(Ut=Ut!==null,Bt=!1,St===null?Kl(Et):Bt=St.memoizedState!==null,Ut&&!Bt&&(Et.child.flags|=8192,Et.mode&1&&(St===null||Os.current&1?so===0&&(so=3):Nm())),Et.updateQueue!==null&&(Et.flags|=4),ho(Et),null);case 4:return Ql(),ts(St,Et),St===null&&er(Et.stateNode.containerInfo),ho(Et),null;case 10:return Is(Et.type._context),ho(Et),null;case 17:return ys(Et.type)&&fn(),ho(Et),null;case 19:if(wr(Os),Wt=Et.memoizedState,Wt===null)return ho(Et),null;if(Ut=(Et.flags&128)!==0,nn=Wt.rendering,nn===null)if(Ut)jo(Wt,!1);else{if(so!==0||St!==null&&St.flags&128)for(St=Et.child;St!==null;){if(nn=Fl(St),nn!==null){for(Et.flags|=128,jo(Wt,!1),St=nn.updateQueue,St!==null&&(Et.updateQueue=St,Et.flags|=4),Et.subtreeFlags=0,St=Bt,Ut=Et.child;Ut!==null;)Bt=Ut,Wt=St,Bt.flags&=14680066,nn=Bt.alternate,nn===null?(Bt.childLanes=0,Bt.lanes=Wt,Bt.child=null,Bt.subtreeFlags=0,Bt.memoizedProps=null,Bt.memoizedState=null,Bt.updateQueue=null,Bt.dependencies=null,Bt.stateNode=null):(Bt.childLanes=nn.childLanes,Bt.lanes=nn.lanes,Bt.child=nn.child,Bt.subtreeFlags=0,Bt.deletions=null,Bt.memoizedProps=nn.memoizedProps,Bt.memoizedState=nn.memoizedState,Bt.updateQueue=nn.updateQueue,Bt.type=nn.type,Wt=nn.dependencies,Bt.dependencies=Wt===null?null:{lanes:Wt.lanes,firstContext:Wt.firstContext}),Ut=Ut.sibling;return cn(Os,Os.current&1|2),Et.child}St=St.sibling}Wt.tail!==null&&Ls()>Rm&&(Et.flags|=128,Ut=!0,jo(Wt,!1),Et.lanes=4194304)}else{if(!Ut)if(St=Fl(nn),St!==null){if(Et.flags|=128,Ut=!0,St=St.updateQueue,St!==null&&(Et.updateQueue=St,Et.flags|=4),jo(Wt,!0),Wt.tail===null&&Wt.tailMode==="hidden"&&!nn.alternate&&!Ns)return ho(Et),null}else 2*Ls()-Wt.renderingStartTime>Rm&&Bt!==1073741824&&(Et.flags|=128,Ut=!0,jo(Wt,!1),Et.lanes=4194304);Wt.isBackwards?(nn.sibling=Et.child,Et.child=nn):(St=Wt.last,St!==null?St.sibling=nn:Et.child=nn,Wt.last=nn)}return Wt.tail!==null?(Et=Wt.tail,Wt.rendering=Et,Wt.tail=Et.sibling,Wt.renderingStartTime=Ls(),Et.sibling=null,St=Os.current,cn(Os,Ut?St&1|2:St&1),Et):(ho(Et),null);case 22:case 23:return $m(),Ut=Et.memoizedState!==null,St!==null&&St.memoizedState!==null!==Ut&&(Et.flags|=8192),Ut&&Et.mode&1?qo&1073741824&&(ho(Et),Vn&&Et.subtreeFlags&6&&(Et.flags|=8192)):ho(Et),null;case 24:return null;case 25:return null}throw Error(ot(156,Et.tag))}var tp=at.ReactCurrentOwner,Qs=!1;function po(St,Et,Bt,Ut){Et.child=St===null?Dp(Et,null,Bt,Ut):Jo(Et,St.child,Bt,Ut)}function _r(St,Et,Bt,Ut,Wt){Bt=Bt.render;var nn=Et.ref;return Vs(Et,Wt),Ut=fp(St,Et,Bt,Ut,nn,Wt),Bt=pp(),St!==null&&!Qs?(Et.updateQueue=St.updateQueue,Et.flags&=-2053,St.lanes&=~Wt,An(St,Et,Wt)):(Ns&&Bt&&Es(Et),Et.flags|=1,po(St,Et,Ut,Wt),Et.child)}function Cr(St,Et,Bt,Ut,Wt){if(St===null){var nn=Bt.type;return typeof nn=="function"&&!Bm(nn)&&nn.defaultProps===void 0&&Bt.compare===null&&Bt.defaultProps===void 0?(Et.tag=15,Et.type=nn,xp(St,Et,nn,Ut,Wt)):(St=pm(Bt.type,null,Ut,Et,Et.mode,Wt),St.ref=Et.ref,St.return=Et,Et.child=St)}if(nn=St.child,!(St.lanes&Wt)){var xn=nn.memoizedProps;if(Bt=Bt.compare,Bt=Bt!==null?Bt:Vl,Bt(xn,Ut)&&St.ref===Et.ref)return An(St,Et,Wt)}return Et.flags|=1,St=_u(nn,Ut),St.ref=Et.ref,St.return=Et,Et.child=St}function xp(St,Et,Bt,Ut,Wt){if(St!==null&&Vl(St.memoizedProps,Ut)&&St.ref===Et.ref)if(Qs=!1,(St.lanes&Wt)!==0)St.flags&131072&&(Qs=!0);else return Et.lanes=St.lanes,An(St,Et,Wt);return Au(St,Et,Bt,Ut,Wt)}function np(St,Et,Bt){var Ut=Et.pendingProps,Wt=Ut.children,nn=St!==null?St.memoizedState:null;if(Ut.mode==="hidden")if(!(Et.mode&1))Et.memoizedState={baseLanes:0,cachePool:null},cn(ip,qo),qo|=Bt;else if(Bt&1073741824)Et.memoizedState={baseLanes:0,cachePool:null},Ut=nn!==null?nn.baseLanes:Bt,cn(ip,qo),qo|=Ut;else return St=nn!==null?nn.baseLanes|Bt:Bt,Et.lanes=Et.childLanes=1073741824,Et.memoizedState={baseLanes:St,cachePool:null},Et.updateQueue=null,cn(ip,qo),qo|=St,null;else nn!==null?(Ut=nn.baseLanes|Bt,Et.memoizedState=null):Ut=Bt,cn(ip,qo),qo|=Ut;return po(St,Et,Wt,Bt),Et.child}function Bu(St,Et){var Bt=Et.ref;(St===null&&Bt!==null||St!==null&&St.ref!==Bt)&&(Et.flags|=512,Et.flags|=2097152)}function Au(St,Et,Bt,Ut,Wt){var nn=ys(Bt)?Gs:cs.current;return nn=Ws(Et,nn),Vs(Et,Wt),Bt=fp(St,Et,Bt,Ut,nn,Wt),Ut=pp(),St!==null&&!Qs?(Et.updateQueue=St.updateQueue,Et.flags&=-2053,St.lanes&=~Wt,An(St,Et,Wt)):(Ns&&Ut&&Es(Et),Et.flags|=1,po(St,Et,Bt,Wt),Et.child)}function Ol(St,Et,Bt,Ut,Wt){if(ys(Bt)){var nn=!0;Io(Et)}else nn=!1;if(Vs(Et,Wt),Et.stateNode===null)St!==null&&(St.alternate=null,Et.alternate=null,Et.flags|=2),Pp(Et,Bt,Ut),lp(Et,Bt,Ut,Wt),Ut=!0;else if(St===null){var xn=Et.stateNode,On=Et.memoizedProps;xn.props=On;var dr=xn.context,Mr=Bt.contextType;typeof Mr=="object"&&Mr!==null?Mr=Fs(Mr):(Mr=ys(Bt)?Gs:cs.current,Mr=Ws(Et,Mr));var Vr=Bt.getDerivedStateFromProps,rs=typeof Vr=="function"||typeof xn.getSnapshotBeforeUpdate=="function";rs||typeof xn.UNSAFE_componentWillReceiveProps!="function"&&typeof xn.componentWillReceiveProps!="function"||(On!==Ut||dr!==Mr)&&su(Et,xn,Ut,Mr),Dl=!1;var Kr=Et.memoizedState;xn.state=Kr,Wu(Et,Ut,xn,Wt),dr=Et.memoizedState,On!==Ut||Kr!==dr||Xr.current||Dl?(typeof Vr=="function"&&(iu(Et,Bt,Vr,Ut),dr=Et.memoizedState),(On=Dl||Rp(Et,Bt,On,Ut,Kr,dr,Mr))?(rs||typeof xn.UNSAFE_componentWillMount!="function"&&typeof xn.componentWillMount!="function"||(typeof xn.componentWillMount=="function"&&xn.componentWillMount(),typeof xn.UNSAFE_componentWillMount=="function"&&xn.UNSAFE_componentWillMount()),typeof xn.componentDidMount=="function"&&(Et.flags|=4194308)):(typeof xn.componentDidMount=="function"&&(Et.flags|=4194308),Et.memoizedProps=Ut,Et.memoizedState=dr),xn.props=Ut,xn.state=dr,xn.context=Mr,Ut=On):(typeof xn.componentDidMount=="function"&&(Et.flags|=4194308),Ut=!1)}else{xn=Et.stateNode,Ep(St,Et),On=Et.memoizedProps,Mr=Et.type===Et.elementType?On:ao(Et.type,On),xn.props=Mr,rs=Et.pendingProps,Kr=xn.context,dr=Bt.contextType,typeof dr=="object"&&dr!==null?dr=Fs(dr):(dr=ys(Bt)?Gs:cs.current,dr=Ws(Et,dr));var Ds=Bt.getDerivedStateFromProps;(Vr=typeof Ds=="function"||typeof xn.getSnapshotBeforeUpdate=="function")||typeof xn.UNSAFE_componentWillReceiveProps!="function"&&typeof xn.componentWillReceiveProps!="function"||(On!==rs||Kr!==dr)&&su(Et,xn,Ut,dr),Dl=!1,Kr=Et.memoizedState,xn.state=Kr,Wu(Et,Ut,xn,Wt);var qr=Et.memoizedState;On!==rs||Kr!==qr||Xr.current||Dl?(typeof Ds=="function"&&(iu(Et,Bt,Ds,Ut),qr=Et.memoizedState),(Mr=Dl||Rp(Et,Bt,Mr,Ut,Kr,qr,dr)||!1)?(Vr||typeof xn.UNSAFE_componentWillUpdate!="function"&&typeof xn.componentWillUpdate!="function"||(typeof xn.componentWillUpdate=="function"&&xn.componentWillUpdate(Ut,qr,dr),typeof xn.UNSAFE_componentWillUpdate=="function"&&xn.UNSAFE_componentWillUpdate(Ut,qr,dr)),typeof xn.componentDidUpdate=="function"&&(Et.flags|=4),typeof xn.getSnapshotBeforeUpdate=="function"&&(Et.flags|=1024)):(typeof xn.componentDidUpdate!="function"||On===St.memoizedProps&&Kr===St.memoizedState||(Et.flags|=4),typeof xn.getSnapshotBeforeUpdate!="function"||On===St.memoizedProps&&Kr===St.memoizedState||(Et.flags|=1024),Et.memoizedProps=Ut,Et.memoizedState=qr),xn.props=Ut,xn.state=qr,xn.context=dr,Ut=Mr):(typeof xn.componentDidUpdate!="function"||On===St.memoizedProps&&Kr===St.memoizedState||(Et.flags|=4),typeof xn.getSnapshotBeforeUpdate!="function"||On===St.memoizedProps&&Kr===St.memoizedState||(Et.flags|=1024),Ut=!1)}return rp(St,Et,Bt,Ut,nn,Wt)}function rp(St,Et,Bt,Ut,Wt,nn){Bu(St,Et);var xn=(Et.flags&128)!==0;if(!Ut&&!xn)return Wt&&ws(Et,Bt,!1),An(St,Et,nn);Ut=Et.stateNode,tp.current=Et;var On=xn&&typeof Bt.getDerivedStateFromError!="function"?null:Ut.render();return Et.flags|=1,St!==null&&xn?(Et.child=Jo(Et,St.child,null,nn),Et.child=Jo(Et,null,On,nn)):po(St,Et,On,nn),Et.memoizedState=Ut.state,Wt&&ws(Et,Bt,!0),Et.child}function Rl(St){var Et=St.stateNode;Et.pendingContext?Ts(St,Et.pendingContext,Et.pendingContext!==Et.context):Et.context&&Ts(St,Et.context,!1),Yu(St,Et.containerInfo)}function vt(St,Et,Bt,Ut,Wt){return ou(),bo(Wt),Et.flags|=256,po(St,Et,Bt,Ut),Et.child}var yt={dehydrated:null,treeContext:null,retryLane:0};function _t(St){return{baseLanes:St,cachePool:null}}function Mt(St,Et,Bt){var Ut=Et.pendingProps,Wt=Os.current,nn=!1,xn=(Et.flags&128)!==0,On;if((On=xn)||(On=St!==null&&St.memoizedState===null?!1:(Wt&2)!==0),On?(nn=!0,Et.flags&=-129):(St===null||St.memoizedState!==null)&&(Wt|=1),cn(Os,Wt&1),St===null)return Ml(Et),St=Et.memoizedState,St!==null&&(St=St.dehydrated,St!==null)?(Et.mode&1?Us(St)?Et.lanes=8:Et.lanes=1073741824:Et.lanes=1,null):(Wt=Ut.children,St=Ut.fallback,nn?(Ut=Et.mode,nn=Et.child,Wt={mode:"hidden",children:Wt},!(Ut&1)&&nn!==null?(nn.childLanes=0,nn.pendingProps=Wt):nn=mm(Wt,Ut,0,null),St=Gu(St,Ut,Bt,null),nn.return=Et,St.return=Et,nn.sibling=St,Et.child=nn,Et.child.memoizedState=_t(Bt),Et.memoizedState=yt,St):Ct(Et,Wt));if(Wt=St.memoizedState,Wt!==null){if(On=Wt.dehydrated,On!==null){if(xn)return Et.flags&256?(Et.flags&=-257,Ft(St,Et,Bt,Error(ot(422)))):Et.memoizedState!==null?(Et.child=St.child,Et.flags|=128,null):(nn=Ut.fallback,Wt=Et.mode,Ut=mm({mode:"visible",children:Ut.children},Wt,0,null),nn=Gu(nn,Wt,Bt,null),nn.flags|=2,Ut.return=Et,nn.return=Et,Ut.sibling=nn,Et.child=Ut,Et.mode&1&&Jo(Et,St.child,null,Bt),Et.child.memoizedState=_t(Bt),Et.memoizedState=yt,nn);if(!(Et.mode&1))Et=Ft(St,Et,Bt,null);else if(Us(On))Et=Ft(St,Et,Bt,Error(ot(419)));else if(Ut=(Bt&St.childLanes)!==0,Qs||Ut){if(Ut=Js,Ut!==null){switch(Bt&-Bt){case 4:nn=2;break;case 16:nn=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:nn=32;break;case 536870912:nn=268435456;break;default:nn=0}Ut=nn&(Ut.suspendedLanes|Bt)?0:nn,Ut!==0&&Ut!==Wt.retryLane&&(Wt.retryLane=Ut,ga(St,Ut,-1))}Nm(),Et=Ft(St,Et,Bt,Error(ot(421)))}else eo(On)?(Et.flags|=128,Et.child=St.child,Et=I0.bind(null,St),zn(On,Et),Et=null):(Bt=Wt.treeContext,dn&&(Ro=xt(On),Co=Et,Ns=!0,zo=null,Ru=!1,Bt!==null&&(_o[wo++]=Qo,_o[wo++]=Vo,_o[wo++]=Wl,Qo=Bt.id,Vo=Bt.overflow,Wl=Et)),Et=Ct(Et,Et.pendingProps.children),Et.flags|=4096);return Et}return nn?(Ut=Nt(St,Et,Ut.children,Ut.fallback,Bt),nn=Et.child,Wt=St.child.memoizedState,nn.memoizedState=Wt===null?_t(Bt):{baseLanes:Wt.baseLanes|Bt,cachePool:null},nn.childLanes=St.childLanes&~Bt,Et.memoizedState=yt,Ut):(Bt=Pt(St,Et,Ut.children,Bt),Et.memoizedState=null,Bt)}return nn?(Ut=Nt(St,Et,Ut.children,Ut.fallback,Bt),nn=Et.child,Wt=St.child.memoizedState,nn.memoizedState=Wt===null?_t(Bt):{baseLanes:Wt.baseLanes|Bt,cachePool:null},nn.childLanes=St.childLanes&~Bt,Et.memoizedState=yt,Ut):(Bt=Pt(St,Et,Ut.children,Bt),Et.memoizedState=null,Bt)}function Ct(St,Et){return Et=mm({mode:"visible",children:Et},St.mode,0,null),Et.return=St,St.child=Et}function Pt(St,Et,Bt,Ut){var Wt=St.child;return St=Wt.sibling,Bt=_u(Wt,{mode:"visible",children:Bt}),!(Et.mode&1)&&(Bt.lanes=Ut),Bt.return=Et,Bt.sibling=null,St!==null&&(Ut=Et.deletions,Ut===null?(Et.deletions=[St],Et.flags|=16):Ut.push(St)),Et.child=Bt}function Nt(St,Et,Bt,Ut,Wt){var nn=Et.mode;St=St.child;var xn=St.sibling,On={mode:"hidden",children:Bt};return!(nn&1)&&Et.child!==St?(Bt=Et.child,Bt.childLanes=0,Bt.pendingProps=On,Et.deletions=null):(Bt=_u(St,On),Bt.subtreeFlags=St.subtreeFlags&14680064),xn!==null?Ut=_u(xn,Ut):(Ut=Gu(Ut,nn,Wt,null),Ut.flags|=2),Ut.return=Et,Bt.return=Et,Bt.sibling=Ut,Et.child=Bt,Ut}function Ft(St,Et,Bt,Ut){return Ut!==null&&bo(Ut),Jo(Et,St.child,null,Bt),St=Ct(Et,Et.pendingProps.children),St.flags|=2,Et.memoizedState=null,St}function Vt(St,Et,Bt){St.lanes|=Et;var Ut=St.alternate;Ut!==null&&(Ut.lanes|=Et),lo(St.return,Et,Bt)}function Qt(St,Et,Bt,Ut,Wt){var nn=St.memoizedState;nn===null?St.memoizedState={isBackwards:Et,rendering:null,renderingStartTime:0,last:Ut,tail:Bt,tailMode:Wt}:(nn.isBackwards=Et,nn.rendering=null,nn.renderingStartTime=0,nn.last=Ut,nn.tail=Bt,nn.tailMode=Wt)}function on(St,Et,Bt){var Ut=Et.pendingProps,Wt=Ut.revealOrder,nn=Ut.tail;if(po(St,Et,Ut.children,Bt),Ut=Os.current,Ut&2)Ut=Ut&1|2,Et.flags|=128;else{if(St!==null&&St.flags&128)e:for(St=Et.child;St!==null;){if(St.tag===13)St.memoizedState!==null&&Vt(St,Bt,Et);else if(St.tag===19)Vt(St,Bt,Et);else if(St.child!==null){St.child.return=St,St=St.child;continue}if(St===Et)break e;for(;St.sibling===null;){if(St.return===null||St.return===Et)break e;St=St.return}St.sibling.return=St.return,St=St.sibling}Ut&=1}if(cn(Os,Ut),!(Et.mode&1))Et.memoizedState=null;else switch(Wt){case"forwards":for(Bt=Et.child,Wt=null;Bt!==null;)St=Bt.alternate,St!==null&&Fl(St)===null&&(Wt=Bt),Bt=Bt.sibling;Bt=Wt,Bt===null?(Wt=Et.child,Et.child=null):(Wt=Bt.sibling,Bt.sibling=null),Qt(Et,!1,Wt,Bt,nn);break;case"backwards":for(Bt=null,Wt=Et.child,Et.child=null;Wt!==null;){if(St=Wt.alternate,St!==null&&Fl(St)===null){Et.child=Wt;break}St=Wt.sibling,Wt.sibling=Bt,Bt=Wt,Wt=St}Qt(Et,!0,Bt,null,nn);break;case"together":Qt(Et,!1,null,null,void 0);break;default:Et.memoizedState=null}return Et.child}function An(St,Et,Bt){if(St!==null&&(Et.dependencies=St.dependencies),sp|=Et.lanes,!(Bt&Et.childLanes))return null;if(St!==null&&Et.child!==St.child)throw Error(ot(153));if(Et.child!==null){for(St=Et.child,Bt=_u(St,St.pendingProps),Et.child=Bt,Bt.return=Et;St.sibling!==null;)St=St.sibling,Bt=Bt.sibling=_u(St,St.pendingProps),Bt.return=Et;Bt.sibling=null}return Et.child}function Tn(St,Et,Bt){switch(Et.tag){case 3:Rl(Et),ou();break;case 5:du(Et);break;case 1:ys(Et.type)&&Io(Et);break;case 4:Yu(Et,Et.stateNode.containerInfo);break;case 10:Yo(Et,Et.type._context,Et.memoizedProps.value);break;case 13:var Ut=Et.memoizedState;if(Ut!==null)return Ut.dehydrated!==null?(cn(Os,Os.current&1),Et.flags|=128,null):Bt&Et.child.childLanes?Mt(St,Et,Bt):(cn(Os,Os.current&1),St=An(St,Et,Bt),St!==null?St.sibling:null);cn(Os,Os.current&1);break;case 19:if(Ut=(Bt&Et.childLanes)!==0,St.flags&128){if(Ut)return on(St,Et,Bt);Et.flags|=128}var Wt=Et.memoizedState;if(Wt!==null&&(Wt.rendering=null,Wt.tail=null,Wt.lastEffect=null),cn(Os,Os.current),Ut)break;return null;case 22:case 23:return Et.lanes=0,np(St,Et,Bt)}return An(St,Et,Bt)}function Pn(St,Et){switch(cp(Et),Et.tag){case 1:return ys(Et.type)&&fn(),St=Et.flags,St&65536?(Et.flags=St&-65537|128,Et):null;case 3:return Ql(),wr(Xr),wr(cs),hp(),St=Et.flags,St&65536&&!(St&128)?(Et.flags=St&-65537|128,Et):null;case 5:return Bl(Et),null;case 13:if(wr(Os),St=Et.memoizedState,St!==null&&St.dehydrated!==null){if(Et.alternate===null)throw Error(ot(340));ou()}return St=Et.flags,St&65536?(Et.flags=St&-65537|128,Et):null;case 19:return wr(Os),null;case 4:return Ql(),null;case 10:return Is(Et.type._context),null;case 22:case 23:return $m(),null;case 24:return null;default:return null}}var bn=!1,Bn=!1,ur=typeof WeakSet=="function"?WeakSet:Set,Ln=null;function Hn(St,Et){var Bt=St.ref;if(Bt!==null)if(typeof Bt=="function")try{Bt(null)}catch(Ut){Uo(St,Et,Ut)}else Bt.current=null}function Kn(St,Et,Bt){try{Bt()}catch(Ut){Uo(St,Et,Ut)}}var kn=!1;function $r(St,Et){for(jt(St.containerInfo),Ln=Et;Ln!==null;)if(St=Ln,Et=St.child,(St.subtreeFlags&1028)!==0&&Et!==null)Et.return=St,Ln=Et;else for(;Ln!==null;){St=Ln;try{var Bt=St.alternate;if(St.flags&1024)switch(St.tag){case 0:case 11:case 15:break;case 1:if(Bt!==null){var Ut=Bt.memoizedProps,Wt=Bt.memoizedState,nn=St.stateNode,xn=nn.getSnapshotBeforeUpdate(St.elementType===St.type?Ut:ao(St.type,Ut),Wt);nn.__reactInternalSnapshotBeforeUpdate=xn}break;case 3:Vn&&Ir(St.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(ot(163))}}catch(On){Uo(St,St.return,On)}if(Et=St.sibling,Et!==null){Et.return=St.return,Ln=Et;break}Ln=St.return}return Bt=kn,kn=!1,Bt}function Br(St,Et,Bt){var Ut=Et.updateQueue;if(Ut=Ut!==null?Ut.lastEffect:null,Ut!==null){var Wt=Ut=Ut.next;do{if((Wt.tag&St)===St){var nn=Wt.destroy;Wt.destroy=void 0,nn!==void 0&&Kn(Et,Bt,nn)}Wt=Wt.next}while(Wt!==Ut)}}function Er(St,Et){if(Et=Et.updateQueue,Et=Et!==null?Et.lastEffect:null,Et!==null){var Bt=Et=Et.next;do{if((Bt.tag&St)===St){var Ut=Bt.create;Bt.destroy=Ut()}Bt=Bt.next}while(Bt!==Et)}}function Dr(St){var Et=St.ref;if(Et!==null){var Bt=St.stateNode;switch(St.tag){case 5:St=Zt(Bt);break;default:St=Bt}typeof Et=="function"?Et(St):Et.current=St}}function vs(St,Et,Bt){if(xo&&typeof xo.onCommitFiberUnmount=="function")try{xo.onCommitFiberUnmount(Il,Et)}catch{}switch(Et.tag){case 0:case 11:case 14:case 15:if(St=Et.updateQueue,St!==null&&(St=St.lastEffect,St!==null)){var Ut=St=St.next;do{var Wt=Ut,nn=Wt.destroy;Wt=Wt.tag,nn!==void 0&&(Wt&2||Wt&4)&&Kn(Et,Bt,nn),Ut=Ut.next}while(Ut!==St)}break;case 1:if(Hn(Et,Bt),St=Et.stateNode,typeof St.componentWillUnmount=="function")try{St.props=Et.memoizedProps,St.state=Et.memoizedState,St.componentWillUnmount()}catch(xn){Uo(Et,Bt,xn)}break;case 5:Hn(Et,Bt);break;case 4:Vn?Ms(St,Et,Bt):En&&En&&(Et=Et.stateNode.containerInfo,Bt=Pr(Et),Lr(Et,Bt))}}function fs(St,Et,Bt){for(var Ut=Et;;)if(vs(St,Ut,Bt),Ut.child===null||Vn&&Ut.tag===4){if(Ut===Et)break;for(;Ut.sibling===null;){if(Ut.return===null||Ut.return===Et)return;Ut=Ut.return}Ut.sibling.return=Ut.return,Ut=Ut.sibling}else Ut.child.return=Ut,Ut=Ut.child}function ms(St){var Et=St.alternate;Et!==null&&(St.alternate=null,ms(Et)),St.child=null,St.deletions=null,St.sibling=null,St.tag===5&&(Et=St.stateNode,Et!==null&&ir(Et)),St.stateNode=null,St.return=null,St.dependencies=null,St.memoizedProps=null,St.memoizedState=null,St.pendingProps=null,St.stateNode=null,St.updateQueue=null}function _i(St){return St.tag===5||St.tag===3||St.tag===4}function Zr(St){e:for(;;){for(;St.sibling===null;){if(St.return===null||_i(St.return))return null;St=St.return}for(St.sibling.return=St.return,St=St.sibling;St.tag!==5&&St.tag!==6&&St.tag!==18;){if(St.flags&2||St.child===null||St.tag===4)continue e;St.child.return=St,St=St.child}if(!(St.flags&2))return St.stateNode}}function es(St){if(Vn){e:{for(var Et=St.return;Et!==null;){if(_i(Et))break e;Et=Et.return}throw Error(ot(160))}var Bt=Et;switch(Bt.tag){case 5:Et=Bt.stateNode,Bt.flags&32&&(vr(Et),Bt.flags&=-33),Bt=Zr(St),Yr(St,Bt,Et);break;case 3:case 4:Et=Bt.stateNode.containerInfo,Bt=Zr(St),xs(St,Bt,Et);break;default:throw Error(ot(161))}}}function xs(St,Et,Bt){var Ut=St.tag;if(Ut===5||Ut===6)St=St.stateNode,Et?pr(Bt,St,Et):Tr(Bt,St);else if(Ut!==4&&(St=St.child,St!==null))for(xs(St,Et,Bt),St=St.sibling;St!==null;)xs(St,Et,Bt),St=St.sibling}function Yr(St,Et,Bt){var Ut=St.tag;if(Ut===5||Ut===6)St=St.stateNode,Et?br(Bt,St,Et):hr(Bt,St);else if(Ut!==4&&(St=St.child,St!==null))for(Yr(St,Et,Bt),St=St.sibling;St!==null;)Yr(St,Et,Bt),St=St.sibling}function Ms(St,Et,Bt){for(var Ut=Et,Wt=!1,nn,xn;;){if(!Wt){Wt=Ut.return;e:for(;;){if(Wt===null)throw Error(ot(160));switch(nn=Wt.stateNode,Wt.tag){case 5:xn=!1;break e;case 3:nn=nn.containerInfo,xn=!0;break e;case 4:nn=nn.containerInfo,xn=!0;break e}Wt=Wt.return}Wt=!0}if(Ut.tag===5||Ut.tag===6)fs(St,Ut,Bt),xn?qn(nn,Ut.stateNode):vn(nn,Ut.stateNode);else if(Ut.tag===18)xn?Un(nn,Ut.stateNode):Wn(nn,Ut.stateNode);else if(Ut.tag===4){if(Ut.child!==null){nn=Ut.stateNode.containerInfo,xn=!0,Ut.child.return=Ut,Ut=Ut.child;continue}}else if(vs(St,Ut,Bt),Ut.child!==null){Ut.child.return=Ut,Ut=Ut.child;continue}if(Ut===Et)break;for(;Ut.sibling===null;){if(Ut.return===null||Ut.return===Et)return;Ut=Ut.return,Ut.tag===4&&(Wt=!1)}Ut.sibling.return=Ut.return,Ut=Ut.sibling}}function io(St,Et){if(Vn){switch(Et.tag){case 0:case 11:case 14:case 15:Br(3,Et,Et.return),Er(3,Et),Br(5,Et,Et.return);return;case 1:return;case 5:var Bt=Et.stateNode;if(Bt!=null){var Ut=Et.memoizedProps;St=St!==null?St.memoizedProps:Ut;var Wt=Et.type,nn=Et.updateQueue;Et.updateQueue=null,nn!==null&&Rr(Bt,nn,Wt,St,Ut,Et)}return;case 6:if(Et.stateNode===null)throw Error(ot(162));Bt=Et.memoizedProps,cr(Et.stateNode,St!==null?St.memoizedProps:Bt,Bt);return;case 3:dn&&St!==null&&St.memoizedState.isDehydrated&&ln(Et.stateNode.containerInfo);return;case 12:return;case 13:Fu(Et);return;case 19:Fu(Et);return;case 17:return}throw Error(ot(163))}switch(Et.tag){case 0:case 11:case 14:case 15:Br(3,Et,Et.return),Er(3,Et),Br(5,Et,Et.return);return;case 12:return;case 13:Fu(Et);return;case 19:Fu(Et);return;case 3:dn&&St!==null&&St.memoizedState.isDehydrated&&ln(Et.stateNode.containerInfo);break;case 22:case 23:return}e:if(En){switch(Et.tag){case 1:case 5:case 6:break e;case 3:case 4:Et=Et.stateNode,Lr(Et.containerInfo,Et.pendingChildren);break e}throw Error(ot(163))}}function Fu(St){var Et=St.updateQueue;if(Et!==null){St.updateQueue=null;var Bt=St.stateNode;Bt===null&&(Bt=St.stateNode=new ur),Et.forEach(function(Ut){var Wt=D0.bind(null,St,Ut);Bt.has(Ut)||(Bt.add(Ut),Ut.then(Wt,Wt))})}}function S0(St,Et){for(Ln=Et;Ln!==null;){Et=Ln;var Bt=Et.deletions;if(Bt!==null)for(var Ut=0;Ut<Bt.length;Ut++){var Wt=Bt[Ut];try{var nn=St;Vn?Ms(nn,Wt,Et):fs(nn,Wt,Et);var xn=Wt.alternate;xn!==null&&(xn.return=null),Wt.return=null}catch(Hr){Uo(Wt,Et,Hr)}}if(Bt=Et.child,Et.subtreeFlags&12854&&Bt!==null)Bt.return=Et,Ln=Bt;else for(;Ln!==null;){Et=Ln;try{var On=Et.flags;if(On&32&&Vn&&vr(Et.stateNode),On&512){var dr=Et.alternate;if(dr!==null){var Mr=dr.ref;Mr!==null&&(typeof Mr=="function"?Mr(null):Mr.current=null)}}if(On&8192)switch(Et.tag){case 13:if(Et.memoizedState!==null){var Vr=Et.alternate;(Vr===null||Vr.memoizedState===null)&&(Cm=Ls())}break;case 22:var rs=Et.memoizedState!==null,Kr=Et.alternate,Ds=Kr!==null&&Kr.memoizedState!==null;if(Bt=Et,Vn){e:if(Ut=Bt,Wt=rs,nn=null,Vn)for(var qr=Ut;;){if(qr.tag===5){if(nn===null){nn=qr;var To=qr.stateNode;Wt?Sn(To):Nn(qr.stateNode,qr.memoizedProps)}}else if(qr.tag===6){if(nn===null){var ba=qr.stateNode;Wt?Ar(ba):nr(ba,qr.memoizedProps)}}else if((qr.tag!==22&&qr.tag!==23||qr.memoizedState===null||qr===Ut)&&qr.child!==null){qr.child.return=qr,qr=qr.child;continue}if(qr===Ut)break;for(;qr.sibling===null;){if(qr.return===null||qr.return===Ut)break e;nn===qr&&(nn=null),qr=qr.return}nn===qr&&(nn=null),qr.sibling.return=qr.return,qr=qr.sibling}}if(rs&&!Ds&&Bt.mode&1){Ln=Bt;for(var Zn=Bt.child;Zn!==null;){for(Bt=Ln=Zn;Ln!==null;){Ut=Ln;var Gn=Ut.child;switch(Ut.tag){case 0:case 11:case 14:case 15:Br(4,Ut,Ut.return);break;case 1:Hn(Ut,Ut.return);var ar=Ut.stateNode;if(typeof ar.componentWillUnmount=="function"){var Ur=Ut.return;try{ar.props=Ut.memoizedProps,ar.state=Ut.memoizedState,ar.componentWillUnmount()}catch(Hr){Uo(Ut,Ur,Hr)}}break;case 5:Hn(Ut,Ut.return);break;case 22:if(Ut.memoizedState!==null){Hm(Bt);continue}}Gn!==null?(Gn.return=Ut,Ln=Gn):Hm(Bt)}Zn=Zn.sibling}}}switch(On&4102){case 2:es(Et),Et.flags&=-3;break;case 6:es(Et),Et.flags&=-3,io(Et.alternate,Et);break;case 4096:Et.flags&=-4097;break;case 4100:Et.flags&=-4097,io(Et.alternate,Et);break;case 4:io(Et.alternate,Et)}}catch(Hr){Uo(Et,Et.return,Hr)}if(Bt=Et.sibling,Bt!==null){Bt.return=Et.return,Ln=Bt;break}Ln=Et.return}}}function T0(St,Et,Bt){Ln=St,Vm(St)}function Vm(St,Et,Bt){for(var Ut=(St.mode&1)!==0;Ln!==null;){var Wt=Ln,nn=Wt.child;if(Wt.tag===22&&Ut){var xn=Wt.memoizedState!==null||bn;if(!xn){var On=Wt.alternate,dr=On!==null&&On.memoizedState!==null||Bn;On=bn;var Mr=Bn;if(bn=xn,(Bn=dr)&&!Mr)for(Ln=Wt;Ln!==null;)xn=Ln,dr=xn.child,xn.tag===22&&xn.memoizedState!==null?jm(Wt):dr!==null?(dr.return=xn,Ln=dr):jm(Wt);for(;nn!==null;)Ln=nn,Vm(nn),nn=nn.sibling;Ln=Wt,bn=On,Bn=Mr}zm(St)}else Wt.subtreeFlags&8772&&nn!==null?(nn.return=Wt,Ln=nn):zm(St)}}function zm(St){for(;Ln!==null;){var Et=Ln;if(Et.flags&8772){var Bt=Et.alternate;try{if(Et.flags&8772)switch(Et.tag){case 0:case 11:case 15:Bn||Er(5,Et);break;case 1:var Ut=Et.stateNode;if(Et.flags&4&&!Bn)if(Bt===null)Ut.componentDidMount();else{var Wt=Et.elementType===Et.type?Bt.memoizedProps:ao(Et.type,Bt.memoizedProps);Ut.componentDidUpdate(Wt,Bt.memoizedState,Ut.__reactInternalSnapshotBeforeUpdate)}var nn=Et.updateQueue;nn!==null&&wp(Et,nn,Ut);break;case 3:var xn=Et.updateQueue;if(xn!==null){if(Bt=null,Et.child!==null)switch(Et.child.tag){case 5:Bt=Zt(Et.child.stateNode);break;case 1:Bt=Et.child.stateNode}wp(Et,xn,Bt)}break;case 5:var On=Et.stateNode;Bt===null&&Et.flags&4&&yr(On,Et.type,Et.memoizedProps,Et);break;case 6:break;case 4:break;case 12:break;case 13:if(dn&&Et.memoizedState===null){var dr=Et.alternate;if(dr!==null){var Mr=dr.memoizedState;if(Mr!==null){var Vr=Mr.dehydrated;Vr!==null&&Rn(Vr)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(ot(163))}Bn||Et.flags&512&&Dr(Et)}catch(rs){Uo(Et,Et.return,rs)}}if(Et===St){Ln=null;break}if(Bt=Et.sibling,Bt!==null){Bt.return=Et.return,Ln=Bt;break}Ln=Et.return}}function Hm(St){for(;Ln!==null;){var Et=Ln;if(Et===St){Ln=null;break}var Bt=Et.sibling;if(Bt!==null){Bt.return=Et.return,Ln=Bt;break}Ln=Et.return}}function jm(St){for(;Ln!==null;){var Et=Ln;try{switch(Et.tag){case 0:case 11:case 15:var Bt=Et.return;try{Er(4,Et)}catch(dr){Uo(Et,Bt,dr)}break;case 1:var Ut=Et.stateNode;if(typeof Ut.componentDidMount=="function"){var Wt=Et.return;try{Ut.componentDidMount()}catch(dr){Uo(Et,Wt,dr)}}var nn=Et.return;try{Dr(Et)}catch(dr){Uo(Et,nn,dr)}break;case 5:var xn=Et.return;try{Dr(Et)}catch(dr){Uo(Et,xn,dr)}}}catch(dr){Uo(Et,Et.return,dr)}if(Et===St){Ln=null;break}var On=Et.sibling;if(On!==null){On.return=Et.return,Ln=On;break}Ln=Et.return}}var em=0,tm=1,nm=2,rm=3,im=4;if(typeof Symbol=="function"&&Symbol.for){var _p=Symbol.for;em=_p("selector.component"),tm=_p("selector.has_pseudo_class"),nm=_p("selector.role"),rm=_p("selector.test_id"),im=_p("selector.text")}function bm(St){var Et=rr(St);if(Et!=null){if(typeof Et.memoizedProps["data-testname"]!="string")throw Error(ot(364));return Et}if(St=en(St),St===null)throw Error(ot(362));return St.stateNode.current}function Sm(St,Et){switch(Et.$$typeof){case em:if(St.type===Et.value)return!0;break;case tm:e:{Et=Et.value,St=[St,0];for(var Bt=0;Bt<St.length;){var Ut=St[Bt++],Wt=St[Bt++],nn=Et[Wt];if(Ut.tag!==5||!Mn(Ut)){for(;nn!=null&&Sm(Ut,nn);)Wt++,nn=Et[Wt];if(Wt===Et.length){Et=!0;break e}else for(Ut=Ut.child;Ut!==null;)St.push(Ut,Wt),Ut=Ut.sibling}}Et=!1}return Et;case nm:if(St.tag===5&&In(St.stateNode,Et.value))return!0;break;case im:if((St.tag===5||St.tag===6)&&(St=gn(St),St!==null&&0<=St.indexOf(Et.value)))return!0;break;case rm:if(St.tag===5&&(St=St.memoizedProps["data-testname"],typeof St=="string"&&St.toLowerCase()===Et.value.toLowerCase()))return!0;break;default:throw Error(ot(365))}return!1}function Tm(St){switch(St.$$typeof){case em:return"<"+(Lt(St.value)||"Unknown")+">";case tm:return":has("+(Tm(St)||"")+")";case nm:return'[role="'+St.value+'"]';case im:return'"'+St.value+'"';case rm:return'[data-testname="'+St.value+'"]';default:throw Error(ot(365))}}function qm(St,Et){var Bt=[];St=[St,0];for(var Ut=0;Ut<St.length;){var Wt=St[Ut++],nn=St[Ut++],xn=Et[nn];if(Wt.tag!==5||!Mn(Wt)){for(;xn!=null&&Sm(Wt,xn);)nn++,xn=Et[nn];if(nn===Et.length)Bt.push(Wt);else for(Wt=Wt.child;Wt!==null;)St.push(Wt,nn),Wt=Wt.sibling}}return Bt}function Em(St,Et){if(!un)throw Error(ot(363));St=bm(St),St=qm(St,Et),Et=[],St=Array.from(St);for(var Bt=0;Bt<St.length;){var Ut=St[Bt++];if(Ut.tag===5)Mn(Ut)||Et.push(Ut.stateNode);else for(Ut=Ut.child;Ut!==null;)St.push(Ut),Ut=Ut.sibling}return Et}var E0=Math.ceil,sm=at.ReactCurrentDispatcher,Mm=at.ReactCurrentOwner,Ys=at.ReactCurrentBatchConfig,hs=0,Js=null,Zs=null,vo=0,qo=0,ip=ns(0),so=0,bp=null,sp=0,om=0,wm=0,Sp=null,Oo=null,Cm=0,Rm=1/0;function op(){Rm=Ls()+500}var am=!1,Pm=null,gu=null,lm=!1,yu=null,cm=0,Tp=0,Lm=null,um=-1,hm=0;function Lo(){return hs&6?Ls():um!==-1?um:um=Ls()}function vu(St){return St.mode&1?hs&2&&vo!==0?vo&-vo:Gl.transition!==null?(hm===0&&(St=Wo,Wo<<=1,!(Wo&4194240)&&(Wo=64),hm=St),hm):(St=as,St!==0?St:Yn()):1}function ga(St,Et,Bt){if(50<Tp)throw Tp=0,Lm=null,Error(ot(185));var Ut=dm(St,Et);return Ut===null?null:(Xo(Ut,Et,Bt),(!(hs&2)||Ut!==Js)&&(Ut===Js&&(!(hs&2)&&(om|=Et),so===4&&xu(Ut,vo)),ko(Ut,Bt),Et===1&&hs===0&&!(St.mode&1)&&(op(),oo&&ro())),Ut)}function dm(St,Et){St.lanes|=Et;var Bt=St.alternate;for(Bt!==null&&(Bt.lanes|=Et),Bt=St,St=St.return;St!==null;)St.childLanes|=Et,Bt=St.alternate,Bt!==null&&(Bt.childLanes|=Et),Bt=St,St=St.return;return Bt.tag===3?Bt.stateNode:null}function ko(St,Et){var Bt=St.callbackNode;Tu(St,Et);var Ut=$a(St,St===Js?vo:0);if(Ut===0)Bt!==null&&tu(Bt),St.callbackNode=null,St.callbackPriority=0;else if(Et=Ut&-Ut,St.callbackPriority!==Et){if(Bt!=null&&tu(Bt),Et===1)St.tag===0?ru(Km.bind(null,St)):Ul(Km.bind(null,St)),Qn?sr(function(){hs===0&&ro()}):Al(yl,ro),Bt=null;else{switch(eu(Ut)){case 1:Bt=yl;break;case 4:Bt=zu;break;case 16:Bt=go;break;case 536870912:Bt=nu;break;default:Bt=go}Bt=r0(Bt,Wm.bind(null,St))}St.callbackPriority=Et,St.callbackNode=Bt}}function Wm(St,Et){if(um=-1,hm=0,hs&6)throw Error(ot(327));var Bt=St.callbackNode;if(Uu()&&St.callbackNode!==Bt)return null;var Ut=$a(St,St===Js?vo:0);if(Ut===0)return null;if(Ut&30||Ut&St.expiredLanes||Et)Et=fm(St,Ut);else{Et=Ut;var Wt=hs;hs|=2;var nn=Qm();(Js!==St||vo!==Et)&&(op(),Ou(St,Et));do try{R0();break}catch(On){Ym(St,On)}while(!0);_l(),sm.current=nn,hs=Wt,Zs!==null?Et=0:(Js=null,vo=0,Et=so)}if(Et!==0){if(Et===2&&(Wt=Ko(St),Wt!==0&&(Ut=Wt,Et=Im(St,Wt))),Et===1)throw Bt=bp,Ou(St,0),xu(St,Ut),ko(St,Ls()),Bt;if(Et===6)xu(St,Ut);else{if(Wt=St.current.alternate,!(Ut&30)&&!M0(Wt)&&(Et=fm(St,Ut),Et===2&&(nn=Ko(St),nn!==0&&(Ut=nn,Et=Im(St,nn))),Et===1))throw Bt=bp,Ou(St,0),xu(St,Ut),ko(St,Ls()),Bt;switch(St.finishedWork=Wt,St.finishedLanes=Ut,Et){case 0:case 1:throw Error(ot(345));case 2:ku(St,Oo);break;case 3:if(xu(St,Ut),(Ut&130023424)===Ut&&(Et=Cm+500-Ls(),10<Et)){if($a(St,0)!==0)break;if(Wt=St.suspendedLanes,(Wt&Ut)!==Ut){Lo(),St.pingedLanes|=St.suspendedLanes&Wt;break}St.timeoutHandle=yn(ku.bind(null,St,Oo),Et);break}ku(St,Oo);break;case 4:if(xu(St,Ut),(Ut&4194240)===Ut)break;for(Et=St.eventTimes,Wt=-1;0<Ut;){var xn=31-to(Ut);nn=1<<xn,xn=Et[xn],xn>Wt&&(Wt=xn),Ut&=~nn}if(Ut=Wt,Ut=Ls()-Ut,Ut=(120>Ut?120:480>Ut?480:1080>Ut?1080:1920>Ut?1920:3e3>Ut?3e3:4320>Ut?4320:1960*E0(Ut/1960))-Ut,10<Ut){St.timeoutHandle=yn(ku.bind(null,St,Oo),Ut);break}ku(St,Oo);break;case 5:ku(St,Oo);break;default:throw Error(ot(329))}}}return ko(St,Ls()),St.callbackNode===Bt?Wm.bind(null,St):null}function Im(St,Et){var Bt=Sp;return St.current.memoizedState.isDehydrated&&(Ou(St,Et).flags|=256),St=fm(St,Et),St!==2&&(Et=Oo,Oo=Bt,Et!==null&&Dm(Et)),St}function Dm(St){Oo===null?Oo=St:Oo.push.apply(Oo,St)}function M0(St){for(var Et=St;;){if(Et.flags&16384){var Bt=Et.updateQueue;if(Bt!==null&&(Bt=Bt.stores,Bt!==null))for(var Ut=0;Ut<Bt.length;Ut++){var Wt=Bt[Ut],nn=Wt.getSnapshot;Wt=Wt.value;try{if(!Eo(nn(),Wt))return!1}catch{return!1}}}if(Bt=Et.child,Et.subtreeFlags&16384&&Bt!==null)Bt.return=Et,Et=Bt;else{if(Et===St)break;for(;Et.sibling===null;){if(Et.return===null||Et.return===St)return!0;Et=Et.return}Et.sibling.return=Et.return,Et=Et.sibling}}return!0}function xu(St,Et){for(Et&=~wm,Et&=~om,St.suspendedLanes|=Et,St.pingedLanes&=~Et,St=St.expirationTimes;0<Et;){var Bt=31-to(Et),Ut=1<<Bt;St[Bt]=-1,Et&=~Ut}}function Km(St){if(hs&6)throw Error(ot(327));Uu();var Et=$a(St,0);if(!(Et&1))return ko(St,Ls()),null;var Bt=fm(St,Et);if(St.tag!==0&&Bt===2){var Ut=Ko(St);Ut!==0&&(Et=Ut,Bt=Im(St,Ut))}if(Bt===1)throw Bt=bp,Ou(St,0),xu(St,Et),ko(St,Ls()),Bt;if(Bt===6)throw Error(ot(345));return St.finishedWork=St.current.alternate,St.finishedLanes=Et,ku(St,Oo),ko(St,Ls()),null}function Xm(St){yu!==null&&yu.tag===0&&!(hs&6)&&Uu();var Et=hs;hs|=1;var Bt=Ys.transition,Ut=as;try{if(Ys.transition=null,as=1,St)return St()}finally{as=Ut,Ys.transition=Bt,hs=Et,!(hs&6)&&ro()}}function $m(){qo=ip.current,wr(ip)}function Ou(St,Et){St.finishedWork=null,St.finishedLanes=0;var Bt=St.timeoutHandle;if(Bt!==Jn&&(St.timeoutHandle=Jn,$n(Bt)),Zs!==null)for(Bt=Zs.return;Bt!==null;){var Ut=Bt;switch(cp(Ut),Ut.tag){case 1:Ut=Ut.type.childContextTypes,Ut!=null&&fn();break;case 3:Ql(),wr(Xr),wr(cs),hp();break;case 5:Bl(Ut);break;case 4:Ql();break;case 13:wr(Os);break;case 19:wr(Os);break;case 10:Is(Ut.type._context);break;case 22:case 23:$m()}Bt=Bt.return}if(Js=St,Zs=St=_u(St.current,null),vo=qo=Et,so=0,bp=null,wm=om=sp=0,Oo=Sp=null,Mo!==null){for(Et=0;Et<Mo.length;Et++)if(Bt=Mo[Et],Ut=Bt.interleaved,Ut!==null){Bt.interleaved=null;var Wt=Ut.next,nn=Bt.pending;if(nn!==null){var xn=nn.next;nn.next=Wt,Ut.next=xn}Bt.pending=Ut}Mo=null}return St}function Ym(St,Et){do{var Bt=Zs;try{if(_l(),Qu.current=_h,Lu){for(var Ut=zs.memoizedState;Ut!==null;){var Wt=Ut.queue;Wt!==null&&(Wt.pending=null),Ut=Ut.next}Lu=!1}if(fu=0,js=co=zs=null,Jl=!1,Iu=0,Mm.current=null,Bt===null||Bt.return===null){so=1,bp=Et,Zs=null;break}e:{var nn=St,xn=Bt.return,On=Bt,dr=Et;if(Et=vo,On.flags|=32768,dr!==null&&typeof dr=="object"&&typeof dr.then=="function"){var Mr=dr,Vr=On,rs=Vr.tag;if(!(Vr.mode&1)&&(rs===0||rs===11||rs===15)){var Kr=Vr.alternate;Kr?(Vr.updateQueue=Kr.updateQueue,Vr.memoizedState=Kr.memoizedState,Vr.lanes=Kr.lanes):(Vr.updateQueue=null,Vr.memoizedState=null)}var Ds=Zp(xn);if(Ds!==null){Ds.flags&=-257,Cl(Ds,xn,On,nn,Et),Ds.mode&1&&Jp(nn,Mr,Et),Et=Ds,dr=Mr;var qr=Et.updateQueue;if(qr===null){var To=new Set;To.add(dr),Et.updateQueue=To}else qr.add(dr);break e}else{if(!(Et&1)){Jp(nn,Mr,Et),Nm();break e}dr=Error(ot(426))}}else if(Ns&&On.mode&1){var ba=Zp(xn);if(ba!==null){!(ba.flags&65536)&&(ba.flags|=256),Cl(ba,xn,On,nn,Et),bo(dr);break e}}nn=dr,so!==4&&(so=2),Sp===null?Sp=[nn]:Sp.push(nn),dr=_d(dr,On),On=xn;do{switch(On.tag){case 3:On.flags|=65536,Et&=-Et,On.lanes|=Et;var Zn=Yp(On,dr,Et);Mp(On,Zn);break e;case 1:nn=dr;var Gn=On.type,ar=On.stateNode;if(!(On.flags&128)&&(typeof Gn.getDerivedStateFromError=="function"||ar!==null&&typeof ar.componentDidCatch=="function"&&(gu===null||!gu.has(ar)))){On.flags|=65536,Et&=-Et,On.lanes|=Et;var Ur=Qp(On,nn,Et);Mp(On,Ur);break e}}On=On.return}while(On!==null)}Zm(Bt)}catch(Hr){Et=Hr,Zs===Bt&&Bt!==null&&(Zs=Bt=Bt.return);continue}break}while(!0)}function Qm(){var St=sm.current;return sm.current=_h,St===null?_h:St}function Nm(){(so===0||so===3||so===2)&&(so=4),Js===null||!(sp&268435455)&&!(om&268435455)||xu(Js,vo)}function fm(St,Et){var Bt=hs;hs|=2;var Ut=Qm();Js===St&&vo===Et||Ou(St,Et);do try{C0();break}catch(Wt){Ym(St,Wt)}while(!0);if(_l(),hs=Bt,sm.current=Ut,Zs!==null)throw Error(ot(261));return Js=null,vo=0,so}function C0(){for(;Zs!==null;)Jm(Zs)}function R0(){for(;Zs!==null&&!Eu();)Jm(Zs)}function Jm(St){var Et=n0(St.alternate,St,qo);St.memoizedProps=St.pendingProps,Et===null?Zm(St):Zs=Et,Mm.current=null}function Zm(St){var Et=St;do{var Bt=Et.alternate;if(St=Et.return,Et.flags&32768){if(Bt=Pn(Bt,Et),Bt!==null){Bt.flags&=32767,Zs=Bt;return}if(St!==null)St.flags|=32768,St.subtreeFlags=0,St.deletions=null;else{so=6,Zs=null;return}}else if(Bt=fo(Bt,Et,qo),Bt!==null){Zs=Bt;return}if(Et=Et.sibling,Et!==null){Zs=Et;return}Zs=Et=St}while(Et!==null);so===0&&(so=5)}function ku(St,Et){var Bt=as,Ut=Ys.transition;try{Ys.transition=null,as=1,P0(St,Et,Bt)}finally{Ys.transition=Ut,as=Bt}return null}function P0(St,Et,Bt){do Uu();while(yu!==null);if(hs&6)throw Error(ot(327));var Ut=St.finishedWork,Wt=St.finishedLanes;if(Ut===null)return null;if(St.finishedWork=null,St.finishedLanes=0,Ut===St.current)throw Error(ot(177));St.callbackNode=null,St.callbackPriority=0;var nn=Ut.lanes|Ut.childLanes;if(Ll(St,nn),St===Js&&(Zs=Js=null,vo=0),!(Ut.subtreeFlags&2064)&&!(Ut.flags&2064)||lm||(lm=!0,r0(go,function(){return Uu(),null})),nn=(Ut.flags&15990)!==0,Ut.subtreeFlags&15990||nn){nn=Ys.transition,Ys.transition=null;var xn=as;as=1;var On=hs;hs|=4,Mm.current=null,$r(St,Ut),S0(St,Ut),Kt(St.containerInfo),St.current=Ut,T0(Ut),Mu(),hs=On,as=xn,Ys.transition=nn}else St.current=Ut;if(lm&&(lm=!1,yu=St,cm=Wt),nn=St.pendingLanes,nn===0&&(gu=null),wu(Ut.stateNode),ko(St,Ls()),Et!==null)for(Bt=St.onRecoverableError,Ut=0;Ut<Et.length;Ut++)Bt(Et[Ut]);if(am)throw am=!1,St=Pm,Pm=null,St;return cm&1&&St.tag!==0&&Uu(),nn=St.pendingLanes,nn&1?St===Lm?Tp++:(Tp=0,Lm=St):Tp=0,ro(),null}function Uu(){if(yu!==null){var St=eu(cm),Et=Ys.transition,Bt=as;try{if(Ys.transition=null,as=16>St?16:St,yu===null)var Ut=!1;else{if(St=yu,yu=null,cm=0,hs&6)throw Error(ot(331));var Wt=hs;for(hs|=4,Ln=St.current;Ln!==null;){var nn=Ln,xn=nn.child;if(Ln.flags&16){var On=nn.deletions;if(On!==null){for(var dr=0;dr<On.length;dr++){var Mr=On[dr];for(Ln=Mr;Ln!==null;){var Vr=Ln;switch(Vr.tag){case 0:case 11:case 15:Br(8,Vr,nn)}var rs=Vr.child;if(rs!==null)rs.return=Vr,Ln=rs;else for(;Ln!==null;){Vr=Ln;var Kr=Vr.sibling,Ds=Vr.return;if(ms(Vr),Vr===Mr){Ln=null;break}if(Kr!==null){Kr.return=Ds,Ln=Kr;break}Ln=Ds}}}var qr=nn.alternate;if(qr!==null){var To=qr.child;if(To!==null){qr.child=null;do{var ba=To.sibling;To.sibling=null,To=ba}while(To!==null)}}Ln=nn}}if(nn.subtreeFlags&2064&&xn!==null)xn.return=nn,Ln=xn;else e:for(;Ln!==null;){if(nn=Ln,nn.flags&2048)switch(nn.tag){case 0:case 11:case 15:Br(9,nn,nn.return)}var Zn=nn.sibling;if(Zn!==null){Zn.return=nn.return,Ln=Zn;break e}Ln=nn.return}}var Gn=St.current;for(Ln=Gn;Ln!==null;){xn=Ln;var ar=xn.child;if(xn.subtreeFlags&2064&&ar!==null)ar.return=xn,Ln=ar;else e:for(xn=Gn;Ln!==null;){if(On=Ln,On.flags&2048)try{switch(On.tag){case 0:case 11:case 15:Er(9,On)}}catch(Hr){Uo(On,On.return,Hr)}if(On===xn){Ln=null;break e}var Ur=On.sibling;if(Ur!==null){Ur.return=On.return,Ln=Ur;break e}Ln=On.return}}if(hs=Wt,ro(),xo&&typeof xo.onPostCommitFiberRoot=="function")try{xo.onPostCommitFiberRoot(Il,St)}catch{}Ut=!0}return Ut}finally{as=Bt,Ys.transition=Et}}return!1}function e0(St,Et,Bt){Et=_d(Bt,Et),Et=Yp(St,Et,1),$l(St,Et),Et=Lo(),St=dm(St,1),St!==null&&(Xo(St,1,Et),ko(St,Et))}function Uo(St,Et,Bt){if(St.tag===3)e0(St,St,Bt);else for(;Et!==null;){if(Et.tag===3){e0(Et,St,Bt);break}else if(Et.tag===1){var Ut=Et.stateNode;if(typeof Et.type.getDerivedStateFromError=="function"||typeof Ut.componentDidCatch=="function"&&(gu===null||!gu.has(Ut))){St=_d(Bt,St),St=Qp(Et,St,1),$l(Et,St),St=Lo(),Et=dm(Et,1),Et!==null&&(Xo(Et,1,St),ko(Et,St));break}}Et=Et.return}}function L0(St,Et,Bt){var Ut=St.pingCache;Ut!==null&&Ut.delete(Et),Et=Lo(),St.pingedLanes|=St.suspendedLanes&Bt,Js===St&&(vo&Bt)===Bt&&(so===4||so===3&&(vo&130023424)===vo&&500>Ls()-Cm?Ou(St,0):wm|=Bt),ko(St,Et)}function t0(St,Et){Et===0&&(St.mode&1?(Et=no,no<<=1,!(no&130023424)&&(no=4194304)):Et=1);var Bt=Lo();St=dm(St,Et),St!==null&&(Xo(St,Et,Bt),ko(St,Bt))}function I0(St){var Et=St.memoizedState,Bt=0;Et!==null&&(Bt=Et.retryLane),t0(St,Bt)}function D0(St,Et){var Bt=0;switch(St.tag){case 13:var Ut=St.stateNode,Wt=St.memoizedState;Wt!==null&&(Bt=Wt.retryLane);break;case 19:Ut=St.stateNode;break;default:throw Error(ot(314))}Ut!==null&&Ut.delete(Et),t0(St,Bt)}var n0;n0=function(St,Et,Bt){if(St!==null)if(St.memoizedProps!==Et.pendingProps||Xr.current)Qs=!0;else{if(!(St.lanes&Bt)&&!(Et.flags&128))return Qs=!1,Tn(St,Et,Bt);Qs=!!(St.flags&131072)}else Qs=!1,Ns&&Et.flags&1048576&&Cu(Et,Xu,Et.index);switch(Et.lanes=0,Et.tag){case 2:var Ut=Et.type;St!==null&&(St.alternate=null,Et.alternate=null,Et.flags|=2),St=Et.pendingProps;var Wt=Ws(Et,cs.current);Vs(Et,Bt),Wt=fp(null,Et,Ut,St,Wt,Bt);var nn=pp();return Et.flags|=1,typeof Wt=="object"&&Wt!==null&&typeof Wt.render=="function"&&Wt.$$typeof===void 0?(Et.tag=1,Et.memoizedState=null,Et.updateQueue=null,ys(Ut)?(nn=!0,Io(Et)):nn=!1,Et.memoizedState=Wt.state!==null&&Wt.state!==void 0?Wt.state:null,ju(Et),Wt.updater=Ku,Et.stateNode=Wt,Wt._reactInternals=Et,lp(Et,Ut,St,Bt),Et=rp(null,Et,Ut,!0,nn,Bt)):(Et.tag=0,Ns&&nn&&Es(Et),po(null,Et,Wt,Bt),Et=Et.child),Et;case 16:Ut=Et.elementType;e:{switch(St!==null&&(St.alternate=null,Et.alternate=null,Et.flags|=2),St=Et.pendingProps,Wt=Ut._init,Ut=Wt(Ut._payload),Et.type=Ut,Wt=Et.tag=N0(Ut),St=ao(Ut,St),Wt){case 0:Et=Au(null,Et,Ut,St,Bt);break e;case 1:Et=Ol(null,Et,Ut,St,Bt);break e;case 11:Et=_r(null,Et,Ut,St,Bt);break e;case 14:Et=Cr(null,Et,Ut,ao(Ut.type,St),Bt);break e}throw Error(ot(306,Ut,""))}return Et;case 0:return Ut=Et.type,Wt=Et.pendingProps,Wt=Et.elementType===Ut?Wt:ao(Ut,Wt),Au(St,Et,Ut,Wt,Bt);case 1:return Ut=Et.type,Wt=Et.pendingProps,Wt=Et.elementType===Ut?Wt:ao(Ut,Wt),Ol(St,Et,Ut,Wt,Bt);case 3:e:{if(Rl(Et),St===null)throw Error(ot(387));Ut=Et.pendingProps,nn=Et.memoizedState,Wt=nn.element,Ep(St,Et),Wu(Et,Ut,null,Bt);var xn=Et.memoizedState;if(Ut=xn.element,dn&&nn.isDehydrated)if(nn={element:Ut,isDehydrated:!1,cache:xn.cache,transitions:xn.transitions},Et.updateQueue.baseState=nn,Et.memoizedState=nn,Et.flags&256){Wt=Error(ot(423)),Et=vt(St,Et,Ut,Bt,Wt);break e}else if(Ut!==Wt){Wt=Error(ot(424)),Et=vt(St,Et,Ut,Bt,Wt);break e}else for(dn&&(Ro=Or(Et.stateNode.containerInfo),Co=Et,Ns=!0,zo=null,Ru=!1),Bt=Dp(Et,null,Ut,Bt),Et.child=Bt;Bt;)Bt.flags=Bt.flags&-3|4096,Bt=Bt.sibling;else{if(ou(),Ut===Wt){Et=An(St,Et,Bt);break e}po(St,Et,Ut,Bt)}Et=Et.child}return Et;case 5:return du(Et),St===null&&Ml(Et),Ut=Et.type,Wt=Et.pendingProps,nn=St!==null?St.memoizedProps:null,xn=Wt.children,pn(Ut,Wt)?xn=null:nn!==null&&pn(Ut,nn)&&(Et.flags|=32),Bu(St,Et),po(St,Et,xn,Bt),Et.child;case 6:return St===null&&Ml(Et),null;case 13:return Mt(St,Et,Bt);case 4:return Yu(Et,Et.stateNode.containerInfo),Ut=Et.pendingProps,St===null?Et.child=Jo(Et,null,Ut,Bt):po(St,Et,Ut,Bt),Et.child;case 11:return Ut=Et.type,Wt=Et.pendingProps,Wt=Et.elementType===Ut?Wt:ao(Ut,Wt),_r(St,Et,Ut,Wt,Bt);case 7:return po(St,Et,Et.pendingProps,Bt),Et.child;case 8:return po(St,Et,Et.pendingProps.children,Bt),Et.child;case 12:return po(St,Et,Et.pendingProps.children,Bt),Et.child;case 10:e:{if(Ut=Et.type._context,Wt=Et.pendingProps,nn=Et.memoizedProps,xn=Wt.value,Yo(Et,Ut,xn),nn!==null)if(Eo(nn.value,xn)){if(nn.children===Wt.children&&!Xr.current){Et=An(St,Et,Bt);break e}}else for(nn=Et.child,nn!==null&&(nn.return=Et);nn!==null;){var On=nn.dependencies;if(On!==null){xn=nn.child;for(var dr=On.firstContext;dr!==null;){if(dr.context===Ut){if(nn.tag===1){dr=Sl(-1,Bt&-Bt),dr.tag=2;var Mr=nn.updateQueue;if(Mr!==null){Mr=Mr.shared;var Vr=Mr.pending;Vr===null?dr.next=dr:(dr.next=Vr.next,Vr.next=dr),Mr.pending=dr}}nn.lanes|=Bt,dr=nn.alternate,dr!==null&&(dr.lanes|=Bt),lo(nn.return,Bt,Et),On.lanes|=Bt;break}dr=dr.next}}else if(nn.tag===10)xn=nn.type===Et.type?null:nn.child;else if(nn.tag===18){if(xn=nn.return,xn===null)throw Error(ot(341));xn.lanes|=Bt,On=xn.alternate,On!==null&&(On.lanes|=Bt),lo(xn,Bt,Et),xn=nn.sibling}else xn=nn.child;if(xn!==null)xn.return=nn;else for(xn=nn;xn!==null;){if(xn===Et){xn=null;break}if(nn=xn.sibling,nn!==null){nn.return=xn.return,xn=nn;break}xn=xn.return}nn=xn}po(St,Et,Wt.children,Bt),Et=Et.child}return Et;case 9:return Wt=Et.type,Ut=Et.pendingProps.children,Vs(Et,Bt),Wt=Fs(Wt),Ut=Ut(Wt),Et.flags|=1,po(St,Et,Ut,Bt),Et.child;case 14:return Ut=Et.type,Wt=ao(Ut,Et.pendingProps),Wt=ao(Ut.type,Wt),Cr(St,Et,Ut,Wt,Bt);case 15:return xp(St,Et,Et.type,Et.pendingProps,Bt);case 17:return Ut=Et.type,Wt=Et.pendingProps,Wt=Et.elementType===Ut?Wt:ao(Ut,Wt),St!==null&&(St.alternate=null,Et.alternate=null,Et.flags|=2),Et.tag=1,ys(Ut)?(St=!0,Io(Et)):St=!1,Vs(Et,Bt),Pp(Et,Ut,Wt),lp(Et,Ut,Wt,Bt),rp(null,Et,Ut,!0,St,Bt);case 19:return on(St,Et,Bt);case 22:return np(St,Et,Bt)}throw Error(ot(156,Et.tag))};function r0(St,Et){return Al(St,Et)}function $0(St,Et,Bt,Ut){this.tag=St,this.key=Bt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Et,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Ut,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xa(St,Et,Bt,Ut){return new $0(St,Et,Bt,Ut)}function Bm(St){return St=St.prototype,!(!St||!St.isReactComponent)}function N0(St){if(typeof St=="function")return Bm(St)?1:0;if(St!=null){if(St=St.$$typeof,St===mt)return 11;if(St===bt)return 14}return 2}function _u(St,Et){var Bt=St.alternate;return Bt===null?(Bt=xa(St.tag,Et,St.key,St.mode),Bt.elementType=St.elementType,Bt.type=St.type,Bt.stateNode=St.stateNode,Bt.alternate=St,St.alternate=Bt):(Bt.pendingProps=Et,Bt.type=St.type,Bt.flags=0,Bt.subtreeFlags=0,Bt.deletions=null),Bt.flags=St.flags&14680064,Bt.childLanes=St.childLanes,Bt.lanes=St.lanes,Bt.child=St.child,Bt.memoizedProps=St.memoizedProps,Bt.memoizedState=St.memoizedState,Bt.updateQueue=St.updateQueue,Et=St.dependencies,Bt.dependencies=Et===null?null:{lanes:Et.lanes,firstContext:Et.firstContext},Bt.sibling=St.sibling,Bt.index=St.index,Bt.ref=St.ref,Bt}function pm(St,Et,Bt,Ut,Wt,nn){var xn=2;if(Ut=St,typeof St=="function")Bm(St)&&(xn=1);else if(typeof St=="string")xn=5;else e:switch(St){case ut:return Gu(Bt.children,Wt,nn,Et);case ht:xn=8,Wt|=8;break;case dt:return St=xa(12,Bt,Et,Wt|2),St.elementType=dt,St.lanes=nn,St;case At:return St=xa(13,Bt,Et,Wt),St.elementType=At,St.lanes=nn,St;case gt:return St=xa(19,Bt,Et,Wt),St.elementType=gt,St.lanes=nn,St;case wt:return mm(Bt,Wt,nn,Et);default:if(typeof St=="object"&&St!==null)switch(St.$$typeof){case ft:xn=10;break e;case pt:xn=9;break e;case mt:xn=11;break e;case bt:xn=14;break e;case Tt:xn=16,Ut=null;break e}throw Error(ot(130,St==null?St:typeof St,""))}return Et=xa(xn,Bt,Et,Wt),Et.elementType=St,Et.type=Ut,Et.lanes=nn,Et}function Gu(St,Et,Bt,Ut){return St=xa(7,St,Ut,Et),St.lanes=Bt,St}function mm(St,Et,Bt,Ut){return St=xa(22,St,Ut,Et),St.elementType=wt,St.lanes=Bt,St.stateNode={},St}function Fm(St,Et,Bt){return St=xa(6,St,null,Et),St.lanes=Bt,St}function Om(St,Et,Bt){return Et=xa(4,St.children!==null?St.children:[],St.key,Et),Et.lanes=Bt,Et.stateNode={containerInfo:St.containerInfo,pendingChildren:null,implementation:St.implementation},Et}function B0(St,Et,Bt,Ut,Wt){this.tag=Et,this.containerInfo=St,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Jn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_c(0),this.expirationTimes=_c(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_c(0),this.identifierPrefix=Ut,this.onRecoverableError=Wt,dn&&(this.mutableSourceEagerHydrationData=null)}function i0(St,Et,Bt,Ut,Wt,nn,xn,On,dr){return St=new B0(St,Et,Bt,On,dr),Et===1?(Et=1,nn===!0&&(Et|=8)):Et=0,nn=xa(3,null,null,Et),St.current=nn,nn.stateNode=St,nn.memoizedState={element:Ut,isDehydrated:Bt,cache:null,transitions:null},ju(nn),St}function s0(St){if(!St)return mr;St=St._reactInternals;e:{if(kt(St)!==St||St.tag!==1)throw Error(ot(170));var Et=St;do{switch(Et.tag){case 3:Et=Et.stateNode.context;break e;case 1:if(ys(Et.type)){Et=Et.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Et=Et.return}while(Et!==null);throw Error(ot(171))}if(St.tag===1){var Bt=St.type;if(ys(Bt))return Ao(St,Bt,Et)}return Et}function o0(St){var Et=St._reactInternals;if(Et===void 0)throw typeof St.render=="function"?Error(ot(188)):(St=Object.keys(St).join(","),Error(ot(268,St)));return St=zt(Et),St===null?null:St.stateNode}function a0(St,Et){if(St=St.memoizedState,St!==null&&St.dehydrated!==null){var Bt=St.retryLane;St.retryLane=Bt!==0&&Bt<Et?Bt:Et}}function km(St,Et){a0(St,Et),(St=St.alternate)&&a0(St,Et)}function F0(St){return St=zt(St),St===null?null:St.stateNode}function O0(){return null}return et.attemptContinuousHydration=function(St){if(St.tag===13){var Et=Lo();ga(St,134217728,Et),km(St,134217728)}},et.attemptHydrationAtCurrentPriority=function(St){if(St.tag===13){var Et=Lo(),Bt=vu(St);ga(St,Bt,Et),km(St,Bt)}},et.attemptSynchronousHydration=function(St){switch(St.tag){case 3:var Et=St.stateNode;if(Et.current.memoizedState.isDehydrated){var Bt=Cs(Et.pendingLanes);Bt!==0&&(ps(Et,Bt|1),ko(Et,Ls()),!(hs&6)&&(op(),ro()))}break;case 13:var Ut=Lo();Xm(function(){return ga(St,1,Ut)}),km(St,1)}},et.batchedUpdates=function(St,Et){var Bt=hs;hs|=1;try{return St(Et)}finally{hs=Bt,hs===0&&(op(),oo&&ro())}},et.createComponentSelector=function(St){return{$$typeof:em,value:St}},et.createContainer=function(St,Et,Bt,Ut,Wt,nn,xn){return i0(St,Et,!1,null,Bt,Ut,Wt,nn,xn)},et.createHasPseudoClassSelector=function(St){return{$$typeof:tm,value:St}},et.createHydrationContainer=function(St,Et,Bt,Ut,Wt,nn,xn,On,dr){return St=i0(Bt,Ut,!0,St,Wt,nn,xn,On,dr),St.context=s0(null),Bt=St.current,Ut=Lo(),Wt=vu(Bt),nn=Sl(Ut,Wt),nn.callback=Et??null,$l(Bt,nn),St.current.lanes=Wt,Xo(St,Wt,Ut),ko(St,Ut),St},et.createPortal=function(St,Et,Bt){var Ut=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ct,key:Ut==null?null:""+Ut,children:St,containerInfo:Et,implementation:Bt}},et.createRoleSelector=function(St){return{$$typeof:nm,value:St}},et.createTestNameSelector=function(St){return{$$typeof:rm,value:St}},et.createTextSelector=function(St){return{$$typeof:im,value:St}},et.deferredUpdates=function(St){var Et=as,Bt=Ys.transition;try{return Ys.transition=null,as=16,St()}finally{as=Et,Ys.transition=Bt}},et.discreteUpdates=function(St,Et,Bt,Ut,Wt){var nn=as,xn=Ys.transition;try{return Ys.transition=null,as=1,St(Et,Bt,Ut,Wt)}finally{as=nn,Ys.transition=xn,hs===0&&op()}},et.findAllNodes=Em,et.findBoundingRects=function(St,Et){if(!un)throw Error(ot(363));Et=Em(St,Et),St=[];for(var Bt=0;Bt<Et.length;Bt++)St.push(wn(Et[Bt]));for(Et=St.length-1;0<Et;Et--){Bt=St[Et];for(var Ut=Bt.x,Wt=Ut+Bt.width,nn=Bt.y,xn=nn+Bt.height,On=Et-1;0<=On;On--)if(Et!==On){var dr=St[On],Mr=dr.x,Vr=Mr+dr.width,rs=dr.y,Kr=rs+dr.height;if(Ut>=Mr&&nn>=rs&&Wt<=Vr&&xn<=Kr){St.splice(Et,1);break}else if(Ut!==Mr||Bt.width!==dr.width||Kr<nn||rs>xn){if(!(nn!==rs||Bt.height!==dr.height||Vr<Ut||Mr>Wt)){Mr>Ut&&(dr.width+=Mr-Ut,dr.x=Ut),Vr<Wt&&(dr.width=Wt-Mr),St.splice(Et,1);break}}else{rs>nn&&(dr.height+=rs-nn,dr.y=nn),Kr<xn&&(dr.height=xn-rs),St.splice(Et,1);break}}}return St},et.findHostInstance=o0,et.findHostInstanceWithNoPortals=function(St){return St=Ot(St),St=St!==null?Yt(St):null,St===null?null:St.stateNode},et.findHostInstanceWithWarning=function(St){return o0(St)},et.flushControlled=function(St){var Et=hs;hs|=1;var Bt=Ys.transition,Ut=as;try{Ys.transition=null,as=1,St()}finally{as=Ut,Ys.transition=Bt,hs=Et,hs===0&&(op(),ro())}},et.flushPassiveEffects=Uu,et.flushSync=Xm,et.focusWithin=function(St,Et){if(!un)throw Error(ot(363));for(St=bm(St),Et=qm(St,Et),Et=Array.from(Et),St=0;St<Et.length;){var Bt=Et[St++];if(!Mn(Bt)){if(Bt.tag===5&&gr(Bt.stateNode))return!0;for(Bt=Bt.child;Bt!==null;)Et.push(Bt),Bt=Bt.sibling}}return!1},et.getCurrentUpdatePriority=function(){return as},et.getFindAllNodesFailureDescription=function(St,Et){if(!un)throw Error(ot(363));var Bt=0,Ut=[];St=[bm(St),0];for(var Wt=0;Wt<St.length;){var nn=St[Wt++],xn=St[Wt++],On=Et[xn];if((nn.tag!==5||!Mn(nn))&&(Sm(nn,On)&&(Ut.push(Tm(On)),xn++,xn>Bt&&(Bt=xn)),xn<Et.length))for(nn=nn.child;nn!==null;)St.push(nn,xn),nn=nn.sibling}if(Bt<Et.length){for(St=[];Bt<Et.length;Bt++)St.push(Tm(Et[Bt]));return`findAllNodes was able to match part of the selector:
  `+(Ut.join(" > ")+`

No matching component was found for:
  `)+St.join(" > ")}return null},et.getPublicRootInstance=function(St){if(St=St.current,!St.child)return null;switch(St.child.tag){case 5:return Zt(St.child.stateNode);default:return St.child.stateNode}},et.injectIntoDevTools=function(St){if(St={bundleType:St.bundleType,version:St.version,rendererPackageName:St.rendererPackageName,rendererConfig:St.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:at.ReactCurrentDispatcher,findHostInstanceByFiber:F0,findFiberByHostInstance:St.findFiberByHostInstance||O0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")St=!1;else{var Et=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(Et.isDisabled||!Et.supportsFiber)St=!0;else{try{Il=Et.inject(St),xo=Et}catch{}St=!!Et.checkDCE}}return St},et.isAlreadyRendering=function(){return!1},et.observeVisibleRects=function(St,Et,Bt,Ut){if(!un)throw Error(ot(363));St=Em(St,Et);var Wt=jn(St,Bt,Ut).disconnect;return{disconnect:function(){Wt()}}},et.registerMutableSourceForHydration=function(St,Et){var Bt=Et._getVersion;Bt=Bt(Et._source),St.mutableSourceEagerHydrationData==null?St.mutableSourceEagerHydrationData=[Et,Bt]:St.mutableSourceEagerHydrationData.push(Et,Bt)},et.runWithPriority=function(St,Et){var Bt=as;try{return as=St,Et()}finally{as=Bt}},et.shouldError=function(){return null},et.shouldSuspend=function(){return!1},et.updateContainer=function(St,Et,Bt,Ut){var Wt=Et.current,nn=Lo(),xn=vu(Wt);return Bt=s0(Bt),Et.context===null?Et.context=Bt:Et.pendingContext=Bt,Et=Sl(nn,xn),Et.payload={element:St},Ut=Ut===void 0?null:Ut,Ut!==null&&(Et.callback=Ut),$l(Wt,Et),St=ga(Wt,xn,nn),St!==null&&qu(St,Wt,xn),xn},et};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs$1(reactReconcilerExports);var scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(nt){function _e(Gt,jt){var Kt=Gt.length;Gt.push(jt);e:for(;0<Kt;){var Jt=Kt-1>>>1,sn=Gt[Jt];if(0<it(sn,jt))Gt[Jt]=jt,Gt[Kt]=sn,Kt=Jt;else break e}}function et(Gt){return Gt.length===0?null:Gt[0]}function rt(Gt){if(Gt.length===0)return null;var jt=Gt[0],Kt=Gt.pop();if(Kt!==jt){Gt[0]=Kt;e:for(var Jt=0,sn=Gt.length,hn=sn>>>1;Jt<hn;){var an=2*(Jt+1)-1,pn=Gt[an],_n=an+1,yn=Gt[_n];if(0>it(pn,Kt))_n<sn&&0>it(yn,pn)?(Gt[Jt]=yn,Gt[_n]=Kt,Jt=_n):(Gt[Jt]=pn,Gt[an]=Kt,Jt=an);else if(_n<sn&&0>it(yn,Kt))Gt[Jt]=yn,Gt[_n]=Kt,Jt=_n;else break e}}return jt}function it(Gt,jt){var Kt=Gt.sortIndex-jt.sortIndex;return Kt!==0?Kt:Gt.id-jt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;nt.unstable_now=function(){return st.now()}}else{var ot=Date,at=ot.now();nt.unstable_now=function(){return ot.now()-at}}var lt=[],ct=[],ut=1,ht=null,dt=3,ft=!1,pt=!1,mt=!1,At=typeof setTimeout=="function"?setTimeout:null,gt=typeof clearTimeout=="function"?clearTimeout:null,bt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Tt(Gt){for(var jt=et(ct);jt!==null;){if(jt.callback===null)rt(ct);else if(jt.startTime<=Gt)rt(ct),jt.sortIndex=jt.expirationTime,_e(lt,jt);else break;jt=et(ct)}}function wt(Gt){if(mt=!1,Tt(Gt),!pt)if(et(lt)!==null)pt=!0,Zt(Rt);else{var jt=et(ct);jt!==null&&rn(wt,jt.startTime-Gt)}}function Rt(Gt,jt){pt=!1,mt&&(mt=!1,gt($t),$t=-1),ft=!0;var Kt=dt;try{for(Tt(jt),ht=et(lt);ht!==null&&(!(ht.expirationTime>jt)||Gt&&!Ot());){var Jt=ht.callback;if(typeof Jt=="function"){ht.callback=null,dt=ht.priorityLevel;var sn=Jt(ht.expirationTime<=jt);jt=nt.unstable_now(),typeof sn=="function"?ht.callback=sn:ht===et(lt)&&rt(lt),Tt(jt)}else rt(lt);ht=et(lt)}if(ht!==null)var hn=!0;else{var an=et(ct);an!==null&&rn(wt,an.startTime-jt),hn=!1}return hn}finally{ht=null,dt=Kt,ft=!1}}var It=!1,Lt=null,$t=-1,kt=5,Dt=-1;function Ot(){return!(nt.unstable_now()-Dt<kt)}function zt(){if(Lt!==null){var Gt=nt.unstable_now();Dt=Gt;var jt=!0;try{jt=Lt(!0,Gt)}finally{jt?Ht():(It=!1,Lt=null)}}else It=!1}var Ht;if(typeof bt=="function")Ht=function(){bt(zt)};else if(typeof MessageChannel<"u"){var Yt=new MessageChannel,Xt=Yt.port2;Yt.port1.onmessage=zt,Ht=function(){Xt.postMessage(null)}}else Ht=function(){At(zt,0)};function Zt(Gt){Lt=Gt,It||(It=!0,Ht())}function rn(Gt,jt){$t=At(function(){Gt(nt.unstable_now())},jt)}nt.unstable_IdlePriority=5,nt.unstable_ImmediatePriority=1,nt.unstable_LowPriority=4,nt.unstable_NormalPriority=3,nt.unstable_Profiling=null,nt.unstable_UserBlockingPriority=2,nt.unstable_cancelCallback=function(Gt){Gt.callback=null},nt.unstable_continueExecution=function(){pt||ft||(pt=!0,Zt(Rt))},nt.unstable_forceFrameRate=function(Gt){0>Gt||125<Gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<Gt?Math.floor(1e3/Gt):5},nt.unstable_getCurrentPriorityLevel=function(){return dt},nt.unstable_getFirstCallbackNode=function(){return et(lt)},nt.unstable_next=function(Gt){switch(dt){case 1:case 2:case 3:var jt=3;break;default:jt=dt}var Kt=dt;dt=jt;try{return Gt()}finally{dt=Kt}},nt.unstable_pauseExecution=function(){},nt.unstable_requestPaint=function(){},nt.unstable_runWithPriority=function(Gt,jt){switch(Gt){case 1:case 2:case 3:case 4:case 5:break;default:Gt=3}var Kt=dt;dt=Gt;try{return jt()}finally{dt=Kt}},nt.unstable_scheduleCallback=function(Gt,jt,Kt){var Jt=nt.unstable_now();switch(typeof Kt=="object"&&Kt!==null?(Kt=Kt.delay,Kt=typeof Kt=="number"&&0<Kt?Jt+Kt:Jt):Kt=Jt,Gt){case 1:var sn=-1;break;case 2:sn=250;break;case 5:sn=1073741823;break;case 4:sn=1e4;break;default:sn=5e3}return sn=Kt+sn,Gt={id:ut++,callback:jt,priorityLevel:Gt,startTime:Kt,expirationTime:sn,sortIndex:-1},Kt>Jt?(Gt.sortIndex=Kt,_e(ct,Gt),et(lt)===null&&Gt===et(ct)&&(mt?(gt($t),$t=-1):mt=!0,rn(wt,Kt-Jt))):(Gt.sortIndex=sn,_e(lt,Gt),pt||ft||(pt=!0,Zt(Rt))),Gt},nt.unstable_shouldYield=Ot,nt.unstable_wrapCallback=function(Gt){var jt=dt;return function(){var Kt=dt;dt=jt;try{return Gt.apply(this,arguments)}finally{dt=Kt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;const catalogue={},extend$1=nt=>void Object.assign(catalogue,nt);function createRenderer(nt,_e){function et(ut,{args:ht=[],attach:dt,...ft},pt){let mt=`${ut[0].toUpperCase()}${ut.slice(1)}`,At;if(ut==="primitive"){if(ft.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const gt=ft.object;At=prepare(gt,{type:ut,root:pt,attach:dt,primitive:!0})}else{const gt=catalogue[mt];if(!gt)throw new Error(`R3F: ${mt} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(ht))throw new Error("R3F: The args prop must be an array!");At=prepare(new gt(...ht),{type:ut,root:pt,attach:dt,memoizedProps:{args:ht}})}return At.__r3f.attach===void 0&&(At instanceof BufferGeometry$1?At.__r3f.attach="geometry":At instanceof Material$1&&(At.__r3f.attach="material")),mt!=="inject"&&applyProps$1(At,ft),At}function rt(ut,ht){let dt=!1;if(ht){var ft,pt;(ft=ht.__r3f)!=null&&ft.attach?attach(ut,ht,ht.__r3f.attach):ht.isObject3D&&ut.isObject3D&&(ut.add(ht),dt=!0),dt||(pt=ut.__r3f)==null||pt.objects.push(ht),ht.__r3f||prepare(ht,{}),ht.__r3f.parent=ut,updateInstance(ht),invalidateInstance(ht)}}function it(ut,ht,dt){let ft=!1;if(ht){var pt,mt;if((pt=ht.__r3f)!=null&&pt.attach)attach(ut,ht,ht.__r3f.attach);else if(ht.isObject3D&&ut.isObject3D){ht.parent=ut,ht.dispatchEvent({type:"added"}),ut.dispatchEvent({type:"childadded",child:ht});const At=ut.children.filter(bt=>bt!==ht),gt=At.indexOf(dt);ut.children=[...At.slice(0,gt),ht,...At.slice(gt)],ft=!0}ft||(mt=ut.__r3f)==null||mt.objects.push(ht),ht.__r3f||prepare(ht,{}),ht.__r3f.parent=ut,updateInstance(ht),invalidateInstance(ht)}}function st(ut,ht,dt=!1){ut&&[...ut].forEach(ft=>ot(ht,ft,dt))}function ot(ut,ht,dt){if(ht){var ft,pt,mt;if(ht.__r3f&&(ht.__r3f.parent=null),(ft=ut.__r3f)!=null&&ft.objects&&(ut.__r3f.objects=ut.__r3f.objects.filter(wt=>wt!==ht)),(pt=ht.__r3f)!=null&&pt.attach)detach(ut,ht,ht.__r3f.attach);else if(ht.isObject3D&&ut.isObject3D){var At;ut.remove(ht),(At=ht.__r3f)!=null&&At.root&&removeInteractivity(findInitialRoot(ht),ht)}const bt=(mt=ht.__r3f)==null?void 0:mt.primitive,Tt=!bt&&(dt===void 0?ht.dispose!==null:dt);if(!bt){var gt;st((gt=ht.__r3f)==null?void 0:gt.objects,ht,Tt),st(ht.children,ht,Tt)}if(delete ht.__r3f,Tt&&ht.dispose&&ht.type!=="Scene"){const wt=()=>{try{ht.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,wt):wt()}invalidateInstance(ut)}}function at(ut,ht,dt,ft){var pt;const mt=(pt=ut.__r3f)==null?void 0:pt.parent;if(!mt)return;const At=et(ht,dt,ut.__r3f.root);if(ut.children){for(const gt of ut.children)gt.__r3f&&rt(At,gt);ut.children=ut.children.filter(gt=>!gt.__r3f)}ut.__r3f.objects.forEach(gt=>rt(At,gt)),ut.__r3f.objects=[],ut.__r3f.autoRemovedBeforeAppend||ot(mt,ut),At.parent&&(At.__r3f.autoRemovedBeforeAppend=!0),rt(mt,At),At.raycast&&At.__r3f.eventCount&&findInitialRoot(At).getState().internal.interaction.push(At),[ft,ft.alternate].forEach(gt=>{gt!==null&&(gt.stateNode=At,gt.ref&&(typeof gt.ref=="function"?gt.ref(At):gt.ref.current=At))})}const lt=()=>{};return{reconciler:Reconciler({createInstance:et,removeChild:ot,appendChild:rt,appendInitialChild:rt,insertBefore:it,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(ut,ht)=>{if(!ht)return;const dt=ut.getState().scene;dt.__r3f&&(dt.__r3f.root=ut,rt(dt,ht))},removeChildFromContainer:(ut,ht)=>{ht&&ot(ut.getState().scene,ht)},insertInContainerBefore:(ut,ht,dt)=>{if(!ht||!dt)return;const ft=ut.getState().scene;ft.__r3f&&it(ft,ht,dt)},getRootHostContext:()=>null,getChildHostContext:ut=>ut,finalizeInitialChildren(ut){var ht;return!!((ht=ut==null?void 0:ut.__r3f)!=null?ht:{}).handlers},prepareUpdate(ut,ht,dt,ft){var pt;if(((pt=ut==null?void 0:ut.__r3f)!=null?pt:{}).primitive&&ft.object&&ft.object!==ut)return[!0];{const{args:At=[],children:gt,...bt}=ft,{args:Tt=[],children:wt,...Rt}=dt;if(!Array.isArray(At))throw new Error("R3F: the args prop must be an array!");if(At.some((Lt,$t)=>Lt!==Tt[$t]))return[!0];const It=diffProps(ut,bt,Rt,!0);return It.changes.length?[!1,It]:null}},commitUpdate(ut,[ht,dt],ft,pt,mt,At){ht?at(ut,ft,mt,At):applyProps$1(ut,dt)},commitMount(ut,ht,dt,ft){var pt;const mt=(pt=ut.__r3f)!=null?pt:{};ut.raycast&&mt.handlers&&mt.eventCount&&findInitialRoot(ut).getState().internal.interaction.push(ut)},getPublicInstance:ut=>ut,prepareForCommit:()=>null,preparePortalMount:ut=>prepare(ut.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(ut){var ht;const{attach:dt,parent:ft}=(ht=ut.__r3f)!=null?ht:{};dt&&ft&&detach(ft,ut,dt),ut.isObject3D&&(ut.visible=!1),invalidateInstance(ut)},unhideInstance(ut,ht){var dt;const{attach:ft,parent:pt}=(dt=ut.__r3f)!=null?dt:{};ft&&pt&&attach(pt,ut,ft),(ut.isObject3D&&ht.visible==null||ht.visible)&&(ut.visible=!0),invalidateInstance(ut)},createTextInstance:lt,hideTextInstance:lt,unhideTextInstance:lt,getCurrentEventPriority:()=>_e?_e():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document$1,_window$navigator$1;const hasColorSpace=nt=>"colorSpace"in nt||"outputColorSpace"in nt,getColorManagement=()=>{var nt;return(nt=catalogue.ColorManagement)!=null?nt:null},isOrthographicCamera=nt=>nt&&nt.isOrthographicCamera,isRef=nt=>nt&&nt.hasOwnProperty("current"),useIsomorphicLayoutEffect$2=typeof window<"u"&&((_window$document$1=window.document)!=null&&_window$document$1.createElement||((_window$navigator$1=window.navigator)==null?void 0:_window$navigator$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(nt){const _e=reactExports.useRef(nt);return useIsomorphicLayoutEffect$2(()=>void(_e.current=nt),[nt]),_e}function Block({set:nt}){return useIsomorphicLayoutEffect$2(()=>(nt(new Promise(()=>null)),()=>nt(!1)),[nt]),null}class ErrorBoundary extends reactExports.Component{constructor(..._e){super(..._e),this.state={error:!1}}componentDidCatch(_e){this.props.set(_e)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=nt=>nt&&!!nt.memoized&&!!nt.changes;function calculateDpr(nt){var _e;const et=typeof window<"u"?(_e=window.devicePixelRatio)!=null?_e:2:1;return Array.isArray(nt)?Math.min(Math.max(nt[0],et),nt[1]):nt}const getRootState=nt=>{var _e;return(_e=nt.__r3f)==null?void 0:_e.root.getState()};function findInitialRoot(nt){let _e=nt.__r3f.root;for(;_e.getState().previousRoot;)_e=_e.getState().previousRoot;return _e}const is={obj:nt=>nt===Object(nt)&&!is.arr(nt)&&typeof nt!="function",fun:nt=>typeof nt=="function",str:nt=>typeof nt=="string",num:nt=>typeof nt=="number",boo:nt=>typeof nt=="boolean",und:nt=>nt===void 0,arr:nt=>Array.isArray(nt),equ(nt,_e,{arrays:et="shallow",objects:rt="reference",strict:it=!0}={}){if(typeof nt!=typeof _e||!!nt!=!!_e)return!1;if(is.str(nt)||is.num(nt)||is.boo(nt))return nt===_e;const st=is.obj(nt);if(st&&rt==="reference")return nt===_e;const ot=is.arr(nt);if(ot&&et==="reference")return nt===_e;if((ot||st)&&nt===_e)return!0;let at;for(at in nt)if(!(at in _e))return!1;if(st&&et==="shallow"&&rt==="shallow"){for(at in it?_e:nt)if(!is.equ(nt[at],_e[at],{strict:it,objects:"reference"}))return!1}else for(at in it?_e:nt)if(nt[at]!==_e[at])return!1;if(is.und(at)){if(ot&&nt.length===0&&_e.length===0||st&&Object.keys(nt).length===0&&Object.keys(_e).length===0)return!0;if(nt!==_e)return!1}return!0}};function buildGraph(nt){const _e={nodes:{},materials:{}};return nt&&nt.traverse(et=>{et.name&&(_e.nodes[et.name]=et),et.material&&!_e.materials[et.material.name]&&(_e.materials[et.material.name]=et.material)}),_e}function dispose(nt){nt.dispose&&nt.type!=="Scene"&&nt.dispose();for(const _e in nt)_e.dispose==null||_e.dispose(),delete nt[_e]}function prepare(nt,_e){const et=nt;return et.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._e},nt}function resolve(nt,_e){let et=nt;if(_e.includes("-")){const rt=_e.split("-"),it=rt.pop();return et=rt.reduce((st,ot)=>st[ot],nt),{target:et,key:it}}else return{target:et,key:_e}}const INDEX_REGEX=/-\d+$/;function attach(nt,_e,et){if(is.str(et)){if(INDEX_REGEX.test(et)){const st=et.replace(INDEX_REGEX,""),{target:ot,key:at}=resolve(nt,st);Array.isArray(ot[at])||(ot[at]=[])}const{target:rt,key:it}=resolve(nt,et);_e.__r3f.previousAttach=rt[it],rt[it]=_e}else _e.__r3f.previousAttach=et(nt,_e)}function detach(nt,_e,et){var rt,it;if(is.str(et)){const{target:st,key:ot}=resolve(nt,et),at=_e.__r3f.previousAttach;at===void 0?delete st[ot]:st[ot]=at}else(rt=_e.__r3f)==null||rt.previousAttach==null||rt.previousAttach(nt,_e);(it=_e.__r3f)==null||delete it.previousAttach}function diffProps(nt,{children:_e,key:et,ref:rt,...it},{children:st,key:ot,ref:at,...lt}={},ct=!1){const ut=nt.__r3f,ht=Object.entries(it),dt=[];if(ct){const pt=Object.keys(lt);for(let mt=0;mt<pt.length;mt++)it.hasOwnProperty(pt[mt])||ht.unshift([pt[mt],DEFAULT+"remove"])}ht.forEach(([pt,mt])=>{var At;if((At=nt.__r3f)!=null&&At.primitive&&pt==="object"||is.equ(mt,lt[pt]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(pt))return dt.push([pt,mt,!0,[]]);let gt=[];pt.includes("-")&&(gt=pt.split("-")),dt.push([pt,mt,!1,gt]);for(const bt in it){const Tt=it[bt];bt.startsWith(`${pt}-`)&&dt.push([bt,Tt,!1,bt.split("-")])}});const ft={...it};return ut!=null&&ut.memoizedProps&&ut!=null&&ut.memoizedProps.args&&(ft.args=ut.memoizedProps.args),ut!=null&&ut.memoizedProps&&ut!=null&&ut.memoizedProps.attach&&(ft.attach=ut.memoizedProps.attach),{memoized:ft,changes:dt}}const __DEV__=typeof process<"u"&&!1;function applyProps$1(nt,_e){var et;const rt=nt.__r3f,it=rt==null?void 0:rt.root,st=it==null||it.getState==null?void 0:it.getState(),{memoized:ot,changes:at}=isDiffSet(_e)?_e:diffProps(nt,_e),lt=rt==null?void 0:rt.eventCount;nt.__r3f&&(nt.__r3f.memoizedProps=ot);for(let ut=0;ut<at.length;ut++){let[ht,dt,ft,pt]=at[ut];if(hasColorSpace(nt)){const bt="srgb",Tt="srgb-linear";ht==="encoding"?(ht="colorSpace",dt=dt===3001?bt:Tt):ht==="outputEncoding"&&(ht="outputColorSpace",dt=dt===3001?bt:Tt)}let mt=nt,At=mt[ht];if(pt.length&&(At=pt.reduce((gt,bt)=>gt[bt],nt),!(At&&At.set))){const[gt,...bt]=pt.reverse();mt=bt.reverse().reduce((Tt,wt)=>Tt[wt],nt),ht=gt}if(dt===DEFAULT+"remove")if(mt.constructor){let gt=DEFAULTS.get(mt.constructor);gt||(gt=new mt.constructor,DEFAULTS.set(mt.constructor,gt)),dt=gt[ht]}else dt=0;if(ft&&rt)dt?rt.handlers[ht]=dt:delete rt.handlers[ht],rt.eventCount=Object.keys(rt.handlers).length;else if(At&&At.set&&(At.copy||At instanceof Layers$1)){if(Array.isArray(dt))At.fromArray?At.fromArray(dt):At.set(...dt);else if(At.copy&&dt&&dt.constructor&&(__DEV__?At.constructor.name===dt.constructor.name:At.constructor===dt.constructor))At.copy(dt);else if(dt!==void 0){const gt=At instanceof Color$2;!gt&&At.setScalar?At.setScalar(dt):At instanceof Layers$1&&dt instanceof Layers$1?At.mask=dt.mask:At.set(dt),!getColorManagement()&&st&&!st.linear&&gt&&At.convertSRGBToLinear()}}else if(mt[ht]=dt,mt[ht]instanceof Texture$1&&mt[ht].format===RGBAFormat$1&&mt[ht].type===UnsignedByteType$1&&st){const gt=mt[ht];hasColorSpace(gt)&&hasColorSpace(st.gl)?gt.colorSpace=st.gl.outputColorSpace:gt.encoding=st.gl.outputEncoding}invalidateInstance(nt)}if(rt&&rt.parent&&nt.raycast&&lt!==rt.eventCount){const ut=findInitialRoot(nt).getState().internal,ht=ut.interaction.indexOf(nt);ht>-1&&ut.interaction.splice(ht,1),rt.eventCount&&ut.interaction.push(nt)}return!(at.length===1&&at[0][0]==="onUpdate")&&at.length&&(et=nt.__r3f)!=null&&et.parent&&updateInstance(nt),nt}function invalidateInstance(nt){var _e,et;const rt=(_e=nt.__r3f)==null||(et=_e.root)==null||et.getState==null?void 0:et.getState();rt&&rt.internal.frames===0&&rt.invalidate()}function updateInstance(nt){nt.onUpdate==null||nt.onUpdate(nt)}function updateCamera(nt,_e){nt.manual||(isOrthographicCamera(nt)?(nt.left=_e.width/-2,nt.right=_e.width/2,nt.top=_e.height/2,nt.bottom=_e.height/-2):nt.aspect=_e.width/_e.height,nt.updateProjectionMatrix(),nt.updateMatrixWorld())}function makeId(nt){return(nt.eventObject||nt.object).uuid+"/"+nt.index+nt.instanceId}function getEventPriority(){var nt;const _e=typeof self<"u"&&self||typeof window<"u"&&window;if(!_e)return constantsExports.DefaultEventPriority;switch((nt=_e.event)==null?void 0:nt.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(nt,_e,et,rt){const it=et.get(_e);it&&(et.delete(_e),et.size===0&&(nt.delete(rt),it.target.releasePointerCapture(rt)))}function removeInteractivity(nt,_e){const{internal:et}=nt.getState();et.interaction=et.interaction.filter(rt=>rt!==_e),et.initialHits=et.initialHits.filter(rt=>rt!==_e),et.hovered.forEach((rt,it)=>{(rt.eventObject===_e||rt.object===_e)&&et.hovered.delete(it)}),et.capturedMap.forEach((rt,it)=>{releaseInternalPointerCapture(et.capturedMap,_e,rt,it)})}function createEvents(nt){function _e(lt){const{internal:ct}=nt.getState(),ut=lt.offsetX-ct.initialClick[0],ht=lt.offsetY-ct.initialClick[1];return Math.round(Math.sqrt(ut*ut+ht*ht))}function et(lt){return lt.filter(ct=>["Move","Over","Enter","Out","Leave"].some(ut=>{var ht;return(ht=ct.__r3f)==null?void 0:ht.handlers["onPointer"+ut]}))}function rt(lt,ct){const ut=nt.getState(),ht=new Set,dt=[],ft=ct?ct(ut.internal.interaction):ut.internal.interaction;for(let gt=0;gt<ft.length;gt++){const bt=getRootState(ft[gt]);bt&&(bt.raycaster.camera=void 0)}ut.previousRoot||ut.events.compute==null||ut.events.compute(lt,ut);function pt(gt){const bt=getRootState(gt);if(!bt||!bt.events.enabled||bt.raycaster.camera===null)return[];if(bt.raycaster.camera===void 0){var Tt;bt.events.compute==null||bt.events.compute(lt,bt,(Tt=bt.previousRoot)==null?void 0:Tt.getState()),bt.raycaster.camera===void 0&&(bt.raycaster.camera=null)}return bt.raycaster.camera?bt.raycaster.intersectObject(gt,!0):[]}let mt=ft.flatMap(pt).sort((gt,bt)=>{const Tt=getRootState(gt.object),wt=getRootState(bt.object);return!Tt||!wt?gt.distance-bt.distance:wt.events.priority-Tt.events.priority||gt.distance-bt.distance}).filter(gt=>{const bt=makeId(gt);return ht.has(bt)?!1:(ht.add(bt),!0)});ut.events.filter&&(mt=ut.events.filter(mt,ut));for(const gt of mt){let bt=gt.object;for(;bt;){var At;(At=bt.__r3f)!=null&&At.eventCount&&dt.push({...gt,eventObject:bt}),bt=bt.parent}}if("pointerId"in lt&&ut.internal.capturedMap.has(lt.pointerId))for(let gt of ut.internal.capturedMap.get(lt.pointerId).values())ht.has(makeId(gt.intersection))||dt.push(gt.intersection);return dt}function it(lt,ct,ut,ht){const dt=nt.getState();if(lt.length){const ft={stopped:!1};for(const pt of lt){const mt=getRootState(pt.object)||dt,{raycaster:At,pointer:gt,camera:bt,internal:Tt}=mt,wt=new Vector3$1(gt.x,gt.y,0).unproject(bt),Rt=Dt=>{var Ot,zt;return(Ot=(zt=Tt.capturedMap.get(Dt))==null?void 0:zt.has(pt.eventObject))!=null?Ot:!1},It=Dt=>{const Ot={intersection:pt,target:ct.target};Tt.capturedMap.has(Dt)?Tt.capturedMap.get(Dt).set(pt.eventObject,Ot):Tt.capturedMap.set(Dt,new Map([[pt.eventObject,Ot]])),ct.target.setPointerCapture(Dt)},Lt=Dt=>{const Ot=Tt.capturedMap.get(Dt);Ot&&releaseInternalPointerCapture(Tt.capturedMap,pt.eventObject,Ot,Dt)};let $t={};for(let Dt in ct){let Ot=ct[Dt];typeof Ot!="function"&&($t[Dt]=Ot)}let kt={...pt,...$t,pointer:gt,intersections:lt,stopped:ft.stopped,delta:ut,unprojectedPoint:wt,ray:At.ray,camera:bt,stopPropagation(){const Dt="pointerId"in ct&&Tt.capturedMap.get(ct.pointerId);if((!Dt||Dt.has(pt.eventObject))&&(kt.stopped=ft.stopped=!0,Tt.hovered.size&&Array.from(Tt.hovered.values()).find(Ot=>Ot.eventObject===pt.eventObject))){const Ot=lt.slice(0,lt.indexOf(pt));st([...Ot,pt])}},target:{hasPointerCapture:Rt,setPointerCapture:It,releasePointerCapture:Lt},currentTarget:{hasPointerCapture:Rt,setPointerCapture:It,releasePointerCapture:Lt},nativeEvent:ct};if(ht(kt),ft.stopped===!0)break}}return lt}function st(lt){const{internal:ct}=nt.getState();for(const ut of ct.hovered.values())if(!lt.length||!lt.find(ht=>ht.object===ut.object&&ht.index===ut.index&&ht.instanceId===ut.instanceId)){const dt=ut.eventObject.__r3f,ft=dt==null?void 0:dt.handlers;if(ct.hovered.delete(makeId(ut)),dt!=null&&dt.eventCount){const pt={...ut,intersections:lt};ft.onPointerOut==null||ft.onPointerOut(pt),ft.onPointerLeave==null||ft.onPointerLeave(pt)}}}function ot(lt,ct){for(let ut=0;ut<ct.length;ut++){const ht=ct[ut].__r3f;ht==null||ht.handlers.onPointerMissed==null||ht.handlers.onPointerMissed(lt)}}function at(lt){switch(lt){case"onPointerLeave":case"onPointerCancel":return()=>st([]);case"onLostPointerCapture":return ct=>{const{internal:ut}=nt.getState();"pointerId"in ct&&ut.capturedMap.has(ct.pointerId)&&requestAnimationFrame(()=>{ut.capturedMap.has(ct.pointerId)&&(ut.capturedMap.delete(ct.pointerId),st([]))})}}return function(ut){const{onPointerMissed:ht,internal:dt}=nt.getState();dt.lastEvent.current=ut;const ft=lt==="onPointerMove",pt=lt==="onClick"||lt==="onContextMenu"||lt==="onDoubleClick",At=rt(ut,ft?et:void 0),gt=pt?_e(ut):0;lt==="onPointerDown"&&(dt.initialClick=[ut.offsetX,ut.offsetY],dt.initialHits=At.map(Tt=>Tt.eventObject)),pt&&!At.length&&gt<=2&&(ot(ut,dt.interaction),ht&&ht(ut)),ft&&st(At);function bt(Tt){const wt=Tt.eventObject,Rt=wt.__r3f,It=Rt==null?void 0:Rt.handlers;if(Rt!=null&&Rt.eventCount)if(ft){if(It.onPointerOver||It.onPointerEnter||It.onPointerOut||It.onPointerLeave){const Lt=makeId(Tt),$t=dt.hovered.get(Lt);$t?$t.stopped&&Tt.stopPropagation():(dt.hovered.set(Lt,Tt),It.onPointerOver==null||It.onPointerOver(Tt),It.onPointerEnter==null||It.onPointerEnter(Tt))}It.onPointerMove==null||It.onPointerMove(Tt)}else{const Lt=It[lt];Lt?(!pt||dt.initialHits.includes(wt))&&(ot(ut,dt.interaction.filter($t=>!dt.initialHits.includes($t))),Lt(Tt)):pt&&dt.initialHits.includes(wt)&&ot(ut,dt.interaction.filter($t=>!dt.initialHits.includes($t)))}}it(At,ut,gt,bt)}}return{handlePointer:at}}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=nt=>!!(nt!=null&&nt.render),context$2=reactExports.createContext(null),createStore=(nt,_e)=>{const et=create((at,lt)=>{const ct=new Vector3$1,ut=new Vector3$1,ht=new Vector3$1;function dt(gt=lt().camera,bt=ut,Tt=lt().size){const{width:wt,height:Rt,top:It,left:Lt}=Tt,$t=wt/Rt;bt instanceof Vector3$1?ht.copy(bt):ht.set(...bt);const kt=gt.getWorldPosition(ct).distanceTo(ht);if(isOrthographicCamera(gt))return{width:wt/gt.zoom,height:Rt/gt.zoom,top:It,left:Lt,factor:1,distance:kt,aspect:$t};{const Dt=gt.fov*Math.PI/180,Ot=2*Math.tan(Dt/2)*kt,zt=Ot*(wt/Rt);return{width:zt,height:Ot,top:It,left:Lt,factor:wt/zt,distance:kt,aspect:$t}}}let ft;const pt=gt=>at(bt=>({performance:{...bt.performance,current:gt}})),mt=new Vector2$1;return{set:at,get:lt,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(gt=1)=>nt(lt(),gt),advance:(gt,bt)=>_e(gt,bt,lt()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:mt,mouse:mt,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const gt=lt();ft&&clearTimeout(ft),gt.performance.current!==gt.performance.min&&pt(gt.performance.min),ft=setTimeout(()=>pt(lt().performance.max),gt.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:dt},setEvents:gt=>at(bt=>({...bt,events:{...bt.events,...gt}})),setSize:(gt,bt,Tt,wt,Rt)=>{const It=lt().camera,Lt={width:gt,height:bt,top:wt||0,left:Rt||0,updateStyle:Tt};at($t=>({size:Lt,viewport:{...$t.viewport,...dt(It,ut,Lt)}}))},setDpr:gt=>at(bt=>{const Tt=calculateDpr(gt);return{viewport:{...bt.viewport,dpr:Tt,initialDpr:bt.viewport.initialDpr||Tt}}}),setFrameloop:(gt="always")=>{const bt=lt().clock;bt.stop(),bt.elapsedTime=0,gt!=="never"&&(bt.start(),bt.elapsedTime=0),at(()=>({frameloop:gt}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(gt,bt,Tt)=>{const wt=lt().internal;return wt.priority=wt.priority+(bt>0?1:0),wt.subscribers.push({ref:gt,priority:bt,store:Tt}),wt.subscribers=wt.subscribers.sort((Rt,It)=>Rt.priority-It.priority),()=>{const Rt=lt().internal;Rt!=null&&Rt.subscribers&&(Rt.priority=Rt.priority-(bt>0?1:0),Rt.subscribers=Rt.subscribers.filter(It=>It.ref!==gt))}}}}}),rt=et.getState();let it=rt.size,st=rt.viewport.dpr,ot=rt.camera;return et.subscribe(()=>{const{camera:at,size:lt,viewport:ct,gl:ut,set:ht}=et.getState();if(lt.width!==it.width||lt.height!==it.height||ct.dpr!==st){var dt;it=lt,st=ct.dpr,updateCamera(at,lt),ut.setPixelRatio(ct.dpr);const ft=(dt=lt.updateStyle)!=null?dt:typeof HTMLCanvasElement<"u"&&ut.domElement instanceof HTMLCanvasElement;ut.setSize(lt.width,lt.height,ft)}at!==ot&&(ot=at,ht(ft=>({viewport:{...ft.viewport,...ft.viewport.getCurrentViewport(at)}})))}),et.subscribe(at=>nt(at)),et};let i$2,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;function run(nt,_e){if(nt.size)for(const{callback:et}of nt.values())et(_e)}function flushGlobalEffects(nt,_e){switch(nt){case"before":return run(globalEffects,_e);case"after":return run(globalAfterEffects,_e);case"tail":return run(globalTailEffects,_e)}}let subscribers,subscription;function render$1(nt,_e,et){let rt=_e.clock.getDelta();for(_e.frameloop==="never"&&typeof nt=="number"&&(rt=nt-_e.clock.elapsedTime,_e.clock.oldTime=_e.clock.elapsedTime,_e.clock.elapsedTime=nt),subscribers=_e.internal.subscribers,i$2=0;i$2<subscribers.length;i$2++)subscription=subscribers[i$2],subscription.ref.current(subscription.store.getState(),rt,et);return!_e.internal.priority&&_e.gl.render&&_e.gl.render(_e.scene,_e.camera),_e.internal.frames=Math.max(0,_e.internal.frames-1),_e.frameloop==="always"?1:_e.internal.frames}function createLoop(nt){let _e=!1,et=!1,rt,it,st;function ot(ct){it=requestAnimationFrame(ot),_e=!0,rt=0,flushGlobalEffects("before",ct),et=!0;for(const ht of nt.values()){var ut;st=ht.store.getState(),st.internal.active&&(st.frameloop==="always"||st.internal.frames>0)&&!((ut=st.gl.xr)!=null&&ut.isPresenting)&&(rt+=render$1(ct,st))}if(et=!1,flushGlobalEffects("after",ct),rt===0)return flushGlobalEffects("tail",ct),_e=!1,cancelAnimationFrame(it)}function at(ct,ut=1){var ht;if(!ct)return nt.forEach(dt=>at(dt.store.getState(),ut));(ht=ct.gl.xr)!=null&&ht.isPresenting||!ct.internal.active||ct.frameloop==="never"||(ut>1?ct.internal.frames=Math.min(60,ct.internal.frames+ut):et?ct.internal.frames=2:ct.internal.frames=1,_e||(_e=!0,requestAnimationFrame(ot)))}function lt(ct,ut=!0,ht,dt){if(ut&&flushGlobalEffects("before",ct),ht)render$1(ct,ht,dt);else for(const ft of nt.values())render$1(ct,ft.store.getState());ut&&flushGlobalEffects("after",ct)}return{loop:ot,invalidate:at,advance:lt}}function useInstanceHandle(nt){const _e=reactExports.useRef(null);return useIsomorphicLayoutEffect$2(()=>void(_e.current=nt.current.__r3f),[nt]),_e}function useStore(){const nt=reactExports.useContext(context$2);if(!nt)throw new Error("R3F: Hooks can only be used within the Canvas component!");return nt}function useThree(nt=et=>et,_e){return useStore()(nt,_e)}function useFrame(nt,_e=0){const et=useStore(),rt=et.getState().internal.subscribe,it=useMutableCallback(nt);return useIsomorphicLayoutEffect$2(()=>rt(it,_e,et),[_e,rt,et]),null}const memoizedLoaders=new WeakMap;function loadingFn(nt,_e){return function(et,...rt){let it=memoizedLoaders.get(et);return it||(it=new et,memoizedLoaders.set(et,it)),nt&&nt(it),Promise.all(rt.map(st=>new Promise((ot,at)=>it.load(st,lt=>{lt.scene&&Object.assign(lt,buildGraph(lt.scene)),ot(lt)},_e,lt=>at(new Error(`Could not load ${st}: ${lt==null?void 0:lt.message}`))))))}}function useLoader(nt,_e,et,rt){const it=Array.isArray(_e)?_e:[_e],st=suspend(loadingFn(et,rt),[nt,...it],{equal:is.equ});return Array.isArray(_e)?st:st[0]}useLoader.preload=function(nt,_e,et){const rt=Array.isArray(_e)?_e:[_e];return preload(loadingFn(et),[nt,...rt])};useLoader.clear=function(nt,_e){const et=Array.isArray(_e)?_e:[_e];return clear([nt,...et])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(nt,_e)=>{const et=typeof nt=="function"?nt(_e):nt;return isRenderer(et)?et:new WebGLRenderer({powerPreference:"high-performance",canvas:_e,antialias:!0,alpha:!0,...nt})};function computeInitialSize(nt,_e){const et=typeof HTMLCanvasElement<"u"&&nt instanceof HTMLCanvasElement;if(_e){const{width:rt,height:it,top:st,left:ot,updateStyle:at=et}=_e;return{width:rt,height:it,top:st,left:ot,updateStyle:at}}else if(typeof HTMLCanvasElement<"u"&&nt instanceof HTMLCanvasElement&&nt.parentElement){const{width:rt,height:it,top:st,left:ot}=nt.parentElement.getBoundingClientRect();return{width:rt,height:it,top:st,left:ot,updateStyle:et}}else if(typeof OffscreenCanvas<"u"&&nt instanceof OffscreenCanvas)return{width:nt.width,height:nt.height,top:0,left:0,updateStyle:et};return{width:0,height:0,top:0,left:0}}function createRoot(nt){const _e=roots.get(nt),et=_e==null?void 0:_e.fiber,rt=_e==null?void 0:_e.store;_e&&console.warn("R3F.createRoot should only be called once!");const it=typeof reportError=="function"?reportError:console.error,st=rt||createStore(invalidate,advance),ot=et||reconciler.createContainer(st,constantsExports.ConcurrentRoot,null,!1,null,"",it,null);_e||roots.set(nt,{fiber:ot,store:st});let at,lt=!1,ct;return{configure(ut={}){let{gl:ht,size:dt,scene:ft,events:pt,onCreated:mt,shadows:At=!1,linear:gt=!1,flat:bt=!1,legacy:Tt=!1,orthographic:wt=!1,frameloop:Rt="always",dpr:It=[1,2],performance:Lt,raycaster:$t,camera:kt,onPointerMissed:Dt}=ut,Ot=st.getState(),zt=Ot.gl;Ot.gl||Ot.set({gl:zt=createRendererInstance(ht,nt)});let Ht=Ot.raycaster;Ht||Ot.set({raycaster:Ht=new Raycaster});const{params:Yt,...Xt}=$t||{};if(is.equ(Xt,Ht,shallowLoose)||applyProps(Ht,{...Xt}),is.equ(Yt,Ht.params,shallowLoose)||applyProps(Ht,{params:{...Ht.params,...Yt}}),!Ot.camera||Ot.camera===ct&&!is.equ(ct,kt,shallowLoose)){ct=kt;const Kt=kt instanceof Camera$1,Jt=Kt?kt:wt?new OrthographicCamera$1(0,0,0,0,.1,1e3):new PerspectiveCamera$2(75,0,.1,1e3);Kt||(Jt.position.z=5,kt&&(applyProps(Jt,kt),("aspect"in kt||"left"in kt||"right"in kt||"bottom"in kt||"top"in kt)&&(Jt.manual=!0,Jt.updateProjectionMatrix())),!Ot.camera&&!(kt!=null&&kt.rotation)&&Jt.lookAt(0,0,0)),Ot.set({camera:Jt}),Ht.camera=Jt}if(!Ot.scene){let Kt;ft instanceof Scene$1?Kt=ft:(Kt=new Scene$1,ft&&applyProps(Kt,ft)),Ot.set({scene:prepare(Kt)})}if(!Ot.xr){var Zt;const Kt=(hn,an)=>{const pn=st.getState();pn.frameloop!=="never"&&advance(hn,!0,pn,an)},Jt=()=>{const hn=st.getState();hn.gl.xr.enabled=hn.gl.xr.isPresenting,hn.gl.xr.setAnimationLoop(hn.gl.xr.isPresenting?Kt:null),hn.gl.xr.isPresenting||invalidate(hn)},sn={connect(){const hn=st.getState().gl;hn.xr.addEventListener("sessionstart",Jt),hn.xr.addEventListener("sessionend",Jt)},disconnect(){const hn=st.getState().gl;hn.xr.removeEventListener("sessionstart",Jt),hn.xr.removeEventListener("sessionend",Jt)}};typeof((Zt=zt.xr)==null?void 0:Zt.addEventListener)=="function"&&sn.connect(),Ot.set({xr:sn})}if(zt.shadowMap){const Kt=zt.shadowMap.enabled,Jt=zt.shadowMap.type;if(zt.shadowMap.enabled=!!At,is.boo(At))zt.shadowMap.type=PCFSoftShadowMap$1;else if(is.str(At)){var rn;const sn={basic:BasicShadowMap$1,percentage:PCFShadowMap$2,soft:PCFSoftShadowMap$1,variance:VSMShadowMap$1};zt.shadowMap.type=(rn=sn[At])!=null?rn:PCFSoftShadowMap$1}else is.obj(At)&&Object.assign(zt.shadowMap,At);(Kt!==zt.shadowMap.enabled||Jt!==zt.shadowMap.type)&&(zt.shadowMap.needsUpdate=!0)}const Gt=getColorManagement();Gt&&("enabled"in Gt?Gt.enabled=!Tt:"legacyMode"in Gt&&(Gt.legacyMode=Tt)),lt||applyProps(zt,{outputEncoding:gt?3e3:3001,toneMapping:bt?NoToneMapping$1:ACESFilmicToneMapping$1}),Ot.legacy!==Tt&&Ot.set(()=>({legacy:Tt})),Ot.linear!==gt&&Ot.set(()=>({linear:gt})),Ot.flat!==bt&&Ot.set(()=>({flat:bt})),ht&&!is.fun(ht)&&!isRenderer(ht)&&!is.equ(ht,zt,shallowLoose)&&applyProps(zt,ht),pt&&!Ot.events.handlers&&Ot.set({events:pt(st)});const jt=computeInitialSize(nt,dt);return is.equ(jt,Ot.size,shallowLoose)||Ot.setSize(jt.width,jt.height,jt.updateStyle,jt.top,jt.left),It&&Ot.viewport.dpr!==calculateDpr(It)&&Ot.setDpr(It),Ot.frameloop!==Rt&&Ot.setFrameloop(Rt),Ot.onPointerMissed||Ot.set({onPointerMissed:Dt}),Lt&&!is.equ(Lt,Ot.performance,shallowLoose)&&Ot.set(Kt=>({performance:{...Kt.performance,...Lt}})),at=mt,lt=!0,this},render(ut){return lt||this.configure(),reconciler.updateContainer(jsxRuntimeExports.jsx(Provider,{store:st,children:ut,onCreated:at,rootElement:nt}),ot,null,()=>{}),st},unmount(){unmountComponentAtNode(nt)}}}function Provider({store:nt,children:_e,onCreated:et,rootElement:rt}){return useIsomorphicLayoutEffect$2(()=>{const it=nt.getState();it.set(st=>({internal:{...st.internal,active:!0}})),et&&et(it),nt.getState().events.connected||it.events.connect==null||it.events.connect(rt)},[]),jsxRuntimeExports.jsx(context$2.Provider,{value:nt,children:_e})}function unmountComponentAtNode(nt,_e){const et=roots.get(nt),rt=et==null?void 0:et.fiber;if(rt){const it=et==null?void 0:et.store.getState();it&&(it.internal.active=!1),reconciler.updateContainer(null,rt,null,()=>{it&&setTimeout(()=>{try{var st,ot,at,lt;it.events.disconnect==null||it.events.disconnect(),(st=it.gl)==null||(ot=st.renderLists)==null||ot.dispose==null||ot.dispose(),(at=it.gl)==null||at.forceContextLoss==null||at.forceContextLoss(),(lt=it.gl)!=null&&lt.xr&&it.xr.disconnect(),dispose(it),roots.delete(nt)}catch{}},500)})}}function createPortal(nt,_e,et){return jsxRuntimeExports.jsx(Portal,{children:nt,container:_e,state:et},_e.uuid)}function Portal({state:nt={},children:_e,container:et}){const{events:rt,size:it,...st}=nt,ot=useStore(),[at]=reactExports.useState(()=>new Raycaster),[lt]=reactExports.useState(()=>new Vector2$1),ct=reactExports.useCallback((ht,dt)=>{const ft={...ht};Object.keys(ht).forEach(mt=>{(privateKeys.includes(mt)||ht[mt]!==dt[mt]&&dt[mt])&&delete ft[mt]});let pt;if(dt&&it){const mt=dt.camera;pt=ht.viewport.getCurrentViewport(mt,new Vector3$1,it),mt!==ht.camera&&updateCamera(mt,it)}return{...ft,scene:et,raycaster:at,pointer:lt,mouse:lt,previousRoot:ot,events:{...ht.events,...dt==null?void 0:dt.events,...rt},size:{...ht.size,...it},viewport:{...ht.viewport,...pt},...st}},[nt]),[ut]=reactExports.useState(()=>{const ht=ot.getState();return create((ft,pt)=>({...ht,scene:et,raycaster:at,pointer:lt,mouse:lt,previousRoot:ot,events:{...ht.events,...rt},size:{...ht.size,...it},...st,set:ft,get:pt,setEvents:mt=>ft(At=>({...At,events:{...At.events,...mt}}))}))});return reactExports.useEffect(()=>{const ht=ot.subscribe(dt=>ut.setState(ft=>ct(dt,ft)));return()=>{ht()}},[ct]),reactExports.useEffect(()=>{ut.setState(ht=>ct(ot.getState(),ht))},[ct]),reactExports.useEffect(()=>()=>{ut.destroy()},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:reconciler.createPortal(jsxRuntimeExports.jsx(context$2.Provider,{value:ut,children:_e}),ut,null)})}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(nt){const{handlePointer:_e}=createEvents(nt);return{priority:1,enabled:!0,compute(et,rt,it){rt.pointer.set(et.offsetX/rt.size.width*2-1,-(et.offsetY/rt.size.height)*2+1),rt.raycaster.setFromCamera(rt.pointer,rt.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((et,rt)=>({...et,[rt]:_e(rt)}),{}),update:()=>{var et;const{events:rt,internal:it}=nt.getState();(et=it.lastEvent)!=null&&et.current&&rt.handlers&&rt.handlers.onPointerMove(it.lastEvent.current)},connect:et=>{var rt;const{set:it,events:st}=nt.getState();st.disconnect==null||st.disconnect(),it(ot=>({events:{...ot.events,connected:et}})),Object.entries((rt=st.handlers)!=null?rt:[]).forEach(([ot,at])=>{const[lt,ct]=DOM_EVENTS[ot];et.addEventListener(lt,at,{passive:ct})})},disconnect:()=>{const{set:et,events:rt}=nt.getState();if(rt.connected){var it;Object.entries((it=rt.handlers)!=null?it:[]).forEach(([st,ot])=>{if(rt&&rt.connected instanceof HTMLElement){const[at]=DOM_EVENTS[st];rt.connected.removeEventListener(at,ot)}}),et(st=>({events:{...st.events,connected:void 0}}))}}}}function debounce$1(nt,_e,et){var rt,it,st,ot,at;_e==null&&(_e=100);function lt(){var ut=Date.now()-ot;ut<_e&&ut>=0?rt=setTimeout(lt,_e-ut):(rt=null,et||(at=nt.apply(st,it),st=it=null))}var ct=function(){st=this,it=arguments,ot=Date.now();var ut=et&&!rt;return rt||(rt=setTimeout(lt,_e)),ut&&(at=nt.apply(st,it),st=it=null),at};return ct.clear=function(){rt&&(clearTimeout(rt),rt=null)},ct.flush=function(){rt&&(at=nt.apply(st,it),st=it=null,clearTimeout(rt),rt=null)},ct}debounce$1.debounce=debounce$1;var debounce_1=debounce$1;const createDebounce=getDefaultExportFromCjs$1(debounce_1);var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(nt,_e,et)=>_e in nt?__defProp$1(nt,_e,{enumerable:!0,configurable:!0,writable:!0,value:et}):nt[_e]=et,__spreadValues=(nt,_e)=>{for(var et in _e||(_e={}))__hasOwnProp.call(_e,et)&&__defNormalProp$1(nt,et,_e[et]);if(__getOwnPropSymbols)for(var et of __getOwnPropSymbols(_e))__propIsEnum.call(_e,et)&&__defNormalProp$1(nt,et,_e[et]);return nt},__spreadProps=(nt,_e)=>__defProps(nt,__getOwnPropDescs(_e)),_a$1,_b$1;typeof window<"u"&&((_a$1=window.document)!=null&&_a$1.createElement||((_b$1=window.navigator)==null?void 0:_b$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function traverseFiber(nt,_e,et){if(!nt)return;if(et(nt)===!0)return nt;let rt=nt.child;for(;rt;){const it=traverseFiber(rt,_e,et);if(it)return it;rt=rt.sibling}}function wrapContext(nt){try{return Object.defineProperties(nt,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return nt}}const error=console.error;console.error=function(){const nt=[...arguments].join("");if(nt!=null&&nt.startsWith("Warning:")&&nt.includes("useContext")){console.error=error;return}return error.apply(this,arguments)};const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}function useFiber(){const nt=reactExports.useContext(FiberContext);if(nt===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _e=reactExports.useId();return reactExports.useMemo(()=>{for(const rt of[nt,nt==null?void 0:nt.alternate]){if(!rt)continue;const it=traverseFiber(rt,!1,st=>{let ot=st.memoizedState;for(;ot;){if(ot.memoizedState===_e)return!0;ot=ot.next}});if(it)return it}},[nt,_e])}function useContextMap(){const nt=useFiber(),[_e]=reactExports.useState(()=>new Map);_e.clear();let et=nt;for(;et;){if(et.type&&typeof et.type=="object"){const it=et.type._context===void 0&&et.type.Provider===et.type?et.type:et.type._context;it&&it!==FiberContext&&!_e.has(it)&&_e.set(it,reactExports.useContext(wrapContext(it)))}et=et.return}return _e}function useContextBridge(){const nt=useContextMap();return reactExports.useMemo(()=>Array.from(nt.keys()).reduce((_e,et)=>rt=>reactExports.createElement(_e,null,reactExports.createElement(et.Provider,__spreadProps(__spreadValues({},rt),{value:nt.get(et)}))),_e=>reactExports.createElement(FiberProvider,__spreadValues({},_e))),[nt])}function useMeasure({debounce:nt,scroll:_e,polyfill:et,offsetSize:rt}={debounce:0,scroll:!1,offsetSize:!1}){const it=et||typeof window<"u"&&window.ResizeObserver,[st,ot]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!it)return st.width=1280,st.height=800,[()=>{},st,()=>{}];const at=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:st,orientationHandler:null}),lt=nt?typeof nt=="number"?nt:nt.scroll:null,ct=nt?typeof nt=="number"?nt:nt.resize:null,ut=reactExports.useRef(!1);reactExports.useEffect(()=>(ut.current=!0,()=>void(ut.current=!1)));const[ht,dt,ft]=reactExports.useMemo(()=>{const gt=()=>{if(!at.current.element)return;const{left:bt,top:Tt,width:wt,height:Rt,bottom:It,right:Lt,x:$t,y:kt}=at.current.element.getBoundingClientRect(),Dt={left:bt,top:Tt,width:wt,height:Rt,bottom:It,right:Lt,x:$t,y:kt};at.current.element instanceof HTMLElement&&rt&&(Dt.height=at.current.element.offsetHeight,Dt.width=at.current.element.offsetWidth),Object.freeze(Dt),ut.current&&!areBoundsEqual(at.current.lastBounds,Dt)&&ot(at.current.lastBounds=Dt)};return[gt,ct?createDebounce(gt,ct):gt,lt?createDebounce(gt,lt):gt]},[ot,rt,lt,ct]);function pt(){at.current.scrollContainers&&(at.current.scrollContainers.forEach(gt=>gt.removeEventListener("scroll",ft,!0)),at.current.scrollContainers=null),at.current.resizeObserver&&(at.current.resizeObserver.disconnect(),at.current.resizeObserver=null),at.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",at.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",at.current.orientationHandler))}function mt(){var gt;at.current.element&&(at.current.resizeObserver=new it(dt),(gt=at.current.resizeObserver)==null||gt.observe(at.current.element),_e&&at.current.scrollContainers&&at.current.scrollContainers.forEach(bt=>bt.addEventListener("scroll",ft,{capture:!0,passive:!0})),at.current.orientationHandler=()=>{ft()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",at.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",at.current.orientationHandler))}const At=gt=>{!gt||gt===at.current.element||(pt(),at.current.element=gt,at.current.scrollContainers=findScrollContainers(gt),mt())};return useOnWindowScroll(ft,!!_e),useOnWindowResize(dt),reactExports.useEffect(()=>{pt(),mt()},[_e,ft,dt]),reactExports.useEffect(()=>pt,[]),[At,st,ht]}function useOnWindowResize(nt){reactExports.useEffect(()=>{const _e=nt;return window.addEventListener("resize",_e),()=>void window.removeEventListener("resize",_e)},[nt])}function useOnWindowScroll(nt,_e){reactExports.useEffect(()=>{if(_e){const et=nt;return window.addEventListener("scroll",et,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",et,!0)}},[nt,_e])}function findScrollContainers(nt){const _e=[];if(!nt||nt===document.body)return _e;const{overflow:et,overflowX:rt,overflowY:it}=window.getComputedStyle(nt);return[et,rt,it].some(st=>st==="auto"||st==="scroll")&&_e.push(nt),[..._e,...findScrollContainers(nt.parentElement)]}const keys=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(nt,_e)=>keys.every(et=>nt[et]===_e[et]),CanvasImpl=reactExports.forwardRef(function({children:_e,fallback:et,resize:rt,style:it,gl:st,events:ot=createPointerEvents,eventSource:at,eventPrefix:lt,shadows:ct,linear:ut,flat:ht,legacy:dt,orthographic:ft,frameloop:pt,dpr:mt,performance:At,raycaster:gt,camera:bt,scene:Tt,onPointerMissed:wt,onCreated:Rt,...It},Lt){reactExports.useMemo(()=>extend$1(THREE$l),[]);const $t=useContextBridge(),[kt,Dt]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...rt}),Ot=reactExports.useRef(null),zt=reactExports.useRef(null);reactExports.useImperativeHandle(Lt,()=>Ot.current);const Ht=useMutableCallback(wt),[Yt,Xt]=reactExports.useState(!1),[Zt,rn]=reactExports.useState(!1);if(Yt)throw Yt;if(Zt)throw Zt;const Gt=reactExports.useRef(null);useIsomorphicLayoutEffect$2(()=>{const Kt=Ot.current;Dt.width>0&&Dt.height>0&&Kt&&(Gt.current||(Gt.current=createRoot(Kt)),Gt.current.configure({gl:st,events:ot,shadows:ct,linear:ut,flat:ht,legacy:dt,orthographic:ft,frameloop:pt,dpr:mt,performance:At,raycaster:gt,camera:bt,scene:Tt,size:Dt,onPointerMissed:(...Jt)=>Ht.current==null?void 0:Ht.current(...Jt),onCreated:Jt=>{Jt.events.connect==null||Jt.events.connect(at?isRef(at)?at.current:at:zt.current),lt&&Jt.setEvents({compute:(sn,hn)=>{const an=sn[lt+"X"],pn=sn[lt+"Y"];hn.pointer.set(an/hn.size.width*2-1,-(pn/hn.size.height)*2+1),hn.raycaster.setFromCamera(hn.pointer,hn.camera)}}),Rt==null||Rt(Jt)}}),Gt.current.render(jsxRuntimeExports.jsx($t,{children:jsxRuntimeExports.jsx(ErrorBoundary,{set:rn,children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Block,{set:Xt}),children:_e})})})))}),reactExports.useEffect(()=>{const Kt=Ot.current;if(Kt)return()=>unmountComponentAtNode(Kt)},[]);const jt=at?"none":"auto";return jsxRuntimeExports.jsx("div",{ref:zt,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:jt,...it},...It,children:jsxRuntimeExports.jsx("div",{ref:kt,style:{width:"100%",height:"100%"},children:jsxRuntimeExports.jsx("canvas",{ref:Ot,style:{display:"block"},children:et})})})}),Canvas=reactExports.forwardRef(function(_e,et){return jsxRuntimeExports.jsx(FiberProvider,{children:jsxRuntimeExports.jsx(CanvasImpl,{..._e,ref:et})})});var cssMediaquery={};cssMediaquery.match=matchQuery;cssMediaquery.parse=parseQuery;var RE_MEDIA_QUERY=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,RE_MQ_EXPRESSION=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,RE_MQ_FEATURE=/^(?:(min|max)-)?(.+)/,RE_LENGTH_UNIT=/(em|rem|px|cm|mm|in|pt|pc)?$/,RE_RESOLUTION_UNIT=/(dpi|dpcm|dppx)?$/;function matchQuery(nt,_e){return parseQuery(nt).some(function(et){var rt=et.inverse,it=et.type==="all"||_e.type===et.type;if(it&&rt||!(it||rt))return!1;var st=et.expressions.every(function(ot){var at=ot.feature,lt=ot.modifier,ct=ot.value,ut=_e[at];if(!ut)return!1;switch(at){case"orientation":case"scan":return ut.toLowerCase()===ct.toLowerCase();case"width":case"height":case"device-width":case"device-height":ct=toPx(ct),ut=toPx(ut);break;case"resolution":ct=toDpi(ct),ut=toDpi(ut);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":ct=toDecimal(ct),ut=toDecimal(ut);break;case"grid":case"color":case"color-index":case"monochrome":ct=parseInt(ct,10)||1,ut=parseInt(ut,10)||0;break}switch(lt){case"min":return ut>=ct;case"max":return ut<=ct;default:return ut===ct}});return st&&!rt||!st&&rt})}function parseQuery(nt){return nt.split(",").map(function(_e){_e=_e.trim();var et=_e.match(RE_MEDIA_QUERY),rt=et[1],it=et[2],st=et[3]||"",ot={};return ot.inverse=!!rt&&rt.toLowerCase()==="not",ot.type=it?it.toLowerCase():"all",st=st.match(/\([^\)]+\)/g)||[],ot.expressions=st.map(function(at){var lt=at.match(RE_MQ_EXPRESSION),ct=lt[1].toLowerCase().match(RE_MQ_FEATURE);return{modifier:ct[1],feature:ct[2],value:lt[2]}}),ot})}function toDecimal(nt){var _e=Number(nt),et;return _e||(et=nt.match(/^(\d+)\s*\/\s*(\d+)$/),_e=et[1]/et[2]),_e}function toDpi(nt){var _e=parseFloat(nt),et=String(nt).match(RE_RESOLUTION_UNIT)[1];switch(et){case"dpcm":return _e/2.54;case"dppx":return _e*96;default:return _e}}function toPx(nt){var _e=parseFloat(nt),et=String(nt).match(RE_LENGTH_UNIT)[1];switch(et){case"em":return _e*16;case"rem":return _e*16;case"cm":return _e*96/2.54;case"mm":return _e*96/2.54/10;case"in":return _e*96;case"pt":return _e*72;case"pc":return _e*72/12;default:return _e}}var staticMatch=cssMediaquery.match,dynamicMatch=typeof window<"u"?window.matchMedia:null;function Mql(nt,_e,et){var rt=this,it;dynamicMatch&&!et&&(it=dynamicMatch.call(window,nt)),it?(this.matches=it.matches,this.media=it.media,it.addListener(at)):(this.matches=staticMatch(nt,_e),this.media=nt),this.addListener=st,this.removeListener=ot,this.dispose=lt;function st(ct){it&&it.addListener(ct)}function ot(ct){it&&it.removeListener(ct)}function at(ct){rt.matches=ct.matches,rt.media=ct.media}function lt(){it&&it.removeListener(at)}}function matchMedia$1(nt,_e,et){return new Mql(nt,_e,et)}var matchmediaquery=matchMedia$1;const matchMedia$2=getDefaultExportFromCjs$1(matchmediaquery);var uppercasePattern=/[A-Z]/g,msPattern=/^ms-/,cache$3={};function toHyphenLower(nt){return"-"+nt.toLowerCase()}function hyphenateStyleName(nt){if(cache$3.hasOwnProperty(nt))return cache$3[nt];var _e=nt.replace(uppercasePattern,toHyphenLower);return cache$3[nt]=msPattern.test(_e)?"-"+_e:_e}function shallowEqualObjects(nt,_e){if(nt===_e)return!0;if(!nt||!_e)return!1;const et=Object.keys(nt),rt=Object.keys(_e),it=et.length;if(rt.length!==it)return!1;for(let st=0;st<it;st++){const ot=et[st];if(nt[ot]!==_e[ot]||!Object.prototype.hasOwnProperty.call(_e,ot))return!1}return!0}const stringOrNumber=PropTypes.oneOfType([PropTypes.string,PropTypes.number]),types={all:PropTypes.bool,grid:PropTypes.bool,aural:PropTypes.bool,braille:PropTypes.bool,handheld:PropTypes.bool,print:PropTypes.bool,projection:PropTypes.bool,screen:PropTypes.bool,tty:PropTypes.bool,tv:PropTypes.bool,embossed:PropTypes.bool},matchers$1={orientation:PropTypes.oneOf(["portrait","landscape"]),scan:PropTypes.oneOf(["progressive","interlace"]),aspectRatio:PropTypes.string,deviceAspectRatio:PropTypes.string,height:stringOrNumber,deviceHeight:stringOrNumber,width:stringOrNumber,deviceWidth:stringOrNumber,color:PropTypes.bool,colorIndex:PropTypes.bool,monochrome:PropTypes.bool,resolution:stringOrNumber,type:Object.keys(types)},{type,...featureMatchers}=matchers$1,features={minAspectRatio:PropTypes.string,maxAspectRatio:PropTypes.string,minDeviceAspectRatio:PropTypes.string,maxDeviceAspectRatio:PropTypes.string,minHeight:stringOrNumber,maxHeight:stringOrNumber,minDeviceHeight:stringOrNumber,maxDeviceHeight:stringOrNumber,minWidth:stringOrNumber,maxWidth:stringOrNumber,minDeviceWidth:stringOrNumber,maxDeviceWidth:stringOrNumber,minColor:PropTypes.number,maxColor:PropTypes.number,minColorIndex:PropTypes.number,maxColorIndex:PropTypes.number,minMonochrome:PropTypes.number,maxMonochrome:PropTypes.number,minResolution:stringOrNumber,maxResolution:stringOrNumber,...featureMatchers},all$1={...types,...features};var mq={all:all$1,types,matchers:matchers$1,features};const negate$1=nt=>`not ${nt}`,keyVal=(nt,_e)=>{const et=hyphenateStyleName(nt);return typeof _e=="number"&&(_e=`${_e}px`),_e===!0?et:_e===!1?negate$1(et):`(${et}: ${_e})`},join=nt=>nt.join(" and "),toQuery=nt=>{const _e=[];return Object.keys(mq.all).forEach(et=>{const rt=nt[et];rt!=null&&_e.push(keyVal(et,rt))}),join(_e)},Context$1=reactExports.createContext(void 0),makeQuery=nt=>nt.query||toQuery(nt),hyphenateKeys=nt=>nt?Object.keys(nt).reduce((et,rt)=>(et[hyphenateStyleName(rt)]=nt[rt],et),{}):void 0,useIsUpdate=()=>{const nt=reactExports.useRef(!1);return reactExports.useEffect(()=>{nt.current=!0},[]),nt.current},useDevice=nt=>{const _e=reactExports.useContext(Context$1),et=()=>hyphenateKeys(nt)||hyphenateKeys(_e),[rt,it]=reactExports.useState(et);return reactExports.useEffect(()=>{const st=et();shallowEqualObjects(rt,st)||it(st)},[nt,_e]),rt},useQuery=nt=>{const _e=()=>makeQuery(nt),[et,rt]=reactExports.useState(_e);return reactExports.useEffect(()=>{const it=_e();et!==it&&rt(it)},[nt]),et},useMatchMedia=(nt,_e)=>{const et=()=>matchMedia$2(nt,_e||{},!!_e),[rt,it]=reactExports.useState(et),st=useIsUpdate();return reactExports.useEffect(()=>{if(st){const ot=et();return it(ot),()=>{ot&&ot.dispose()}}},[nt,_e]),rt},useMatches=nt=>{const[_e,et]=reactExports.useState(nt.matches);return reactExports.useEffect(()=>{const rt=it=>{et(it.matches)};return nt.addListener(rt),et(nt.matches),()=>{nt.removeListener(rt)}},[nt]),_e},useMediaQuery=(nt,_e,et)=>{const rt=useDevice(_e),it=useQuery(nt);if(!it)throw new Error("Invalid or missing MediaQuery!");const st=useMatchMedia(it,rt),ot=useMatches(st),at=useIsUpdate();return reactExports.useEffect(()=>{at&&et&&et(ot)},[ot]),reactExports.useEffect(()=>()=>{st&&st.dispose()},[]),ot};function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e];for(var rt in et)({}).hasOwnProperty.call(et,rt)&&(nt[rt]=et[rt])}return nt},_extends$2.apply(null,arguments)}const v1=new Vector3$1,v2=new Vector3$1,v3=new Vector3$1,v4=new Vector2$1;function defaultCalculatePosition(nt,_e,et){const rt=v1.setFromMatrixPosition(nt.matrixWorld);rt.project(_e);const it=et.width/2,st=et.height/2;return[rt.x*it+it,-(rt.y*st)+st]}function isObjectBehindCamera(nt,_e){const et=v1.setFromMatrixPosition(nt.matrixWorld),rt=v2.setFromMatrixPosition(_e.matrixWorld),it=et.sub(rt),st=_e.getWorldDirection(v3);return it.angleTo(st)>Math.PI/2}function isObjectVisible(nt,_e,et,rt){const it=v1.setFromMatrixPosition(nt.matrixWorld),st=it.clone();st.project(_e),v4.set(st.x,st.y),et.setFromCamera(v4,_e);const ot=et.intersectObjects(rt,!0);if(ot.length){const at=ot[0].distance;return it.distanceTo(et.ray.origin)<at}return!0}function objectScale(nt,_e){if(_e instanceof OrthographicCamera$1)return _e.zoom;if(_e instanceof PerspectiveCamera$2){const et=v1.setFromMatrixPosition(nt.matrixWorld),rt=v2.setFromMatrixPosition(_e.matrixWorld),it=_e.fov*Math.PI/180,st=et.distanceTo(rt);return 1/(2*Math.tan(it/2)*st)}else return 1}function objectZIndex(nt,_e,et){if(_e instanceof PerspectiveCamera$2||_e instanceof OrthographicCamera$1){const rt=v1.setFromMatrixPosition(nt.matrixWorld),it=v2.setFromMatrixPosition(_e.matrixWorld),st=rt.distanceTo(it),ot=(et[1]-et[0])/(_e.far-_e.near),at=et[1]-ot*_e.far;return Math.round(ot*st+at)}}const epsilon$3=nt=>Math.abs(nt)<1e-10?0:nt;function getCSSMatrix(nt,_e,et=""){let rt="matrix3d(";for(let it=0;it!==16;it++)rt+=epsilon$3(_e[it]*nt.elements[it])+(it!==15?",":")");return et+rt}const getCameraCSSMatrix=(nt=>_e=>getCSSMatrix(_e,nt))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),getObjectCSSMatrix=(nt=>(_e,et)=>getCSSMatrix(_e,nt(et),"translate(-50%,-50%)"))(nt=>[1/nt,1/nt,1/nt,1,-1/nt,-1/nt,-1/nt,-1,1/nt,1/nt,1/nt,1,1,1,1,1]);function isRefObject$1(nt){return nt&&typeof nt=="object"&&"current"in nt}const Html=reactExports.forwardRef(({children:nt,eps:_e=.001,style:et,className:rt,prepend:it,center:st,fullscreen:ot,portal:at,distanceFactor:lt,sprite:ct=!1,transform:ut=!1,occlude:ht,onOcclude:dt,castShadow:ft,receiveShadow:pt,material:mt,geometry:At,zIndexRange:gt=[16777271,0],calculatePosition:bt=defaultCalculatePosition,as:Tt="div",wrapperClass:wt,pointerEvents:Rt="auto",...It},Lt)=>{const{gl:$t,camera:kt,scene:Dt,size:Ot,raycaster:zt,events:Ht,viewport:Yt}=useThree(),[Xt]=reactExports.useState(()=>document.createElement(Tt)),Zt=reactExports.useRef(),rn=reactExports.useRef(null),Gt=reactExports.useRef(0),jt=reactExports.useRef([0,0]),Kt=reactExports.useRef(null),Jt=reactExports.useRef(null),sn=(at==null?void 0:at.current)||Ht.connected||$t.domElement.parentNode,hn=reactExports.useRef(null),an=reactExports.useRef(!1),pn=reactExports.useMemo(()=>ht&&ht!=="blending"||Array.isArray(ht)&&ht.length&&isRefObject$1(ht[0]),[ht]);reactExports.useLayoutEffect(()=>{const Xn=$t.domElement;ht&&ht==="blending"?(Xn.style.zIndex=`${Math.floor(gt[0]/2)}`,Xn.style.position="absolute",Xn.style.pointerEvents="none"):(Xn.style.zIndex=null,Xn.style.position=null,Xn.style.pointerEvents=null)},[ht]),reactExports.useLayoutEffect(()=>{if(rn.current){const Xn=Zt.current=createRoot$1(Xt);if(Dt.updateMatrixWorld(),ut)Xt.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Vn=bt(rn.current,kt,Ot);Xt.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Vn[0]}px,${Vn[1]}px,0);transform-origin:0 0;`}return sn&&(it?sn.prepend(Xt):sn.appendChild(Xt)),()=>{sn&&sn.removeChild(Xt),Xn.unmount()}}},[sn,ut]),reactExports.useLayoutEffect(()=>{wt&&(Xt.className=wt)},[wt]);const _n=reactExports.useMemo(()=>ut?{position:"absolute",top:0,left:0,width:Ot.width,height:Ot.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:st?"translate3d(-50%,-50%,0)":"none",...ot&&{top:-Ot.height/2,left:-Ot.width/2,width:Ot.width,height:Ot.height},...et},[et,st,ot,Ot,ut]),yn=reactExports.useMemo(()=>({position:"absolute",pointerEvents:Rt}),[Rt]);reactExports.useLayoutEffect(()=>{if(an.current=!1,ut){var Xn;(Xn=Zt.current)==null||Xn.render(reactExports.createElement("div",{ref:Kt,style:_n},reactExports.createElement("div",{ref:Jt,style:yn},reactExports.createElement("div",{ref:Lt,className:rt,style:et,children:nt}))))}else{var Vn;(Vn=Zt.current)==null||Vn.render(reactExports.createElement("div",{ref:Lt,style:_n,className:rt,children:nt}))}});const $n=reactExports.useRef(!0);useFrame(Xn=>{if(rn.current){kt.updateMatrixWorld(),rn.current.updateWorldMatrix(!0,!1);const Vn=ut?jt.current:bt(rn.current,kt,Ot);if(ut||Math.abs(Gt.current-kt.zoom)>_e||Math.abs(jt.current[0]-Vn[0])>_e||Math.abs(jt.current[1]-Vn[1])>_e){const En=isObjectBehindCamera(rn.current,kt);let dn=!1;pn&&(Array.isArray(ht)?dn=ht.map(ir=>ir.current):ht!=="blending"&&(dn=[Dt]));const rr=$n.current;if(dn){const ir=isObjectVisible(rn.current,kt,zt,dn);$n.current=ir&&!En}else $n.current=!En;rr!==$n.current&&(dt?dt(!$n.current):Xt.style.display=$n.current?"block":"none");const er=Math.floor(gt[0]/2),Yn=ht?pn?[gt[0],er]:[er-1,0]:gt;if(Xt.style.zIndex=`${objectZIndex(rn.current,kt,Yn)}`,ut){const[ir,Qn]=[Ot.width/2,Ot.height/2],sr=kt.projectionMatrix.elements[5]*Qn,{isOrthographicCamera:un,top:en,left:wn,bottom:gn,right:Mn}=kt,In=getCameraCSSMatrix(kt.matrixWorldInverse),gr=un?`scale(${sr})translate(${epsilon$3(-(Mn+wn)/2)}px,${epsilon$3((en+gn)/2)}px)`:`translateZ(${sr}px)`;let jn=rn.current.matrixWorld;ct&&(jn=kt.matrixWorldInverse.clone().transpose().copyPosition(jn).scale(rn.current.scale),jn.elements[3]=jn.elements[7]=jn.elements[11]=0,jn.elements[15]=1),Xt.style.width=Ot.width+"px",Xt.style.height=Ot.height+"px",Xt.style.perspective=un?"":`${sr}px`,Kt.current&&Jt.current&&(Kt.current.style.transform=`${gr}${In}translate(${ir}px,${Qn}px)`,Jt.current.style.transform=getObjectCSSMatrix(jn,1/((lt||10)/400)))}else{const ir=lt===void 0?1:objectScale(rn.current,kt)*lt;Xt.style.transform=`translate3d(${Vn[0]}px,${Vn[1]}px,0) scale(${ir})`}jt.current=Vn,Gt.current=kt.zoom}}if(!pn&&hn.current&&!an.current)if(ut){if(Kt.current){const Vn=Kt.current.children[0];if(Vn!=null&&Vn.clientWidth&&Vn!=null&&Vn.clientHeight){const{isOrthographicCamera:En}=kt;if(En||At)It.scale&&(Array.isArray(It.scale)?It.scale instanceof Vector3$1?hn.current.scale.copy(It.scale.clone().divideScalar(1)):hn.current.scale.set(1/It.scale[0],1/It.scale[1],1/It.scale[2]):hn.current.scale.setScalar(1/It.scale));else{const dn=(lt||10)/400,rr=Vn.clientWidth*dn,er=Vn.clientHeight*dn;hn.current.scale.set(rr,er,1)}an.current=!0}}}else{const Vn=Xt.children[0];if(Vn!=null&&Vn.clientWidth&&Vn!=null&&Vn.clientHeight){const En=1/Yt.factor,dn=Vn.clientWidth*En,rr=Vn.clientHeight*En;hn.current.scale.set(dn,rr,1),an.current=!0}hn.current.lookAt(Xn.camera.position)}});const Jn=reactExports.useMemo(()=>({vertexShader:ut?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[ut]);return reactExports.createElement("group",_extends$2({},It,{ref:rn}),ht&&!pn&&reactExports.createElement("mesh",{castShadow:ft,receiveShadow:pt,ref:hn},At||reactExports.createElement("planeGeometry",null),mt||reactExports.createElement("shaderMaterial",{side:DoubleSide$1,vertexShader:Jn.vertexShader,fragmentShader:Jn.fragmentShader})))});function useCursor(nt,_e="pointer",et="auto",rt=document.body){reactExports.useEffect(()=>{if(nt)return rt.style.cursor=_e,()=>void(rt.style.cursor=et)},[nt])}let saveLastTotalLoaded=0;const useProgress=create(nt=>(DefaultLoadingManager.onStart=(_e,et,rt)=>{nt({active:!0,item:_e,loaded:et,total:rt,progress:(et-saveLastTotalLoaded)/(rt-saveLastTotalLoaded)*100})},DefaultLoadingManager.onLoad=()=>{nt({active:!1})},DefaultLoadingManager.onError=_e=>nt(et=>({errors:[...et.errors,_e]})),DefaultLoadingManager.onProgress=(_e,et,rt)=>{et===rt&&(saveLastTotalLoaded=rt),nt({active:!0,item:_e,loaded:et,total:rt,progress:(et-saveLastTotalLoaded)/(rt-saveLastTotalLoaded)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function _defineProperty$6(nt,_e,et){return _e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _arrayLikeToArray$a(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=new Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _unsupportedIterableToArray$a(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$a(nt,_e);var et=Object.prototype.toString.call(nt).slice(8,-1);if(et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set")return Array.from(nt);if(et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et))return _arrayLikeToArray$a(nt,_e)}}function _arrayWithoutHoles$8(nt){if(Array.isArray(nt))return _arrayLikeToArray$a(nt)}function _iterableToArray$8(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _nonIterableSpread$8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray$8(nt){return _arrayWithoutHoles$8(nt)||_iterableToArray$8(nt)||_unsupportedIterableToArray$a(nt)||_nonIterableSpread$8()}new Vector2$1;new Vector2$1;function clamp$4(nt,_e,et){return Math.max(_e,Math.min(et,nt))}function repeat(nt,_e){return clamp$4(nt-Math.floor(nt/_e)*_e,0,_e)}function deltaAngle(nt,_e){var et=repeat(_e-nt,Math.PI*2);return et>Math.PI&&(et-=Math.PI*2),et}function _classCallCheck$4(nt,_e){if(!(nt instanceof _e))throw new TypeError("Cannot call a class as a function")}var Grad=function nt(_e,et,rt){var it=this;_classCallCheck$4(this,nt),_defineProperty$6(this,"dot2",function(st,ot){return it.x*st+it.y*ot}),_defineProperty$6(this,"dot3",function(st,ot,at){return it.x*st+it.y*ot+it.z*at}),this.x=_e,this.y=et,this.z=rt},grad3=[new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)],p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],perm=new Array(512),gradP=new Array(512),seed=function(_e){_e>0&&_e<1&&(_e*=65536),_e=Math.floor(_e),_e<256&&(_e|=_e<<8);for(var et=0;et<256;et++){var rt;et&1?rt=p[et]^_e&255:rt=p[et]^_e>>8&255,perm[et]=perm[et+256]=rt,gradP[et]=gradP[et+256]=grad3[rt%12]}};seed(0);function normalizeSeed(nt){if(typeof nt=="number")nt=Math.abs(nt);else if(typeof nt=="string"){var _e=nt;nt=0;for(var et=0;et<_e.length;et++)nt=(nt+(et+1)*(_e.charCodeAt(et)%96))%2147483647}return nt===0&&(nt=311),nt}function lcgRandom(nt){var _e=normalizeSeed(nt);return function(){var et=_e*48271%2147483647;return _e=et,et/2147483647}}var Generator=function nt(_e){var et=this;_classCallCheck$4(this,nt),_defineProperty$6(this,"seed",0),_defineProperty$6(this,"init",function(rt){et.seed=rt,et.value=lcgRandom(rt)}),_defineProperty$6(this,"value",lcgRandom(this.seed)),this.init(_e)};new Generator(Math.random());var rsqw=function(_e){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,it=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return rt/Math.atan(1/et)*Math.atan(Math.sin(2*Math.PI*_e*it)/et)},exp$1=function(_e){return 1/(1+_e+.48*_e*_e+.235*_e*_e*_e)},linear$2=function(_e){return _e},sine={in:function(_e){return 1-Math.cos(_e*Math.PI/2)},out:function(_e){return Math.sin(_e*Math.PI/2)},inOut:function(_e){return-(Math.cos(Math.PI*_e)-1)/2}},cubic={in:function(_e){return _e*_e*_e},out:function(_e){return 1-Math.pow(1-_e,3)},inOut:function(_e){return _e<.5?4*_e*_e*_e:1-Math.pow(-2*_e+2,3)/2}},quint={in:function(_e){return _e*_e*_e*_e*_e},out:function(_e){return 1-Math.pow(1-_e,5)},inOut:function(_e){return _e<.5?16*_e*_e*_e*_e*_e:1-Math.pow(-2*_e+2,5)/2}},circ={in:function(_e){return 1-Math.sqrt(1-Math.pow(_e,2))},out:function(_e){return Math.sqrt(1-Math.pow(_e-1,2))},inOut:function(_e){return _e<.5?(1-Math.sqrt(1-Math.pow(2*_e,2)))/2:(Math.sqrt(1-Math.pow(-2*_e+2,2))+1)/2}},quart={in:function(_e){return _e*_e*_e*_e},out:function(_e){return 1- --_e*_e*_e*_e},inOut:function(_e){return _e<.5?8*_e*_e*_e*_e:1-8*--_e*_e*_e*_e}},expo={in:function(_e){return _e===0?0:Math.pow(2,10*_e-10)},out:function(_e){return _e===1?1:1-Math.pow(2,-10*_e)},inOut:function(_e){return _e===0?0:_e===1?1:_e<.5?Math.pow(2,20*_e-10)/2:(2-Math.pow(2,-20*_e+10))/2}};function damp$1(nt,_e,et){var rt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,it=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,st=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,ot=arguments.length>6&&arguments[6]!==void 0?arguments[6]:exp$1,at=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,lt="velocity_"+_e;if(nt.__damp===void 0&&(nt.__damp={}),nt.__damp[lt]===void 0&&(nt.__damp[lt]=0),Math.abs(nt[_e]-et)<=at)return nt[_e]=et,!1;rt=Math.max(1e-4,rt);var ct=2/rt,ut=ot(ct*it),ht=nt[_e]-et,dt=et,ft=st*rt;ht=Math.min(Math.max(ht,-ft),ft),et=nt[_e]-ht;var pt=(nt.__damp[lt]+ct*ht)*it;nt.__damp[lt]=(nt.__damp[lt]-ct*pt)*ut;var mt=et+(ht+pt)*ut;return dt-nt[_e]>0==mt>dt&&(mt=dt,nt.__damp[lt]=(mt-dt)/it),nt[_e]=mt,!0}var isCamera=function(_e){return _e&&_e.isCamera},isLight=function(_e){return _e&&_e.isLight},vl3d=new Vector3$1,_q1$1=new Quaternion$1,_q2=new Quaternion$1,_m1$3=new Matrix4$1,_position=new Vector3$1;function dampLookAt(nt,_e,et,rt,it,st,ot){typeof _e=="number"?vl3d.setScalar(_e):Array.isArray(_e)?vl3d.set(_e[0],_e[1],_e[2]):vl3d.copy(_e);var at=nt.parent;nt.updateWorldMatrix(!0,!1),_position.setFromMatrixPosition(nt.matrixWorld),isCamera(nt)||isLight(nt)?_m1$3.lookAt(_position,vl3d,nt.up):_m1$3.lookAt(vl3d,_position,nt.up),dampQ(nt.quaternion,_q2.setFromRotationMatrix(_m1$3),et,rt,it,st,ot),at&&(_m1$3.extractRotation(at.matrixWorld),_q1$1.setFromRotationMatrix(_m1$3),dampQ(nt.quaternion,_q2.copy(nt.quaternion).premultiply(_q1$1.invert()),et,rt,it,st,ot))}function dampAngle(nt,_e,et,rt,it,st,ot,at){return damp$1(nt,_e,nt[_e]+deltaAngle(nt[_e],et),rt,it,st,ot,at)}var v2d=new Vector2$1,a2,b2;function damp2(nt,_e,et,rt,it,st,ot){return typeof _e=="number"?v2d.setScalar(_e):Array.isArray(_e)?v2d.set(_e[0],_e[1]):v2d.copy(_e),a2=damp$1(nt,"x",v2d.x,et,rt,it,st,ot),b2=damp$1(nt,"y",v2d.y,et,rt,it,st,ot),a2||b2}var v3d=new Vector3$1,a3,b3,c3;function damp3(nt,_e,et,rt,it,st,ot){return typeof _e=="number"?v3d.setScalar(_e):Array.isArray(_e)?v3d.set(_e[0],_e[1],_e[2]):v3d.copy(_e),a3=damp$1(nt,"x",v3d.x,et,rt,it,st,ot),b3=damp$1(nt,"y",v3d.y,et,rt,it,st,ot),c3=damp$1(nt,"z",v3d.z,et,rt,it,st,ot),a3||b3||c3}var v4d=new Vector4$1,a4,b4,c4,d4;function damp4(nt,_e,et,rt,it,st,ot){return typeof _e=="number"?v4d.setScalar(_e):Array.isArray(_e)?v4d.set(_e[0],_e[1],_e[2],_e[3]):v4d.copy(_e),a4=damp$1(nt,"x",v4d.x,et,rt,it,st,ot),b4=damp$1(nt,"y",v4d.y,et,rt,it,st,ot),c4=damp$1(nt,"z",v4d.z,et,rt,it,st,ot),d4=damp$1(nt,"w",v4d.w,et,rt,it,st,ot),a4||b4||c4||d4}var rot=new Euler$1,aE,bE,cE;function dampE(nt,_e,et,rt,it,st,ot){return Array.isArray(_e)?rot.set(_e[0],_e[1],_e[2],_e[3]):rot.copy(_e),aE=dampAngle(nt,"x",rot.x,et,rt,it,st,ot),bE=dampAngle(nt,"y",rot.y,et,rt,it,st,ot),cE=dampAngle(nt,"z",rot.z,et,rt,it,st,ot),aE||bE||cE}var col=new Color$2,aC,bC$1,cC;function dampC(nt,_e,et,rt,it,st,ot){return _e instanceof Color$2?col.copy(_e):Array.isArray(_e)?col.setRGB(_e[0],_e[1],_e[2]):col.set(_e),aC=damp$1(nt,"r",col.r,et,rt,it,st,ot),bC$1=damp$1(nt,"g",col.g,et,rt,it,st,ot),cC=damp$1(nt,"b",col.b,et,rt,it,st,ot),aC||bC$1||cC}var qt=new Quaternion$1,v4result=new Vector4$1,v4velocity=new Vector4$1,v4error=new Vector4$1,aQ,bQ,cQ,dQ;function dampQ(nt,_e,et,rt,it,st,ot){var at=nt;Array.isArray(_e)?qt.set(_e[0],_e[1],_e[2],_e[3]):qt.copy(_e);var lt=nt.dot(qt)>0?1:-1;return qt.x*=lt,qt.y*=lt,qt.z*=lt,qt.w*=lt,aQ=damp$1(nt,"x",qt.x,et,rt,it,st,ot),bQ=damp$1(nt,"y",qt.y,et,rt,it,st,ot),cQ=damp$1(nt,"z",qt.z,et,rt,it,st,ot),dQ=damp$1(nt,"w",qt.w,et,rt,it,st,ot),v4result.set(nt.x,nt.y,nt.z,nt.w).normalize(),v4velocity.set(at.__damp.velocity_x,at.__damp.velocity_y,at.__damp.velocity_z,at.__damp.velocity_w),v4error.copy(v4result).multiplyScalar(v4velocity.dot(v4result)/v4result.dot(v4result)),at.__damp.velocity_x-=v4error.x,at.__damp.velocity_y-=v4error.y,at.__damp.velocity_z-=v4error.z,at.__damp.velocity_w-=v4error.w,nt.set(v4result.x,v4result.y,v4result.z,v4result.w),aQ||bQ||cQ||dQ}var spherical$2=new Spherical,aS,bS,cS;function dampS(nt,_e,et,rt,it,st,ot){return Array.isArray(_e)?spherical$2.set(_e[0],_e[1],_e[2]):spherical$2.copy(_e),aS=damp$1(nt,"radius",spherical$2.radius,et,rt,it,st,ot),bS=dampAngle(nt,"phi",spherical$2.phi,et,rt,it,st,ot),cS=dampAngle(nt,"theta",spherical$2.theta,et,rt,it,st,ot),aS||bS||cS}var mat=new Matrix4$1,mPos=new Vector3$1,mRot=new Quaternion$1,mSca=new Vector3$1,aM,bM,cM;function dampM(nt,_e,et,rt,it,st,ot){var at=nt;return at.__damp===void 0&&(at.__damp={position:new Vector3$1,rotation:new Quaternion$1,scale:new Vector3$1},nt.decompose(at.__damp.position,at.__damp.rotation,at.__damp.scale)),Array.isArray(_e)?mat.set.apply(mat,_toConsumableArray$8(_e)):mat.copy(_e),mat.decompose(mPos,mRot,mSca),aM=damp3(at.__damp.position,mPos,et,rt,it,st,ot),bM=dampQ(at.__damp.rotation,mRot,et,rt,it,st,ot),cM=damp3(at.__damp.scale,mSca,et,rt,it,st,ot),nt.compose(at.__damp.position,at.__damp.rotation,at.__damp.scale),aM||bM||cM}var easing=Object.freeze({__proto__:null,rsqw,exp:exp$1,linear:linear$2,sine,cubic,quint,circ,quart,expo,damp:damp$1,dampLookAt,dampAngle,damp2,damp3,damp4,dampE,dampC,dampQ,dampS,dampM});let webGL2Available;function isWebGL2Available(){var nt;if(webGL2Available!==void 0)return webGL2Available;try{let _e;const et=document.createElement("canvas");return webGL2Available=!!(window.WebGL2RenderingContext&&(_e=et.getContext("webgl2"))),_e&&((nt=_e.getExtension("WEBGL_lose_context"))==null||nt.loseContext()),webGL2Available}catch{return webGL2Available=!1}}const version$1=parseInt(REVISION$1.replace(/\D+/g,""));function toTrianglesDrawMode$1(nt,_e){if(_e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),nt;if(_e===TriangleFanDrawMode||_e===TriangleStripDrawMode){let et=nt.getIndex();if(et===null){const ot=[],at=nt.getAttribute("position");if(at!==void 0){for(let lt=0;lt<at.count;lt++)ot.push(lt);nt.setIndex(ot),et=nt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),nt}const rt=et.count-2,it=[];if(et)if(_e===TriangleFanDrawMode)for(let ot=1;ot<=rt;ot++)it.push(et.getX(0)),it.push(et.getX(ot)),it.push(et.getX(ot+1));else for(let ot=0;ot<rt;ot++)ot%2===0?(it.push(et.getX(ot)),it.push(et.getX(ot+1)),it.push(et.getX(ot+2))):(it.push(et.getX(ot+2)),it.push(et.getX(ot+1)),it.push(et.getX(ot)));it.length/3!==rt&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const st=nt.clone();return st.setIndex(it),st.clearGroups(),st}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_e),nt}var __defProp=Object.defineProperty,__defNormalProp=(nt,_e,et)=>_e in nt?__defProp(nt,_e,{enumerable:!0,configurable:!0,writable:!0,value:et}):nt[_e]=et,__publicField=(nt,_e,et)=>(__defNormalProp(nt,typeof _e!="symbol"?_e+"":_e,et),et);const _ray$2=new Ray$1,_plane$2=new Plane$1,TILT_LIMIT=Math.cos(70*(Math.PI/180)),moduloWrapAround=(nt,_e)=>(nt%_e+_e)%_e;let OrbitControls$2=class extends EventDispatcher$1{constructor(_e,et){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3$1),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"zoomToCursor",!1),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),this.object=_e,this.domElement=et,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>ut.phi,this.getAzimuthalAngle=()=>ut.theta,this.setPolarAngle=vn=>{let qn=moduloWrapAround(vn,2*Math.PI),vr=ut.phi;vr<0&&(vr+=2*Math.PI),qn<0&&(qn+=2*Math.PI);let Sn=Math.abs(qn-vr);2*Math.PI-Sn<Sn&&(qn<vr?qn+=2*Math.PI:vr+=2*Math.PI),ht.phi=qn-vr,rt.update()},this.setAzimuthalAngle=vn=>{let qn=moduloWrapAround(vn,2*Math.PI),vr=ut.theta;vr<0&&(vr+=2*Math.PI),qn<0&&(qn+=2*Math.PI);let Sn=Math.abs(qn-vr);2*Math.PI-Sn<Sn&&(qn<vr?qn+=2*Math.PI:vr+=2*Math.PI),ht.theta=qn-vr,rt.update()},this.getDistance=()=>rt.object.position.distanceTo(rt.target),this.listenToKeyEvents=vn=>{vn.addEventListener("keydown",jn),this._domElementKeyEvents=vn},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",jn),this._domElementKeyEvents=null},this.saveState=()=>{rt.target0.copy(rt.target),rt.position0.copy(rt.object.position),rt.zoom0=rt.object.zoom},this.reset=()=>{rt.target.copy(rt.target0),rt.object.position.copy(rt.position0),rt.object.zoom=rt.zoom0,rt.object.updateProjectionMatrix(),rt.dispatchEvent(it),rt.update(),lt=at.NONE},this.update=(()=>{const vn=new Vector3$1,qn=new Vector3$1(0,1,0),vr=new Quaternion$1().setFromUnitVectors(_e.up,qn),Sn=vr.clone().invert(),Ar=new Vector3$1,Nn=new Quaternion$1,nr=2*Math.PI;return function(){const Dn=rt.object.position;vr.setFromUnitVectors(_e.up,qn),Sn.copy(vr).invert(),vn.copy(Dn).sub(rt.target),vn.applyQuaternion(vr),ut.setFromVector3(vn),rt.autoRotate&&lt===at.NONE&&Yt(zt()),rt.enableDamping?(ut.theta+=ht.theta*rt.dampingFactor,ut.phi+=ht.phi*rt.dampingFactor):(ut.theta+=ht.theta,ut.phi+=ht.phi);let Pr=rt.minAzimuthAngle,jr=rt.maxAzimuthAngle;isFinite(Pr)&&isFinite(jr)&&(Pr<-Math.PI?Pr+=nr:Pr>Math.PI&&(Pr-=nr),jr<-Math.PI?jr+=nr:jr>Math.PI&&(jr-=nr),Pr<=jr?ut.theta=Math.max(Pr,Math.min(jr,ut.theta)):ut.theta=ut.theta>(Pr+jr)/2?Math.max(Pr,ut.theta):Math.min(jr,ut.theta)),ut.phi=Math.max(rt.minPolarAngle,Math.min(rt.maxPolarAngle,ut.phi)),ut.makeSafe(),rt.enableDamping===!0?rt.target.addScaledVector(ft,rt.dampingFactor):rt.target.add(ft),rt.zoomToCursor&&kt||rt.object.isOrthographicCamera?ut.radius=sn(ut.radius):ut.radius=sn(ut.radius*dt),vn.setFromSpherical(ut),vn.applyQuaternion(Sn),Dn.copy(rt.target).add(vn),rt.object.matrixAutoUpdate||rt.object.updateMatrix(),rt.object.lookAt(rt.target),rt.enableDamping===!0?(ht.theta*=1-rt.dampingFactor,ht.phi*=1-rt.dampingFactor,ft.multiplyScalar(1-rt.dampingFactor)):(ht.set(0,0,0),ft.set(0,0,0));let Jr=!1;if(rt.zoomToCursor&&kt){let Lr=null;if(rt.object instanceof PerspectiveCamera$2&&rt.object.isPerspectiveCamera){const Wr=vn.length();Lr=sn(Wr*dt);const As=Wr-Lr;rt.object.position.addScaledVector(Lt,As),rt.object.updateMatrixWorld()}else if(rt.object.isOrthographicCamera){const Wr=new Vector3$1($t.x,$t.y,0);Wr.unproject(rt.object),rt.object.zoom=Math.max(rt.minZoom,Math.min(rt.maxZoom,rt.object.zoom/dt)),rt.object.updateProjectionMatrix(),Jr=!0;const As=new Vector3$1($t.x,$t.y,0);As.unproject(rt.object),rt.object.position.sub(As).add(Wr),rt.object.updateMatrixWorld(),Lr=vn.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),rt.zoomToCursor=!1;Lr!==null&&(rt.screenSpacePanning?rt.target.set(0,0,-1).transformDirection(rt.object.matrix).multiplyScalar(Lr).add(rt.object.position):(_ray$2.origin.copy(rt.object.position),_ray$2.direction.set(0,0,-1).transformDirection(rt.object.matrix),Math.abs(rt.object.up.dot(_ray$2.direction))<TILT_LIMIT?_e.lookAt(rt.target):(_plane$2.setFromNormalAndCoplanarPoint(rt.object.up,rt.target),_ray$2.intersectPlane(_plane$2,rt.target))))}else rt.object instanceof OrthographicCamera$1&&rt.object.isOrthographicCamera&&(Jr=dt!==1,Jr&&(rt.object.zoom=Math.max(rt.minZoom,Math.min(rt.maxZoom,rt.object.zoom/dt)),rt.object.updateProjectionMatrix()));return dt=1,kt=!1,Jr||Ar.distanceToSquared(rt.object.position)>ct||8*(1-Nn.dot(rt.object.quaternion))>ct?(rt.dispatchEvent(it),Ar.copy(rt.object.position),Nn.copy(rt.object.quaternion),Jr=!1,!0):!1}})(),this.connect=vn=>{rt.domElement=vn,rt.domElement.style.touchAction="none",rt.domElement.addEventListener("contextmenu",cr),rt.domElement.addEventListener("pointerdown",en),rt.domElement.addEventListener("pointercancel",gn),rt.domElement.addEventListener("wheel",gr)},this.dispose=()=>{var vn,qn,vr,Sn,Ar,Nn;rt.domElement&&(rt.domElement.style.touchAction="auto"),(vn=rt.domElement)==null||vn.removeEventListener("contextmenu",cr),(qn=rt.domElement)==null||qn.removeEventListener("pointerdown",en),(vr=rt.domElement)==null||vr.removeEventListener("pointercancel",gn),(Sn=rt.domElement)==null||Sn.removeEventListener("wheel",gr),(Ar=rt.domElement)==null||Ar.ownerDocument.removeEventListener("pointermove",wn),(Nn=rt.domElement)==null||Nn.ownerDocument.removeEventListener("pointerup",gn),rt._domElementKeyEvents!==null&&rt._domElementKeyEvents.removeEventListener("keydown",jn)};const rt=this,it={type:"change"},st={type:"start"},ot={type:"end"},at={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let lt=at.NONE;const ct=1e-6,ut=new Spherical,ht=new Spherical;let dt=1;const ft=new Vector3$1,pt=new Vector2$1,mt=new Vector2$1,At=new Vector2$1,gt=new Vector2$1,bt=new Vector2$1,Tt=new Vector2$1,wt=new Vector2$1,Rt=new Vector2$1,It=new Vector2$1,Lt=new Vector3$1,$t=new Vector2$1;let kt=!1;const Dt=[],Ot={};function zt(){return 2*Math.PI/60/60*rt.autoRotateSpeed}function Ht(){return Math.pow(.95,rt.zoomSpeed)}function Yt(vn){rt.reverseOrbit||rt.reverseHorizontalOrbit?ht.theta+=vn:ht.theta-=vn}function Xt(vn){rt.reverseOrbit||rt.reverseVerticalOrbit?ht.phi+=vn:ht.phi-=vn}const Zt=(()=>{const vn=new Vector3$1;return function(vr,Sn){vn.setFromMatrixColumn(Sn,0),vn.multiplyScalar(-vr),ft.add(vn)}})(),rn=(()=>{const vn=new Vector3$1;return function(vr,Sn){rt.screenSpacePanning===!0?vn.setFromMatrixColumn(Sn,1):(vn.setFromMatrixColumn(Sn,0),vn.crossVectors(rt.object.up,vn)),vn.multiplyScalar(vr),ft.add(vn)}})(),Gt=(()=>{const vn=new Vector3$1;return function(vr,Sn){const Ar=rt.domElement;if(Ar&&rt.object instanceof PerspectiveCamera$2&&rt.object.isPerspectiveCamera){const Nn=rt.object.position;vn.copy(Nn).sub(rt.target);let nr=vn.length();nr*=Math.tan(rt.object.fov/2*Math.PI/180),Zt(2*vr*nr/Ar.clientHeight,rt.object.matrix),rn(2*Sn*nr/Ar.clientHeight,rt.object.matrix)}else Ar&&rt.object instanceof OrthographicCamera$1&&rt.object.isOrthographicCamera?(Zt(vr*(rt.object.right-rt.object.left)/rt.object.zoom/Ar.clientWidth,rt.object.matrix),rn(Sn*(rt.object.top-rt.object.bottom)/rt.object.zoom/Ar.clientHeight,rt.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),rt.enablePan=!1)}})();function jt(vn){rt.object instanceof PerspectiveCamera$2&&rt.object.isPerspectiveCamera||rt.object instanceof OrthographicCamera$1&&rt.object.isOrthographicCamera?dt/=vn:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),rt.enableZoom=!1)}function Kt(vn){rt.object instanceof PerspectiveCamera$2&&rt.object.isPerspectiveCamera||rt.object instanceof OrthographicCamera$1&&rt.object.isOrthographicCamera?dt*=vn:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),rt.enableZoom=!1)}function Jt(vn){if(!rt.zoomToCursor||!rt.domElement)return;kt=!0;const qn=rt.domElement.getBoundingClientRect(),vr=vn.clientX-qn.left,Sn=vn.clientY-qn.top,Ar=qn.width,Nn=qn.height;$t.x=vr/Ar*2-1,$t.y=-(Sn/Nn)*2+1,Lt.set($t.x,$t.y,1).unproject(rt.object).sub(rt.object.position).normalize()}function sn(vn){return Math.max(rt.minDistance,Math.min(rt.maxDistance,vn))}function hn(vn){pt.set(vn.clientX,vn.clientY)}function an(vn){Jt(vn),wt.set(vn.clientX,vn.clientY)}function pn(vn){gt.set(vn.clientX,vn.clientY)}function _n(vn){mt.set(vn.clientX,vn.clientY),At.subVectors(mt,pt).multiplyScalar(rt.rotateSpeed);const qn=rt.domElement;qn&&(Yt(2*Math.PI*At.x/qn.clientHeight),Xt(2*Math.PI*At.y/qn.clientHeight)),pt.copy(mt),rt.update()}function yn(vn){Rt.set(vn.clientX,vn.clientY),It.subVectors(Rt,wt),It.y>0?jt(Ht()):It.y<0&&Kt(Ht()),wt.copy(Rt),rt.update()}function $n(vn){bt.set(vn.clientX,vn.clientY),Tt.subVectors(bt,gt).multiplyScalar(rt.panSpeed),Gt(Tt.x,Tt.y),gt.copy(bt),rt.update()}function Jn(vn){Jt(vn),vn.deltaY<0?Kt(Ht()):vn.deltaY>0&&jt(Ht()),rt.update()}function Xn(vn){let qn=!1;switch(vn.code){case rt.keys.UP:Gt(0,rt.keyPanSpeed),qn=!0;break;case rt.keys.BOTTOM:Gt(0,-rt.keyPanSpeed),qn=!0;break;case rt.keys.LEFT:Gt(rt.keyPanSpeed,0),qn=!0;break;case rt.keys.RIGHT:Gt(-rt.keyPanSpeed,0),qn=!0;break}qn&&(vn.preventDefault(),rt.update())}function Vn(){if(Dt.length==1)pt.set(Dt[0].pageX,Dt[0].pageY);else{const vn=.5*(Dt[0].pageX+Dt[1].pageX),qn=.5*(Dt[0].pageY+Dt[1].pageY);pt.set(vn,qn)}}function En(){if(Dt.length==1)gt.set(Dt[0].pageX,Dt[0].pageY);else{const vn=.5*(Dt[0].pageX+Dt[1].pageX),qn=.5*(Dt[0].pageY+Dt[1].pageY);gt.set(vn,qn)}}function dn(){const vn=Dt[0].pageX-Dt[1].pageX,qn=Dt[0].pageY-Dt[1].pageY,vr=Math.sqrt(vn*vn+qn*qn);wt.set(0,vr)}function rr(){rt.enableZoom&&dn(),rt.enablePan&&En()}function er(){rt.enableZoom&&dn(),rt.enableRotate&&Vn()}function Yn(vn){if(Dt.length==1)mt.set(vn.pageX,vn.pageY);else{const vr=pr(vn),Sn=.5*(vn.pageX+vr.x),Ar=.5*(vn.pageY+vr.y);mt.set(Sn,Ar)}At.subVectors(mt,pt).multiplyScalar(rt.rotateSpeed);const qn=rt.domElement;qn&&(Yt(2*Math.PI*At.x/qn.clientHeight),Xt(2*Math.PI*At.y/qn.clientHeight)),pt.copy(mt)}function ir(vn){if(Dt.length==1)bt.set(vn.pageX,vn.pageY);else{const qn=pr(vn),vr=.5*(vn.pageX+qn.x),Sn=.5*(vn.pageY+qn.y);bt.set(vr,Sn)}Tt.subVectors(bt,gt).multiplyScalar(rt.panSpeed),Gt(Tt.x,Tt.y),gt.copy(bt)}function Qn(vn){const qn=pr(vn),vr=vn.pageX-qn.x,Sn=vn.pageY-qn.y,Ar=Math.sqrt(vr*vr+Sn*Sn);Rt.set(0,Ar),It.set(0,Math.pow(Rt.y/wt.y,rt.zoomSpeed)),jt(It.y),wt.copy(Rt)}function sr(vn){rt.enableZoom&&Qn(vn),rt.enablePan&&ir(vn)}function un(vn){rt.enableZoom&&Qn(vn),rt.enableRotate&&Yn(vn)}function en(vn){var qn,vr;rt.enabled!==!1&&(Dt.length===0&&((qn=rt.domElement)==null||qn.ownerDocument.addEventListener("pointermove",wn),(vr=rt.domElement)==null||vr.ownerDocument.addEventListener("pointerup",gn)),yr(vn),vn.pointerType==="touch"?hr(vn):Mn(vn))}function wn(vn){rt.enabled!==!1&&(vn.pointerType==="touch"?Tr(vn):In(vn))}function gn(vn){var qn,vr,Sn;Rr(vn),Dt.length===0&&((qn=rt.domElement)==null||qn.releasePointerCapture(vn.pointerId),(vr=rt.domElement)==null||vr.ownerDocument.removeEventListener("pointermove",wn),(Sn=rt.domElement)==null||Sn.ownerDocument.removeEventListener("pointerup",gn)),rt.dispatchEvent(ot),lt=at.NONE}function Mn(vn){let qn;switch(vn.button){case 0:qn=rt.mouseButtons.LEFT;break;case 1:qn=rt.mouseButtons.MIDDLE;break;case 2:qn=rt.mouseButtons.RIGHT;break;default:qn=-1}switch(qn){case MOUSE.DOLLY:if(rt.enableZoom===!1)return;an(vn),lt=at.DOLLY;break;case MOUSE.ROTATE:if(vn.ctrlKey||vn.metaKey||vn.shiftKey){if(rt.enablePan===!1)return;pn(vn),lt=at.PAN}else{if(rt.enableRotate===!1)return;hn(vn),lt=at.ROTATE}break;case MOUSE.PAN:if(vn.ctrlKey||vn.metaKey||vn.shiftKey){if(rt.enableRotate===!1)return;hn(vn),lt=at.ROTATE}else{if(rt.enablePan===!1)return;pn(vn),lt=at.PAN}break;default:lt=at.NONE}lt!==at.NONE&&rt.dispatchEvent(st)}function In(vn){if(rt.enabled!==!1)switch(lt){case at.ROTATE:if(rt.enableRotate===!1)return;_n(vn);break;case at.DOLLY:if(rt.enableZoom===!1)return;yn(vn);break;case at.PAN:if(rt.enablePan===!1)return;$n(vn);break}}function gr(vn){rt.enabled===!1||rt.enableZoom===!1||lt!==at.NONE&&lt!==at.ROTATE||(vn.preventDefault(),rt.dispatchEvent(st),Jn(vn),rt.dispatchEvent(ot))}function jn(vn){rt.enabled===!1||rt.enablePan===!1||Xn(vn)}function hr(vn){switch(br(vn),Dt.length){case 1:switch(rt.touches.ONE){case TOUCH.ROTATE:if(rt.enableRotate===!1)return;Vn(),lt=at.TOUCH_ROTATE;break;case TOUCH.PAN:if(rt.enablePan===!1)return;En(),lt=at.TOUCH_PAN;break;default:lt=at.NONE}break;case 2:switch(rt.touches.TWO){case TOUCH.DOLLY_PAN:if(rt.enableZoom===!1&&rt.enablePan===!1)return;rr(),lt=at.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(rt.enableZoom===!1&&rt.enableRotate===!1)return;er(),lt=at.TOUCH_DOLLY_ROTATE;break;default:lt=at.NONE}break;default:lt=at.NONE}lt!==at.NONE&&rt.dispatchEvent(st)}function Tr(vn){switch(br(vn),lt){case at.TOUCH_ROTATE:if(rt.enableRotate===!1)return;Yn(vn),rt.update();break;case at.TOUCH_PAN:if(rt.enablePan===!1)return;ir(vn),rt.update();break;case at.TOUCH_DOLLY_PAN:if(rt.enableZoom===!1&&rt.enablePan===!1)return;sr(vn),rt.update();break;case at.TOUCH_DOLLY_ROTATE:if(rt.enableZoom===!1&&rt.enableRotate===!1)return;un(vn),rt.update();break;default:lt=at.NONE}}function cr(vn){rt.enabled!==!1&&vn.preventDefault()}function yr(vn){Dt.push(vn)}function Rr(vn){delete Ot[vn.pointerId];for(let qn=0;qn<Dt.length;qn++)if(Dt[qn].pointerId==vn.pointerId){Dt.splice(qn,1);return}}function br(vn){let qn=Ot[vn.pointerId];qn===void 0&&(qn=new Vector2$1,Ot[vn.pointerId]=qn),qn.set(vn.pageX,vn.pageY)}function pr(vn){const qn=vn.pointerId===Dt[0].pointerId?Dt[1]:Dt[0];return Ot[qn.pointerId]}et!==void 0&&this.connect(et),this.update()}};function decodeText(nt){if(typeof TextDecoder<"u")return new TextDecoder().decode(nt);let _e="";for(let et=0,rt=nt.length;et<rt;et++)_e+=String.fromCharCode(nt[et]);try{return decodeURIComponent(escape(_e))}catch{return _e}}const SRGBColorSpace$1="srgb",LinearSRGBColorSpace$1="srgb-linear",sRGBEncoding=3001,LinearEncoding=3e3;class GLTFLoader extends Loader{constructor(_e){super(_e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(et){return new GLTFMaterialsClearcoatExtension(et)}),this.register(function(et){return new GLTFMaterialsDispersionExtension(et)}),this.register(function(et){return new GLTFTextureBasisUExtension(et)}),this.register(function(et){return new GLTFTextureWebPExtension(et)}),this.register(function(et){return new GLTFTextureAVIFExtension(et)}),this.register(function(et){return new GLTFMaterialsSheenExtension(et)}),this.register(function(et){return new GLTFMaterialsTransmissionExtension(et)}),this.register(function(et){return new GLTFMaterialsVolumeExtension(et)}),this.register(function(et){return new GLTFMaterialsIorExtension(et)}),this.register(function(et){return new GLTFMaterialsEmissiveStrengthExtension(et)}),this.register(function(et){return new GLTFMaterialsSpecularExtension(et)}),this.register(function(et){return new GLTFMaterialsIridescenceExtension(et)}),this.register(function(et){return new GLTFMaterialsAnisotropyExtension(et)}),this.register(function(et){return new GLTFMaterialsBumpExtension(et)}),this.register(function(et){return new GLTFLightsExtension(et)}),this.register(function(et){return new GLTFMeshoptCompression(et)}),this.register(function(et){return new GLTFMeshGpuInstancing(et)})}load(_e,et,rt,it){const st=this;let ot;if(this.resourcePath!=="")ot=this.resourcePath;else if(this.path!==""){const ct=LoaderUtils.extractUrlBase(_e);ot=LoaderUtils.resolveURL(ct,this.path)}else ot=LoaderUtils.extractUrlBase(_e);this.manager.itemStart(_e);const at=function(ct){it?it(ct):console.error(ct),st.manager.itemError(_e),st.manager.itemEnd(_e)},lt=new FileLoader(this.manager);lt.setPath(this.path),lt.setResponseType("arraybuffer"),lt.setRequestHeader(this.requestHeader),lt.setWithCredentials(this.withCredentials),lt.load(_e,function(ct){try{st.parse(ct,ot,function(ut){et(ut),st.manager.itemEnd(_e)},at)}catch(ut){at(ut)}},rt,at)}setDRACOLoader(_e){return this.dracoLoader=_e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_e){return this.ktx2Loader=_e,this}setMeshoptDecoder(_e){return this.meshoptDecoder=_e,this}register(_e){return this.pluginCallbacks.indexOf(_e)===-1&&this.pluginCallbacks.push(_e),this}unregister(_e){return this.pluginCallbacks.indexOf(_e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_e),1),this}parse(_e,et,rt,it){let st;const ot={},at={};if(typeof _e=="string")st=JSON.parse(_e);else if(_e instanceof ArrayBuffer)if(decodeText(new Uint8Array(_e.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC){try{ot[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_e)}catch(ut){it&&it(ut);return}st=JSON.parse(ot[EXTENSIONS.KHR_BINARY_GLTF].content)}else st=JSON.parse(decodeText(new Uint8Array(_e)));else st=_e;if(st.asset===void 0||st.asset.version[0]<2){it&&it(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const lt=new GLTFParser(st,{path:et||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});lt.fileLoader.setRequestHeader(this.requestHeader);for(let ct=0;ct<this.pluginCallbacks.length;ct++){const ut=this.pluginCallbacks[ct](lt);ut.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),at[ut.name]=ut,ot[ut.name]=!0}if(st.extensionsUsed)for(let ct=0;ct<st.extensionsUsed.length;++ct){const ut=st.extensionsUsed[ct],ht=st.extensionsRequired||[];switch(ut){case EXTENSIONS.KHR_MATERIALS_UNLIT:ot[ut]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:ot[ut]=new GLTFDracoMeshCompressionExtension(st,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:ot[ut]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:ot[ut]=new GLTFMeshQuantizationExtension;break;default:ht.indexOf(ut)>=0&&at[ut]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ut+'".')}}lt.setExtensions(ot),lt.setPlugins(at),lt.parse(rt,it)}parseAsync(_e,et){const rt=this;return new Promise(function(it,st){rt.parse(_e,et,it,st)})}}function GLTFRegistry(){let nt={};return{get:function(_e){return nt[_e]},add:function(_e,et){nt[_e]=et},remove:function(_e){delete nt[_e]},removeAll:function(){nt={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _e=this.parser,et=this.parser.json.nodes||[];for(let rt=0,it=et.length;rt<it;rt++){const st=et[rt];st.extensions&&st.extensions[this.name]&&st.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,st.extensions[this.name].light)}}_loadLight(_e){const et=this.parser,rt="light:"+_e;let it=et.cache.get(rt);if(it)return it;const st=et.json,lt=((st.extensions&&st.extensions[this.name]||{}).lights||[])[_e];let ct;const ut=new Color$2(16777215);lt.color!==void 0&&ut.setRGB(lt.color[0],lt.color[1],lt.color[2],LinearSRGBColorSpace$1);const ht=lt.range!==void 0?lt.range:0;switch(lt.type){case"directional":ct=new DirectionalLight$1(ut),ct.target.position.set(0,0,-1),ct.add(ct.target);break;case"point":ct=new PointLight$1(ut),ct.distance=ht;break;case"spot":ct=new SpotLight$1(ut),ct.distance=ht,lt.spot=lt.spot||{},lt.spot.innerConeAngle=lt.spot.innerConeAngle!==void 0?lt.spot.innerConeAngle:0,lt.spot.outerConeAngle=lt.spot.outerConeAngle!==void 0?lt.spot.outerConeAngle:Math.PI/4,ct.angle=lt.spot.outerConeAngle,ct.penumbra=1-lt.spot.innerConeAngle/lt.spot.outerConeAngle,ct.target.position.set(0,0,-1),ct.add(ct.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+lt.type)}return ct.position.set(0,0,0),ct.decay=2,assignExtrasToUserData(ct,lt),lt.intensity!==void 0&&(ct.intensity=lt.intensity),ct.name=et.createUniqueName(lt.name||"light_"+_e),it=Promise.resolve(ct),et.cache.add(rt,it),it}getDependency(_e,et){if(_e==="light")return this._loadLight(et)}createNodeAttachment(_e){const et=this,rt=this.parser,st=rt.json.nodes[_e],at=(st.extensions&&st.extensions[this.name]||{}).light;return at===void 0?null:this._loadLight(at).then(function(lt){return rt._getNodeRef(et.cache,at,lt)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial$1}extendParams(_e,et,rt){const it=[];_e.color=new Color$2(1,1,1),_e.opacity=1;const st=et.pbrMetallicRoughness;if(st){if(Array.isArray(st.baseColorFactor)){const ot=st.baseColorFactor;_e.color.setRGB(ot[0],ot[1],ot[2],LinearSRGBColorSpace$1),_e.opacity=ot[3]}st.baseColorTexture!==void 0&&it.push(rt.assignTexture(_e,"map",st.baseColorTexture,SRGBColorSpace$1))}return Promise.all(it)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_e,et){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name].emissiveStrength;return st!==void 0&&(et.emissiveIntensity=st),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];if(ot.clearcoatFactor!==void 0&&(et.clearcoat=ot.clearcoatFactor),ot.clearcoatTexture!==void 0&&st.push(rt.assignTexture(et,"clearcoatMap",ot.clearcoatTexture)),ot.clearcoatRoughnessFactor!==void 0&&(et.clearcoatRoughness=ot.clearcoatRoughnessFactor),ot.clearcoatRoughnessTexture!==void 0&&st.push(rt.assignTexture(et,"clearcoatRoughnessMap",ot.clearcoatRoughnessTexture)),ot.clearcoatNormalTexture!==void 0&&(st.push(rt.assignTexture(et,"clearcoatNormalMap",ot.clearcoatNormalTexture)),ot.clearcoatNormalTexture.scale!==void 0)){const at=ot.clearcoatNormalTexture.scale;et.clearcoatNormalScale=new Vector2$1(at,at)}return Promise.all(st)}}class GLTFMaterialsDispersionExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_DISPERSION}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name];return et.dispersion=st.dispersion!==void 0?st.dispersion:0,Promise.resolve()}}class GLTFMaterialsIridescenceExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.iridescenceFactor!==void 0&&(et.iridescence=ot.iridescenceFactor),ot.iridescenceTexture!==void 0&&st.push(rt.assignTexture(et,"iridescenceMap",ot.iridescenceTexture)),ot.iridescenceIor!==void 0&&(et.iridescenceIOR=ot.iridescenceIor),et.iridescenceThicknessRange===void 0&&(et.iridescenceThicknessRange=[100,400]),ot.iridescenceThicknessMinimum!==void 0&&(et.iridescenceThicknessRange[0]=ot.iridescenceThicknessMinimum),ot.iridescenceThicknessMaximum!==void 0&&(et.iridescenceThicknessRange[1]=ot.iridescenceThicknessMaximum),ot.iridescenceThicknessTexture!==void 0&&st.push(rt.assignTexture(et,"iridescenceThicknessMap",ot.iridescenceThicknessTexture)),Promise.all(st)}}class GLTFMaterialsSheenExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[];et.sheenColor=new Color$2(0,0,0),et.sheenRoughness=0,et.sheen=1;const ot=it.extensions[this.name];if(ot.sheenColorFactor!==void 0){const at=ot.sheenColorFactor;et.sheenColor.setRGB(at[0],at[1],at[2],LinearSRGBColorSpace$1)}return ot.sheenRoughnessFactor!==void 0&&(et.sheenRoughness=ot.sheenRoughnessFactor),ot.sheenColorTexture!==void 0&&st.push(rt.assignTexture(et,"sheenColorMap",ot.sheenColorTexture,SRGBColorSpace$1)),ot.sheenRoughnessTexture!==void 0&&st.push(rt.assignTexture(et,"sheenRoughnessMap",ot.sheenRoughnessTexture)),Promise.all(st)}}class GLTFMaterialsTransmissionExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.transmissionFactor!==void 0&&(et.transmission=ot.transmissionFactor),ot.transmissionTexture!==void 0&&st.push(rt.assignTexture(et,"transmissionMap",ot.transmissionTexture)),Promise.all(st)}}class GLTFMaterialsVolumeExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];et.thickness=ot.thicknessFactor!==void 0?ot.thicknessFactor:0,ot.thicknessTexture!==void 0&&st.push(rt.assignTexture(et,"thicknessMap",ot.thicknessTexture)),et.attenuationDistance=ot.attenuationDistance||1/0;const at=ot.attenuationColor||[1,1,1];return et.attenuationColor=new Color$2().setRGB(at[0],at[1],at[2],LinearSRGBColorSpace$1),Promise.all(st)}}class GLTFMaterialsIorExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name];return et.ior=st.ior!==void 0?st.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];et.specularIntensity=ot.specularFactor!==void 0?ot.specularFactor:1,ot.specularTexture!==void 0&&st.push(rt.assignTexture(et,"specularIntensityMap",ot.specularTexture));const at=ot.specularColorFactor||[1,1,1];return et.specularColor=new Color$2().setRGB(at[0],at[1],at[2],LinearSRGBColorSpace$1),ot.specularColorTexture!==void 0&&st.push(rt.assignTexture(et,"specularColorMap",ot.specularColorTexture,SRGBColorSpace$1)),Promise.all(st)}}class GLTFMaterialsBumpExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_MATERIALS_BUMP}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return et.bumpScale=ot.bumpFactor!==void 0?ot.bumpFactor:1,ot.bumpTexture!==void 0&&st.push(rt.assignTexture(et,"bumpMap",ot.bumpTexture)),Promise.all(st)}}class GLTFMaterialsAnisotropyExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_e){const rt=this.parser.json.materials[_e];return!rt.extensions||!rt.extensions[this.name]?null:MeshPhysicalMaterial$1}extendMaterialParams(_e,et){const rt=this.parser,it=rt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.anisotropyStrength!==void 0&&(et.anisotropy=ot.anisotropyStrength),ot.anisotropyRotation!==void 0&&(et.anisotropyRotation=ot.anisotropyRotation),ot.anisotropyTexture!==void 0&&st.push(rt.assignTexture(et,"anisotropyMap",ot.anisotropyTexture)),Promise.all(st)}}class GLTFTextureBasisUExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_e){const et=this.parser,rt=et.json,it=rt.textures[_e];if(!it.extensions||!it.extensions[this.name])return null;const st=it.extensions[this.name],ot=et.options.ktx2Loader;if(!ot){if(rt.extensionsRequired&&rt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return et.loadTextureImage(_e,st.source,ot)}}class GLTFTextureWebPExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_e){const et=this.name,rt=this.parser,it=rt.json,st=it.textures[_e];if(!st.extensions||!st.extensions[et])return null;const ot=st.extensions[et],at=it.images[ot.source];let lt=rt.textureLoader;if(at.uri){const ct=rt.options.manager.getHandler(at.uri);ct!==null&&(lt=ct)}return this.detectSupport().then(function(ct){if(ct)return rt.loadTextureImage(_e,ot.source,lt);if(it.extensionsRequired&&it.extensionsRequired.indexOf(et)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return rt.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const et=new Image;et.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",et.onload=et.onerror=function(){_e(et.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_e){const et=this.name,rt=this.parser,it=rt.json,st=it.textures[_e];if(!st.extensions||!st.extensions[et])return null;const ot=st.extensions[et],at=it.images[ot.source];let lt=rt.textureLoader;if(at.uri){const ct=rt.options.manager.getHandler(at.uri);ct!==null&&(lt=ct)}return this.detectSupport().then(function(ct){if(ct)return rt.loadTextureImage(_e,ot.source,lt);if(it.extensionsRequired&&it.extensionsRequired.indexOf(et)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return rt.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const et=new Image;et.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",et.onload=et.onerror=function(){_e(et.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_e){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_e}loadBufferView(_e){const et=this.parser.json,rt=et.bufferViews[_e];if(rt.extensions&&rt.extensions[this.name]){const it=rt.extensions[this.name],st=this.parser.getDependency("buffer",it.buffer),ot=this.parser.options.meshoptDecoder;if(!ot||!ot.supported){if(et.extensionsRequired&&et.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return st.then(function(at){const lt=it.byteOffset||0,ct=it.byteLength||0,ut=it.count,ht=it.byteStride,dt=new Uint8Array(at,lt,ct);return ot.decodeGltfBufferAsync?ot.decodeGltfBufferAsync(ut,ht,dt,it.mode,it.filter).then(function(ft){return ft.buffer}):ot.ready.then(function(){const ft=new ArrayBuffer(ut*ht);return ot.decodeGltfBuffer(new Uint8Array(ft),ut,ht,dt,it.mode,it.filter),ft})})}else return null}}class GLTFMeshGpuInstancing{constructor(_e){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_e}createNodeMesh(_e){const et=this.parser.json,rt=et.nodes[_e];if(!rt.extensions||!rt.extensions[this.name]||rt.mesh===void 0)return null;const it=et.meshes[rt.mesh];for(const ct of it.primitives)if(ct.mode!==WEBGL_CONSTANTS.TRIANGLES&&ct.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&ct.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&ct.mode!==void 0)return null;const ot=rt.extensions[this.name].attributes,at=[],lt={};for(const ct in ot)at.push(this.parser.getDependency("accessor",ot[ct]).then(ut=>(lt[ct]=ut,lt[ct])));return at.length<1?null:(at.push(this.parser.createNodeMesh(_e)),Promise.all(at).then(ct=>{const ut=ct.pop(),ht=ut.isGroup?ut.children:[ut],dt=ct[0].count,ft=[];for(const pt of ht){const mt=new Matrix4$1,At=new Vector3$1,gt=new Quaternion$1,bt=new Vector3$1(1,1,1),Tt=new InstancedMesh(pt.geometry,pt.material,dt);for(let wt=0;wt<dt;wt++)lt.TRANSLATION&&At.fromBufferAttribute(lt.TRANSLATION,wt),lt.ROTATION&&gt.fromBufferAttribute(lt.ROTATION,wt),lt.SCALE&&bt.fromBufferAttribute(lt.SCALE,wt),Tt.setMatrixAt(wt,mt.compose(At,gt,bt));for(const wt in lt)if(wt==="_COLOR_0"){const Rt=lt[wt];Tt.instanceColor=new InstancedBufferAttribute$1(Rt.array,Rt.itemSize,Rt.normalized)}else wt!=="TRANSLATION"&&wt!=="ROTATION"&&wt!=="SCALE"&&pt.geometry.setAttribute(wt,lt[wt]);Object3D$1.prototype.copy.call(Tt,pt),this.parser.assignFinalMaterial(Tt),ft.push(Tt)}return ut.isGroup?(ut.clear(),ut.add(...ft),ut):ft[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_e){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const et=new DataView(_e,0,BINARY_EXTENSION_HEADER_LENGTH);if(this.header={magic:decodeText(new Uint8Array(_e.slice(0,4))),version:et.getUint32(4,!0),length:et.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const rt=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,it=new DataView(_e,BINARY_EXTENSION_HEADER_LENGTH);let st=0;for(;st<rt;){const ot=it.getUint32(st,!0);st+=4;const at=it.getUint32(st,!0);if(st+=4,at===BINARY_EXTENSION_CHUNK_TYPES.JSON){const lt=new Uint8Array(_e,BINARY_EXTENSION_HEADER_LENGTH+st,ot);this.content=decodeText(lt)}else if(at===BINARY_EXTENSION_CHUNK_TYPES.BIN){const lt=BINARY_EXTENSION_HEADER_LENGTH+st;this.body=_e.slice(lt,lt+ot)}st+=ot}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_e,et){if(!et)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_e,this.dracoLoader=et,this.dracoLoader.preload()}decodePrimitive(_e,et){const rt=this.json,it=this.dracoLoader,st=_e.extensions[this.name].bufferView,ot=_e.extensions[this.name].attributes,at={},lt={},ct={};for(const ut in ot){const ht=ATTRIBUTES[ut]||ut.toLowerCase();at[ht]=ot[ut]}for(const ut in _e.attributes){const ht=ATTRIBUTES[ut]||ut.toLowerCase();if(ot[ut]!==void 0){const dt=rt.accessors[_e.attributes[ut]],ft=WEBGL_COMPONENT_TYPES[dt.componentType];ct[ht]=ft.name,lt[ht]=dt.normalized===!0}}return et.getDependency("bufferView",st).then(function(ut){return new Promise(function(ht,dt){it.decodeDracoFile(ut,function(ft){for(const pt in ft.attributes){const mt=ft.attributes[pt],At=lt[pt];At!==void 0&&(mt.normalized=At)}ht(ft)},at,ct,LinearSRGBColorSpace$1,dt)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_e,et){return(et.texCoord===void 0||et.texCoord===_e.channel)&&et.offset===void 0&&et.rotation===void 0&&et.scale===void 0||(_e=_e.clone(),et.texCoord!==void 0&&(_e.channel=et.texCoord),et.offset!==void 0&&_e.offset.fromArray(et.offset),et.rotation!==void 0&&(_e.rotation=et.rotation),et.scale!==void 0&&_e.repeat.fromArray(et.scale),_e.needsUpdate=!0),_e}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_e,et,rt,it){super(_e,et,rt,it)}copySampleValue_(_e){const et=this.resultBuffer,rt=this.sampleValues,it=this.valueSize,st=_e*it*3+it;for(let ot=0;ot!==it;ot++)et[ot]=rt[st+ot];return et}interpolate_(_e,et,rt,it){const st=this.resultBuffer,ot=this.sampleValues,at=this.valueSize,lt=at*2,ct=at*3,ut=it-et,ht=(rt-et)/ut,dt=ht*ht,ft=dt*ht,pt=_e*ct,mt=pt-ct,At=-2*ft+3*dt,gt=ft-dt,bt=1-At,Tt=gt-dt+ht;for(let wt=0;wt!==at;wt++){const Rt=ot[mt+wt+at],It=ot[mt+wt+lt]*ut,Lt=ot[pt+wt+at],$t=ot[pt+wt]*ut;st[wt]=bt*Rt+Tt*It+At*Lt+gt*$t}return st}}const _q=new Quaternion$1;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_e,et,rt,it){const st=super.interpolate_(_e,et,rt,it);return _q.fromArray(st).normalize().toArray(st),st}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter$1,9729:LinearFilter$1,9984:NearestMipmapNearestFilter$1,9985:LinearMipmapNearestFilter$1,9986:NearestMipmapLinearFilter$1,9987:LinearMipmapLinearFilter$1},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping$1,33648:MirroredRepeatWrapping$1,10497:RepeatWrapping$1},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...version$1>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(nt){return nt.DefaultMaterial===void 0&&(nt.DefaultMaterial=new MeshStandardMaterial$1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide$1})),nt.DefaultMaterial}function addUnknownExtensionsToUserData(nt,_e,et){for(const rt in et.extensions)nt[rt]===void 0&&(_e.userData.gltfExtensions=_e.userData.gltfExtensions||{},_e.userData.gltfExtensions[rt]=et.extensions[rt])}function assignExtrasToUserData(nt,_e){_e.extras!==void 0&&(typeof _e.extras=="object"?Object.assign(nt.userData,_e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_e.extras))}function addMorphTargets(nt,_e,et){let rt=!1,it=!1,st=!1;for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(ht.POSITION!==void 0&&(rt=!0),ht.NORMAL!==void 0&&(it=!0),ht.COLOR_0!==void 0&&(st=!0),rt&&it&&st)break}if(!rt&&!it&&!st)return Promise.resolve(nt);const ot=[],at=[],lt=[];for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(rt){const dt=ht.POSITION!==void 0?et.getDependency("accessor",ht.POSITION):nt.attributes.position;ot.push(dt)}if(it){const dt=ht.NORMAL!==void 0?et.getDependency("accessor",ht.NORMAL):nt.attributes.normal;at.push(dt)}if(st){const dt=ht.COLOR_0!==void 0?et.getDependency("accessor",ht.COLOR_0):nt.attributes.color;lt.push(dt)}}return Promise.all([Promise.all(ot),Promise.all(at),Promise.all(lt)]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];return rt&&(nt.morphAttributes.position=ut),it&&(nt.morphAttributes.normal=ht),st&&(nt.morphAttributes.color=dt),nt.morphTargetsRelative=!0,nt})}function updateMorphTargets(nt,_e){if(nt.updateMorphTargets(),_e.weights!==void 0)for(let et=0,rt=_e.weights.length;et<rt;et++)nt.morphTargetInfluences[et]=_e.weights[et];if(_e.extras&&Array.isArray(_e.extras.targetNames)){const et=_e.extras.targetNames;if(nt.morphTargetInfluences.length===et.length){nt.morphTargetDictionary={};for(let rt=0,it=et.length;rt<it;rt++)nt.morphTargetDictionary[et[rt]]=rt}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(nt){let _e;const et=nt.extensions&&nt.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(et?_e="draco:"+et.bufferView+":"+et.indices+":"+createAttributesKey(et.attributes):_e=nt.indices+":"+createAttributesKey(nt.attributes)+":"+nt.mode,nt.targets!==void 0)for(let rt=0,it=nt.targets.length;rt<it;rt++)_e+=":"+createAttributesKey(nt.targets[rt]);return _e}function createAttributesKey(nt){let _e="";const et=Object.keys(nt).sort();for(let rt=0,it=et.length;rt<it;rt++)_e+=et[rt]+":"+nt[et[rt]]+";";return _e}function getNormalizedComponentScale(nt){switch(nt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(nt){return nt.search(/\.jpe?g($|\?)/i)>0||nt.search(/^data\:image\/jpeg/)===0?"image/jpeg":nt.search(/\.webp($|\?)/i)>0||nt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4$1;class GLTFParser{constructor(_e={},et={}){this.json=_e,this.extensions={},this.plugins={},this.options=et,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let rt=!1,it=!1,st=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(rt=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,it=navigator.userAgent.indexOf("Firefox")>-1,st=it?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||rt||it&&st<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_e){this.extensions=_e}setPlugins(_e){this.plugins=_e}parse(_e,et){const rt=this,it=this.json,st=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(ot){return ot._markDefs&&ot._markDefs()}),Promise.all(this._invokeAll(function(ot){return ot.beforeRoot&&ot.beforeRoot()})).then(function(){return Promise.all([rt.getDependencies("scene"),rt.getDependencies("animation"),rt.getDependencies("camera")])}).then(function(ot){const at={scene:ot[0][it.scene||0],scenes:ot[0],animations:ot[1],cameras:ot[2],asset:it.asset,parser:rt,userData:{}};return addUnknownExtensionsToUserData(st,at,it),assignExtrasToUserData(at,it),Promise.all(rt._invokeAll(function(lt){return lt.afterRoot&&lt.afterRoot(at)})).then(function(){for(const lt of at.scenes)lt.updateMatrixWorld();_e(at)})}).catch(et)}_markDefs(){const _e=this.json.nodes||[],et=this.json.skins||[],rt=this.json.meshes||[];for(let it=0,st=et.length;it<st;it++){const ot=et[it].joints;for(let at=0,lt=ot.length;at<lt;at++)_e[ot[at]].isBone=!0}for(let it=0,st=_e.length;it<st;it++){const ot=_e[it];ot.mesh!==void 0&&(this._addNodeRef(this.meshCache,ot.mesh),ot.skin!==void 0&&(rt[ot.mesh].isSkinnedMesh=!0)),ot.camera!==void 0&&this._addNodeRef(this.cameraCache,ot.camera)}}_addNodeRef(_e,et){et!==void 0&&(_e.refs[et]===void 0&&(_e.refs[et]=_e.uses[et]=0),_e.refs[et]++)}_getNodeRef(_e,et,rt){if(_e.refs[et]<=1)return rt;const it=rt.clone(),st=(ot,at)=>{const lt=this.associations.get(ot);lt!=null&&this.associations.set(at,lt);for(const[ct,ut]of ot.children.entries())st(ut,at.children[ct])};return st(rt,it),it.name+="_instance_"+_e.uses[et]++,it}_invokeOne(_e){const et=Object.values(this.plugins);et.push(this);for(let rt=0;rt<et.length;rt++){const it=_e(et[rt]);if(it)return it}return null}_invokeAll(_e){const et=Object.values(this.plugins);et.unshift(this);const rt=[];for(let it=0;it<et.length;it++){const st=_e(et[it]);st&&rt.push(st)}return rt}getDependency(_e,et){const rt=_e+":"+et;let it=this.cache.get(rt);if(!it){switch(_e){case"scene":it=this.loadScene(et);break;case"node":it=this._invokeOne(function(st){return st.loadNode&&st.loadNode(et)});break;case"mesh":it=this._invokeOne(function(st){return st.loadMesh&&st.loadMesh(et)});break;case"accessor":it=this.loadAccessor(et);break;case"bufferView":it=this._invokeOne(function(st){return st.loadBufferView&&st.loadBufferView(et)});break;case"buffer":it=this.loadBuffer(et);break;case"material":it=this._invokeOne(function(st){return st.loadMaterial&&st.loadMaterial(et)});break;case"texture":it=this._invokeOne(function(st){return st.loadTexture&&st.loadTexture(et)});break;case"skin":it=this.loadSkin(et);break;case"animation":it=this._invokeOne(function(st){return st.loadAnimation&&st.loadAnimation(et)});break;case"camera":it=this.loadCamera(et);break;default:if(it=this._invokeOne(function(st){return st!=this&&st.getDependency&&st.getDependency(_e,et)}),!it)throw new Error("Unknown type: "+_e);break}this.cache.add(rt,it)}return it}getDependencies(_e){let et=this.cache.get(_e);if(!et){const rt=this,it=this.json[_e+(_e==="mesh"?"es":"s")]||[];et=Promise.all(it.map(function(st,ot){return rt.getDependency(_e,ot)})),this.cache.add(_e,et)}return et}loadBuffer(_e){const et=this.json.buffers[_e],rt=this.fileLoader;if(et.type&&et.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+et.type+" buffer type is not supported.");if(et.uri===void 0&&_e===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const it=this.options;return new Promise(function(st,ot){rt.load(LoaderUtils.resolveURL(et.uri,it.path),st,void 0,function(){ot(new Error('THREE.GLTFLoader: Failed to load buffer "'+et.uri+'".'))})})}loadBufferView(_e){const et=this.json.bufferViews[_e];return this.getDependency("buffer",et.buffer).then(function(rt){const it=et.byteLength||0,st=et.byteOffset||0;return rt.slice(st,st+it)})}loadAccessor(_e){const et=this,rt=this.json,it=this.json.accessors[_e];if(it.bufferView===void 0&&it.sparse===void 0){const ot=WEBGL_TYPE_SIZES[it.type],at=WEBGL_COMPONENT_TYPES[it.componentType],lt=it.normalized===!0,ct=new at(it.count*ot);return Promise.resolve(new BufferAttribute$1(ct,ot,lt))}const st=[];return it.bufferView!==void 0?st.push(this.getDependency("bufferView",it.bufferView)):st.push(null),it.sparse!==void 0&&(st.push(this.getDependency("bufferView",it.sparse.indices.bufferView)),st.push(this.getDependency("bufferView",it.sparse.values.bufferView))),Promise.all(st).then(function(ot){const at=ot[0],lt=WEBGL_TYPE_SIZES[it.type],ct=WEBGL_COMPONENT_TYPES[it.componentType],ut=ct.BYTES_PER_ELEMENT,ht=ut*lt,dt=it.byteOffset||0,ft=it.bufferView!==void 0?rt.bufferViews[it.bufferView].byteStride:void 0,pt=it.normalized===!0;let mt,At;if(ft&&ft!==ht){const gt=Math.floor(dt/ft),bt="InterleavedBuffer:"+it.bufferView+":"+it.componentType+":"+gt+":"+it.count;let Tt=et.cache.get(bt);Tt||(mt=new ct(at,gt*ft,it.count*ft/ut),Tt=new InterleavedBuffer$1(mt,ft/ut),et.cache.add(bt,Tt)),At=new InterleavedBufferAttribute$1(Tt,lt,dt%ft/ut,pt)}else at===null?mt=new ct(it.count*lt):mt=new ct(at,dt,it.count*lt),At=new BufferAttribute$1(mt,lt,pt);if(it.sparse!==void 0){const gt=WEBGL_TYPE_SIZES.SCALAR,bt=WEBGL_COMPONENT_TYPES[it.sparse.indices.componentType],Tt=it.sparse.indices.byteOffset||0,wt=it.sparse.values.byteOffset||0,Rt=new bt(ot[1],Tt,it.sparse.count*gt),It=new ct(ot[2],wt,it.sparse.count*lt);at!==null&&(At=new BufferAttribute$1(At.array.slice(),At.itemSize,At.normalized));for(let Lt=0,$t=Rt.length;Lt<$t;Lt++){const kt=Rt[Lt];if(At.setX(kt,It[Lt*lt]),lt>=2&&At.setY(kt,It[Lt*lt+1]),lt>=3&&At.setZ(kt,It[Lt*lt+2]),lt>=4&&At.setW(kt,It[Lt*lt+3]),lt>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return At})}loadTexture(_e){const et=this.json,rt=this.options,st=et.textures[_e].source,ot=et.images[st];let at=this.textureLoader;if(ot.uri){const lt=rt.manager.getHandler(ot.uri);lt!==null&&(at=lt)}return this.loadTextureImage(_e,st,at)}loadTextureImage(_e,et,rt){const it=this,st=this.json,ot=st.textures[_e],at=st.images[et],lt=(at.uri||at.bufferView)+":"+ot.sampler;if(this.textureCache[lt])return this.textureCache[lt];const ct=this.loadImageSource(et,rt).then(function(ut){ut.flipY=!1,ut.name=ot.name||at.name||"",ut.name===""&&typeof at.uri=="string"&&at.uri.startsWith("data:image/")===!1&&(ut.name=at.uri);const dt=(st.samplers||{})[ot.sampler]||{};return ut.magFilter=WEBGL_FILTERS[dt.magFilter]||LinearFilter$1,ut.minFilter=WEBGL_FILTERS[dt.minFilter]||LinearMipmapLinearFilter$1,ut.wrapS=WEBGL_WRAPPINGS[dt.wrapS]||RepeatWrapping$1,ut.wrapT=WEBGL_WRAPPINGS[dt.wrapT]||RepeatWrapping$1,it.associations.set(ut,{textures:_e}),ut}).catch(function(){return null});return this.textureCache[lt]=ct,ct}loadImageSource(_e,et){const rt=this,it=this.json,st=this.options;if(this.sourceCache[_e]!==void 0)return this.sourceCache[_e].then(ht=>ht.clone());const ot=it.images[_e],at=self.URL||self.webkitURL;let lt=ot.uri||"",ct=!1;if(ot.bufferView!==void 0)lt=rt.getDependency("bufferView",ot.bufferView).then(function(ht){ct=!0;const dt=new Blob([ht],{type:ot.mimeType});return lt=at.createObjectURL(dt),lt});else if(ot.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");const ut=Promise.resolve(lt).then(function(ht){return new Promise(function(dt,ft){let pt=dt;et.isImageBitmapLoader===!0&&(pt=function(mt){const At=new Texture$1(mt);At.needsUpdate=!0,dt(At)}),et.load(LoaderUtils.resolveURL(ht,st.path),pt,void 0,ft)})}).then(function(ht){return ct===!0&&at.revokeObjectURL(lt),assignExtrasToUserData(ht,ot),ht.userData.mimeType=ot.mimeType||getImageURIMimeType(ot.uri),ht}).catch(function(ht){throw console.error("THREE.GLTFLoader: Couldn't load texture",lt),ht});return this.sourceCache[_e]=ut,ut}assignTexture(_e,et,rt,it){const st=this;return this.getDependency("texture",rt.index).then(function(ot){if(!ot)return null;if(rt.texCoord!==void 0&&rt.texCoord>0&&(ot=ot.clone(),ot.channel=rt.texCoord),st.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const at=rt.extensions!==void 0?rt.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(at){const lt=st.associations.get(ot);ot=st.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(ot,at),st.associations.set(ot,lt)}}return it!==void 0&&(typeof it=="number"&&(it=it===sRGBEncoding?SRGBColorSpace$1:LinearSRGBColorSpace$1),"colorSpace"in ot?ot.colorSpace=it:ot.encoding=it===SRGBColorSpace$1?sRGBEncoding:LinearEncoding),_e[et]=ot,ot})}assignFinalMaterial(_e){const et=_e.geometry;let rt=_e.material;const it=et.attributes.tangent===void 0,st=et.attributes.color!==void 0,ot=et.attributes.normal===void 0;if(_e.isPoints){const at="PointsMaterial:"+rt.uuid;let lt=this.cache.get(at);lt||(lt=new PointsMaterial$1,Material$1.prototype.copy.call(lt,rt),lt.color.copy(rt.color),lt.map=rt.map,lt.sizeAttenuation=!1,this.cache.add(at,lt)),rt=lt}else if(_e.isLine){const at="LineBasicMaterial:"+rt.uuid;let lt=this.cache.get(at);lt||(lt=new LineBasicMaterial$1,Material$1.prototype.copy.call(lt,rt),lt.color.copy(rt.color),lt.map=rt.map,this.cache.add(at,lt)),rt=lt}if(it||st||ot){let at="ClonedMaterial:"+rt.uuid+":";it&&(at+="derivative-tangents:"),st&&(at+="vertex-colors:"),ot&&(at+="flat-shading:");let lt=this.cache.get(at);lt||(lt=rt.clone(),st&&(lt.vertexColors=!0),ot&&(lt.flatShading=!0),it&&(lt.normalScale&&(lt.normalScale.y*=-1),lt.clearcoatNormalScale&&(lt.clearcoatNormalScale.y*=-1)),this.cache.add(at,lt),this.associations.set(lt,this.associations.get(rt))),rt=lt}_e.material=rt}getMaterialType(){return MeshStandardMaterial$1}loadMaterial(_e){const et=this,rt=this.json,it=this.extensions,st=rt.materials[_e];let ot;const at={},lt=st.extensions||{},ct=[];if(lt[EXTENSIONS.KHR_MATERIALS_UNLIT]){const ht=it[EXTENSIONS.KHR_MATERIALS_UNLIT];ot=ht.getMaterialType(),ct.push(ht.extendParams(at,st,et))}else{const ht=st.pbrMetallicRoughness||{};if(at.color=new Color$2(1,1,1),at.opacity=1,Array.isArray(ht.baseColorFactor)){const dt=ht.baseColorFactor;at.color.setRGB(dt[0],dt[1],dt[2],LinearSRGBColorSpace$1),at.opacity=dt[3]}ht.baseColorTexture!==void 0&&ct.push(et.assignTexture(at,"map",ht.baseColorTexture,SRGBColorSpace$1)),at.metalness=ht.metallicFactor!==void 0?ht.metallicFactor:1,at.roughness=ht.roughnessFactor!==void 0?ht.roughnessFactor:1,ht.metallicRoughnessTexture!==void 0&&(ct.push(et.assignTexture(at,"metalnessMap",ht.metallicRoughnessTexture)),ct.push(et.assignTexture(at,"roughnessMap",ht.metallicRoughnessTexture))),ot=this._invokeOne(function(dt){return dt.getMaterialType&&dt.getMaterialType(_e)}),ct.push(Promise.all(this._invokeAll(function(dt){return dt.extendMaterialParams&&dt.extendMaterialParams(_e,at)})))}st.doubleSided===!0&&(at.side=DoubleSide$1);const ut=st.alphaMode||ALPHA_MODES.OPAQUE;if(ut===ALPHA_MODES.BLEND?(at.transparent=!0,at.depthWrite=!1):(at.transparent=!1,ut===ALPHA_MODES.MASK&&(at.alphaTest=st.alphaCutoff!==void 0?st.alphaCutoff:.5)),st.normalTexture!==void 0&&ot!==MeshBasicMaterial$1&&(ct.push(et.assignTexture(at,"normalMap",st.normalTexture)),at.normalScale=new Vector2$1(1,1),st.normalTexture.scale!==void 0)){const ht=st.normalTexture.scale;at.normalScale.set(ht,ht)}if(st.occlusionTexture!==void 0&&ot!==MeshBasicMaterial$1&&(ct.push(et.assignTexture(at,"aoMap",st.occlusionTexture)),st.occlusionTexture.strength!==void 0&&(at.aoMapIntensity=st.occlusionTexture.strength)),st.emissiveFactor!==void 0&&ot!==MeshBasicMaterial$1){const ht=st.emissiveFactor;at.emissive=new Color$2().setRGB(ht[0],ht[1],ht[2],LinearSRGBColorSpace$1)}return st.emissiveTexture!==void 0&&ot!==MeshBasicMaterial$1&&ct.push(et.assignTexture(at,"emissiveMap",st.emissiveTexture,SRGBColorSpace$1)),Promise.all(ct).then(function(){const ht=new ot(at);return st.name&&(ht.name=st.name),assignExtrasToUserData(ht,st),et.associations.set(ht,{materials:_e}),st.extensions&&addUnknownExtensionsToUserData(it,ht,st),ht})}createUniqueName(_e){const et=PropertyBinding.sanitizeNodeName(_e||"");return et in this.nodeNamesUsed?et+"_"+ ++this.nodeNamesUsed[et]:(this.nodeNamesUsed[et]=0,et)}loadGeometries(_e){const et=this,rt=this.extensions,it=this.primitiveCache;function st(at){return rt[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(at,et).then(function(lt){return addPrimitiveAttributes(lt,at,et)})}const ot=[];for(let at=0,lt=_e.length;at<lt;at++){const ct=_e[at],ut=createPrimitiveKey(ct),ht=it[ut];if(ht)ot.push(ht.promise);else{let dt;ct.extensions&&ct.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?dt=st(ct):dt=addPrimitiveAttributes(new BufferGeometry$1,ct,et),it[ut]={primitive:ct,promise:dt},ot.push(dt)}}return Promise.all(ot)}loadMesh(_e){const et=this,rt=this.json,it=this.extensions,st=rt.meshes[_e],ot=st.primitives,at=[];for(let lt=0,ct=ot.length;lt<ct;lt++){const ut=ot[lt].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",ot[lt].material);at.push(ut)}return at.push(et.loadGeometries(ot)),Promise.all(at).then(function(lt){const ct=lt.slice(0,lt.length-1),ut=lt[lt.length-1],ht=[];for(let ft=0,pt=ut.length;ft<pt;ft++){const mt=ut[ft],At=ot[ft];let gt;const bt=ct[ft];if(At.mode===WEBGL_CONSTANTS.TRIANGLES||At.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||At.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||At.mode===void 0)gt=st.isSkinnedMesh===!0?new SkinnedMesh(mt,bt):new Mesh$1(mt,bt),gt.isSkinnedMesh===!0&&gt.normalizeSkinWeights(),At.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?gt.geometry=toTrianglesDrawMode$1(gt.geometry,TriangleStripDrawMode):At.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(gt.geometry=toTrianglesDrawMode$1(gt.geometry,TriangleFanDrawMode));else if(At.mode===WEBGL_CONSTANTS.LINES)gt=new LineSegments(mt,bt);else if(At.mode===WEBGL_CONSTANTS.LINE_STRIP)gt=new Line(mt,bt);else if(At.mode===WEBGL_CONSTANTS.LINE_LOOP)gt=new LineLoop(mt,bt);else if(At.mode===WEBGL_CONSTANTS.POINTS)gt=new Points(mt,bt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+At.mode);Object.keys(gt.geometry.morphAttributes).length>0&&updateMorphTargets(gt,st),gt.name=et.createUniqueName(st.name||"mesh_"+_e),assignExtrasToUserData(gt,st),At.extensions&&addUnknownExtensionsToUserData(it,gt,At),et.assignFinalMaterial(gt),ht.push(gt)}for(let ft=0,pt=ht.length;ft<pt;ft++)et.associations.set(ht[ft],{meshes:_e,primitives:ft});if(ht.length===1)return st.extensions&&addUnknownExtensionsToUserData(it,ht[0],st),ht[0];const dt=new Group$1;st.extensions&&addUnknownExtensionsToUserData(it,dt,st),et.associations.set(dt,{meshes:_e});for(let ft=0,pt=ht.length;ft<pt;ft++)dt.add(ht[ft]);return dt})}loadCamera(_e){let et;const rt=this.json.cameras[_e],it=rt[rt.type];if(!it){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return rt.type==="perspective"?et=new PerspectiveCamera$2(MathUtils$1.radToDeg(it.yfov),it.aspectRatio||1,it.znear||1,it.zfar||2e6):rt.type==="orthographic"&&(et=new OrthographicCamera$1(-it.xmag,it.xmag,it.ymag,-it.ymag,it.znear,it.zfar)),rt.name&&(et.name=this.createUniqueName(rt.name)),assignExtrasToUserData(et,rt),Promise.resolve(et)}loadSkin(_e){const et=this.json.skins[_e],rt=[];for(let it=0,st=et.joints.length;it<st;it++)rt.push(this._loadNodeShallow(et.joints[it]));return et.inverseBindMatrices!==void 0?rt.push(this.getDependency("accessor",et.inverseBindMatrices)):rt.push(null),Promise.all(rt).then(function(it){const st=it.pop(),ot=it,at=[],lt=[];for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];if(ht){at.push(ht);const dt=new Matrix4$1;st!==null&&dt.fromArray(st.array,ct*16),lt.push(dt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',et.joints[ct])}return new Skeleton(at,lt)})}loadAnimation(_e){const et=this.json,rt=this,it=et.animations[_e],st=it.name?it.name:"animation_"+_e,ot=[],at=[],lt=[],ct=[],ut=[];for(let ht=0,dt=it.channels.length;ht<dt;ht++){const ft=it.channels[ht],pt=it.samplers[ft.sampler],mt=ft.target,At=mt.node,gt=it.parameters!==void 0?it.parameters[pt.input]:pt.input,bt=it.parameters!==void 0?it.parameters[pt.output]:pt.output;mt.node!==void 0&&(ot.push(this.getDependency("node",At)),at.push(this.getDependency("accessor",gt)),lt.push(this.getDependency("accessor",bt)),ct.push(pt),ut.push(mt))}return Promise.all([Promise.all(ot),Promise.all(at),Promise.all(lt),Promise.all(ct),Promise.all(ut)]).then(function(ht){const dt=ht[0],ft=ht[1],pt=ht[2],mt=ht[3],At=ht[4],gt=[];for(let bt=0,Tt=dt.length;bt<Tt;bt++){const wt=dt[bt],Rt=ft[bt],It=pt[bt],Lt=mt[bt],$t=At[bt];if(wt===void 0)continue;wt.updateMatrix&&wt.updateMatrix();const kt=rt._createAnimationTracks(wt,Rt,It,Lt,$t);if(kt)for(let Dt=0;Dt<kt.length;Dt++)gt.push(kt[Dt])}return new AnimationClip(st,void 0,gt)})}createNodeMesh(_e){const et=this.json,rt=this,it=et.nodes[_e];return it.mesh===void 0?null:rt.getDependency("mesh",it.mesh).then(function(st){const ot=rt._getNodeRef(rt.meshCache,it.mesh,st);return it.weights!==void 0&&ot.traverse(function(at){if(at.isMesh)for(let lt=0,ct=it.weights.length;lt<ct;lt++)at.morphTargetInfluences[lt]=it.weights[lt]}),ot})}loadNode(_e){const et=this.json,rt=this,it=et.nodes[_e],st=rt._loadNodeShallow(_e),ot=[],at=it.children||[];for(let ct=0,ut=at.length;ct<ut;ct++)ot.push(rt.getDependency("node",at[ct]));const lt=it.skin===void 0?Promise.resolve(null):rt.getDependency("skin",it.skin);return Promise.all([st,Promise.all(ot),lt]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];dt!==null&&ut.traverse(function(ft){ft.isSkinnedMesh&&ft.bind(dt,_identityMatrix)});for(let ft=0,pt=ht.length;ft<pt;ft++)ut.add(ht[ft]);return ut})}_loadNodeShallow(_e){const et=this.json,rt=this.extensions,it=this;if(this.nodeCache[_e]!==void 0)return this.nodeCache[_e];const st=et.nodes[_e],ot=st.name?it.createUniqueName(st.name):"",at=[],lt=it._invokeOne(function(ct){return ct.createNodeMesh&&ct.createNodeMesh(_e)});return lt&&at.push(lt),st.camera!==void 0&&at.push(it.getDependency("camera",st.camera).then(function(ct){return it._getNodeRef(it.cameraCache,st.camera,ct)})),it._invokeAll(function(ct){return ct.createNodeAttachment&&ct.createNodeAttachment(_e)}).forEach(function(ct){at.push(ct)}),this.nodeCache[_e]=Promise.all(at).then(function(ct){let ut;if(st.isBone===!0?ut=new Bone:ct.length>1?ut=new Group$1:ct.length===1?ut=ct[0]:ut=new Object3D$1,ut!==ct[0])for(let ht=0,dt=ct.length;ht<dt;ht++)ut.add(ct[ht]);if(st.name&&(ut.userData.name=st.name,ut.name=ot),assignExtrasToUserData(ut,st),st.extensions&&addUnknownExtensionsToUserData(rt,ut,st),st.matrix!==void 0){const ht=new Matrix4$1;ht.fromArray(st.matrix),ut.applyMatrix4(ht)}else st.translation!==void 0&&ut.position.fromArray(st.translation),st.rotation!==void 0&&ut.quaternion.fromArray(st.rotation),st.scale!==void 0&&ut.scale.fromArray(st.scale);return it.associations.has(ut)||it.associations.set(ut,{}),it.associations.get(ut).nodes=_e,ut}),this.nodeCache[_e]}loadScene(_e){const et=this.extensions,rt=this.json.scenes[_e],it=this,st=new Group$1;rt.name&&(st.name=it.createUniqueName(rt.name)),assignExtrasToUserData(st,rt),rt.extensions&&addUnknownExtensionsToUserData(et,st,rt);const ot=rt.nodes||[],at=[];for(let lt=0,ct=ot.length;lt<ct;lt++)at.push(it.getDependency("node",ot[lt]));return Promise.all(at).then(function(lt){for(let ut=0,ht=lt.length;ut<ht;ut++)st.add(lt[ut]);const ct=ut=>{const ht=new Map;for(const[dt,ft]of it.associations)(dt instanceof Material$1||dt instanceof Texture$1)&&ht.set(dt,ft);return ut.traverse(dt=>{const ft=it.associations.get(dt);ft!=null&&ht.set(dt,ft)}),ht};return it.associations=ct(st),st})}_createAnimationTracks(_e,et,rt,it,st){const ot=[],at=_e.name?_e.name:_e.uuid,lt=[];PATH_PROPERTIES[st.path]===PATH_PROPERTIES.weights?_e.traverse(function(dt){dt.morphTargetInfluences&&lt.push(dt.name?dt.name:dt.uuid)}):lt.push(at);let ct;switch(PATH_PROPERTIES[st.path]){case PATH_PROPERTIES.weights:ct=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:ct=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:ct=VectorKeyframeTrack;break;default:switch(rt.itemSize){case 1:ct=NumberKeyframeTrack;break;case 2:case 3:default:ct=VectorKeyframeTrack;break}break}const ut=it.interpolation!==void 0?INTERPOLATION[it.interpolation]:InterpolateLinear,ht=this._getArrayFromAccessor(rt);for(let dt=0,ft=lt.length;dt<ft;dt++){const pt=new ct(lt[dt]+"."+PATH_PROPERTIES[st.path],et.array,ht,ut);it.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(pt),ot.push(pt)}return ot}_getArrayFromAccessor(_e){let et=_e.array;if(_e.normalized){const rt=getNormalizedComponentScale(et.constructor),it=new Float32Array(et.length);for(let st=0,ot=et.length;st<ot;st++)it[st]=et[st]*rt;et=it}return et}_createCubicSplineTrackInterpolant(_e){_e.createInterpolant=function(rt){const it=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new it(this.times,this.values,this.getValueSize()/3,rt)},_e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(nt,_e,et){const rt=_e.attributes,it=new Box3$1;if(rt.POSITION!==void 0){const at=et.json.accessors[rt.POSITION],lt=at.min,ct=at.max;if(lt!==void 0&&ct!==void 0){if(it.set(new Vector3$1(lt[0],lt[1],lt[2]),new Vector3$1(ct[0],ct[1],ct[2])),at.normalized){const ut=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[at.componentType]);it.min.multiplyScalar(ut),it.max.multiplyScalar(ut)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const st=_e.targets;if(st!==void 0){const at=new Vector3$1,lt=new Vector3$1;for(let ct=0,ut=st.length;ct<ut;ct++){const ht=st[ct];if(ht.POSITION!==void 0){const dt=et.json.accessors[ht.POSITION],ft=dt.min,pt=dt.max;if(ft!==void 0&&pt!==void 0){if(lt.setX(Math.max(Math.abs(ft[0]),Math.abs(pt[0]))),lt.setY(Math.max(Math.abs(ft[1]),Math.abs(pt[1]))),lt.setZ(Math.max(Math.abs(ft[2]),Math.abs(pt[2]))),dt.normalized){const mt=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[dt.componentType]);lt.multiplyScalar(mt)}at.max(lt)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}it.expandByVector(at)}nt.boundingBox=it;const ot=new Sphere$1;it.getCenter(ot.center),ot.radius=it.min.distanceTo(it.max)/2,nt.boundingSphere=ot}function addPrimitiveAttributes(nt,_e,et){const rt=_e.attributes,it=[];function st(ot,at){return et.getDependency("accessor",ot).then(function(lt){nt.setAttribute(at,lt)})}for(const ot in rt){const at=ATTRIBUTES[ot]||ot.toLowerCase();at in nt.attributes||it.push(st(rt[ot],at))}if(_e.indices!==void 0&&!nt.index){const ot=et.getDependency("accessor",_e.indices).then(function(at){nt.setIndex(at)});it.push(ot)}return assignExtrasToUserData(nt,_e),computeBounds(nt,_e,et),Promise.all(it).then(function(){return _e.targets!==void 0?addMorphTargets(nt,_e.targets,et):nt})}const _taskCache=new WeakMap;class DRACOLoader extends Loader{constructor(_e){super(_e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(_e){return this.decoderPath=_e,this}setDecoderConfig(_e){return this.decoderConfig=_e,this}setWorkerLimit(_e){return this.workerLimit=_e,this}load(_e,et,rt,it){const st=new FileLoader(this.manager);st.setPath(this.path),st.setResponseType("arraybuffer"),st.setRequestHeader(this.requestHeader),st.setWithCredentials(this.withCredentials),st.load(_e,ot=>{const at={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(ot,at).then(et).catch(it)},rt,it)}decodeDracoFile(_e,et,rt,it){const st={attributeIDs:rt||this.defaultAttributeIDs,attributeTypes:it||this.defaultAttributeTypes,useUniqueIDs:!!rt};this.decodeGeometry(_e,st).then(et)}decodeGeometry(_e,et){for(const lt in et.attributeTypes){const ct=et.attributeTypes[lt];ct.BYTES_PER_ELEMENT!==void 0&&(et.attributeTypes[lt]=ct.name)}const rt=JSON.stringify(et);if(_taskCache.has(_e)){const lt=_taskCache.get(_e);if(lt.key===rt)return lt.promise;if(_e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let it;const st=this.workerNextTaskID++,ot=_e.byteLength,at=this._getWorker(st,ot).then(lt=>(it=lt,new Promise((ct,ut)=>{it._callbacks[st]={resolve:ct,reject:ut},it.postMessage({type:"decode",id:st,taskConfig:et,buffer:_e},[_e])}))).then(lt=>this._createGeometry(lt.geometry));return at.catch(()=>!0).then(()=>{it&&st&&this._releaseTask(it,st)}),_taskCache.set(_e,{key:rt,promise:at}),at}_createGeometry(_e){const et=new BufferGeometry$1;_e.index&&et.setIndex(new BufferAttribute$1(_e.index.array,1));for(let rt=0;rt<_e.attributes.length;rt++){const it=_e.attributes[rt],st=it.name,ot=it.array,at=it.itemSize;et.setAttribute(st,new BufferAttribute$1(ot,at))}return et}_loadLibrary(_e,et){const rt=new FileLoader(this.manager);return rt.setPath(this.decoderPath),rt.setResponseType(et),rt.setWithCredentials(this.withCredentials),new Promise((it,st)=>{rt.load(_e,it,void 0,st)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const _e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",et=[];return _e?et.push(this._loadLibrary("draco_decoder.js","text")):(et.push(this._loadLibrary("draco_wasm_wrapper.js","text")),et.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(et).then(rt=>{const it=rt[0];_e||(this.decoderConfig.wasmBinary=rt[1]);const st=DRACOWorker.toString(),ot=["/* draco decoder */",it,"","/* worker */",st.substring(st.indexOf("{")+1,st.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([ot]))}),this.decoderPending}_getWorker(_e,et){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const it=new Worker(this.workerSourceURL);it._callbacks={},it._taskCosts={},it._taskLoad=0,it.postMessage({type:"init",decoderConfig:this.decoderConfig}),it.onmessage=function(st){const ot=st.data;switch(ot.type){case"decode":it._callbacks[ot.id].resolve(ot);break;case"error":it._callbacks[ot.id].reject(ot);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+ot.type+'"')}},this.workerPool.push(it)}else this.workerPool.sort(function(it,st){return it._taskLoad>st._taskLoad?-1:1});const rt=this.workerPool[this.workerPool.length-1];return rt._taskCosts[_e]=et,rt._taskLoad+=et,rt})}_releaseTask(_e,et){_e._taskLoad-=_e._taskCosts[et],delete _e._callbacks[et],delete _e._taskCosts[et]}debug(){console.log("Task load: ",this.workerPool.map(_e=>_e._taskLoad))}dispose(){for(let _e=0;_e<this.workerPool.length;++_e)this.workerPool[_e].terminate();return this.workerPool.length=0,this}}function DRACOWorker(){let nt,_e;onmessage=function(ot){const at=ot.data;switch(at.type){case"init":nt=at.decoderConfig,_e=new Promise(function(ut){nt.onModuleLoaded=function(ht){ut({draco:ht})},DracoDecoderModule(nt)});break;case"decode":const lt=at.buffer,ct=at.taskConfig;_e.then(ut=>{const ht=ut.draco,dt=new ht.Decoder,ft=new ht.DecoderBuffer;ft.Init(new Int8Array(lt),lt.byteLength);try{const pt=et(ht,dt,ft,ct),mt=pt.attributes.map(At=>At.array.buffer);pt.index&&mt.push(pt.index.array.buffer),self.postMessage({type:"decode",id:at.id,geometry:pt},mt)}catch(pt){console.error(pt),self.postMessage({type:"error",id:at.id,error:pt.message})}finally{ht.destroy(ft),ht.destroy(dt)}});break}};function et(ot,at,lt,ct){const ut=ct.attributeIDs,ht=ct.attributeTypes;let dt,ft;const pt=at.GetEncodedGeometryType(lt);if(pt===ot.TRIANGULAR_MESH)dt=new ot.Mesh,ft=at.DecodeBufferToMesh(lt,dt);else if(pt===ot.POINT_CLOUD)dt=new ot.PointCloud,ft=at.DecodeBufferToPointCloud(lt,dt);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!ft.ok()||dt.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+ft.error_msg());const mt={index:null,attributes:[]};for(const At in ut){const gt=self[ht[At]];let bt,Tt;if(ct.useUniqueIDs)Tt=ut[At],bt=at.GetAttributeByUniqueId(dt,Tt);else{if(Tt=at.GetAttributeId(dt,ot[ut[At]]),Tt===-1)continue;bt=at.GetAttribute(dt,Tt)}mt.attributes.push(it(ot,at,dt,At,gt,bt))}return pt===ot.TRIANGULAR_MESH&&(mt.index=rt(ot,at,dt)),ot.destroy(dt),mt}function rt(ot,at,lt){const ut=lt.num_faces()*3,ht=ut*4,dt=ot._malloc(ht);at.GetTrianglesUInt32Array(lt,ht,dt);const ft=new Uint32Array(ot.HEAPF32.buffer,dt,ut).slice();return ot._free(dt),{array:ft,itemSize:1}}function it(ot,at,lt,ct,ut,ht){const dt=ht.num_components(),pt=lt.num_points()*dt,mt=pt*ut.BYTES_PER_ELEMENT,At=st(ot,ut),gt=ot._malloc(mt);at.GetAttributeDataArrayForAllPoints(lt,ht,At,mt,gt);const bt=new ut(ot.HEAPF32.buffer,gt,pt).slice();return ot._free(gt),{name:ct,array:bt,itemSize:dt}}function st(ot,at){switch(at){case Float32Array:return ot.DT_FLOAT32;case Int8Array:return ot.DT_INT8;case Int16Array:return ot.DT_INT16;case Int32Array:return ot.DT_INT32;case Uint8Array:return ot.DT_UINT8;case Uint16Array:return ot.DT_UINT16;case Uint32Array:return ot.DT_UINT32}}}let generated;const MeshoptDecoder=()=>{if(generated)return generated;const nt="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",_e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",et=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),rt=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let it=nt;WebAssembly.validate(et)&&(it=_e);let st;const ot=WebAssembly.instantiate(at(it),{}).then(ht=>{st=ht.instance,st.exports.__wasm_call_ctors()});function at(ht){const dt=new Uint8Array(ht.length);for(let pt=0;pt<ht.length;++pt){const mt=ht.charCodeAt(pt);dt[pt]=mt>96?mt-71:mt>64?mt-65:mt>47?mt+4:mt>46?63:62}let ft=0;for(let pt=0;pt<ht.length;++pt)dt[ft++]=dt[pt]<60?rt[dt[pt]]:(dt[pt]-60)*64+dt[++pt];return dt.buffer.slice(0,ft)}function lt(ht,dt,ft,pt,mt,At){const gt=st.exports.sbrk,bt=ft+3&-4,Tt=gt(bt*pt),wt=gt(mt.length),Rt=new Uint8Array(st.exports.memory.buffer);Rt.set(mt,wt);const It=ht(Tt,ft,pt,wt,mt.length);if(It===0&&At&&At(Tt,bt,pt),dt.set(Rt.subarray(Tt,Tt+ft*pt)),gt(Tt-gt(0)),It!==0)throw new Error(`Malformed buffer data: ${It}`)}const ct={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ut={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return generated={ready:ot,supported:!0,decodeVertexBuffer(ht,dt,ft,pt,mt){lt(st.exports.meshopt_decodeVertexBuffer,ht,dt,ft,pt,st.exports[ct[mt]])},decodeIndexBuffer(ht,dt,ft,pt){lt(st.exports.meshopt_decodeIndexBuffer,ht,dt,ft,pt)},decodeIndexSequence(ht,dt,ft,pt){lt(st.exports.meshopt_decodeIndexSequence,ht,dt,ft,pt)},decodeGltfBuffer(ht,dt,ft,pt,mt,At){lt(st.exports[ut[mt]],ht,dt,ft,pt,st.exports[ct[At]])}},generated};function workerBootstrap(){var nt=Object.create(null);function _e(it,st){var ot=it.id,at=it.name,lt=it.dependencies;lt===void 0&&(lt=[]);var ct=it.init;ct===void 0&&(ct=function(){});var ut=it.getTransferables;if(ut===void 0&&(ut=null),!nt[ot])try{lt=lt.map(function(dt){return dt&&dt.isWorkerModule&&(_e(dt,function(ft){if(ft instanceof Error)throw ft}),dt=nt[dt.id].value),dt}),ct=rt("<"+at+">.init",ct),ut&&(ut=rt("<"+at+">.getTransferables",ut));var ht=null;typeof ct=="function"?ht=ct.apply(void 0,lt):console.error("worker module init function failed to rehydrate"),nt[ot]={id:ot,value:ht,getTransferables:ut},st(ht)}catch(dt){dt&&dt.noLog||console.error(dt),st(dt)}}function et(it,st){var ot,at=it.id,lt=it.args;(!nt[at]||typeof nt[at].value!="function")&&st(new Error("Worker module "+at+": not found or its 'init' did not return a function"));try{var ct=(ot=nt[at]).value.apply(ot,lt);ct&&typeof ct.then=="function"?ct.then(ut,function(ht){return st(ht instanceof Error?ht:new Error(""+ht))}):ut(ct)}catch(ht){st(ht)}function ut(ht){try{var dt=nt[at].getTransferables&&nt[at].getTransferables(ht);(!dt||!Array.isArray(dt)||!dt.length)&&(dt=void 0),st(ht,dt)}catch(ft){console.error(ft),st(ft)}}}function rt(it,st){var ot=void 0;self.troikaDefine=function(lt){return ot=lt};var at=URL.createObjectURL(new Blob(["/** "+it.replace(/\*/g,"")+` **/

troikaDefine(
`+st+`
)`],{type:"application/javascript"}));try{importScripts(at)}catch(lt){console.error(lt)}return URL.revokeObjectURL(at),delete self.troikaDefine,ot}self.addEventListener("message",function(it){var st=it.data,ot=st.messageId,at=st.action,lt=st.data;try{at==="registerModule"&&_e(lt,function(ct){ct instanceof Error?postMessage({messageId:ot,success:!1,error:ct.message}):postMessage({messageId:ot,success:!0,result:{isCallable:typeof ct=="function"}})}),at==="callModule"&&et(lt,function(ct,ut){ct instanceof Error?postMessage({messageId:ot,success:!1,error:ct.message}):postMessage({messageId:ot,success:!0,result:ct},ut||void 0)})}catch(ct){postMessage({messageId:ot,success:!1,error:ct.stack})}})}function defineMainThreadModule(nt){var _e=function(){for(var et=[],rt=arguments.length;rt--;)et[rt]=arguments[rt];return _e._getInitResult().then(function(it){if(typeof it=="function")return it.apply(void 0,et);throw new Error("Worker module function was called but `init` did not return a callable function")})};return _e._getInitResult=function(){var et=nt.dependencies,rt=nt.init;et=Array.isArray(et)?et.map(function(st){return st&&st._getInitResult?st._getInitResult():st}):[];var it=Promise.all(et).then(function(st){return rt.apply(null,st)});return _e._getInitResult=function(){return it},it},_e}var supportsWorkers=function(){var nt=!1;if(typeof window<"u"&&typeof window.document<"u")try{var _e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));_e.terminate(),nt=!0}catch(et){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+et.message+"]")}return supportsWorkers=function(){return nt},nt},_workerModuleId=0,_messageId=0,_allowInitAsString=!1,workers=Object.create(null),registeredModules=Object.create(null),openRequests=Object.create(null);function defineWorkerModule(nt){if((!nt||typeof nt.init!="function")&&!_allowInitAsString)throw new Error("requires `options.init` function");var _e=nt.dependencies,et=nt.init,rt=nt.getTransferables,it=nt.workerId;if(!supportsWorkers())return defineMainThreadModule(nt);it==null&&(it="#default");var st="workerModule"+ ++_workerModuleId,ot=nt.name||st,at=null;_e=_e&&_e.map(function(ct){return typeof ct=="function"&&!ct.workerModuleData&&(_allowInitAsString=!0,ct=defineWorkerModule({workerId:it,name:"<"+ot+"> function dependency: "+ct.name,init:`function(){return (
`+stringifyFunction(ct)+`
)}`}),_allowInitAsString=!1),ct&&ct.workerModuleData&&(ct=ct.workerModuleData),ct});function lt(){for(var ct=[],ut=arguments.length;ut--;)ct[ut]=arguments[ut];if(!at){at=callWorker(it,"registerModule",lt.workerModuleData);var ht=function(){at=null,registeredModules[it].delete(ht)};(registeredModules[it]||(registeredModules[it]=new Set)).add(ht)}return at.then(function(dt){var ft=dt.isCallable;if(ft)return callWorker(it,"callModule",{id:st,args:ct});throw new Error("Worker module function was called but `init` did not return a callable function")})}return lt.workerModuleData={isWorkerModule:!0,id:st,name:ot,dependencies:_e,init:stringifyFunction(et),getTransferables:rt&&stringifyFunction(rt)},lt}function terminateWorker(nt){registeredModules[nt]&&registeredModules[nt].forEach(function(_e){_e()}),workers[nt]&&(workers[nt].terminate(),delete workers[nt])}function stringifyFunction(nt){var _e=nt.toString();return!/^function/.test(_e)&&/^\w+\s*\(/.test(_e)&&(_e="function "+_e),_e}function getWorker(nt){var _e=workers[nt];if(!_e){var et=stringifyFunction(workerBootstrap);_e=workers[nt]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+nt.replace(/\*/g,"")+` **/

;(`+et+")()"],{type:"application/javascript"}))),_e.onmessage=function(rt){var it=rt.data,st=it.messageId,ot=openRequests[st];if(!ot)throw new Error("WorkerModule response with empty or unknown messageId");delete openRequests[st],ot(it)}}return _e}function callWorker(nt,_e,et){return new Promise(function(rt,it){var st=++_messageId;openRequests[st]=function(ot){ot.success?rt(ot.result):it(new Error("Error in worker "+_e+" call: "+ot.error))},getWorker(nt).postMessage({messageId:st,action:_e,data:et})})}function SDFGenerator(){var nt=function(_e){function et(jt,Kt,Jt,sn,hn,an,pn,_n){var yn=1-pn;_n.x=yn*yn*jt+2*yn*pn*Jt+pn*pn*hn,_n.y=yn*yn*Kt+2*yn*pn*sn+pn*pn*an}function rt(jt,Kt,Jt,sn,hn,an,pn,_n,yn,$n){var Jn=1-yn;$n.x=Jn*Jn*Jn*jt+3*Jn*Jn*yn*Jt+3*Jn*yn*yn*hn+yn*yn*yn*pn,$n.y=Jn*Jn*Jn*Kt+3*Jn*Jn*yn*sn+3*Jn*yn*yn*an+yn*yn*yn*_n}function it(jt,Kt){for(var Jt=/([MLQCZ])([^MLQCZ]*)/g,sn,hn,an,pn,_n;sn=Jt.exec(jt);){var yn=sn[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function($n){return parseFloat($n)});switch(sn[1]){case"M":pn=hn=yn[0],_n=an=yn[1];break;case"L":(yn[0]!==pn||yn[1]!==_n)&&Kt("L",pn,_n,pn=yn[0],_n=yn[1]);break;case"Q":{Kt("Q",pn,_n,pn=yn[2],_n=yn[3],yn[0],yn[1]);break}case"C":{Kt("C",pn,_n,pn=yn[4],_n=yn[5],yn[0],yn[1],yn[2],yn[3]);break}case"Z":(pn!==hn||_n!==an)&&Kt("L",pn,_n,hn,an);break}}}function st(jt,Kt,Jt){Jt===void 0&&(Jt=16);var sn={x:0,y:0};it(jt,function(hn,an,pn,_n,yn,$n,Jn,Xn,Vn){switch(hn){case"L":Kt(an,pn,_n,yn);break;case"Q":{for(var En=an,dn=pn,rr=1;rr<Jt;rr++)et(an,pn,$n,Jn,_n,yn,rr/(Jt-1),sn),Kt(En,dn,sn.x,sn.y),En=sn.x,dn=sn.y;break}case"C":{for(var er=an,Yn=pn,ir=1;ir<Jt;ir++)rt(an,pn,$n,Jn,Xn,Vn,_n,yn,ir/(Jt-1),sn),Kt(er,Yn,sn.x,sn.y),er=sn.x,Yn=sn.y;break}}})}var ot="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",at="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",lt=new WeakMap,ct={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function ut(jt,Kt){var Jt=jt.getContext?jt.getContext("webgl",ct):jt,sn=lt.get(Jt);if(!sn){let er=function(en){var wn=an[en];if(!wn&&(wn=an[en]=Jt.getExtension(en),!wn))throw new Error(en+" not supported");return wn},Yn=function(en,wn){var gn=Jt.createShader(wn);return Jt.shaderSource(gn,en),Jt.compileShader(gn),gn},ir=function(en,wn,gn,Mn){if(!pn[en]){var In={},gr={},jn=Jt.createProgram();Jt.attachShader(jn,Yn(wn,Jt.VERTEX_SHADER)),Jt.attachShader(jn,Yn(gn,Jt.FRAGMENT_SHADER)),Jt.linkProgram(jn),pn[en]={program:jn,transaction:function(Tr){Jt.useProgram(jn),Tr({setUniform:function(yr,Rr){for(var br=[],pr=arguments.length-2;pr-- >0;)br[pr]=arguments[pr+2];var vn=gr[Rr]||(gr[Rr]=Jt.getUniformLocation(jn,Rr));Jt["uniform"+yr].apply(Jt,[vn].concat(br))},setAttribute:function(yr,Rr,br,pr,vn){var qn=In[yr];qn||(qn=In[yr]={buf:Jt.createBuffer(),loc:Jt.getAttribLocation(jn,yr),data:null}),Jt.bindBuffer(Jt.ARRAY_BUFFER,qn.buf),Jt.vertexAttribPointer(qn.loc,Rr,Jt.FLOAT,!1,0,0),Jt.enableVertexAttribArray(qn.loc),hn?Jt.vertexAttribDivisor(qn.loc,pr):er("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(qn.loc,pr),vn!==qn.data&&(Jt.bufferData(Jt.ARRAY_BUFFER,vn,br),qn.data=vn)}})}}}pn[en].transaction(Mn)},Qn=function(en,wn){yn++;try{Jt.activeTexture(Jt.TEXTURE0+yn);var gn=_n[en];gn||(gn=_n[en]=Jt.createTexture(),Jt.bindTexture(Jt.TEXTURE_2D,gn),Jt.texParameteri(Jt.TEXTURE_2D,Jt.TEXTURE_MIN_FILTER,Jt.NEAREST),Jt.texParameteri(Jt.TEXTURE_2D,Jt.TEXTURE_MAG_FILTER,Jt.NEAREST)),Jt.bindTexture(Jt.TEXTURE_2D,gn),wn(gn,yn)}finally{yn--}},sr=function(en,wn,gn){var Mn=Jt.createFramebuffer();$n.push(Mn),Jt.bindFramebuffer(Jt.FRAMEBUFFER,Mn),Jt.activeTexture(Jt.TEXTURE0+wn),Jt.bindTexture(Jt.TEXTURE_2D,en),Jt.framebufferTexture2D(Jt.FRAMEBUFFER,Jt.COLOR_ATTACHMENT0,Jt.TEXTURE_2D,en,0);try{gn(Mn)}finally{Jt.deleteFramebuffer(Mn),Jt.bindFramebuffer(Jt.FRAMEBUFFER,$n[--$n.length-1]||null)}},un=function(){an={},pn={},_n={},yn=-1,$n.length=0};var Jn=er,Xn=Yn,Vn=ir,En=Qn,dn=sr,rr=un,hn=typeof WebGL2RenderingContext<"u"&&Jt instanceof WebGL2RenderingContext,an={},pn={},_n={},yn=-1,$n=[];Jt.canvas.addEventListener("webglcontextlost",function(en){un(),en.preventDefault()},!1),lt.set(Jt,sn={gl:Jt,isWebGL2:hn,getExtension:er,withProgram:ir,withTexture:Qn,withTextureFramebuffer:sr,handleContextLoss:un})}Kt(sn)}function ht(jt,Kt,Jt,sn,hn,an,pn,_n){pn===void 0&&(pn=15),_n===void 0&&(_n=null),ut(jt,function(yn){var $n=yn.gl,Jn=yn.withProgram,Xn=yn.withTexture;Xn("copy",function(Vn,En){$n.texImage2D($n.TEXTURE_2D,0,$n.RGBA,hn,an,0,$n.RGBA,$n.UNSIGNED_BYTE,Kt),Jn("copy",ot,at,function(dn){var rr=dn.setUniform,er=dn.setAttribute;er("aUV",2,$n.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),rr("1i","image",En),$n.bindFramebuffer($n.FRAMEBUFFER,_n||null),$n.disable($n.BLEND),$n.colorMask(pn&8,pn&4,pn&2,pn&1),$n.viewport(Jt,sn,hn,an),$n.scissor(Jt,sn,hn,an),$n.drawArrays($n.TRIANGLES,0,3)})})})}function dt(jt,Kt,Jt){var sn=jt.width,hn=jt.height;ut(jt,function(an){var pn=an.gl,_n=new Uint8Array(sn*hn*4);pn.readPixels(0,0,sn,hn,pn.RGBA,pn.UNSIGNED_BYTE,_n),jt.width=Kt,jt.height=Jt,ht(pn,_n,0,0,sn,hn)})}var ft=Object.freeze({__proto__:null,withWebGLContext:ut,renderImageData:ht,resizeWebGLCanvasWithoutClearing:dt});function pt(jt,Kt,Jt,sn,hn,an){an===void 0&&(an=1);var pn=new Uint8Array(jt*Kt),_n=sn[2]-sn[0],yn=sn[3]-sn[1],$n=[];st(Jt,function(er,Yn,ir,Qn){$n.push({x1:er,y1:Yn,x2:ir,y2:Qn,minX:Math.min(er,ir),minY:Math.min(Yn,Qn),maxX:Math.max(er,ir),maxY:Math.max(Yn,Qn)})}),$n.sort(function(er,Yn){return er.maxX-Yn.maxX});for(var Jn=0;Jn<jt;Jn++)for(var Xn=0;Xn<Kt;Xn++){var Vn=dn(sn[0]+_n*(Jn+.5)/jt,sn[1]+yn*(Xn+.5)/Kt),En=Math.pow(1-Math.abs(Vn)/hn,an)/2;Vn<0&&(En=1-En),En=Math.max(0,Math.min(255,Math.round(En*255))),pn[Xn*jt+Jn]=En}return pn;function dn(er,Yn){for(var ir=1/0,Qn=1/0,sr=$n.length;sr--;){var un=$n[sr];if(un.maxX+Qn<=er)break;if(er+Qn>un.minX&&Yn-Qn<un.maxY&&Yn+Qn>un.minY){var en=gt(er,Yn,un.x1,un.y1,un.x2,un.y2);en<ir&&(ir=en,Qn=Math.sqrt(ir))}}return rr(er,Yn)&&(Qn=-Qn),Qn}function rr(er,Yn){for(var ir=0,Qn=$n.length;Qn--;){var sr=$n[Qn];if(sr.maxX<=er)break;var un=sr.y1>Yn!=sr.y2>Yn&&er<(sr.x2-sr.x1)*(Yn-sr.y1)/(sr.y2-sr.y1)+sr.x1;un&&(ir+=sr.y1<sr.y2?1:-1)}return ir!==0}}function mt(jt,Kt,Jt,sn,hn,an,pn,_n,yn,$n){an===void 0&&(an=1),_n===void 0&&(_n=0),yn===void 0&&(yn=0),$n===void 0&&($n=0),At(jt,Kt,Jt,sn,hn,an,pn,null,_n,yn,$n)}function At(jt,Kt,Jt,sn,hn,an,pn,_n,yn,$n,Jn){an===void 0&&(an=1),yn===void 0&&(yn=0),$n===void 0&&($n=0),Jn===void 0&&(Jn=0);for(var Xn=pt(jt,Kt,Jt,sn,hn,an),Vn=new Uint8Array(Xn.length*4),En=0;En<Xn.length;En++)Vn[En*4+Jn]=Xn[En];ht(pn,Vn,yn,$n,jt,Kt,1<<3-Jn,_n)}function gt(jt,Kt,Jt,sn,hn,an){var pn=hn-Jt,_n=an-sn,yn=pn*pn+_n*_n,$n=yn?Math.max(0,Math.min(1,((jt-Jt)*pn+(Kt-sn)*_n)/yn)):0,Jn=jt-(Jt+$n*pn),Xn=Kt-(sn+$n*_n);return Jn*Jn+Xn*Xn}var bt=Object.freeze({__proto__:null,generate:pt,generateIntoCanvas:mt,generateIntoFramebuffer:At}),Tt="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",wt="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",Rt="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",It=new Float32Array([0,0,2,0,0,2]),Lt=null,$t=!1,kt={},Dt=new WeakMap;function Ot(jt){if(!$t&&!Xt(jt))throw new Error("WebGL generation not supported")}function zt(jt,Kt,Jt,sn,hn,an,pn){if(an===void 0&&(an=1),pn===void 0&&(pn=null),!pn&&(pn=Lt,!pn)){var _n=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!_n)throw new Error("OffscreenCanvas or DOM canvas not supported");pn=Lt=_n.getContext("webgl",{depth:!1})}Ot(pn);var yn=new Uint8Array(jt*Kt*4);ut(pn,function(Vn){var En=Vn.gl,dn=Vn.withTexture,rr=Vn.withTextureFramebuffer;dn("readable",function(er,Yn){En.texImage2D(En.TEXTURE_2D,0,En.RGBA,jt,Kt,0,En.RGBA,En.UNSIGNED_BYTE,null),rr(er,Yn,function(ir){Yt(jt,Kt,Jt,sn,hn,an,En,ir,0,0,0),En.readPixels(0,0,jt,Kt,En.RGBA,En.UNSIGNED_BYTE,yn)})})});for(var $n=new Uint8Array(jt*Kt),Jn=0,Xn=0;Jn<yn.length;Jn+=4)$n[Xn++]=yn[Jn];return $n}function Ht(jt,Kt,Jt,sn,hn,an,pn,_n,yn,$n){an===void 0&&(an=1),_n===void 0&&(_n=0),yn===void 0&&(yn=0),$n===void 0&&($n=0),Yt(jt,Kt,Jt,sn,hn,an,pn,null,_n,yn,$n)}function Yt(jt,Kt,Jt,sn,hn,an,pn,_n,yn,$n,Jn){an===void 0&&(an=1),yn===void 0&&(yn=0),$n===void 0&&($n=0),Jn===void 0&&(Jn=0),Ot(pn);var Xn=[];st(Jt,function(Vn,En,dn,rr){Xn.push(Vn,En,dn,rr)}),Xn=new Float32Array(Xn),ut(pn,function(Vn){var En=Vn.gl,dn=Vn.isWebGL2,rr=Vn.getExtension,er=Vn.withProgram,Yn=Vn.withTexture,ir=Vn.withTextureFramebuffer,Qn=Vn.handleContextLoss;if(Yn("rawDistances",function(sr,un){(jt!==sr._lastWidth||Kt!==sr._lastHeight)&&En.texImage2D(En.TEXTURE_2D,0,En.RGBA,sr._lastWidth=jt,sr._lastHeight=Kt,0,En.RGBA,En.UNSIGNED_BYTE,null),er("main",Tt,wt,function(en){var wn=en.setAttribute,gn=en.setUniform,Mn=!dn&&rr("ANGLE_instanced_arrays"),In=!dn&&rr("EXT_blend_minmax");wn("aUV",2,En.STATIC_DRAW,0,It),wn("aLineSegment",4,En.DYNAMIC_DRAW,1,Xn),gn.apply(void 0,["4f","uGlyphBounds"].concat(sn)),gn("1f","uMaxDistance",hn),gn("1f","uExponent",an),ir(sr,un,function(gr){En.enable(En.BLEND),En.colorMask(!0,!0,!0,!0),En.viewport(0,0,jt,Kt),En.scissor(0,0,jt,Kt),En.blendFunc(En.ONE,En.ONE),En.blendEquationSeparate(En.FUNC_ADD,dn?En.MAX:In.MAX_EXT),En.clear(En.COLOR_BUFFER_BIT),dn?En.drawArraysInstanced(En.TRIANGLES,0,3,Xn.length/4):Mn.drawArraysInstancedANGLE(En.TRIANGLES,0,3,Xn.length/4)})}),er("post",ot,Rt,function(en){en.setAttribute("aUV",2,En.STATIC_DRAW,0,It),en.setUniform("1i","tex",un),En.bindFramebuffer(En.FRAMEBUFFER,_n),En.disable(En.BLEND),En.colorMask(Jn===0,Jn===1,Jn===2,Jn===3),En.viewport(yn,$n,jt,Kt),En.scissor(yn,$n,jt,Kt),En.drawArrays(En.TRIANGLES,0,3)})}),En.isContextLost())throw Qn(),new Error("webgl context lost")})}function Xt(jt){var Kt=!jt||jt===Lt?kt:jt.canvas||jt,Jt=Dt.get(Kt);if(Jt===void 0){$t=!0;var sn=null;try{var hn=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],an=zt(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,jt);Jt=an&&hn.length===an.length&&an.every(function(pn,_n){return pn===hn[_n]}),Jt||(sn="bad trial run results",console.info(hn,an))}catch(pn){Jt=!1,sn=pn.message}sn&&console.warn("WebGL SDF generation not supported:",sn),$t=!1,Dt.set(Kt,Jt)}return Jt}var Zt=Object.freeze({__proto__:null,generate:zt,generateIntoCanvas:Ht,generateIntoFramebuffer:Yt,isSupported:Xt});function rn(jt,Kt,Jt,sn,hn,an){hn===void 0&&(hn=Math.max(sn[2]-sn[0],sn[3]-sn[1])/2),an===void 0&&(an=1);try{return zt.apply(Zt,arguments)}catch(pn){return console.info("WebGL SDF generation failed, falling back to JS",pn),pt.apply(bt,arguments)}}function Gt(jt,Kt,Jt,sn,hn,an,pn,_n,yn,$n){hn===void 0&&(hn=Math.max(sn[2]-sn[0],sn[3]-sn[1])/2),an===void 0&&(an=1),_n===void 0&&(_n=0),yn===void 0&&(yn=0),$n===void 0&&($n=0);try{return Ht.apply(Zt,arguments)}catch(Jn){return console.info("WebGL SDF generation failed, falling back to JS",Jn),mt.apply(bt,arguments)}}return _e.forEachPathCommand=it,_e.generate=rn,_e.generateIntoCanvas=Gt,_e.javascript=bt,_e.pathToLineSegments=st,_e.webgl=Zt,_e.webglUtils=ft,Object.defineProperty(_e,"__esModule",{value:!0}),_e}({});return nt}function bidiFactory(){var nt=function(_e){var et={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},rt={},it={};rt.L=1,it[1]="L",Object.keys(et).forEach(function(Qn,sr){rt[Qn]=1<<sr+1,it[rt[Qn]]=Qn}),Object.freeze(rt);var st=rt.LRI|rt.RLI|rt.FSI,ot=rt.L|rt.R|rt.AL,at=rt.B|rt.S|rt.WS|rt.ON|rt.FSI|rt.LRI|rt.RLI|rt.PDI,lt=rt.BN|rt.RLE|rt.LRE|rt.RLO|rt.LRO|rt.PDF,ct=rt.S|rt.WS|rt.B|st|rt.PDI|lt,ut=null;function ht(){if(!ut){ut=new Map;var Qn=function(un){if(et.hasOwnProperty(un)){var en=0;et[un].split(",").forEach(function(wn){var gn=wn.split("+"),Mn=gn[0],In=gn[1];Mn=parseInt(Mn,36),In=In?parseInt(In,36):0,ut.set(en+=Mn,rt[un]);for(var gr=0;gr<In;gr++)ut.set(++en,rt[un])})}};for(var sr in et)Qn(sr)}}function dt(Qn){return ht(),ut.get(Qn.codePointAt(0))||rt.L}function ft(Qn){return it[dt(Qn)]}var pt={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function mt(Qn,sr){var un=36,en=0,wn=new Map,gn=sr&&new Map,Mn;return Qn.split(",").forEach(function In(gr){if(gr.indexOf("+")!==-1)for(var jn=+gr;jn--;)In(Mn);else{Mn=gr;var hr=gr.split(">"),Tr=hr[0],cr=hr[1];Tr=String.fromCodePoint(en+=parseInt(Tr,un)),cr=String.fromCodePoint(en+=parseInt(cr,un)),wn.set(Tr,cr),sr&&gn.set(cr,Tr)}}),{map:wn,reverseMap:gn}}var At,gt,bt;function Tt(){if(!At){var Qn=mt(pt.pairs,!0),sr=Qn.map,un=Qn.reverseMap;At=sr,gt=un,bt=mt(pt.canonical,!1).map}}function wt(Qn){return Tt(),At.get(Qn)||null}function Rt(Qn){return Tt(),gt.get(Qn)||null}function It(Qn){return Tt(),bt.get(Qn)||null}var Lt=rt.L,$t=rt.R,kt=rt.EN,Dt=rt.ES,Ot=rt.ET,zt=rt.AN,Ht=rt.CS,Yt=rt.B,Xt=rt.S,Zt=rt.ON,rn=rt.BN,Gt=rt.NSM,jt=rt.AL,Kt=rt.LRO,Jt=rt.RLO,sn=rt.LRE,hn=rt.RLE,an=rt.PDF,pn=rt.LRI,_n=rt.RLI,yn=rt.FSI,$n=rt.PDI;function Jn(Qn,sr){for(var un=125,en=new Uint32Array(Qn.length),wn=0;wn<Qn.length;wn++)en[wn]=dt(Qn[wn]);var gn=new Map;function Mn(Is,lo){var Vs=en[Is];en[Is]=lo,gn.set(Vs,gn.get(Vs)-1),Vs&at&&gn.set(at,gn.get(at)-1),gn.set(lo,(gn.get(lo)||0)+1),lo&at&&gn.set(at,(gn.get(at)||0)+1)}for(var In=new Uint8Array(Qn.length),gr=new Map,jn=[],hr=null,Tr=0;Tr<Qn.length;Tr++)hr||jn.push(hr={start:Tr,end:Qn.length-1,level:sr==="rtl"?1:sr==="ltr"?0:_l(Tr,!1)}),en[Tr]&Yt&&(hr.end=Tr,hr=null);for(var cr=hn|sn|Jt|Kt|st|$n|an|Yt,yr=function(Is){return Is+(Is&1?1:2)},Rr=function(Is){return Is+(Is&1?2:1)},br=0;br<jn.length;br++){hr=jn[br];var pr=[{_level:hr.level,_override:0,_isolate:0}],vn=void 0,qn=0,vr=0,Sn=0;gn.clear();for(var Ar=hr.start;Ar<=hr.end;Ar++){var Nn=en[Ar];if(vn=pr[pr.length-1],gn.set(Nn,(gn.get(Nn)||0)+1),Nn&at&&gn.set(at,(gn.get(at)||0)+1),Nn&cr)if(Nn&(hn|sn)){In[Ar]=vn._level;var nr=(Nn===hn?Rr:yr)(vn._level);nr<=un&&!qn&&!vr?pr.push({_level:nr,_override:0,_isolate:0}):qn||vr++}else if(Nn&(Jt|Kt)){In[Ar]=vn._level;var Ir=(Nn===Jt?Rr:yr)(vn._level);Ir<=un&&!qn&&!vr?pr.push({_level:Ir,_override:Nn&Jt?$t:Lt,_isolate:0}):qn||vr++}else if(Nn&st){Nn&yn&&(Nn=_l(Ar+1,!0)===1?_n:pn),In[Ar]=vn._level,vn._override&&Mn(Ar,vn._override);var Dn=(Nn===_n?Rr:yr)(vn._level);Dn<=un&&qn===0&&vr===0?(Sn++,pr.push({_level:Dn,_override:0,_isolate:1,_isolInitIndex:Ar})):qn++}else if(Nn&$n){if(qn>0)qn--;else if(Sn>0){for(vr=0;!pr[pr.length-1]._isolate;)pr.pop();var Pr=pr[pr.length-1]._isolInitIndex;Pr!=null&&(gr.set(Pr,Ar),gr.set(Ar,Pr)),pr.pop(),Sn--}vn=pr[pr.length-1],In[Ar]=vn._level,vn._override&&Mn(Ar,vn._override)}else Nn&an?(qn===0&&(vr>0?vr--:!vn._isolate&&pr.length>1&&(pr.pop(),vn=pr[pr.length-1])),In[Ar]=vn._level):Nn&Yt&&(In[Ar]=hr.level);else In[Ar]=vn._level,vn._override&&Nn!==rn&&Mn(Ar,vn._override)}for(var jr=[],Jr=null,Lr=hr.start;Lr<=hr.end;Lr++){var Wr=en[Lr];if(!(Wr&lt)){var As=In[Lr],ks=Wr&st,Ps=Wr===$n;Jr&&As===Jr._level?(Jr._end=Lr,Jr._endsWithIsolInit=ks):jr.push(Jr={_start:Lr,_end:Lr,_level:As,_startsWithPDI:Ps,_endsWithIsolInit:ks})}}for(var $s=[],eo=0;eo<jr.length;eo++){var Us=jr[eo];if(!Us._startsWithPDI||Us._startsWithPDI&&!gr.has(Us._start)){for(var zn=[Jr=Us],lr=void 0;Jr&&Jr._endsWithIsolInit&&(lr=gr.get(Jr._end))!=null;)for(var Sr=eo+1;Sr<jr.length;Sr++)if(jr[Sr]._start===lr){zn.push(Jr=jr[Sr]);break}for(var Or=[],xt=0;xt<zn.length;xt++)for(var mn=zn[xt],os=mn._start;os<=mn._end;os++)Or.push(os);for(var gs=In[Or[0]],Bs=hr.level,ln=Or[0]-1;ln>=0;ln--)if(!(en[ln]&lt)){Bs=In[ln];break}var Rn=Or[Or.length-1],Wn=In[Rn],Un=hr.level;if(!(en[Rn]&st)){for(var Cn=Rn+1;Cn<=hr.end;Cn++)if(!(en[Cn]&lt)){Un=In[Cn];break}}$s.push({_seqIndices:Or,_sosType:Math.max(Bs,gs)%2?$t:Lt,_eosType:Math.max(Un,Wn)%2?$t:Lt})}}for(var xr=0;xr<$s.length;xr++){var Nr=$s[xr],fr=Nr._seqIndices,Fr=Nr._sosType,Gr=Nr._eosType,zr=In[fr[0]]&1?$t:Lt;if(gn.get(Gt))for(var kr=0;kr<fr.length;kr++){var ls=fr[kr];if(en[ls]&Gt){for(var ds=Fr,ns=kr-1;ns>=0;ns--)if(!(en[fr[ns]]&lt)){ds=en[fr[ns]];break}Mn(ls,ds&(st|$n)?Zt:ds)}}if(gn.get(kt))for(var wr=0;wr<fr.length;wr++){var cn=fr[wr];if(en[cn]&kt)for(var mr=wr-1;mr>=-1;mr--){var cs=mr===-1?Fr:en[fr[mr]];if(cs&ot){cs===jt&&Mn(cn,zt);break}}}if(gn.get(jt))for(var Xr=0;Xr<fr.length;Xr++){var Gs=fr[Xr];en[Gs]&jt&&Mn(Gs,$t)}if(gn.get(Dt)||gn.get(Ht))for(var Ws=1;Ws<fr.length-1;Ws++){var ys=fr[Ws];if(en[ys]&(Dt|Ht)){for(var fn=0,Ts=0,Ao=Ws-1;Ao>=0&&(fn=en[fr[Ao]],!!(fn&lt));Ao--);for(var Io=Ws+1;Io<fr.length&&(Ts=en[fr[Io]],!!(Ts&lt));Io++);fn===Ts&&(en[ys]===Dt?fn===kt:fn&(kt|zt))&&Mn(ys,fn)}}if(gn.get(kt))for(var ws=0;ws<fr.length;ws++){var to=fr[ws];if(en[to]&kt){for(var Pl=ws-1;Pl>=0&&en[fr[Pl]]&(Ot|lt);Pl--)Mn(fr[Pl],kt);for(ws++;ws<fr.length&&en[fr[ws]]&(Ot|lt|kt);ws++)en[fr[ws]]!==kt&&Mn(fr[ws],kt)}}if(gn.get(Ot)||gn.get(Dt)||gn.get(Ht))for(var Go=0;Go<fr.length;Go++){var Su=fr[Go];if(en[Su]&(Ot|Dt|Ht)){Mn(Su,Zt);for(var Wo=Go-1;Wo>=0&&en[fr[Wo]]&lt;Wo--)Mn(fr[Wo],Zt);for(var no=Go+1;no<fr.length&&en[fr[no]]&lt;no++)Mn(fr[no],Zt)}}if(gn.get(kt))for(var Cs=0,$a=Fr;Cs<fr.length;Cs++){var Vu=fr[Cs],Tu=en[Vu];Tu&kt?$a===Lt&&Mn(Vu,Lt):Tu&ot&&($a=Tu)}if(gn.get(at)){var Ko=$t|kt|zt,_c=Ko|Lt,Xo=[];{for(var Ll=[],ps=0;ps<fr.length;ps++)if(en[fr[ps]]&at){var as=Qn[fr[ps]],eu=void 0;if(wt(as)!==null)if(Ll.length<63)Ll.push({char:as,seqIndex:ps});else break;else if((eu=Rt(as))!==null)for(var Al=Ll.length-1;Al>=0;Al--){var tu=Ll[Al].char;if(tu===eu||tu===Rt(It(as))||wt(It(tu))===as){Xo.push([Ll[Al].seqIndex,ps]),Ll.length=Al;break}}}Xo.sort(function(Is,lo){return Is[0]-lo[0]})}for(var Eu=0;Eu<Xo.length;Eu++){for(var Mu=Xo[Eu],Ls=Mu[0],yl=Mu[1],zu=!1,go=0,nu=Ls+1;nu<yl;nu++){var Il=fr[nu];if(en[Il]&_c){zu=!0;var xo=en[Il]&Ko?$t:Lt;if(xo===zr){go=xo;break}}}if(zu&&!go){go=Fr;for(var wu=Ls-1;wu>=0;wu--){var Hu=fr[wu];if(en[Hu]&_c){var Eo=en[Hu]&Ko?$t:Lt;Eo!==zr?go=Eo:go=zr;break}}}if(go){if(en[fr[Ls]]=en[fr[yl]]=go,go!==zr){for(var _s=Ls+1;_s<fr.length;_s++)if(!(en[fr[_s]]&lt)){dt(Qn[fr[_s]])&Gt&&(en[fr[_s]]=go);break}}if(go!==zr){for(var oo=yl+1;oo<fr.length;oo++)if(!(en[fr[oo]]&lt)){dt(Qn[fr[oo]])&Gt&&(en[fr[oo]]=go);break}}}}for(var Rs=0;Rs<fr.length;Rs++)if(en[fr[Rs]]&at){for(var Ul=Rs,ru=Rs,ro=Fr,Gl=Rs-1;Gl>=0;Gl--)if(en[fr[Gl]]&lt)Ul=Gl;else{ro=en[fr[Gl]]&Ko?$t:Lt;break}for(var Vl=Gr,zl=Rs+1;zl<fr.length;zl++)if(en[fr[zl]]&(at|lt))ru=zl;else{Vl=en[fr[zl]]&Ko?$t:Lt;break}for(var ao=Ul;ao<=ru;ao++)en[fr[ao]]=ro===Vl?ro:zr;Rs=ru}}}for(var Hs=hr.start;Hs<=hr.end;Hs++){var Do=In[Hs],$o=en[Hs];if(Do&1?$o&(Lt|kt|zt)&&In[Hs]++:$o&$t?In[Hs]++:$o&(zt|kt)&&(In[Hs]+=2),$o&lt&&(In[Hs]=Hs===0?hr.level:In[Hs-1]),Hs===hr.end||dt(Qn[Hs])&(Xt|Yt))for(var xl=Hs;xl>=0&&dt(Qn[xl])&ct;xl--)In[xl]=hr.level}}return{levels:In,paragraphs:jn};function _l(Is,lo){for(var Vs=Is;Vs<Qn.length;Vs++){var Fs=en[Vs];if(Fs&($t|jt))return 1;if(Fs&(Yt|Lt)||lo&&Fs===$n)return 0;if(Fs&st){var Mo=Yo(Vs);Vs=Mo===-1?Qn.length:Mo}}return 0}function Yo(Is){for(var lo=1,Vs=Is+1;Vs<Qn.length;Vs++){var Fs=en[Vs];if(Fs&Yt)break;if(Fs&$n){if(--lo===0)return Vs}else Fs&st&&lo++}return-1}}var Xn="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Vn;function En(){if(!Vn){var Qn=mt(Xn,!0),sr=Qn.map,un=Qn.reverseMap;un.forEach(function(en,wn){sr.set(wn,en)}),Vn=sr}}function dn(Qn){return En(),Vn.get(Qn)||null}function rr(Qn,sr,un,en){var wn=Qn.length;un=Math.max(0,un==null?0:+un),en=Math.min(wn-1,en==null?wn-1:+en);for(var gn=new Map,Mn=un;Mn<=en;Mn++)if(sr[Mn]&1){var In=dn(Qn[Mn]);In!==null&&gn.set(Mn,In)}return gn}function er(Qn,sr,un,en){var wn=Qn.length;un=Math.max(0,un==null?0:+un),en=Math.min(wn-1,en==null?wn-1:+en);var gn=[];return sr.paragraphs.forEach(function(Mn){var In=Math.max(un,Mn.start),gr=Math.min(en,Mn.end);if(In<gr){for(var jn=sr.levels.slice(In,gr+1),hr=gr;hr>=In&&dt(Qn[hr])&ct;hr--)jn[hr]=Mn.level;for(var Tr=Mn.level,cr=1/0,yr=0;yr<jn.length;yr++){var Rr=jn[yr];Rr>Tr&&(Tr=Rr),Rr<cr&&(cr=Rr|1)}for(var br=Tr;br>=cr;br--)for(var pr=0;pr<jn.length;pr++)if(jn[pr]>=br){for(var vn=pr;pr+1<jn.length&&jn[pr+1]>=br;)pr++;pr>vn&&gn.push([vn+In,pr+In])}}}),gn}function Yn(Qn,sr,un,en){var wn=ir(Qn,sr,un,en),gn=[].concat(Qn);return wn.forEach(function(Mn,In){gn[In]=(sr.levels[Mn]&1?dn(Qn[Mn]):null)||Qn[Mn]}),gn.join("")}function ir(Qn,sr,un,en){for(var wn=er(Qn,sr,un,en),gn=[],Mn=0;Mn<Qn.length;Mn++)gn[Mn]=Mn;return wn.forEach(function(In){for(var gr=In[0],jn=In[1],hr=gn.slice(gr,jn+1),Tr=hr.length;Tr--;)gn[jn-Tr]=hr[Tr]}),gn}return _e.closingToOpeningBracket=Rt,_e.getBidiCharType=dt,_e.getBidiCharTypeName=ft,_e.getCanonicalBracket=It,_e.getEmbeddingLevels=Jn,_e.getMirroredCharacter=dn,_e.getMirroredCharactersMap=rr,_e.getReorderSegments=er,_e.getReorderedIndices=ir,_e.getReorderedString=Yn,_e.openingToClosingBracket=wt,Object.defineProperty(_e,"__esModule",{value:!0}),_e}({});return nt}const voidMainRegExp=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(nt){const _e=/^[ \t]*#include +<([\w\d./]+)>/gm;function et(rt,it){let st=ShaderChunk[it];return st?expandShaderIncludes(st):rt}return nt.replace(_e,et)}const _lut$1=[];for(let nt=0;nt<256;nt++)_lut$1[nt]=(nt<16?"0":"")+nt.toString(16);function generateUUID$1(){const nt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,et=Math.random()*4294967295|0,rt=Math.random()*4294967295|0;return(_lut$1[nt&255]+_lut$1[nt>>8&255]+_lut$1[nt>>16&255]+_lut$1[nt>>24&255]+"-"+_lut$1[_e&255]+_lut$1[_e>>8&255]+"-"+_lut$1[_e>>16&15|64]+_lut$1[_e>>24&255]+"-"+_lut$1[et&63|128]+_lut$1[et>>8&255]+"-"+_lut$1[et>>16&255]+_lut$1[et>>24&255]+_lut$1[rt&255]+_lut$1[rt>>8&255]+_lut$1[rt>>16&255]+_lut$1[rt>>24&255]).toUpperCase()}const assign$2=Object.assign||function(){let nt=arguments[0];for(let _e=1,et=arguments.length;_e<et;_e++){let rt=arguments[_e];if(rt)for(let it in rt)Object.prototype.hasOwnProperty.call(rt,it)&&(nt[it]=rt[it])}return nt},epoch=Date.now(),CONSTRUCTOR_CACHE=new WeakMap,SHADER_UPGRADE_CACHE=new Map;let materialInstanceId=1e10;function createDerivedMaterial(nt,_e){const et=getKeyForOptions(_e);let rt=CONSTRUCTOR_CACHE.get(nt);if(rt||CONSTRUCTOR_CACHE.set(nt,rt=Object.create(null)),rt[et])return new rt[et];const it=`_onBeforeCompile${et}`,st=function(ct,ut){nt.onBeforeCompile.call(this,ct,ut);const ht=this.customProgramCacheKey()+"|"+ct.vertexShader+"|"+ct.fragmentShader;let dt=SHADER_UPGRADE_CACHE[ht];if(!dt){const ft=upgradeShaders(this,ct,_e,et);dt=SHADER_UPGRADE_CACHE[ht]=ft}ct.vertexShader=dt.vertexShader,ct.fragmentShader=dt.fragmentShader,assign$2(ct.uniforms,this.uniforms),_e.timeUniform&&(ct.uniforms[_e.timeUniform]={get value(){return Date.now()-epoch}}),this[it]&&this[it](ct)},ot=function(){return at(_e.chained?nt:nt.clone())},at=function(ct){const ut=Object.create(ct,lt);return Object.defineProperty(ut,"baseMaterial",{value:nt}),Object.defineProperty(ut,"id",{value:materialInstanceId++}),ut.uuid=generateUUID$1(),ut.uniforms=assign$2({},ct.uniforms,_e.uniforms),ut.defines=assign$2({},ct.defines,_e.defines),ut.defines[`TROIKA_DERIVED_MATERIAL_${et}`]="",ut.extensions=assign$2({},ct.extensions,_e.extensions),ut._listeners=void 0,ut},lt={constructor:{value:ot},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return nt.customProgramCacheKey()+"|"+et}},onBeforeCompile:{get(){return st},set(ct){this[it]=ct}},copy:{writable:!0,configurable:!0,value:function(ct){return nt.copy.call(this,ct),!nt.isShaderMaterial&&!nt.isDerivedMaterial&&(assign$2(this.extensions,ct.extensions),assign$2(this.defines,ct.defines),assign$2(this.uniforms,UniformsUtils.clone(ct.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const ct=new nt.constructor;return at(ct).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let ct=this._depthMaterial;return ct||(ct=this._depthMaterial=createDerivedMaterial(nt.isDerivedMaterial?nt.getDepthMaterial():new MeshDepthMaterial({depthPacking:RGBADepthPacking}),_e),ct.defines.IS_DEPTH_MATERIAL="",ct.uniforms=this.uniforms),ct}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let ct=this._distanceMaterial;return ct||(ct=this._distanceMaterial=createDerivedMaterial(nt.isDerivedMaterial?nt.getDistanceMaterial():new MeshDistanceMaterial,_e),ct.defines.IS_DISTANCE_MATERIAL="",ct.uniforms=this.uniforms),ct}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:ct,_distanceMaterial:ut}=this;ct&&ct.dispose(),ut&&ut.dispose(),nt.dispose.call(this)}}};return rt[et]=ot,new ot}function upgradeShaders(nt,{vertexShader:_e,fragmentShader:et},rt,it){let{vertexDefs:st,vertexMainIntro:ot,vertexMainOutro:at,vertexTransform:lt,fragmentDefs:ct,fragmentMainIntro:ut,fragmentMainOutro:ht,fragmentColorTransform:dt,customRewriter:ft,timeUniform:pt}=rt;if(st=st||"",ot=ot||"",at=at||"",ct=ct||"",ut=ut||"",ht=ht||"",(lt||ft)&&(_e=expandShaderIncludes(_e)),(dt||ft)&&(et=et.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),et=expandShaderIncludes(et)),ft){let mt=ft({vertexShader:_e,fragmentShader:et});_e=mt.vertexShader,et=mt.fragmentShader}if(dt){let mt=[];et=et.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,At=>(mt.push(At),"")),ht=`${dt}
${mt.join(`
`)}
${ht}`}if(pt){const mt=`
uniform float ${pt};
`;st=mt+st,ct=mt+ct}return lt&&(_e=`vec3 troika_position_${it};
vec3 troika_normal_${it};
vec2 troika_uv_${it};
${_e}
`,st=`${st}
void troikaVertexTransform${it}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${lt}
}
`,ot=`
troika_position_${it} = vec3(position);
troika_normal_${it} = vec3(normal);
troika_uv_${it} = vec2(uv);
troikaVertexTransform${it}(troika_position_${it}, troika_normal_${it}, troika_uv_${it});
${ot}
`,_e=_e.replace(/\b(position|normal|uv)\b/g,(mt,At,gt,bt)=>/\battribute\s+vec[23]\s+$/.test(bt.substr(0,gt))?At:`troika_${At}_${it}`),nt.map&&nt.map.channel>0||(_e=_e.replace(/\bMAP_UV\b/g,`troika_uv_${it}`))),_e=injectIntoShaderCode(_e,it,st,ot,at),et=injectIntoShaderCode(et,it,ct,ut,ht),{vertexShader:_e,fragmentShader:et}}function injectIntoShaderCode(nt,_e,et,rt,it){return(rt||it||et)&&(nt=nt.replace(voidMainRegExp,`
${et}
void troikaOrigMain${_e}() {`),nt+=`
void main() {
  ${rt}
  troikaOrigMain${_e}();
  ${it}
}`),nt}function optionsJsonReplacer(nt,_e){return nt==="uniforms"?void 0:typeof _e=="function"?_e.toString():_e}let _idCtr=0;const optionsHashesToIds=new Map;function getKeyForOptions(nt){const _e=JSON.stringify(nt,optionsJsonReplacer);let et=optionsHashesToIds.get(_e);return et==null&&optionsHashesToIds.set(_e,et=++_idCtr),et}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function typrFactory(){return typeof window>"u"&&(self.window=self),function(nt){var _e={parse:function(it){var st=_e._bin,ot=new Uint8Array(it);if(st.readASCII(ot,0,4)=="ttcf"){var at=4;st.readUshort(ot,at),at+=2,st.readUshort(ot,at),at+=2;var lt=st.readUint(ot,at);at+=4;for(var ct=[],ut=0;ut<lt;ut++){var ht=st.readUint(ot,at);at+=4,ct.push(_e._readFont(ot,ht))}return ct}return[_e._readFont(ot,0)]},_readFont:function(it,st){var ot=_e._bin,at=st;ot.readFixed(it,st),st+=4;var lt=ot.readUshort(it,st);st+=2,ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2;for(var ct=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],ut={_data:it,_offset:at},ht={},dt=0;dt<lt;dt++){var ft=ot.readASCII(it,st,4);st+=4,ot.readUint(it,st),st+=4;var pt=ot.readUint(it,st);st+=4;var mt=ot.readUint(it,st);st+=4,ht[ft]={offset:pt,length:mt}}for(dt=0;dt<ct.length;dt++){var At=ct[dt];ht[At]&&(ut[At.trim()]=_e[At.trim()].parse(it,ht[At].offset,ht[At].length,ut))}return ut},_tabOffset:function(it,st,ot){for(var at=_e._bin,lt=at.readUshort(it,ot+4),ct=ot+12,ut=0;ut<lt;ut++){var ht=at.readASCII(it,ct,4);ct+=4,at.readUint(it,ct),ct+=4;var dt=at.readUint(it,ct);if(ct+=4,at.readUint(it,ct),ct+=4,ht==st)return dt}return 0}};_e._bin={readFixed:function(it,st){return(it[st]<<8|it[st+1])+(it[st+2]<<8|it[st+3])/65540},readF2dot14:function(it,st){return _e._bin.readShort(it,st)/16384},readInt:function(it,st){return _e._bin._view(it).getInt32(st)},readInt8:function(it,st){return _e._bin._view(it).getInt8(st)},readShort:function(it,st){return _e._bin._view(it).getInt16(st)},readUshort:function(it,st){return _e._bin._view(it).getUint16(st)},readUshorts:function(it,st,ot){for(var at=[],lt=0;lt<ot;lt++)at.push(_e._bin.readUshort(it,st+2*lt));return at},readUint:function(it,st){return _e._bin._view(it).getUint32(st)},readUint64:function(it,st){return 4294967296*_e._bin.readUint(it,st)+_e._bin.readUint(it,st+4)},readASCII:function(it,st,ot){for(var at="",lt=0;lt<ot;lt++)at+=String.fromCharCode(it[st+lt]);return at},readUnicode:function(it,st,ot){for(var at="",lt=0;lt<ot;lt++){var ct=it[st++]<<8|it[st++];at+=String.fromCharCode(ct)}return at},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(it,st,ot){var at=_e._bin._tdec;return at&&st==0&&ot==it.length?at.decode(it):_e._bin.readASCII(it,st,ot)},readBytes:function(it,st,ot){for(var at=[],lt=0;lt<ot;lt++)at.push(it[st+lt]);return at},readASCIIArray:function(it,st,ot){for(var at=[],lt=0;lt<ot;lt++)at.push(String.fromCharCode(it[st+lt]));return at},_view:function(it){return it._dataView||(it._dataView=it.buffer?new DataView(it.buffer,it.byteOffset,it.byteLength):new DataView(new Uint8Array(it).buffer))}},_e._lctf={},_e._lctf.parse=function(it,st,ot,at,lt){var ct=_e._bin,ut={},ht=st;ct.readFixed(it,st),st+=4;var dt=ct.readUshort(it,st);st+=2;var ft=ct.readUshort(it,st);st+=2;var pt=ct.readUshort(it,st);return st+=2,ut.scriptList=_e._lctf.readScriptList(it,ht+dt),ut.featureList=_e._lctf.readFeatureList(it,ht+ft),ut.lookupList=_e._lctf.readLookupList(it,ht+pt,lt),ut},_e._lctf.readLookupList=function(it,st,ot){var at=_e._bin,lt=st,ct=[],ut=at.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++){var dt=at.readUshort(it,st);st+=2;var ft=_e._lctf.readLookupTable(it,lt+dt,ot);ct.push(ft)}return ct},_e._lctf.readLookupTable=function(it,st,ot){var at=_e._bin,lt=st,ct={tabs:[]};ct.ltype=at.readUshort(it,st),st+=2,ct.flag=at.readUshort(it,st),st+=2;var ut=at.readUshort(it,st);st+=2;for(var ht=ct.ltype,dt=0;dt<ut;dt++){var ft=at.readUshort(it,st);st+=2;var pt=ot(it,ht,lt+ft,ct);ct.tabs.push(pt)}return ct},_e._lctf.numOfOnes=function(it){for(var st=0,ot=0;ot<32;ot++)it>>>ot&1&&st++;return st},_e._lctf.readClassDef=function(it,st){var ot=_e._bin,at=[],lt=ot.readUshort(it,st);if(st+=2,lt==1){var ct=ot.readUshort(it,st);st+=2;var ut=ot.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++)at.push(ct+ht),at.push(ct+ht),at.push(ot.readUshort(it,st)),st+=2}if(lt==2){var dt=ot.readUshort(it,st);for(st+=2,ht=0;ht<dt;ht++)at.push(ot.readUshort(it,st)),st+=2,at.push(ot.readUshort(it,st)),st+=2,at.push(ot.readUshort(it,st)),st+=2}return at},_e._lctf.getInterval=function(it,st){for(var ot=0;ot<it.length;ot+=3){var at=it[ot],lt=it[ot+1];if(it[ot+2],at<=st&&st<=lt)return ot}return-1},_e._lctf.readCoverage=function(it,st){var ot=_e._bin,at={};at.fmt=ot.readUshort(it,st),st+=2;var lt=ot.readUshort(it,st);return st+=2,at.fmt==1&&(at.tab=ot.readUshorts(it,st,lt)),at.fmt==2&&(at.tab=ot.readUshorts(it,st,3*lt)),at},_e._lctf.coverageIndex=function(it,st){var ot=it.tab;if(it.fmt==1)return ot.indexOf(st);if(it.fmt==2){var at=_e._lctf.getInterval(ot,st);if(at!=-1)return ot[at+2]+(st-ot[at])}return-1},_e._lctf.readFeatureList=function(it,st){var ot=_e._bin,at=st,lt=[],ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readASCII(it,st,4);st+=4;var dt=ot.readUshort(it,st);st+=2;var ft=_e._lctf.readFeatureTable(it,at+dt);ft.tag=ht.trim(),lt.push(ft)}return lt},_e._lctf.readFeatureTable=function(it,st){var ot=_e._bin,at=st,lt={},ct=ot.readUshort(it,st);st+=2,ct>0&&(lt.featureParams=at+ct);var ut=ot.readUshort(it,st);st+=2,lt.tab=[];for(var ht=0;ht<ut;ht++)lt.tab.push(ot.readUshort(it,st+2*ht));return lt},_e._lctf.readScriptList=function(it,st){var ot=_e._bin,at=st,lt={},ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readASCII(it,st,4);st+=4;var dt=ot.readUshort(it,st);st+=2,lt[ht.trim()]=_e._lctf.readScriptTable(it,at+dt)}return lt},_e._lctf.readScriptTable=function(it,st){var ot=_e._bin,at=st,lt={},ct=ot.readUshort(it,st);st+=2,ct>0&&(lt.default=_e._lctf.readLangSysTable(it,at+ct));var ut=ot.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++){var dt=ot.readASCII(it,st,4);st+=4;var ft=ot.readUshort(it,st);st+=2,lt[dt.trim()]=_e._lctf.readLangSysTable(it,at+ft)}return lt},_e._lctf.readLangSysTable=function(it,st){var ot=_e._bin,at={};ot.readUshort(it,st),st+=2,at.reqFeature=ot.readUshort(it,st),st+=2;var lt=ot.readUshort(it,st);return st+=2,at.features=ot.readUshorts(it,st,lt),at},_e.CFF={},_e.CFF.parse=function(it,st,ot){var at=_e._bin;(it=new Uint8Array(it.buffer,st,ot))[st=0],it[++st],it[++st],it[++st],st++;var lt=[];st=_e.CFF.readIndex(it,st,lt);for(var ct=[],ut=0;ut<lt.length-1;ut++)ct.push(at.readASCII(it,st+lt[ut],lt[ut+1]-lt[ut]));st+=lt[lt.length-1];var ht=[];st=_e.CFF.readIndex(it,st,ht);var dt=[];for(ut=0;ut<ht.length-1;ut++)dt.push(_e.CFF.readDict(it,st+ht[ut],st+ht[ut+1]));st+=ht[ht.length-1];var ft=dt[0],pt=[];st=_e.CFF.readIndex(it,st,pt);var mt=[];for(ut=0;ut<pt.length-1;ut++)mt.push(at.readASCII(it,st+pt[ut],pt[ut+1]-pt[ut]));if(st+=pt[pt.length-1],_e.CFF.readSubrs(it,st,ft),ft.CharStrings){st=ft.CharStrings,pt=[],st=_e.CFF.readIndex(it,st,pt);var At=[];for(ut=0;ut<pt.length-1;ut++)At.push(at.readBytes(it,st+pt[ut],pt[ut+1]-pt[ut]));ft.CharStrings=At}if(ft.ROS){st=ft.FDArray;var gt=[];for(st=_e.CFF.readIndex(it,st,gt),ft.FDArray=[],ut=0;ut<gt.length-1;ut++){var bt=_e.CFF.readDict(it,st+gt[ut],st+gt[ut+1]);_e.CFF._readFDict(it,bt,mt),ft.FDArray.push(bt)}st+=gt[gt.length-1],st=ft.FDSelect,ft.FDSelect=[];var Tt=it[st];if(st++,Tt!=3)throw Tt;var wt=at.readUshort(it,st);for(st+=2,ut=0;ut<wt+1;ut++)ft.FDSelect.push(at.readUshort(it,st),it[st+2]),st+=3}return ft.Encoding&&(ft.Encoding=_e.CFF.readEncoding(it,ft.Encoding,ft.CharStrings.length)),ft.charset&&(ft.charset=_e.CFF.readCharset(it,ft.charset,ft.CharStrings.length)),_e.CFF._readFDict(it,ft,mt),ft},_e.CFF._readFDict=function(it,st,ot){var at;for(var lt in st.Private&&(at=st.Private[1],st.Private=_e.CFF.readDict(it,at,at+st.Private[0]),st.Private.Subrs&&_e.CFF.readSubrs(it,at+st.Private.Subrs,st.Private)),st)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(lt)!=-1&&(st[lt]=ot[st[lt]-426+35])},_e.CFF.readSubrs=function(it,st,ot){var at=_e._bin,lt=[];st=_e.CFF.readIndex(it,st,lt);var ct,ut=lt.length;ct=ut<1240?107:ut<33900?1131:32768,ot.Bias=ct,ot.Subrs=[];for(var ht=0;ht<lt.length-1;ht++)ot.Subrs.push(at.readBytes(it,st+lt[ht],lt[ht+1]-lt[ht]))},_e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],_e.CFF.glyphByUnicode=function(it,st){for(var ot=0;ot<it.charset.length;ot++)if(it.charset[ot]==st)return ot;return-1},_e.CFF.glyphBySE=function(it,st){return st<0||st>255?-1:_e.CFF.glyphByUnicode(it,_e.CFF.tableSE[st])},_e.CFF.readEncoding=function(it,st,ot){_e._bin;var at=[".notdef"],lt=it[st];if(st++,lt!=0)throw"error: unknown encoding format: "+lt;var ct=it[st];st++;for(var ut=0;ut<ct;ut++)at.push(it[st+ut]);return at},_e.CFF.readCharset=function(it,st,ot){var at=_e._bin,lt=[".notdef"],ct=it[st];if(st++,ct==0)for(var ut=0;ut<ot;ut++){var ht=at.readUshort(it,st);st+=2,lt.push(ht)}else{if(ct!=1&&ct!=2)throw"error: format: "+ct;for(;lt.length<ot;){ht=at.readUshort(it,st),st+=2;var dt=0;for(ct==1?(dt=it[st],st++):(dt=at.readUshort(it,st),st+=2),ut=0;ut<=dt;ut++)lt.push(ht),ht++}}return lt},_e.CFF.readIndex=function(it,st,ot){var at=_e._bin,lt=at.readUshort(it,st)+1,ct=it[st+=2];if(st++,ct==1)for(var ut=0;ut<lt;ut++)ot.push(it[st+ut]);else if(ct==2)for(ut=0;ut<lt;ut++)ot.push(at.readUshort(it,st+2*ut));else if(ct==3)for(ut=0;ut<lt;ut++)ot.push(16777215&at.readUint(it,st+3*ut-1));else if(lt!=1)throw"unsupported offset size: "+ct+", count: "+lt;return(st+=lt*ct)-1},_e.CFF.getCharString=function(it,st,ot){var at=_e._bin,lt=it[st],ct=it[st+1];it[st+2],it[st+3],it[st+4];var ut=1,ht=null,dt=null;lt<=20&&(ht=lt,ut=1),lt==12&&(ht=100*lt+ct,ut=2),21<=lt&&lt<=27&&(ht=lt,ut=1),lt==28&&(dt=at.readShort(it,st+1),ut=3),29<=lt&&lt<=31&&(ht=lt,ut=1),32<=lt&&lt<=246&&(dt=lt-139,ut=1),247<=lt&&lt<=250&&(dt=256*(lt-247)+ct+108,ut=2),251<=lt&&lt<=254&&(dt=256*-(lt-251)-ct-108,ut=2),lt==255&&(dt=at.readInt(it,st+1)/65535,ut=5),ot.val=dt??"o"+ht,ot.size=ut},_e.CFF.readCharString=function(it,st,ot){for(var at=st+ot,lt=_e._bin,ct=[];st<at;){var ut=it[st],ht=it[st+1];it[st+2],it[st+3],it[st+4];var dt=1,ft=null,pt=null;ut<=20&&(ft=ut,dt=1),ut==12&&(ft=100*ut+ht,dt=2),ut!=19&&ut!=20||(ft=ut,dt=2),21<=ut&&ut<=27&&(ft=ut,dt=1),ut==28&&(pt=lt.readShort(it,st+1),dt=3),29<=ut&&ut<=31&&(ft=ut,dt=1),32<=ut&&ut<=246&&(pt=ut-139,dt=1),247<=ut&&ut<=250&&(pt=256*(ut-247)+ht+108,dt=2),251<=ut&&ut<=254&&(pt=256*-(ut-251)-ht-108,dt=2),ut==255&&(pt=lt.readInt(it,st+1)/65535,dt=5),ct.push(pt??"o"+ft),st+=dt}return ct},_e.CFF.readDict=function(it,st,ot){for(var at=_e._bin,lt={},ct=[];st<ot;){var ut=it[st],ht=it[st+1];it[st+2],it[st+3],it[st+4];var dt=1,ft=null,pt=null;if(ut==28&&(pt=at.readShort(it,st+1),dt=3),ut==29&&(pt=at.readInt(it,st+1),dt=5),32<=ut&&ut<=246&&(pt=ut-139,dt=1),247<=ut&&ut<=250&&(pt=256*(ut-247)+ht+108,dt=2),251<=ut&&ut<=254&&(pt=256*-(ut-251)-ht-108,dt=2),ut==255)throw pt=at.readInt(it,st+1)/65535,dt=5,"unknown number";if(ut==30){var mt=[];for(dt=1;;){var At=it[st+dt];dt++;var gt=At>>4,bt=15&At;if(gt!=15&&mt.push(gt),bt!=15&&mt.push(bt),bt==15)break}for(var Tt="",wt=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],Rt=0;Rt<mt.length;Rt++)Tt+=wt[mt[Rt]];pt=parseFloat(Tt)}ut<=21&&(ft=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][ut],dt=1,ut==12&&(ft=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][ht],dt=2)),ft!=null?(lt[ft]=ct.length==1?ct[0]:ct,ct=[]):ct.push(pt),st+=dt}return lt},_e.cmap={},_e.cmap.parse=function(it,st,ot){it=new Uint8Array(it.buffer,st,ot),st=0;var at=_e._bin,lt={};at.readUshort(it,st),st+=2;var ct=at.readUshort(it,st);st+=2;var ut=[];lt.tables=[];for(var ht=0;ht<ct;ht++){var dt=at.readUshort(it,st);st+=2;var ft=at.readUshort(it,st);st+=2;var pt=at.readUint(it,st);st+=4;var mt="p"+dt+"e"+ft,At=ut.indexOf(pt);if(At==-1){var gt;At=lt.tables.length,ut.push(pt);var bt=at.readUshort(it,pt);bt==0?gt=_e.cmap.parse0(it,pt):bt==4?gt=_e.cmap.parse4(it,pt):bt==6?gt=_e.cmap.parse6(it,pt):bt==12?gt=_e.cmap.parse12(it,pt):console.debug("unknown format: "+bt,dt,ft,pt),lt.tables.push(gt)}if(lt[mt]!=null)throw"multiple tables for one platform+encoding";lt[mt]=At}return lt},_e.cmap.parse0=function(it,st){var ot=_e._bin,at={};at.format=ot.readUshort(it,st),st+=2;var lt=ot.readUshort(it,st);st+=2,ot.readUshort(it,st),st+=2,at.map=[];for(var ct=0;ct<lt-6;ct++)at.map.push(it[st+ct]);return at},_e.cmap.parse4=function(it,st){var ot=_e._bin,at=st,lt={};lt.format=ot.readUshort(it,st),st+=2;var ct=ot.readUshort(it,st);st+=2,ot.readUshort(it,st),st+=2;var ut=ot.readUshort(it,st);st+=2;var ht=ut/2;lt.searchRange=ot.readUshort(it,st),st+=2,lt.entrySelector=ot.readUshort(it,st),st+=2,lt.rangeShift=ot.readUshort(it,st),st+=2,lt.endCount=ot.readUshorts(it,st,ht),st+=2*ht,st+=2,lt.startCount=ot.readUshorts(it,st,ht),st+=2*ht,lt.idDelta=[];for(var dt=0;dt<ht;dt++)lt.idDelta.push(ot.readShort(it,st)),st+=2;for(lt.idRangeOffset=ot.readUshorts(it,st,ht),st+=2*ht,lt.glyphIdArray=[];st<at+ct;)lt.glyphIdArray.push(ot.readUshort(it,st)),st+=2;return lt},_e.cmap.parse6=function(it,st){var ot=_e._bin,at={};at.format=ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2,at.firstCode=ot.readUshort(it,st),st+=2;var lt=ot.readUshort(it,st);st+=2,at.glyphIdArray=[];for(var ct=0;ct<lt;ct++)at.glyphIdArray.push(ot.readUshort(it,st)),st+=2;return at},_e.cmap.parse12=function(it,st){var ot=_e._bin,at={};at.format=ot.readUshort(it,st),st+=2,st+=2,ot.readUint(it,st),st+=4,ot.readUint(it,st),st+=4;var lt=ot.readUint(it,st);st+=4,at.groups=[];for(var ct=0;ct<lt;ct++){var ut=st+12*ct,ht=ot.readUint(it,ut+0),dt=ot.readUint(it,ut+4),ft=ot.readUint(it,ut+8);at.groups.push([ht,dt,ft])}return at},_e.glyf={},_e.glyf.parse=function(it,st,ot,at){for(var lt=[],ct=0;ct<at.maxp.numGlyphs;ct++)lt.push(null);return lt},_e.glyf._parseGlyf=function(it,st){var ot=_e._bin,at=it._data,lt=_e._tabOffset(at,"glyf",it._offset)+it.loca[st];if(it.loca[st]==it.loca[st+1])return null;var ct={};if(ct.noc=ot.readShort(at,lt),lt+=2,ct.xMin=ot.readShort(at,lt),lt+=2,ct.yMin=ot.readShort(at,lt),lt+=2,ct.xMax=ot.readShort(at,lt),lt+=2,ct.yMax=ot.readShort(at,lt),lt+=2,ct.xMin>=ct.xMax||ct.yMin>=ct.yMax)return null;if(ct.noc>0){ct.endPts=[];for(var ut=0;ut<ct.noc;ut++)ct.endPts.push(ot.readUshort(at,lt)),lt+=2;var ht=ot.readUshort(at,lt);if(lt+=2,at.length-lt<ht)return null;ct.instructions=ot.readBytes(at,lt,ht),lt+=ht;var dt=ct.endPts[ct.noc-1]+1;for(ct.flags=[],ut=0;ut<dt;ut++){var ft=at[lt];if(lt++,ct.flags.push(ft),(8&ft)!=0){var pt=at[lt];lt++;for(var mt=0;mt<pt;mt++)ct.flags.push(ft),ut++}}for(ct.xs=[],ut=0;ut<dt;ut++){var At=(2&ct.flags[ut])!=0,gt=(16&ct.flags[ut])!=0;At?(ct.xs.push(gt?at[lt]:-at[lt]),lt++):gt?ct.xs.push(0):(ct.xs.push(ot.readShort(at,lt)),lt+=2)}for(ct.ys=[],ut=0;ut<dt;ut++)At=(4&ct.flags[ut])!=0,gt=(32&ct.flags[ut])!=0,At?(ct.ys.push(gt?at[lt]:-at[lt]),lt++):gt?ct.ys.push(0):(ct.ys.push(ot.readShort(at,lt)),lt+=2);var bt=0,Tt=0;for(ut=0;ut<dt;ut++)bt+=ct.xs[ut],Tt+=ct.ys[ut],ct.xs[ut]=bt,ct.ys[ut]=Tt}else{var wt;ct.parts=[];do{wt=ot.readUshort(at,lt),lt+=2;var Rt={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(ct.parts.push(Rt),Rt.glyphIndex=ot.readUshort(at,lt),lt+=2,1&wt){var It=ot.readShort(at,lt);lt+=2;var Lt=ot.readShort(at,lt);lt+=2}else It=ot.readInt8(at,lt),lt++,Lt=ot.readInt8(at,lt),lt++;2&wt?(Rt.m.tx=It,Rt.m.ty=Lt):(Rt.p1=It,Rt.p2=Lt),8&wt?(Rt.m.a=Rt.m.d=ot.readF2dot14(at,lt),lt+=2):64&wt?(Rt.m.a=ot.readF2dot14(at,lt),lt+=2,Rt.m.d=ot.readF2dot14(at,lt),lt+=2):128&wt&&(Rt.m.a=ot.readF2dot14(at,lt),lt+=2,Rt.m.b=ot.readF2dot14(at,lt),lt+=2,Rt.m.c=ot.readF2dot14(at,lt),lt+=2,Rt.m.d=ot.readF2dot14(at,lt),lt+=2)}while(32&wt);if(256&wt){var $t=ot.readUshort(at,lt);for(lt+=2,ct.instr=[],ut=0;ut<$t;ut++)ct.instr.push(at[lt]),lt++}}return ct},_e.GDEF={},_e.GDEF.parse=function(it,st,ot,at){var lt=st;st+=4;var ct=_e._bin.readUshort(it,st);return{glyphClassDef:ct===0?null:_e._lctf.readClassDef(it,lt+ct)}},_e.GPOS={},_e.GPOS.parse=function(it,st,ot,at){return _e._lctf.parse(it,st,ot,at,_e.GPOS.subt)},_e.GPOS.subt=function(it,st,ot,at){var lt=_e._bin,ct=ot,ut={};if(ut.fmt=lt.readUshort(it,ot),ot+=2,st==1||st==2||st==3||st==7||st==8&&ut.fmt<=2){var ht=lt.readUshort(it,ot);ot+=2,ut.coverage=_e._lctf.readCoverage(it,ht+ct)}if(st==1&&ut.fmt==1){var dt=lt.readUshort(it,ot);ot+=2,dt!=0&&(ut.pos=_e.GPOS.readValueRecord(it,ot,dt))}else if(st==2&&ut.fmt>=1&&ut.fmt<=2){dt=lt.readUshort(it,ot),ot+=2;var ft=lt.readUshort(it,ot);ot+=2;var pt=_e._lctf.numOfOnes(dt),mt=_e._lctf.numOfOnes(ft);if(ut.fmt==1){ut.pairsets=[];var At=lt.readUshort(it,ot);ot+=2;for(var gt=0;gt<At;gt++){var bt=ct+lt.readUshort(it,ot);ot+=2;var Tt=lt.readUshort(it,bt);bt+=2;for(var wt=[],Rt=0;Rt<Tt;Rt++){var It=lt.readUshort(it,bt);bt+=2,dt!=0&&(zt=_e.GPOS.readValueRecord(it,bt,dt),bt+=2*pt),ft!=0&&(Ht=_e.GPOS.readValueRecord(it,bt,ft),bt+=2*mt),wt.push({gid2:It,val1:zt,val2:Ht})}ut.pairsets.push(wt)}}if(ut.fmt==2){var Lt=lt.readUshort(it,ot);ot+=2;var $t=lt.readUshort(it,ot);ot+=2;var kt=lt.readUshort(it,ot);ot+=2;var Dt=lt.readUshort(it,ot);for(ot+=2,ut.classDef1=_e._lctf.readClassDef(it,ct+Lt),ut.classDef2=_e._lctf.readClassDef(it,ct+$t),ut.matrix=[],gt=0;gt<kt;gt++){var Ot=[];for(Rt=0;Rt<Dt;Rt++){var zt=null,Ht=null;dt!=0&&(zt=_e.GPOS.readValueRecord(it,ot,dt),ot+=2*pt),ft!=0&&(Ht=_e.GPOS.readValueRecord(it,ot,ft),ot+=2*mt),Ot.push({val1:zt,val2:Ht})}ut.matrix.push(Ot)}}}else if(st==4&&ut.fmt==1)ut.markCoverage=_e._lctf.readCoverage(it,lt.readUshort(it,ot)+ct),ut.baseCoverage=_e._lctf.readCoverage(it,lt.readUshort(it,ot+2)+ct),ut.markClassCount=lt.readUshort(it,ot+4),ut.markArray=_e.GPOS.readMarkArray(it,lt.readUshort(it,ot+6)+ct),ut.baseArray=_e.GPOS.readBaseArray(it,lt.readUshort(it,ot+8)+ct,ut.markClassCount);else if(st==6&&ut.fmt==1)ut.mark1Coverage=_e._lctf.readCoverage(it,lt.readUshort(it,ot)+ct),ut.mark2Coverage=_e._lctf.readCoverage(it,lt.readUshort(it,ot+2)+ct),ut.markClassCount=lt.readUshort(it,ot+4),ut.mark1Array=_e.GPOS.readMarkArray(it,lt.readUshort(it,ot+6)+ct),ut.mark2Array=_e.GPOS.readBaseArray(it,lt.readUshort(it,ot+8)+ct,ut.markClassCount);else{if(st==9&&ut.fmt==1){var Yt=lt.readUshort(it,ot);ot+=2;var Xt=lt.readUint(it,ot);if(ot+=4,at.ltype==9)at.ltype=Yt;else if(at.ltype!=Yt)throw"invalid extension substitution";return _e.GPOS.subt(it,at.ltype,ct+Xt)}console.debug("unsupported GPOS table LookupType",st,"format",ut.fmt)}return ut},_e.GPOS.readValueRecord=function(it,st,ot){var at=_e._bin,lt=[];return lt.push(1&ot?at.readShort(it,st):0),st+=1&ot?2:0,lt.push(2&ot?at.readShort(it,st):0),st+=2&ot?2:0,lt.push(4&ot?at.readShort(it,st):0),st+=4&ot?2:0,lt.push(8&ot?at.readShort(it,st):0),st+=8&ot?2:0,lt},_e.GPOS.readBaseArray=function(it,st,ot){var at=_e._bin,lt=[],ct=st,ut=at.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++){for(var dt=[],ft=0;ft<ot;ft++)dt.push(_e.GPOS.readAnchorRecord(it,ct+at.readUshort(it,st))),st+=2;lt.push(dt)}return lt},_e.GPOS.readMarkArray=function(it,st){var ot=_e._bin,at=[],lt=st,ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=_e.GPOS.readAnchorRecord(it,ot.readUshort(it,st+2)+lt);ht.markClass=ot.readUshort(it,st),at.push(ht),st+=4}return at},_e.GPOS.readAnchorRecord=function(it,st){var ot=_e._bin,at={};return at.fmt=ot.readUshort(it,st),at.x=ot.readShort(it,st+2),at.y=ot.readShort(it,st+4),at},_e.GSUB={},_e.GSUB.parse=function(it,st,ot,at){return _e._lctf.parse(it,st,ot,at,_e.GSUB.subt)},_e.GSUB.subt=function(it,st,ot,at){var lt=_e._bin,ct=ot,ut={};if(ut.fmt=lt.readUshort(it,ot),ot+=2,st!=1&&st!=2&&st!=4&&st!=5&&st!=6)return null;if(st==1||st==2||st==4||st==5&&ut.fmt<=2||st==6&&ut.fmt<=2){var ht=lt.readUshort(it,ot);ot+=2,ut.coverage=_e._lctf.readCoverage(it,ct+ht)}if(st==1&&ut.fmt>=1&&ut.fmt<=2){if(ut.fmt==1)ut.delta=lt.readShort(it,ot),ot+=2;else if(ut.fmt==2){var dt=lt.readUshort(it,ot);ot+=2,ut.newg=lt.readUshorts(it,ot,dt),ot+=2*ut.newg.length}}else if(st==2&&ut.fmt==1){dt=lt.readUshort(it,ot),ot+=2,ut.seqs=[];for(var ft=0;ft<dt;ft++){var pt=lt.readUshort(it,ot)+ct;ot+=2;var mt=lt.readUshort(it,pt);ut.seqs.push(lt.readUshorts(it,pt+2,mt))}}else if(st==4)for(ut.vals=[],dt=lt.readUshort(it,ot),ot+=2,ft=0;ft<dt;ft++){var At=lt.readUshort(it,ot);ot+=2,ut.vals.push(_e.GSUB.readLigatureSet(it,ct+At))}else if(st==5&&ut.fmt==2){if(ut.fmt==2){var gt=lt.readUshort(it,ot);ot+=2,ut.cDef=_e._lctf.readClassDef(it,ct+gt),ut.scset=[];var bt=lt.readUshort(it,ot);for(ot+=2,ft=0;ft<bt;ft++){var Tt=lt.readUshort(it,ot);ot+=2,ut.scset.push(Tt==0?null:_e.GSUB.readSubClassSet(it,ct+Tt))}}}else if(st==6&&ut.fmt==3){if(ut.fmt==3){for(ft=0;ft<3;ft++){dt=lt.readUshort(it,ot),ot+=2;for(var wt=[],Rt=0;Rt<dt;Rt++)wt.push(_e._lctf.readCoverage(it,ct+lt.readUshort(it,ot+2*Rt)));ot+=2*dt,ft==0&&(ut.backCvg=wt),ft==1&&(ut.inptCvg=wt),ft==2&&(ut.ahedCvg=wt)}dt=lt.readUshort(it,ot),ot+=2,ut.lookupRec=_e.GSUB.readSubstLookupRecords(it,ot,dt)}}else{if(st==7&&ut.fmt==1){var It=lt.readUshort(it,ot);ot+=2;var Lt=lt.readUint(it,ot);if(ot+=4,at.ltype==9)at.ltype=It;else if(at.ltype!=It)throw"invalid extension substitution";return _e.GSUB.subt(it,at.ltype,ct+Lt)}console.debug("unsupported GSUB table LookupType",st,"format",ut.fmt)}return ut},_e.GSUB.readSubClassSet=function(it,st){var ot=_e._bin.readUshort,at=st,lt=[],ct=ot(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot(it,st);st+=2,lt.push(_e.GSUB.readSubClassRule(it,at+ht))}return lt},_e.GSUB.readSubClassRule=function(it,st){var ot=_e._bin.readUshort,at={},lt=ot(it,st),ct=ot(it,st+=2);st+=2,at.input=[];for(var ut=0;ut<lt-1;ut++)at.input.push(ot(it,st)),st+=2;return at.substLookupRecords=_e.GSUB.readSubstLookupRecords(it,st,ct),at},_e.GSUB.readSubstLookupRecords=function(it,st,ot){for(var at=_e._bin.readUshort,lt=[],ct=0;ct<ot;ct++)lt.push(at(it,st),at(it,st+2)),st+=4;return lt},_e.GSUB.readChainSubClassSet=function(it,st){var ot=_e._bin,at=st,lt=[],ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readUshort(it,st);st+=2,lt.push(_e.GSUB.readChainSubClassRule(it,at+ht))}return lt},_e.GSUB.readChainSubClassRule=function(it,st){for(var ot=_e._bin,at={},lt=["backtrack","input","lookahead"],ct=0;ct<lt.length;ct++){var ut=ot.readUshort(it,st);st+=2,ct==1&&ut--,at[lt[ct]]=ot.readUshorts(it,st,ut),st+=2*at[lt[ct]].length}return ut=ot.readUshort(it,st),st+=2,at.subst=ot.readUshorts(it,st,2*ut),st+=2*at.subst.length,at},_e.GSUB.readLigatureSet=function(it,st){var ot=_e._bin,at=st,lt=[],ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readUshort(it,st);st+=2,lt.push(_e.GSUB.readLigature(it,at+ht))}return lt},_e.GSUB.readLigature=function(it,st){var ot=_e._bin,at={chain:[]};at.nglyph=ot.readUshort(it,st),st+=2;var lt=ot.readUshort(it,st);st+=2;for(var ct=0;ct<lt-1;ct++)at.chain.push(ot.readUshort(it,st)),st+=2;return at},_e.head={},_e.head.parse=function(it,st,ot){var at=_e._bin,lt={};return at.readFixed(it,st),st+=4,lt.fontRevision=at.readFixed(it,st),st+=4,at.readUint(it,st),st+=4,at.readUint(it,st),st+=4,lt.flags=at.readUshort(it,st),st+=2,lt.unitsPerEm=at.readUshort(it,st),st+=2,lt.created=at.readUint64(it,st),st+=8,lt.modified=at.readUint64(it,st),st+=8,lt.xMin=at.readShort(it,st),st+=2,lt.yMin=at.readShort(it,st),st+=2,lt.xMax=at.readShort(it,st),st+=2,lt.yMax=at.readShort(it,st),st+=2,lt.macStyle=at.readUshort(it,st),st+=2,lt.lowestRecPPEM=at.readUshort(it,st),st+=2,lt.fontDirectionHint=at.readShort(it,st),st+=2,lt.indexToLocFormat=at.readShort(it,st),st+=2,lt.glyphDataFormat=at.readShort(it,st),st+=2,lt},_e.hhea={},_e.hhea.parse=function(it,st,ot){var at=_e._bin,lt={};return at.readFixed(it,st),st+=4,lt.ascender=at.readShort(it,st),st+=2,lt.descender=at.readShort(it,st),st+=2,lt.lineGap=at.readShort(it,st),st+=2,lt.advanceWidthMax=at.readUshort(it,st),st+=2,lt.minLeftSideBearing=at.readShort(it,st),st+=2,lt.minRightSideBearing=at.readShort(it,st),st+=2,lt.xMaxExtent=at.readShort(it,st),st+=2,lt.caretSlopeRise=at.readShort(it,st),st+=2,lt.caretSlopeRun=at.readShort(it,st),st+=2,lt.caretOffset=at.readShort(it,st),st+=2,st+=8,lt.metricDataFormat=at.readShort(it,st),st+=2,lt.numberOfHMetrics=at.readUshort(it,st),st+=2,lt},_e.hmtx={},_e.hmtx.parse=function(it,st,ot,at){for(var lt=_e._bin,ct={aWidth:[],lsBearing:[]},ut=0,ht=0,dt=0;dt<at.maxp.numGlyphs;dt++)dt<at.hhea.numberOfHMetrics&&(ut=lt.readUshort(it,st),st+=2,ht=lt.readShort(it,st),st+=2),ct.aWidth.push(ut),ct.lsBearing.push(ht);return ct},_e.kern={},_e.kern.parse=function(it,st,ot,at){var lt=_e._bin,ct=lt.readUshort(it,st);if(st+=2,ct==1)return _e.kern.parseV1(it,st-2,ot,at);var ut=lt.readUshort(it,st);st+=2;for(var ht={glyph1:[],rval:[]},dt=0;dt<ut;dt++){st+=2,ot=lt.readUshort(it,st),st+=2;var ft=lt.readUshort(it,st);st+=2;var pt=ft>>>8;if((pt&=15)!=0)throw"unknown kern table format: "+pt;st=_e.kern.readFormat0(it,st,ht)}return ht},_e.kern.parseV1=function(it,st,ot,at){var lt=_e._bin;lt.readFixed(it,st),st+=4;var ct=lt.readUint(it,st);st+=4;for(var ut={glyph1:[],rval:[]},ht=0;ht<ct;ht++){lt.readUint(it,st),st+=4;var dt=lt.readUshort(it,st);st+=2,lt.readUshort(it,st),st+=2;var ft=dt>>>8;if((ft&=15)!=0)throw"unknown kern table format: "+ft;st=_e.kern.readFormat0(it,st,ut)}return ut},_e.kern.readFormat0=function(it,st,ot){var at=_e._bin,lt=-1,ct=at.readUshort(it,st);st+=2,at.readUshort(it,st),st+=2,at.readUshort(it,st),st+=2,at.readUshort(it,st),st+=2;for(var ut=0;ut<ct;ut++){var ht=at.readUshort(it,st);st+=2;var dt=at.readUshort(it,st);st+=2;var ft=at.readShort(it,st);st+=2,ht!=lt&&(ot.glyph1.push(ht),ot.rval.push({glyph2:[],vals:[]}));var pt=ot.rval[ot.rval.length-1];pt.glyph2.push(dt),pt.vals.push(ft),lt=ht}return st},_e.loca={},_e.loca.parse=function(it,st,ot,at){var lt=_e._bin,ct=[],ut=at.head.indexToLocFormat,ht=at.maxp.numGlyphs+1;if(ut==0)for(var dt=0;dt<ht;dt++)ct.push(lt.readUshort(it,st+(dt<<1))<<1);if(ut==1)for(dt=0;dt<ht;dt++)ct.push(lt.readUint(it,st+(dt<<2)));return ct},_e.maxp={},_e.maxp.parse=function(it,st,ot){var at=_e._bin,lt={},ct=at.readUint(it,st);return st+=4,lt.numGlyphs=at.readUshort(it,st),st+=2,ct==65536&&(lt.maxPoints=at.readUshort(it,st),st+=2,lt.maxContours=at.readUshort(it,st),st+=2,lt.maxCompositePoints=at.readUshort(it,st),st+=2,lt.maxCompositeContours=at.readUshort(it,st),st+=2,lt.maxZones=at.readUshort(it,st),st+=2,lt.maxTwilightPoints=at.readUshort(it,st),st+=2,lt.maxStorage=at.readUshort(it,st),st+=2,lt.maxFunctionDefs=at.readUshort(it,st),st+=2,lt.maxInstructionDefs=at.readUshort(it,st),st+=2,lt.maxStackElements=at.readUshort(it,st),st+=2,lt.maxSizeOfInstructions=at.readUshort(it,st),st+=2,lt.maxComponentElements=at.readUshort(it,st),st+=2,lt.maxComponentDepth=at.readUshort(it,st),st+=2),lt},_e.name={},_e.name.parse=function(it,st,ot){var at=_e._bin,lt={};at.readUshort(it,st),st+=2;var ct=at.readUshort(it,st);st+=2,at.readUshort(it,st);for(var ut,ht=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],dt=st+=2,ft=0;ft<ct;ft++){var pt=at.readUshort(it,st);st+=2;var mt=at.readUshort(it,st);st+=2;var At=at.readUshort(it,st);st+=2;var gt=at.readUshort(it,st);st+=2;var bt=at.readUshort(it,st);st+=2;var Tt=at.readUshort(it,st);st+=2;var wt,Rt=ht[gt],It=dt+12*ct+Tt;if(pt==0)wt=at.readUnicode(it,It,bt/2);else if(pt==3&&mt==0)wt=at.readUnicode(it,It,bt/2);else if(mt==0)wt=at.readASCII(it,It,bt);else if(mt==1)wt=at.readUnicode(it,It,bt/2);else if(mt==3)wt=at.readUnicode(it,It,bt/2);else{if(pt!=1)throw"unknown encoding "+mt+", platformID: "+pt;wt=at.readASCII(it,It,bt),console.debug("reading unknown MAC encoding "+mt+" as ASCII")}var Lt="p"+pt+","+At.toString(16);lt[Lt]==null&&(lt[Lt]={}),lt[Lt][Rt!==void 0?Rt:gt]=wt,lt[Lt]._lang=At}for(var $t in lt)if(lt[$t].postScriptName!=null&&lt[$t]._lang==1033)return lt[$t];for(var $t in lt)if(lt[$t].postScriptName!=null&&lt[$t]._lang==0)return lt[$t];for(var $t in lt)if(lt[$t].postScriptName!=null&&lt[$t]._lang==3084)return lt[$t];for(var $t in lt)if(lt[$t].postScriptName!=null)return lt[$t];for(var $t in lt){ut=$t;break}return console.debug("returning name table with languageID "+lt[ut]._lang),lt[ut]},_e["OS/2"]={},_e["OS/2"].parse=function(it,st,ot){var at=_e._bin.readUshort(it,st);st+=2;var lt={};if(at==0)_e["OS/2"].version0(it,st,lt);else if(at==1)_e["OS/2"].version1(it,st,lt);else if(at==2||at==3||at==4)_e["OS/2"].version2(it,st,lt);else{if(at!=5)throw"unknown OS/2 table version: "+at;_e["OS/2"].version5(it,st,lt)}return lt},_e["OS/2"].version0=function(it,st,ot){var at=_e._bin;return ot.xAvgCharWidth=at.readShort(it,st),st+=2,ot.usWeightClass=at.readUshort(it,st),st+=2,ot.usWidthClass=at.readUshort(it,st),st+=2,ot.fsType=at.readUshort(it,st),st+=2,ot.ySubscriptXSize=at.readShort(it,st),st+=2,ot.ySubscriptYSize=at.readShort(it,st),st+=2,ot.ySubscriptXOffset=at.readShort(it,st),st+=2,ot.ySubscriptYOffset=at.readShort(it,st),st+=2,ot.ySuperscriptXSize=at.readShort(it,st),st+=2,ot.ySuperscriptYSize=at.readShort(it,st),st+=2,ot.ySuperscriptXOffset=at.readShort(it,st),st+=2,ot.ySuperscriptYOffset=at.readShort(it,st),st+=2,ot.yStrikeoutSize=at.readShort(it,st),st+=2,ot.yStrikeoutPosition=at.readShort(it,st),st+=2,ot.sFamilyClass=at.readShort(it,st),st+=2,ot.panose=at.readBytes(it,st,10),st+=10,ot.ulUnicodeRange1=at.readUint(it,st),st+=4,ot.ulUnicodeRange2=at.readUint(it,st),st+=4,ot.ulUnicodeRange3=at.readUint(it,st),st+=4,ot.ulUnicodeRange4=at.readUint(it,st),st+=4,ot.achVendID=[at.readInt8(it,st),at.readInt8(it,st+1),at.readInt8(it,st+2),at.readInt8(it,st+3)],st+=4,ot.fsSelection=at.readUshort(it,st),st+=2,ot.usFirstCharIndex=at.readUshort(it,st),st+=2,ot.usLastCharIndex=at.readUshort(it,st),st+=2,ot.sTypoAscender=at.readShort(it,st),st+=2,ot.sTypoDescender=at.readShort(it,st),st+=2,ot.sTypoLineGap=at.readShort(it,st),st+=2,ot.usWinAscent=at.readUshort(it,st),st+=2,ot.usWinDescent=at.readUshort(it,st),st+=2},_e["OS/2"].version1=function(it,st,ot){var at=_e._bin;return st=_e["OS/2"].version0(it,st,ot),ot.ulCodePageRange1=at.readUint(it,st),st+=4,ot.ulCodePageRange2=at.readUint(it,st),st+=4},_e["OS/2"].version2=function(it,st,ot){var at=_e._bin;return st=_e["OS/2"].version1(it,st,ot),ot.sxHeight=at.readShort(it,st),st+=2,ot.sCapHeight=at.readShort(it,st),st+=2,ot.usDefault=at.readUshort(it,st),st+=2,ot.usBreak=at.readUshort(it,st),st+=2,ot.usMaxContext=at.readUshort(it,st),st+=2},_e["OS/2"].version5=function(it,st,ot){var at=_e._bin;return st=_e["OS/2"].version2(it,st,ot),ot.usLowerOpticalPointSize=at.readUshort(it,st),st+=2,ot.usUpperOpticalPointSize=at.readUshort(it,st),st+=2},_e.post={},_e.post.parse=function(it,st,ot){var at=_e._bin,lt={};return lt.version=at.readFixed(it,st),st+=4,lt.italicAngle=at.readFixed(it,st),st+=4,lt.underlinePosition=at.readShort(it,st),st+=2,lt.underlineThickness=at.readShort(it,st),st+=2,lt},_e==null&&(_e={}),_e.U==null&&(_e.U={}),_e.U.codeToGlyph=function(it,st){var ot=it.cmap,at=-1;if(ot.p0e4!=null?at=ot.p0e4:ot.p3e1!=null?at=ot.p3e1:ot.p1e0!=null?at=ot.p1e0:ot.p0e3!=null&&(at=ot.p0e3),at==-1)throw"no familiar platform and encoding!";var lt=ot.tables[at];if(lt.format==0)return st>=lt.map.length?0:lt.map[st];if(lt.format==4){for(var ct=-1,ut=0;ut<lt.endCount.length;ut++)if(st<=lt.endCount[ut]){ct=ut;break}return ct==-1||lt.startCount[ct]>st?0:65535&(lt.idRangeOffset[ct]!=0?lt.glyphIdArray[st-lt.startCount[ct]+(lt.idRangeOffset[ct]>>1)-(lt.idRangeOffset.length-ct)]:st+lt.idDelta[ct])}if(lt.format==12){if(st>lt.groups[lt.groups.length-1][1])return 0;for(ut=0;ut<lt.groups.length;ut++){var ht=lt.groups[ut];if(ht[0]<=st&&st<=ht[1])return ht[2]+(st-ht[0])}return 0}throw"unknown cmap table format "+lt.format},_e.U.glyphToPath=function(it,st){var ot={cmds:[],crds:[]};if(it.SVG&&it.SVG.entries[st]){var at=it.SVG.entries[st];return at==null?ot:(typeof at=="string"&&(at=_e.SVG.toPath(at),it.SVG.entries[st]=at),at)}if(it.CFF){var lt={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:it.CFF.Private?it.CFF.Private.defaultWidthX:0,open:!1},ct=it.CFF,ut=it.CFF.Private;if(ct.ROS){for(var ht=0;ct.FDSelect[ht+2]<=st;)ht+=2;ut=ct.FDArray[ct.FDSelect[ht+1]].Private}_e.U._drawCFF(it.CFF.CharStrings[st],lt,ct,ut,ot)}else it.glyf&&_e.U._drawGlyf(st,it,ot);return ot},_e.U._drawGlyf=function(it,st,ot){var at=st.glyf[it];at==null&&(at=st.glyf[it]=_e.glyf._parseGlyf(st,it)),at!=null&&(at.noc>-1?_e.U._simpleGlyph(at,ot):_e.U._compoGlyph(at,st,ot))},_e.U._simpleGlyph=function(it,st){for(var ot=0;ot<it.noc;ot++){for(var at=ot==0?0:it.endPts[ot-1]+1,lt=it.endPts[ot],ct=at;ct<=lt;ct++){var ut=ct==at?lt:ct-1,ht=ct==lt?at:ct+1,dt=1&it.flags[ct],ft=1&it.flags[ut],pt=1&it.flags[ht],mt=it.xs[ct],At=it.ys[ct];if(ct==at)if(dt){if(!ft){_e.U.P.moveTo(st,mt,At);continue}_e.U.P.moveTo(st,it.xs[ut],it.ys[ut])}else ft?_e.U.P.moveTo(st,it.xs[ut],it.ys[ut]):_e.U.P.moveTo(st,(it.xs[ut]+mt)/2,(it.ys[ut]+At)/2);dt?ft&&_e.U.P.lineTo(st,mt,At):pt?_e.U.P.qcurveTo(st,mt,At,it.xs[ht],it.ys[ht]):_e.U.P.qcurveTo(st,mt,At,(mt+it.xs[ht])/2,(At+it.ys[ht])/2)}_e.U.P.closePath(st)}},_e.U._compoGlyph=function(it,st,ot){for(var at=0;at<it.parts.length;at++){var lt={cmds:[],crds:[]},ct=it.parts[at];_e.U._drawGlyf(ct.glyphIndex,st,lt);for(var ut=ct.m,ht=0;ht<lt.crds.length;ht+=2){var dt=lt.crds[ht],ft=lt.crds[ht+1];ot.crds.push(dt*ut.a+ft*ut.b+ut.tx),ot.crds.push(dt*ut.c+ft*ut.d+ut.ty)}for(ht=0;ht<lt.cmds.length;ht++)ot.cmds.push(lt.cmds[ht])}},_e.U._getGlyphClass=function(it,st){var ot=_e._lctf.getInterval(st,it);return ot==-1?0:st[ot+2]},_e.U._applySubs=function(it,st,ot,at){for(var lt=it.length-st-1,ct=0;ct<ot.tabs.length;ct++)if(ot.tabs[ct]!=null){var ut,ht=ot.tabs[ct];if(!ht.coverage||(ut=_e._lctf.coverageIndex(ht.coverage,it[st]))!=-1){if(ot.ltype==1)it[st],ht.fmt==1?it[st]=it[st]+ht.delta:it[st]=ht.newg[ut];else if(ot.ltype==4)for(var dt=ht.vals[ut],ft=0;ft<dt.length;ft++){var pt=dt[ft],mt=pt.chain.length;if(!(mt>lt)){for(var At=!0,gt=0,bt=0;bt<mt;bt++){for(;it[st+gt+(1+bt)]==-1;)gt++;pt.chain[bt]!=it[st+gt+(1+bt)]&&(At=!1)}if(At){for(it[st]=pt.nglyph,bt=0;bt<mt+gt;bt++)it[st+bt+1]=-1;break}}}else if(ot.ltype==5&&ht.fmt==2)for(var Tt=_e._lctf.getInterval(ht.cDef,it[st]),wt=ht.cDef[Tt+2],Rt=ht.scset[wt],It=0;It<Rt.length;It++){var Lt=Rt[It],$t=Lt.input;if(!($t.length>lt)){for(At=!0,bt=0;bt<$t.length;bt++){var kt=_e._lctf.getInterval(ht.cDef,it[st+1+bt]);if(Tt==-1&&ht.cDef[kt+2]!=$t[bt]){At=!1;break}}if(At){var Dt=Lt.substLookupRecords;for(ft=0;ft<Dt.length;ft+=2)Dt[ft],Dt[ft+1]}}}else if(ot.ltype==6&&ht.fmt==3){if(!_e.U._glsCovered(it,ht.backCvg,st-ht.backCvg.length)||!_e.U._glsCovered(it,ht.inptCvg,st)||!_e.U._glsCovered(it,ht.ahedCvg,st+ht.inptCvg.length))continue;var Ot=ht.lookupRec;for(It=0;It<Ot.length;It+=2){Tt=Ot[It];var zt=at[Ot[It+1]];_e.U._applySubs(it,st+Tt,zt,at)}}}}},_e.U._glsCovered=function(it,st,ot){for(var at=0;at<st.length;at++)if(_e._lctf.coverageIndex(st[at],it[ot+at])==-1)return!1;return!0},_e.U.glyphsToPath=function(it,st,ot){for(var at={cmds:[],crds:[]},lt=0,ct=0;ct<st.length;ct++){var ut=st[ct];if(ut!=-1){for(var ht=ct<st.length-1&&st[ct+1]!=-1?st[ct+1]:0,dt=_e.U.glyphToPath(it,ut),ft=0;ft<dt.crds.length;ft+=2)at.crds.push(dt.crds[ft]+lt),at.crds.push(dt.crds[ft+1]);for(ot&&at.cmds.push(ot),ft=0;ft<dt.cmds.length;ft++)at.cmds.push(dt.cmds[ft]);ot&&at.cmds.push("X"),lt+=it.hmtx.aWidth[ut],ct<st.length-1&&(lt+=_e.U.getPairAdjustment(it,ut,ht))}}return at},_e.U.P={},_e.U.P.moveTo=function(it,st,ot){it.cmds.push("M"),it.crds.push(st,ot)},_e.U.P.lineTo=function(it,st,ot){it.cmds.push("L"),it.crds.push(st,ot)},_e.U.P.curveTo=function(it,st,ot,at,lt,ct,ut){it.cmds.push("C"),it.crds.push(st,ot,at,lt,ct,ut)},_e.U.P.qcurveTo=function(it,st,ot,at,lt){it.cmds.push("Q"),it.crds.push(st,ot,at,lt)},_e.U.P.closePath=function(it){it.cmds.push("Z")},_e.U._drawCFF=function(it,st,ot,at,lt){for(var ct=st.stack,ut=st.nStems,ht=st.haveWidth,dt=st.width,ft=st.open,pt=0,mt=st.x,At=st.y,gt=0,bt=0,Tt=0,wt=0,Rt=0,It=0,Lt=0,$t=0,kt=0,Dt=0,Ot={val:0,size:0};pt<it.length;){_e.CFF.getCharString(it,pt,Ot);var zt=Ot.val;if(pt+=Ot.size,zt=="o1"||zt=="o18")ct.length%2!=0&&!ht&&(dt=ct.shift()+at.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0;else if(zt=="o3"||zt=="o23")ct.length%2!=0&&!ht&&(dt=ct.shift()+at.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0;else if(zt=="o4")ct.length>1&&!ht&&(dt=ct.shift()+at.nominalWidthX,ht=!0),ft&&_e.U.P.closePath(lt),At+=ct.pop(),_e.U.P.moveTo(lt,mt,At),ft=!0;else if(zt=="o5")for(;ct.length>0;)mt+=ct.shift(),At+=ct.shift(),_e.U.P.lineTo(lt,mt,At);else if(zt=="o6"||zt=="o7")for(var Ht=ct.length,Yt=zt=="o6",Xt=0;Xt<Ht;Xt++){var Zt=ct.shift();Yt?mt+=Zt:At+=Zt,Yt=!Yt,_e.U.P.lineTo(lt,mt,At)}else if(zt=="o8"||zt=="o24"){Ht=ct.length;for(var rn=0;rn+6<=Ht;)gt=mt+ct.shift(),bt=At+ct.shift(),Tt=gt+ct.shift(),wt=bt+ct.shift(),mt=Tt+ct.shift(),At=wt+ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,mt,At),rn+=6;zt=="o24"&&(mt+=ct.shift(),At+=ct.shift(),_e.U.P.lineTo(lt,mt,At))}else{if(zt=="o11")break;if(zt=="o1234"||zt=="o1235"||zt=="o1236"||zt=="o1237")zt=="o1234"&&(bt=At,Tt=(gt=mt+ct.shift())+ct.shift(),Dt=wt=bt+ct.shift(),It=wt,$t=At,mt=(Lt=(Rt=(kt=Tt+ct.shift())+ct.shift())+ct.shift())+ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,kt,Dt),_e.U.P.curveTo(lt,Rt,It,Lt,$t,mt,At)),zt=="o1235"&&(gt=mt+ct.shift(),bt=At+ct.shift(),Tt=gt+ct.shift(),wt=bt+ct.shift(),kt=Tt+ct.shift(),Dt=wt+ct.shift(),Rt=kt+ct.shift(),It=Dt+ct.shift(),Lt=Rt+ct.shift(),$t=It+ct.shift(),mt=Lt+ct.shift(),At=$t+ct.shift(),ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,kt,Dt),_e.U.P.curveTo(lt,Rt,It,Lt,$t,mt,At)),zt=="o1236"&&(gt=mt+ct.shift(),bt=At+ct.shift(),Tt=gt+ct.shift(),Dt=wt=bt+ct.shift(),It=wt,Lt=(Rt=(kt=Tt+ct.shift())+ct.shift())+ct.shift(),$t=It+ct.shift(),mt=Lt+ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,kt,Dt),_e.U.P.curveTo(lt,Rt,It,Lt,$t,mt,At)),zt=="o1237"&&(gt=mt+ct.shift(),bt=At+ct.shift(),Tt=gt+ct.shift(),wt=bt+ct.shift(),kt=Tt+ct.shift(),Dt=wt+ct.shift(),Rt=kt+ct.shift(),It=Dt+ct.shift(),Lt=Rt+ct.shift(),$t=It+ct.shift(),Math.abs(Lt-mt)>Math.abs($t-At)?mt=Lt+ct.shift():At=$t+ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,kt,Dt),_e.U.P.curveTo(lt,Rt,It,Lt,$t,mt,At));else if(zt=="o14"){if(ct.length>0&&!ht&&(dt=ct.shift()+ot.nominalWidthX,ht=!0),ct.length==4){var Gt=ct.shift(),jt=ct.shift(),Kt=ct.shift(),Jt=ct.shift(),sn=_e.CFF.glyphBySE(ot,Kt),hn=_e.CFF.glyphBySE(ot,Jt);_e.U._drawCFF(ot.CharStrings[sn],st,ot,at,lt),st.x=Gt,st.y=jt,_e.U._drawCFF(ot.CharStrings[hn],st,ot,at,lt)}ft&&(_e.U.P.closePath(lt),ft=!1)}else if(zt=="o19"||zt=="o20")ct.length%2!=0&&!ht&&(dt=ct.shift()+at.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0,pt+=ut+7>>3;else if(zt=="o21")ct.length>2&&!ht&&(dt=ct.shift()+at.nominalWidthX,ht=!0),At+=ct.pop(),mt+=ct.pop(),ft&&_e.U.P.closePath(lt),_e.U.P.moveTo(lt,mt,At),ft=!0;else if(zt=="o22")ct.length>1&&!ht&&(dt=ct.shift()+at.nominalWidthX,ht=!0),mt+=ct.pop(),ft&&_e.U.P.closePath(lt),_e.U.P.moveTo(lt,mt,At),ft=!0;else if(zt=="o25"){for(;ct.length>6;)mt+=ct.shift(),At+=ct.shift(),_e.U.P.lineTo(lt,mt,At);gt=mt+ct.shift(),bt=At+ct.shift(),Tt=gt+ct.shift(),wt=bt+ct.shift(),mt=Tt+ct.shift(),At=wt+ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,mt,At)}else if(zt=="o26")for(ct.length%2&&(mt+=ct.shift());ct.length>0;)gt=mt,bt=At+ct.shift(),mt=Tt=gt+ct.shift(),At=(wt=bt+ct.shift())+ct.shift(),_e.U.P.curveTo(lt,gt,bt,Tt,wt,mt,At);else if(zt=="o27")for(ct.length%2&&(At+=ct.shift());ct.length>0;)bt=At,Tt=(gt=mt+ct.shift())+ct.shift(),wt=bt+ct.shift(),mt=Tt+ct.shift(),At=wt,_e.U.P.curveTo(lt,gt,bt,Tt,wt,mt,At);else if(zt=="o10"||zt=="o29"){var an=zt=="o10"?at:ot;if(ct.length==0)console.debug("error: empty stack");else{var pn=ct.pop(),_n=an.Subrs[pn+an.Bias];st.x=mt,st.y=At,st.nStems=ut,st.haveWidth=ht,st.width=dt,st.open=ft,_e.U._drawCFF(_n,st,ot,at,lt),mt=st.x,At=st.y,ut=st.nStems,ht=st.haveWidth,dt=st.width,ft=st.open}}else if(zt=="o30"||zt=="o31"){var yn=ct.length,$n=(rn=0,zt=="o31");for(rn+=yn-(Ht=-3&yn);rn<Ht;)$n?(bt=At,Tt=(gt=mt+ct.shift())+ct.shift(),At=(wt=bt+ct.shift())+ct.shift(),Ht-rn==5?(mt=Tt+ct.shift(),rn++):mt=Tt,$n=!1):(gt=mt,bt=At+ct.shift(),Tt=gt+ct.shift(),wt=bt+ct.shift(),mt=Tt+ct.shift(),Ht-rn==5?(At=wt+ct.shift(),rn++):At=wt,$n=!0),_e.U.P.curveTo(lt,gt,bt,Tt,wt,mt,At),rn+=4}else{if((zt+"").charAt(0)=="o")throw console.debug("Unknown operation: "+zt,it),zt;ct.push(zt)}}}st.x=mt,st.y=At,st.nStems=ut,st.haveWidth=ht,st.width=dt,st.open=ft};var et=_e,rt={Typr:et};return nt.Typr=et,nt.default=rt,Object.defineProperty(nt,"__esModule",{value:!0}),nt}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function woff2otfFactory(){return function(nt){var _e=Uint8Array,et=Uint16Array,rt=Uint32Array,it=new _e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),st=new _e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ot=new _e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),at=function(zt,Ht){for(var Yt=new et(31),Xt=0;Xt<31;++Xt)Yt[Xt]=Ht+=1<<zt[Xt-1];var Zt=new rt(Yt[30]);for(Xt=1;Xt<30;++Xt)for(var rn=Yt[Xt];rn<Yt[Xt+1];++rn)Zt[rn]=rn-Yt[Xt]<<5|Xt;return[Yt,Zt]},lt=at(it,2),ct=lt[0],ut=lt[1];ct[28]=258,ut[258]=28;for(var ht=at(st,0)[0],dt=new et(32768),ft=0;ft<32768;++ft){var pt=(43690&ft)>>>1|(21845&ft)<<1;pt=(61680&(pt=(52428&pt)>>>2|(13107&pt)<<2))>>>4|(3855&pt)<<4,dt[ft]=((65280&pt)>>>8|(255&pt)<<8)>>>1}var mt=function(zt,Ht,Yt){for(var Xt=zt.length,Zt=0,rn=new et(Ht);Zt<Xt;++Zt)++rn[zt[Zt]-1];var Gt,jt=new et(Ht);for(Zt=0;Zt<Ht;++Zt)jt[Zt]=jt[Zt-1]+rn[Zt-1]<<1;{Gt=new et(1<<Ht);var Kt=15-Ht;for(Zt=0;Zt<Xt;++Zt)if(zt[Zt])for(var Jt=Zt<<4|zt[Zt],sn=Ht-zt[Zt],hn=jt[zt[Zt]-1]++<<sn,an=hn|(1<<sn)-1;hn<=an;++hn)Gt[dt[hn]>>>Kt]=Jt}return Gt},At=new _e(288);for(ft=0;ft<144;++ft)At[ft]=8;for(ft=144;ft<256;++ft)At[ft]=9;for(ft=256;ft<280;++ft)At[ft]=7;for(ft=280;ft<288;++ft)At[ft]=8;var gt=new _e(32);for(ft=0;ft<32;++ft)gt[ft]=5;var bt=mt(At,9),Tt=mt(gt,5),wt=function(zt){for(var Ht=zt[0],Yt=1;Yt<zt.length;++Yt)zt[Yt]>Ht&&(Ht=zt[Yt]);return Ht},Rt=function(zt,Ht,Yt){var Xt=Ht/8|0;return(zt[Xt]|zt[Xt+1]<<8)>>(7&Ht)&Yt},It=function(zt,Ht){var Yt=Ht/8|0;return(zt[Yt]|zt[Yt+1]<<8|zt[Yt+2]<<16)>>(7&Ht)},Lt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$t=function(zt,Ht,Yt){var Xt=new Error(Ht||Lt[zt]);if(Xt.code=zt,Error.captureStackTrace&&Error.captureStackTrace(Xt,$t),!Yt)throw Xt;return Xt},kt=function(zt,Ht,Yt){var Xt=zt.length;if(!Xt||Yt&&!Yt.l&&Xt<5)return Ht||new _e(0);var Zt=!Ht||Yt,rn=!Yt||Yt.i;Yt||(Yt={}),Ht||(Ht=new _e(3*Xt));var Gt,jt=function(vn){var qn=Ht.length;if(vn>qn){var vr=new _e(Math.max(2*qn,vn));vr.set(Ht),Ht=vr}},Kt=Yt.f||0,Jt=Yt.p||0,sn=Yt.b||0,hn=Yt.l,an=Yt.d,pn=Yt.m,_n=Yt.n,yn=8*Xt;do{if(!hn){Yt.f=Kt=Rt(zt,Jt,1);var $n=Rt(zt,Jt+1,3);if(Jt+=3,!$n){var Jn=zt[(un=((Gt=Jt)/8|0)+(7&Gt&&1)+4)-4]|zt[un-3]<<8,Xn=un+Jn;if(Xn>Xt){rn&&$t(0);break}Zt&&jt(sn+Jn),Ht.set(zt.subarray(un,Xn),sn),Yt.b=sn+=Jn,Yt.p=Jt=8*Xn;continue}if($n==1)hn=bt,an=Tt,pn=9,_n=5;else if($n==2){var Vn=Rt(zt,Jt,31)+257,En=Rt(zt,Jt+10,15)+4,dn=Vn+Rt(zt,Jt+5,31)+1;Jt+=14;for(var rr=new _e(dn),er=new _e(19),Yn=0;Yn<En;++Yn)er[ot[Yn]]=Rt(zt,Jt+3*Yn,7);Jt+=3*En;var ir=wt(er),Qn=(1<<ir)-1,sr=mt(er,ir);for(Yn=0;Yn<dn;){var un,en=sr[Rt(zt,Jt,Qn)];if(Jt+=15&en,(un=en>>>4)<16)rr[Yn++]=un;else{var wn=0,gn=0;for(un==16?(gn=3+Rt(zt,Jt,3),Jt+=2,wn=rr[Yn-1]):un==17?(gn=3+Rt(zt,Jt,7),Jt+=3):un==18&&(gn=11+Rt(zt,Jt,127),Jt+=7);gn--;)rr[Yn++]=wn}}var Mn=rr.subarray(0,Vn),In=rr.subarray(Vn);pn=wt(Mn),_n=wt(In),hn=mt(Mn,pn),an=mt(In,_n)}else $t(1);if(Jt>yn){rn&&$t(0);break}}Zt&&jt(sn+131072);for(var gr=(1<<pn)-1,jn=(1<<_n)-1,hr=Jt;;hr=Jt){var Tr=(wn=hn[It(zt,Jt)&gr])>>>4;if((Jt+=15&wn)>yn){rn&&$t(0);break}if(wn||$t(2),Tr<256)Ht[sn++]=Tr;else{if(Tr==256){hr=Jt,hn=null;break}var cr=Tr-254;if(Tr>264){var yr=it[Yn=Tr-257];cr=Rt(zt,Jt,(1<<yr)-1)+ct[Yn],Jt+=yr}var Rr=an[It(zt,Jt)&jn],br=Rr>>>4;if(Rr||$t(3),Jt+=15&Rr,In=ht[br],br>3&&(yr=st[br],In+=It(zt,Jt)&(1<<yr)-1,Jt+=yr),Jt>yn){rn&&$t(0);break}Zt&&jt(sn+131072);for(var pr=sn+cr;sn<pr;sn+=4)Ht[sn]=Ht[sn-In],Ht[sn+1]=Ht[sn+1-In],Ht[sn+2]=Ht[sn+2-In],Ht[sn+3]=Ht[sn+3-In];sn=pr}}Yt.l=hn,Yt.p=hr,Yt.b=sn,hn&&(Kt=1,Yt.m=pn,Yt.d=an,Yt.n=_n)}while(!Kt);return sn==Ht.length?Ht:function(vn,qn,vr){(vr==null||vr>vn.length)&&(vr=vn.length);var Sn=new(vn instanceof et?et:vn instanceof rt?rt:_e)(vr-qn);return Sn.set(vn.subarray(qn,vr)),Sn}(Ht,0,sn)},Dt=new _e(0),Ot=typeof TextDecoder<"u"&&new TextDecoder;try{Ot.decode(Dt,{stream:!0})}catch{}return nt.convert_streams=function(zt){var Ht=new DataView(zt),Yt=0;function Xt(){var Vn=Ht.getUint16(Yt);return Yt+=2,Vn}function Zt(){var Vn=Ht.getUint32(Yt);return Yt+=4,Vn}function rn(Vn){Jn.setUint16(Xn,Vn),Xn+=2}function Gt(Vn){Jn.setUint32(Xn,Vn),Xn+=4}for(var jt={signature:Zt(),flavor:Zt(),length:Zt(),numTables:Xt(),reserved:Xt(),totalSfntSize:Zt(),majorVersion:Xt(),minorVersion:Xt(),metaOffset:Zt(),metaLength:Zt(),metaOrigLength:Zt(),privOffset:Zt(),privLength:Zt()},Kt=0;Math.pow(2,Kt)<=jt.numTables;)Kt++;Kt--;for(var Jt=16*Math.pow(2,Kt),sn=16*jt.numTables-Jt,hn=12,an=[],pn=0;pn<jt.numTables;pn++)an.push({tag:Zt(),offset:Zt(),compLength:Zt(),origLength:Zt(),origChecksum:Zt()}),hn+=16;var _n,yn=new Uint8Array(12+16*an.length+an.reduce(function(Vn,En){return Vn+En.origLength+4},0)),$n=yn.buffer,Jn=new DataView($n),Xn=0;return Gt(jt.flavor),rn(jt.numTables),rn(Jt),rn(Kt),rn(sn),an.forEach(function(Vn){Gt(Vn.tag),Gt(Vn.origChecksum),Gt(hn),Gt(Vn.origLength),Vn.outOffset=hn,(hn+=Vn.origLength)%4!=0&&(hn+=4-hn%4)}),an.forEach(function(Vn){var En,dn=zt.slice(Vn.offset,Vn.offset+Vn.compLength);if(Vn.compLength!=Vn.origLength){var rr=new Uint8Array(Vn.origLength);En=new Uint8Array(dn,2),kt(En,rr)}else rr=new Uint8Array(dn);yn.set(rr,Vn.outOffset);var er=0;(hn=Vn.outOffset+Vn.origLength)%4!=0&&(er=4-hn%4),yn.set(new Uint8Array(er).buffer,Vn.outOffset+Vn.origLength),_n=hn+er}),$n.slice(0,_n)},Object.defineProperty(nt,"__esModule",{value:!0}),nt}({}).convert_streams}function parserFactory(nt,_e){const et={M:2,L:2,Q:4,C:6,Z:0},rt={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},it=1,st=2,ot=4,at=8,lt=16,ct=32;let ut;function ht(Lt){if(!ut){const $t={R:st,L:it,D:ot,C:lt,U:ct,T:at};ut=new Map;for(let kt in rt){let Dt=0;rt[kt].split(",").forEach(Ot=>{let[zt,Ht]=Ot.split("+");zt=parseInt(zt,36),Ht=Ht?parseInt(Ht,36):0,ut.set(Dt+=zt,$t[kt]);for(let Yt=Ht;Yt--;)ut.set(++Dt,$t[kt])})}}return ut.get(Lt)||ct}const dt=1,ft=2,pt=3,mt=4,At=[null,"isol","init","fina","medi"];function gt(Lt){const $t=new Uint8Array(Lt.length);let kt=ct,Dt=dt,Ot=-1;for(let zt=0;zt<Lt.length;zt++){const Ht=Lt.codePointAt(zt);let Yt=ht(Ht)|0,Xt=dt;Yt&at||(kt&(it|ot|lt)?Yt&(st|ot|lt)?(Xt=pt,(Dt===dt||Dt===pt)&&$t[Ot]++):Yt&(it|ct)&&(Dt===ft||Dt===mt)&&$t[Ot]--:kt&(st|ct)&&(Dt===ft||Dt===mt)&&$t[Ot]--,Dt=$t[zt]=Xt,kt=Yt,Ot=zt,Ht>65535&&zt++)}return $t}function bt(Lt,$t){const kt=[];for(let Ot=0;Ot<$t.length;Ot++){const zt=$t.codePointAt(Ot);zt>65535&&Ot++,kt.push(nt.U.codeToGlyph(Lt,zt))}const Dt=Lt.GSUB;if(Dt){const{lookupList:Ot,featureList:zt}=Dt;let Ht;const Yt=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,Xt=[];zt.forEach(Zt=>{if(Yt.test(Zt.tag))for(let rn=0;rn<Zt.tab.length;rn++){if(Xt[Zt.tab[rn]])continue;Xt[Zt.tab[rn]]=!0;const Gt=Ot[Zt.tab[rn]],jt=/^(isol|init|fina|medi)$/.test(Zt.tag);jt&&!Ht&&(Ht=gt($t));for(let Kt=0;Kt<kt.length;Kt++)(!Ht||!jt||At[Ht[Kt]]===Zt.tag)&&nt.U._applySubs(kt,Kt,Gt,Ot)}})}return kt}function Tt(Lt,$t){const kt=new Int16Array($t.length*3);let Dt=0;for(;Dt<$t.length;Dt++){const Yt=$t[Dt];if(Yt===-1)continue;kt[Dt*3+2]=Lt.hmtx.aWidth[Yt];const Xt=Lt.GPOS;if(Xt){const Zt=Xt.lookupList;for(let rn=0;rn<Zt.length;rn++){const Gt=Zt[rn];for(let jt=0;jt<Gt.tabs.length;jt++){const Kt=Gt.tabs[jt];if(Gt.ltype===1){if(nt._lctf.coverageIndex(Kt.coverage,Yt)!==-1&&Kt.pos){Ht(Kt.pos,Dt);break}}else if(Gt.ltype===2){let Jt=null,sn=Ot();if(sn!==-1){const hn=nt._lctf.coverageIndex(Kt.coverage,$t[sn]);if(hn!==-1){if(Kt.fmt===1){const an=Kt.pairsets[hn];for(let pn=0;pn<an.length;pn++)an[pn].gid2===Yt&&(Jt=an[pn])}else if(Kt.fmt===2){const an=nt.U._getGlyphClass($t[sn],Kt.classDef1),pn=nt.U._getGlyphClass(Yt,Kt.classDef2);Jt=Kt.matrix[an][pn]}if(Jt){Jt.val1&&Ht(Jt.val1,sn),Jt.val2&&Ht(Jt.val2,Dt);break}}}}else if(Gt.ltype===4){const Jt=nt._lctf.coverageIndex(Kt.markCoverage,Yt);if(Jt!==-1){const sn=Ot(zt),hn=sn===-1?-1:nt._lctf.coverageIndex(Kt.baseCoverage,$t[sn]);if(hn!==-1){const an=Kt.markArray[Jt],pn=Kt.baseArray[hn][an.markClass];kt[Dt*3]=pn.x-an.x+kt[sn*3]-kt[sn*3+2],kt[Dt*3+1]=pn.y-an.y+kt[sn*3+1];break}}}else if(Gt.ltype===6){const Jt=nt._lctf.coverageIndex(Kt.mark1Coverage,Yt);if(Jt!==-1){const sn=Ot();if(sn!==-1){const hn=$t[sn];if(wt(Lt,hn)===3){const an=nt._lctf.coverageIndex(Kt.mark2Coverage,hn);if(an!==-1){const pn=Kt.mark1Array[Jt],_n=Kt.mark2Array[an][pn.markClass];kt[Dt*3]=_n.x-pn.x+kt[sn*3]-kt[sn*3+2],kt[Dt*3+1]=_n.y-pn.y+kt[sn*3+1];break}}}}}}}}else if(Lt.kern&&!Lt.cff){const Zt=Ot();if(Zt!==-1){const rn=Lt.kern.glyph1.indexOf($t[Zt]);if(rn!==-1){const Gt=Lt.kern.rval[rn].glyph2.indexOf(Yt);Gt!==-1&&(kt[Zt*3+2]+=Lt.kern.rval[rn].vals[Gt])}}}}return kt;function Ot(Yt){for(let Xt=Dt-1;Xt>=0;Xt--)if($t[Xt]!==-1&&(!Yt||Yt($t[Xt])))return Xt;return-1}function zt(Yt){return wt(Lt,Yt)===1}function Ht(Yt,Xt){for(let Zt=0;Zt<3;Zt++)kt[Xt*3+Zt]+=Yt[Zt]||0}}function wt(Lt,$t){const kt=Lt.GDEF&&Lt.GDEF.glyphClassDef;return kt?nt.U._getGlyphClass($t,kt):0}function Rt(...Lt){for(let $t=0;$t<Lt.length;$t++)if(typeof Lt[$t]=="number")return Lt[$t]}function It(Lt){const $t=Object.create(null),kt=Lt["OS/2"],Dt=Lt.hhea,Ot=Lt.head.unitsPerEm,zt=Rt(kt&&kt.sTypoAscender,Dt&&Dt.ascender,Ot),Ht={unitsPerEm:Ot,ascender:zt,descender:Rt(kt&&kt.sTypoDescender,Dt&&Dt.descender,0),capHeight:Rt(kt&&kt.sCapHeight,zt),xHeight:Rt(kt&&kt.sxHeight,zt),lineGap:Rt(kt&&kt.sTypoLineGap,Dt&&Dt.lineGap),supportsCodePoint(Yt){return nt.U.codeToGlyph(Lt,Yt)>0},forEachGlyph(Yt,Xt,Zt,rn){let Gt=0;const jt=1/Ht.unitsPerEm*Xt,Kt=bt(Lt,Yt);let Jt=0;const sn=Tt(Lt,Kt);return Kt.forEach((hn,an)=>{if(hn!==-1){let pn=$t[hn];if(!pn){const{cmds:_n,crds:yn}=nt.U.glyphToPath(Lt,hn);let $n="",Jn=0;for(let rr=0,er=_n.length;rr<er;rr++){const Yn=et[_n[rr]];$n+=_n[rr];for(let ir=1;ir<=Yn;ir++)$n+=(ir>1?",":"")+yn[Jn++]}let Xn,Vn,En,dn;if(yn.length){Xn=Vn=1/0,En=dn=-1/0;for(let rr=0,er=yn.length;rr<er;rr+=2){let Yn=yn[rr],ir=yn[rr+1];Yn<Xn&&(Xn=Yn),ir<Vn&&(Vn=ir),Yn>En&&(En=Yn),ir>dn&&(dn=ir)}}else Xn=En=Vn=dn=0;pn=$t[hn]={index:hn,advanceWidth:Lt.hmtx.aWidth[hn],xMin:Xn,yMin:Vn,xMax:En,yMax:dn,path:$n}}rn.call(null,pn,Gt+sn[an*3]*jt,sn[an*3+1]*jt,Jt),Gt+=sn[an*3+2]*jt,Zt&&(Gt+=Zt*Xt)}Jt+=Yt.codePointAt(Jt)>65535?2:1}),Gt}};return Ht}return function($t){const kt=new Uint8Array($t,0,4),Dt=nt._bin.readASCII(kt,0,4);if(Dt==="wOFF")$t=_e($t);else if(Dt==="wOF2")throw new Error("woff2 fonts not supported");return It(nt.parse($t)[0])}}const workerModule=defineWorkerModule({name:"Typr Font Parser",dependencies:[typrFactory,woff2otfFactory,parserFactory],init(nt,_e,et){const rt=nt(),it=_e();return et(rt,it)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function unicodeFontResolverClientFactory(){return function(nt){var _e=function(){this.buckets=new Map};_e.prototype.add=function(Tt){var wt=Tt>>5;this.buckets.set(wt,(this.buckets.get(wt)||0)|1<<(31&Tt))},_e.prototype.has=function(Tt){var wt=this.buckets.get(Tt>>5);return wt!==void 0&&(wt&1<<(31&Tt))!=0},_e.prototype.serialize=function(){var Tt=[];return this.buckets.forEach(function(wt,Rt){Tt.push((+Rt).toString(36)+":"+wt.toString(36))}),Tt.join(",")},_e.prototype.deserialize=function(Tt){var wt=this;this.buckets.clear(),Tt.split(",").forEach(function(Rt){var It=Rt.split(":");wt.buckets.set(parseInt(It[0],36),parseInt(It[1],36))})};var et=Math.pow(2,8),rt=et-1,it=~rt;function st(Tt){var wt=function(It){return It&it}(Tt).toString(16),Rt=function(It){return(It&it)+et-1}(Tt).toString(16);return"codepoint-index/plane"+(Tt>>16)+"/"+wt+"-"+Rt+".json"}function ot(Tt,wt){var Rt=Tt&rt,It=wt.codePointAt(Rt/6|0);return((It=(It||48)-48)&1<<Rt%6)!=0}function at(Tt,wt){var Rt;(Rt=Tt,Rt.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(It){return It.split("-").map(function(Lt){return parseInt(Lt.trim(),16)})})).forEach(function(It){var Lt=It[0],$t=It[1];$t===void 0&&($t=Lt),wt(Lt,$t)})}function lt(Tt,wt){at(Tt,function(Rt,It){for(var Lt=Rt;Lt<=It;Lt++)wt(Lt)})}var ct={},ut={},ht=new WeakMap,dt="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function ft(Tt){var wt=ht.get(Tt);return wt||(wt=new _e,lt(Tt.ranges,function(Rt){return wt.add(Rt)}),ht.set(Tt,wt)),wt}var pt,mt=new Map;function At(Tt,wt,Rt){return Tt[wt]?wt:Tt[Rt]?Rt:function(It){for(var Lt in It)return Lt}(Tt)}function gt(Tt,wt){var Rt=wt;if(!Tt.includes(Rt)){Rt=1/0;for(var It=0;It<Tt.length;It++)Math.abs(Tt[It]-wt)<Math.abs(Rt-wt)&&(Rt=Tt[It])}return Rt}function bt(Tt){return pt||(pt=new Set,lt("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(wt){pt.add(wt)})),pt.has(Tt)}return nt.CodePointSet=_e,nt.clearCache=function(){ct={},ut={}},nt.getFontsForString=function(Tt,wt){wt===void 0&&(wt={});var Rt,It=wt.lang;It===void 0&&(It=new RegExp("\\p{Script=Hangul}","u").test(Rt=Tt)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(Rt)?"ja":"en");var Lt=wt.category;Lt===void 0&&(Lt="sans-serif");var $t=wt.style;$t===void 0&&($t="normal");var kt=wt.weight;kt===void 0&&(kt=400);var Dt=(wt.dataUrl||dt).replace(/\/$/g,""),Ot=new Map,zt=new Uint8Array(Tt.length),Ht={},Yt={},Xt=new Array(Tt.length),Zt=new Map,rn=!1;function Gt(Jt){var sn=mt.get(Jt);return sn||(sn=fetch(Dt+"/"+Jt).then(function(hn){if(!hn.ok)throw new Error(hn.statusText);return hn.json().then(function(an){if(!Array.isArray(an)||an[0]!==1)throw new Error("Incorrect schema version; need 1, got "+an[0]);return an[1]})}).catch(function(hn){if(Dt!==dt)return rn||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+Dt+'", trying default CDN. '+hn.message),rn=!0),Dt=dt,mt.delete(Jt),Gt(Jt);throw hn}),mt.set(Jt,sn)),sn}for(var jt=function(Jt){var sn=Tt.codePointAt(Jt),hn=st(sn);Xt[Jt]=hn,ct[hn]||Zt.has(hn)||Zt.set(hn,Gt(hn).then(function(an){ct[hn]=an})),sn>65535&&(Jt++,Kt=Jt)},Kt=0;Kt<Tt.length;Kt++)jt(Kt);return Promise.all(Zt.values()).then(function(){Zt.clear();for(var Jt=function(hn){var an=Tt.codePointAt(hn),pn=null,_n=ct[Xt[hn]],yn=void 0;for(var $n in _n){var Jn=Yt[$n];if(Jn===void 0&&(Jn=Yt[$n]=new RegExp($n).test(It||"en")),Jn){for(var Xn in yn=$n,_n[$n])if(ot(an,_n[$n][Xn])){pn=Xn;break}break}}if(!pn){e:for(var Vn in _n)if(Vn!==yn){for(var En in _n[Vn])if(ot(an,_n[Vn][En])){pn=En;break e}}}pn||(console.debug("No font coverage for U+"+an.toString(16)),pn="latin"),Xt[hn]=pn,ut[pn]||Zt.has(pn)||Zt.set(pn,Gt("font-meta/"+pn+".json").then(function(dn){ut[pn]=dn})),an>65535&&(hn++,sn=hn)},sn=0;sn<Tt.length;sn++)Jt(sn);return Promise.all(Zt.values())}).then(function(){for(var Jt,sn=null,hn=0;hn<Tt.length;hn++){var an=Tt.codePointAt(hn);if(sn&&(bt(an)||ft(sn).has(an)))zt[hn]=zt[hn-1];else{sn=ut[Xt[hn]];var pn=Ht[sn.id];if(!pn){var _n=sn.typeforms,yn=At(_n,Lt,"sans-serif"),$n=At(_n[yn],$t,"normal"),Jn=gt((Jt=_n[yn])===null||Jt===void 0?void 0:Jt[$n],kt);pn=Ht[sn.id]=Dt+"/font-files/"+sn.id+"/"+yn+"."+$n+"."+Jn+".woff"}var Xn=Ot.get(pn);Xn==null&&(Xn=Ot.size,Ot.set(pn,Xn)),zt[hn]=Xn}an>65535&&(hn++,zt[hn]=zt[hn-1])}return{fontUrls:Array.from(Ot.keys()),chars:zt}})},Object.defineProperty(nt,"__esModule",{value:!0}),nt}({})}function createFontResolver(nt,_e){const et=Object.create(null),rt=Object.create(null);function it(ot,at){const lt=ct=>{console.error(`Failure loading font ${ot}`,ct)};try{const ct=new XMLHttpRequest;ct.open("get",ot,!0),ct.responseType="arraybuffer",ct.onload=function(){if(ct.status>=400)lt(new Error(ct.statusText));else if(ct.status>0)try{const ut=nt(ct.response);ut.src=ot,at(ut)}catch(ut){lt(ut)}},ct.onerror=lt,ct.send()}catch(ct){lt(ct)}}function st(ot,at){let lt=et[ot];lt?at(lt):rt[ot]?rt[ot].push(at):(rt[ot]=[at],it(ot,ct=>{ct.src=ot,et[ot]=ct,rt[ot].forEach(ut=>ut(ct)),delete rt[ot]}))}return function(ot,at,{lang:lt,fonts:ct=[],style:ut="normal",weight:ht="normal",unicodeFontsURL:dt}={}){const ft=new Uint8Array(ot.length),pt=[];ot.length||bt();const mt=new Map,At=[];if(ut!=="italic"&&(ut="normal"),typeof ht!="number"&&(ht=ht==="bold"?700:400),ct&&!Array.isArray(ct)&&(ct=[ct]),ct=ct.slice().filter(wt=>!wt.lang||wt.lang.test(lt)).reverse(),ct.length){let Lt=0;(function $t(kt=0){for(let Dt=kt,Ot=ot.length;Dt<Ot;Dt++){const zt=ot.codePointAt(Dt);if(Lt===1&&pt[ft[Dt-1]].supportsCodePoint(zt)||/\s/.test(ot[Dt]))ft[Dt]=ft[Dt-1],Lt===2&&(At[At.length-1][1]=Dt);else for(let Ht=ft[Dt],Yt=ct.length;Ht<=Yt;Ht++)if(Ht===Yt){const Xt=Lt===2?At[At.length-1]:At[At.length]=[Dt,Dt];Xt[1]=Dt,Lt=2}else{ft[Dt]=Ht;const{src:Xt,unicodeRange:Zt}=ct[Ht];if(!Zt||Tt(zt,Zt)){const rn=et[Xt];if(!rn){st(Xt,()=>{$t(Dt)});return}if(rn.supportsCodePoint(zt)){let Gt=mt.get(rn);typeof Gt!="number"&&(Gt=pt.length,pt.push(rn),mt.set(rn,Gt)),ft[Dt]=Gt,Lt=1;break}}}zt>65535&&Dt+1<Ot&&(ft[Dt+1]=ft[Dt],Dt++,Lt===2&&(At[At.length-1][1]=Dt))}gt()})()}else At.push([0,ot.length-1]),gt();function gt(){if(At.length){const wt=At.map(Rt=>ot.substring(Rt[0],Rt[1]+1)).join(`
`);_e.getFontsForString(wt,{lang:lt||void 0,style:ut,weight:ht,dataUrl:dt}).then(({fontUrls:Rt,chars:It})=>{const Lt=pt.length;let $t=0;At.forEach(Dt=>{for(let Ot=0,zt=Dt[1]-Dt[0];Ot<=zt;Ot++)ft[Dt[0]+Ot]=It[$t++]+Lt;$t++});let kt=0;Rt.forEach((Dt,Ot)=>{st(Dt,zt=>{pt[Ot+Lt]=zt,++kt===Rt.length&&bt()})})})}else bt()}function bt(){at({chars:ft,fonts:pt})}function Tt(wt,Rt){for(let It=0;It<Rt.length;It++){const[Lt,$t=Lt]=Rt[It];if(Lt<=wt&&wt<=$t)return!0}return!1}}}const fontResolverWorkerModule=defineWorkerModule({name:"FontResolver",dependencies:[createFontResolver,workerModule,unicodeFontResolverClientFactory],init(nt,_e,et){return nt(_e,et())}});function createTypesetter(nt,_e){const rt=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,it="[^\\S\\u00A0]",st=new RegExp(`${it}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function ot({text:pt,lang:mt,fonts:At,style:gt,weight:bt,preResolvedFonts:Tt,unicodeFontsURL:wt},Rt){const It=({chars:Lt,fonts:$t})=>{let kt,Dt;const Ot=[];for(let zt=0;zt<Lt.length;zt++)Lt[zt]!==Dt?(Dt=Lt[zt],Ot.push(kt={start:zt,end:zt,fontObj:$t[Lt[zt]]})):kt.end=zt;Rt(Ot)};Tt?It(Tt):nt(pt,It,{lang:mt,fonts:At,style:gt,weight:bt,unicodeFontsURL:wt})}function at({text:pt="",font:mt,lang:At,sdfGlyphSize:gt=64,fontSize:bt=400,fontWeight:Tt=1,fontStyle:wt="normal",letterSpacing:Rt=0,lineHeight:It="normal",maxWidth:Lt=1/0,direction:$t,textAlign:kt="left",textIndent:Dt=0,whiteSpace:Ot="normal",overflowWrap:zt="normal",anchorX:Ht=0,anchorY:Yt=0,metricsOnly:Xt=!1,unicodeFontsURL:Zt,preResolvedFonts:rn=null,includeCaretPositions:Gt=!1,chunkedBoundsSize:jt=8192,colorRanges:Kt=null},Jt){const sn=ht(),hn={fontLoad:0,typesetting:0};pt.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),pt=pt.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),bt=+bt,Rt=+Rt,Lt=+Lt,It=It||"normal",Dt=+Dt,ot({text:pt,lang:At,style:wt,weight:Tt,fonts:typeof mt=="string"?[{src:mt}]:mt,unicodeFontsURL:Zt,preResolvedFonts:rn},an=>{hn.fontLoad=ht()-sn;const pn=isFinite(Lt);let _n=null,yn=null,$n=null,Jn=null,Xn=null,Vn=null,En=null,dn=null,rr=0,er=0,Yn=Ot!=="nowrap";const ir=new Map,Qn=ht();let sr=Dt,un=0,en=new dt;const wn=[en];an.forEach(jn=>{const{fontObj:hr}=jn,{ascender:Tr,descender:cr,unitsPerEm:yr,lineGap:Rr,capHeight:br,xHeight:pr}=hr;let vn=ir.get(hr);if(!vn){const Nn=bt/yr,nr=It==="normal"?(Tr-cr+Rr)*Nn:It*bt,Ir=(nr-(Tr-cr)*Nn)/2,Dn=Math.min(nr,(Tr-cr)*Nn),Pr=(Tr+cr)/2*Nn+Dn/2;vn={index:ir.size,src:hr.src,fontObj:hr,fontSizeMult:Nn,unitsPerEm:yr,ascender:Tr*Nn,descender:cr*Nn,capHeight:br*Nn,xHeight:pr*Nn,lineHeight:nr,baseline:-Ir-Tr*Nn,caretTop:Pr,caretBottom:Pr-Dn},ir.set(hr,vn)}const{fontSizeMult:qn}=vn,vr=pt.slice(jn.start,jn.end+1);let Sn,Ar;hr.forEachGlyph(vr,bt,Rt,(Nn,nr,Ir,Dn)=>{nr+=un,Dn+=jn.start,Sn=nr,Ar=Nn;const Pr=pt.charAt(Dn),jr=Nn.advanceWidth*qn,Jr=en.count;let Lr;if("isEmpty"in Nn||(Nn.isWhitespace=!!Pr&&new RegExp(it).test(Pr),Nn.canBreakAfter=!!Pr&&st.test(Pr),Nn.isEmpty=Nn.xMin===Nn.xMax||Nn.yMin===Nn.yMax||rt.test(Pr)),!Nn.isWhitespace&&!Nn.isEmpty&&er++,Yn&&pn&&!Nn.isWhitespace&&nr+jr+sr>Lt&&Jr){if(en.glyphAt(Jr-1).glyphObj.canBreakAfter)Lr=new dt,sr=-nr;else for(let As=Jr;As--;)if(As===0&&zt==="break-word"){Lr=new dt,sr=-nr;break}else if(en.glyphAt(As).glyphObj.canBreakAfter){Lr=en.splitAt(As+1);const ks=Lr.glyphAt(0).x;sr-=ks;for(let Ps=Lr.count;Ps--;)Lr.glyphAt(Ps).x-=ks;break}Lr&&(en.isSoftWrapped=!0,en=Lr,wn.push(en),rr=Lt)}let Wr=en.glyphAt(en.count);Wr.glyphObj=Nn,Wr.x=nr+sr,Wr.y=Ir,Wr.width=jr,Wr.charIndex=Dn,Wr.fontData=vn,Pr===`
`&&(en=new dt,wn.push(en),sr=-(nr+jr+Rt*bt)+Dt)}),un=Sn+Ar.advanceWidth*qn+Rt*bt});let gn=0;wn.forEach(jn=>{let hr=!0;for(let Tr=jn.count;Tr--;){const cr=jn.glyphAt(Tr);hr&&!cr.glyphObj.isWhitespace&&(jn.width=cr.x+cr.width,jn.width>rr&&(rr=jn.width),hr=!1);let{lineHeight:yr,capHeight:Rr,xHeight:br,baseline:pr}=cr.fontData;yr>jn.lineHeight&&(jn.lineHeight=yr);const vn=pr-jn.baseline;vn<0&&(jn.baseline+=vn,jn.cap+=vn,jn.ex+=vn),jn.cap=Math.max(jn.cap,jn.baseline+Rr),jn.ex=Math.max(jn.ex,jn.baseline+br)}jn.baseline-=gn,jn.cap-=gn,jn.ex-=gn,gn+=jn.lineHeight});let Mn=0,In=0;if(Ht&&(typeof Ht=="number"?Mn=-Ht:typeof Ht=="string"&&(Mn=-rr*(Ht==="left"?0:Ht==="center"?.5:Ht==="right"?1:ct(Ht)))),Yt&&(typeof Yt=="number"?In=-Yt:typeof Yt=="string"&&(In=Yt==="top"?0:Yt==="top-baseline"?-wn[0].baseline:Yt==="top-cap"?-wn[0].cap:Yt==="top-ex"?-wn[0].ex:Yt==="middle"?gn/2:Yt==="bottom"?gn:Yt==="bottom-baseline"?-wn[wn.length-1].baseline:ct(Yt)*gn)),!Xt){const jn=_e.getEmbeddingLevels(pt,$t);_n=new Uint16Array(er),yn=new Uint8Array(er),$n=new Float32Array(er*2),Jn={},En=[1/0,1/0,-1/0,-1/0],dn=[],Gt&&(Vn=new Float32Array(pt.length*4)),Kt&&(Xn=new Uint8Array(er*3));let hr=0,Tr=-1,cr=-1,yr,Rr;if(wn.forEach((br,pr)=>{let{count:vn,width:qn}=br;if(vn>0){let vr=0;for(let Dn=vn;Dn--&&br.glyphAt(Dn).glyphObj.isWhitespace;)vr++;let Sn=0,Ar=0;if(kt==="center")Sn=(rr-qn)/2;else if(kt==="right")Sn=rr-qn;else if(kt==="justify"&&br.isSoftWrapped){let Dn=0;for(let Pr=vn-vr;Pr--;)br.glyphAt(Pr).glyphObj.isWhitespace&&Dn++;Ar=(rr-qn)/Dn}if(Ar||Sn){let Dn=0;for(let Pr=0;Pr<vn;Pr++){let jr=br.glyphAt(Pr);const Jr=jr.glyphObj;jr.x+=Sn+Dn,Ar!==0&&Jr.isWhitespace&&Pr<vn-vr&&(Dn+=Ar,jr.width+=Ar)}}const Nn=_e.getReorderSegments(pt,jn,br.glyphAt(0).charIndex,br.glyphAt(br.count-1).charIndex);for(let Dn=0;Dn<Nn.length;Dn++){const[Pr,jr]=Nn[Dn];let Jr=1/0,Lr=-1/0;for(let Wr=0;Wr<vn;Wr++)if(br.glyphAt(Wr).charIndex>=Pr){let As=Wr,ks=Wr;for(;ks<vn;ks++){let Ps=br.glyphAt(ks);if(Ps.charIndex>jr)break;ks<vn-vr&&(Jr=Math.min(Jr,Ps.x),Lr=Math.max(Lr,Ps.x+Ps.width))}for(let Ps=As;Ps<ks;Ps++){const $s=br.glyphAt(Ps);$s.x=Lr-($s.x+$s.width-Jr)}break}}let nr;const Ir=Dn=>nr=Dn;for(let Dn=0;Dn<vn;Dn++){const Pr=br.glyphAt(Dn);nr=Pr.glyphObj;const jr=nr.index,Jr=jn.levels[Pr.charIndex]&1;if(Jr){const Lr=_e.getMirroredCharacter(pt[Pr.charIndex]);Lr&&Pr.fontData.fontObj.forEachGlyph(Lr,0,0,Ir)}if(Gt){const{charIndex:Lr,fontData:Wr}=Pr,As=Pr.x+Mn,ks=Pr.x+Pr.width+Mn;Vn[Lr*4]=Jr?ks:As,Vn[Lr*4+1]=Jr?As:ks,Vn[Lr*4+2]=br.baseline+Wr.caretBottom+In,Vn[Lr*4+3]=br.baseline+Wr.caretTop+In;const Ps=Lr-Tr;Ps>1&&ut(Vn,Tr,Ps),Tr=Lr}if(Kt){const{charIndex:Lr}=Pr;for(;Lr>cr;)cr++,Kt.hasOwnProperty(cr)&&(Rr=Kt[cr])}if(!nr.isWhitespace&&!nr.isEmpty){const Lr=hr++,{fontSizeMult:Wr,src:As,index:ks}=Pr.fontData,Ps=Jn[As]||(Jn[As]={});Ps[jr]||(Ps[jr]={path:nr.path,pathBounds:[nr.xMin,nr.yMin,nr.xMax,nr.yMax]});const $s=Pr.x+Mn,eo=Pr.y+br.baseline+In;$n[Lr*2]=$s,$n[Lr*2+1]=eo;const Us=$s+nr.xMin*Wr,zn=eo+nr.yMin*Wr,lr=$s+nr.xMax*Wr,Sr=eo+nr.yMax*Wr;Us<En[0]&&(En[0]=Us),zn<En[1]&&(En[1]=zn),lr>En[2]&&(En[2]=lr),Sr>En[3]&&(En[3]=Sr),Lr%jt===0&&(yr={start:Lr,end:Lr,rect:[1/0,1/0,-1/0,-1/0]},dn.push(yr)),yr.end++;const Or=yr.rect;if(Us<Or[0]&&(Or[0]=Us),zn<Or[1]&&(Or[1]=zn),lr>Or[2]&&(Or[2]=lr),Sr>Or[3]&&(Or[3]=Sr),_n[Lr]=jr,yn[Lr]=ks,Kt){const xt=Lr*3;Xn[xt]=Rr>>16&255,Xn[xt+1]=Rr>>8&255,Xn[xt+2]=Rr&255}}}}}),Vn){const br=pt.length-Tr;br>1&&ut(Vn,Tr,br)}}const gr=[];ir.forEach(({index:jn,src:hr,unitsPerEm:Tr,ascender:cr,descender:yr,lineHeight:Rr,capHeight:br,xHeight:pr})=>{gr[jn]={src:hr,unitsPerEm:Tr,ascender:cr,descender:yr,lineHeight:Rr,capHeight:br,xHeight:pr}}),hn.typesetting=ht()-Qn,Jt({glyphIds:_n,glyphFontIndices:yn,glyphPositions:$n,glyphData:Jn,fontData:gr,caretPositions:Vn,glyphColors:Xn,chunkedBounds:dn,fontSize:bt,topBaseline:In+wn[0].baseline,blockBounds:[Mn,In-gn,Mn+rr,In],visibleBounds:En,timings:hn})})}function lt(pt,mt){at({...pt,metricsOnly:!0},At=>{const[gt,bt,Tt,wt]=At.blockBounds;mt({width:Tt-gt,height:wt-bt})})}function ct(pt){let mt=pt.match(/^([\d.]+)%$/),At=mt?parseFloat(mt[1]):NaN;return isNaN(At)?0:At/100}function ut(pt,mt,At){const gt=pt[mt*4],bt=pt[mt*4+1],Tt=pt[mt*4+2],wt=pt[mt*4+3],Rt=(bt-gt)/At;for(let It=0;It<At;It++){const Lt=(mt+It)*4;pt[Lt]=gt+Rt*It,pt[Lt+1]=gt+Rt*(It+1),pt[Lt+2]=Tt,pt[Lt+3]=wt}}function ht(){return(self.performance||Date).now()}function dt(){this.data=[]}const ft=["glyphObj","x","y","width","charIndex","fontData"];return dt.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/ft.length)},glyphAt(pt){let mt=dt.flyweight;return mt.data=this.data,mt.index=pt,mt},splitAt(pt){let mt=new dt;return mt.data=this.data.splice(pt*ft.length),mt}},dt.flyweight=ft.reduce((pt,mt,At,gt)=>(Object.defineProperty(pt,mt,{get(){return this.data[this.index*ft.length+At]},set(bt){this.data[this.index*ft.length+At]=bt}}),pt),{data:null,index:0}),{typeset:at,measure:lt}}const now$4=()=>(self.performance||Date).now(),mainThreadGenerator=SDFGenerator();let warned;function generateSDF(nt,_e,et,rt,it,st,ot,at,lt,ct,ut=!0){return ut?generateSDF_GL(nt,_e,et,rt,it,st,ot,at,lt,ct).then(null,ht=>(warned||(console.warn("WebGL SDF generation failed, falling back to JS",ht),warned=!0),generateSDF_JS_Worker(nt,_e,et,rt,it,st,ot,at,lt,ct))):generateSDF_JS_Worker(nt,_e,et,rt,it,st,ot,at,lt,ct)}const queue=[],chunkTimeBudget=5;let timer=0;function nextChunk(){const nt=now$4();for(;queue.length&&now$4()-nt<chunkTimeBudget;)queue.shift()();timer=queue.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...nt)=>new Promise((_e,et)=>{queue.push(()=>{const rt=now$4();try{mainThreadGenerator.webgl.generateIntoCanvas(...nt),_e({timing:now$4()-rt})}catch(it){et(it)}}),timer||(timer=setTimeout(nextChunk,0))}),threadCount=4,idleTimeout=2e3,threads={};let callNum=0;function generateSDF_JS_Worker(nt,_e,et,rt,it,st,ot,at,lt,ct){const ut="TroikaTextSDFGenerator_JS_"+callNum++%threadCount;let ht=threads[ut];return ht||(ht=threads[ut]={workerModule:defineWorkerModule({name:ut,workerId:ut,dependencies:[SDFGenerator,now$4],init(dt,ft){const pt=dt().javascript.generate;return function(...mt){const At=ft();return{textureData:pt(...mt),timing:ft()-At}}},getTransferables(dt){return[dt.textureData.buffer]}}),requests:0,idleTimer:null}),ht.requests++,clearTimeout(ht.idleTimer),ht.workerModule(nt,_e,et,rt,it,st).then(({textureData:dt,timing:ft})=>{const pt=now$4(),mt=new Uint8Array(dt.length*4);for(let At=0;At<dt.length;At++)mt[At*4+ct]=dt[At];return mainThreadGenerator.webglUtils.renderImageData(ot,mt,at,lt,nt,_e,1<<3-ct),ft+=now$4()-pt,--ht.requests===0&&(ht.idleTimer=setTimeout(()=>{terminateWorker(ut)},idleTimeout)),{timing:ft}})}function warmUpSDFCanvas(nt){nt._warm||(mainThreadGenerator.webgl.isSupported(nt),nt._warm=!0)}const resizeWebGLCanvasWithoutClearing=mainThreadGenerator.webglUtils.resizeWebGLCanvasWithoutClearing,CONFIG={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},tempColor=new Color$2;function now$1$1(){return(self.performance||Date).now()}const atlases=Object.create(null);function getTextRenderInfo(nt,_e){nt=assign$1({},nt);const et=now$1$1(),{defaultFontURL:rt}=CONFIG,it=[];if(rt&&it.push({label:"default",src:toAbsoluteURL(rt)}),nt.font&&it.push({label:"user",src:toAbsoluteURL(nt.font)}),nt.font=it,nt.text=""+nt.text,nt.sdfGlyphSize=nt.sdfGlyphSize||CONFIG.sdfGlyphSize,nt.unicodeFontsURL=nt.unicodeFontsURL||CONFIG.unicodeFontsURL,nt.colorRanges!=null){let dt={};for(let ft in nt.colorRanges)if(nt.colorRanges.hasOwnProperty(ft)){let pt=nt.colorRanges[ft];typeof pt!="number"&&(pt=tempColor.set(pt).getHex()),dt[ft]=pt}nt.colorRanges=dt}Object.freeze(nt);const{textureWidth:st,sdfExponent:ot}=CONFIG,{sdfGlyphSize:at}=nt,lt=st/at*4;let ct=atlases[at];if(!ct){const dt=document.createElement("canvas");dt.width=st,dt.height=at*256/lt,ct=atlases[at]={glyphCount:0,sdfGlyphSize:at,sdfCanvas:dt,sdfTexture:new Texture$1(dt,void 0,void 0,void 0,LinearFilter$1,LinearFilter$1),contextLost:!1,glyphsByFont:new Map},ct.sdfTexture.generateMipmaps=!1,initContextLossHandling(ct)}const{sdfTexture:ut,sdfCanvas:ht}=ct;typesetInWorker(nt).then(dt=>{const{glyphIds:ft,glyphFontIndices:pt,fontData:mt,glyphPositions:At,fontSize:gt,timings:bt}=dt,Tt=[],wt=new Float32Array(ft.length*4);let Rt=0,It=0;const Lt=now$1$1(),$t=mt.map(Ht=>{let Yt=ct.glyphsByFont.get(Ht.src);return Yt||ct.glyphsByFont.set(Ht.src,Yt=new Map),Yt});ft.forEach((Ht,Yt)=>{const Xt=pt[Yt],{src:Zt,unitsPerEm:rn}=mt[Xt];let Gt=$t[Xt].get(Ht);if(!Gt){const{path:hn,pathBounds:an}=dt.glyphData[Zt][Ht],pn=Math.max(an[2]-an[0],an[3]-an[1])/at*(CONFIG.sdfMargin*at+.5),_n=ct.glyphCount++,yn=[an[0]-pn,an[1]-pn,an[2]+pn,an[3]+pn];$t[Xt].set(Ht,Gt={path:hn,atlasIndex:_n,sdfViewBox:yn}),Tt.push(Gt)}const{sdfViewBox:jt}=Gt,Kt=At[It++],Jt=At[It++],sn=gt/rn;wt[Rt++]=Kt+jt[0]*sn,wt[Rt++]=Jt+jt[1]*sn,wt[Rt++]=Kt+jt[2]*sn,wt[Rt++]=Jt+jt[3]*sn,ft[Yt]=Gt.atlasIndex}),bt.quads=(bt.quads||0)+(now$1$1()-Lt);const kt=now$1$1();bt.sdf={};const Dt=ht.height,Ot=Math.ceil(ct.glyphCount/lt),zt=Math.pow(2,Math.ceil(Math.log2(Ot*at)));zt>Dt&&(console.info(`Increasing SDF texture size ${Dt}->${zt}`),resizeWebGLCanvasWithoutClearing(ht,st,zt),ut.dispose()),Promise.all(Tt.map(Ht=>generateGlyphSDF(Ht,ct,nt.gpuAccelerateSDF).then(({timing:Yt})=>{bt.sdf[Ht.atlasIndex]=Yt}))).then(()=>{Tt.length&&!ct.contextLost&&(safariPre15Workaround(ct),ut.needsUpdate=!0),bt.sdfTotal=now$1$1()-kt,bt.total=now$1$1()-et,_e(Object.freeze({parameters:nt,sdfTexture:ut,sdfGlyphSize:at,sdfExponent:ot,glyphBounds:wt,glyphAtlasIndices:ft,glyphColors:dt.glyphColors,caretPositions:dt.caretPositions,chunkedBounds:dt.chunkedBounds,ascender:dt.ascender,descender:dt.descender,lineHeight:dt.lineHeight,capHeight:dt.capHeight,xHeight:dt.xHeight,topBaseline:dt.topBaseline,blockBounds:dt.blockBounds,visibleBounds:dt.visibleBounds,timings:dt.timings}))})}),Promise.resolve().then(()=>{ct.contextLost||warmUpSDFCanvas(ht)})}function generateGlyphSDF({path:nt,atlasIndex:_e,sdfViewBox:et},{sdfGlyphSize:rt,sdfCanvas:it,contextLost:st},ot){if(st)return Promise.resolve({timing:-1});const{textureWidth:at,sdfExponent:lt}=CONFIG,ct=Math.max(et[2]-et[0],et[3]-et[1]),ut=Math.floor(_e/4),ht=ut%(at/rt)*rt,dt=Math.floor(ut/(at/rt))*rt,ft=_e%4;return generateSDF(rt,rt,nt,et,ct,lt,it,ht,dt,ft,ot)}function initContextLossHandling(nt){const _e=nt.sdfCanvas;_e.addEventListener("webglcontextlost",et=>{console.log("Context Lost",et),et.preventDefault(),nt.contextLost=!0}),_e.addEventListener("webglcontextrestored",et=>{console.log("Context Restored",et),nt.contextLost=!1;const rt=[];nt.glyphsByFont.forEach(it=>{it.forEach(st=>{rt.push(generateGlyphSDF(st,nt,!0))})}),Promise.all(rt).then(()=>{safariPre15Workaround(nt),nt.sdfTexture.needsUpdate=!0})})}function preloadFont({font:nt,characters:_e,sdfGlyphSize:et},rt){let it=Array.isArray(_e)?_e.join(`
`):""+_e;getTextRenderInfo({font:nt,sdfGlyphSize:et,text:it},rt)}function assign$1(nt,_e){for(let et in _e)_e.hasOwnProperty(et)&&(nt[et]=_e[et]);return nt}let linkEl;function toAbsoluteURL(nt){return linkEl||(linkEl=typeof document>"u"?{}:document.createElement("a")),linkEl.href=nt,linkEl.href}function safariPre15Workaround(nt){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:_e,sdfTexture:et}=nt,{width:rt,height:it}=_e,st=nt.sdfCanvas.getContext("webgl");let ot=et.image.data;(!ot||ot.length!==rt*it*4)&&(ot=new Uint8Array(rt*it*4),et.image={width:rt,height:it,data:ot},et.flipY=!1,et.isDataTexture=!0),st.readPixels(0,0,rt,it,st.RGBA,st.UNSIGNED_BYTE,ot)}}const typesetterWorkerModule=defineWorkerModule({name:"Typesetter",dependencies:[createTypesetter,fontResolverWorkerModule,bidiFactory],init(nt,_e,et){return nt(_e,et())}}),typesetInWorker=defineWorkerModule({name:"Typesetter",dependencies:[typesetterWorkerModule],init(nt){return function(_e){return new Promise(et=>{nt.typeset(_e,et)})}},getTransferables(nt){const _e=[];for(let et in nt)nt[et]&&nt[et].buffer&&_e.push(nt[et].buffer);return _e}}),templateGeometries={};function getTemplateGeometry(nt){let _e=templateGeometries[nt];if(!_e){const et=new PlaneGeometry(1,1,nt,nt),rt=et.clone(),it=et.attributes,st=rt.attributes,ot=new BufferGeometry$1,at=it.uv.count;for(let lt=0;lt<at;lt++)st.position.array[lt*3]*=-1,st.normal.array[lt*3+2]*=-1;["position","normal","uv"].forEach(lt=>{ot.setAttribute(lt,new Float32BufferAttribute$1([...it[lt].array,...st[lt].array],it[lt].itemSize))}),ot.setIndex([...et.index.array,...rt.index.array.map(lt=>lt+at)]),ot.translate(.5,.5,0),_e=templateGeometries[nt]=ot}return _e}const glyphBoundsAttrName="aTroikaGlyphBounds",glyphIndexAttrName="aTroikaGlyphIndex",glyphColorAttrName="aTroikaGlyphColor";class GlyphsGeometry extends InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Sphere$1,this.boundingBox=new Box3$1}computeBoundingSphere(){}computeBoundingBox(){}setSide(_e){const et=this.getIndex().count;this.setDrawRange(_e===BackSide$1?et/2:0,_e===DoubleSide$1?et:et/2)}set detail(_e){if(_e!==this._detail){this._detail=_e,(typeof _e!="number"||_e<1)&&(_e=1);let et=getTemplateGeometry(_e);["position","normal","uv"].forEach(rt=>{this.attributes[rt]=et.attributes[rt].clone()}),this.setIndex(et.getIndex().clone())}}get detail(){return this._detail}set curveRadius(_e){_e!==this._curveRadius&&(this._curveRadius=_e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(_e,et,rt,it,st){updateBufferAttr(this,glyphBoundsAttrName,_e,4),updateBufferAttr(this,glyphIndexAttrName,et,1),updateBufferAttr(this,glyphColorAttrName,st,3),this._blockBounds=rt,this._chunkedBounds=it,this.instanceCount=et.length,this._updateBounds()}_updateBounds(){const _e=this._blockBounds;if(_e){const{curveRadius:et,boundingBox:rt}=this;if(et){const{PI:it,floor:st,min:ot,max:at,sin:lt,cos:ct}=Math,ut=it/2,ht=it*2,dt=Math.abs(et),ft=_e[0]/dt,pt=_e[2]/dt,mt=st((ft+ut)/ht)!==st((pt+ut)/ht)?-dt:ot(lt(ft)*dt,lt(pt)*dt),At=st((ft-ut)/ht)!==st((pt-ut)/ht)?dt:at(lt(ft)*dt,lt(pt)*dt),gt=st((ft+it)/ht)!==st((pt+it)/ht)?dt*2:at(dt-ct(ft)*dt,dt-ct(pt)*dt);rt.min.set(mt,_e[1],et<0?-gt:0),rt.max.set(At,_e[3],et<0?0:gt)}else rt.min.set(_e[0],_e[1],0),rt.max.set(_e[2],_e[3],0);rt.getBoundingSphere(this.boundingSphere)}}applyClipRect(_e){let et=this.getAttribute(glyphIndexAttrName).count,rt=this._chunkedBounds;if(rt)for(let it=rt.length;it--;){et=rt[it].end;let st=rt[it].rect;if(st[1]<_e.w&&st[3]>_e.y&&st[0]<_e.z&&st[2]>_e.x)break}this.instanceCount=et}}function updateBufferAttr(nt,_e,et,rt){const it=nt.getAttribute(_e);et?it&&it.array.length===et.length?(it.array.set(et),it.needsUpdate=!0):(nt.setAttribute(_e,new InstancedBufferAttribute$1(et,rt)),delete nt._maxInstanceCount,nt.dispose()):it&&nt.deleteAttribute(_e)}const VERTEX_DEFS=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VERTEX_TRANSFORM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,FRAGMENT_DEFS=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,FRAGMENT_TRANSFORM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function createTextDerivedMaterial(nt){const _e=createDerivedMaterial(nt,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Vector2$1},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vector4$1(0,0,0,0)},uTroikaClipRect:{value:new Vector4$1(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Vector2$1},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Color$2},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Matrix3$1},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:VERTEX_DEFS,vertexTransform:VERTEX_TRANSFORM,fragmentDefs:FRAGMENT_DEFS,fragmentColorTransform:FRAGMENT_TRANSFORM,customRewriter({vertexShader:et,fragmentShader:rt}){let it=/\buniform\s+vec3\s+diffuse\b/;return it.test(rt)&&(rt=rt.replace(it,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),it.test(et)||(et=et.replace(voidMainRegExp,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:et,fragmentShader:rt}}});return _e.transparent=!0,Object.defineProperties(_e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),_e}const defaultMaterial=new MeshBasicMaterial$1({color:16777215,side:DoubleSide$1,transparent:!0}),defaultStrokeColor=8421504,tempMat4=new Matrix4$1,tempVec3a=new Vector3$1,tempVec3b=new Vector3$1,tempArray=[],origin=new Vector3$1,defaultOrient="+x+y";function first(nt){return Array.isArray(nt)?nt[0]:nt}let getFlatRaycastMesh=()=>{const nt=new Mesh$1(new PlaneGeometry(1,1),defaultMaterial);return getFlatRaycastMesh=()=>nt,nt},getCurvedRaycastMesh=()=>{const nt=new Mesh$1(new PlaneGeometry(1,1,32,1),defaultMaterial);return getCurvedRaycastMesh=()=>nt,nt};const syncStartEvent={type:"syncstart"},syncCompleteEvent={type:"synccomplete"},SYNCABLE_PROPS=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],COPYABLE_PROPS=SYNCABLE_PROPS.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Text$1=class extends Mesh$1{constructor(){const _e=new GlyphsGeometry;super(_e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=defaultStrokeColor,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=defaultOrient,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(_e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(_e):(this._isSyncing=!0,this.dispatchEvent(syncStartEvent),getTextRenderInfo({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},et=>{this._isSyncing=!1,this._textRenderInfo=et,this.geometry.updateGlyphs(et.glyphBounds,et.glyphAtlasIndices,et.blockBounds,et.chunkedBounds,et.glyphColors);const rt=this._queuedSyncs;rt&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{rt.forEach(it=>it&&it())})),this.dispatchEvent(syncCompleteEvent),_e&&_e()})))}onBeforeRender(_e,et,rt,it,st,ot){this.sync(),st.isTroikaTextMaterial&&this._prepareForRender(st),st._hadOwnSide=st.hasOwnProperty("side"),this.geometry.setSide(st._actualSide=st.side),st.side=FrontSide$1}onAfterRender(_e,et,rt,it,st,ot){st._hadOwnSide?st.side=st._actualSide:delete st.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let _e=this._derivedMaterial;const et=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=defaultMaterial.clone());if((!_e||_e.baseMaterial!==et)&&(_e=this._derivedMaterial=createTextDerivedMaterial(et),et.addEventListener("dispose",function rt(){et.removeEventListener("dispose",rt),_e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let rt=_e._outlineMtl;return rt||(rt=_e._outlineMtl=Object.create(_e,{id:{value:_e.id+.1}}),rt.isTextOutlineMaterial=!0,rt.depthWrite=!1,rt.map=null,_e.addEventListener("dispose",function it(){_e.removeEventListener("dispose",it),rt.dispose()})),[rt,_e]}else return _e}set material(_e){_e&&_e.isTroikaTextMaterial?(this._derivedMaterial=_e,this._baseMaterial=_e.baseMaterial):this._baseMaterial=_e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(_e){this.geometry.detail=_e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(_e){this.geometry.curveRadius=_e}get customDepthMaterial(){return first(this.material).getDepthMaterial()}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}_prepareForRender(_e){const et=_e.isTextOutlineMaterial,rt=_e.uniforms,it=this.textRenderInfo;if(it){const{sdfTexture:at,blockBounds:lt}=it;rt.uTroikaSDFTexture.value=at,rt.uTroikaSDFTextureSize.value.set(at.image.width,at.image.height),rt.uTroikaSDFGlyphSize.value=it.sdfGlyphSize,rt.uTroikaSDFExponent.value=it.sdfExponent,rt.uTroikaTotalBounds.value.fromArray(lt),rt.uTroikaUseGlyphColors.value=!et&&!!it.glyphColors;let ct=0,ut=0,ht=0,dt,ft,pt,mt=0,At=0;if(et){let{outlineWidth:bt,outlineOffsetX:Tt,outlineOffsetY:wt,outlineBlur:Rt,outlineOpacity:It}=this;ct=this._parsePercent(bt)||0,ut=Math.max(0,this._parsePercent(Rt)||0),dt=It,mt=this._parsePercent(Tt)||0,At=this._parsePercent(wt)||0}else ht=Math.max(0,this._parsePercent(this.strokeWidth)||0),ht&&(pt=this.strokeColor,rt.uTroikaStrokeColor.value.set(pt??defaultStrokeColor),ft=this.strokeOpacity,ft==null&&(ft=1)),dt=this.fillOpacity;rt.uTroikaDistanceOffset.value=ct,rt.uTroikaPositionOffset.value.set(mt,At),rt.uTroikaBlurRadius.value=ut,rt.uTroikaStrokeWidth.value=ht,rt.uTroikaStrokeOpacity.value=ft,rt.uTroikaFillOpacity.value=dt??1,rt.uTroikaCurveRadius.value=this.curveRadius||0;let gt=this.clipRect;if(gt&&Array.isArray(gt)&&gt.length===4)rt.uTroikaClipRect.value.fromArray(gt);else{const bt=(this.fontSize||.1)*100;rt.uTroikaClipRect.value.set(lt[0]-bt,lt[1]-bt,lt[2]+bt,lt[3]+bt)}this.geometry.applyClipRect(rt.uTroikaClipRect.value)}rt.uTroikaSDFDebug.value=!!this.debugSDF,_e.polygonOffset=!!this.depthOffset,_e.polygonOffsetFactor=_e.polygonOffsetUnits=this.depthOffset||0;const st=et?this.outlineColor||0:this.color;if(st==null)delete _e.color;else{const at=_e.hasOwnProperty("color")?_e.color:_e.color=new Color$2;(st!==at._input||typeof st=="object")&&at.set(at._input=st)}let ot=this.orientation||defaultOrient;if(ot!==_e._orientation){let at=rt.uTroikaOrient.value;ot=ot.replace(/[^-+xyz]/g,"");let lt=ot!==defaultOrient&&ot.match(/^([-+])([xyz])([-+])([xyz])$/);if(lt){let[,ct,ut,ht,dt]=lt;tempVec3a.set(0,0,0)[ut]=ct==="-"?1:-1,tempVec3b.set(0,0,0)[dt]=ht==="-"?-1:1,tempMat4.lookAt(origin,tempVec3a.cross(tempVec3b),tempVec3b),at.setFromMatrix4(tempMat4)}else at.identity();_e._orientation=ot}}_parsePercent(_e){if(typeof _e=="string"){let et=_e.match(/^(-?[\d.]+)%$/),rt=et?parseFloat(et[1]):NaN;_e=(isNaN(rt)?0:rt/100)*this.fontSize}return _e}localPositionToTextCoords(_e,et=new Vector2$1){et.copy(_e);const rt=this.curveRadius;return rt&&(et.x=Math.atan2(_e.x,Math.abs(rt)-Math.abs(_e.z))*Math.abs(rt)),et}worldPositionToTextCoords(_e,et=new Vector2$1){return tempVec3a.copy(_e),this.localPositionToTextCoords(this.worldToLocal(tempVec3a),et)}raycast(_e,et){const{textRenderInfo:rt,curveRadius:it}=this;if(rt){const st=rt.blockBounds,ot=it?getCurvedRaycastMesh():getFlatRaycastMesh(),at=ot.geometry,{position:lt,uv:ct}=at.attributes;for(let ut=0;ut<ct.count;ut++){let ht=st[0]+ct.getX(ut)*(st[2]-st[0]);const dt=st[1]+ct.getY(ut)*(st[3]-st[1]);let ft=0;it&&(ft=it-Math.cos(ht/it)*it,ht=Math.sin(ht/it)*it),lt.setXYZ(ut,ht,dt,ft)}at.boundingSphere=this.geometry.boundingSphere,at.boundingBox=this.geometry.boundingBox,ot.matrixWorld=this.matrixWorld,ot.material.side=this.material.side,tempArray.length=0,ot.raycast(_e,tempArray);for(let ut=0;ut<tempArray.length;ut++)tempArray[ut].object=this,et.push(tempArray[ut])}}copy(_e){const et=this.geometry;return super.copy(_e),this.geometry=et,COPYABLE_PROPS.forEach(rt=>{this[rt]=_e[rt]}),this}clone(){return new this.constructor().copy(this)}};SYNCABLE_PROPS.forEach(nt=>{const _e="_private_"+nt;Object.defineProperty(Text$1.prototype,nt,{get(){return this[_e]},set(et){et!==this[_e]&&(this[_e]=et,this._needsSync=!0)}})});const Text=reactExports.forwardRef(({sdfGlyphSize:nt=64,anchorX:_e="center",anchorY:et="middle",font:rt,fontSize:it=1,children:st,characters:ot,onSync:at,...lt},ct)=>{const ut=useThree(({invalidate:pt})=>pt),[ht]=reactExports.useState(()=>new Text$1),[dt,ft]=reactExports.useMemo(()=>{const pt=[];let mt="";return reactExports.Children.forEach(st,At=>{typeof At=="string"||typeof At=="number"?mt+=At:pt.push(At)}),[pt,mt]},[st]);return suspend(()=>new Promise(pt=>preloadFont({font:rt,characters:ot},pt)),["troika-text",rt,ot]),reactExports.useLayoutEffect(()=>void ht.sync(()=>{ut(),at&&at(ht)})),reactExports.useEffect(()=>()=>ht.dispose(),[ht]),reactExports.createElement("primitive",_extends$2({object:ht,ref:ct,font:rt,text:ft,anchorX:_e,anchorY:et,fontSize:it,sdfGlyphSize:nt},lt),dt)}),getVersion=()=>parseInt(REVISION$1.replace(/\D+/g,"")),version=getVersion();let dracoLoader=null,decoderPath="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function extensions(nt=!0,_e=!0,et){return rt=>{et&&et(rt),nt&&(dracoLoader||(dracoLoader=new DRACOLoader),dracoLoader.setDecoderPath(typeof nt=="string"?nt:decoderPath),rt.setDRACOLoader(dracoLoader)),_e&&rt.setMeshoptDecoder(typeof MeshoptDecoder=="function"?MeshoptDecoder():MeshoptDecoder)}}const useGLTF=(nt,_e,et,rt)=>useLoader(GLTFLoader,nt,extensions(_e,et,rt));useGLTF.preload=(nt,_e,et,rt)=>useLoader.preload(GLTFLoader,nt,extensions(_e,et,rt));useGLTF.clear=nt=>useLoader.clear(GLTFLoader,nt);useGLTF.setDecoderPath=nt=>{decoderPath=nt};function useFBO(nt,_e,et){const rt=useThree(dt=>dt.size),it=useThree(dt=>dt.viewport),st=typeof nt=="number"?nt:rt.width*it.dpr,ot=typeof _e=="number"?_e:rt.height*it.dpr,at=(typeof nt=="number"?et:nt)||{},{samples:lt=0,depth:ct,...ut}=at,ht=reactExports.useMemo(()=>{const dt=new WebGLRenderTarget$1(st,ot,{minFilter:LinearFilter$1,magFilter:LinearFilter$1,type:HalfFloatType$1,...ut});return ct&&(dt.depthTexture=new DepthTexture$1(st,ot,FloatType$1)),dt.samples=lt,dt},[]);return reactExports.useLayoutEffect(()=>{ht.setSize(st,ot),lt&&(ht.samples=lt)},[lt,ht,st,ot]),reactExports.useEffect(()=>()=>ht.dispose(),[]),ht}const isFunction=nt=>typeof nt=="function",PerspectiveCamera$1=reactExports.forwardRef(({envMap:nt,resolution:_e=256,frames:et=1/0,makeDefault:rt,children:it,...st},ot)=>{const at=useThree(({set:At})=>At),lt=useThree(({camera:At})=>At),ct=useThree(({size:At})=>At),ut=reactExports.useRef(null);reactExports.useImperativeHandle(ot,()=>ut.current,[]);const ht=reactExports.useRef(null),dt=useFBO(_e);reactExports.useLayoutEffect(()=>{st.manual||(ut.current.aspect=ct.width/ct.height)},[ct,st]),reactExports.useLayoutEffect(()=>{ut.current.updateProjectionMatrix()});let ft=0,pt=null;const mt=isFunction(it);return useFrame(At=>{mt&&(et===1/0||ft<et)&&(ht.current.visible=!1,At.gl.setRenderTarget(dt),pt=At.scene.background,nt&&(At.scene.background=nt),At.gl.render(At.scene,ut.current),At.scene.background=pt,At.gl.setRenderTarget(null),ht.current.visible=!0,ft++)}),reactExports.useLayoutEffect(()=>{if(rt){const At=lt;return at(()=>({camera:ut.current})),()=>at(()=>({camera:At}))}},[ut,rt,at]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("perspectiveCamera",_extends$2({ref:ut},st),!mt&&it),reactExports.createElement("group",{ref:ht},mt&&it(dt.texture)))}),OrbitControls$1=reactExports.forwardRef(({makeDefault:nt,camera:_e,regress:et,domElement:rt,enableDamping:it=!0,keyEvents:st=!1,onChange:ot,onStart:at,onEnd:lt,...ct},ut)=>{const ht=useThree(It=>It.invalidate),dt=useThree(It=>It.camera),ft=useThree(It=>It.gl),pt=useThree(It=>It.events),mt=useThree(It=>It.setEvents),At=useThree(It=>It.set),gt=useThree(It=>It.get),bt=useThree(It=>It.performance),Tt=_e||dt,wt=rt||pt.connected||ft.domElement,Rt=reactExports.useMemo(()=>new OrbitControls$2(Tt),[Tt]);return useFrame(()=>{Rt.enabled&&Rt.update()},-1),reactExports.useEffect(()=>(st&&Rt.connect(st===!0?wt:st),Rt.connect(wt),()=>void Rt.dispose()),[st,wt,et,Rt,ht]),reactExports.useEffect(()=>{const It=kt=>{ht(),et&&bt.regress(),ot&&ot(kt)},Lt=kt=>{at&&at(kt)},$t=kt=>{lt&&lt(kt)};return Rt.addEventListener("change",It),Rt.addEventListener("start",Lt),Rt.addEventListener("end",$t),()=>{Rt.removeEventListener("start",Lt),Rt.removeEventListener("end",$t),Rt.removeEventListener("change",It)}},[ot,at,lt,Rt,ht,mt]),reactExports.useEffect(()=>{if(nt){const It=gt().controls;return At({controls:Rt}),()=>At({controls:It})}},[nt,Rt]),reactExports.createElement("primitive",_extends$2({ref:ut,object:Rt,enableDamping:it},ct))}),scriptRel="modulepreload",assetsURL=function(nt){return"/"+nt},seen={},__vitePreload=function(_e,et,rt){let it=Promise.resolve();if(et&&et.length>0){document.getElementsByTagName("link");const ot=document.querySelector("meta[property=csp-nonce]"),at=(ot==null?void 0:ot.nonce)||(ot==null?void 0:ot.getAttribute("nonce"));it=Promise.allSettled(et.map(lt=>{if(lt=assetsURL(lt),lt in seen)return;seen[lt]=!0;const ct=lt.endsWith(".css"),ut=ct?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${lt}"]${ut}`))return;const ht=document.createElement("link");if(ht.rel=ct?"stylesheet":scriptRel,ct||(ht.as="script"),ht.crossOrigin="",ht.href=lt,at&&ht.setAttribute("nonce",at),document.head.appendChild(ht),ct)return new Promise((dt,ft)=>{ht.addEventListener("load",dt),ht.addEventListener("error",()=>ft(new Error(`Unable to preload CSS for ${lt}`)))})}))}function st(ot){const at=new Event("vite:preloadError",{cancelable:!0});if(at.payload=ot,window.dispatchEvent(at),!at.defaultPrevented)throw ot}return it.then(ot=>{for(const at of ot||[])at.status==="rejected"&&st(at.reason);return _e().catch(st)})};function getDefaultExportFromCjs(nt){return nt&&nt.__esModule&&Object.prototype.hasOwnProperty.call(nt,"default")?nt.default:nt}var urlToolkit={exports:{}};(function(nt,_e){(function(et){var rt=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,it=/^(?=([^\/?#]*))\1([^]*)$/,st=/(?:\/|^)\.(?=\/)/g,ot=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,at={buildAbsoluteURL:function(lt,ct,ut){if(ut=ut||{},lt=lt.trim(),ct=ct.trim(),!ct){if(!ut.alwaysNormalize)return lt;var ht=at.parseURL(lt);if(!ht)throw new Error("Error trying to parse base URL.");return ht.path=at.normalizePath(ht.path),at.buildURLFromParts(ht)}var dt=at.parseURL(ct);if(!dt)throw new Error("Error trying to parse relative URL.");if(dt.scheme)return ut.alwaysNormalize?(dt.path=at.normalizePath(dt.path),at.buildURLFromParts(dt)):ct;var ft=at.parseURL(lt);if(!ft)throw new Error("Error trying to parse base URL.");if(!ft.netLoc&&ft.path&&ft.path[0]!=="/"){var pt=it.exec(ft.path);ft.netLoc=pt[1],ft.path=pt[2]}ft.netLoc&&!ft.path&&(ft.path="/");var mt={scheme:ft.scheme,netLoc:dt.netLoc,path:null,params:dt.params,query:dt.query,fragment:dt.fragment};if(!dt.netLoc&&(mt.netLoc=ft.netLoc,dt.path[0]!=="/"))if(!dt.path)mt.path=ft.path,dt.params||(mt.params=ft.params,dt.query||(mt.query=ft.query));else{var At=ft.path,gt=At.substring(0,At.lastIndexOf("/")+1)+dt.path;mt.path=at.normalizePath(gt)}return mt.path===null&&(mt.path=ut.alwaysNormalize?at.normalizePath(dt.path):dt.path),at.buildURLFromParts(mt)},parseURL:function(lt){var ct=rt.exec(lt);return ct?{scheme:ct[1]||"",netLoc:ct[2]||"",path:ct[3]||"",params:ct[4]||"",query:ct[5]||"",fragment:ct[6]||""}:null},normalizePath:function(lt){for(lt=lt.split("").reverse().join("").replace(st,"");lt.length!==(lt=lt.replace(ot,"")).length;);return lt.split("").reverse().join("")},buildURLFromParts:function(lt){return lt.scheme+lt.netLoc+lt.path+lt.params+lt.query+lt.fragment}};nt.exports=at})()})(urlToolkit);var urlToolkitExports=urlToolkit.exports;function ownKeys$3(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread2$3(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$3(Object(et),!0).forEach(function(rt){_defineProperty$5(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$3(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}function _toPrimitive$6(nt,_e){if(typeof nt!="object"||!nt)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey$6(nt){var _e=_toPrimitive$6(nt,"string");return typeof _e=="symbol"?_e:String(_e)}function _defineProperty$5(nt,_e,et){return _e=_toPropertyKey$6(_e),_e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e];for(var rt in et)Object.prototype.hasOwnProperty.call(et,rt)&&(nt[rt]=et[rt])}return nt},_extends$1.apply(this,arguments)}const isFiniteNumber=Number.isFinite||function(nt){return typeof nt=="number"&&isFinite(nt)},isSafeInteger=Number.isSafeInteger||function(nt){return typeof nt=="number"&&Math.abs(nt)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;let Events=function(nt){return nt.MEDIA_ATTACHING="hlsMediaAttaching",nt.MEDIA_ATTACHED="hlsMediaAttached",nt.MEDIA_DETACHING="hlsMediaDetaching",nt.MEDIA_DETACHED="hlsMediaDetached",nt.BUFFER_RESET="hlsBufferReset",nt.BUFFER_CODECS="hlsBufferCodecs",nt.BUFFER_CREATED="hlsBufferCreated",nt.BUFFER_APPENDING="hlsBufferAppending",nt.BUFFER_APPENDED="hlsBufferAppended",nt.BUFFER_EOS="hlsBufferEos",nt.BUFFER_FLUSHING="hlsBufferFlushing",nt.BUFFER_FLUSHED="hlsBufferFlushed",nt.MANIFEST_LOADING="hlsManifestLoading",nt.MANIFEST_LOADED="hlsManifestLoaded",nt.MANIFEST_PARSED="hlsManifestParsed",nt.LEVEL_SWITCHING="hlsLevelSwitching",nt.LEVEL_SWITCHED="hlsLevelSwitched",nt.LEVEL_LOADING="hlsLevelLoading",nt.LEVEL_LOADED="hlsLevelLoaded",nt.LEVEL_UPDATED="hlsLevelUpdated",nt.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",nt.LEVELS_UPDATED="hlsLevelsUpdated",nt.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",nt.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",nt.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",nt.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",nt.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",nt.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",nt.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",nt.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",nt.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",nt.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",nt.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",nt.CUES_PARSED="hlsCuesParsed",nt.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",nt.INIT_PTS_FOUND="hlsInitPtsFound",nt.FRAG_LOADING="hlsFragLoading",nt.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",nt.FRAG_LOADED="hlsFragLoaded",nt.FRAG_DECRYPTED="hlsFragDecrypted",nt.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",nt.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",nt.FRAG_PARSING_METADATA="hlsFragParsingMetadata",nt.FRAG_PARSED="hlsFragParsed",nt.FRAG_BUFFERED="hlsFragBuffered",nt.FRAG_CHANGED="hlsFragChanged",nt.FPS_DROP="hlsFpsDrop",nt.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",nt.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",nt.ERROR="hlsError",nt.DESTROYING="hlsDestroying",nt.KEY_LOADING="hlsKeyLoading",nt.KEY_LOADED="hlsKeyLoaded",nt.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",nt.BACK_BUFFER_REACHED="hlsBackBufferReached",nt.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",nt}({}),ErrorTypes=function(nt){return nt.NETWORK_ERROR="networkError",nt.MEDIA_ERROR="mediaError",nt.KEY_SYSTEM_ERROR="keySystemError",nt.MUX_ERROR="muxError",nt.OTHER_ERROR="otherError",nt}({}),ErrorDetails=function(nt){return nt.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",nt.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",nt.KEY_SYSTEM_NO_SESSION="keySystemNoSession",nt.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",nt.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",nt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",nt.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",nt.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",nt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",nt.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",nt.MANIFEST_LOAD_ERROR="manifestLoadError",nt.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",nt.MANIFEST_PARSING_ERROR="manifestParsingError",nt.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",nt.LEVEL_EMPTY_ERROR="levelEmptyError",nt.LEVEL_LOAD_ERROR="levelLoadError",nt.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",nt.LEVEL_PARSING_ERROR="levelParsingError",nt.LEVEL_SWITCH_ERROR="levelSwitchError",nt.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",nt.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",nt.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",nt.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",nt.FRAG_LOAD_ERROR="fragLoadError",nt.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",nt.FRAG_DECRYPT_ERROR="fragDecryptError",nt.FRAG_PARSING_ERROR="fragParsingError",nt.FRAG_GAP="fragGap",nt.REMUX_ALLOC_ERROR="remuxAllocError",nt.KEY_LOAD_ERROR="keyLoadError",nt.KEY_LOAD_TIMEOUT="keyLoadTimeOut",nt.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",nt.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",nt.BUFFER_APPEND_ERROR="bufferAppendError",nt.BUFFER_APPENDING_ERROR="bufferAppendingError",nt.BUFFER_STALLED_ERROR="bufferStalledError",nt.BUFFER_FULL_ERROR="bufferFullError",nt.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",nt.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",nt.INTERNAL_EXCEPTION="internalException",nt.INTERNAL_ABORTED="aborted",nt.UNKNOWN="unknown",nt}({});const noop$2=function(){},fakeLogger={trace:noop$2,debug:noop$2,log:noop$2,warn:noop$2,info:noop$2,error:noop$2};let exportedLogger=fakeLogger;function consolePrintFn(nt){const _e=self.console[nt];return _e?_e.bind(self.console,`[${nt}] >`):noop$2}function exportLoggerFunctions(nt,..._e){_e.forEach(function(et){exportedLogger[et]=nt[et]?nt[et].bind(nt):consolePrintFn(et)})}function enableLogs(nt,_e){if(typeof console=="object"&&nt===!0||typeof nt=="object"){exportLoggerFunctions(nt,"debug","log","info","warn","error");try{exportedLogger.log(`Debug logs enabled for "${_e}" in hls.js version 1.5.17`)}catch{exportedLogger=fakeLogger}}else exportedLogger=fakeLogger}const logger=exportedLogger,DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(_e){typeof _e=="string"&&(_e=AttrList.parseAttrList(_e)),_extends$1(this,_e)}get clientAttrs(){return Object.keys(this).filter(_e=>_e.substring(0,2)==="X-")}decimalInteger(_e){const et=parseInt(this[_e],10);return et>Number.MAX_SAFE_INTEGER?1/0:et}hexadecimalInteger(_e){if(this[_e]){let et=(this[_e]||"0x").slice(2);et=(et.length&1?"0":"")+et;const rt=new Uint8Array(et.length/2);for(let it=0;it<et.length/2;it++)rt[it]=parseInt(et.slice(it*2,it*2+2),16);return rt}else return null}hexadecimalIntegerAsNumber(_e){const et=parseInt(this[_e],16);return et>Number.MAX_SAFE_INTEGER?1/0:et}decimalFloatingPoint(_e){return parseFloat(this[_e])}optionalFloat(_e,et){const rt=this[_e];return rt?parseFloat(rt):et}enumeratedString(_e){return this[_e]}bool(_e){return this[_e]==="YES"}decimalResolution(_e){const et=DECIMAL_RESOLUTION_REGEX.exec(this[_e]);if(et!==null)return{width:parseInt(et[1],10),height:parseInt(et[2],10)}}static parseAttrList(_e){let et;const rt={},it='"';for(ATTR_LIST_REGEX.lastIndex=0;(et=ATTR_LIST_REGEX.exec(_e))!==null;){let st=et[2];st.indexOf(it)===0&&st.lastIndexOf(it)===st.length-1&&(st=st.slice(1,-1));const ot=et[1].trim();rt[ot]=st}return rt}}function isDateRangeCueAttribute(nt){return nt!=="ID"&&nt!=="CLASS"&&nt!=="START-DATE"&&nt!=="DURATION"&&nt!=="END-DATE"&&nt!=="END-ON-NEXT"}function isSCTE35Attribute(nt){return nt==="SCTE35-OUT"||nt==="SCTE35-IN"}class DateRange{constructor(_e,et){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,et){const rt=et.attr;for(const it in rt)if(Object.prototype.hasOwnProperty.call(_e,it)&&_e[it]!==rt[it]){logger.warn(`DATERANGE tag attribute: "${it}" does not match for tags with ID: "${_e.ID}"`),this._badValueForSameId=it;break}_e=_extends$1(new AttrList({}),rt,_e)}if(this.attr=_e,this._startDate=new Date(_e["START-DATE"]),"END-DATE"in this.attr){const rt=new Date(this.attr["END-DATE"]);isFiniteNumber(rt.getTime())&&(this._endDate=rt)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const _e=this.duration;return _e!==null?new Date(this._startDate.getTime()+_e*1e3):null}get duration(){if("DURATION"in this.attr){const _e=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(_e))return _e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class BaseSegment{constructor(_e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ElementaryStreamTypes.AUDIO]:null,[ElementaryStreamTypes.VIDEO]:null,[ElementaryStreamTypes.AUDIOVIDEO]:null},this.baseurl=_e}setByteRange(_e,et){const rt=_e.split("@",2);let it;rt.length===1?it=(et==null?void 0:et.byteRangeEndOffset)||0:it=parseInt(rt[1]),this._byteRange=[it,parseInt(rt[0])+it]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(_e){this._url=_e}}class Fragment extends BaseSegment{constructor(_e,et){super(et),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new LoadStats,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=_e}get decryptdata(){const{levelkeys:_e}=this;if(!_e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const et=this.levelkeys.identity;if(et)this._decryptdata=et.getDecryptData(this.sn);else{const rt=Object.keys(this.levelkeys);if(rt.length===1)return this._decryptdata=this.levelkeys[rt[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!isFiniteNumber(this.programDateTime))return null;const _e=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+_e*1e3}get encrypted(){var _e;if((_e=this._decryptdata)!=null&&_e.encrypted)return!0;if(this.levelkeys){const et=Object.keys(this.levelkeys),rt=et.length;if(rt>1||rt===1&&this.levelkeys[et[0]].encrypted)return!0}return!1}setKeyFormat(_e){if(this.levelkeys){const et=this.levelkeys[_e];et&&!this._decryptdata&&(this._decryptdata=et.getDecryptData(this.sn))}}abortRequests(){var _e,et;(_e=this.loader)==null||_e.abort(),(et=this.keyLoader)==null||et.abort()}setElementaryStreamInfo(_e,et,rt,it,st,ot=!1){const{elementaryStreams:at}=this,lt=at[_e];if(!lt){at[_e]={startPTS:et,endPTS:rt,startDTS:it,endDTS:st,partial:ot};return}lt.startPTS=Math.min(lt.startPTS,et),lt.endPTS=Math.max(lt.endPTS,rt),lt.startDTS=Math.min(lt.startDTS,it),lt.endDTS=Math.max(lt.endDTS,st)}clearElementaryStreamInfo(){const{elementaryStreams:_e}=this;_e[ElementaryStreamTypes.AUDIO]=null,_e[ElementaryStreamTypes.VIDEO]=null,_e[ElementaryStreamTypes.AUDIOVIDEO]=null}}class Part extends BaseSegment{constructor(_e,et,rt,it,st){super(rt),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new LoadStats,this.duration=_e.decimalFloatingPoint("DURATION"),this.gap=_e.bool("GAP"),this.independent=_e.bool("INDEPENDENT"),this.relurl=_e.enumeratedString("URI"),this.fragment=et,this.index=it;const ot=_e.enumeratedString("BYTERANGE");ot&&this.setByteRange(ot,st),st&&(this.fragOffset=st.fragOffset+st.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:_e}=this;return!!(_e.audio||_e.video||_e.audiovideo)}}const DEFAULT_TARGET_DURATION=10;class LevelDetails{constructor(_e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=_e}reloaded(_e){if(!_e){this.advanced=!0,this.updated=!0;return}const et=this.lastPartSn-_e.lastPartSn,rt=this.lastPartIndex-_e.lastPartIndex;this.updated=this.endSN!==_e.endSN||!!rt||!!et||!this.live,this.advanced=this.endSN>_e.endSN||et>0||et===0&&rt>0,this.updated||this.advanced?this.misses=Math.floor(_e.misses*.6):this.misses=_e.misses+1,this.availabilityDelay=_e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||DEFAULT_TARGET_DURATION}get drift(){const _e=this.driftEndTime-this.driftStartTime;return _e>0?(this.driftEnd-this.driftStart)*1e3/_e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var _e;return(_e=this.partList)!=null&&_e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var _e;return(_e=this.fragments)!=null&&_e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var _e;return(_e=this.partList)!=null&&_e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var _e;return(_e=this.partList)!=null&&_e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function base64Decode(nt){return Uint8Array.from(atob(nt),_e=>_e.charCodeAt(0))}function getKeyIdBytes(nt){const _e=strToUtf8array(nt).subarray(0,16),et=new Uint8Array(16);return et.set(_e,16-_e.length),et}function changeEndianness(nt){const _e=function(rt,it,st){const ot=rt[it];rt[it]=rt[st],rt[st]=ot};_e(nt,0,3),_e(nt,1,2),_e(nt,4,5),_e(nt,6,7)}function convertDataUriToArrayBytes(nt){const _e=nt.split(":");let et=null;if(_e[0]==="data"&&_e.length===2){const rt=_e[1].split(";"),it=rt[rt.length-1].split(",");if(it.length===2){const st=it[0]==="base64",ot=it[1];st?(rt.splice(-1,1),et=base64Decode(ot)):et=getKeyIdBytes(ot)}}return et}function strToUtf8array(nt){return Uint8Array.from(unescape(encodeURIComponent(nt)),_e=>_e.charCodeAt(0))}const optionalSelf=typeof self<"u"?self:void 0;var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function keySystemFormatToKeySystemDomain(nt){switch(nt){case KeySystemFormats.FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats.PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats.WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats.CLEARKEY:return KeySystems.CLEARKEY}}var KeySystemIds={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function keySystemIdToKeySystemDomain(nt){if(nt===KeySystemIds.WIDEVINE)return KeySystems.WIDEVINE;if(nt===KeySystemIds.PLAYREADY)return KeySystems.PLAYREADY;if(nt===KeySystemIds.CENC||nt===KeySystemIds.CLEARKEY)return KeySystems.CLEARKEY}function keySystemDomainToKeySystemFormat(nt){switch(nt){case KeySystems.FAIRPLAY:return KeySystemFormats.FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats.PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats.WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats.CLEARKEY}}function getKeySystemsForConfig(nt){const{drmSystems:_e,widevineLicenseUrl:et}=nt,rt=_e?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter(it=>!!_e[it]):[];return!rt[KeySystems.WIDEVINE]&&et&&rt.push(KeySystems.WIDEVINE),rt}const requestMediaKeySystemAccess=function(nt){return optionalSelf!=null&&(nt=optionalSelf.navigator)!=null&&nt.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function getSupportedMediaKeySystemConfigurations(nt,_e,et,rt){let it;switch(nt){case KeySystems.FAIRPLAY:it=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:it=["cenc"];break;case KeySystems.CLEARKEY:it=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${nt}`)}return createMediaKeySystemConfigurations(it,_e,et,rt)}function createMediaKeySystemConfigurations(nt,_e,et,rt){return[{initDataTypes:nt,persistentState:rt.persistentState||"optional",distinctiveIdentifier:rt.distinctiveIdentifier||"optional",sessionTypes:rt.sessionTypes||[rt.sessionType||"temporary"],audioCapabilities:_e.map(st=>({contentType:`audio/mp4; codecs="${st}"`,robustness:rt.audioRobustness||"",encryptionScheme:rt.audioEncryptionScheme||null})),videoCapabilities:et.map(st=>({contentType:`video/mp4; codecs="${st}"`,robustness:rt.videoRobustness||"",encryptionScheme:rt.videoEncryptionScheme||null}))}]}function sliceUint8(nt,_e,et){return Uint8Array.prototype.slice?nt.slice(_e,et):new Uint8Array(Array.prototype.slice.call(nt,_e,et))}const isHeader$2=(nt,_e)=>_e+10<=nt.length&&nt[_e]===73&&nt[_e+1]===68&&nt[_e+2]===51&&nt[_e+3]<255&&nt[_e+4]<255&&nt[_e+6]<128&&nt[_e+7]<128&&nt[_e+8]<128&&nt[_e+9]<128,isFooter=(nt,_e)=>_e+10<=nt.length&&nt[_e]===51&&nt[_e+1]===68&&nt[_e+2]===73&&nt[_e+3]<255&&nt[_e+4]<255&&nt[_e+6]<128&&nt[_e+7]<128&&nt[_e+8]<128&&nt[_e+9]<128,getID3Data=(nt,_e)=>{const et=_e;let rt=0;for(;isHeader$2(nt,_e);){rt+=10;const it=readSize(nt,_e+6);rt+=it,isFooter(nt,_e+10)&&(rt+=10),_e+=rt}if(rt>0)return nt.subarray(et,et+rt)},readSize=(nt,_e)=>{let et=0;return et=(nt[_e]&127)<<21,et|=(nt[_e+1]&127)<<14,et|=(nt[_e+2]&127)<<7,et|=nt[_e+3]&127,et},canParse$2=(nt,_e)=>isHeader$2(nt,_e)&&readSize(nt,_e+6)+10<=nt.length-_e,getTimeStamp=nt=>{const _e=getID3Frames(nt);for(let et=0;et<_e.length;et++){const rt=_e[et];if(isTimeStampFrame(rt))return readTimeStamp(rt)}},isTimeStampFrame=nt=>nt&&nt.key==="PRIV"&&nt.info==="com.apple.streaming.transportStreamTimestamp",getFrameData=nt=>{const _e=String.fromCharCode(nt[0],nt[1],nt[2],nt[3]),et=readSize(nt,4),rt=10;return{type:_e,size:et,data:nt.subarray(rt,rt+et)}},getID3Frames=nt=>{let _e=0;const et=[];for(;isHeader$2(nt,_e);){const rt=readSize(nt,_e+6);_e+=10;const it=_e+rt;for(;_e+8<it;){const st=getFrameData(nt.subarray(_e)),ot=decodeFrame(st);ot&&et.push(ot),_e+=st.size+10}isFooter(nt,_e)&&(_e+=10)}return et},decodeFrame=nt=>nt.type==="PRIV"?decodePrivFrame(nt):nt.type[0]==="W"?decodeURLFrame(nt):decodeTextFrame(nt),decodePrivFrame=nt=>{if(nt.size<2)return;const _e=utf8ArrayToStr(nt.data,!0),et=new Uint8Array(nt.data.subarray(_e.length+1));return{key:nt.type,info:_e,data:et.buffer}},decodeTextFrame=nt=>{if(nt.size<2)return;if(nt.type==="TXXX"){let et=1;const rt=utf8ArrayToStr(nt.data.subarray(et),!0);et+=rt.length+1;const it=utf8ArrayToStr(nt.data.subarray(et));return{key:nt.type,info:rt,data:it}}const _e=utf8ArrayToStr(nt.data.subarray(1));return{key:nt.type,data:_e}},decodeURLFrame=nt=>{if(nt.type==="WXXX"){if(nt.size<2)return;let et=1;const rt=utf8ArrayToStr(nt.data.subarray(et),!0);et+=rt.length+1;const it=utf8ArrayToStr(nt.data.subarray(et));return{key:nt.type,info:rt,data:it}}const _e=utf8ArrayToStr(nt.data);return{key:nt.type,data:_e}},readTimeStamp=nt=>{if(nt.data.byteLength===8){const _e=new Uint8Array(nt.data),et=_e[3]&1;let rt=(_e[4]<<23)+(_e[5]<<15)+(_e[6]<<7)+_e[7];return rt/=45,et&&(rt+=4772185884e-2),Math.round(rt)}},utf8ArrayToStr=(nt,_e=!1)=>{const et=getTextDecoder();if(et){const ct=et.decode(nt);if(_e){const ut=ct.indexOf("\0");return ut!==-1?ct.substring(0,ut):ct}return ct.replace(/\0/g,"")}const rt=nt.length;let it,st,ot,at="",lt=0;for(;lt<rt;){if(it=nt[lt++],it===0&&_e)return at;if(it===0||it===3)continue;switch(it>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:at+=String.fromCharCode(it);break;case 12:case 13:st=nt[lt++],at+=String.fromCharCode((it&31)<<6|st&63);break;case 14:st=nt[lt++],ot=nt[lt++],at+=String.fromCharCode((it&15)<<12|(st&63)<<6|(ot&63)<<0);break}}return at};let decoder;function getTextDecoder(){if(!navigator.userAgent.includes("PlayStation 4"))return!decoder&&typeof self.TextDecoder<"u"&&(decoder=new self.TextDecoder("utf-8")),decoder}const Hex={hexDump:function(nt){let _e="";for(let et=0;et<nt.length;et++){let rt=nt[et].toString(16);rt.length<2&&(rt="0"+rt),_e+=rt}return _e}},UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(nt){return String.fromCharCode.apply(null,nt)}function readUint16(nt,_e){const et=nt[_e]<<8|nt[_e+1];return et<0?65536+et:et}function readUint32(nt,_e){const et=readSint32(nt,_e);return et<0?4294967296+et:et}function readUint64(nt,_e){let et=readUint32(nt,_e);return et*=Math.pow(2,32),et+=readUint32(nt,_e+4),et}function readSint32(nt,_e){return nt[_e]<<24|nt[_e+1]<<16|nt[_e+2]<<8|nt[_e+3]}function writeUint32(nt,_e,et){nt[_e]=et>>24,nt[_e+1]=et>>16&255,nt[_e+2]=et>>8&255,nt[_e+3]=et&255}function hasMoofData(nt){const _e=nt.byteLength;for(let et=0;et<_e;){const rt=readUint32(nt,et);if(rt>8&&nt[et+4]===109&&nt[et+5]===111&&nt[et+6]===111&&nt[et+7]===102)return!0;et=rt>1?et+rt:_e}return!1}function findBox(nt,_e){const et=[];if(!_e.length)return et;const rt=nt.byteLength;for(let it=0;it<rt;){const st=readUint32(nt,it),ot=bin2str(nt.subarray(it+4,it+8)),at=st>1?it+st:rt;if(ot===_e[0])if(_e.length===1)et.push(nt.subarray(it+8,at));else{const lt=findBox(nt.subarray(it+8,at),_e.slice(1));lt.length&&push.apply(et,lt)}it=at}return et}function parseSegmentIndex(nt){const _e=[],et=nt[0];let rt=8;const it=readUint32(nt,rt);rt+=4;let st=0,ot=0;et===0?(st=readUint32(nt,rt),ot=readUint32(nt,rt+4),rt+=8):(st=readUint64(nt,rt),ot=readUint64(nt,rt+8),rt+=16),rt+=2;let at=nt.length+ot;const lt=readUint16(nt,rt);rt+=2;for(let ct=0;ct<lt;ct++){let ut=rt;const ht=readUint32(nt,ut);ut+=4;const dt=ht&2147483647;if((ht&2147483648)>>>31===1)return logger.warn("SIDX has hierarchical references (not supported)"),null;const pt=readUint32(nt,ut);ut+=4,_e.push({referenceSize:dt,subsegmentDuration:pt,info:{duration:pt/it,start:at,end:at+dt-1}}),at+=dt,ut+=4,rt=ut}return{earliestPresentationTime:st,timescale:it,version:et,referencesCount:lt,references:_e}}function parseInitSegment(nt){const _e=[],et=findBox(nt,["moov","trak"]);for(let it=0;it<et.length;it++){const st=et[it],ot=findBox(st,["tkhd"])[0];if(ot){let at=ot[0];const lt=readUint32(ot,at===0?12:20),ct=findBox(st,["mdia","mdhd"])[0];if(ct){at=ct[0];const ut=readUint32(ct,at===0?12:20),ht=findBox(st,["mdia","hdlr"])[0];if(ht){const dt=bin2str(ht.subarray(8,12)),ft={soun:ElementaryStreamTypes.AUDIO,vide:ElementaryStreamTypes.VIDEO}[dt];if(ft){const pt=findBox(st,["mdia","minf","stbl","stsd"])[0],mt=parseStsd(pt);_e[lt]={timescale:ut,type:ft},_e[ft]=_objectSpread2$3({timescale:ut,id:lt},mt)}}}}}return findBox(nt,["moov","mvex","trex"]).forEach(it=>{const st=readUint32(it,4),ot=_e[st];ot&&(ot.default={duration:readUint32(it,12),flags:readUint32(it,20)})}),_e}function parseStsd(nt){const _e=nt.subarray(8),et=_e.subarray(86),rt=bin2str(_e.subarray(4,8));let it=rt;const st=rt==="enca"||rt==="encv";if(st){const at=findBox(_e,[rt])[0].subarray(rt==="enca"?28:78);findBox(at,["sinf"]).forEach(ct=>{const ut=findBox(ct,["schm"])[0];if(ut){const ht=bin2str(ut.subarray(4,8));if(ht==="cbcs"||ht==="cenc"){const dt=findBox(ct,["frma"])[0];dt&&(it=bin2str(dt))}}})}switch(it){case"avc1":case"avc2":case"avc3":case"avc4":{const ot=findBox(et,["avcC"])[0];it+="."+toHex(ot[1])+toHex(ot[2])+toHex(ot[3]);break}case"mp4a":{const ot=findBox(_e,[rt])[0],at=findBox(ot.subarray(28),["esds"])[0];if(at&&at.length>12){let lt=4;if(at[lt++]!==3)break;lt=skipBERInteger(at,lt),lt+=2;const ct=at[lt++];if(ct&128&&(lt+=2),ct&64&&(lt+=at[lt++]),at[lt++]!==4)break;lt=skipBERInteger(at,lt);const ut=at[lt++];if(ut===64)it+="."+toHex(ut);else break;if(lt+=12,at[lt++]!==5)break;lt=skipBERInteger(at,lt);const ht=at[lt++];let dt=(ht&248)>>3;dt===31&&(dt+=1+((ht&7)<<3)+((at[lt]&224)>>5)),it+="."+dt}break}case"hvc1":case"hev1":{const ot=findBox(et,["hvcC"])[0],at=ot[1],lt=["","A","B","C"][at>>6],ct=at&31,ut=readUint32(ot,2),ht=(at&32)>>5?"H":"L",dt=ot[12],ft=ot.subarray(6,12);it+="."+lt+ct,it+="."+ut.toString(16).toUpperCase(),it+="."+ht+dt;let pt="";for(let mt=ft.length;mt--;){const At=ft[mt];(At||pt)&&(pt="."+At.toString(16).toUpperCase()+pt)}it+=pt;break}case"dvh1":case"dvhe":{const ot=findBox(et,["dvcC"])[0],at=ot[2]>>1&127,lt=ot[2]<<5&32|ot[3]>>3&31;it+="."+addLeadingZero(at)+"."+addLeadingZero(lt);break}case"vp09":{const ot=findBox(et,["vpcC"])[0],at=ot[4],lt=ot[5],ct=ot[6]>>4&15;it+="."+addLeadingZero(at)+"."+addLeadingZero(lt)+"."+addLeadingZero(ct);break}case"av01":{const ot=findBox(et,["av1C"])[0],at=ot[1]>>>5,lt=ot[1]&31,ct=ot[2]>>>7?"H":"M",ut=(ot[2]&64)>>6,ht=(ot[2]&32)>>5,dt=at===2&&ut?ht?12:10:ut?10:8,ft=(ot[2]&16)>>4,pt=(ot[2]&8)>>3,mt=(ot[2]&4)>>2,At=ot[2]&3;it+="."+at+"."+addLeadingZero(lt)+ct+"."+addLeadingZero(dt)+"."+ft+"."+pt+mt+At+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+0;break}}return{codec:it,encrypted:st}}function skipBERInteger(nt,_e){const et=_e+5;for(;nt[_e++]&128&&_e<et;);return _e}function toHex(nt){return("0"+nt.toString(16).toUpperCase()).slice(-2)}function addLeadingZero(nt){return(nt<10?"0":"")+nt}function patchEncyptionData(nt,_e){if(!nt||!_e)return nt;const et=_e.keyId;return et&&_e.isCommonEncryption&&findBox(nt,["moov","trak"]).forEach(it=>{const ot=findBox(it,["mdia","minf","stbl","stsd"])[0].subarray(8);let at=findBox(ot,["enca"]);const lt=at.length>0;lt||(at=findBox(ot,["encv"])),at.forEach(ct=>{const ut=lt?ct.subarray(28):ct.subarray(78);findBox(ut,["sinf"]).forEach(dt=>{const ft=parseSinf(dt);if(ft){const pt=ft.subarray(8,24);pt.some(mt=>mt!==0)||(logger.log(`[eme] Patching keyId in 'enc${lt?"a":"v"}>sinf>>tenc' box: ${Hex.hexDump(pt)} -> ${Hex.hexDump(et)}`),ft.set(et,8))}})})}),nt}function parseSinf(nt){const _e=findBox(nt,["schm"])[0];if(_e){const et=bin2str(_e.subarray(4,8));if(et==="cbcs"||et==="cenc")return findBox(nt,["schi","tenc"])[0]}return null}function getStartDTS(nt,_e){return findBox(_e,["moof","traf"]).reduce((et,rt)=>{const it=findBox(rt,["tfdt"])[0],st=it[0],ot=findBox(rt,["tfhd"]).reduce((at,lt)=>{const ct=readUint32(lt,4),ut=nt[ct];if(ut){let ht=readUint32(it,4);if(st===1){if(ht===UINT32_MAX$1)return logger.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),at;ht*=UINT32_MAX$1+1,ht+=readUint32(it,8)}const dt=ut.timescale||9e4,ft=ht/dt;if(isFiniteNumber(ft)&&(at===null||ft<at))return ft}return at},null);return ot!==null&&isFiniteNumber(ot)&&(et===null||ot<et)?ot:et},null)}function getDuration(nt,_e){let et=0,rt=0,it=0;const st=findBox(nt,["moof","traf"]);for(let ot=0;ot<st.length;ot++){const at=st[ot],lt=findBox(at,["tfhd"])[0],ct=readUint32(lt,4),ut=_e[ct];if(!ut)continue;const ht=ut.default,dt=readUint32(lt,0)|(ht==null?void 0:ht.flags);let ft=ht==null?void 0:ht.duration;dt&8&&(dt&2?ft=readUint32(lt,12):ft=readUint32(lt,8));const pt=ut.timescale||9e4,mt=findBox(at,["trun"]);for(let At=0;At<mt.length;At++){if(et=computeRawDurationFromSamples(mt[At]),!et&&ft){const gt=readUint32(mt[At],4);et=ft*gt}ut.type===ElementaryStreamTypes.VIDEO?rt+=et/pt:ut.type===ElementaryStreamTypes.AUDIO&&(it+=et/pt)}}if(rt===0&&it===0){let ot=1/0,at=0,lt=0;const ct=findBox(nt,["sidx"]);for(let ut=0;ut<ct.length;ut++){const ht=parseSegmentIndex(ct[ut]);if(ht!=null&&ht.references){ot=Math.min(ot,ht.earliestPresentationTime/ht.timescale);const dt=ht.references.reduce((ft,pt)=>ft+pt.info.duration||0,0);at=Math.max(at,dt+ht.earliestPresentationTime/ht.timescale),lt=at-ot}}if(lt&&isFiniteNumber(lt))return lt}return rt||it}function computeRawDurationFromSamples(nt){const _e=readUint32(nt,0);let et=8;_e&1&&(et+=4),_e&4&&(et+=4);let rt=0;const it=readUint32(nt,4);for(let st=0;st<it;st++){if(_e&256){const ot=readUint32(nt,et);rt+=ot,et+=4}_e&512&&(et+=4),_e&1024&&(et+=4),_e&2048&&(et+=4)}return rt}function offsetStartDTS(nt,_e,et){findBox(_e,["moof","traf"]).forEach(rt=>{findBox(rt,["tfhd"]).forEach(it=>{const st=readUint32(it,4),ot=nt[st];if(!ot)return;const at=ot.timescale||9e4;findBox(rt,["tfdt"]).forEach(lt=>{const ct=lt[0],ut=et*at;if(ut){let ht=readUint32(lt,4);if(ct===0)ht-=ut,ht=Math.max(ht,0),writeUint32(lt,4,ht);else{ht*=Math.pow(2,32),ht+=readUint32(lt,8),ht-=ut,ht=Math.max(ht,0);const dt=Math.floor(ht/(UINT32_MAX$1+1)),ft=Math.floor(ht%(UINT32_MAX$1+1));writeUint32(lt,4,dt),writeUint32(lt,8,ft)}}})})})}function segmentValidRange(nt){const _e={valid:null,remainder:null},et=findBox(nt,["moof"]);if(et.length<2)return _e.remainder=nt,_e;const rt=et[et.length-1];return _e.valid=sliceUint8(nt,0,rt.byteOffset-8),_e.remainder=sliceUint8(nt,rt.byteOffset-8),_e}function appendUint8Array(nt,_e){const et=new Uint8Array(nt.length+_e.length);return et.set(nt),et.set(_e,nt.length),et}function parseSamples(nt,_e){const et=[],rt=_e.samples,it=_e.timescale,st=_e.id;let ot=!1;return findBox(rt,["moof"]).map(lt=>{const ct=lt.byteOffset-8;findBox(lt,["traf"]).map(ht=>{const dt=findBox(ht,["tfdt"]).map(ft=>{const pt=ft[0];let mt=readUint32(ft,4);return pt===1&&(mt*=Math.pow(2,32),mt+=readUint32(ft,8)),mt/it})[0];return dt!==void 0&&(nt=dt),findBox(ht,["tfhd"]).map(ft=>{const pt=readUint32(ft,4),mt=readUint32(ft,0)&16777215,At=(mt&1)!==0,gt=(mt&2)!==0,bt=(mt&8)!==0;let Tt=0;const wt=(mt&16)!==0;let Rt=0;const It=(mt&32)!==0;let Lt=8;pt===st&&(At&&(Lt+=8),gt&&(Lt+=4),bt&&(Tt=readUint32(ft,Lt),Lt+=4),wt&&(Rt=readUint32(ft,Lt),Lt+=4),It&&(Lt+=4),_e.type==="video"&&(ot=isHEVC(_e.codec)),findBox(ht,["trun"]).map($t=>{const kt=$t[0],Dt=readUint32($t,0)&16777215,Ot=(Dt&1)!==0;let zt=0;const Ht=(Dt&4)!==0,Yt=(Dt&256)!==0;let Xt=0;const Zt=(Dt&512)!==0;let rn=0;const Gt=(Dt&1024)!==0,jt=(Dt&2048)!==0;let Kt=0;const Jt=readUint32($t,4);let sn=8;Ot&&(zt=readUint32($t,sn),sn+=4),Ht&&(sn+=4);let hn=zt+ct;for(let an=0;an<Jt;an++){if(Yt?(Xt=readUint32($t,sn),sn+=4):Xt=Tt,Zt?(rn=readUint32($t,sn),sn+=4):rn=Rt,Gt&&(sn+=4),jt&&(kt===0?Kt=readUint32($t,sn):Kt=readSint32($t,sn),sn+=4),_e.type===ElementaryStreamTypes.VIDEO){let pn=0;for(;pn<rn;){const _n=readUint32(rt,hn);if(hn+=4,isSEIMessage(ot,rt[hn])){const yn=rt.subarray(hn,hn+_n);parseSEIMessageFromNALu(yn,ot?2:1,nt+Kt/it,et)}hn+=_n,pn+=_n+4}}nt+=Xt/it}}))})})}),et}function isHEVC(nt){if(!nt)return!1;const _e=nt.indexOf("."),et=_e<0?nt:nt.substring(0,_e);return et==="hvc1"||et==="hev1"||et==="dvh1"||et==="dvhe"}function isSEIMessage(nt,_e){if(nt){const et=_e>>1&63;return et===39||et===40}else return(_e&31)===6}function parseSEIMessageFromNALu(nt,_e,et,rt){const it=discardEPB(nt);let st=0;st+=_e;let ot=0,at=0,lt=0;for(;st<it.length;){ot=0;do{if(st>=it.length)break;lt=it[st++],ot+=lt}while(lt===255);at=0;do{if(st>=it.length)break;lt=it[st++],at+=lt}while(lt===255);const ct=it.length-st;let ut=st;if(at<ct)st+=at;else if(at>ct){logger.error(`Malformed SEI payload. ${at} is too small, only ${ct} bytes left to parse.`);break}if(ot===4){if(it[ut++]===181){const dt=readUint16(it,ut);if(ut+=2,dt===49){const ft=readUint32(it,ut);if(ut+=4,ft===1195456820){const pt=it[ut++];if(pt===3){const mt=it[ut++],At=31&mt,gt=64&mt,bt=gt?2+At*3:0,Tt=new Uint8Array(bt);if(gt){Tt[0]=mt;for(let wt=1;wt<bt;wt++)Tt[wt]=it[ut++]}rt.push({type:pt,payloadType:ot,pts:et,bytes:Tt})}}}}}else if(ot===5&&at>16){const ht=[];for(let pt=0;pt<16;pt++){const mt=it[ut++].toString(16);ht.push(mt.length==1?"0"+mt:mt),(pt===3||pt===5||pt===7||pt===9)&&ht.push("-")}const dt=at-16,ft=new Uint8Array(dt);for(let pt=0;pt<dt;pt++)ft[pt]=it[ut++];rt.push({payloadType:ot,pts:et,uuid:ht.join(""),userData:utf8ArrayToStr(ft),userDataBytes:ft})}}}function discardEPB(nt){const _e=nt.byteLength,et=[];let rt=1;for(;rt<_e-2;)nt[rt]===0&&nt[rt+1]===0&&nt[rt+2]===3?(et.push(rt+2),rt+=2):rt++;if(et.length===0)return nt;const it=_e-et.length,st=new Uint8Array(it);let ot=0;for(rt=0;rt<it;ot++,rt++)ot===et[0]&&(ot++,et.shift()),st[rt]=nt[ot];return st}function parseEmsg(nt){const _e=nt[0];let et="",rt="",it=0,st=0,ot=0,at=0,lt=0,ct=0;if(_e===0){for(;bin2str(nt.subarray(ct,ct+1))!=="\0";)et+=bin2str(nt.subarray(ct,ct+1)),ct+=1;for(et+=bin2str(nt.subarray(ct,ct+1)),ct+=1;bin2str(nt.subarray(ct,ct+1))!=="\0";)rt+=bin2str(nt.subarray(ct,ct+1)),ct+=1;rt+=bin2str(nt.subarray(ct,ct+1)),ct+=1,it=readUint32(nt,12),st=readUint32(nt,16),at=readUint32(nt,20),lt=readUint32(nt,24),ct=28}else if(_e===1){ct+=4,it=readUint32(nt,ct),ct+=4;const ht=readUint32(nt,ct);ct+=4;const dt=readUint32(nt,ct);for(ct+=4,ot=2**32*ht+dt,isSafeInteger(ot)||(ot=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),at=readUint32(nt,ct),ct+=4,lt=readUint32(nt,ct),ct+=4;bin2str(nt.subarray(ct,ct+1))!=="\0";)et+=bin2str(nt.subarray(ct,ct+1)),ct+=1;for(et+=bin2str(nt.subarray(ct,ct+1)),ct+=1;bin2str(nt.subarray(ct,ct+1))!=="\0";)rt+=bin2str(nt.subarray(ct,ct+1)),ct+=1;rt+=bin2str(nt.subarray(ct,ct+1)),ct+=1}const ut=nt.subarray(ct,nt.byteLength);return{schemeIdUri:et,value:rt,timeScale:it,presentationTime:ot,presentationTimeDelta:st,eventDuration:at,id:lt,payload:ut}}function mp4Box(nt,..._e){const et=_e.length;let rt=8,it=et;for(;it--;)rt+=_e[it].byteLength;const st=new Uint8Array(rt);for(st[0]=rt>>24&255,st[1]=rt>>16&255,st[2]=rt>>8&255,st[3]=rt&255,st.set(nt,4),it=0,rt=8;it<et;it++)st.set(_e[it],rt),rt+=_e[it].byteLength;return st}function mp4pssh(nt,_e,et){if(nt.byteLength!==16)throw new RangeError("Invalid system id");let rt,it;rt=0,it=new Uint8Array;let st;rt>0?(st=new Uint8Array(4),_e.length>0&&new DataView(st.buffer).setUint32(0,_e.length,!1)):st=new Uint8Array;const ot=new Uint8Array(4);return et&&et.byteLength>0&&new DataView(ot.buffer).setUint32(0,et.byteLength,!1),mp4Box([112,115,115,104],new Uint8Array([rt,0,0,0]),nt,st,it,ot,et||new Uint8Array)}function parseMultiPssh(nt){const _e=[];if(nt instanceof ArrayBuffer){const et=nt.byteLength;let rt=0;for(;rt+32<et;){const it=new DataView(nt,rt),st=parsePssh(it);_e.push(st),rt+=st.size}}return _e}function parsePssh(nt){const _e=nt.getUint32(0),et=nt.byteOffset,rt=nt.byteLength;if(rt<_e)return{offset:et,size:rt};if(nt.getUint32(4)!==1886614376)return{offset:et,size:_e};const st=nt.getUint32(8)>>>24;if(st!==0&&st!==1)return{offset:et,size:_e};const ot=nt.buffer,at=Hex.hexDump(new Uint8Array(ot,et+12,16)),lt=nt.getUint32(28);let ct=null,ut=null;if(st===0){if(_e-32<lt||lt<22)return{offset:et,size:_e};ut=new Uint8Array(ot,et+32,lt)}else if(st===1){if(!lt||rt<et+32+lt*16+16)return{offset:et,size:_e};ct=[];for(let ht=0;ht<lt;ht++)ct.push(new Uint8Array(ot,et+32+ht*16,16))}return{version:st,systemId:at,kids:ct,data:ut,offset:et,size:_e}}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}constructor(_e,et,rt,it=[1],st=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=_e,this.uri=et,this.keyFormat=rt,this.keyFormatVersions=it,this.iv=st,this.encrypted=_e?_e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&_e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case KeySystemFormats.FAIRPLAY:case KeySystemFormats.WIDEVINE:case KeySystemFormats.PLAYREADY:case KeySystemFormats.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(_e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof _e!="number"&&(this.method==="AES-128"&&!this.iv&&logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),_e=0);const rt=createInitializationVector(_e);return new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,rt)}const et=convertDataUriToArrayBytes(this.uri);if(et)switch(this.keyFormat){case KeySystemFormats.WIDEVINE:this.pssh=et,et.length>=22&&(this.keyId=et.subarray(et.length-22,et.length-6));break;case KeySystemFormats.PLAYREADY:{const rt=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(rt,null,et);const it=new Uint16Array(et.buffer,et.byteOffset,et.byteLength/2),st=String.fromCharCode.apply(null,Array.from(it)),ot=st.substring(st.indexOf("<"),st.length),ct=new DOMParser().parseFromString(ot,"text/xml").getElementsByTagName("KID")[0];if(ct){const ut=ct.childNodes[0]?ct.childNodes[0].nodeValue:ct.getAttribute("VALUE");if(ut){const ht=base64Decode(ut).subarray(0,16);changeEndianness(ht),this.keyId=ht}}break}default:{let rt=et.subarray(0,16);if(rt.length!==16){const it=new Uint8Array(16);it.set(rt,16-rt.length),rt=it}this.keyId=rt;break}}if(!this.keyId||this.keyId.byteLength!==16){let rt=keyUriToKeyIdMap[this.uri];if(!rt){const it=Object.keys(keyUriToKeyIdMap).length%Number.MAX_SAFE_INTEGER;rt=new Uint8Array(16),new DataView(rt.buffer,12,4).setUint32(0,it),keyUriToKeyIdMap[this.uri]=rt}this.keyId=rt}return this}}function createInitializationVector(nt){const _e=new Uint8Array(16);for(let et=12;et<16;et++)_e[et]=nt>>8*(15-et)&255;return _e}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(nt){return VARIABLE_REPLACEMENT_REGEX.test(nt)}function substituteVariablesInAttributes(nt,_e,et){if(nt.variableList!==null||nt.hasVariableRefs)for(let rt=et.length;rt--;){const it=et[rt],st=_e[it];st&&(_e[it]=substituteVariables(nt,st))}}function substituteVariables(nt,_e){if(nt.variableList!==null||nt.hasVariableRefs){const et=nt.variableList;return _e.replace(VARIABLE_REPLACEMENT_REGEX,rt=>{const it=rt.substring(2,rt.length-1),st=et==null?void 0:et[it];return st===void 0?(nt.playlistParsingError||(nt.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${it}"`)),rt):st})}return _e}function addVariableDefinition(nt,_e,et){let rt=nt.variableList;rt||(nt.variableList=rt={});let it,st;if("QUERYPARAM"in _e){it=_e.QUERYPARAM;try{const ot=new self.URL(et).searchParams;if(ot.has(it))st=ot.get(it);else throw new Error(`"${it}" does not match any query parameter in URI: "${et}"`)}catch(ot){nt.playlistParsingError||(nt.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${ot.message}`))}}else it=_e.NAME,st=_e.VALUE;it in rt?nt.playlistParsingError||(nt.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${it}"`)):rt[it]=st||""}function importVariableDefinition(nt,_e,et){const rt=_e.IMPORT;if(et&&rt in et){let it=nt.variableList;it||(nt.variableList=it={}),it[rt]=et[rt]}else nt.playlistParsingError||(nt.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${rt}"`))}function getMediaSource(nt=!0){return typeof self>"u"?void 0:(nt||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function isManagedMediaSource(nt){return typeof self<"u"&&nt===self.ManagedMediaSource}const sampleEntryCodesISO={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function isCodecType(nt,_e){const et=sampleEntryCodesISO[_e];return!!et&&!!et[nt.slice(0,4)]}function areCodecsMediaSourceSupported(nt,_e,et=!0){return!nt.split(",").some(rt=>!isCodecMediaSourceSupported(rt,_e,et))}function isCodecMediaSourceSupported(nt,_e,et=!0){var rt;const it=getMediaSource(et);return(rt=it==null?void 0:it.isTypeSupported(mimeTypeForCodec(nt,_e)))!=null?rt:!1}function mimeTypeForCodec(nt,_e){return`${_e}/mp4;codecs="${nt}"`}function videoCodecPreferenceValue(nt){if(nt){const _e=nt.substring(0,4);return sampleEntryCodesISO.video[_e]}return 2}function codecsSetSelectionPreferenceValue(nt){return nt.split(",").reduce((_e,et)=>{const rt=sampleEntryCodesISO.video[et];return rt?(rt*2+_e)/(_e?3:2):(sampleEntryCodesISO.audio[et]+_e)/(_e?2:1)},0)}const CODEC_COMPATIBLE_NAMES={};function getCodecCompatibleNameLower(nt,_e=!0){if(CODEC_COMPATIBLE_NAMES[nt])return CODEC_COMPATIBLE_NAMES[nt];const et={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[nt];for(let rt=0;rt<et.length;rt++)if(isCodecMediaSourceSupported(et[rt],"audio",_e))return CODEC_COMPATIBLE_NAMES[nt]=et[rt],et[rt];return nt}const AUDIO_CODEC_REGEXP=/flac|opus/i;function getCodecCompatibleName(nt,_e=!0){return nt.replace(AUDIO_CODEC_REGEXP,et=>getCodecCompatibleNameLower(et.toLowerCase(),_e))}function pickMostCompleteCodecName(nt,_e){return nt&&nt!=="mp4a"?nt:_e&&_e.split(",")[0]}function convertAVC1ToAVCOTI(nt){const _e=nt.split(",");for(let et=0;et<_e.length;et++){const rt=_e[et].split(".");if(rt.length>2){let it=rt.shift()+".";it+=parseInt(rt.shift()).toString(16),it+=("000"+parseInt(rt.shift()).toString(16)).slice(-4),_e[et]=it}}return _e.join(",")}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(_e,et){for(let rt=0;rt<_e.length;rt++){const it=_e[rt];if(it.id===et)return it}}static resolve(_e,et){return urlToolkitExports.buildAbsoluteURL(et,_e,{alwaysNormalize:!0})}static isMediaPlaylist(_e){return IS_MEDIA_PLAYLIST.test(_e)}static parseMasterPlaylist(_e,et){const rt=hasVariableReferences(_e),it={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:rt},st=[];MASTER_PLAYLIST_REGEX.lastIndex=0;let ot;for(;(ot=MASTER_PLAYLIST_REGEX.exec(_e))!=null;)if(ot[1]){var at;const ct=new AttrList(ot[1]);substituteVariablesInAttributes(it,ct,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const ut=substituteVariables(it,ot[2]),ht={attrs:ct,bitrate:ct.decimalInteger("BANDWIDTH")||ct.decimalInteger("AVERAGE-BANDWIDTH"),name:ct.NAME,url:M3U8Parser.resolve(ut,et)},dt=ct.decimalResolution("RESOLUTION");dt&&(ht.width=dt.width,ht.height=dt.height),setCodecs(ct.CODECS,ht),(at=ht.unknownCodecs)!=null&&at.length||st.push(ht),it.levels.push(ht)}else if(ot[3]){const ct=ot[3],ut=ot[4];switch(ct){case"SESSION-DATA":{const ht=new AttrList(ut);substituteVariablesInAttributes(it,ht,["DATA-ID","LANGUAGE","VALUE","URI"]);const dt=ht["DATA-ID"];dt&&(it.sessionData===null&&(it.sessionData={}),it.sessionData[dt]=ht);break}case"SESSION-KEY":{const ht=parseKey(ut,et,it);ht.encrypted&&ht.isSupported()?(it.sessionKeys===null&&(it.sessionKeys=[]),it.sessionKeys.push(ht)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${ut}"`);break}case"DEFINE":{{const ht=new AttrList(ut);substituteVariablesInAttributes(it,ht,["NAME","VALUE","QUERYPARAM"]),addVariableDefinition(it,ht,et)}break}case"CONTENT-STEERING":{const ht=new AttrList(ut);substituteVariablesInAttributes(it,ht,["SERVER-URI","PATHWAY-ID"]),it.contentSteering={uri:M3U8Parser.resolve(ht["SERVER-URI"],et),pathwayId:ht["PATHWAY-ID"]||"."};break}case"START":{it.startTimeOffset=parseStartTimeOffset(ut);break}}}const lt=st.length>0&&st.length<it.levels.length;return it.levels=lt?st:it.levels,it.levels.length===0&&(it.playlistParsingError=new Error("no levels found in manifest")),it}static parseMasterPlaylistMedia(_e,et,rt){let it;const st={},ot=rt.levels,at={AUDIO:ot.map(ct=>({id:ct.attrs.AUDIO,audioCodec:ct.audioCodec})),SUBTITLES:ot.map(ct=>({id:ct.attrs.SUBTITLES,textCodec:ct.textCodec})),"CLOSED-CAPTIONS":[]};let lt=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;(it=MASTER_PLAYLIST_MEDIA_REGEX.exec(_e))!==null;){const ct=new AttrList(it[1]),ut=ct.TYPE;if(ut){const ht=at[ut],dt=st[ut]||[];st[ut]=dt,substituteVariablesInAttributes(rt,ct,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const ft=ct.LANGUAGE,pt=ct["ASSOC-LANGUAGE"],mt=ct.CHANNELS,At=ct.CHARACTERISTICS,gt=ct["INSTREAM-ID"],bt={attrs:ct,bitrate:0,id:lt++,groupId:ct["GROUP-ID"]||"",name:ct.NAME||ft||"",type:ut,default:ct.bool("DEFAULT"),autoselect:ct.bool("AUTOSELECT"),forced:ct.bool("FORCED"),lang:ft,url:ct.URI?M3U8Parser.resolve(ct.URI,et):""};if(pt&&(bt.assocLang=pt),mt&&(bt.channels=mt),At&&(bt.characteristics=At),gt&&(bt.instreamId=gt),ht!=null&&ht.length){const Tt=M3U8Parser.findGroup(ht,bt.groupId)||ht[0];assignCodec(bt,Tt,"audioCodec"),assignCodec(bt,Tt,"textCodec")}dt.push(bt)}}return st}static parseLevelPlaylist(_e,et,rt,it,st,ot){const at=new LevelDetails(et),lt=at.fragments;let ct=null,ut=0,ht=0,dt=0,ft=0,pt=null,mt=new Fragment(it,et),At,gt,bt,Tt=-1,wt=!1,Rt=null;for(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,at.m3u8=_e,at.hasVariableRefs=hasVariableReferences(_e);(At=LEVEL_PLAYLIST_REGEX_FAST.exec(_e))!==null;){wt&&(wt=!1,mt=new Fragment(it,et),mt.start=dt,mt.sn=ut,mt.cc=ft,mt.level=rt,ct&&(mt.initSegment=ct,mt.rawProgramDateTime=ct.rawProgramDateTime,ct.rawProgramDateTime=null,Rt&&(mt.setByteRange(Rt),Rt=null)));const kt=At[1];if(kt){mt.duration=parseFloat(kt);const Dt=(" "+At[2]).slice(1);mt.title=Dt||null,mt.tagList.push(Dt?["INF",kt,Dt]:["INF",kt])}else if(At[3]){if(isFiniteNumber(mt.duration)){mt.start=dt,bt&&setFragLevelKeys(mt,bt,at),mt.sn=ut,mt.level=rt,mt.cc=ft,lt.push(mt);const Dt=(" "+At[3]).slice(1);mt.relurl=substituteVariables(at,Dt),assignProgramDateTime(mt,pt),pt=mt,dt+=mt.duration,ut++,ht=0,wt=!0}}else if(At[4]){const Dt=(" "+At[4]).slice(1);pt?mt.setByteRange(Dt,pt):mt.setByteRange(Dt)}else if(At[5])mt.rawProgramDateTime=(" "+At[5]).slice(1),mt.tagList.push(["PROGRAM-DATE-TIME",mt.rawProgramDateTime]),Tt===-1&&(Tt=lt.length);else{if(At=At[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!At){logger.warn("No matches on slow regex match for level playlist!");continue}for(gt=1;gt<At.length&&!(typeof At[gt]<"u");gt++);const Dt=(" "+At[gt]).slice(1),Ot=(" "+At[gt+1]).slice(1),zt=At[gt+2]?(" "+At[gt+2]).slice(1):"";switch(Dt){case"PLAYLIST-TYPE":at.type=Ot.toUpperCase();break;case"MEDIA-SEQUENCE":ut=at.startSN=parseInt(Ot);break;case"SKIP":{const Ht=new AttrList(Ot);substituteVariablesInAttributes(at,Ht,["RECENTLY-REMOVED-DATERANGES"]);const Yt=Ht.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(Yt)){at.skippedSegments=Yt;for(let Zt=Yt;Zt--;)lt.unshift(null);ut+=Yt}const Xt=Ht.enumeratedString("RECENTLY-REMOVED-DATERANGES");Xt&&(at.recentlyRemovedDateranges=Xt.split("	"));break}case"TARGETDURATION":at.targetduration=Math.max(parseInt(Ot),1);break;case"VERSION":at.version=parseInt(Ot);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":at.live=!1;break;case"#":(Ot||zt)&&mt.tagList.push(zt?[Ot,zt]:[Ot]);break;case"DISCONTINUITY":ft++,mt.tagList.push(["DIS"]);break;case"GAP":mt.gap=!0,mt.tagList.push([Dt]);break;case"BITRATE":mt.tagList.push([Dt,Ot]);break;case"DATERANGE":{const Ht=new AttrList(Ot);substituteVariablesInAttributes(at,Ht,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),substituteVariablesInAttributes(at,Ht,Ht.clientAttrs);const Yt=new DateRange(Ht,at.dateRanges[Ht.ID]);Yt.isValid||at.skippedSegments?at.dateRanges[Yt.id]=Yt:logger.warn(`Ignoring invalid DATERANGE tag: "${Ot}"`),mt.tagList.push(["EXT-X-DATERANGE",Ot]);break}case"DEFINE":{{const Ht=new AttrList(Ot);substituteVariablesInAttributes(at,Ht,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Ht?importVariableDefinition(at,Ht,ot):addVariableDefinition(at,Ht,et)}break}case"DISCONTINUITY-SEQUENCE":ft=parseInt(Ot);break;case"KEY":{const Ht=parseKey(Ot,et,at);if(Ht.isSupported()){if(Ht.method==="NONE"){bt=void 0;break}bt||(bt={}),bt[Ht.keyFormat]&&(bt=_extends$1({},bt)),bt[Ht.keyFormat]=Ht}else logger.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${Ot}"`);break}case"START":at.startTimeOffset=parseStartTimeOffset(Ot);break;case"MAP":{const Ht=new AttrList(Ot);if(substituteVariablesInAttributes(at,Ht,["BYTERANGE","URI"]),mt.duration){const Yt=new Fragment(it,et);setInitSegment(Yt,Ht,rt,bt),ct=Yt,mt.initSegment=ct,ct.rawProgramDateTime&&!mt.rawProgramDateTime&&(mt.rawProgramDateTime=ct.rawProgramDateTime)}else{const Yt=mt.byteRangeEndOffset;if(Yt){const Xt=mt.byteRangeStartOffset;Rt=`${Yt-Xt}@${Xt}`}else Rt=null;setInitSegment(mt,Ht,rt,bt),ct=mt,wt=!0}break}case"SERVER-CONTROL":{const Ht=new AttrList(Ot);at.canBlockReload=Ht.bool("CAN-BLOCK-RELOAD"),at.canSkipUntil=Ht.optionalFloat("CAN-SKIP-UNTIL",0),at.canSkipDateRanges=at.canSkipUntil>0&&Ht.bool("CAN-SKIP-DATERANGES"),at.partHoldBack=Ht.optionalFloat("PART-HOLD-BACK",0),at.holdBack=Ht.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Ht=new AttrList(Ot);at.partTarget=Ht.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Ht=at.partList;Ht||(Ht=at.partList=[]);const Yt=ht>0?Ht[Ht.length-1]:void 0,Xt=ht++,Zt=new AttrList(Ot);substituteVariablesInAttributes(at,Zt,["BYTERANGE","URI"]);const rn=new Part(Zt,mt,et,Xt,Yt);Ht.push(rn),mt.duration+=rn.duration;break}case"PRELOAD-HINT":{const Ht=new AttrList(Ot);substituteVariablesInAttributes(at,Ht,["URI"]),at.preloadHint=Ht;break}case"RENDITION-REPORT":{const Ht=new AttrList(Ot);substituteVariablesInAttributes(at,Ht,["URI"]),at.renditionReports=at.renditionReports||[],at.renditionReports.push(Ht);break}default:logger.warn(`line parsed but not handled: ${At}`);break}}}pt&&!pt.relurl?(lt.pop(),dt-=pt.duration,at.partList&&(at.fragmentHint=pt)):at.partList&&(assignProgramDateTime(mt,pt),mt.cc=ft,at.fragmentHint=mt,bt&&setFragLevelKeys(mt,bt,at));const It=lt.length,Lt=lt[0],$t=lt[It-1];if(dt+=at.skippedSegments*at.targetduration,dt>0&&It&&$t){at.averagetargetduration=dt/It;const kt=$t.sn;at.endSN=kt!=="initSegment"?kt:0,at.live||($t.endList=!0),Lt&&(at.startCC=Lt.cc)}else at.endSN=0,at.startCC=0;return at.fragmentHint&&(dt+=at.fragmentHint.duration),at.totalduration=dt,at.endCC=ft,Tt>0&&backfillProgramDateTimes(lt,Tt),at}}function parseKey(nt,_e,et){var rt,it;const st=new AttrList(nt);substituteVariablesInAttributes(et,st,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const ot=(rt=st.METHOD)!=null?rt:"",at=st.URI,lt=st.hexadecimalInteger("IV"),ct=st.KEYFORMATVERSIONS,ut=(it=st.KEYFORMAT)!=null?it:"identity";at&&st.IV&&!lt&&logger.error(`Invalid IV: ${st.IV}`);const ht=at?M3U8Parser.resolve(at,_e):"",dt=(ct||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(ot,ht,ut,dt,lt)}function parseStartTimeOffset(nt){const et=new AttrList(nt).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(et)?et:null}function setCodecs(nt,_e){let et=(nt||"").split(/[ ,]+/).filter(rt=>rt);["video","audio","text"].forEach(rt=>{const it=et.filter(st=>isCodecType(st,rt));it.length&&(_e[`${rt}Codec`]=it.join(","),et=et.filter(st=>it.indexOf(st)===-1))}),_e.unknownCodecs=et}function assignCodec(nt,_e,et){const rt=_e[et];rt&&(nt[et]=rt)}function backfillProgramDateTimes(nt,_e){let et=nt[_e];for(let rt=_e;rt--;){const it=nt[rt];if(!it)return;it.programDateTime=et.programDateTime-it.duration*1e3,et=it}}function assignProgramDateTime(nt,_e){nt.rawProgramDateTime?nt.programDateTime=Date.parse(nt.rawProgramDateTime):_e!=null&&_e.programDateTime&&(nt.programDateTime=_e.endProgramDateTime),isFiniteNumber(nt.programDateTime)||(nt.programDateTime=null,nt.rawProgramDateTime=null)}function setInitSegment(nt,_e,et,rt){nt.relurl=_e.URI,_e.BYTERANGE&&nt.setByteRange(_e.BYTERANGE),nt.level=et,nt.sn="initSegment",rt&&(nt.levelkeys=rt),nt.initSegment=null}function setFragLevelKeys(nt,_e,et){nt.levelkeys=_e;const{encryptedFragments:rt}=et;(!rt.length||rt[rt.length-1].levelkeys!==_e)&&Object.keys(_e).some(it=>_e[it].isCommonEncryption)&&rt.push(nt)}var PlaylistContextType={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},PlaylistLevelType={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function mapContextToLevelType(nt){const{type:_e}=nt;switch(_e){case PlaylistContextType.AUDIO_TRACK:return PlaylistLevelType.AUDIO;case PlaylistContextType.SUBTITLE_TRACK:return PlaylistLevelType.SUBTITLE;default:return PlaylistLevelType.MAIN}}function getResponseUrl(nt,_e){let et=nt.url;return(et===void 0||et.indexOf("data:")===0)&&(et=_e.url),et}class PlaylistLoader{constructor(_e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=_e,this.registerListeners()}startLoad(_e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:_e}=this;_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),_e.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:_e}=this;_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),_e.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(_e){const et=this.hls.config,rt=et.pLoader,it=et.loader,st=rt||it,ot=new st(et);return this.loaders[_e.type]=ot,ot}getInternalLoader(_e){return this.loaders[_e.type]}resetInternalLoader(_e){this.loaders[_e]&&delete this.loaders[_e]}destroyInternalLoaders(){for(const _e in this.loaders){const et=this.loaders[_e];et&&et.destroy(),this.resetInternalLoader(_e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(_e,et){const{url:rt}=et;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType.MANIFEST,url:rt,deliveryDirectives:null})}onLevelLoading(_e,et){const{id:rt,level:it,pathwayId:st,url:ot,deliveryDirectives:at}=et;this.load({id:rt,level:it,pathwayId:st,responseType:"text",type:PlaylistContextType.LEVEL,url:ot,deliveryDirectives:at})}onAudioTrackLoading(_e,et){const{id:rt,groupId:it,url:st,deliveryDirectives:ot}=et;this.load({id:rt,groupId:it,level:null,responseType:"text",type:PlaylistContextType.AUDIO_TRACK,url:st,deliveryDirectives:ot})}onSubtitleTrackLoading(_e,et){const{id:rt,groupId:it,url:st,deliveryDirectives:ot}=et;this.load({id:rt,groupId:it,level:null,responseType:"text",type:PlaylistContextType.SUBTITLE_TRACK,url:st,deliveryDirectives:ot})}load(_e){var et;const rt=this.hls.config;let it=this.getInternalLoader(_e);if(it){const ct=it.context;if(ct&&ct.url===_e.url&&ct.level===_e.level){logger.trace("[playlist-loader]: playlist request ongoing");return}logger.log(`[playlist-loader]: aborting previous loader for type: ${_e.type}`),it.abort()}let st;if(_e.type===PlaylistContextType.MANIFEST?st=rt.manifestLoadPolicy.default:st=_extends$1({},rt.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),it=this.createInternalLoader(_e),isFiniteNumber((et=_e.deliveryDirectives)==null?void 0:et.part)){let ct;if(_e.type===PlaylistContextType.LEVEL&&_e.level!==null?ct=this.hls.levels[_e.level].details:_e.type===PlaylistContextType.AUDIO_TRACK&&_e.id!==null?ct=this.hls.audioTracks[_e.id].details:_e.type===PlaylistContextType.SUBTITLE_TRACK&&_e.id!==null&&(ct=this.hls.subtitleTracks[_e.id].details),ct){const ut=ct.partTarget,ht=ct.targetduration;if(ut&&ht){const dt=Math.max(ut*3,ht*.8)*1e3;st=_extends$1({},st,{maxTimeToFirstByteMs:Math.min(dt,st.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(dt,st.maxTimeToFirstByteMs)})}}}const ot=st.errorRetry||st.timeoutRetry||{},at={loadPolicy:st,timeout:st.maxLoadTimeMs,maxRetry:ot.maxNumRetry||0,retryDelay:ot.retryDelayMs||0,maxRetryDelay:ot.maxRetryDelayMs||0},lt={onSuccess:(ct,ut,ht,dt)=>{const ft=this.getInternalLoader(ht);this.resetInternalLoader(ht.type);const pt=ct.data;if(pt.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(ct,ht,new Error("no EXTM3U delimiter"),dt||null,ut);return}ut.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(pt)?this.handleTrackOrLevelPlaylist(ct,ut,ht,dt||null,ft):this.handleMasterPlaylist(ct,ut,ht,dt)},onError:(ct,ut,ht,dt)=>{this.handleNetworkError(ut,ht,!1,ct,dt)},onTimeout:(ct,ut,ht)=>{this.handleNetworkError(ut,ht,!0,void 0,ct)}};it.load(_e,at,lt)}handleMasterPlaylist(_e,et,rt,it){const st=this.hls,ot=_e.data,at=getResponseUrl(_e,rt),lt=M3U8Parser.parseMasterPlaylist(ot,at);if(lt.playlistParsingError){this.handleManifestParsingError(_e,rt,lt.playlistParsingError,it,et);return}const{contentSteering:ct,levels:ut,sessionData:ht,sessionKeys:dt,startTimeOffset:ft,variableList:pt}=lt;this.variableList=pt;const{AUDIO:mt=[],SUBTITLES:At,"CLOSED-CAPTIONS":gt}=M3U8Parser.parseMasterPlaylistMedia(ot,at,lt);mt.length&&!mt.some(Tt=>!Tt.url)&&ut[0].audioCodec&&!ut[0].attrs.AUDIO&&(logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),mt.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""})),st.trigger(Events.MANIFEST_LOADED,{levels:ut,audioTracks:mt,subtitles:At,captions:gt,contentSteering:ct,url:at,stats:et,networkDetails:it,sessionData:ht,sessionKeys:dt,startTimeOffset:ft,variableList:pt})}handleTrackOrLevelPlaylist(_e,et,rt,it,st){const ot=this.hls,{id:at,level:lt,type:ct}=rt,ut=getResponseUrl(_e,rt),ht=0,dt=isFiniteNumber(lt)?lt:isFiniteNumber(at)?at:0,ft=mapContextToLevelType(rt),pt=M3U8Parser.parseLevelPlaylist(_e.data,ut,dt,ft,ht,this.variableList);if(ct===PlaylistContextType.MANIFEST){const mt={attrs:new AttrList({}),bitrate:0,details:pt,name:"",url:ut};ot.trigger(Events.MANIFEST_LOADED,{levels:[mt],audioTracks:[],url:ut,stats:et,networkDetails:it,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}et.parsing.end=performance.now(),rt.levelDetails=pt,this.handlePlaylistLoaded(pt,_e,et,rt,it,st)}handleManifestParsingError(_e,et,rt,it,st){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:et.type===PlaylistContextType.MANIFEST,url:_e.url,err:rt,error:rt,reason:rt.message,response:_e,context:et,networkDetails:it,stats:st})}handleNetworkError(_e,et,rt=!1,it,st){let ot=`A network ${rt?"timeout":"error"+(it?" (status "+it.code+")":"")} occurred while loading ${_e.type}`;_e.type===PlaylistContextType.LEVEL?ot+=`: ${_e.level} id: ${_e.id}`:(_e.type===PlaylistContextType.AUDIO_TRACK||_e.type===PlaylistContextType.SUBTITLE_TRACK)&&(ot+=` id: ${_e.id} group-id: "${_e.groupId}"`);const at=new Error(ot);logger.warn(`[playlist-loader]: ${ot}`);let lt=ErrorDetails.UNKNOWN,ct=!1;const ut=this.getInternalLoader(_e);switch(_e.type){case PlaylistContextType.MANIFEST:lt=rt?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,ct=!0;break;case PlaylistContextType.LEVEL:lt=rt?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,ct=!1;break;case PlaylistContextType.AUDIO_TRACK:lt=rt?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,ct=!1;break;case PlaylistContextType.SUBTITLE_TRACK:lt=rt?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,ct=!1;break}ut&&this.resetInternalLoader(_e.type);const ht={type:ErrorTypes.NETWORK_ERROR,details:lt,fatal:ct,url:_e.url,loader:ut,context:_e,error:at,networkDetails:et,stats:st};if(it){const dt=(et==null?void 0:et.url)||_e.url;ht.response=_objectSpread2$3({url:dt,data:void 0},it)}this.hls.trigger(Events.ERROR,ht)}handlePlaylistLoaded(_e,et,rt,it,st,ot){const at=this.hls,{type:lt,level:ct,id:ut,groupId:ht,deliveryDirectives:dt}=it,ft=getResponseUrl(et,it),pt=mapContextToLevelType(it),mt=typeof it.level=="number"&&pt===PlaylistLevelType.MAIN?ct:void 0;if(!_e.fragments.length){const gt=new Error("No Segments found in Playlist");at.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:ft,error:gt,reason:gt.message,response:et,context:it,level:mt,parent:pt,networkDetails:st,stats:rt});return}_e.targetduration||(_e.playlistParsingError=new Error("Missing Target Duration"));const At=_e.playlistParsingError;if(At){at.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:ft,error:At,reason:At.message,response:et,context:it,level:mt,parent:pt,networkDetails:st,stats:rt});return}switch(_e.live&&ot&&(ot.getCacheAge&&(_e.ageHeader=ot.getCacheAge()||0),(!ot.getCacheAge||isNaN(_e.ageHeader))&&(_e.ageHeader=0)),lt){case PlaylistContextType.MANIFEST:case PlaylistContextType.LEVEL:at.trigger(Events.LEVEL_LOADED,{details:_e,level:mt||0,id:ut||0,stats:rt,networkDetails:st,deliveryDirectives:dt});break;case PlaylistContextType.AUDIO_TRACK:at.trigger(Events.AUDIO_TRACK_LOADED,{details:_e,id:ut||0,groupId:ht||"",stats:rt,networkDetails:st,deliveryDirectives:dt});break;case PlaylistContextType.SUBTITLE_TRACK:at.trigger(Events.SUBTITLE_TRACK_LOADED,{details:_e,id:ut||0,groupId:ht||"",stats:rt,networkDetails:st,deliveryDirectives:dt});break}}}function sendAddTrackEvent(nt,_e){let et;try{et=new Event("addtrack")}catch{et=document.createEvent("Event"),et.initEvent("addtrack",!1,!1)}et.track=nt,_e.dispatchEvent(et)}function addCueToTrack(nt,_e){const et=nt.mode;if(et==="disabled"&&(nt.mode="hidden"),nt.cues&&!nt.cues.getCueById(_e.id))try{if(nt.addCue(_e),!nt.cues.getCueById(_e.id))throw new Error(`addCue is failed for: ${_e}`)}catch(rt){logger.debug(`[texttrack-utils]: ${rt}`);try{const it=new self.TextTrackCue(_e.startTime,_e.endTime,_e.text);it.id=_e.id,nt.addCue(it)}catch(it){logger.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${it}`)}}et==="disabled"&&(nt.mode=et)}function clearCurrentCues(nt){const _e=nt.mode;if(_e==="disabled"&&(nt.mode="hidden"),nt.cues)for(let et=nt.cues.length;et--;)nt.removeCue(nt.cues[et]);_e==="disabled"&&(nt.mode=_e)}function removeCuesInRange(nt,_e,et,rt){const it=nt.mode;if(it==="disabled"&&(nt.mode="hidden"),nt.cues&&nt.cues.length>0){const st=getCuesInRange(nt.cues,_e,et);for(let ot=0;ot<st.length;ot++)(!rt||rt(st[ot]))&&nt.removeCue(st[ot])}it==="disabled"&&(nt.mode=it)}function getFirstCueIndexAfterTime(nt,_e){if(_e<nt[0].startTime)return 0;const et=nt.length-1;if(_e>nt[et].endTime)return-1;let rt=0,it=et;for(;rt<=it;){const st=Math.floor((it+rt)/2);if(_e<nt[st].startTime)it=st-1;else if(_e>nt[st].startTime&&rt<et)rt=st+1;else return st}return nt[rt].startTime-_e<_e-nt[it].startTime?rt:it}function getCuesInRange(nt,_e,et){const rt=[],it=getFirstCueIndexAfterTime(nt,_e);if(it>-1)for(let st=it,ot=nt.length;st<ot;st++){const at=nt[st];if(at.startTime>=_e&&at.endTime<=et)rt.push(at);else if(at.startTime>et)return rt}return rt}function filterSubtitleTracks(nt){const _e=[];for(let et=0;et<nt.length;et++){const rt=nt[et];(rt.kind==="subtitles"||rt.kind==="captions")&&rt.label&&_e.push(nt[et])}return _e}var MetadataSchema={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const MIN_CUE_DURATION=.25;function getCueClass(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function createCueWithDataFields(nt,_e,et,rt,it){let st=new nt(_e,et,"");try{st.value=rt,it&&(st.type=it)}catch{st=new nt(_e,et,JSON.stringify(it?_objectSpread2$3({type:it},rt):rt))}return st}const MAX_CUE_ENDTIME=(()=>{const nt=getCueClass();try{nt&&new nt(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function dateRangeDateToTimelineSeconds(nt,_e){return nt.getTime()/1e3-_e}function hexToArrayBuffer(nt){return Uint8Array.from(nt.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ID3TrackController{constructor(_e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=_e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:_e}=this;_e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),_e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),_e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(_e,et){this.media=et.media}onMediaDetaching(){this.id3Track&&(clearCurrentCues(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(_e){const et=this.getID3Track(_e.textTracks);return et.mode="hidden",et}getID3Track(_e){if(this.media){for(let et=0;et<_e.length;et++){const rt=_e[et];if(rt.kind==="metadata"&&rt.label==="id3")return sendAddTrackEvent(rt,this.media),rt}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(_e,et){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:rt,enableID3MetadataCues:it}}}=this;if(!rt&&!it)return;const{samples:st}=et;this.id3Track||(this.id3Track=this.createTrack(this.media));const ot=getCueClass();if(ot)for(let at=0;at<st.length;at++){const lt=st[at].type;if(lt===MetadataSchema.emsg&&!rt||!it)continue;const ct=getID3Frames(st[at].data);if(ct){const ut=st[at].pts;let ht=ut+st[at].duration;ht>MAX_CUE_ENDTIME&&(ht=MAX_CUE_ENDTIME),ht-ut<=0&&(ht=ut+MIN_CUE_DURATION);for(let ft=0;ft<ct.length;ft++){const pt=ct[ft];if(!isTimeStampFrame(pt)){this.updateId3CueEnds(ut,lt);const mt=createCueWithDataFields(ot,ut,ht,pt,lt);mt&&this.id3Track.addCue(mt)}}}}}updateId3CueEnds(_e,et){var rt;const it=(rt=this.id3Track)==null?void 0:rt.cues;if(it)for(let st=it.length;st--;){const ot=it[st];ot.type===et&&ot.startTime<_e&&ot.endTime===MAX_CUE_ENDTIME&&(ot.endTime=_e)}}onBufferFlushing(_e,{startOffset:et,endOffset:rt,type:it}){const{id3Track:st,hls:ot}=this;if(!ot)return;const{config:{enableEmsgMetadataCues:at,enableID3MetadataCues:lt}}=ot;if(st&&(at||lt)){let ct;it==="audio"?ct=ut=>ut.type===MetadataSchema.audioId3&&lt:it==="video"?ct=ut=>ut.type===MetadataSchema.emsg&&at:ct=ut=>ut.type===MetadataSchema.audioId3&&lt||ut.type===MetadataSchema.emsg&&at,removeCuesInRange(st,et,rt,ct)}}onLevelUpdated(_e,{details:et}){if(!this.media||!et.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:rt,id3Track:it}=this,{dateRanges:st}=et,ot=Object.keys(st);if(it){const ut=Object.keys(rt).filter(ht=>!ot.includes(ht));for(let ht=ut.length;ht--;){const dt=ut[ht];Object.keys(rt[dt].cues).forEach(ft=>{it.removeCue(rt[dt].cues[ft])}),delete rt[dt]}}const at=et.fragments[et.fragments.length-1];if(ot.length===0||!isFiniteNumber(at==null?void 0:at.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const lt=at.programDateTime/1e3-at.start,ct=getCueClass();for(let ut=0;ut<ot.length;ut++){const ht=ot[ut],dt=st[ht],ft=dateRangeDateToTimelineSeconds(dt.startDate,lt),pt=rt[ht],mt=(pt==null?void 0:pt.cues)||{};let At=(pt==null?void 0:pt.durationKnown)||!1,gt=MAX_CUE_ENDTIME;const bt=dt.endDate;if(bt)gt=dateRangeDateToTimelineSeconds(bt,lt),At=!0;else if(dt.endOnNext&&!At){const wt=ot.reduce((Rt,It)=>{if(It!==dt.id){const Lt=st[It];if(Lt.class===dt.class&&Lt.startDate>dt.startDate&&(!Rt||dt.startDate<Rt.startDate))return Lt}return Rt},null);wt&&(gt=dateRangeDateToTimelineSeconds(wt.startDate,lt),At=!0)}const Tt=Object.keys(dt.attr);for(let wt=0;wt<Tt.length;wt++){const Rt=Tt[wt];if(!isDateRangeCueAttribute(Rt))continue;const It=mt[Rt];if(It)At&&!pt.durationKnown&&(It.endTime=gt);else if(ct){let Lt=dt.attr[Rt];isSCTE35Attribute(Rt)&&(Lt=hexToArrayBuffer(Lt));const $t=createCueWithDataFields(ct,ft,gt,{key:Rt,data:Lt},MetadataSchema.dateRange);$t&&($t.id=ht,this.id3Track.addCue($t),mt[Rt]=$t)}}rt[ht]={cues:mt,dateRange:dt,durationKnown:At}}}}class LatencyController{constructor(_e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=_e,this.config=_e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:_e,levelDetails:et}=this;return _e.liveMaxLatencyDuration!==void 0?_e.liveMaxLatencyDuration:et?_e.liveMaxLatencyDurationCount*et.targetduration:0}get targetLatency(){const{levelDetails:_e}=this;if(_e===null)return null;const{holdBack:et,partHoldBack:rt,targetduration:it}=_e,{liveSyncDuration:st,liveSyncDurationCount:ot,lowLatencyMode:at}=this.config,lt=this.hls.userConfig;let ct=at&&rt||et;(lt.liveSyncDuration||lt.liveSyncDurationCount||ct===0)&&(ct=st!==void 0?st:ot*it);const ut=it;return ct+Math.min(this.stallCount*1,ut)}get liveSyncPosition(){const _e=this.estimateLiveEdge(),et=this.targetLatency,rt=this.levelDetails;if(_e===null||et===null||rt===null)return null;const it=rt.edge,st=_e-et-this.edgeStalled,ot=it-rt.totalduration,at=it-(this.config.lowLatencyMode&&rt.partTarget||rt.targetduration);return Math.min(Math.max(ot,st),at)}get drift(){const{levelDetails:_e}=this;return _e===null?1:_e.drift}get edgeStalled(){const{levelDetails:_e}=this;if(_e===null)return 0;const et=(this.config.lowLatencyMode&&_e.partTarget||_e.targetduration)*3;return Math.max(_e.age-et,0)}get forwardBufferLength(){const{media:_e,levelDetails:et}=this;if(!_e||!et)return 0;const rt=_e.buffered.length;return(rt?_e.buffered.end(rt-1):et.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(Events.ERROR,this.onError,this)}onMediaAttached(_e,et){this.media=et.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(_e,{details:et}){this.levelDetails=et,et.advanced&&this.timeupdate(),!et.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(_e,et){var rt;et.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,(rt=this.levelDetails)!=null&&rt.live&&logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:_e,levelDetails:et}=this;if(!_e||!et)return;this.currentTime=_e.currentTime;const rt=this.computeLatency();if(rt===null)return;this._latency=rt;const{lowLatencyMode:it,maxLiveSyncPlaybackRate:st}=this.config;if(!it||st===1||!et.live)return;const ot=this.targetLatency;if(ot===null)return;const at=rt-ot,lt=Math.min(this.maxLatency,ot+et.targetduration);if(at<lt&&at>.05&&this.forwardBufferLength>1){const ut=Math.min(2,Math.max(1,st)),ht=Math.round(2/(1+Math.exp(-.75*at-this.edgeStalled))*20)/20;_e.playbackRate=Math.min(ut,Math.max(1,ht))}else _e.playbackRate!==1&&_e.playbackRate!==0&&(_e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:_e}=this;return _e===null?null:_e.edge+_e.age}computeLatency(){const _e=this.estimateLiveEdge();return _e===null?null:_e-this.currentTime}}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];function isHdcpLevel(nt){return HdcpLevels.indexOf(nt)>-1}const VideoRangeValues=["SDR","PQ","HLG"];function isVideoRange(nt){return!!nt&&VideoRangeValues.indexOf(nt)>-1}var HlsSkip={No:"",Yes:"YES",v2:"v2"};function getSkipValue(nt){const{canSkipUntil:_e,canSkipDateRanges:et,age:rt}=nt,it=rt<_e/2;return _e&&it?et?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}class HlsUrlParameters{constructor(_e,et,rt){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=_e,this.part=et,this.skip=rt}addDirectives(_e){const et=new self.URL(_e);return this.msn!==void 0&&et.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&et.searchParams.set("_HLS_part",this.part.toString()),this.skip&&et.searchParams.set("_HLS_skip",this.skip),et.href}}class Level{constructor(_e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[_e.url],this._attrs=[_e.attrs],this.bitrate=_e.bitrate,_e.details&&(this.details=_e.details),this.id=_e.id||0,this.name=_e.name,this.width=_e.width||0,this.height=_e.height||0,this.frameRate=_e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=_e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=_e.audioCodec,this.videoCodec=_e.videoCodec,this.codecSet=[_e.videoCodec,_e.audioCodec].filter(et=>!!et).map(et=>et.substring(0,4)).join(","),this.addGroupId("audio",_e.attrs.AUDIO),this.addGroupId("text",_e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(_e){return hasGroup(this._audioGroups,_e)}hasSubtitleGroup(_e){return hasGroup(this._subtitleGroups,_e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(_e,et){if(et){if(_e==="audio"){let rt=this._audioGroups;rt||(rt=this._audioGroups=[]),rt.indexOf(et)===-1&&rt.push(et)}else if(_e==="text"){let rt=this._subtitleGroups;rt||(rt=this._subtitleGroups=[]),rt.indexOf(et)===-1&&rt.push(et)}}}get urlId(){return 0}set urlId(_e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var _e;return(_e=this.audioGroups)==null?void 0:_e[0]}get textGroupId(){var _e;return(_e=this.subtitleGroups)==null?void 0:_e[0]}addFallback(){}}function hasGroup(nt,_e){return!_e||!nt?!1:nt.indexOf(_e)!==-1}function updateFromToPTS(nt,_e){const et=_e.startPTS;if(isFiniteNumber(et)){let rt=0,it;_e.sn>nt.sn?(rt=et-nt.start,it=nt):(rt=nt.start-et,it=_e),it.duration!==rt&&(it.duration=rt)}else _e.sn>nt.sn?nt.cc===_e.cc&&nt.minEndPTS?_e.start=nt.start+(nt.minEndPTS-nt.start):_e.start=nt.start+nt.duration:_e.start=Math.max(nt.start-_e.duration,0)}function updateFragPTSDTS(nt,_e,et,rt,it,st){rt-et<=0&&(logger.warn("Fragment should have a positive duration",_e),rt=et+_e.duration,st=it+_e.duration);let at=et,lt=rt;const ct=_e.startPTS,ut=_e.endPTS;if(isFiniteNumber(ct)){const At=Math.abs(ct-et);isFiniteNumber(_e.deltaPTS)?_e.deltaPTS=Math.max(At,_e.deltaPTS):_e.deltaPTS=At,at=Math.max(et,ct),et=Math.min(et,ct),it=Math.min(it,_e.startDTS),lt=Math.min(rt,ut),rt=Math.max(rt,ut),st=Math.max(st,_e.endDTS)}const ht=et-_e.start;_e.start!==0&&(_e.start=et),_e.duration=rt-_e.start,_e.startPTS=et,_e.maxStartPTS=at,_e.startDTS=it,_e.endPTS=rt,_e.minEndPTS=lt,_e.endDTS=st;const dt=_e.sn;if(!nt||dt<nt.startSN||dt>nt.endSN)return 0;let ft;const pt=dt-nt.startSN,mt=nt.fragments;for(mt[pt]=_e,ft=pt;ft>0;ft--)updateFromToPTS(mt[ft],mt[ft-1]);for(ft=pt;ft<mt.length-1;ft++)updateFromToPTS(mt[ft],mt[ft+1]);return nt.fragmentHint&&updateFromToPTS(mt[mt.length-1],nt.fragmentHint),nt.PTSKnown=nt.alignedSliding=!0,ht}function mergeDetails(nt,_e){let et=null;const rt=nt.fragments;for(let lt=rt.length-1;lt>=0;lt--){const ct=rt[lt].initSegment;if(ct){et=ct;break}}nt.fragmentHint&&delete nt.fragmentHint.endPTS;let it=0,st;if(mapFragmentIntersection(nt,_e,(lt,ct)=>{lt.relurl&&(it=lt.cc-ct.cc),isFiniteNumber(lt.startPTS)&&isFiniteNumber(lt.endPTS)&&(ct.start=ct.startPTS=lt.startPTS,ct.startDTS=lt.startDTS,ct.maxStartPTS=lt.maxStartPTS,ct.endPTS=lt.endPTS,ct.endDTS=lt.endDTS,ct.minEndPTS=lt.minEndPTS,ct.duration=lt.endPTS-lt.startPTS,ct.duration&&(st=ct),_e.PTSKnown=_e.alignedSliding=!0),ct.elementaryStreams=lt.elementaryStreams,ct.loader=lt.loader,ct.stats=lt.stats,lt.initSegment&&(ct.initSegment=lt.initSegment,et=lt.initSegment)}),et&&(_e.fragmentHint?_e.fragments.concat(_e.fragmentHint):_e.fragments).forEach(ct=>{var ut;ct&&(!ct.initSegment||ct.initSegment.relurl===((ut=et)==null?void 0:ut.relurl))&&(ct.initSegment=et)}),_e.skippedSegments)if(_e.deltaUpdateFailed=_e.fragments.some(lt=>!lt),_e.deltaUpdateFailed){logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let lt=_e.skippedSegments;lt--;)_e.fragments.shift();_e.startSN=_e.fragments[0].sn,_e.startCC=_e.fragments[0].cc}else _e.canSkipDateRanges&&(_e.dateRanges=mergeDateRanges(nt.dateRanges,_e.dateRanges,_e.recentlyRemovedDateranges));const ot=_e.fragments;if(it){logger.warn("discontinuity sliding from playlist, take drift into account");for(let lt=0;lt<ot.length;lt++)ot[lt].cc+=it}_e.skippedSegments&&(_e.startCC=_e.fragments[0].cc),mapPartIntersection(nt.partList,_e.partList,(lt,ct)=>{ct.elementaryStreams=lt.elementaryStreams,ct.stats=lt.stats}),st?updateFragPTSDTS(_e,st,st.startPTS,st.endPTS,st.startDTS,st.endDTS):adjustSliding(nt,_e),ot.length&&(_e.totalduration=_e.edge-ot[0].start),_e.driftStartTime=nt.driftStartTime,_e.driftStart=nt.driftStart;const at=_e.advancedDateTime;if(_e.advanced&&at){const lt=_e.edge;_e.driftStart||(_e.driftStartTime=at,_e.driftStart=lt),_e.driftEndTime=at,_e.driftEnd=lt}else _e.driftEndTime=nt.driftEndTime,_e.driftEnd=nt.driftEnd,_e.advancedDateTime=nt.advancedDateTime}function mergeDateRanges(nt,_e,et){const rt=_extends$1({},nt);return et&&et.forEach(it=>{delete rt[it]}),Object.keys(_e).forEach(it=>{const st=new DateRange(_e[it].attr,rt[it]);st.isValid?rt[it]=st:logger.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(_e[it].attr)}"`)}),rt}function mapPartIntersection(nt,_e,et){if(nt&&_e){let rt=0;for(let it=0,st=nt.length;it<=st;it++){const ot=nt[it],at=_e[it+rt];ot&&at&&ot.index===at.index&&ot.fragment.sn===at.fragment.sn?et(ot,at):rt--}}}function mapFragmentIntersection(nt,_e,et){const rt=_e.skippedSegments,it=Math.max(nt.startSN,_e.startSN)-_e.startSN,st=(nt.fragmentHint?1:0)+(rt?_e.endSN:Math.min(nt.endSN,_e.endSN))-_e.startSN,ot=_e.startSN-nt.startSN,at=_e.fragmentHint?_e.fragments.concat(_e.fragmentHint):_e.fragments,lt=nt.fragmentHint?nt.fragments.concat(nt.fragmentHint):nt.fragments;for(let ct=it;ct<=st;ct++){const ut=lt[ot+ct];let ht=at[ct];rt&&!ht&&ct<rt&&(ht=_e.fragments[ct]=ut),ut&&ht&&et(ut,ht)}}function adjustSliding(nt,_e){const et=_e.startSN+_e.skippedSegments-nt.startSN,rt=nt.fragments;et<0||et>=rt.length||addSliding(_e,rt[et].start)}function addSliding(nt,_e){if(_e){const et=nt.fragments;for(let rt=nt.skippedSegments;rt<et.length;rt++)et[rt].start+=_e;nt.fragmentHint&&(nt.fragmentHint.start+=_e)}}function computeReloadInterval(nt,_e=1/0){let et=1e3*nt.targetduration;if(nt.updated){const rt=nt.fragments;if(rt.length&&et*4>_e){const st=rt[rt.length-1].duration*1e3;st<et&&(et=st)}}else et/=2;return Math.round(et)}function getFragmentWithSN(nt,_e,et){if(!(nt!=null&&nt.details))return null;const rt=nt.details;let it=rt.fragments[_e-rt.startSN];return it||(it=rt.fragmentHint,it&&it.sn===_e)?it:_e<rt.startSN&&et&&et.sn===_e?et:null}function getPartWith(nt,_e,et){var rt;return nt!=null&&nt.details?findPart((rt=nt.details)==null?void 0:rt.partList,_e,et):null}function findPart(nt,_e,et){if(nt)for(let rt=nt.length;rt--;){const it=nt[rt];if(it.index===et&&it.fragment.sn===_e)return it}return null}function reassignFragmentLevelIndexes(nt){nt.forEach((_e,et)=>{const{details:rt}=_e;rt!=null&&rt.fragments&&rt.fragments.forEach(it=>{it.level=et})})}function isTimeoutError(nt){switch(nt.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function getRetryConfig(nt,_e){const et=isTimeoutError(_e);return nt.default[`${et?"timeout":"error"}Retry`]}function getRetryDelay(nt,_e){const et=nt.backoff==="linear"?1:Math.pow(2,_e);return Math.min(et*nt.retryDelayMs,nt.maxRetryDelayMs)}function getLoaderConfigWithoutReties(nt){return _objectSpread2$3(_objectSpread2$3({},nt),{errorRetry:null,timeoutRetry:null})}function shouldRetry(nt,_e,et,rt){if(!nt)return!1;const it=rt==null?void 0:rt.code,st=_e<nt.maxNumRetry&&(retryForHttpStatus(it)||!!et);return nt.shouldRetry?nt.shouldRetry(nt,_e,et,rt,st):st}function retryForHttpStatus(nt){return nt===0&&navigator.onLine===!1||!!nt&&(nt<400||nt>499)}const BinarySearch={search:function(nt,_e){let et=0,rt=nt.length-1,it=null,st=null;for(;et<=rt;){it=(et+rt)/2|0,st=nt[it];const ot=_e(st);if(ot>0)et=it+1;else if(ot<0)rt=it-1;else return st}return null}};function findFragmentByPDT(nt,_e,et){if(_e===null||!Array.isArray(nt)||!nt.length||!isFiniteNumber(_e))return null;const rt=nt[0].programDateTime;if(_e<(rt||0))return null;const it=nt[nt.length-1].endProgramDateTime;if(_e>=(it||0))return null;et=et||0;for(let st=0;st<nt.length;++st){const ot=nt[st];if(pdtWithinToleranceTest(_e,et,ot))return ot}return null}function findFragmentByPTS(nt,_e,et=0,rt=0,it=.005){let st=null;if(nt){st=_e[nt.sn-_e[0].sn+1]||null;const at=nt.endDTS-et;at>0&&at<15e-7&&(et+=15e-7)}else et===0&&_e[0].start===0&&(st=_e[0]);if(st&&((!nt||nt.level===st.level)&&fragmentWithinToleranceTest(et,rt,st)===0||fragmentWithinFastStartSwitch(st,nt,Math.min(it,rt))))return st;const ot=BinarySearch.search(_e,fragmentWithinToleranceTest.bind(null,et,rt));return ot&&(ot!==nt||!st)?ot:st}function fragmentWithinFastStartSwitch(nt,_e,et){if(_e&&_e.start===0&&_e.level<nt.level&&(_e.endPTS||0)>0){const rt=_e.tagList.reduce((it,st)=>(st[0]==="INF"&&(it+=parseFloat(st[1])),it),et);return nt.start<=rt}return!1}function fragmentWithinToleranceTest(nt=0,_e=0,et){if(et.start<=nt&&et.start+et.duration>nt)return 0;const rt=Math.min(_e,et.duration+(et.deltaPTS?et.deltaPTS:0));return et.start+et.duration-rt<=nt?1:et.start-rt>nt&&et.start?-1:0}function pdtWithinToleranceTest(nt,_e,et){const rt=Math.min(_e,et.duration+(et.deltaPTS?et.deltaPTS:0))*1e3;return(et.endProgramDateTime||0)-rt>nt}function findFragWithCC(nt,_e){return BinarySearch.search(nt,et=>et.cc<_e?1:et.cc>_e?-1:0)}var NetworkErrorAction={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ErrorActionFlags={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class ErrorController{constructor(_e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=_e,this.log=logger.log.bind(logger,"[info]:"),this.warn=logger.warn.bind(logger,"[warning]:"),this.error=logger.error.bind(logger,"[error]:"),this.registerListeners()}registerListeners(){const _e=this.hls;_e.on(Events.ERROR,this.onError,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const _e=this.hls;_e&&(_e.off(Events.ERROR,this.onError,this),_e.off(Events.ERROR,this.onErrorOut,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(_e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(_e){return(_e==null?void 0:_e.type)===PlaylistLevelType.MAIN?_e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(_e,et){var rt,it;if(et.fatal)return;const st=this.hls,ot=et.context;switch(et.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:et.errorAction=this.getFragRetryOrSwitchAction(et);return;case ErrorDetails.FRAG_PARSING_ERROR:if((rt=et.frag)!=null&&rt.gap){et.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_DECRYPT_ERROR:{et.errorAction=this.getFragRetryOrSwitchAction(et),et.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox;return}case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var at,lt;const ct=et.parent===PlaylistLevelType.MAIN?et.level:st.loadLevel;et.details===ErrorDetails.LEVEL_EMPTY_ERROR&&((at=et.context)!=null&&(lt=at.levelDetails)!=null&&lt.live)?et.errorAction=this.getPlaylistRetryOrSwitchAction(et,ct):(et.levelRetry=!1,et.errorAction=this.getLevelSwitchAction(et,ct))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:typeof(ot==null?void 0:ot.level)=="number"&&(et.errorAction=this.getPlaylistRetryOrSwitchAction(et,ot.level));return;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(ot){const ct=st.levels[st.loadLevel];if(ct&&(ot.type===PlaylistContextType.AUDIO_TRACK&&ct.hasAudioGroup(ot.groupId)||ot.type===PlaylistContextType.SUBTITLE_TRACK&&ct.hasSubtitleGroup(ot.groupId))){et.errorAction=this.getPlaylistRetryOrSwitchAction(et,st.loadLevel),et.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox,et.errorAction.flags=ErrorActionFlags.MoveAllAlternatesMatchingHost;return}}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const ct=st.levels[st.loadLevel],ut=ct==null?void 0:ct.attrs["HDCP-LEVEL"];ut?et.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHDCP,hdcpLevel:ut}:this.keySystemError(et)}return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:et.errorAction=this.getLevelSwitchAction(et,(it=et.level)!=null?it:st.loadLevel);return;case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:et.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}et.type===ErrorTypes.KEY_SYSTEM_ERROR&&this.keySystemError(et)}keySystemError(_e){const et=this.getVariantLevelIndex(_e.frag);_e.levelRetry=!1,_e.errorAction=this.getLevelSwitchAction(_e,et)}getPlaylistRetryOrSwitchAction(_e,et){const rt=this.hls,it=getRetryConfig(rt.config.playlistLoadPolicy,_e),st=this.playlistError++;if(shouldRetry(it,st,isTimeoutError(_e),_e.response))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:it,retryCount:st};const at=this.getLevelSwitchAction(_e,et);return it&&(at.retryConfig=it,at.retryCount=st),at}getFragRetryOrSwitchAction(_e){const et=this.hls,rt=this.getVariantLevelIndex(_e.frag),it=et.levels[rt],{fragLoadPolicy:st,keyLoadPolicy:ot}=et.config,at=getRetryConfig(_e.details.startsWith("key")?ot:st,_e),lt=et.levels.reduce((ut,ht)=>ut+ht.fragmentError,0);if(it&&(_e.details!==ErrorDetails.FRAG_GAP&&it.fragmentError++,shouldRetry(at,lt,isTimeoutError(_e),_e.response)))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:at,retryCount:lt};const ct=this.getLevelSwitchAction(_e,rt);return at&&(ct.retryConfig=at,ct.retryCount=lt),ct}getLevelSwitchAction(_e,et){const rt=this.hls;et==null&&(et=rt.loadLevel);const it=this.hls.levels[et];if(it){var st,ot;const ct=_e.details;it.loadError++,ct===ErrorDetails.BUFFER_APPEND_ERROR&&it.fragmentError++;let ut=-1;const{levels:ht,loadLevel:dt,minAutoLevel:ft,maxAutoLevel:pt}=rt;rt.autoLevelEnabled||(rt.loadLevel=-1);const mt=(st=_e.frag)==null?void 0:st.type,gt=(mt===PlaylistLevelType.AUDIO&&ct===ErrorDetails.FRAG_PARSING_ERROR||_e.sourceBufferName==="audio"&&(ct===ErrorDetails.BUFFER_ADD_CODEC_ERROR||ct===ErrorDetails.BUFFER_APPEND_ERROR))&&ht.some(({audioCodec:It})=>it.audioCodec!==It),Tt=_e.sourceBufferName==="video"&&(ct===ErrorDetails.BUFFER_ADD_CODEC_ERROR||ct===ErrorDetails.BUFFER_APPEND_ERROR)&&ht.some(({codecSet:It,audioCodec:Lt})=>it.codecSet!==It&&it.audioCodec===Lt),{type:wt,groupId:Rt}=(ot=_e.context)!=null?ot:{};for(let It=ht.length;It--;){const Lt=(It+dt)%ht.length;if(Lt!==dt&&Lt>=ft&&Lt<=pt&&ht[Lt].loadError===0){var at,lt;const $t=ht[Lt];if(ct===ErrorDetails.FRAG_GAP&&mt===PlaylistLevelType.MAIN&&_e.frag){const kt=ht[Lt].details;if(kt){const Dt=findFragmentByPTS(_e.frag,kt.fragments,_e.frag.start);if(Dt!=null&&Dt.gap)continue}}else{if(wt===PlaylistContextType.AUDIO_TRACK&&$t.hasAudioGroup(Rt)||wt===PlaylistContextType.SUBTITLE_TRACK&&$t.hasSubtitleGroup(Rt))continue;if(mt===PlaylistLevelType.AUDIO&&(at=it.audioGroups)!=null&&at.some(kt=>$t.hasAudioGroup(kt))||mt===PlaylistLevelType.SUBTITLE&&(lt=it.subtitleGroups)!=null&&lt.some(kt=>$t.hasSubtitleGroup(kt))||gt&&it.audioCodec===$t.audioCodec||!gt&&it.audioCodec!==$t.audioCodec||Tt&&it.codecSet===$t.codecSet)continue}ut=Lt;break}}if(ut>-1&&rt.loadLevel!==ut)return _e.levelRetry=!0,this.playlistError=0,{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.None,nextAutoLevel:ut}}return{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHost}}onErrorOut(_e,et){var rt;switch((rt=et.errorAction)==null?void 0:rt.action){case NetworkErrorAction.DoNothing:break;case NetworkErrorAction.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(et),!et.errorAction.resolved&&et.details!==ErrorDetails.FRAG_GAP?et.fatal=!0:/MediaSource readyState: ended/.test(et.error.message)&&(this.warn(`MediaSource ended after "${et.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case NetworkErrorAction.RetryRequest:break}if(et.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(_e){const et=this.hls,rt=_e.errorAction;if(!rt)return;const{flags:it,hdcpLevel:st,nextAutoLevel:ot}=rt;switch(it){case ErrorActionFlags.None:this.switchLevel(_e,ot);break;case ErrorActionFlags.MoveAllAlternatesMatchingHDCP:st&&(et.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(st)-1],rt.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${et.maxHdcpLevel}" or lower`);break}rt.resolved||this.switchLevel(_e,ot)}switchLevel(_e,et){et!==void 0&&_e.errorAction&&(this.warn(`switching to level ${et} after ${_e.details}`),this.hls.nextAutoLevel=et,_e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class BasePlaylistController{constructor(_e,et){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=logger.log.bind(logger,`${et}:`),this.warn=logger.warn.bind(logger,`${et}:`),this.hls=_e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(_e,et,rt){const it=et==null?void 0:et.renditionReports;if(it){let st=-1;for(let ot=0;ot<it.length;ot++){const at=it[ot];let lt;try{lt=new self.URL(at.URI,et.url).href}catch(ct){logger.warn(`Could not construct new URL for Rendition Report: ${ct}`),lt=at.URI||""}if(lt===_e){st=ot;break}else lt===_e.substring(0,lt.length)&&(st=ot)}if(st!==-1){const ot=it[st],at=parseInt(ot["LAST-MSN"])||(et==null?void 0:et.lastPartSn);let lt=parseInt(ot["LAST-PART"])||(et==null?void 0:et.lastPartIndex);if(this.hls.config.lowLatencyMode){const ut=Math.min(et.age-et.partTarget,et.targetduration);lt>=0&&ut>et.partTarget&&(lt+=1)}const ct=rt&&getSkipValue(rt);return new HlsUrlParameters(at,lt>=0?lt:void 0,ct)}}}loadPlaylist(_e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(_e){return this.canLoad&&!!_e&&!!_e.url&&(!_e.details||_e.details.live)}shouldReloadPlaylist(_e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(_e)}playlistLoaded(_e,et,rt){const{details:it,stats:st}=et,ot=self.performance.now(),at=st.loading.first?Math.max(0,ot-st.loading.first):0;if(it.advancedDateTime=Date.now()-at,it.live||rt!=null&&rt.live){if(it.reloaded(rt),rt&&this.log(`live playlist ${_e} ${it.advanced?"REFRESHED "+it.lastPartSn+"-"+it.lastPartIndex:it.updated?"UPDATED":"MISSED"}`),rt&&it.fragments.length>0&&mergeDetails(rt,it),!this.canLoad||!it.live)return;let lt,ct,ut;if(it.canBlockReload&&it.endSN&&it.advanced){const At=this.hls.config.lowLatencyMode,gt=it.lastPartSn,bt=it.endSN,Tt=it.lastPartIndex,wt=Tt!==-1,Rt=gt===bt,It=At?0:Tt;wt?(ct=Rt?bt+1:gt,ut=Rt?It:Tt+1):ct=bt+1;const Lt=it.age,$t=Lt+it.ageHeader;let kt=Math.min($t-it.partTarget,it.targetduration*1.5);if(kt>0){if(rt&&kt>rt.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${rt.tuneInGoal} to: ${kt} with playlist age: ${it.age}`),kt=0;else{const Dt=Math.floor(kt/it.targetduration);if(ct+=Dt,ut!==void 0){const Ot=Math.round(kt%it.targetduration/it.partTarget);ut+=Ot}this.log(`CDN Tune-in age: ${it.ageHeader}s last advanced ${Lt.toFixed(2)}s goal: ${kt} skip sn ${Dt} to part ${ut}`)}it.tuneInGoal=kt}if(lt=this.getDeliveryDirectives(it,et.deliveryDirectives,ct,ut),At||!Rt){this.loadPlaylist(lt);return}}else(it.canBlockReload||it.canSkipUntil)&&(lt=this.getDeliveryDirectives(it,et.deliveryDirectives,ct,ut));const ht=this.hls.mainForwardBufferInfo,dt=ht?ht.end-ht.len:0,ft=(it.edge-dt)*1e3,pt=computeReloadInterval(it,ft);it.updated&&ot>this.requestScheduled+pt&&(this.requestScheduled=st.loading.start),ct!==void 0&&it.canBlockReload?this.requestScheduled=st.loading.first+pt-(it.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+pt<ot?this.requestScheduled=ot:this.requestScheduled-ot<=0&&(this.requestScheduled+=pt);let mt=this.requestScheduled-ot;mt=Math.max(0,mt),this.log(`reload live playlist ${_e} in ${Math.round(mt)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(lt),mt)}else this.clearTimer()}getDeliveryDirectives(_e,et,rt,it){let st=getSkipValue(_e);return et!=null&&et.skip&&_e.deltaUpdateFailed&&(rt=et.msn,it=et.part,st=HlsSkip.No),new HlsUrlParameters(rt,it,st)}checkRetry(_e){const et=_e.details,rt=isTimeoutError(_e),it=_e.errorAction,{action:st,retryCount:ot=0,retryConfig:at}=it||{},lt=!!it&&!!at&&(st===NetworkErrorAction.RetryRequest||!it.resolved&&st===NetworkErrorAction.SendAlternateToPenaltyBox);if(lt){var ct;if(this.requestScheduled=-1,ot>=at.maxNumRetry)return!1;if(rt&&(ct=_e.context)!=null&&ct.deliveryDirectives)this.warn(`Retrying playlist loading ${ot+1}/${at.maxNumRetry} after "${et}" without delivery-directives`),this.loadPlaylist();else{const ut=getRetryDelay(at,ot);this.timer=self.setTimeout(()=>this.loadPlaylist(),ut),this.warn(`Retrying playlist loading ${ot+1}/${at.maxNumRetry} after "${et}" in ${ut}ms`)}_e.levelRetry=!0,it.resolved=!0}return lt}}class EWMA{constructor(_e,et=0,rt=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=_e,this.alpha_=_e?Math.exp(Math.log(.5)/_e):0,this.estimate_=et,this.totalWeight_=rt}sample(_e,et){const rt=Math.pow(this.alpha_,_e);this.estimate_=et*(1-rt)+rt*this.estimate_,this.totalWeight_+=_e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const _e=1-Math.pow(this.alpha_,this.totalWeight_);if(_e)return this.estimate_/_e}return this.estimate_}}class EwmaBandWidthEstimator{constructor(_e,et,rt,it=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=rt,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(_e),this.fast_=new EWMA(et),this.defaultTTFB_=it,this.ttfb_=new EWMA(_e)}update(_e,et){const{slow_:rt,fast_:it,ttfb_:st}=this;rt.halfLife!==_e&&(this.slow_=new EWMA(_e,rt.getEstimate(),rt.getTotalWeight())),it.halfLife!==et&&(this.fast_=new EWMA(et,it.getEstimate(),it.getTotalWeight())),st.halfLife!==_e&&(this.ttfb_=new EWMA(_e,st.getEstimate(),st.getTotalWeight()))}sample(_e,et){_e=Math.max(_e,this.minDelayMs_);const rt=8*et,it=_e/1e3,st=rt/it;this.fast_.sample(it,st),this.slow_.sample(it,st)}sampleTTFB(_e){const et=_e/1e3,rt=Math.sqrt(2)*Math.exp(-Math.pow(et,2)/2);this.ttfb_.sample(rt,Math.max(_e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const SUPPORTED_INFO_DEFAULT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},SUPPORTED_INFO_CACHE={};function requiresMediaCapabilitiesDecodingInfo(nt,_e,et,rt,it,st){const ot=nt.audioCodec?nt.audioGroups:null,at=st==null?void 0:st.audioCodec,lt=st==null?void 0:st.channels,ct=lt?parseInt(lt):at?1/0:2;let ut=null;if(ot!=null&&ot.length)try{ot.length===1&&ot[0]?ut=_e.groups[ot[0]].channels:ut=ot.reduce((ht,dt)=>{if(dt){const ft=_e.groups[dt];if(!ft)throw new Error(`Audio track group ${dt} not found`);Object.keys(ft.channels).forEach(pt=>{ht[pt]=(ht[pt]||0)+ft.channels[pt]})}return ht},{2:0})}catch{return!0}return nt.videoCodec!==void 0&&(nt.width>1920&&nt.height>1088||nt.height>1920&&nt.width>1088||nt.frameRate>Math.max(rt,30)||nt.videoRange!=="SDR"&&nt.videoRange!==et||nt.bitrate>Math.max(it,8e6))||!!ut&&isFiniteNumber(ct)&&Object.keys(ut).some(ht=>parseInt(ht)>ct)}function getMediaDecodingInfoPromise(nt,_e,et){const rt=nt.videoCodec,it=nt.audioCodec;if(!rt||!it||!et)return Promise.resolve(SUPPORTED_INFO_DEFAULT);const st={width:nt.width,height:nt.height,bitrate:Math.ceil(Math.max(nt.bitrate*.9,nt.averageBitrate)),framerate:nt.frameRate||30},ot=nt.videoRange;ot!=="SDR"&&(st.transferFunction=ot.toLowerCase());const at=rt.split(",").map(lt=>({type:"media-source",video:_objectSpread2$3(_objectSpread2$3({},st),{},{contentType:mimeTypeForCodec(lt,"video")})}));return it&&nt.audioGroups&&nt.audioGroups.forEach(lt=>{var ct;lt&&((ct=_e.groups[lt])==null||ct.tracks.forEach(ut=>{if(ut.groupId===lt){const ht=ut.channels||"",dt=parseFloat(ht);isFiniteNumber(dt)&&dt>2&&at.push.apply(at,it.split(",").map(ft=>({type:"media-source",audio:{contentType:mimeTypeForCodec(ft,"audio"),channels:""+dt}})))}}))}),Promise.all(at.map(lt=>{const ct=getMediaDecodingInfoKey(lt);return SUPPORTED_INFO_CACHE[ct]||(SUPPORTED_INFO_CACHE[ct]=et.decodingInfo(lt))})).then(lt=>({supported:!lt.some(ct=>!ct.supported),configurations:at,decodingInfoResults:lt})).catch(lt=>({supported:!1,configurations:at,decodingInfoResults:[],error:lt}))}function getMediaDecodingInfoKey(nt){const{audio:_e,video:et}=nt,rt=et||_e;if(rt){const it=rt.contentType.split('"')[1];if(et)return`r${et.height}x${et.width}f${Math.ceil(et.framerate)}${et.transferFunction||"sd"}_${it}_${Math.ceil(et.bitrate/1e5)}`;if(_e)return`c${_e.channels}${_e.spatialRendering?"s":"n"}_${it}`}return""}function isHdrSupported(){if(typeof matchMedia=="function"){const nt=matchMedia("(dynamic-range: high)"),_e=matchMedia("bad query");if(nt.media!==_e.media)return nt.matches===!0}return!1}function getVideoSelectionOptions(nt,_e){let et=!1,rt=[];return nt&&(et=nt!=="SDR",rt=[nt]),_e&&(rt=_e.allowedVideoRanges||VideoRangeValues.slice(0),et=_e.preferHDR!==void 0?_e.preferHDR:isHdrSupported(),et?rt=rt.filter(it=>it!=="SDR"):rt=["SDR"]),{preferHDR:et,allowedVideoRanges:rt}}function getStartCodecTier(nt,_e,et,rt,it){const st=Object.keys(nt),ot=rt==null?void 0:rt.channels,at=rt==null?void 0:rt.audioCodec,lt=ot&&parseInt(ot)===2;let ct=!0,ut=!1,ht=1/0,dt=1/0,ft=1/0,pt=0,mt=[];const{preferHDR:At,allowedVideoRanges:gt}=getVideoSelectionOptions(_e,it);for(let Rt=st.length;Rt--;){const It=nt[st[Rt]];ct=It.channels[2]>0,ht=Math.min(ht,It.minHeight),dt=Math.min(dt,It.minFramerate),ft=Math.min(ft,It.minBitrate);const Lt=gt.filter($t=>It.videoRanges[$t]>0);Lt.length>0&&(ut=!0,mt=Lt)}ht=isFiniteNumber(ht)?ht:0,dt=isFiniteNumber(dt)?dt:0;const bt=Math.max(1080,ht),Tt=Math.max(30,dt);return ft=isFiniteNumber(ft)?ft:et,et=Math.max(ft,et),ut||(_e=void 0,mt=[]),{codecSet:st.reduce((Rt,It)=>{const Lt=nt[It];if(It===Rt)return Rt;if(Lt.minBitrate>et)return logStartCodecCandidateIgnored(It,`min bitrate of ${Lt.minBitrate} > current estimate of ${et}`),Rt;if(!Lt.hasDefaultAudio)return logStartCodecCandidateIgnored(It,"no renditions with default or auto-select sound found"),Rt;if(at&&It.indexOf(at.substring(0,4))%5!==0)return logStartCodecCandidateIgnored(It,`audio codec preference "${at}" not found`),Rt;if(ot&&!lt){if(!Lt.channels[ot])return logStartCodecCandidateIgnored(It,`no renditions with ${ot} channel sound found (channels options: ${Object.keys(Lt.channels)})`),Rt}else if((!at||lt)&&ct&&Lt.channels[2]===0)return logStartCodecCandidateIgnored(It,"no renditions with stereo sound found"),Rt;return Lt.minHeight>bt?(logStartCodecCandidateIgnored(It,`min resolution of ${Lt.minHeight} > maximum of ${bt}`),Rt):Lt.minFramerate>Tt?(logStartCodecCandidateIgnored(It,`min framerate of ${Lt.minFramerate} > maximum of ${Tt}`),Rt):mt.some($t=>Lt.videoRanges[$t]>0)?Lt.maxScore<pt?(logStartCodecCandidateIgnored(It,`max score of ${Lt.maxScore} < selected max of ${pt}`),Rt):Rt&&(codecsSetSelectionPreferenceValue(It)>=codecsSetSelectionPreferenceValue(Rt)||Lt.fragmentError>nt[Rt].fragmentError)?Rt:(pt=Lt.maxScore,It):(logStartCodecCandidateIgnored(It,`no variants with VIDEO-RANGE of ${JSON.stringify(mt)} found`),Rt)},void 0),videoRanges:mt,preferHDR:At,minFramerate:dt,minBitrate:ft}}function logStartCodecCandidateIgnored(nt,_e){logger.log(`[abr] start candidates with "${nt}" ignored because ${_e}`)}function getAudioTracksByGroup(nt){return nt.reduce((_e,et)=>{let rt=_e.groups[et.groupId];rt||(rt=_e.groups[et.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),rt.tracks.push(et);const it=et.channels||"2";return rt.channels[it]=(rt.channels[it]||0)+1,rt.hasDefault=rt.hasDefault||et.default,rt.hasAutoSelect=rt.hasAutoSelect||et.autoselect,rt.hasDefault&&(_e.hasDefaultAudio=!0),rt.hasAutoSelect&&(_e.hasAutoSelectAudio=!0),_e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function getCodecTiers(nt,_e,et,rt){return nt.slice(et,rt+1).reduce((it,st)=>{if(!st.codecSet)return it;const ot=st.audioGroups;let at=it[st.codecSet];at||(it[st.codecSet]=at={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!ot,fragmentError:0}),at.minBitrate=Math.min(at.minBitrate,st.bitrate);const lt=Math.min(st.height,st.width);return at.minHeight=Math.min(at.minHeight,lt),at.minFramerate=Math.min(at.minFramerate,st.frameRate),at.maxScore=Math.max(at.maxScore,st.score),at.fragmentError+=st.fragmentError,at.videoRanges[st.videoRange]=(at.videoRanges[st.videoRange]||0)+1,ot&&ot.forEach(ct=>{if(!ct)return;const ut=_e.groups[ct];ut&&(at.hasDefaultAudio=at.hasDefaultAudio||_e.hasDefaultAudio?ut.hasDefault:ut.hasAutoSelect||!_e.hasDefaultAudio&&!_e.hasAutoSelectAudio,Object.keys(ut.channels).forEach(ht=>{at.channels[ht]=(at.channels[ht]||0)+ut.channels[ht]}))}),it},{})}function findMatchingOption(nt,_e,et){if("attrs"in nt){const rt=_e.indexOf(nt);if(rt!==-1)return rt}for(let rt=0;rt<_e.length;rt++){const it=_e[rt];if(matchesOption(nt,it,et))return rt}return-1}function matchesOption(nt,_e,et){const{groupId:rt,name:it,lang:st,assocLang:ot,characteristics:at,default:lt}=nt,ct=nt.forced;return(rt===void 0||_e.groupId===rt)&&(it===void 0||_e.name===it)&&(st===void 0||_e.lang===st)&&(st===void 0||_e.assocLang===ot)&&(lt===void 0||_e.default===lt)&&(ct===void 0||_e.forced===ct)&&(at===void 0||characteristicsMatch(at,_e.characteristics))&&(et===void 0||et(nt,_e))}function characteristicsMatch(nt,_e=""){const et=nt.split(","),rt=_e.split(",");return et.length===rt.length&&!et.some(it=>rt.indexOf(it)===-1)}function audioMatchPredicate(nt,_e){const{audioCodec:et,channels:rt}=nt;return(et===void 0||(_e.audioCodec||"").substring(0,4)===et.substring(0,4))&&(rt===void 0||rt===(_e.channels||"2"))}function findClosestLevelWithAudioGroup(nt,_e,et,rt,it){const st=_e[rt],at=_e.reduce((dt,ft,pt)=>{const mt=ft.uri;return(dt[mt]||(dt[mt]=[])).push(pt),dt},{})[st.uri];at.length>1&&(rt=Math.max.apply(Math,at));const lt=st.videoRange,ct=st.frameRate,ut=st.codecSet.substring(0,4),ht=searchDownAndUpList(_e,rt,dt=>{if(dt.videoRange!==lt||dt.frameRate!==ct||dt.codecSet.substring(0,4)!==ut)return!1;const ft=dt.audioGroups,pt=et.filter(mt=>!ft||ft.indexOf(mt.groupId)!==-1);return findMatchingOption(nt,pt,it)>-1});return ht>-1?ht:searchDownAndUpList(_e,rt,dt=>{const ft=dt.audioGroups,pt=et.filter(mt=>!ft||ft.indexOf(mt.groupId)!==-1);return findMatchingOption(nt,pt,it)>-1})}function searchDownAndUpList(nt,_e,et){for(let rt=_e;rt>-1;rt--)if(et(nt[rt]))return rt;for(let rt=_e+1;rt<nt.length;rt++)if(et(nt[rt]))return rt;return-1}class AbrController{constructor(_e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:et,partCurrent:rt,hls:it}=this,{autoLevelEnabled:st,media:ot}=it;if(!et||!ot)return;const at=performance.now(),lt=rt?rt.stats:et.stats,ct=rt?rt.duration:et.duration,ut=at-lt.loading.start,ht=it.minAutoLevel;if(lt.aborted||lt.loaded&&lt.loaded===lt.total||et.level<=ht){this.clearTimer(),this._nextAutoLevel=-1;return}if(!st||ot.paused||!ot.playbackRate||!ot.readyState)return;const dt=it.mainForwardBufferInfo;if(dt===null)return;const ft=this.bwEstimator.getEstimateTTFB(),pt=Math.abs(ot.playbackRate);if(ut<=Math.max(ft,1e3*(ct/(pt*2))))return;const mt=dt.len/pt,At=lt.loading.first?lt.loading.first-lt.loading.start:-1,gt=lt.loaded&&At>-1,bt=this.getBwEstimate(),Tt=it.levels,wt=Tt[et.level],Rt=lt.total||Math.max(lt.loaded,Math.round(ct*wt.averageBitrate/8));let It=gt?ut-At:ut;It<1&&gt&&(It=Math.min(ut,lt.loaded*8/bt));const Lt=gt?lt.loaded*1e3/It:0,$t=Lt?(Rt-lt.loaded)/Lt:Rt*8/bt+ft/1e3;if($t<=mt)return;const kt=Lt?Lt*8:bt;let Dt=Number.POSITIVE_INFINITY,Ot;for(Ot=et.level-1;Ot>ht;Ot--){const Ht=Tt[Ot].maxBitrate;if(Dt=this.getTimeToLoadFrag(ft/1e3,kt,ct*Ht,!Tt[Ot].details),Dt<mt)break}if(Dt>=$t||Dt>ct*10)return;it.nextLoadLevel=it.nextAutoLevel=Ot,gt?this.bwEstimator.sample(ut-Math.min(ft,At),lt.loaded):this.bwEstimator.sampleTTFB(ut);const zt=Tt[Ot].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>zt&&this.resetEstimator(zt),this.clearTimer(),logger.warn(`[abr] Fragment ${et.sn}${rt?" part "+rt.index:""} of level ${et.level} is loading too slowly;
      Time to underbuffer: ${mt.toFixed(3)} s
      Estimated load time for current fragment: ${$t.toFixed(3)} s
      Estimated load time for down switch fragment: ${Dt.toFixed(3)} s
      TTFB estimate: ${At|0} ms
      Current BW estimate: ${isFiniteNumber(bt)?bt|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${Ot} @ ${zt|0} bps`),it.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:et,part:rt,stats:lt})},this.hls=_e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(_e){_e&&(logger.log(`setting initial bwe to ${_e}`),this.hls.config.abrEwmaDefaultEstimate=_e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const _e=this.hls.config;return new EwmaBandWidthEstimator(_e.abrEwmaSlowVoD,_e.abrEwmaFastVoD,_e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:_e}=this;_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.FRAG_LOADING,this.onFragLoading,this),_e.on(Events.FRAG_LOADED,this.onFragLoaded,this),_e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),_e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.on(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),_e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:_e}=this;_e&&(_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.FRAG_LOADING,this.onFragLoading,this),_e.off(Events.FRAG_LOADED,this.onFragLoaded,this),_e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),_e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.off(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),_e.off(Events.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(_e,et){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(_e,et){const rt=et.frag;if(!this.ignoreFragment(rt)){if(!rt.bitrateTest){var it;this.fragCurrent=rt,this.partCurrent=(it=et.part)!=null?it:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(_e,et){this.clearTimer()}onError(_e,et){if(!et.fatal)switch(et.details){case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ErrorDetails.FRAG_LOAD_TIMEOUT:{const rt=et.frag,{fragCurrent:it,partCurrent:st}=this;if(rt&&it&&rt.sn===it.sn&&rt.level===it.level){const ot=performance.now(),at=st?st.stats:rt.stats,lt=ot-at.loading.start,ct=at.loading.first?at.loading.first-at.loading.start:-1;if(at.loaded&&ct>-1){const ht=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(lt-Math.min(ht,ct),at.loaded)}else this.bwEstimator.sampleTTFB(lt)}break}}}getTimeToLoadFrag(_e,et,rt,it){const st=_e+rt/et,ot=it?this.lastLevelLoadSec:0;return st+ot}onLevelLoaded(_e,et){const rt=this.hls.config,{loading:it}=et.stats,st=it.end-it.start;isFiniteNumber(st)&&(this.lastLevelLoadSec=st/1e3),et.details.live?this.bwEstimator.update(rt.abrEwmaSlowLive,rt.abrEwmaFastLive):this.bwEstimator.update(rt.abrEwmaSlowVoD,rt.abrEwmaFastVoD)}onFragLoaded(_e,{frag:et,part:rt}){const it=rt?rt.stats:et.stats;if(et.type===PlaylistLevelType.MAIN&&this.bwEstimator.sampleTTFB(it.loading.first-it.loading.start),!this.ignoreFragment(et)){if(this.clearTimer(),et.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const st=rt?rt.duration:et.duration,ot=this.hls.levels[et.level],at=(ot.loaded?ot.loaded.bytes:0)+it.loaded,lt=(ot.loaded?ot.loaded.duration:0)+st;ot.loaded={bytes:at,duration:lt},ot.realBitrate=Math.round(8*at/lt)}if(et.bitrateTest){const st={stats:it,frag:et,part:rt,id:et.type};this.onFragBuffered(Events.FRAG_BUFFERED,st),et.bitrateTest=!1}else this.lastLoadedFragLevel=et.level}}onFragBuffered(_e,et){const{frag:rt,part:it}=et,st=it!=null&&it.stats.loaded?it.stats:rt.stats;if(st.aborted||this.ignoreFragment(rt))return;const ot=st.parsing.end-st.loading.start-Math.min(st.loading.first-st.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(ot,st.loaded),st.bwEstimate=this.getBwEstimate(),rt.bitrateTest?this.bitrateTestDelay=ot/1e3:this.bitrateTestDelay=0}ignoreFragment(_e){return _e.type!==PlaylistLevelType.MAIN||_e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:_e,minAutoLevel:et}=this.hls,rt=this.getBwEstimate(),it=this.hls.config.maxStarvationDelay,st=this.findBestLevel(rt,et,_e,0,it,1,1);if(st>-1)return st;const ot=this.hls.firstLevel,at=Math.min(Math.max(ot,et),_e);return logger.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${ot} clamped to ${at}`),at}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const _e=this.forcedAutoLevel,rt=this.bwEstimator.canEstimate(),it=this.lastLoadedFragLevel>-1;if(_e!==-1&&(!rt||!it||this.nextAutoLevelKey===this.getAutoLevelKey()))return _e;const st=rt&&it?this.getNextABRAutoLevel():this.firstAutoLevel;if(_e!==-1){const ot=this.hls.levels;if(ot.length>Math.max(_e,st)&&ot[_e].loadError<=ot[st].loadError)return _e}return this._nextAutoLevel=st,this.nextAutoLevelKey=this.getAutoLevelKey(),st}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:_e,partCurrent:et,hls:rt}=this,{maxAutoLevel:it,config:st,minAutoLevel:ot}=rt,at=et?et.duration:_e?_e.duration:0,lt=this.getBwEstimate(),ct=this.getStarvationDelay();let ut=st.abrBandWidthFactor,ht=st.abrBandWidthUpFactor;if(ct){const At=this.findBestLevel(lt,ot,it,ct,0,ut,ht);if(At>=0)return At}let dt=at?Math.min(at,st.maxStarvationDelay):st.maxStarvationDelay;if(!ct){const At=this.bitrateTestDelay;At&&(dt=(at?Math.min(at,st.maxLoadingDelay):st.maxLoadingDelay)-At,logger.info(`[abr] bitrate test took ${Math.round(1e3*At)}ms, set first fragment max fetchDuration to ${Math.round(1e3*dt)} ms`),ut=ht=1)}const ft=this.findBestLevel(lt,ot,it,ct,dt,ut,ht);if(logger.info(`[abr] ${ct?"rebuffering expected":"buffer is empty"}, optimal quality level ${ft}`),ft>-1)return ft;const pt=rt.levels[ot],mt=rt.levels[rt.loadLevel];return(pt==null?void 0:pt.bitrate)<(mt==null?void 0:mt.bitrate)?ot:rt.loadLevel}getStarvationDelay(){const _e=this.hls,et=_e.media;if(!et)return 1/0;const rt=et&&et.playbackRate!==0?Math.abs(et.playbackRate):1,it=_e.mainForwardBufferInfo;return(it?it.len:0)/rt}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(_e,et,rt,it,st,ot,at){var lt;const ct=it+st,ut=this.lastLoadedFragLevel,ht=ut===-1?this.hls.firstLevel:ut,{fragCurrent:dt,partCurrent:ft}=this,{levels:pt,allAudioTracks:mt,loadLevel:At,config:gt}=this.hls;if(pt.length===1)return 0;const bt=pt[ht],Tt=!!(bt!=null&&(lt=bt.details)!=null&&lt.live),wt=At===-1||ut===-1;let Rt,It="SDR",Lt=(bt==null?void 0:bt.frameRate)||0;const{audioPreference:$t,videoPreference:kt}=gt,Dt=this.audioTracksByGroup||(this.audioTracksByGroup=getAudioTracksByGroup(mt));if(wt){if(this.firstSelection!==-1)return this.firstSelection;const Xt=this.codecTiers||(this.codecTiers=getCodecTiers(pt,Dt,et,rt)),Zt=getStartCodecTier(Xt,It,_e,$t,kt),{codecSet:rn,videoRanges:Gt,minFramerate:jt,minBitrate:Kt,preferHDR:Jt}=Zt;Rt=rn,It=Jt?Gt[Gt.length-1]:Gt[0],Lt=jt,_e=Math.max(_e,Kt),logger.log(`[abr] picked start tier ${JSON.stringify(Zt)}`)}else Rt=bt==null?void 0:bt.codecSet,It=bt==null?void 0:bt.videoRange;const Ot=ft?ft.duration:dt?dt.duration:0,zt=this.bwEstimator.getEstimateTTFB()/1e3,Ht=[];for(let Xt=rt;Xt>=et;Xt--){var Yt;const Zt=pt[Xt],rn=Xt>ht;if(!Zt)continue;if(gt.useMediaCapabilities&&!Zt.supportedResult&&!Zt.supportedPromise){const an=navigator.mediaCapabilities;typeof(an==null?void 0:an.decodingInfo)=="function"&&requiresMediaCapabilitiesDecodingInfo(Zt,Dt,It,Lt,_e,$t)?(Zt.supportedPromise=getMediaDecodingInfoPromise(Zt,Dt,an),Zt.supportedPromise.then(pn=>{if(!this.hls)return;Zt.supportedResult=pn;const _n=this.hls.levels,yn=_n.indexOf(Zt);pn.error?logger.warn(`[abr] MediaCapabilities decodingInfo error: "${pn.error}" for level ${yn} ${JSON.stringify(pn)}`):pn.supported||(logger.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${yn} ${JSON.stringify(pn)}`),yn>-1&&_n.length>1&&(logger.log(`[abr] Removing unsupported level ${yn}`),this.hls.removeLevel(yn)))})):Zt.supportedResult=SUPPORTED_INFO_DEFAULT}if(Rt&&Zt.codecSet!==Rt||It&&Zt.videoRange!==It||rn&&Lt>Zt.frameRate||!rn&&Lt>0&&Lt<Zt.frameRate||Zt.supportedResult&&!((Yt=Zt.supportedResult.decodingInfoResults)!=null&&Yt[0].smooth)){Ht.push(Xt);continue}const Gt=Zt.details,jt=(ft?Gt==null?void 0:Gt.partTarget:Gt==null?void 0:Gt.averagetargetduration)||Ot;let Kt;rn?Kt=at*_e:Kt=ot*_e;const Jt=Ot&&it>=Ot*2&&st===0?pt[Xt].averageBitrate:pt[Xt].maxBitrate,sn=this.getTimeToLoadFrag(zt,Kt,Jt*jt,Gt===void 0);if(Kt>=Jt&&(Xt===ut||Zt.loadError===0&&Zt.fragmentError===0)&&(sn<=zt||!isFiniteNumber(sn)||Tt&&!this.bitrateTestDelay||sn<ct)){const an=this.forcedAutoLevel;return Xt!==At&&(an===-1||an!==At)&&(Ht.length&&logger.trace(`[abr] Skipped level(s) ${Ht.join(",")} of ${rt} max with CODECS and VIDEO-RANGE:"${pt[Ht[0]].codecs}" ${pt[Ht[0]].videoRange}; not compatible with "${bt.codecs}" ${It}`),logger.info(`[abr] switch candidate:${ht}->${Xt} adjustedbw(${Math.round(Kt)})-bitrate=${Math.round(Kt-Jt)} ttfb:${zt.toFixed(1)} avgDuration:${jt.toFixed(1)} maxFetchDuration:${ct.toFixed(1)} fetchDuration:${sn.toFixed(1)} firstSelection:${wt} codecSet:${Rt} videoRange:${It} hls.loadLevel:${At}`)),wt&&(this.firstSelection=Xt),Xt}}return-1}set nextAutoLevel(_e){const{maxAutoLevel:et,minAutoLevel:rt}=this.hls,it=Math.min(Math.max(_e,rt),et);this._nextAutoLevel!==it&&(this.nextAutoLevelKey="",this._nextAutoLevel=it)}}class TaskLoop{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(_e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,_e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FragmentTracker{constructor(_e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=_e,this._registerListeners()}_registerListeners(){const{hls:_e}=this;_e.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),_e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),_e.on(Events.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:_e}=this;_e.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),_e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),_e.off(Events.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(_e,et){const rt=this.activePartLists[et];if(rt)for(let it=rt.length;it--;){const st=rt[it];if(!st)break;const ot=st.end;if(st.start<=_e&&ot!==null&&_e<=ot)return st}return this.getBufferedFrag(_e,et)}getBufferedFrag(_e,et){const{fragments:rt}=this,it=Object.keys(rt);for(let st=it.length;st--;){const ot=rt[it[st]];if((ot==null?void 0:ot.body.type)===et&&ot.buffered){const at=ot.body;if(at.start<=_e&&_e<=at.end)return at}}return null}detectEvictedFragments(_e,et,rt,it){this.timeRanges&&(this.timeRanges[_e]=et);const st=(it==null?void 0:it.fragment.sn)||-1;Object.keys(this.fragments).forEach(ot=>{const at=this.fragments[ot];if(!at||st>=at.body.sn)return;if(!at.buffered&&!at.loaded){at.body.type===rt&&this.removeFragment(at.body);return}const lt=at.range[_e];lt&&lt.time.some(ct=>{const ut=!this.isTimeBuffered(ct.startPTS,ct.endPTS,et);return ut&&this.removeFragment(at.body),ut})})}detectPartialFragments(_e){const et=this.timeRanges,{frag:rt,part:it}=_e;if(!et||rt.sn==="initSegment")return;const st=getFragmentKey(rt),ot=this.fragments[st];if(!ot||ot.buffered&&rt.gap)return;const at=!rt.relurl;Object.keys(et).forEach(lt=>{const ct=rt.elementaryStreams[lt];if(!ct)return;const ut=et[lt],ht=at||ct.partial===!0;ot.range[lt]=this.getBufferedTimes(rt,it,ht,ut)}),ot.loaded=null,Object.keys(ot.range).length?(ot.buffered=!0,(ot.body.endList=rt.endList||ot.body.endList)&&(this.endListFragments[ot.body.type]=ot),isPartial(ot)||this.removeParts(rt.sn-1,rt.type)):this.removeFragment(ot.body)}removeParts(_e,et){const rt=this.activePartLists[et];rt&&(this.activePartLists[et]=rt.filter(it=>it.fragment.sn>=_e))}fragBuffered(_e,et){const rt=getFragmentKey(_e);let it=this.fragments[rt];!it&&et&&(it=this.fragments[rt]={body:_e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},_e.gap&&(this.hasGaps=!0)),it&&(it.loaded=null,it.buffered=!0)}getBufferedTimes(_e,et,rt,it){const st={time:[],partial:rt},ot=_e.start,at=_e.end,lt=_e.minEndPTS||at,ct=_e.maxStartPTS||ot;for(let ut=0;ut<it.length;ut++){const ht=it.start(ut)-this.bufferPadding,dt=it.end(ut)+this.bufferPadding;if(ct>=ht&&lt<=dt){st.time.push({startPTS:Math.max(ot,it.start(ut)),endPTS:Math.min(at,it.end(ut))});break}else if(ot<dt&&at>ht){const ft=Math.max(ot,it.start(ut)),pt=Math.min(at,it.end(ut));pt>ft&&(st.partial=!0,st.time.push({startPTS:ft,endPTS:pt}))}else if(at<=ht)break}return st}getPartialFragment(_e){let et=null,rt,it,st,ot=0;const{bufferPadding:at,fragments:lt}=this;return Object.keys(lt).forEach(ct=>{const ut=lt[ct];ut&&isPartial(ut)&&(it=ut.body.start-at,st=ut.body.end+at,_e>=it&&_e<=st&&(rt=Math.min(_e-it,st-_e),ot<=rt&&(et=ut.body,ot=rt)))}),et}isEndListAppended(_e){const et=this.endListFragments[_e];return et!==void 0&&(et.buffered||isPartial(et))}getState(_e){const et=getFragmentKey(_e),rt=this.fragments[et];return rt?rt.buffered?isPartial(rt)?FragmentState.PARTIAL:FragmentState.OK:FragmentState.APPENDING:FragmentState.NOT_LOADED}isTimeBuffered(_e,et,rt){let it,st;for(let ot=0;ot<rt.length;ot++){if(it=rt.start(ot)-this.bufferPadding,st=rt.end(ot)+this.bufferPadding,_e>=it&&et<=st)return!0;if(et<=it)return!1}return!1}onFragLoaded(_e,et){const{frag:rt,part:it}=et;if(rt.sn==="initSegment"||rt.bitrateTest)return;const st=it?null:et,ot=getFragmentKey(rt);this.fragments[ot]={body:rt,appendedPTS:null,loaded:st,buffered:!1,range:Object.create(null)}}onBufferAppended(_e,et){const{frag:rt,part:it,timeRanges:st}=et;if(rt.sn==="initSegment")return;const ot=rt.type;if(it){let at=this.activePartLists[ot];at||(this.activePartLists[ot]=at=[]),at.push(it)}this.timeRanges=st,Object.keys(st).forEach(at=>{const lt=st[at];this.detectEvictedFragments(at,lt,ot,it)})}onFragBuffered(_e,et){this.detectPartialFragments(et)}hasFragment(_e){const et=getFragmentKey(_e);return!!this.fragments[et]}hasParts(_e){var et;return!!((et=this.activePartLists[_e])!=null&&et.length)}removeFragmentsInRange(_e,et,rt,it,st){it&&!this.hasGaps||Object.keys(this.fragments).forEach(ot=>{const at=this.fragments[ot];if(!at)return;const lt=at.body;lt.type!==rt||it&&!lt.gap||lt.start<et&&lt.end>_e&&(at.buffered||st)&&this.removeFragment(lt)})}removeFragment(_e){const et=getFragmentKey(_e);_e.stats.loaded=0,_e.clearElementaryStreamInfo();const rt=this.activePartLists[_e.type];if(rt){const it=_e.sn;this.activePartLists[_e.type]=rt.filter(st=>st.fragment.sn!==it)}delete this.fragments[et],_e.endList&&delete this.endListFragments[_e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function isPartial(nt){var _e,et,rt;return nt.buffered&&(nt.body.gap||((_e=nt.range.video)==null?void 0:_e.partial)||((et=nt.range.audio)==null?void 0:et.partial)||((rt=nt.range.audiovideo)==null?void 0:rt.partial))}function getFragmentKey(nt){return`${nt.type}_${nt.level}_${nt.sn}`}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(_e,et){try{if(_e){const rt=BufferHelper.getBuffered(_e);for(let it=0;it<rt.length;it++)if(et>=rt.start(it)&&et<=rt.end(it))return!0}}catch{}return!1}static bufferInfo(_e,et,rt){try{if(_e){const it=BufferHelper.getBuffered(_e),st=[];let ot;for(ot=0;ot<it.length;ot++)st.push({start:it.start(ot),end:it.end(ot)});return this.bufferedInfo(st,et,rt)}}catch{}return{len:0,start:et,end:et,nextStart:void 0}}static bufferedInfo(_e,et,rt){et=Math.max(0,et),_e.sort(function(ct,ut){const ht=ct.start-ut.start;return ht||ut.end-ct.end});let it=[];if(rt)for(let ct=0;ct<_e.length;ct++){const ut=it.length;if(ut){const ht=it[ut-1].end;_e[ct].start-ht<rt?_e[ct].end>ht&&(it[ut-1].end=_e[ct].end):it.push(_e[ct])}else it.push(_e[ct])}else it=_e;let st=0,ot,at=et,lt=et;for(let ct=0;ct<it.length;ct++){const ut=it[ct].start,ht=it[ct].end;if(et+rt>=ut&&et<ht)at=ut,lt=ht,st=lt-et;else if(et+rt<ut){ot=ut;break}}return{len:st,start:at||0,end:lt||0,nextStart:ot}}static getBuffered(_e){try{return _e.buffered}catch(et){return logger.log("failed to get media.buffered",et),noopBuffered}}}class ChunkMetadata{constructor(_e,et,rt,it=0,st=-1,ot=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=getNewPerformanceTiming(),this.buffering={audio:getNewPerformanceTiming(),video:getNewPerformanceTiming(),audiovideo:getNewPerformanceTiming()},this.level=_e,this.sn=et,this.id=rt,this.size=it,this.part=st,this.partial=ot}}function getNewPerformanceTiming(){return{start:0,executeStart:0,executeEnd:0,end:0}}function findFirstFragWithCC(nt,_e){for(let rt=0,it=nt.length;rt<it;rt++){var et;if(((et=nt[rt])==null?void 0:et.cc)===_e)return nt[rt]}return null}function shouldAlignOnDiscontinuities(nt,_e,et){return!!(_e&&(et.endCC>et.startCC||nt&&nt.cc<et.startCC))}function findDiscontinuousReferenceFrag(nt,_e){const et=nt.fragments,rt=_e.fragments;if(!rt.length||!et.length){logger.log("No fragments to align");return}const it=findFirstFragWithCC(et,rt[0].cc);if(!it||it&&!it.startPTS){logger.log("No frag in previous level to align on");return}return it}function adjustFragmentStart(nt,_e){if(nt){const et=nt.start+_e;nt.start=nt.startPTS=et,nt.endPTS=et+nt.duration}}function adjustSlidingStart(nt,_e){const et=_e.fragments;for(let rt=0,it=et.length;rt<it;rt++)adjustFragmentStart(et[rt],nt);_e.fragmentHint&&adjustFragmentStart(_e.fragmentHint,nt),_e.alignedSliding=!0}function alignStream(nt,_e,et){_e&&(alignDiscontinuities(nt,et,_e),!et.alignedSliding&&_e&&alignMediaPlaylistByPDT(et,_e),!et.alignedSliding&&_e&&!et.skippedSegments&&adjustSliding(_e,et))}function alignDiscontinuities(nt,_e,et){if(shouldAlignOnDiscontinuities(nt,et,_e)){const rt=findDiscontinuousReferenceFrag(et,_e);rt&&isFiniteNumber(rt.start)&&(logger.log(`Adjusting PTS using last level due to CC increase within current level ${_e.url}`),adjustSlidingStart(rt.start,_e))}}function alignMediaPlaylistByPDT(nt,_e){if(!nt.hasProgramDateTime||!_e.hasProgramDateTime)return;const et=nt.fragments,rt=_e.fragments;if(!et.length||!rt.length)return;let it,st;const ot=Math.min(_e.endCC,nt.endCC);_e.startCC<ot&&nt.startCC<ot&&(it=findFirstFragWithCC(rt,ot),st=findFirstFragWithCC(et,ot)),(!it||!st)&&(it=rt[Math.floor(rt.length/2)],st=findFirstFragWithCC(et,it.cc)||et[Math.floor(et.length/2)]);const at=it.programDateTime,lt=st.programDateTime;if(!at||!lt)return;const ct=(lt-at)/1e3-(st.start-it.start);adjustSlidingStart(ct,nt)}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(_e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=_e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(_e,et){const rt=_e.url;if(!rt)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:_e,error:new Error(`Fragment does not have a ${rt?"part list":"url"}`),networkDetails:null}));this.abort();const it=this.config,st=it.fLoader,ot=it.loader;return new Promise((at,lt)=>{if(this.loader&&this.loader.destroy(),_e.gap)if(_e.tagList.some(ft=>ft[0]==="GAP")){lt(createGapLoadError(_e));return}else _e.gap=!1;const ct=this.loader=_e.loader=st?new st(it):new ot(it),ut=createLoaderContext(_e),ht=getLoaderConfigWithoutReties(it.fragLoadPolicy.default),dt={loadPolicy:ht,timeout:ht.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:_e.sn==="initSegment"?1/0:MIN_CHUNK_SIZE};_e.stats=ct.stats,ct.load(ut,dt,{onSuccess:(ft,pt,mt,At)=>{this.resetLoader(_e,ct);let gt=ft.data;mt.resetIV&&_e.decryptdata&&(_e.decryptdata.iv=new Uint8Array(gt.slice(0,16)),gt=gt.slice(16)),at({frag:_e,part:null,payload:gt,networkDetails:At})},onError:(ft,pt,mt,At)=>{this.resetLoader(_e,ct),lt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:_e,response:_objectSpread2$3({url:rt,data:void 0},ft),error:new Error(`HTTP Error ${ft.code} ${ft.text}`),networkDetails:mt,stats:At}))},onAbort:(ft,pt,mt)=>{this.resetLoader(_e,ct),lt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:_e,error:new Error("Aborted"),networkDetails:mt,stats:ft}))},onTimeout:(ft,pt,mt)=>{this.resetLoader(_e,ct),lt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:_e,error:new Error(`Timeout after ${dt.timeout}ms`),networkDetails:mt,stats:ft}))},onProgress:(ft,pt,mt,At)=>{et&&et({frag:_e,part:null,payload:mt,networkDetails:At})}})})}loadPart(_e,et,rt){this.abort();const it=this.config,st=it.fLoader,ot=it.loader;return new Promise((at,lt)=>{if(this.loader&&this.loader.destroy(),_e.gap||et.gap){lt(createGapLoadError(_e,et));return}const ct=this.loader=_e.loader=st?new st(it):new ot(it),ut=createLoaderContext(_e,et),ht=getLoaderConfigWithoutReties(it.fragLoadPolicy.default),dt={loadPolicy:ht,timeout:ht.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};et.stats=ct.stats,ct.load(ut,dt,{onSuccess:(ft,pt,mt,At)=>{this.resetLoader(_e,ct),this.updateStatsFromPart(_e,et);const gt={frag:_e,part:et,payload:ft.data,networkDetails:At};rt(gt),at(gt)},onError:(ft,pt,mt,At)=>{this.resetLoader(_e,ct),lt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:_e,part:et,response:_objectSpread2$3({url:ut.url,data:void 0},ft),error:new Error(`HTTP Error ${ft.code} ${ft.text}`),networkDetails:mt,stats:At}))},onAbort:(ft,pt,mt)=>{_e.stats.aborted=et.stats.aborted,this.resetLoader(_e,ct),lt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:_e,part:et,error:new Error("Aborted"),networkDetails:mt,stats:ft}))},onTimeout:(ft,pt,mt)=>{this.resetLoader(_e,ct),lt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:_e,part:et,error:new Error(`Timeout after ${dt.timeout}ms`),networkDetails:mt,stats:ft}))}})})}updateStatsFromPart(_e,et){const rt=_e.stats,it=et.stats,st=it.total;if(rt.loaded+=it.loaded,st){const lt=Math.round(_e.duration/et.duration),ct=Math.min(Math.round(rt.loaded/st),lt),ht=(lt-ct)*Math.round(rt.loaded/ct);rt.total=rt.loaded+ht}else rt.total=Math.max(rt.loaded,rt.total);const ot=rt.loading,at=it.loading;ot.start?ot.first+=at.first-at.start:(ot.start=at.start,ot.first=at.first),ot.end=at.end}resetLoader(_e,et){_e.loader=null,this.loader===et&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),et.destroy()}}function createLoaderContext(nt,_e=null){const et=_e||nt,rt={frag:nt,part:_e,responseType:"arraybuffer",url:et.url,headers:{},rangeStart:0,rangeEnd:0},it=et.byteRangeStartOffset,st=et.byteRangeEndOffset;if(isFiniteNumber(it)&&isFiniteNumber(st)){var ot;let at=it,lt=st;if(nt.sn==="initSegment"&&((ot=nt.decryptdata)==null?void 0:ot.method)==="AES-128"){const ct=st-it;ct%16&&(lt=st+(16-ct%16)),it!==0&&(rt.resetIV=!0,at=it-16)}rt.rangeStart=at,rt.rangeEnd=lt}return rt}function createGapLoadError(nt,_e){const et=new Error(`GAP ${nt.gap?"tag":"attribute"} found`),rt={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag:nt,error:et,networkDetails:null};return _e&&(rt.part=_e),(_e||nt).stats.aborted=!0,new LoadError(rt)}class LoadError extends Error{constructor(_e){super(_e.error.message),this.data=void 0,this.data=_e}}class AESCrypto{constructor(_e,et){this.subtle=void 0,this.aesIV=void 0,this.subtle=_e,this.aesIV=et}decrypt(_e,et){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},et,_e)}}class FastAESKey{constructor(_e,et){this.subtle=void 0,this.key=void 0,this.subtle=_e,this.key=et}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function removePadding(nt){const _e=nt.byteLength,et=_e&&new DataView(nt.buffer).getUint8(_e-1);return et?sliceUint8(nt,0,_e-et):nt}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(_e){const et=new DataView(_e),rt=new Uint32Array(4);for(let it=0;it<4;it++)rt[it]=et.getUint32(it*4);return rt}initTable(){const _e=this.sBox,et=this.invSBox,rt=this.subMix,it=rt[0],st=rt[1],ot=rt[2],at=rt[3],lt=this.invSubMix,ct=lt[0],ut=lt[1],ht=lt[2],dt=lt[3],ft=new Uint32Array(256);let pt=0,mt=0,At=0;for(At=0;At<256;At++)At<128?ft[At]=At<<1:ft[At]=At<<1^283;for(At=0;At<256;At++){let gt=mt^mt<<1^mt<<2^mt<<3^mt<<4;gt=gt>>>8^gt&255^99,_e[pt]=gt,et[gt]=pt;const bt=ft[pt],Tt=ft[bt],wt=ft[Tt];let Rt=ft[gt]*257^gt*16843008;it[pt]=Rt<<24|Rt>>>8,st[pt]=Rt<<16|Rt>>>16,ot[pt]=Rt<<8|Rt>>>24,at[pt]=Rt,Rt=wt*16843009^Tt*65537^bt*257^pt*16843008,ct[gt]=Rt<<24|Rt>>>8,ut[gt]=Rt<<16|Rt>>>16,ht[gt]=Rt<<8|Rt>>>24,dt[gt]=Rt,pt?(pt=bt^ft[ft[ft[wt^bt]]],mt^=ft[ft[mt]]):pt=mt=1}}expandKey(_e){const et=this.uint8ArrayToUint32Array_(_e);let rt=!0,it=0;for(;it<et.length&&rt;)rt=et[it]===this.key[it],it++;if(rt)return;this.key=et;const st=this.keySize=et.length;if(st!==4&&st!==6&&st!==8)throw new Error("Invalid aes key size="+st);const ot=this.ksRows=(st+6+1)*4;let at,lt;const ct=this.keySchedule=new Uint32Array(ot),ut=this.invKeySchedule=new Uint32Array(ot),ht=this.sBox,dt=this.rcon,ft=this.invSubMix,pt=ft[0],mt=ft[1],At=ft[2],gt=ft[3];let bt,Tt;for(at=0;at<ot;at++){if(at<st){bt=ct[at]=et[at];continue}Tt=bt,at%st===0?(Tt=Tt<<8|Tt>>>24,Tt=ht[Tt>>>24]<<24|ht[Tt>>>16&255]<<16|ht[Tt>>>8&255]<<8|ht[Tt&255],Tt^=dt[at/st|0]<<24):st>6&&at%st===4&&(Tt=ht[Tt>>>24]<<24|ht[Tt>>>16&255]<<16|ht[Tt>>>8&255]<<8|ht[Tt&255]),ct[at]=bt=(ct[at-st]^Tt)>>>0}for(lt=0;lt<ot;lt++)at=ot-lt,lt&3?Tt=ct[at]:Tt=ct[at-4],lt<4||at<=4?ut[lt]=Tt:ut[lt]=pt[ht[Tt>>>24]]^mt[ht[Tt>>>16&255]]^At[ht[Tt>>>8&255]]^gt[ht[Tt&255]],ut[lt]=ut[lt]>>>0}networkToHostOrderSwap(_e){return _e<<24|(_e&65280)<<8|(_e&16711680)>>8|_e>>>24}decrypt(_e,et,rt){const it=this.keySize+6,st=this.invKeySchedule,ot=this.invSBox,at=this.invSubMix,lt=at[0],ct=at[1],ut=at[2],ht=at[3],dt=this.uint8ArrayToUint32Array_(rt);let ft=dt[0],pt=dt[1],mt=dt[2],At=dt[3];const gt=new Int32Array(_e),bt=new Int32Array(gt.length);let Tt,wt,Rt,It,Lt,$t,kt,Dt,Ot,zt,Ht,Yt,Xt,Zt;const rn=this.networkToHostOrderSwap;for(;et<gt.length;){for(Ot=rn(gt[et]),zt=rn(gt[et+1]),Ht=rn(gt[et+2]),Yt=rn(gt[et+3]),Lt=Ot^st[0],$t=Yt^st[1],kt=Ht^st[2],Dt=zt^st[3],Xt=4,Zt=1;Zt<it;Zt++)Tt=lt[Lt>>>24]^ct[$t>>16&255]^ut[kt>>8&255]^ht[Dt&255]^st[Xt],wt=lt[$t>>>24]^ct[kt>>16&255]^ut[Dt>>8&255]^ht[Lt&255]^st[Xt+1],Rt=lt[kt>>>24]^ct[Dt>>16&255]^ut[Lt>>8&255]^ht[$t&255]^st[Xt+2],It=lt[Dt>>>24]^ct[Lt>>16&255]^ut[$t>>8&255]^ht[kt&255]^st[Xt+3],Lt=Tt,$t=wt,kt=Rt,Dt=It,Xt=Xt+4;Tt=ot[Lt>>>24]<<24^ot[$t>>16&255]<<16^ot[kt>>8&255]<<8^ot[Dt&255]^st[Xt],wt=ot[$t>>>24]<<24^ot[kt>>16&255]<<16^ot[Dt>>8&255]<<8^ot[Lt&255]^st[Xt+1],Rt=ot[kt>>>24]<<24^ot[Dt>>16&255]<<16^ot[Lt>>8&255]<<8^ot[$t&255]^st[Xt+2],It=ot[Dt>>>24]<<24^ot[Lt>>16&255]<<16^ot[$t>>8&255]<<8^ot[kt&255]^st[Xt+3],bt[et]=rn(Tt^ft),bt[et+1]=rn(It^pt),bt[et+2]=rn(Rt^mt),bt[et+3]=rn(wt^At),ft=Ot,pt=zt,mt=Ht,At=Yt,et=et+4}return bt.buffer}}const CHUNK_SIZE=16;class Decrypter{constructor(_e,{removePKCS7Padding:et=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=_e.enableSoftwareAES,this.removePKCS7Padding=et,et)try{const rt=self.crypto;rt&&(this.subtle=rt.subtle||rt.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:_e,remainderData:et}=this;if(!_e||et)return this.reset(),null;const rt=new Uint8Array(_e);return this.reset(),this.removePKCS7Padding?removePadding(rt):rt}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(_e,et,rt){return this.useSoftware?new Promise((it,st)=>{this.softwareDecrypt(new Uint8Array(_e),et,rt);const ot=this.flush();ot?it(ot.buffer):st(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(_e),et,rt)}softwareDecrypt(_e,et,rt){const{currentIV:it,currentResult:st,remainderData:ot}=this;this.logOnce("JS AES decrypt"),ot&&(_e=appendUint8Array(ot,_e),this.remainderData=null);const at=this.getValidChunk(_e);if(!at.length)return null;it&&(rt=it);let lt=this.softwareDecrypter;lt||(lt=this.softwareDecrypter=new AESDecryptor),lt.expandKey(et);const ct=st;return this.currentResult=lt.decrypt(at.buffer,0,rt),this.currentIV=sliceUint8(at,-16).buffer,ct||null}webCryptoDecrypt(_e,et,rt){if(this.key!==et||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(_e,et,rt));this.key=et,this.fastAesKey=new FastAESKey(this.subtle,et)}return this.fastAesKey.expandKey().then(it=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new AESCrypto(this.subtle,new Uint8Array(rt)).decrypt(_e.buffer,it)):Promise.reject(new Error("web crypto not initialized"))).catch(it=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${it.name}: ${it.message}`),this.onWebCryptoError(_e,et,rt)))}onWebCryptoError(_e,et,rt){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(_e,et,rt);const it=this.flush();if(it)return it.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(_e){let et=_e;const rt=_e.length-_e.length%CHUNK_SIZE;return rt!==_e.length&&(et=sliceUint8(_e,0,rt),this.remainderData=sliceUint8(_e,rt)),et}logOnce(_e){this.logEnabled&&(logger.log(`[decrypter]: ${_e}`),this.logEnabled=!1)}}const TimeRanges={toString:function(nt){let _e="";const et=nt.length;for(let rt=0;rt<et;rt++)_e+=`[${nt.start(rt).toFixed(3)}-${nt.end(rt).toFixed(3)}]`;return _e}},State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BaseStreamController extends TaskLoop{constructor(_e,et,rt,it,st){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=st,this.logPrefix=it,this.log=logger.log.bind(logger,`${it}:`),this.warn=logger.warn.bind(logger,`${it}:`),this.hls=_e,this.fragmentLoader=new FragmentLoader(_e.config),this.keyLoader=rt,this.fragmentTracker=et,this.config=_e.config,this.decrypter=new Decrypter(_e.config),_e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(_e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const _e=this.fragCurrent;_e!=null&&_e.loader&&(_e.abortRequests(),this.fragmentTracker.removeFragment(_e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED}_streamEnded(_e,et){if(et.live||_e.nextStart||!_e.end||!this.media)return!1;const rt=et.partList;if(rt!=null&&rt.length){const st=rt[rt.length-1];return BufferHelper.isBuffered(this.media,st.start+st.duration/2)}const it=et.fragments[et.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(it)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var _e;return(_e=this.levelLastLoaded)==null?void 0:_e.details}}onMediaAttached(_e,et){const rt=this.media=this.mediaBuffer=et.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),rt.addEventListener("seeking",this.onvseeking),rt.addEventListener("ended",this.onvended);const it=this.config;this.levels&&it.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(it.startPosition)}onMediaDetaching(){const _e=this.media;_e!=null&&_e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),_e&&this.onvseeking&&this.onvended&&(_e.removeEventListener("seeking",this.onvseeking),_e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:_e,fragCurrent:et,media:rt,mediaBuffer:it,state:st}=this,ot=rt?rt.currentTime:0,at=BufferHelper.bufferInfo(it||rt,ot,_e.maxBufferHole);if(this.log(`media seeking to ${isFiniteNumber(ot)?ot.toFixed(3):ot}, state: ${st}`),this.state===State.ENDED)this.resetLoadingState();else if(et){const lt=_e.maxFragLookUpTolerance,ct=et.start-lt,ut=et.start+et.duration+lt;if(!at.len||ut<at.start||ct>at.end){const ht=ot>ut;(ot<ct||ht)&&(ht&&et.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),et.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}rt&&(this.fragmentTracker.removeFragmentsInRange(ot,1/0,this.playlistType,!0),this.lastCurrentTime=ot),!this.loadedmetadata&&!at.len&&(this.nextLoadPosition=this.startPosition=ot),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(_e,et){this.startTimeOffset=et.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=State.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(_e,et,rt){this._loadFragForPlayback(_e,et,rt)}_loadFragForPlayback(_e,et,rt){const it=st=>{if(this.fragContextChanged(_e)){this.warn(`Fragment ${_e.sn}${st.part?" p: "+st.part.index:""} of level ${_e.level} was dropped during download.`),this.fragmentTracker.removeFragment(_e);return}_e.stats.chunkCount++,this._handleFragmentLoadProgress(st)};this._doFragLoad(_e,et,rt,it).then(st=>{if(!st)return;const ot=this.state;if(this.fragContextChanged(_e)){(ot===State.FRAG_LOADING||!this.fragCurrent&&ot===State.PARSING)&&(this.fragmentTracker.removeFragment(_e),this.state=State.IDLE);return}"payload"in st&&(this.log(`Loaded fragment ${_e.sn} of level ${_e.level}`),this.hls.trigger(Events.FRAG_LOADED,st)),this._handleFragmentLoadComplete(st)}).catch(st=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(`Frag error: ${(st==null?void 0:st.message)||st}`),this.resetFragmentLoading(_e))})}clearTrackerIfNeeded(_e){var et;const{fragmentTracker:rt}=this;if(rt.getState(_e)===FragmentState.APPENDING){const st=_e.type,ot=this.getFwdBufferInfo(this.mediaBuffer,st),at=Math.max(_e.duration,ot?ot.len:this.config.maxBufferLength),lt=this.backtrackFragment;((lt?_e.sn-lt.sn:0)===1||this.reduceMaxBufferLength(at,_e.duration))&&rt.removeFragment(_e)}else((et=this.mediaBuffer)==null?void 0:et.buffered.length)===0?rt.removeAllFragments():rt.hasParts(_e.type)&&(rt.detectPartialFragments({frag:_e,part:null,stats:_e.stats,id:_e.type}),rt.getState(_e)===FragmentState.PARTIAL&&rt.removeFragment(_e))}checkLiveUpdate(_e){if(_e.updated&&!_e.live){const et=_e.fragments[_e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:et,part:null,stats:et.stats,id:et.type})}_e.fragments[0]||(_e.deltaUpdateFailed=!0)}flushMainBuffer(_e,et,rt=null){if(!(_e-et))return;const it={startOffset:_e,endOffset:et,type:rt};this.hls.trigger(Events.BUFFER_FLUSHING,it)}_loadInitSegment(_e,et){this._doFragLoad(_e,et).then(rt=>{if(!rt||this.fragContextChanged(_e)||!this.levels)throw new Error("init load aborted");return rt}).then(rt=>{const{hls:it}=this,{payload:st}=rt,ot=_e.decryptdata;if(st&&st.byteLength>0&&ot!=null&&ot.key&&ot.iv&&ot.method==="AES-128"){const at=self.performance.now();return this.decrypter.decrypt(new Uint8Array(st),ot.key.buffer,ot.iv.buffer).catch(lt=>{throw it.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:lt,reason:lt.message,frag:_e}),lt}).then(lt=>{const ct=self.performance.now();return it.trigger(Events.FRAG_DECRYPTED,{frag:_e,payload:lt,stats:{tstart:at,tdecrypt:ct}}),rt.payload=lt,this.completeInitSegmentLoad(rt)})}return this.completeInitSegmentLoad(rt)}).catch(rt=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(rt),this.resetFragmentLoading(_e))})}completeInitSegmentLoad(_e){const{levels:et}=this;if(!et)throw new Error("init load aborted, missing levels");const rt=_e.frag.stats;this.state=State.IDLE,_e.frag.data=new Uint8Array(_e.payload),rt.parsing.start=rt.buffering.start=self.performance.now(),rt.parsing.end=rt.buffering.end=self.performance.now(),this.tick()}fragContextChanged(_e){const{fragCurrent:et}=this;return!_e||!et||_e.sn!==et.sn||_e.level!==et.level}fragBufferedComplete(_e,et){var rt,it,st,ot;const at=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${_e.type} sn: ${_e.sn}${et?" part: "+et.index:""} of ${this.playlistType===PlaylistLevelType.MAIN?"level":"track"} ${_e.level} (frag:[${((rt=_e.startPTS)!=null?rt:NaN).toFixed(3)}-${((it=_e.endPTS)!=null?it:NaN).toFixed(3)}] > buffer:${at?TimeRanges.toString(BufferHelper.getBuffered(at)):"(detached)"})`),_e.sn!=="initSegment"){var lt;if(_e.type!==PlaylistLevelType.SUBTITLE){const ut=_e.elementaryStreams;if(!Object.keys(ut).some(ht=>!!ut[ht])){this.state=State.IDLE;return}}const ct=(lt=this.levels)==null?void 0:lt[_e.level];ct!=null&&ct.fragmentError&&(this.log(`Resetting level fragment error count of ${ct.fragmentError} on frag buffered`),ct.fragmentError=0)}this.state=State.IDLE,at&&(!this.loadedmetadata&&_e.type==PlaylistLevelType.MAIN&&at.buffered.length&&((st=this.fragCurrent)==null?void 0:st.sn)===((ot=this.fragPrevious)==null?void 0:ot.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(_e){const{transmuxer:et}=this;if(!et)return;const{frag:rt,part:it,partsLoaded:st}=_e,ot=!st||st.length===0||st.some(lt=>!lt),at=new ChunkMetadata(rt.level,rt.sn,rt.stats.chunkCount+1,0,it?it.index:-1,!ot);et.flush(at)}_handleFragmentLoadProgress(_e){}_doFragLoad(_e,et,rt=null,it){var st;const ot=et==null?void 0:et.details;if(!this.levels||!ot)throw new Error(`frag load aborted, missing level${ot?"":" detail"}s`);let at=null;if(_e.encrypted&&!((st=_e.decryptdata)!=null&&st.key)?(this.log(`Loading key for ${_e.sn} of [${ot.startSN}-${ot.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${_e.level}`),this.state=State.KEY_LOADING,this.fragCurrent=_e,at=this.keyLoader.load(_e).then(ut=>{if(!this.fragContextChanged(ut.frag))return this.hls.trigger(Events.KEY_LOADED,ut),this.state===State.KEY_LOADING&&(this.state=State.IDLE),ut}),this.hls.trigger(Events.KEY_LOADING,{frag:_e}),this.fragCurrent===null&&(at=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!_e.encrypted&&ot.encryptedFragments.length&&this.keyLoader.loadClear(_e,ot.encryptedFragments),rt=Math.max(_e.start,rt||0),this.config.lowLatencyMode&&_e.sn!=="initSegment"){const ut=ot.partList;if(ut&&it){rt>_e.end&&ot.fragmentHint&&(_e=ot.fragmentHint);const ht=this.getNextPart(ut,_e,rt);if(ht>-1){const dt=ut[ht];this.log(`Loading part sn: ${_e.sn} p: ${dt.index} cc: ${_e.cc} of playlist [${ot.startSN}-${ot.endSN}] parts [0-${ht}-${ut.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${_e.level}, target: ${parseFloat(rt.toFixed(3))}`),this.nextLoadPosition=dt.start+dt.duration,this.state=State.FRAG_LOADING;let ft;return at?ft=at.then(pt=>!pt||this.fragContextChanged(pt.frag)?null:this.doFragPartsLoad(_e,dt,et,it)).catch(pt=>this.handleFragLoadError(pt)):ft=this.doFragPartsLoad(_e,dt,et,it).catch(pt=>this.handleFragLoadError(pt)),this.hls.trigger(Events.FRAG_LOADING,{frag:_e,part:dt,targetBufferTime:rt}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):ft}else if(!_e.url||this.loadedEndOfParts(ut,rt))return Promise.resolve(null)}}this.log(`Loading fragment ${_e.sn} cc: ${_e.cc} ${ot?"of ["+ot.startSN+"-"+ot.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${_e.level}, target: ${parseFloat(rt.toFixed(3))}`),isFiniteNumber(_e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=_e.start+_e.duration),this.state=State.FRAG_LOADING;const lt=this.config.progressive;let ct;return lt&&at?ct=at.then(ut=>!ut||this.fragContextChanged(ut==null?void 0:ut.frag)?null:this.fragmentLoader.load(_e,it)).catch(ut=>this.handleFragLoadError(ut)):ct=Promise.all([this.fragmentLoader.load(_e,lt?it:void 0),at]).then(([ut])=>(!lt&&ut&&it&&it(ut),ut)).catch(ut=>this.handleFragLoadError(ut)),this.hls.trigger(Events.FRAG_LOADING,{frag:_e,targetBufferTime:rt}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):ct}doFragPartsLoad(_e,et,rt,it){return new Promise((st,ot)=>{var at;const lt=[],ct=(at=rt.details)==null?void 0:at.partList,ut=ht=>{this.fragmentLoader.loadPart(_e,ht,it).then(dt=>{lt[ht.index]=dt;const ft=dt.part;this.hls.trigger(Events.FRAG_LOADED,dt);const pt=getPartWith(rt,_e.sn,ht.index+1)||findPart(ct,_e.sn,ht.index+1);if(pt)ut(pt);else return st({frag:_e,part:ft,partsLoaded:lt})}).catch(ot)};ut(et)})}handleFragLoadError(_e){if("data"in _e){const et=_e.data;_e.data&&et.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(et.frag,et.part):this.hls.trigger(Events.ERROR,et)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:_e,error:_e,fatal:!0});return null}_handleTransmuxerFlush(_e){const et=this.getCurrentContext(_e);if(!et||this.state!==State.PARSING){!this.fragCurrent&&this.state!==State.STOPPED&&this.state!==State.ERROR&&(this.state=State.IDLE);return}const{frag:rt,part:it,level:st}=et,ot=self.performance.now();rt.stats.parsing.end=ot,it&&(it.stats.parsing.end=ot),this.updateLevelTiming(rt,it,st,_e.partial)}getCurrentContext(_e){const{levels:et,fragCurrent:rt}=this,{level:it,sn:st,part:ot}=_e;if(!(et!=null&&et[it]))return this.warn(`Levels object was unset while buffering fragment ${st} of level ${it}. The current chunk will not be buffered.`),null;const at=et[it],lt=ot>-1?getPartWith(at,st,ot):null,ct=lt?lt.fragment:getFragmentWithSN(at,st,rt);return ct?(rt&&rt!==ct&&(ct.stats=rt.stats),{frag:ct,part:lt,level:at}):null}bufferFragmentData(_e,et,rt,it,st){var ot;if(!_e||this.state!==State.PARSING)return;const{data1:at,data2:lt}=_e;let ct=at;if(at&&lt&&(ct=appendUint8Array(at,lt)),!((ot=ct)!=null&&ot.length))return;const ut={type:_e.type,frag:et,part:rt,chunkMeta:it,parent:et.type,data:ct};if(this.hls.trigger(Events.BUFFER_APPENDING,ut),_e.dropped&&_e.independent&&!rt){if(st)return;this.flushBufferGap(et)}}flushBufferGap(_e){const et=this.media;if(!et)return;if(!BufferHelper.isBuffered(et,et.currentTime)){this.flushMainBuffer(0,_e.start);return}const rt=et.currentTime,it=BufferHelper.bufferInfo(et,rt,0),st=_e.duration,ot=Math.min(this.config.maxFragLookUpTolerance*2,st*.25),at=Math.max(Math.min(_e.start-ot,it.end-ot),rt+ot);_e.start-at>ot&&this.flushMainBuffer(at,_e.start)}getFwdBufferInfo(_e,et){const rt=this.getLoadPosition();return isFiniteNumber(rt)?this.getFwdBufferInfoAtPos(_e,rt,et):null}getFwdBufferInfoAtPos(_e,et,rt){const{config:{maxBufferHole:it}}=this,st=BufferHelper.bufferInfo(_e,et,it);if(st.len===0&&st.nextStart!==void 0){const ot=this.fragmentTracker.getBufferedFrag(et,rt);if(ot&&st.nextStart<ot.end)return BufferHelper.bufferInfo(_e,et,Math.max(st.nextStart,it))}return st}getMaxBufferLength(_e){const{config:et}=this;let rt;return _e?rt=Math.max(8*et.maxBufferSize/_e,et.maxBufferLength):rt=et.maxBufferLength,Math.min(rt,et.maxMaxBufferLength)}reduceMaxBufferLength(_e,et){const rt=this.config,it=Math.max(Math.min(_e-et,rt.maxBufferLength),et),st=Math.max(_e-et*3,rt.maxMaxBufferLength/2,it);return st>=it?(rt.maxMaxBufferLength=st,this.warn(`Reduce max buffer length to ${st}s`),!0):!1}getAppendedFrag(_e,et=PlaylistLevelType.MAIN){const rt=this.fragmentTracker.getAppendedFrag(_e,PlaylistLevelType.MAIN);return rt&&"fragment"in rt?rt.fragment:rt}getNextFragment(_e,et){const rt=et.fragments,it=rt.length;if(!it)return null;const{config:st}=this,ot=rt[0].start;let at;if(et.live){const lt=st.initialLiveManifestSize;if(it<lt)return this.warn(`Not enough fragments to start playback (have: ${it}, need: ${lt})`),null;(!et.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||_e<ot)&&(at=this.getInitialLiveFragment(et,rt),this.startPosition=this.nextLoadPosition=at?this.hls.liveSyncPosition||at.start:_e)}else _e<=ot&&(at=rt[0]);if(!at){const lt=st.lowLatencyMode?et.partEnd:et.fragmentEnd;at=this.getFragmentAtPosition(_e,lt,et)}return this.mapToInitFragWhenRequired(at)}isLoopLoading(_e,et){const rt=this.fragmentTracker.getState(_e);return(rt===FragmentState.OK||rt===FragmentState.PARTIAL&&!!_e.gap)&&this.nextLoadPosition>et}getNextFragmentLoopLoading(_e,et,rt,it,st){const ot=_e.gap,at=this.getNextFragment(this.nextLoadPosition,et);if(at===null)return at;if(_e=at,ot&&_e&&!_e.gap&&rt.nextStart){const lt=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,rt.nextStart,it);if(lt!==null&&rt.len+lt.len>=st)return this.log(`buffer full after gaps in "${it}" playlist starting at sn: ${_e.sn}`),null}return _e}mapToInitFragWhenRequired(_e){return _e!=null&&_e.initSegment&&!(_e!=null&&_e.initSegment.data)&&!this.bitrateTest?_e.initSegment:_e}getNextPart(_e,et,rt){let it=-1,st=!1,ot=!0;for(let at=0,lt=_e.length;at<lt;at++){const ct=_e[at];if(ot=ot&&!ct.independent,it>-1&&rt<ct.start)break;const ut=ct.loaded;ut?it=-1:(st||ct.independent||ot)&&ct.fragment===et&&(it=at),st=ut}return it}loadedEndOfParts(_e,et){const rt=_e[_e.length-1];return rt&&et>rt.start&&rt.loaded}getInitialLiveFragment(_e,et){const rt=this.fragPrevious;let it=null;if(rt){if(_e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${rt.programDateTime}`),it=findFragmentByPDT(et,rt.endProgramDateTime,this.config.maxFragLookUpTolerance)),!it){const st=rt.sn+1;if(st>=_e.startSN&&st<=_e.endSN){const ot=et[st-_e.startSN];rt.cc===ot.cc&&(it=ot,this.log(`Live playlist, switching playlist, load frag with next SN: ${it.sn}`))}it||(it=findFragWithCC(et,rt.cc),it&&this.log(`Live playlist, switching playlist, load frag with same CC: ${it.sn}`))}}else{const st=this.hls.liveSyncPosition;st!==null&&(it=this.getFragmentAtPosition(st,this.bitrateTest?_e.fragmentEnd:_e.edge,_e))}return it}getFragmentAtPosition(_e,et,rt){const{config:it}=this;let{fragPrevious:st}=this,{fragments:ot,endSN:at}=rt;const{fragmentHint:lt}=rt,{maxFragLookUpTolerance:ct}=it,ut=rt.partList,ht=!!(it.lowLatencyMode&&ut!=null&&ut.length&&lt);ht&&lt&&!this.bitrateTest&&(ot=ot.concat(lt),at=lt.sn);let dt;if(_e<et){const ft=_e>et-ct?0:ct;dt=findFragmentByPTS(st,ot,_e,ft)}else dt=ot[ot.length-1];if(dt){const ft=dt.sn-rt.startSN,pt=this.fragmentTracker.getState(dt);if((pt===FragmentState.OK||pt===FragmentState.PARTIAL&&dt.gap)&&(st=dt),st&&dt.sn===st.sn&&(!ht||ut[0].fragment.sn>dt.sn)&&st&&dt.level===st.level){const At=ot[ft+1];dt.sn<at&&this.fragmentTracker.getState(At)!==FragmentState.OK?dt=At:dt=null}}return dt}synchronizeToLiveEdge(_e){const{config:et,media:rt}=this;if(!rt)return;const it=this.hls.liveSyncPosition,st=rt.currentTime,ot=_e.fragments[0].start,at=_e.edge,lt=st>=ot-et.maxFragLookUpTolerance&&st<=at;if(it!==null&&rt.duration>it&&(st<it||!lt)){const ct=et.liveMaxLatencyDuration!==void 0?et.liveMaxLatencyDuration:et.liveMaxLatencyDurationCount*_e.targetduration;(!lt&&rt.readyState<4||st<at-ct)&&(this.loadedmetadata||(this.nextLoadPosition=it),rt.readyState&&(this.warn(`Playback: ${st.toFixed(3)} is located too far from the end of live sliding playlist: ${at}, reset currentTime to : ${it.toFixed(3)}`),rt.currentTime=it))}}alignPlaylists(_e,et,rt){const it=_e.fragments.length;if(!it)return this.warn("No fragments in live playlist"),0;const st=_e.fragments[0].start,ot=!et,at=_e.alignedSliding&&isFiniteNumber(st);if(ot||!at&&!st){const{fragPrevious:lt}=this;alignStream(lt,rt,_e);const ct=_e.fragments[0].start;return this.log(`Live playlist sliding: ${ct.toFixed(2)} start-sn: ${et?et.startSN:"na"}->${_e.startSN} prev-sn: ${lt?lt.sn:"na"} fragments: ${it}`),ct}return st}waitForCdnTuneIn(_e){return _e.live&&_e.canBlockReload&&_e.partTarget&&_e.tuneInGoal>Math.max(_e.partHoldBack,_e.partTarget*3)}setStartPosition(_e,et){let rt=this.startPosition;if(rt<et&&(rt=-1),rt===-1||this.lastCurrentTime===-1){const it=this.startTimeOffset!==null,st=it?this.startTimeOffset:_e.startTimeOffset;st!==null&&isFiniteNumber(st)?(rt=et+st,st<0&&(rt+=_e.totalduration),rt=Math.min(Math.max(et,rt),et+_e.totalduration),this.log(`Start time offset ${st} found in ${it?"multivariant":"media"} playlist, adjust startPosition to ${rt}`),this.startPosition=rt):_e.live?rt=this.hls.liveSyncPosition||et:this.startPosition=rt=0,this.lastCurrentTime=rt}this.nextLoadPosition=rt}getLoadPosition(){const{media:_e}=this;let et=0;return this.loadedmetadata&&_e?et=_e.currentTime:this.nextLoadPosition&&(et=this.nextLoadPosition),et}handleFragLoadAborted(_e,et){this.transmuxer&&_e.sn!=="initSegment"&&_e.stats.aborted&&(this.warn(`Fragment ${_e.sn}${et?" part "+et.index:""} of level ${_e.level} was aborted`),this.resetFragmentLoading(_e))}resetFragmentLoading(_e){(!this.fragCurrent||!this.fragContextChanged(_e)&&this.state!==State.FRAG_LOADING_WAITING_RETRY)&&(this.state=State.IDLE)}onFragmentOrKeyLoadError(_e,et){if(et.chunkMeta&&!et.frag){const ut=this.getCurrentContext(et.chunkMeta);ut&&(et.frag=ut.frag)}const rt=et.frag;if(!rt||rt.type!==_e||!this.levels)return;if(this.fragContextChanged(rt)){var it;this.warn(`Frag load error must match current frag to retry ${rt.url} > ${(it=this.fragCurrent)==null?void 0:it.url}`);return}const st=et.details===ErrorDetails.FRAG_GAP;st&&this.fragmentTracker.fragBuffered(rt,!0);const ot=et.errorAction,{action:at,retryCount:lt=0,retryConfig:ct}=ot||{};if(ot&&at===NetworkErrorAction.RetryRequest&&ct){this.resetStartWhenNotLoaded(this.levelLastLoaded);const ut=getRetryDelay(ct,lt);this.warn(`Fragment ${rt.sn} of ${_e} ${rt.level} errored with ${et.details}, retrying loading ${lt+1}/${ct.maxNumRetry} in ${ut}ms`),ot.resolved=!0,this.retryDate=self.performance.now()+ut,this.state=State.FRAG_LOADING_WAITING_RETRY}else if(ct&&ot)if(this.resetFragmentErrors(_e),lt<ct.maxNumRetry)!st&&at!==NetworkErrorAction.RemoveAlternatePermanently&&(ot.resolved=!0);else{logger.warn(`${et.details} reached or exceeded max retry (${lt})`);return}else(ot==null?void 0:ot.action)===NetworkErrorAction.SendAlternateToPenaltyBox?this.state=State.WAITING_LEVEL:this.state=State.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(_e){if(this.state===State.PARSING||this.state===State.PARSED){const et=_e.frag,rt=_e.parent,it=this.getFwdBufferInfo(this.mediaBuffer,rt),st=it&&it.len>.5;st&&this.reduceMaxBufferLength(it.len,(et==null?void 0:et.duration)||10);const ot=!st;return ot&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${rt} buffer`),et&&(this.fragmentTracker.removeFragment(et),this.nextLoadPosition=et.start),this.resetLoadingState(),ot}return!1}resetFragmentErrors(_e){_e===PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==State.STOPPED&&(this.state=State.IDLE)}afterBufferFlushed(_e,et,rt){if(!_e)return;const it=BufferHelper.getBuffered(_e);this.fragmentTracker.detectEvictedFragments(et,it,rt),this.state===State.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=State.IDLE}resetStartWhenNotLoaded(_e){if(!this.loadedmetadata){this.startFragRequested=!1;const et=_e?_e.details:null;et!=null&&et.live?(this.startPosition=-1,this.setStartPosition(et,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(_e){this.warn(`The loading context changed while buffering fragment ${_e.sn} of level ${_e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(_e=0){this.fragmentTracker.removeFragmentsInRange(_e,1/0,this.playlistType,!1,!0)}updateLevelTiming(_e,et,rt,it){var st;const ot=rt.details;if(!ot){this.warn("level.details undefined");return}if(!Object.keys(_e.elementaryStreams).reduce((lt,ct)=>{const ut=_e.elementaryStreams[ct];if(ut){const ht=ut.endPTS-ut.startPTS;if(ht<=0)return this.warn(`Could not parse fragment ${_e.sn} ${ct} duration reliably (${ht})`),lt||!1;const dt=it?0:updateFragPTSDTS(ot,_e,ut.startPTS,ut.endPTS,ut.startDTS,ut.endDTS);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details:ot,level:rt,drift:dt,type:ct,frag:_e,start:ut.startPTS,end:ut.endPTS}),!0}return lt},!1)&&((st=this.transmuxer)==null?void 0:st.error)===null){const lt=new Error(`Found no media in fragment ${_e.sn} of level ${_e.level} resetting transmuxer to fallback to playlist timing`);if(rt.fragmentError===0&&(rt.fragmentError++,_e.gap=!0,this.fragmentTracker.removeFragment(_e),this.fragmentTracker.fragBuffered(_e,!0)),this.warn(lt.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:lt,frag:_e,reason:`Found no media in msn ${_e.sn} of level "${rt.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=State.PARSED,this.hls.trigger(Events.FRAG_PARSED,{frag:_e,part:et})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(_e){_e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(_e){const et=this._state;et!==_e&&(this._state=_e,this.log(`${et}->${_e}`))}get state(){return this._state}}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(_e){this.chunks.push(_e),this.dataLength+=_e.length}flush(){const{chunks:_e,dataLength:et}=this;let rt;if(_e.length)_e.length===1?rt=_e[0]:rt=concatUint8Arrays(_e,et);else return new Uint8Array(0);return this.reset(),rt}reset(){this.chunks.length=0,this.dataLength=0}}function concatUint8Arrays(nt,_e){const et=new Uint8Array(_e);let rt=0;for(let it=0;it<nt.length;it++){const st=nt[it];et.set(st,rt),rt+=st.length}return et}function hasUMDWorker(){return typeof __HLS_WORKER_BUNDLE__=="function"}function injectWorker(){const nt=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),_e=self.URL.createObjectURL(nt);return{worker:new self.Worker(_e),objectURL:_e}}function loadWorker(nt){const _e=new self.URL(nt,self.location.href).href;return{worker:new self.Worker(_e),scriptURL:_e}}function dummyTrack(nt="",_e=9e4){return{type:nt,id:-1,pid:-1,inputTimeScale:_e,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(_e,et,rt,it){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(_e){this.initPTS=_e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(_e,et){return!1}appendFrame(_e,et,rt){}demux(_e,et){this.cachedData&&(_e=appendUint8Array(this.cachedData,_e),this.cachedData=null);let rt=getID3Data(_e,0),it=rt?rt.length:0,st;const ot=this._audioTrack,at=this._id3Track,lt=rt?getTimeStamp(rt):void 0,ct=_e.length;for((this.basePTS===null||this.frameIndex===0&&isFiniteNumber(lt))&&(this.basePTS=initPTSFn(lt,et,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),rt&&rt.length>0&&at.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:rt,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});it<ct;){if(this.canParse(_e,it)){const ut=this.appendFrame(ot,_e,it);ut?(this.frameIndex++,this.lastPTS=ut.sample.pts,it+=ut.length,st=it):it=ct}else canParse$2(_e,it)?(rt=getID3Data(_e,it),at.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:rt,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),it+=rt.length,st=it):it++;if(it===ct&&st!==ct){const ut=sliceUint8(_e,st);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,ut):this.cachedData=ut}}return{audioTrack:ot,videoTrack:dummyTrack(),id3Track:at,textTrack:dummyTrack()}}demuxSampleAes(_e,et,rt){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(_e){const et=this.cachedData;return et&&(this.cachedData=null,this.demux(et,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){}}const initPTSFn=(nt,_e,et)=>{if(isFiniteNumber(nt))return nt*90;const rt=et?et.baseTime*9e4/et.timescale:0;return _e*9e4+rt};function getAudioConfig(nt,_e,et,rt){let it,st,ot,at;const lt=navigator.userAgent.toLowerCase(),ct=rt,ut=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];it=((_e[et+2]&192)>>>6)+1;const ht=(_e[et+2]&60)>>>2;if(ht>ut.length-1){const dt=new Error(`invalid ADTS sampling index:${ht}`);nt.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,error:dt,reason:dt.message});return}return ot=(_e[et+2]&1)<<2,ot|=(_e[et+3]&192)>>>6,logger.log(`manifest codec:${rt}, ADTS type:${it}, samplingIndex:${ht}`),/firefox/i.test(lt)?ht>=6?(it=5,at=new Array(4),st=ht-3):(it=2,at=new Array(2),st=ht):lt.indexOf("android")!==-1?(it=2,at=new Array(2),st=ht):(it=5,at=new Array(4),rt&&(rt.indexOf("mp4a.40.29")!==-1||rt.indexOf("mp4a.40.5")!==-1)||!rt&&ht>=6?st=ht-3:((rt&&rt.indexOf("mp4a.40.2")!==-1&&(ht>=6&&ot===1||/vivaldi/i.test(lt))||!rt&&ot===1)&&(it=2,at=new Array(2)),st=ht)),at[0]=it<<3,at[0]|=(ht&14)>>1,at[1]|=(ht&1)<<7,at[1]|=ot<<3,it===5&&(at[1]|=(st&14)>>1,at[2]=(st&1)<<7,at[2]|=8,at[3]=0),{config:at,samplerate:ut[ht],channelCount:ot,codec:"mp4a.40."+it,manifestCodec:ct}}function isHeaderPattern$1(nt,_e){return nt[_e]===255&&(nt[_e+1]&246)===240}function getHeaderLength(nt,_e){return nt[_e+1]&1?7:9}function getFullFrameLength(nt,_e){return(nt[_e+3]&3)<<11|nt[_e+4]<<3|(nt[_e+5]&224)>>>5}function canGetFrameLength(nt,_e){return _e+5<nt.length}function isHeader$1(nt,_e){return _e+1<nt.length&&isHeaderPattern$1(nt,_e)}function canParse$1(nt,_e){return canGetFrameLength(nt,_e)&&isHeaderPattern$1(nt,_e)&&getFullFrameLength(nt,_e)<=nt.length-_e}function probe$1(nt,_e){if(isHeader$1(nt,_e)){const et=getHeaderLength(nt,_e);if(_e+et>=nt.length)return!1;const rt=getFullFrameLength(nt,_e);if(rt<=et)return!1;const it=_e+rt;return it===nt.length||isHeader$1(nt,it)}return!1}function initTrackConfig(nt,_e,et,rt,it){if(!nt.samplerate){const st=getAudioConfig(_e,et,rt,it);if(!st)return;nt.config=st.config,nt.samplerate=st.samplerate,nt.channelCount=st.channelCount,nt.codec=st.codec,nt.manifestCodec=st.manifestCodec,logger.log(`parsed codec:${nt.codec}, rate:${st.samplerate}, channels:${st.channelCount}`)}}function getFrameDuration(nt){return 1024*9e4/nt}function parseFrameHeader(nt,_e){const et=getHeaderLength(nt,_e);if(_e+et<=nt.length){const rt=getFullFrameLength(nt,_e)-et;if(rt>0)return{headerLength:et,frameLength:rt}}}function appendFrame$2(nt,_e,et,rt,it){const st=getFrameDuration(nt.samplerate),ot=rt+it*st,at=parseFrameHeader(_e,et);let lt;if(at){const{frameLength:ht,headerLength:dt}=at,ft=dt+ht,pt=Math.max(0,et+ft-_e.length);pt?(lt=new Uint8Array(ft-dt),lt.set(_e.subarray(et+dt,_e.length),0)):lt=_e.subarray(et+dt,et+ft);const mt={unit:lt,pts:ot};return pt||nt.samples.push(mt),{sample:mt,length:ft,missing:pt}}const ct=_e.length-et;return lt=new Uint8Array(ct),lt.set(_e.subarray(et,_e.length),0),{sample:{unit:lt,pts:ot},length:ct,missing:-1}}let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame$1(nt,_e,et,rt,it){if(et+24>_e.length)return;const st=parseHeader(_e,et);if(st&&et+st.frameLength<=_e.length){const ot=st.samplesPerFrame*9e4/st.sampleRate,at=rt+it*ot,lt={unit:_e.subarray(et,et+st.frameLength),pts:at,dts:at};return nt.config=[],nt.channelCount=st.channelCount,nt.samplerate=st.sampleRate,nt.samples.push(lt),{sample:lt,length:st.frameLength,missing:0}}}function parseHeader(nt,_e){const et=nt[_e+1]>>3&3,rt=nt[_e+1]>>1&3,it=nt[_e+2]>>4&15,st=nt[_e+2]>>2&3;if(et!==1&&it!==0&&it!==15&&st!==3){const ot=nt[_e+2]>>1&1,at=nt[_e+3]>>6,lt=et===3?3-rt:rt===3?3:4,ct=BitratesMap[lt*14+it-1]*1e3,ht=SamplingRateMap[(et===3?0:et===2?1:2)*3+st],dt=at===3?1:2,ft=SamplesCoefficients[et][rt],pt=BytesInSlot[rt],mt=ft*8*pt,At=Math.floor(ft*ct/ht+ot)*pt;if(chromeVersion$1===null){const Tt=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=Tt?parseInt(Tt[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&rt===2&&ct>=224e3&&at===0&&(nt[_e+3]=nt[_e+3]|128),{sampleRate:ht,channelCount:dt,frameLength:At,samplesPerFrame:mt}}}function isHeaderPattern(nt,_e){return nt[_e]===255&&(nt[_e+1]&224)===224&&(nt[_e+1]&6)!==0}function isHeader(nt,_e){return _e+1<nt.length&&isHeaderPattern(nt,_e)}function canParse(nt,_e){return isHeaderPattern(nt,_e)&&4<=nt.length-_e}function probe(nt,_e){if(_e+1<nt.length&&isHeaderPattern(nt,_e)){const rt=parseHeader(nt,_e);let it=4;rt!=null&&rt.frameLength&&(it=rt.frameLength);const st=_e+it;return st===nt.length||isHeader(nt,st)}return!1}class AACDemuxer extends BaseAudioDemuxer{constructor(_e,et){super(),this.observer=void 0,this.config=void 0,this.observer=_e,this.config=et}resetInitSegment(_e,et,rt,it){super.resetInitSegment(_e,et,rt,it),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:et,duration:it,inputTimeScale:9e4,dropped:0}}static probe(_e){if(!_e)return!1;const et=getID3Data(_e,0);let rt=(et==null?void 0:et.length)||0;if(probe(_e,rt))return!1;for(let it=_e.length;rt<it;rt++)if(probe$1(_e,rt))return logger.log("ADTS sync word found !"),!0;return!1}canParse(_e,et){return canParse$1(_e,et)}appendFrame(_e,et,rt){initTrackConfig(_e,this.observer,et,rt,_e.manifestCodec);const it=appendFrame$2(_e,et,rt,this.basePTS,this.frameIndex);if(it&&it.missing===0)return it}}const emsgSchemePattern=/\/emsg[-/]ID3/i;class MP4Demuxer{constructor(_e,et){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=et}resetTimeStamp(){}resetInitSegment(_e,et,rt,it){const st=this.videoTrack=dummyTrack("video",1),ot=this.audioTrack=dummyTrack("audio",1),at=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,!(_e!=null&&_e.byteLength))return;const lt=parseInitSegment(_e);if(lt.video){const{id:ct,timescale:ut,codec:ht}=lt.video;st.id=ct,st.timescale=at.timescale=ut,st.codec=ht}if(lt.audio){const{id:ct,timescale:ut,codec:ht}=lt.audio;ot.id=ct,ot.timescale=ut,ot.codec=ht}at.id=RemuxerTrackIdConfig.text,st.sampleDuration=0,st.duration=ot.duration=it}resetContiguity(){this.remainderData=null}static probe(_e){return hasMoofData(_e)}demux(_e,et){this.timeOffset=et;let rt=_e;const it=this.videoTrack,st=this.txtTrack;if(this.config.progressive){this.remainderData&&(rt=appendUint8Array(this.remainderData,_e));const at=segmentValidRange(rt);this.remainderData=at.remainder,it.samples=at.valid||new Uint8Array}else it.samples=rt;const ot=this.extractID3Track(it,et);return st.samples=parseSamples(et,it),{videoTrack:it,audioTrack:this.audioTrack,id3Track:ot,textTrack:this.txtTrack}}flush(){const _e=this.timeOffset,et=this.videoTrack,rt=this.txtTrack;et.samples=this.remainderData||new Uint8Array,this.remainderData=null;const it=this.extractID3Track(et,this.timeOffset);return rt.samples=parseSamples(_e,et),{videoTrack:et,audioTrack:dummyTrack(),id3Track:it,textTrack:dummyTrack()}}extractID3Track(_e,et){const rt=this.id3Track;if(_e.samples.length){const it=findBox(_e.samples,["emsg"]);it&&it.forEach(st=>{const ot=parseEmsg(st);if(emsgSchemePattern.test(ot.schemeIdUri)){const at=isFiniteNumber(ot.presentationTime)?ot.presentationTime/ot.timeScale:et+ot.presentationTimeDelta/ot.timeScale;let lt=ot.eventDuration===4294967295?Number.POSITIVE_INFINITY:ot.eventDuration/ot.timeScale;lt<=.001&&(lt=Number.POSITIVE_INFINITY);const ct=ot.payload;rt.samples.push({data:ct,len:ct.byteLength,dts:at,pts:at,type:MetadataSchema.emsg,duration:lt})}})}return rt}demuxSampleAes(_e,et,rt){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const getAudioBSID=(nt,_e)=>{let et=0,rt=5;_e+=rt;const it=new Uint32Array(1),st=new Uint32Array(1),ot=new Uint8Array(1);for(;rt>0;){ot[0]=nt[_e];const at=Math.min(rt,8),lt=8-at;st[0]=4278190080>>>24+lt<<lt,it[0]=(ot[0]&st[0])>>lt,et=et?et<<at|it[0]:it[0],_e+=1,rt-=at}return et};class AC3Demuxer extends BaseAudioDemuxer{constructor(_e){super(),this.observer=void 0,this.observer=_e}resetInitSegment(_e,et,rt,it){super.resetInitSegment(_e,et,rt,it),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:et,duration:it,inputTimeScale:9e4,dropped:0}}canParse(_e,et){return et+64<_e.length}appendFrame(_e,et,rt){const it=appendFrame(_e,et,rt,this.basePTS,this.frameIndex);if(it!==-1)return{sample:_e.samples[_e.samples.length-1],length:it,missing:0}}static probe(_e){if(!_e)return!1;const et=getID3Data(_e,0);if(!et)return!1;const rt=et.length;return _e[rt]===11&&_e[rt+1]===119&&getTimeStamp(et)!==void 0&&getAudioBSID(_e,rt)<16}}function appendFrame(nt,_e,et,rt,it){if(et+8>_e.length||_e[et]!==11||_e[et+1]!==119)return-1;const st=_e[et+4]>>6;if(st>=3)return-1;const at=[48e3,44100,32e3][st],lt=_e[et+4]&63,ut=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][lt*3+st]*2;if(et+ut>_e.length)return-1;const ht=_e[et+6]>>5;let dt=0;ht===2?dt+=2:(ht&1&&ht!==1&&(dt+=2),ht&4&&(dt+=2));const ft=(_e[et+6]<<8|_e[et+7])>>12-dt&1,mt=[2,1,2,3,3,4,4,5][ht]+ft,At=_e[et+5]>>3,gt=_e[et+5]&7,bt=new Uint8Array([st<<6|At<<1|gt>>2,(gt&3)<<6|ht<<3|ft<<2|lt>>4,lt<<4&224]),Tt=1536/at*9e4,wt=rt+it*Tt,Rt=_e.subarray(et,et+ut);return nt.config=bt,nt.channelCount=mt,nt.samplerate=at,nt.samples.push({unit:Rt,pts:wt}),ut}class BaseVideoParser{constructor(){this.VideoSample=null}createVideoSample(_e,et,rt,it){return{key:_e,frame:!1,pts:et,dts:rt,units:[],debug:it,length:0}}getLastNalUnit(_e){var et;let rt=this.VideoSample,it;if((!rt||rt.units.length===0)&&(rt=_e[_e.length-1]),(et=rt)!=null&&et.units){const st=rt.units;it=st[st.length-1]}return it}pushAccessUnit(_e,et){if(_e.units.length&&_e.frame){if(_e.pts===void 0){const rt=et.samples,it=rt.length;if(it){const st=rt[it-1];_e.pts=st.pts,_e.dts=st.dts}else{et.dropped++;return}}et.samples.push(_e)}_e.debug.length&&logger.log(_e.pts+"/"+_e.dts+":"+_e.debug)}}class ExpGolomb{constructor(_e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=_e,this.bytesAvailable=_e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const _e=this.data,et=this.bytesAvailable,rt=_e.byteLength-et,it=new Uint8Array(4),st=Math.min(4,et);if(st===0)throw new Error("no bytes available");it.set(_e.subarray(rt,rt+st)),this.word=new DataView(it.buffer).getUint32(0),this.bitsAvailable=st*8,this.bytesAvailable-=st}skipBits(_e){let et;_e=Math.min(_e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>_e?(this.word<<=_e,this.bitsAvailable-=_e):(_e-=this.bitsAvailable,et=_e>>3,_e-=et<<3,this.bytesAvailable-=et,this.loadWord(),this.word<<=_e,this.bitsAvailable-=_e)}readBits(_e){let et=Math.min(this.bitsAvailable,_e);const rt=this.word>>>32-et;if(_e>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=et,this.bitsAvailable>0)this.word<<=et;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return et=_e-et,et>0&&this.bitsAvailable?rt<<et|this.readBits(et):rt}skipLZ(){let _e;for(_e=0;_e<this.bitsAvailable;++_e)if(this.word&2147483648>>>_e)return this.word<<=_e,this.bitsAvailable-=_e,_e;return this.loadWord(),_e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const _e=this.skipLZ();return this.readBits(_e+1)-1}readEG(){const _e=this.readUEG();return 1&_e?1+_e>>>1:-1*(_e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(_e){let et=8,rt=8,it;for(let st=0;st<_e;st++)rt!==0&&(it=this.readEG(),rt=(et+it+256)%256),et=rt===0?et:rt}readSPS(){let _e=0,et=0,rt=0,it=0,st,ot,at;const lt=this.readUByte.bind(this),ct=this.readBits.bind(this),ut=this.readUEG.bind(this),ht=this.readBoolean.bind(this),dt=this.skipBits.bind(this),ft=this.skipEG.bind(this),pt=this.skipUEG.bind(this),mt=this.skipScalingList.bind(this);lt();const At=lt();if(ct(5),dt(3),lt(),pt(),At===100||At===110||At===122||At===244||At===44||At===83||At===86||At===118||At===128){const It=ut();if(It===3&&dt(1),pt(),pt(),dt(1),ht())for(ot=It!==3?8:12,at=0;at<ot;at++)ht()&&(at<6?mt(16):mt(64))}pt();const gt=ut();if(gt===0)ut();else if(gt===1)for(dt(1),ft(),ft(),st=ut(),at=0;at<st;at++)ft();pt(),dt(1);const bt=ut(),Tt=ut(),wt=ct(1);wt===0&&dt(1),dt(1),ht()&&(_e=ut(),et=ut(),rt=ut(),it=ut());let Rt=[1,1];if(ht()&&ht())switch(lt()){case 1:Rt=[1,1];break;case 2:Rt=[12,11];break;case 3:Rt=[10,11];break;case 4:Rt=[16,11];break;case 5:Rt=[40,33];break;case 6:Rt=[24,11];break;case 7:Rt=[20,11];break;case 8:Rt=[32,11];break;case 9:Rt=[80,33];break;case 10:Rt=[18,11];break;case 11:Rt=[15,11];break;case 12:Rt=[64,33];break;case 13:Rt=[160,99];break;case 14:Rt=[4,3];break;case 15:Rt=[3,2];break;case 16:Rt=[2,1];break;case 255:{Rt=[lt()<<8|lt(),lt()<<8|lt()];break}}return{width:Math.ceil((bt+1)*16-_e*2-et*2),height:(2-wt)*(Tt+1)*16-(wt?2:4)*(rt+it),pixelRatio:Rt}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class AvcVideoParser extends BaseVideoParser{parseAVCPES(_e,et,rt,it,st){const ot=this.parseAVCNALu(_e,rt.data);let at=this.VideoSample,lt,ct=!1;rt.data=null,at&&ot.length&&!_e.audFound&&(this.pushAccessUnit(at,_e),at=this.VideoSample=this.createVideoSample(!1,rt.pts,rt.dts,"")),ot.forEach(ut=>{var ht;switch(ut.type){case 1:{let mt=!1;lt=!0;const At=ut.data;if(ct&&At.length>4){const gt=new ExpGolomb(At).readSliceType();(gt===2||gt===4||gt===7||gt===9)&&(mt=!0)}if(mt){var dt;(dt=at)!=null&&dt.frame&&!at.key&&(this.pushAccessUnit(at,_e),at=this.VideoSample=null)}at||(at=this.VideoSample=this.createVideoSample(!0,rt.pts,rt.dts,"")),at.frame=!0,at.key=mt;break}case 5:lt=!0,(ht=at)!=null&&ht.frame&&!at.key&&(this.pushAccessUnit(at,_e),at=this.VideoSample=null),at||(at=this.VideoSample=this.createVideoSample(!0,rt.pts,rt.dts,"")),at.key=!0,at.frame=!0;break;case 6:{lt=!0,parseSEIMessageFromNALu(ut.data,1,rt.pts,et.samples);break}case 7:{var ft,pt;lt=!0,ct=!0;const mt=ut.data,gt=new ExpGolomb(mt).readSPS();if(!_e.sps||_e.width!==gt.width||_e.height!==gt.height||((ft=_e.pixelRatio)==null?void 0:ft[0])!==gt.pixelRatio[0]||((pt=_e.pixelRatio)==null?void 0:pt[1])!==gt.pixelRatio[1]){_e.width=gt.width,_e.height=gt.height,_e.pixelRatio=gt.pixelRatio,_e.sps=[mt],_e.duration=st;const bt=mt.subarray(1,4);let Tt="avc1.";for(let wt=0;wt<3;wt++){let Rt=bt[wt].toString(16);Rt.length<2&&(Rt="0"+Rt),Tt+=Rt}_e.codec=Tt}break}case 8:lt=!0,_e.pps=[ut.data];break;case 9:lt=!0,_e.audFound=!0,at&&this.pushAccessUnit(at,_e),at=this.VideoSample=this.createVideoSample(!1,rt.pts,rt.dts,"");break;case 12:lt=!0;break;default:lt=!1,at&&(at.debug+="unknown NAL "+ut.type+" ");break}at&&lt&&at.units.push(ut)}),it&&at&&(this.pushAccessUnit(at,_e),this.VideoSample=null)}parseAVCNALu(_e,et){const rt=et.byteLength;let it=_e.naluState||0;const st=it,ot=[];let at=0,lt,ct,ut,ht=-1,dt=0;for(it===-1&&(ht=0,dt=et[0]&31,it=0,at=1);at<rt;){if(lt=et[at++],!it){it=lt?0:1;continue}if(it===1){it=lt?0:2;continue}if(!lt)it=3;else if(lt===1){if(ct=at-it-1,ht>=0){const ft={data:et.subarray(ht,ct),type:dt};ot.push(ft)}else{const ft=this.getLastNalUnit(_e.samples);ft&&(st&&at<=4-st&&ft.state&&(ft.data=ft.data.subarray(0,ft.data.byteLength-st)),ct>0&&(ft.data=appendUint8Array(ft.data,et.subarray(0,ct)),ft.state=0))}at<rt?(ut=et[at]&31,ht=at,dt=ut,it=0):it=-1}else it=0}if(ht>=0&&it>=0){const ft={data:et.subarray(ht,rt),type:dt,state:it};ot.push(ft)}if(ot.length===0){const ft=this.getLastNalUnit(_e.samples);ft&&(ft.data=appendUint8Array(ft.data,et))}return _e.naluState=it,ot}}class SampleAesDecrypter{constructor(_e,et,rt){this.keyData=void 0,this.decrypter=void 0,this.keyData=rt,this.decrypter=new Decrypter(et,{removePKCS7Padding:!1})}decryptBuffer(_e){return this.decrypter.decrypt(_e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(_e,et,rt){const it=_e[et].unit;if(it.length<=16)return;const st=it.subarray(16,it.length-it.length%16),ot=st.buffer.slice(st.byteOffset,st.byteOffset+st.length);this.decryptBuffer(ot).then(at=>{const lt=new Uint8Array(at);it.set(lt,16),this.decrypter.isSync()||this.decryptAacSamples(_e,et+1,rt)})}decryptAacSamples(_e,et,rt){for(;;et++){if(et>=_e.length){rt();return}if(!(_e[et].unit.length<32)&&(this.decryptAacSample(_e,et,rt),!this.decrypter.isSync()))return}}getAvcEncryptedData(_e){const et=Math.floor((_e.length-48)/160)*16+16,rt=new Int8Array(et);let it=0;for(let st=32;st<_e.length-16;st+=160,it+=16)rt.set(_e.subarray(st,st+16),it);return rt}getAvcDecryptedUnit(_e,et){const rt=new Uint8Array(et);let it=0;for(let st=32;st<_e.length-16;st+=160,it+=16)_e.set(rt.subarray(it,it+16),st);return _e}decryptAvcSample(_e,et,rt,it,st){const ot=discardEPB(st.data),at=this.getAvcEncryptedData(ot);this.decryptBuffer(at.buffer).then(lt=>{st.data=this.getAvcDecryptedUnit(ot,lt),this.decrypter.isSync()||this.decryptAvcSamples(_e,et,rt+1,it)})}decryptAvcSamples(_e,et,rt,it){if(_e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;et++,rt=0){if(et>=_e.length){it();return}const st=_e[et].units;for(;!(rt>=st.length);rt++){const ot=st[rt];if(!(ot.data.length<=48||ot.type!==1&&ot.type!==5)&&(this.decryptAvcSample(_e,et,rt,it,ot),!this.decrypter.isSync()))return}}}}const PACKET_LENGTH=188;class TSDemuxer{constructor(_e,et,rt){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=_e,this.config=et,this.typeSupported=rt,this.videoParser=new AvcVideoParser}static probe(_e){const et=TSDemuxer.syncOffset(_e);return et>0&&logger.warn(`MPEG2-TS detected but first sync word found @ offset ${et}`),et!==-1}static syncOffset(_e){const et=_e.length;let rt=Math.min(PACKET_LENGTH*5,et-PACKET_LENGTH)+1,it=0;for(;it<rt;){let st=!1,ot=-1,at=0;for(let lt=it;lt<et;lt+=PACKET_LENGTH)if(_e[lt]===71&&(et-lt===PACKET_LENGTH||_e[lt+PACKET_LENGTH]===71)){if(at++,ot===-1&&(ot=lt,ot!==0&&(rt=Math.min(ot+PACKET_LENGTH*99,_e.length-PACKET_LENGTH)+1)),st||(st=parsePID(_e,lt)===0),st&&at>1&&(ot===0&&at>2||lt+PACKET_LENGTH>rt))return ot}else{if(at)return-1;break}it++}return-1}static createTrack(_e,et){return{container:_e==="video"||_e==="audio"?"video/mp2t":void 0,type:_e,id:RemuxerTrackIdConfig[_e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:_e==="audio"?et:void 0}}resetInitSegment(_e,et,rt,it){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=TSDemuxer.createTrack("video"),this._audioTrack=TSDemuxer.createTrack("audio",it),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=et,this.videoCodec=rt,this._duration=it}resetTimeStamp(){}resetContiguity(){const{_audioTrack:_e,_videoTrack:et,_id3Track:rt}=this;_e&&(_e.pesData=null),et&&(et.pesData=null),rt&&(rt.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(_e,et,rt=!1,it=!1){rt||(this.sampleAes=null);let st;const ot=this._videoTrack,at=this._audioTrack,lt=this._id3Track,ct=this._txtTrack;let ut=ot.pid,ht=ot.pesData,dt=at.pid,ft=lt.pid,pt=at.pesData,mt=lt.pesData,At=null,gt=this.pmtParsed,bt=this._pmtId,Tt=_e.length;if(this.remainderData&&(_e=appendUint8Array(this.remainderData,_e),Tt=_e.length,this.remainderData=null),Tt<PACKET_LENGTH&&!it)return this.remainderData=_e,{audioTrack:at,videoTrack:ot,id3Track:lt,textTrack:ct};const wt=Math.max(0,TSDemuxer.syncOffset(_e));Tt-=(Tt-wt)%PACKET_LENGTH,Tt<_e.byteLength&&!it&&(this.remainderData=new Uint8Array(_e.buffer,Tt,_e.buffer.byteLength-Tt));let Rt=0;for(let Lt=wt;Lt<Tt;Lt+=PACKET_LENGTH)if(_e[Lt]===71){const $t=!!(_e[Lt+1]&64),kt=parsePID(_e,Lt),Dt=(_e[Lt+3]&48)>>4;let Ot;if(Dt>1){if(Ot=Lt+5+_e[Lt+4],Ot===Lt+PACKET_LENGTH)continue}else Ot=Lt+4;switch(kt){case ut:$t&&(ht&&(st=parsePES(ht))&&this.videoParser.parseAVCPES(ot,ct,st,!1,this._duration),ht={data:[],size:0}),ht&&(ht.data.push(_e.subarray(Ot,Lt+PACKET_LENGTH)),ht.size+=Lt+PACKET_LENGTH-Ot);break;case dt:if($t){if(pt&&(st=parsePES(pt)))switch(at.segmentCodec){case"aac":this.parseAACPES(at,st);break;case"mp3":this.parseMPEGPES(at,st);break;case"ac3":this.parseAC3PES(at,st);break}pt={data:[],size:0}}pt&&(pt.data.push(_e.subarray(Ot,Lt+PACKET_LENGTH)),pt.size+=Lt+PACKET_LENGTH-Ot);break;case ft:$t&&(mt&&(st=parsePES(mt))&&this.parseID3PES(lt,st),mt={data:[],size:0}),mt&&(mt.data.push(_e.subarray(Ot,Lt+PACKET_LENGTH)),mt.size+=Lt+PACKET_LENGTH-Ot);break;case 0:$t&&(Ot+=_e[Ot]+1),bt=this._pmtId=parsePAT(_e,Ot);break;case bt:{$t&&(Ot+=_e[Ot]+1);const zt=parsePMT(_e,Ot,this.typeSupported,rt,this.observer);ut=zt.videoPid,ut>0&&(ot.pid=ut,ot.segmentCodec=zt.segmentVideoCodec),dt=zt.audioPid,dt>0&&(at.pid=dt,at.segmentCodec=zt.segmentAudioCodec),ft=zt.id3Pid,ft>0&&(lt.pid=ft),At!==null&&!gt&&(logger.warn(`MPEG-TS PMT found at ${Lt} after unknown PID '${At}'. Backtracking to sync byte @${wt} to parse all TS packets.`),At=null,Lt=wt-188),gt=this.pmtParsed=!0;break}case 17:case 8191:break;default:At=kt;break}}else Rt++;Rt>0&&emitParsingError(this.observer,new Error(`Found ${Rt} TS packet/s that do not start with 0x47`)),ot.pesData=ht,at.pesData=pt,lt.pesData=mt;const It={audioTrack:at,videoTrack:ot,id3Track:lt,textTrack:ct};return it&&this.extractRemainingSamples(It),It}flush(){const{remainderData:_e}=this;this.remainderData=null;let et;return _e?et=this.demux(_e,-1,!1,!0):et={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(et),this.sampleAes?this.decrypt(et,this.sampleAes):et}extractRemainingSamples(_e){const{audioTrack:et,videoTrack:rt,id3Track:it,textTrack:st}=_e,ot=rt.pesData,at=et.pesData,lt=it.pesData;let ct;if(ot&&(ct=parsePES(ot))?(this.videoParser.parseAVCPES(rt,st,ct,!0,this._duration),rt.pesData=null):rt.pesData=ot,at&&(ct=parsePES(at))){switch(et.segmentCodec){case"aac":this.parseAACPES(et,ct);break;case"mp3":this.parseMPEGPES(et,ct);break;case"ac3":this.parseAC3PES(et,ct);break}et.pesData=null}else at!=null&&at.size&&logger.log("last AAC PES packet truncated,might overlap between fragments"),et.pesData=at;lt&&(ct=parsePES(lt))?(this.parseID3PES(it,ct),it.pesData=null):it.pesData=lt}demuxSampleAes(_e,et,rt){const it=this.demux(_e,rt,!0,!this.config.progressive),st=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,et);return this.decrypt(it,st)}decrypt(_e,et){return new Promise(rt=>{const{audioTrack:it,videoTrack:st}=_e;it.samples&&it.segmentCodec==="aac"?et.decryptAacSamples(it.samples,0,()=>{st.samples?et.decryptAvcSamples(st.samples,0,0,()=>{rt(_e)}):rt(_e)}):st.samples&&et.decryptAvcSamples(st.samples,0,0,()=>{rt(_e)})})}destroy(){this._duration=0}parseAACPES(_e,et){let rt=0;const it=this.aacOverFlow;let st=et.data;if(it){this.aacOverFlow=null;const ht=it.missing,dt=it.sample.unit.byteLength;if(ht===-1)st=appendUint8Array(it.sample.unit,st);else{const ft=dt-ht;it.sample.unit.set(st.subarray(0,ht),ft),_e.samples.push(it.sample),rt=it.missing}}let ot,at;for(ot=rt,at=st.length;ot<at-1&&!isHeader$1(st,ot);ot++);if(ot!==rt){let ht;const dt=ot<at-1;if(dt?ht=`AAC PES did not start with ADTS header,offset:${ot}`:ht="No ADTS header found in AAC PES",emitParsingError(this.observer,new Error(ht),dt),!dt)return}initTrackConfig(_e,this.observer,st,ot,this.audioCodec);let lt;if(et.pts!==void 0)lt=et.pts;else if(it){const ht=getFrameDuration(_e.samplerate);lt=it.sample.pts+ht}else{logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let ct=0,ut;for(;ot<at;)if(ut=appendFrame$2(_e,st,ot,lt,ct),ot+=ut.length,ut.missing){this.aacOverFlow=ut;break}else for(ct++;ot<at-1&&!isHeader$1(st,ot);ot++);}parseMPEGPES(_e,et){const rt=et.data,it=rt.length;let st=0,ot=0;const at=et.pts;if(at===void 0){logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;ot<it;)if(isHeader(rt,ot)){const lt=appendFrame$1(_e,rt,ot,at,st);if(lt)ot+=lt.length,st++;else break}else ot++}parseAC3PES(_e,et){{const rt=et.data,it=et.pts;if(it===void 0){logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const st=rt.length;let ot=0,at=0,lt;for(;at<st&&(lt=appendFrame(_e,rt,at,it,ot++))>0;)at+=lt}}parseID3PES(_e,et){if(et.pts===void 0){logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const rt=_extends$1({},et,{type:this._videoTrack?MetadataSchema.emsg:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});_e.samples.push(rt)}}function parsePID(nt,_e){return((nt[_e+1]&31)<<8)+nt[_e+2]}function parsePAT(nt,_e){return(nt[_e+10]&31)<<8|nt[_e+11]}function parsePMT(nt,_e,et,rt,it){const st={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},ot=(nt[_e+1]&15)<<8|nt[_e+2],at=_e+3+ot-4,lt=(nt[_e+10]&15)<<8|nt[_e+11];for(_e+=12+lt;_e<at;){const ct=parsePID(nt,_e),ut=(nt[_e+3]&15)<<8|nt[_e+4];switch(nt[_e]){case 207:if(!rt){logEncryptedSamplesFoundInUnencryptedStream("ADTS AAC");break}case 15:st.audioPid===-1&&(st.audioPid=ct);break;case 21:st.id3Pid===-1&&(st.id3Pid=ct);break;case 219:if(!rt){logEncryptedSamplesFoundInUnencryptedStream("H.264");break}case 27:st.videoPid===-1&&(st.videoPid=ct,st.segmentVideoCodec="avc");break;case 3:case 4:!et.mpeg&&!et.mp3?logger.log("MPEG audio found, not supported in this browser"):st.audioPid===-1&&(st.audioPid=ct,st.segmentAudioCodec="mp3");break;case 193:if(!rt){logEncryptedSamplesFoundInUnencryptedStream("AC-3");break}case 129:et.ac3?st.audioPid===-1&&(st.audioPid=ct,st.segmentAudioCodec="ac3"):logger.log("AC-3 audio found, not supported in this browser");break;case 6:if(st.audioPid===-1&&ut>0){let ht=_e+5,dt=ut;for(;dt>2;){switch(nt[ht]){case 106:et.ac3!==!0?logger.log("AC-3 audio found, not supported in this browser for now"):(st.audioPid=ct,st.segmentAudioCodec="ac3");break}const pt=nt[ht+1]+2;ht+=pt,dt-=pt}}break;case 194:case 135:return emitParsingError(it,new Error("Unsupported EC-3 in M2TS found")),st;case 36:return emitParsingError(it,new Error("Unsupported HEVC in M2TS found")),st}_e+=ut+5}return st}function emitParsingError(nt,_e,et){logger.warn(`parsing error: ${_e.message}`),nt.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry:et,error:_e,reason:_e.message})}function logEncryptedSamplesFoundInUnencryptedStream(nt){logger.log(`${nt} with AES-128-CBC encryption found in unencrypted stream`)}function parsePES(nt){let _e=0,et,rt,it,st,ot;const at=nt.data;if(!nt||nt.size===0)return null;for(;at[0].length<19&&at.length>1;)at[0]=appendUint8Array(at[0],at[1]),at.splice(1,1);if(et=at[0],(et[0]<<16)+(et[1]<<8)+et[2]===1){if(rt=(et[4]<<8)+et[5],rt&&rt>nt.size-6)return null;const ct=et[7];ct&192&&(st=(et[9]&14)*536870912+(et[10]&255)*4194304+(et[11]&254)*16384+(et[12]&255)*128+(et[13]&254)/2,ct&64?(ot=(et[14]&14)*536870912+(et[15]&255)*4194304+(et[16]&254)*16384+(et[17]&255)*128+(et[18]&254)/2,st-ot>60*9e4&&(logger.warn(`${Math.round((st-ot)/9e4)}s delta between PTS and DTS, align them`),st=ot)):ot=st),it=et[8];let ut=it+9;if(nt.size<=ut)return null;nt.size-=ut;const ht=new Uint8Array(nt.size);for(let dt=0,ft=at.length;dt<ft;dt++){et=at[dt];let pt=et.byteLength;if(ut)if(ut>pt){ut-=pt;continue}else et=et.subarray(ut),pt-=ut,ut=0;ht.set(et,_e),_e+=pt}return rt&&(rt-=it+3),{data:ht,pts:st,dts:ot,len:rt}}return null}class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(_e,et,rt,it){super.resetInitSegment(_e,et,rt,it),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:et,duration:it,inputTimeScale:9e4,dropped:0}}static probe(_e){if(!_e)return!1;const et=getID3Data(_e,0);let rt=(et==null?void 0:et.length)||0;if(et&&_e[rt]===11&&_e[rt+1]===119&&getTimeStamp(et)!==void 0&&getAudioBSID(_e,rt)<=16)return!1;for(let it=_e.length;rt<it;rt++)if(probe(_e,rt))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(_e,et){return canParse(_e,et)}appendFrame(_e,et,rt){if(this.basePTS!==null)return appendFrame$1(_e,et,rt,this.basePTS,this.frameIndex)}}class AAC{static getSilentFrame(_e,et){switch(_e){case"mp4a.40.2":if(et===1)return new Uint8Array([0,200,0,128,35,128]);if(et===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(et===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(et===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(et===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(et===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(et===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(et===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(et===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let _e;for(_e in MP4.types)MP4.types.hasOwnProperty(_e)&&(MP4.types[_e]=[_e.charCodeAt(0),_e.charCodeAt(1),_e.charCodeAt(2),_e.charCodeAt(3)]);const et=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),rt=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:et,audio:rt};const it=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),st=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=st,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const ot=new Uint8Array([105,115,111,109]),at=new Uint8Array([97,118,99,49]),lt=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,ot,lt,ot,at),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,it))}static box(_e,...et){let rt=8,it=et.length;const st=it;for(;it--;)rt+=et[it].byteLength;const ot=new Uint8Array(rt);for(ot[0]=rt>>24&255,ot[1]=rt>>16&255,ot[2]=rt>>8&255,ot[3]=rt&255,ot.set(_e,4),it=0,rt=8;it<st;it++)ot.set(et[it],rt),rt+=et[it].byteLength;return ot}static hdlr(_e){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[_e])}static mdat(_e){return MP4.box(MP4.types.mdat,_e)}static mdhd(_e,et){et*=_e;const rt=Math.floor(et/(UINT32_MAX+1)),it=Math.floor(et%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,_e>>24&255,_e>>16&255,_e>>8&255,_e&255,rt>>24,rt>>16&255,rt>>8&255,rt&255,it>>24,it>>16&255,it>>8&255,it&255,85,196,0,0]))}static mdia(_e){return MP4.box(MP4.types.mdia,MP4.mdhd(_e.timescale,_e.duration),MP4.hdlr(_e.type),MP4.minf(_e))}static mfhd(_e){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,_e>>24,_e>>16&255,_e>>8&255,_e&255]))}static minf(_e){return _e.type==="audio"?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(_e)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(_e))}static moof(_e,et,rt){return MP4.box(MP4.types.moof,MP4.mfhd(_e),MP4.traf(rt,et))}static moov(_e){let et=_e.length;const rt=[];for(;et--;)rt[et]=MP4.trak(_e[et]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(_e[0].timescale,_e[0].duration)].concat(rt).concat(MP4.mvex(_e)))}static mvex(_e){let et=_e.length;const rt=[];for(;et--;)rt[et]=MP4.trex(_e[et]);return MP4.box.apply(null,[MP4.types.mvex,...rt])}static mvhd(_e,et){et*=_e;const rt=Math.floor(et/(UINT32_MAX+1)),it=Math.floor(et%(UINT32_MAX+1)),st=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,_e>>24&255,_e>>16&255,_e>>8&255,_e&255,rt>>24,rt>>16&255,rt>>8&255,rt&255,it>>24,it>>16&255,it>>8&255,it&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,st)}static sdtp(_e){const et=_e.samples||[],rt=new Uint8Array(4+et.length);let it,st;for(it=0;it<et.length;it++)st=et[it].flags,rt[it+4]=st.dependsOn<<4|st.isDependedOn<<2|st.hasRedundancy;return MP4.box(MP4.types.sdtp,rt)}static stbl(_e){return MP4.box(MP4.types.stbl,MP4.stsd(_e),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(_e){let et=[],rt=[],it,st,ot;for(it=0;it<_e.sps.length;it++)st=_e.sps[it],ot=st.byteLength,et.push(ot>>>8&255),et.push(ot&255),et=et.concat(Array.prototype.slice.call(st));for(it=0;it<_e.pps.length;it++)st=_e.pps[it],ot=st.byteLength,rt.push(ot>>>8&255),rt.push(ot&255),rt=rt.concat(Array.prototype.slice.call(st));const at=MP4.box(MP4.types.avcC,new Uint8Array([1,et[3],et[4],et[5],255,224|_e.sps.length].concat(et).concat([_e.pps.length]).concat(rt))),lt=_e.width,ct=_e.height,ut=_e.pixelRatio[0],ht=_e.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,lt>>8&255,lt&255,ct>>8&255,ct&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),at,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([ut>>24,ut>>16&255,ut>>8&255,ut&255,ht>>24,ht>>16&255,ht>>8&255,ht&255])))}static esds(_e){const et=_e.config.length;return new Uint8Array([0,0,0,0,3,23+et,0,1,0,4,15+et,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([et]).concat(_e.config).concat([6,1,2]))}static audioStsd(_e){const et=_e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,_e.channelCount,0,16,0,0,0,0,et>>8&255,et&255,0,0])}static mp4a(_e){return MP4.box(MP4.types.mp4a,MP4.audioStsd(_e),MP4.box(MP4.types.esds,MP4.esds(_e)))}static mp3(_e){return MP4.box(MP4.types[".mp3"],MP4.audioStsd(_e))}static ac3(_e){return MP4.box(MP4.types["ac-3"],MP4.audioStsd(_e),MP4.box(MP4.types.dac3,_e.config))}static stsd(_e){return _e.type==="audio"?_e.segmentCodec==="mp3"&&_e.codec==="mp3"?MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(_e)):_e.segmentCodec==="ac3"?MP4.box(MP4.types.stsd,MP4.STSD,MP4.ac3(_e)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(_e)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(_e))}static tkhd(_e){const et=_e.id,rt=_e.duration*_e.timescale,it=_e.width,st=_e.height,ot=Math.floor(rt/(UINT32_MAX+1)),at=Math.floor(rt%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,et>>24&255,et>>16&255,et>>8&255,et&255,0,0,0,0,ot>>24,ot>>16&255,ot>>8&255,ot&255,at>>24,at>>16&255,at>>8&255,at&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,it>>8&255,it&255,0,0,st>>8&255,st&255,0,0]))}static traf(_e,et){const rt=MP4.sdtp(_e),it=_e.id,st=Math.floor(et/(UINT32_MAX+1)),ot=Math.floor(et%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,it>>24,it>>16&255,it>>8&255,it&255])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,st>>24,st>>16&255,st>>8&255,st&255,ot>>24,ot>>16&255,ot>>8&255,ot&255])),MP4.trun(_e,rt.length+16+20+8+16+8+8),rt)}static trak(_e){return _e.duration=_e.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(_e),MP4.mdia(_e))}static trex(_e){const et=_e.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,et>>24,et>>16&255,et>>8&255,et&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(_e,et){const rt=_e.samples||[],it=rt.length,st=12+16*it,ot=new Uint8Array(st);let at,lt,ct,ut,ht,dt;for(et+=8+st,ot.set([_e.type==="video"?1:0,0,15,1,it>>>24&255,it>>>16&255,it>>>8&255,it&255,et>>>24&255,et>>>16&255,et>>>8&255,et&255],0),at=0;at<it;at++)lt=rt[at],ct=lt.duration,ut=lt.size,ht=lt.flags,dt=lt.cts,ot.set([ct>>>24&255,ct>>>16&255,ct>>>8&255,ct&255,ut>>>24&255,ut>>>16&255,ut>>>8&255,ut&255,ht.isLeading<<2|ht.dependsOn,ht.isDependedOn<<6|ht.hasRedundancy<<4|ht.paddingValue<<1|ht.isNonSync,ht.degradPrio&61440,ht.degradPrio&15,dt>>>24&255,dt>>>16&255,dt>>>8&255,dt&255],12+16*at);return MP4.box(MP4.types.trun,ot)}static initSegment(_e){MP4.types||MP4.init();const et=MP4.moov(_e);return appendUint8Array(MP4.FTYP,et)}}MP4.types=void 0;MP4.HDLR_TYPES=void 0;MP4.STTS=void 0;MP4.STSC=void 0;MP4.STCO=void 0;MP4.STSZ=void 0;MP4.VMHD=void 0;MP4.SMHD=void 0;MP4.STSD=void 0;MP4.FTYP=void 0;MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(nt,_e,et=1,rt=!1){const it=nt*_e*et;return rt?Math.round(it):it}function toTimescaleFromScale(nt,_e,et=1,rt=!1){return toTimescaleFromBase(nt,_e,1/et,rt)}function toMsFromMpegTsClock(nt,_e=!1){return toTimescaleFromBase(nt,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,_e)}function toMpegTsClockFromTimescale(nt,_e=1){return toTimescaleFromBase(nt,MPEG_TS_CLOCK_FREQ_HZ,1/_e)}const MAX_SILENT_FRAME_DURATION=10*1e3,AAC_SAMPLES_PER_FRAME=1024,MPEG_AUDIO_SAMPLE_PER_FRAME=1152,AC3_SAMPLES_PER_FRAME=1536;let chromeVersion=null,safariWebkitVersion=null;class MP4Remuxer{constructor(_e,et,rt,it=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=_e,this.config=et,this.typeSupported=rt,this.ISGenerated=!1,chromeVersion===null){const ot=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=ot?parseInt(ot[1]):0}if(safariWebkitVersion===null){const st=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=st?parseInt(st[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(_e){logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=_e}resetNextTimestamp(){logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(_e){let et=!1;const rt=_e.reduce((it,st)=>{const ot=st.pts-it;return ot<-4294967296?(et=!0,normalizePts(it,st.pts)):ot>0?it:st.pts},_e[0].pts);return et&&logger.debug("PTS rollover detected"),rt}remux(_e,et,rt,it,st,ot,at,lt){let ct,ut,ht,dt,ft,pt,mt=st,At=st;const gt=_e.pid>-1,bt=et.pid>-1,Tt=et.samples.length,wt=_e.samples.length>0,Rt=at&&Tt>0||Tt>1;if((!gt||wt)&&(!bt||Rt)||this.ISGenerated||at){if(this.ISGenerated){var Lt,$t,kt,Dt;const Yt=this.videoTrackConfig;Yt&&(et.width!==Yt.width||et.height!==Yt.height||((Lt=et.pixelRatio)==null?void 0:Lt[0])!==(($t=Yt.pixelRatio)==null?void 0:$t[0])||((kt=et.pixelRatio)==null?void 0:kt[1])!==((Dt=Yt.pixelRatio)==null?void 0:Dt[1]))&&this.resetInitSegment()}else ht=this.generateIS(_e,et,st,ot);const Ot=this.isVideoContiguous;let zt=-1,Ht;if(Rt&&(zt=findKeyframeIndex(et.samples),!Ot&&this.config.forceKeyFrameOnDiscontinuity))if(pt=!0,zt>0){logger.warn(`[mp4-remuxer]: Dropped ${zt} out of ${Tt} video samples due to a missing keyframe`);const Yt=this.getVideoStartPts(et.samples);et.samples=et.samples.slice(zt),et.dropped+=zt,At+=(et.samples[0].pts-Yt)/et.inputTimeScale,Ht=At}else zt===-1&&(logger.warn(`[mp4-remuxer]: No keyframe found out of ${Tt} video samples`),pt=!1);if(this.ISGenerated){if(wt&&Rt){const Yt=this.getVideoStartPts(et.samples),Zt=(normalizePts(_e.samples[0].pts,Yt)-Yt)/et.inputTimeScale;mt+=Math.max(0,Zt),At+=Math.max(0,-Zt)}if(wt){if(_e.samplerate||(logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),ht=this.generateIS(_e,et,st,ot)),ut=this.remuxAudio(_e,mt,this.isAudioContiguous,ot,bt||Rt||lt===PlaylistLevelType.AUDIO?At:void 0),Rt){const Yt=ut?ut.endPTS-ut.startPTS:0;et.inputTimeScale||(logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),ht=this.generateIS(_e,et,st,ot)),ct=this.remuxVideo(et,At,Ot,Yt)}}else Rt&&(ct=this.remuxVideo(et,At,Ot,0));ct&&(ct.firstKeyFrame=zt,ct.independent=zt!==-1,ct.firstKeyFramePTS=Ht)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(rt.samples.length&&(ft=flushTextTrackMetadataCueSamples(rt,st,this._initPTS,this._initDTS)),it.samples.length&&(dt=flushTextTrackUserdataCueSamples(it,st,this._initPTS))),{audio:ut,video:ct,initSegment:ht,independent:pt,text:dt,id3:ft}}generateIS(_e,et,rt,it){const st=_e.samples,ot=et.samples,at=this.typeSupported,lt={},ct=this._initPTS;let ut=!ct||it,ht="audio/mp4",dt,ft,pt;if(ut&&(dt=ft=1/0),_e.config&&st.length){switch(_e.timescale=_e.samplerate,_e.segmentCodec){case"mp3":at.mpeg?(ht="audio/mpeg",_e.codec=""):at.mp3&&(_e.codec="mp3");break;case"ac3":_e.codec="ac-3";break}lt.audio={id:"audio",container:ht,codec:_e.codec,initSegment:_e.segmentCodec==="mp3"&&at.mpeg?new Uint8Array(0):MP4.initSegment([_e]),metadata:{channelCount:_e.channelCount}},ut&&(pt=_e.inputTimeScale,!ct||pt!==ct.timescale?dt=ft=st[0].pts-Math.round(pt*rt):ut=!1)}if(et.sps&&et.pps&&ot.length){if(et.timescale=et.inputTimeScale,lt.video={id:"main",container:"video/mp4",codec:et.codec,initSegment:MP4.initSegment([et]),metadata:{width:et.width,height:et.height}},ut)if(pt=et.inputTimeScale,!ct||pt!==ct.timescale){const mt=this.getVideoStartPts(ot),At=Math.round(pt*rt);ft=Math.min(ft,normalizePts(ot[0].dts,mt)-At),dt=Math.min(dt,mt-At)}else ut=!1;this.videoTrackConfig={width:et.width,height:et.height,pixelRatio:et.pixelRatio}}if(Object.keys(lt).length)return this.ISGenerated=!0,ut?(this._initPTS={baseTime:dt,timescale:pt},this._initDTS={baseTime:ft,timescale:pt}):dt=pt=void 0,{tracks:lt,initPTS:dt,timescale:pt}}remuxVideo(_e,et,rt,it){const st=_e.inputTimeScale,ot=_e.samples,at=[],lt=ot.length,ct=this._initPTS;let ut=this.nextAvcDts,ht=8,dt=this.videoSampleDuration,ft,pt,mt=Number.POSITIVE_INFINITY,At=Number.NEGATIVE_INFINITY,gt=!1;if(!rt||ut===null){const jt=et*st,Kt=ot[0].pts-normalizePts(ot[0].dts,ot[0].pts);chromeVersion&&ut!==null&&Math.abs(jt-Kt-ut)<15e3?rt=!0:ut=jt-Kt}const bt=ct.baseTime*st/ct.timescale;for(let jt=0;jt<lt;jt++){const Kt=ot[jt];Kt.pts=normalizePts(Kt.pts-bt,ut),Kt.dts=normalizePts(Kt.dts-bt,ut),Kt.dts<ot[jt>0?jt-1:jt].dts&&(gt=!0)}gt&&ot.sort(function(jt,Kt){const Jt=jt.dts-Kt.dts,sn=jt.pts-Kt.pts;return Jt||sn}),ft=ot[0].dts,pt=ot[ot.length-1].dts;const Tt=pt-ft,wt=Tt?Math.round(Tt/(lt-1)):dt||_e.inputTimeScale/30;if(rt){const jt=ft-ut,Kt=jt>wt,Jt=jt<-1;if((Kt||Jt)&&(Kt?logger.warn(`AVC: ${toMsFromMpegTsClock(jt,!0)} ms (${jt}dts) hole between fragments detected at ${et.toFixed(3)}`):logger.warn(`AVC: ${toMsFromMpegTsClock(-jt,!0)} ms (${jt}dts) overlapping between fragments detected at ${et.toFixed(3)}`),!Jt||ut>=ot[0].pts||chromeVersion)){ft=ut;const sn=ot[0].pts-jt;if(Kt)ot[0].dts=ft,ot[0].pts=sn;else for(let hn=0;hn<ot.length&&!(ot[hn].dts>sn);hn++)ot[hn].dts-=jt,ot[hn].pts-=jt;logger.log(`Video: Initial PTS/DTS adjusted: ${toMsFromMpegTsClock(sn,!0)}/${toMsFromMpegTsClock(ft,!0)}, delta: ${toMsFromMpegTsClock(jt,!0)} ms`)}}ft=Math.max(0,ft);let Rt=0,It=0,Lt=ft;for(let jt=0;jt<lt;jt++){const Kt=ot[jt],Jt=Kt.units,sn=Jt.length;let hn=0;for(let an=0;an<sn;an++)hn+=Jt[an].data.length;It+=hn,Rt+=sn,Kt.length=hn,Kt.dts<Lt?(Kt.dts=Lt,Lt+=wt/4|0||1):Lt=Kt.dts,mt=Math.min(Kt.pts,mt),At=Math.max(Kt.pts,At)}pt=ot[lt-1].dts;const $t=It+4*Rt+8;let kt;try{kt=new Uint8Array($t)}catch(jt){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:jt,bytes:$t,reason:`fail allocating video mdat ${$t}`});return}const Dt=new DataView(kt.buffer);Dt.setUint32(0,$t),kt.set(MP4.types.mdat,4);let Ot=!1,zt=Number.POSITIVE_INFINITY,Ht=Number.POSITIVE_INFINITY,Yt=Number.NEGATIVE_INFINITY,Xt=Number.NEGATIVE_INFINITY;for(let jt=0;jt<lt;jt++){const Kt=ot[jt],Jt=Kt.units;let sn=0;for(let pn=0,_n=Jt.length;pn<_n;pn++){const yn=Jt[pn],$n=yn.data,Jn=yn.data.byteLength;Dt.setUint32(ht,Jn),ht+=4,kt.set($n,ht),ht+=Jn,sn+=4+Jn}let hn;if(jt<lt-1)dt=ot[jt+1].dts-Kt.dts,hn=ot[jt+1].pts-Kt.pts;else{const pn=this.config,_n=jt>0?Kt.dts-ot[jt-1].dts:wt;if(hn=jt>0?Kt.pts-ot[jt-1].pts:wt,pn.stretchShortVideoTrack&&this.nextAudioPts!==null){const yn=Math.floor(pn.maxBufferHole*st),$n=(it?mt+it*st:this.nextAudioPts)-Kt.pts;$n>yn?(dt=$n-_n,dt<0?dt=_n:Ot=!0,logger.log(`[mp4-remuxer]: It is approximately ${$n/90} ms to the next segment; using duration ${dt/90} ms for the last video frame.`)):dt=_n}else dt=_n}const an=Math.round(Kt.pts-Kt.dts);zt=Math.min(zt,dt),Yt=Math.max(Yt,dt),Ht=Math.min(Ht,hn),Xt=Math.max(Xt,hn),at.push(new Mp4Sample(Kt.key,dt,sn,an))}if(at.length){if(chromeVersion){if(chromeVersion<70){const jt=at[0].flags;jt.dependsOn=2,jt.isNonSync=0}}else if(safariWebkitVersion&&Xt-Ht<Yt-zt&&wt/Yt<.025&&at[0].cts===0){logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let jt=ft;for(let Kt=0,Jt=at.length;Kt<Jt;Kt++){const sn=jt+at[Kt].duration,hn=jt+at[Kt].cts;if(Kt<Jt-1){const an=sn+at[Kt+1].cts;at[Kt].duration=an-hn}else at[Kt].duration=Kt?at[Kt-1].duration:wt;at[Kt].cts=0,jt=sn}}}dt=Ot||!dt?wt:dt,this.nextAvcDts=ut=pt+dt,this.videoSampleDuration=dt,this.isVideoContiguous=!0;const Gt={data1:MP4.moof(_e.sequenceNumber++,ft,_extends$1({},_e,{samples:at})),data2:kt,startPTS:mt/st,endPTS:(At+dt)/st,startDTS:ft/st,endDTS:ut/st,type:"video",hasAudio:!1,hasVideo:!0,nb:at.length,dropped:_e.dropped};return _e.samples=[],_e.dropped=0,Gt}getSamplesPerFrame(_e){switch(_e.segmentCodec){case"mp3":return MPEG_AUDIO_SAMPLE_PER_FRAME;case"ac3":return AC3_SAMPLES_PER_FRAME;default:return AAC_SAMPLES_PER_FRAME}}remuxAudio(_e,et,rt,it,st){const ot=_e.inputTimeScale,at=_e.samplerate?_e.samplerate:ot,lt=ot/at,ct=this.getSamplesPerFrame(_e),ut=ct*lt,ht=this._initPTS,dt=_e.segmentCodec==="mp3"&&this.typeSupported.mpeg,ft=[],pt=st!==void 0;let mt=_e.samples,At=dt?0:8,gt=this.nextAudioPts||-1;const bt=et*ot,Tt=ht.baseTime*ot/ht.timescale;if(this.isAudioContiguous=rt=rt||mt.length&&gt>0&&(it&&Math.abs(bt-gt)<9e3||Math.abs(normalizePts(mt[0].pts-Tt,bt)-gt)<20*ut),mt.forEach(function(Zt){Zt.pts=normalizePts(Zt.pts-Tt,bt)}),!rt||gt<0){if(mt=mt.filter(Zt=>Zt.pts>=0),!mt.length)return;st===0?gt=0:it&&!pt?gt=Math.max(0,bt):gt=mt[0].pts}if(_e.segmentCodec==="aac"){const Zt=this.config.maxAudioFramesDrift;for(let rn=0,Gt=gt;rn<mt.length;rn++){const jt=mt[rn],Kt=jt.pts,Jt=Kt-Gt,sn=Math.abs(1e3*Jt/ot);if(Jt<=-Zt*ut&&pt)rn===0&&(logger.warn(`Audio frame @ ${(Kt/ot).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*Jt/ot)} ms.`),this.nextAudioPts=gt=Gt=Kt);else if(Jt>=Zt*ut&&sn<MAX_SILENT_FRAME_DURATION&&pt){let hn=Math.round(Jt/ut);Gt=Kt-hn*ut,Gt<0&&(hn--,Gt+=ut),rn===0&&(this.nextAudioPts=gt=Gt),logger.warn(`[mp4-remuxer]: Injecting ${hn} audio frame @ ${(Gt/ot).toFixed(3)}s due to ${Math.round(1e3*Jt/ot)} ms gap.`);for(let an=0;an<hn;an++){const pn=Math.max(Gt,0);let _n=AAC.getSilentFrame(_e.manifestCodec||_e.codec,_e.channelCount);_n||(logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),_n=jt.unit.subarray()),mt.splice(rn,0,{unit:_n,pts:pn}),Gt+=ut,rn++}}jt.pts=Gt,Gt+=ut}}let wt=null,Rt=null,It,Lt=0,$t=mt.length;for(;$t--;)Lt+=mt[$t].unit.byteLength;for(let Zt=0,rn=mt.length;Zt<rn;Zt++){const Gt=mt[Zt],jt=Gt.unit;let Kt=Gt.pts;if(Rt!==null){const sn=ft[Zt-1];sn.duration=Math.round((Kt-Rt)/lt)}else if(rt&&_e.segmentCodec==="aac"&&(Kt=gt),wt=Kt,Lt>0){Lt+=At;try{It=new Uint8Array(Lt)}catch(sn){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:sn,bytes:Lt,reason:`fail allocating audio mdat ${Lt}`});return}dt||(new DataView(It.buffer).setUint32(0,Lt),It.set(MP4.types.mdat,4))}else return;It.set(jt,At);const Jt=jt.byteLength;At+=Jt,ft.push(new Mp4Sample(!0,ct,Jt,0)),Rt=Kt}const kt=ft.length;if(!kt)return;const Dt=ft[ft.length-1];this.nextAudioPts=gt=Rt+lt*Dt.duration;const Ot=dt?new Uint8Array(0):MP4.moof(_e.sequenceNumber++,wt/lt,_extends$1({},_e,{samples:ft}));_e.samples=[];const zt=wt/ot,Ht=gt/ot,Xt={data1:Ot,data2:It,startPTS:zt,endPTS:Ht,startDTS:zt,endDTS:Ht,type:"audio",hasAudio:!0,hasVideo:!1,nb:kt};return this.isAudioContiguous=!0,Xt}remuxEmptyAudio(_e,et,rt,it){const st=_e.inputTimeScale,ot=_e.samplerate?_e.samplerate:st,at=st/ot,lt=this.nextAudioPts,ct=this._initDTS,ut=ct.baseTime*9e4/ct.timescale,ht=(lt!==null?lt:it.startDTS*st)+ut,dt=it.endDTS*st+ut,ft=at*AAC_SAMPLES_PER_FRAME,pt=Math.ceil((dt-ht)/ft),mt=AAC.getSilentFrame(_e.manifestCodec||_e.codec,_e.channelCount);if(logger.warn("[mp4-remuxer]: remux empty Audio"),!mt){logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const At=[];for(let gt=0;gt<pt;gt++){const bt=ht+gt*ft;At.push({unit:mt,pts:bt,dts:bt})}return _e.samples=At,this.remuxAudio(_e,et,rt,!1)}}function normalizePts(nt,_e){let et;if(_e===null)return nt;for(_e<nt?et=-8589934592:et=8589934592;Math.abs(nt-_e)>4294967296;)nt+=et;return nt}function findKeyframeIndex(nt){for(let _e=0;_e<nt.length;_e++)if(nt[_e].key)return _e;return-1}function flushTextTrackMetadataCueSamples(nt,_e,et,rt){const it=nt.samples.length;if(!it)return;const st=nt.inputTimeScale;for(let at=0;at<it;at++){const lt=nt.samples[at];lt.pts=normalizePts(lt.pts-et.baseTime*st/et.timescale,_e*st)/st,lt.dts=normalizePts(lt.dts-rt.baseTime*st/rt.timescale,_e*st)/st}const ot=nt.samples;return nt.samples=[],{samples:ot}}function flushTextTrackUserdataCueSamples(nt,_e,et){const rt=nt.samples.length;if(!rt)return;const it=nt.inputTimeScale;for(let ot=0;ot<rt;ot++){const at=nt.samples[ot];at.pts=normalizePts(at.pts-et.baseTime*it/et.timescale,_e*it)/it}nt.samples.sort((ot,at)=>ot.pts-at.pts);const st=nt.samples;return nt.samples=[],{samples:st}}class Mp4Sample{constructor(_e,et,rt,it){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=et,this.size=rt,this.cts=it,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:_e?2:1,isNonSync:_e?0:1}}}class PassThroughRemuxer{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(_e){this.initPTS=_e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(_e,et,rt,it){this.audioCodec=et,this.videoCodec=rt,this.generateInitSegment(patchEncyptionData(_e,it)),this.emitInitSegment=!0}generateInitSegment(_e){let{audioCodec:et,videoCodec:rt}=this;if(!(_e!=null&&_e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const it=this.initData=parseInitSegment(_e);it.audio&&(et=getParsedTrackCodec(it.audio,ElementaryStreamTypes.AUDIO)),it.video&&(rt=getParsedTrackCodec(it.video,ElementaryStreamTypes.VIDEO));const st={};it.audio&&it.video?st.audiovideo={container:"video/mp4",codec:et+","+rt,initSegment:_e,id:"main"}:it.audio?st.audio={container:"audio/mp4",codec:et,initSegment:_e,id:"audio"}:it.video?st.video={container:"video/mp4",codec:rt,initSegment:_e,id:"main"}:logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=st}remux(_e,et,rt,it,st,ot){var at,lt;let{initPTS:ct,lastEndTime:ut}=this;const ht={audio:void 0,video:void 0,text:it,id3:rt,initSegment:void 0};isFiniteNumber(ut)||(ut=this.lastEndTime=st||0);const dt=et.samples;if(!(dt!=null&&dt.length))return ht;const ft={initPTS:void 0,timescale:1};let pt=this.initData;if((at=pt)!=null&&at.length||(this.generateInitSegment(dt),pt=this.initData),!((lt=pt)!=null&&lt.length))return logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),ht;this.emitInitSegment&&(ft.tracks=this.initTracks,this.emitInitSegment=!1);const mt=getDuration(dt,pt),At=getStartDTS(pt,dt),gt=At===null?st:At;(isInvalidInitPts(ct,gt,st,mt)||ft.timescale!==ct.timescale&&ot)&&(ft.initPTS=gt-st,ct&&ct.timescale===1&&logger.warn(`Adjusting initPTS by ${ft.initPTS-ct.baseTime}`),this.initPTS=ct={baseTime:ft.initPTS,timescale:1});const bt=_e?gt-ct.baseTime/ct.timescale:ut,Tt=bt+mt;offsetStartDTS(pt,dt,ct.baseTime/ct.timescale),mt>0?this.lastEndTime=Tt:(logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const wt=!!pt.audio,Rt=!!pt.video;let It="";wt&&(It+="audio"),Rt&&(It+="video");const Lt={data1:dt,startPTS:bt,startDTS:bt,endPTS:Tt,endDTS:Tt,type:It,hasAudio:wt,hasVideo:Rt,nb:1,dropped:0};return ht.audio=Lt.type==="audio"?Lt:void 0,ht.video=Lt.type!=="audio"?Lt:void 0,ht.initSegment=ft,ht.id3=flushTextTrackMetadataCueSamples(rt,st,ct,ct),it.samples.length&&(ht.text=flushTextTrackUserdataCueSamples(it,st,ct)),ht}}function isInvalidInitPts(nt,_e,et,rt){if(nt===null)return!0;const it=Math.max(rt,1),st=_e-nt.baseTime/nt.timescale;return Math.abs(st-et)>it}function getParsedTrackCodec(nt,_e){const et=nt==null?void 0:nt.codec;if(et&&et.length>4)return et;if(_e===ElementaryStreamTypes.AUDIO){if(et==="ec-3"||et==="ac-3"||et==="alac")return et;if(et==="fLaC"||et==="Opus")return getCodecCompatibleName(et,!1);const rt="mp4a.40.5";return logger.info(`Parsed audio codec "${et}" or audio object type not handled. Using "${rt}"`),rt}return logger.warn(`Unhandled video codec "${et}"`),et==="hvc1"||et==="hev1"?"hvc1.1.6.L120.90":et==="av01"?"av01.0.04M.08":"avc1.42e01e"}let now$3;try{now$3=self.performance.now.bind(self.performance)}catch{logger.debug("Unable to use Performance API on this environment"),now$3=optionalSelf==null?void 0:optionalSelf.Date.now}const muxConfig=[{demux:MP4Demuxer,remux:PassThroughRemuxer},{demux:TSDemuxer,remux:MP4Remuxer},{demux:AACDemuxer,remux:MP4Remuxer},{demux:MP3Demuxer,remux:MP4Remuxer}];muxConfig.splice(2,0,{demux:AC3Demuxer,remux:MP4Remuxer});class Transmuxer{constructor(_e,et,rt,it,st){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=_e,this.typeSupported=et,this.config=rt,this.vendor=it,this.id=st}configure(_e){this.transmuxConfig=_e,this.decrypter&&this.decrypter.reset()}push(_e,et,rt,it){const st=rt.transmuxing;st.executeStart=now$3();let ot=new Uint8Array(_e);const{currentTransmuxState:at,transmuxConfig:lt}=this;it&&(this.currentTransmuxState=it);const{contiguous:ct,discontinuity:ut,trackSwitch:ht,accurateTimeOffset:dt,timeOffset:ft,initSegmentChange:pt}=it||at,{audioCodec:mt,videoCodec:At,defaultInitPts:gt,duration:bt,initSegmentData:Tt}=lt,wt=getEncryptionType(ot,et);if(wt&&wt.method==="AES-128"){const $t=this.getDecrypter();if($t.isSync()){let kt=$t.softwareDecrypt(ot,wt.key.buffer,wt.iv.buffer);if(rt.part>-1&&(kt=$t.flush()),!kt)return st.executeEnd=now$3(),emptyResult(rt);ot=new Uint8Array(kt)}else return this.decryptionPromise=$t.webCryptoDecrypt(ot,wt.key.buffer,wt.iv.buffer).then(kt=>{const Dt=this.push(kt,null,rt);return this.decryptionPromise=null,Dt}),this.decryptionPromise}const Rt=this.needsProbing(ut,ht);if(Rt){const $t=this.configureTransmuxer(ot);if($t)return logger.warn(`[transmuxer] ${$t.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:$t,reason:$t.message}),st.executeEnd=now$3(),emptyResult(rt)}(ut||ht||pt||Rt)&&this.resetInitSegment(Tt,mt,At,bt,et),(ut||pt||Rt)&&this.resetInitialTimestamp(gt),ct||this.resetContiguity();const It=this.transmux(ot,wt,ft,dt,rt),Lt=this.currentTransmuxState;return Lt.contiguous=!0,Lt.discontinuity=!1,Lt.trackSwitch=!1,st.executeEnd=now$3(),It}flush(_e){const et=_e.transmuxing;et.executeStart=now$3();const{decrypter:rt,currentTransmuxState:it,decryptionPromise:st}=this;if(st)return st.then(()=>this.flush(_e));const ot=[],{timeOffset:at}=it;if(rt){const ht=rt.flush();ht&&ot.push(this.push(ht,null,_e))}const{demuxer:lt,remuxer:ct}=this;if(!lt||!ct)return et.executeEnd=now$3(),[emptyResult(_e)];const ut=lt.flush(at);return isPromise(ut)?ut.then(ht=>(this.flushRemux(ot,ht,_e),ot)):(this.flushRemux(ot,ut,_e),ot)}flushRemux(_e,et,rt){const{audioTrack:it,videoTrack:st,id3Track:ot,textTrack:at}=et,{accurateTimeOffset:lt,timeOffset:ct}=this.currentTransmuxState;logger.log(`[transmuxer.ts]: Flushed fragment ${rt.sn}${rt.part>-1?" p: "+rt.part:""} of level ${rt.level}`);const ut=this.remuxer.remux(it,st,ot,at,ct,lt,!0,this.id);_e.push({remuxResult:ut,chunkMeta:rt}),rt.transmuxing.executeEnd=now$3()}resetInitialTimestamp(_e){const{demuxer:et,remuxer:rt}=this;!et||!rt||(et.resetTimeStamp(_e),rt.resetTimeStamp(_e))}resetContiguity(){const{demuxer:_e,remuxer:et}=this;!_e||!et||(_e.resetContiguity(),et.resetNextTimestamp())}resetInitSegment(_e,et,rt,it,st){const{demuxer:ot,remuxer:at}=this;!ot||!at||(ot.resetInitSegment(_e,et,rt,it),at.resetInitSegment(_e,et,rt,st))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(_e,et,rt,it,st){let ot;return et&&et.method==="SAMPLE-AES"?ot=this.transmuxSampleAes(_e,et,rt,it,st):ot=this.transmuxUnencrypted(_e,rt,it,st),ot}transmuxUnencrypted(_e,et,rt,it){const{audioTrack:st,videoTrack:ot,id3Track:at,textTrack:lt}=this.demuxer.demux(_e,et,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(st,ot,at,lt,et,rt,!1,this.id),chunkMeta:it}}transmuxSampleAes(_e,et,rt,it,st){return this.demuxer.demuxSampleAes(_e,et,rt).then(ot=>({remuxResult:this.remuxer.remux(ot.audioTrack,ot.videoTrack,ot.id3Track,ot.textTrack,rt,it,!1,this.id),chunkMeta:st}))}configureTransmuxer(_e){const{config:et,observer:rt,typeSupported:it,vendor:st}=this;let ot;for(let dt=0,ft=muxConfig.length;dt<ft;dt++){var at;if((at=muxConfig[dt].demux)!=null&&at.probe(_e)){ot=muxConfig[dt];break}}if(!ot)return new Error("Failed to find demuxer by probing fragment data");const lt=this.demuxer,ct=this.remuxer,ut=ot.remux,ht=ot.demux;(!ct||!(ct instanceof ut))&&(this.remuxer=new ut(rt,et,it,st)),(!lt||!(lt instanceof ht))&&(this.demuxer=new ht(rt,et,it),this.probe=ht.probe)}needsProbing(_e,et){return!this.demuxer||!this.remuxer||_e||et}getDecrypter(){let _e=this.decrypter;return _e||(_e=this.decrypter=new Decrypter(this.config)),_e}}function getEncryptionType(nt,_e){let et=null;return nt.byteLength>0&&(_e==null?void 0:_e.key)!=null&&_e.iv!==null&&_e.method!=null&&(et=_e),et}const emptyResult=nt=>({remuxResult:{},chunkMeta:nt});function isPromise(nt){return"then"in nt&&nt.then instanceof Function}class TransmuxConfig{constructor(_e,et,rt,it,st){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=_e,this.videoCodec=et,this.initSegmentData=rt,this.duration=it,this.defaultInitPts=st||null}}class TransmuxState{constructor(_e,et,rt,it,st,ot){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=_e,this.contiguous=et,this.accurateTimeOffset=rt,this.trackSwitch=it,this.timeOffset=st,this.initSegmentChange=ot}}var eventemitter3={exports:{}};(function(nt){var _e=Object.prototype.hasOwnProperty,et="~";function rt(){}Object.create&&(rt.prototype=Object.create(null),new rt().__proto__||(et=!1));function it(lt,ct,ut){this.fn=lt,this.context=ct,this.once=ut||!1}function st(lt,ct,ut,ht,dt){if(typeof ut!="function")throw new TypeError("The listener must be a function");var ft=new it(ut,ht||lt,dt),pt=et?et+ct:ct;return lt._events[pt]?lt._events[pt].fn?lt._events[pt]=[lt._events[pt],ft]:lt._events[pt].push(ft):(lt._events[pt]=ft,lt._eventsCount++),lt}function ot(lt,ct){--lt._eventsCount===0?lt._events=new rt:delete lt._events[ct]}function at(){this._events=new rt,this._eventsCount=0}at.prototype.eventNames=function(){var ct=[],ut,ht;if(this._eventsCount===0)return ct;for(ht in ut=this._events)_e.call(ut,ht)&&ct.push(et?ht.slice(1):ht);return Object.getOwnPropertySymbols?ct.concat(Object.getOwnPropertySymbols(ut)):ct},at.prototype.listeners=function(ct){var ut=et?et+ct:ct,ht=this._events[ut];if(!ht)return[];if(ht.fn)return[ht.fn];for(var dt=0,ft=ht.length,pt=new Array(ft);dt<ft;dt++)pt[dt]=ht[dt].fn;return pt},at.prototype.listenerCount=function(ct){var ut=et?et+ct:ct,ht=this._events[ut];return ht?ht.fn?1:ht.length:0},at.prototype.emit=function(ct,ut,ht,dt,ft,pt){var mt=et?et+ct:ct;if(!this._events[mt])return!1;var At=this._events[mt],gt=arguments.length,bt,Tt;if(At.fn){switch(At.once&&this.removeListener(ct,At.fn,void 0,!0),gt){case 1:return At.fn.call(At.context),!0;case 2:return At.fn.call(At.context,ut),!0;case 3:return At.fn.call(At.context,ut,ht),!0;case 4:return At.fn.call(At.context,ut,ht,dt),!0;case 5:return At.fn.call(At.context,ut,ht,dt,ft),!0;case 6:return At.fn.call(At.context,ut,ht,dt,ft,pt),!0}for(Tt=1,bt=new Array(gt-1);Tt<gt;Tt++)bt[Tt-1]=arguments[Tt];At.fn.apply(At.context,bt)}else{var wt=At.length,Rt;for(Tt=0;Tt<wt;Tt++)switch(At[Tt].once&&this.removeListener(ct,At[Tt].fn,void 0,!0),gt){case 1:At[Tt].fn.call(At[Tt].context);break;case 2:At[Tt].fn.call(At[Tt].context,ut);break;case 3:At[Tt].fn.call(At[Tt].context,ut,ht);break;case 4:At[Tt].fn.call(At[Tt].context,ut,ht,dt);break;default:if(!bt)for(Rt=1,bt=new Array(gt-1);Rt<gt;Rt++)bt[Rt-1]=arguments[Rt];At[Tt].fn.apply(At[Tt].context,bt)}}return!0},at.prototype.on=function(ct,ut,ht){return st(this,ct,ut,ht,!1)},at.prototype.once=function(ct,ut,ht){return st(this,ct,ut,ht,!0)},at.prototype.removeListener=function(ct,ut,ht,dt){var ft=et?et+ct:ct;if(!this._events[ft])return this;if(!ut)return ot(this,ft),this;var pt=this._events[ft];if(pt.fn)pt.fn===ut&&(!dt||pt.once)&&(!ht||pt.context===ht)&&ot(this,ft);else{for(var mt=0,At=[],gt=pt.length;mt<gt;mt++)(pt[mt].fn!==ut||dt&&!pt[mt].once||ht&&pt[mt].context!==ht)&&At.push(pt[mt]);At.length?this._events[ft]=At.length===1?At[0]:At:ot(this,ft)}return this},at.prototype.removeAllListeners=function(ct){var ut;return ct?(ut=et?et+ct:ct,this._events[ut]&&ot(this,ut)):(this._events=new rt,this._eventsCount=0),this},at.prototype.off=at.prototype.removeListener,at.prototype.addListener=at.prototype.on,at.prefixed=et,at.EventEmitter=at,nt.exports=at})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);class TransmuxerInterface{constructor(_e,et,rt,it){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const st=_e.config;this.hls=_e,this.id=et,this.useWorker=!!st.enableWorker,this.onTransmuxComplete=rt,this.onFlush=it;const ot=(ct,ut)=>{ut=ut||{},ut.frag=this.frag,ut.id=this.id,ct===Events.ERROR&&(this.error=ut.error),this.hls.trigger(ct,ut)};this.observer=new EventEmitter,this.observer.on(Events.FRAG_DECRYPTED,ot),this.observer.on(Events.ERROR,ot);const at=getMediaSource(st.preferManagedMediaSource)||{isTypeSupported:()=>!1},lt={mpeg:at.isTypeSupported("audio/mpeg"),mp3:at.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:at.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(st.workerPath||hasUMDWorker())){try{st.workerPath?(logger.log(`loading Web Worker ${st.workerPath} for "${et}"`),this.workerContext=loadWorker(st.workerPath)):(logger.log(`injecting Web Worker for "${et}"`),this.workerContext=injectWorker()),this.onwmsg=ht=>this.onWorkerMessage(ht);const{worker:ut}=this.workerContext;ut.addEventListener("message",this.onwmsg),ut.onerror=ht=>{const dt=new Error(`${ht.message}  (${ht.filename}:${ht.lineno})`);st.enableWorker=!1,logger.warn(`Error in "${et}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:dt})},ut.postMessage({cmd:"init",typeSupported:lt,vendor:"",id:et,config:JSON.stringify(st)})}catch(ut){logger.warn(`Error setting up "${et}" Web Worker, fallback to inline`,ut),this.resetWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,lt,st,"",et)}return}this.transmuxer=new Transmuxer(this.observer,lt,st,"",et)}resetWorker(){if(this.workerContext){const{worker:_e,objectURL:et}=this.workerContext;et&&self.URL.revokeObjectURL(et),_e.removeEventListener("message",this.onwmsg),_e.onerror=null,_e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const et=this.transmuxer;et&&(et.destroy(),this.transmuxer=null)}const _e=this.observer;_e&&_e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(_e,et,rt,it,st,ot,at,lt,ct,ut){var ht,dt;ct.transmuxing.start=self.performance.now();const{transmuxer:ft}=this,pt=ot?ot.start:st.start,mt=st.decryptdata,At=this.frag,gt=!(At&&st.cc===At.cc),bt=!(At&&ct.level===At.level),Tt=At?ct.sn-At.sn:-1,wt=this.part?ct.part-this.part.index:-1,Rt=Tt===0&&ct.id>1&&ct.id===(At==null?void 0:At.stats.chunkCount),It=!bt&&(Tt===1||Tt===0&&(wt===1||Rt&&wt<=0)),Lt=self.performance.now();(bt||Tt||st.stats.parsing.start===0)&&(st.stats.parsing.start=Lt),ot&&(wt||!It)&&(ot.stats.parsing.start=Lt);const $t=!(At&&((ht=st.initSegment)==null?void 0:ht.url)===((dt=At.initSegment)==null?void 0:dt.url)),kt=new TransmuxState(gt,It,lt,bt,pt,$t);if(!It||gt||$t){logger.log(`[transmuxer-interface, ${st.type}]: Starting new transmux session for sn: ${ct.sn} p: ${ct.part} level: ${ct.level} id: ${ct.id}
        discontinuity: ${gt}
        trackSwitch: ${bt}
        contiguous: ${It}
        accurateTimeOffset: ${lt}
        timeOffset: ${pt}
        initSegmentChange: ${$t}`);const Dt=new TransmuxConfig(rt,it,et,at,ut);this.configureTransmuxer(Dt)}if(this.frag=st,this.part=ot,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:_e,decryptdata:mt,chunkMeta:ct,state:kt},_e instanceof ArrayBuffer?[_e]:[]);else if(ft){const Dt=ft.push(_e,mt,ct,kt);isPromise(Dt)?(ft.async=!0,Dt.then(Ot=>{this.handleTransmuxComplete(Ot)}).catch(Ot=>{this.transmuxerError(Ot,ct,"transmuxer-interface push error")})):(ft.async=!1,this.handleTransmuxComplete(Dt))}}flush(_e){_e.transmuxing.start=self.performance.now();const{transmuxer:et}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:_e});else if(et){let rt=et.flush(_e);isPromise(rt)||et.async?(isPromise(rt)||(rt=Promise.resolve(rt)),rt.then(st=>{this.handleFlushResult(st,_e)}).catch(st=>{this.transmuxerError(st,_e,"transmuxer-interface flush error")})):this.handleFlushResult(rt,_e)}}transmuxerError(_e,et,rt){this.hls&&(this.error=_e,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:et,frag:this.frag||void 0,fatal:!1,error:_e,err:_e,reason:rt}))}handleFlushResult(_e,et){_e.forEach(rt=>{this.handleTransmuxComplete(rt)}),this.onFlush(et)}onWorkerMessage(_e){const et=_e.data;if(!(et!=null&&et.event)){logger.warn(`worker message received with no ${et?"event name":"data"}`);return}const rt=this.hls;if(this.hls)switch(et.event){case"init":{var it;const st=(it=this.workerContext)==null?void 0:it.objectURL;st&&self.URL.revokeObjectURL(st);break}case"transmuxComplete":{this.handleTransmuxComplete(et.data);break}case"flush":{this.onFlush(et.data);break}case"workerLog":logger[et.data.logType]&&logger[et.data.logType](et.data.message);break;default:{et.data=et.data||{},et.data.frag=this.frag,et.data.id=this.id,rt.trigger(et.event,et.data);break}}}configureTransmuxer(_e){const{transmuxer:et}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:_e}):et&&et.configure(_e)}handleTransmuxComplete(_e){_e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(_e)}}function subtitleOptionsIdentical(nt,_e){if(nt.length!==_e.length)return!1;for(let et=0;et<nt.length;et++)if(!mediaAttributesIdentical(nt[et].attrs,_e[et].attrs))return!1;return!0}function mediaAttributesIdentical(nt,_e,et){const rt=nt["STABLE-RENDITION-ID"];return rt&&!et?rt===_e["STABLE-RENDITION-ID"]:!(et||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(it=>nt[it]!==_e[it])}function subtitleTrackMatchesTextTrack(nt,_e){return _e.label.toLowerCase()===nt.name.toLowerCase()&&(!_e.language||_e.language.toLowerCase()===(nt.lang||"").toLowerCase())}const TICK_INTERVAL$2=100;class AudioStreamController extends BaseStreamController{constructor(_e,et,rt){super(_e,et,rt,"[audio-stream-controller]",PlaylistLevelType.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:_e}=this;_e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),_e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),_e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),_e.on(Events.ERROR,this.onError,this),_e.on(Events.BUFFER_RESET,this.onBufferReset,this),_e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),_e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),_e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),_e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),_e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),_e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),_e.off(Events.ERROR,this.onError,this),_e.off(Events.BUFFER_RESET,this.onBufferReset,this),_e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),_e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),_e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),_e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(_e,{frag:et,id:rt,initPTS:it,timescale:st}){if(rt==="main"){const ot=et.cc;this.initPTS[et.cc]={baseTime:it,timescale:st},this.log(`InitPTS for cc: ${ot} found from main: ${it}`),this.videoTrackCC=ot,this.state===State.WAITING_INIT_PTS&&this.tick()}}startLoad(_e){if(!this.levels){this.startPosition=_e,this.state=State.STOPPED;return}const et=this.lastCurrentTime;this.stopLoad(),this.setInterval(TICK_INTERVAL$2),et>0&&_e===-1?(this.log(`Override startPosition with lastCurrentTime @${et.toFixed(3)}`),_e=et,this.state=State.IDLE):(this.loadedmetadata=!1,this.state=State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=_e,this.tick()}doTick(){switch(this.state){case State.IDLE:this.doTickIdle();break;case State.WAITING_TRACK:{var _e;const{levels:rt,trackId:it}=this,st=rt==null||(_e=rt[it])==null?void 0:_e.details;if(st){if(this.waitForCdnTuneIn(st))break;this.state=State.WAITING_INIT_PTS}break}case State.FRAG_LOADING_WAITING_RETRY:{var et;const rt=performance.now(),it=this.retryDate;if(!it||rt>=it||(et=this.media)!=null&&et.seeking){const{levels:st,trackId:ot}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((st==null?void 0:st[ot])||null),this.state=State.IDLE}break}case State.WAITING_INIT_PTS:{const rt=this.waitingData;if(rt){const{frag:it,part:st,cache:ot,complete:at}=rt;if(this.initPTS[it.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=State.FRAG_LOADING;const lt=ot.flush(),ct={frag:it,part:st,payload:lt,networkDetails:null};this._handleFragmentLoadProgress(ct),at&&super._handleFragmentLoadComplete(ct)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${it.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const lt=this.getLoadPosition(),ct=BufferHelper.bufferInfo(this.mediaBuffer,lt,this.config.maxBufferHole);fragmentWithinToleranceTest(ct.end,this.config.maxFragLookUpTolerance,it)<0&&(this.log(`Waiting fragment cc (${it.cc}) @ ${it.start} cancelled because another fragment at ${ct.end} is needed`),this.clearWaitingFragment())}}else this.state=State.IDLE}}this.onTickEnd()}clearWaitingFragment(){const _e=this.waitingData;_e&&(this.fragmentTracker.removeFragment(_e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=State.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:_e}=this;_e!=null&&_e.readyState&&(this.lastCurrentTime=_e.currentTime)}doTickIdle(){const{hls:_e,levels:et,media:rt,trackId:it}=this,st=_e.config;if(!rt&&(this.startFragRequested||!st.startFragPrefetch)||!(et!=null&&et[it]))return;const ot=et[it],at=ot.details;if(!at||at.live&&this.levelLastLoaded!==ot||this.waitForCdnTuneIn(at)){this.state=State.WAITING_TRACK;return}const lt=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&lt&&(this.bufferFlushed=!1,this.afterBufferFlushed(lt,ElementaryStreamTypes.AUDIO,PlaylistLevelType.AUDIO));const ct=this.getFwdBufferInfo(lt,PlaylistLevelType.AUDIO);if(ct===null)return;const{bufferedTrack:ut,switchingTrack:ht}=this;if(!ht&&this._streamEnded(ct,at)){_e.trigger(Events.BUFFER_EOS,{type:"audio"}),this.state=State.ENDED;return}const dt=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,PlaylistLevelType.MAIN),ft=ct.len,pt=this.getMaxBufferLength(dt==null?void 0:dt.len),mt=at.fragments,At=mt[0].start;let gt=this.flushing?this.getLoadPosition():ct.end;if(ht&&rt){const Rt=this.getLoadPosition();ut&&!mediaAttributesIdentical(ht.attrs,ut.attrs)&&(gt=Rt),at.PTSKnown&&Rt<At&&(ct.end>At||ct.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),rt.currentTime=At+.05)}if(ft>=pt&&!ht&&gt<mt[mt.length-1].start)return;let bt=this.getNextFragment(gt,at),Tt=!1;if(bt&&this.isLoopLoading(bt,gt)&&(Tt=!!bt.gap,bt=this.getNextFragmentLoopLoading(bt,at,ct,PlaylistLevelType.MAIN,pt)),!bt){this.bufferFlushed=!0;return}const wt=dt&&bt.start>dt.end+at.targetduration;if(wt||!(dt!=null&&dt.len)&&ct.len){const Rt=this.getAppendedFrag(bt.start,PlaylistLevelType.MAIN);if(Rt===null||(Tt||(Tt=!!Rt.gap||!!wt&&dt.len===0),wt&&!Tt||Tt&&ct.nextStart&&ct.nextStart<Rt.end))return}this.loadFragment(bt,ot,gt)}getMaxBufferLength(_e){const et=super.getMaxBufferLength();return _e?Math.min(Math.max(et,_e),this.config.maxMaxBufferLength):et}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(_e,{audioTracks:et}){this.resetTransmuxer(),this.levels=et.map(rt=>new Level(rt))}onAudioTrackSwitching(_e,et){const rt=!!et.url;this.trackId=et.id;const{fragCurrent:it}=this;it&&(it.abortRequests(),this.removeUnbufferedFrags(it.start)),this.resetLoadingState(),rt?this.setInterval(TICK_INTERVAL$2):this.resetTransmuxer(),rt?(this.switchingTrack=et,this.state=State.IDLE,this.flushAudioIfNeeded(et)):(this.switchingTrack=null,this.bufferedTrack=et,this.state=State.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(_e,et){this.mainDetails=et.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(_e,et){var rt;if(this.mainDetails==null){this.cachedTrackLoadedData=et;return}const{levels:it}=this,{details:st,id:ot}=et;if(!it){this.warn(`Audio tracks were reset while loading level ${ot}`);return}this.log(`Audio track ${ot} loaded [${st.startSN},${st.endSN}]${st.lastPartSn?`[part-${st.lastPartSn}-${st.lastPartIndex}]`:""},duration:${st.totalduration}`);const at=it[ot];let lt=0;if(st.live||(rt=at.details)!=null&&rt.live){this.checkLiveUpdate(st);const ut=this.mainDetails;if(st.deltaUpdateFailed||!ut)return;if(!at.details&&st.hasProgramDateTime&&ut.hasProgramDateTime)alignMediaPlaylistByPDT(st,ut),lt=st.fragments[0].start;else{var ct;lt=this.alignPlaylists(st,at.details,(ct=this.levelLastLoaded)==null?void 0:ct.details)}}at.details=st,this.levelLastLoaded=at,!this.startFragRequested&&(this.mainDetails||!st.live)&&this.setStartPosition(this.mainDetails||st,lt),this.state===State.WAITING_TRACK&&!this.waitForCdnTuneIn(st)&&(this.state=State.IDLE),this.tick()}_handleFragmentLoadProgress(_e){var et;const{frag:rt,part:it,payload:st}=_e,{config:ot,trackId:at,levels:lt}=this;if(!lt){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${rt.sn} of level ${rt.level} will not be buffered`);return}const ct=lt[at];if(!ct){this.warn("Audio track is undefined on fragment load progress");return}const ut=ct.details;if(!ut){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(rt.start);return}const ht=ot.defaultAudioCodec||ct.audioCodec||"mp4a.40.2";let dt=this.transmuxer;dt||(dt=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const ft=this.initPTS[rt.cc],pt=(et=rt.initSegment)==null?void 0:et.data;if(ft!==void 0){const At=it?it.index:-1,gt=At!==-1,bt=new ChunkMetadata(rt.level,rt.sn,rt.stats.chunkCount,st.byteLength,At,gt);dt.push(st,pt,ht,"",rt,it,ut.totalduration,!1,bt,ft)}else{this.log(`Unknown video PTS for cc ${rt.cc}, waiting for video PTS before demuxing audio frag ${rt.sn} of [${ut.startSN} ,${ut.endSN}],track ${at}`);const{cache:mt}=this.waitingData=this.waitingData||{frag:rt,part:it,cache:new ChunkCache,complete:!1};mt.push(new Uint8Array(st)),this.waitingVideoCC=this.videoTrackCC,this.state=State.WAITING_INIT_PTS}}_handleFragmentLoadComplete(_e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(_e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(_e,et){const rt=et.tracks.audio;rt&&(this.mediaBuffer=rt.buffer||null),et.tracks.video&&(this.videoBuffer=et.tracks.video.buffer||null)}onFragBuffered(_e,et){const{frag:rt,part:it}=et;if(rt.type!==PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&rt.type===PlaylistLevelType.MAIN){const st=this.videoBuffer||this.media;st&&BufferHelper.getBuffered(st).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(rt)){this.warn(`Fragment ${rt.sn}${it?" p: "+it.index:""} of level ${rt.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(rt.sn!=="initSegment"){this.fragPrevious=rt;const st=this.switchingTrack;st&&(this.bufferedTrack=st,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2$3({},st)))}this.fragBufferedComplete(rt,it)}onError(_e,et){var rt;if(et.fatal){this.state=State.ERROR;return}switch(et.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.AUDIO,et);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!et.levelRetry&&this.state===State.WAITING_TRACK&&((rt=et.context)==null?void 0:rt.type)===PlaylistContextType.AUDIO_TRACK&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:if(!et.parent||et.parent!=="audio")return;if(et.details===ErrorDetails.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(et)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(et);break}}onBufferFlushing(_e,{type:et}){et!==ElementaryStreamTypes.VIDEO&&(this.flushing=!0)}onBufferFlushed(_e,{type:et}){if(et!==ElementaryStreamTypes.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===State.ENDED&&(this.state=State.IDLE);const rt=this.mediaBuffer||this.media;rt&&(this.afterBufferFlushed(rt,et,PlaylistLevelType.AUDIO),this.tick())}}_handleTransmuxComplete(_e){var et;const rt="audio",{hls:it}=this,{remuxResult:st,chunkMeta:ot}=_e,at=this.getCurrentContext(ot);if(!at){this.resetWhenMissingContext(ot);return}const{frag:lt,part:ct,level:ut}=at,{details:ht}=ut,{audio:dt,text:ft,id3:pt,initSegment:mt}=st;if(this.fragContextChanged(lt)||!ht){this.fragmentTracker.removeFragment(lt);return}if(this.state=State.PARSING,this.switchingTrack&&dt&&this.completeAudioSwitch(this.switchingTrack),mt!=null&&mt.tracks){const At=lt.initSegment||lt;this._bufferInitSegment(ut,mt.tracks,At,ot),it.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:At,id:rt,tracks:mt.tracks})}if(dt){const{startPTS:At,endPTS:gt,startDTS:bt,endDTS:Tt}=dt;ct&&(ct.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:At,endPTS:gt,startDTS:bt,endDTS:Tt}),lt.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,At,gt,bt,Tt),this.bufferFragmentData(dt,lt,ct,ot)}if(pt!=null&&(et=pt.samples)!=null&&et.length){const At=_extends$1({id:rt,frag:lt,details:ht},pt);it.trigger(Events.FRAG_PARSING_METADATA,At)}if(ft){const At=_extends$1({id:rt,frag:lt,details:ht},ft);it.trigger(Events.FRAG_PARSING_USERDATA,At)}}_bufferInitSegment(_e,et,rt,it){if(this.state!==State.PARSING)return;et.video&&delete et.video;const st=et.audio;if(!st)return;st.id="audio";const ot=_e.audioCodec;this.log(`Init audio buffer, container:${st.container}, codecs[level/parsed]=[${ot}/${st.codec}]`),ot&&ot.split(",").length===1&&(st.levelCodec=ot),this.hls.trigger(Events.BUFFER_CODECS,et);const at=st.initSegment;if(at!=null&&at.byteLength){const lt={type:"audio",frag:rt,part:null,chunkMeta:it,parent:rt.type,data:at};this.hls.trigger(Events.BUFFER_APPENDING,lt)}this.tickImmediate()}loadFragment(_e,et,rt){const it=this.fragmentTracker.getState(_e);if(this.fragCurrent=_e,this.switchingTrack||it===FragmentState.NOT_LOADED||it===FragmentState.PARTIAL){var st;if(_e.sn==="initSegment")this._loadInitSegment(_e,et);else if((st=et.details)!=null&&st.live&&!this.initPTS[_e.cc]){this.log(`Waiting for video PTS in continuity counter ${_e.cc} of live stream before loading audio fragment ${_e.sn} of level ${this.trackId}`),this.state=State.WAITING_INIT_PTS;const ot=this.mainDetails;ot&&ot.fragments[0].start!==et.details.fragments[0].start&&alignMediaPlaylistByPDT(et.details,ot)}else this.startFragRequested=!0,super.loadFragment(_e,et,rt)}else this.clearTrackerIfNeeded(_e)}flushAudioIfNeeded(_e){const{media:et,bufferedTrack:rt}=this,it=rt==null?void 0:rt.attrs,st=_e.attrs;et&&it&&(it.CHANNELS!==st.CHANNELS||rt.name!==_e.name||rt.lang!==_e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(_e){const{hls:et}=this;this.flushAudioIfNeeded(_e),this.bufferedTrack=_e,this.switchingTrack=null,et.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2$3({},_e))}}class AudioTrackController extends BasePlaylistController{constructor(_e){super(_e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:_e}=this;_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),_e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:_e}=this;_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),_e.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(_e,et){this.tracks=et.audioTracks||[]}onAudioTrackLoaded(_e,et){const{id:rt,groupId:it,details:st}=et,ot=this.tracksInGroup[rt];if(!ot||ot.groupId!==it){this.warn(`Audio track with id:${rt} and group:${it} not found in active group ${ot==null?void 0:ot.groupId}`);return}const at=ot.details;ot.details=et.details,this.log(`Audio track ${rt} "${ot.name}" lang:${ot.lang} group:${it} loaded [${st.startSN}-${st.endSN}]`),rt===this.trackId&&this.playlistLoaded(rt,et,at)}onLevelLoading(_e,et){this.switchLevel(et.level)}onLevelSwitching(_e,et){this.switchLevel(et.level)}switchLevel(_e){const et=this.hls.levels[_e];if(!et)return;const rt=et.audioGroups||null,it=this.groupIds;let st=this.currentTrack;if(!rt||(it==null?void 0:it.length)!==(rt==null?void 0:rt.length)||rt!=null&&rt.some(at=>(it==null?void 0:it.indexOf(at))===-1)){this.groupIds=rt,this.trackId=-1,this.currentTrack=null;const at=this.tracks.filter(dt=>!rt||rt.indexOf(dt.groupId)!==-1);if(at.length)this.selectDefaultTrack&&!at.some(dt=>dt.default)&&(this.selectDefaultTrack=!1),at.forEach((dt,ft)=>{dt.id=ft});else if(!st&&!this.tracksInGroup.length)return;this.tracksInGroup=at;const lt=this.hls.config.audioPreference;if(!st&&lt){const dt=findMatchingOption(lt,at,audioMatchPredicate);if(dt>-1)st=at[dt];else{const ft=findMatchingOption(lt,this.tracks);st=this.tracks[ft]}}let ct=this.findTrackId(st);ct===-1&&st&&(ct=this.findTrackId(null));const ut={audioTracks:at};this.log(`Updating audio tracks, ${at.length} track(s) found in group(s): ${rt==null?void 0:rt.join(",")}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,ut);const ht=this.trackId;if(ct!==-1&&ht===-1)this.setAudioTrack(ct);else if(at.length&&ht===-1){var ot;const dt=new Error(`No audio track selected for current audio group-ID(s): ${(ot=this.groupIds)==null?void 0:ot.join(",")} track count: ${at.length}`);this.warn(dt.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:dt})}}else this.shouldReloadPlaylist(st)&&this.setAudioTrack(this.trackId)}onError(_e,et){et.fatal||!et.context||et.context.type===PlaylistContextType.AUDIO_TRACK&&et.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(et.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(et))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(_e){this.selectDefaultTrack=!1,this.setAudioTrack(_e)}setAudioOption(_e){const et=this.hls;if(et.config.audioPreference=_e,_e){const rt=this.allAudioTracks;if(this.selectDefaultTrack=!1,rt.length){const it=this.currentTrack;if(it&&matchesOption(_e,it,audioMatchPredicate))return it;const st=findMatchingOption(_e,this.tracksInGroup,audioMatchPredicate);if(st>-1){const ot=this.tracksInGroup[st];return this.setAudioTrack(st),ot}else if(it){let ot=et.loadLevel;ot===-1&&(ot=et.firstAutoLevel);const at=findClosestLevelWithAudioGroup(_e,et.levels,rt,ot,audioMatchPredicate);if(at===-1)return null;et.nextLoadLevel=at}if(_e.channels||_e.audioCodec){const ot=findMatchingOption(_e,rt);if(ot>-1)return rt[ot]}}}return null}setAudioTrack(_e){const et=this.tracksInGroup;if(_e<0||_e>=et.length){this.warn(`Invalid audio track id: ${_e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const rt=this.currentTrack,it=et[_e],st=it.details&&!it.details.live;if(_e===this.trackId&&it===rt&&st||(this.log(`Switching to audio-track ${_e} "${it.name}" lang:${it.lang} group:${it.groupId} channels:${it.channels}`),this.trackId=_e,this.currentTrack=it,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2$3({},it)),st))return;const ot=this.switchParams(it.url,rt==null?void 0:rt.details,it.details);this.loadPlaylist(ot)}findTrackId(_e){const et=this.tracksInGroup;for(let rt=0;rt<et.length;rt++){const it=et[rt];if(!(this.selectDefaultTrack&&!it.default)&&(!_e||matchesOption(_e,it,audioMatchPredicate)))return rt}if(_e){const{name:rt,lang:it,assocLang:st,characteristics:ot,audioCodec:at,channels:lt}=_e;for(let ct=0;ct<et.length;ct++){const ut=et[ct];if(matchesOption({name:rt,lang:it,assocLang:st,characteristics:ot,audioCodec:at,channels:lt},ut,audioMatchPredicate))return ct}for(let ct=0;ct<et.length;ct++){const ut=et[ct];if(mediaAttributesIdentical(_e.attrs,ut.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return ct}for(let ct=0;ct<et.length;ct++){const ut=et[ct];if(mediaAttributesIdentical(_e.attrs,ut.attrs,["LANGUAGE"]))return ct}}return-1}loadPlaylist(_e){const et=this.currentTrack;if(this.shouldLoadPlaylist(et)&&et){super.loadPlaylist();const rt=et.id,it=et.groupId;let st=et.url;if(_e)try{st=_e.addDirectives(st)}catch(ot){this.warn(`Could not construct new URL with HLS Delivery Directives: ${ot}`)}this.log(`loading audio-track playlist ${rt} "${et.name}" lang:${et.lang} group:${it}`),this.clearTimer(),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url:st,id:rt,groupId:it,deliveryDirectives:_e||null})}}}const TICK_INTERVAL$1=500;class SubtitleStreamController extends BaseStreamController{constructor(_e,et,rt){super(_e,et,rt,"[subtitle-stream-controller]",PlaylistLevelType.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:_e}=this;_e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.on(Events.ERROR,this.onError,this),_e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),_e.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),_e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),_e.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),_e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.off(Events.ERROR,this.onError,this),_e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),_e.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),_e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),_e.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),_e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(_e){this.stopLoad(),this.state=State.IDLE,this.setInterval(TICK_INTERVAL$1),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=_e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(_e,et){this.mainDetails=et.details}onSubtitleFragProcessed(_e,et){const{frag:rt,success:it}=et;if(this.fragPrevious=rt,this.state=State.IDLE,!it)return;const st=this.tracksBuffered[this.currentTrackId];if(!st)return;let ot;const at=rt.start;for(let ct=0;ct<st.length;ct++)if(at>=st[ct].start&&at<=st[ct].end){ot=st[ct];break}const lt=rt.start+rt.duration;ot?ot.end=lt:(ot={start:at,end:lt},st.push(ot)),this.fragmentTracker.fragBuffered(rt),this.fragBufferedComplete(rt,null)}onBufferFlushing(_e,et){const{startOffset:rt,endOffset:it}=et;if(rt===0&&it!==Number.POSITIVE_INFINITY){const st=it-1;if(st<=0)return;et.endOffsetSubtitles=Math.max(0,st),this.tracksBuffered.forEach(ot=>{for(let at=0;at<ot.length;){if(ot[at].end<=st){ot.shift();continue}else if(ot[at].start<st)ot[at].start=st;else break;at++}}),this.fragmentTracker.removeFragmentsInRange(rt,st,PlaylistLevelType.SUBTITLE)}}onFragBuffered(_e,et){if(!this.loadedmetadata&&et.frag.type===PlaylistLevelType.MAIN){var rt;(rt=this.media)!=null&&rt.buffered.length&&(this.loadedmetadata=!0)}}onError(_e,et){const rt=et.frag;(rt==null?void 0:rt.type)===PlaylistLevelType.SUBTITLE&&(et.details===ErrorDetails.FRAG_GAP&&this.fragmentTracker.fragBuffered(rt,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State.STOPPED&&(this.state=State.IDLE))}onSubtitleTracksUpdated(_e,{subtitleTracks:et}){if(this.levels&&subtitleOptionsIdentical(this.levels,et)){this.levels=et.map(rt=>new Level(rt));return}this.tracksBuffered=[],this.levels=et.map(rt=>{const it=new Level(rt);return this.tracksBuffered[it.id]=[],it}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(_e,et){var rt;if(this.currentTrackId=et.id,!((rt=this.levels)!=null&&rt.length)||this.currentTrackId===-1){this.clearInterval();return}const it=this.levels[this.currentTrackId];it!=null&&it.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,it&&this.setInterval(TICK_INTERVAL$1)}onSubtitleTrackLoaded(_e,et){var rt;const{currentTrackId:it,levels:st}=this,{details:ot,id:at}=et;if(!st){this.warn(`Subtitle tracks were reset while loading level ${at}`);return}const lt=st[at];if(at>=st.length||!lt)return;this.log(`Subtitle track ${at} loaded [${ot.startSN},${ot.endSN}]${ot.lastPartSn?`[part-${ot.lastPartSn}-${ot.lastPartIndex}]`:""},duration:${ot.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let ct=0;if(ot.live||(rt=lt.details)!=null&&rt.live){const ht=this.mainDetails;if(ot.deltaUpdateFailed||!ht)return;const dt=ht.fragments[0];if(!lt.details)ot.hasProgramDateTime&&ht.hasProgramDateTime?(alignMediaPlaylistByPDT(ot,ht),ct=ot.fragments[0].start):dt&&(ct=dt.start,addSliding(ot,ct));else{var ut;ct=this.alignPlaylists(ot,lt.details,(ut=this.levelLastLoaded)==null?void 0:ut.details),ct===0&&dt&&(ct=dt.start,addSliding(ot,ct))}}lt.details=ot,this.levelLastLoaded=lt,at===it&&(!this.startFragRequested&&(this.mainDetails||!ot.live)&&this.setStartPosition(this.mainDetails||ot,ct),this.tick(),ot.live&&!this.fragCurrent&&this.media&&this.state===State.IDLE&&(findFragmentByPTS(null,ot.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),lt.details=void 0)))}_handleFragmentLoadComplete(_e){const{frag:et,payload:rt}=_e,it=et.decryptdata,st=this.hls;if(!this.fragContextChanged(et)&&rt&&rt.byteLength>0&&it!=null&&it.key&&it.iv&&it.method==="AES-128"){const ot=performance.now();this.decrypter.decrypt(new Uint8Array(rt),it.key.buffer,it.iv.buffer).catch(at=>{throw st.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:at,reason:at.message,frag:et}),at}).then(at=>{const lt=performance.now();st.trigger(Events.FRAG_DECRYPTED,{frag:et,payload:at,stats:{tstart:ot,tdecrypt:lt}})}).catch(at=>{this.warn(`${at.name}: ${at.message}`),this.state=State.IDLE})}}doTick(){if(!this.media){this.state=State.IDLE;return}if(this.state===State.IDLE){const{currentTrackId:_e,levels:et}=this,rt=et==null?void 0:et[_e];if(!rt||!et.length||!rt.details)return;const{config:it}=this,st=this.getLoadPosition(),ot=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],st,it.maxBufferHole),{end:at,len:lt}=ot,ct=this.getFwdBufferInfo(this.media,PlaylistLevelType.MAIN),ut=rt.details,ht=this.getMaxBufferLength(ct==null?void 0:ct.len)+ut.levelTargetDuration;if(lt>ht)return;const dt=ut.fragments,ft=dt.length,pt=ut.edge;let mt=null;const At=this.fragPrevious;if(at<pt){const gt=it.maxFragLookUpTolerance,bt=at>pt-gt?0:gt;mt=findFragmentByPTS(At,dt,Math.max(dt[0].start,at),bt),!mt&&At&&At.start<dt[0].start&&(mt=dt[0])}else mt=dt[ft-1];if(!mt)return;if(mt=this.mapToInitFragWhenRequired(mt),mt.sn!=="initSegment"){const gt=mt.sn-ut.startSN,bt=dt[gt-1];bt&&bt.cc===mt.cc&&this.fragmentTracker.getState(bt)===FragmentState.NOT_LOADED&&(mt=bt)}this.fragmentTracker.getState(mt)===FragmentState.NOT_LOADED&&this.loadFragment(mt,rt,at)}}getMaxBufferLength(_e){const et=super.getMaxBufferLength();return _e?Math.max(et,_e):et}loadFragment(_e,et,rt){this.fragCurrent=_e,_e.sn==="initSegment"?this._loadInitSegment(_e,et):(this.startFragRequested=!0,super.loadFragment(_e,et,rt))}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}}class BufferableInstance{constructor(_e){this.buffered=void 0;const et=(rt,it,st)=>{if(it=it>>>0,it>st-1)throw new DOMException(`Failed to execute '${rt}' on 'TimeRanges': The index provided (${it}) is greater than the maximum bound (${st})`);return _e[it][rt]};this.buffered={get length(){return _e.length},end(rt){return et("end",rt,_e.length)},start(rt){return et("start",rt,_e.length)}}}}class SubtitleTrackController extends BasePlaylistController{constructor(_e){super(_e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let et=null;const rt=filterSubtitleTracks(this.media.textTracks);for(let st=0;st<rt.length;st++)if(rt[st].mode==="hidden")et=rt[st];else if(rt[st].mode==="showing"){et=rt[st];break}const it=this.findTrackForTextTrack(et);this.subtitleTrack!==it&&this.setSubtitleTrack(it)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(_e){this._subtitleDisplay=_e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:_e}=this;_e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),_e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),_e.off(Events.ERROR,this.onError,this)}onMediaAttached(_e,et){this.media=et.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(_e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,_e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),filterSubtitleTracks(this.media.textTracks).forEach(et=>{clearCurrentCues(et)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(_e,et){this.tracks=et.subtitleTracks}onSubtitleTrackLoaded(_e,et){const{id:rt,groupId:it,details:st}=et,ot=this.tracksInGroup[rt];if(!ot||ot.groupId!==it){this.warn(`Subtitle track with id:${rt} and group:${it} not found in active group ${ot==null?void 0:ot.groupId}`);return}const at=ot.details;ot.details=et.details,this.log(`Subtitle track ${rt} "${ot.name}" lang:${ot.lang} group:${it} loaded [${st.startSN}-${st.endSN}]`),rt===this.trackId&&this.playlistLoaded(rt,et,at)}onLevelLoading(_e,et){this.switchLevel(et.level)}onLevelSwitching(_e,et){this.switchLevel(et.level)}switchLevel(_e){const et=this.hls.levels[_e];if(!et)return;const rt=et.subtitleGroups||null,it=this.groupIds;let st=this.currentTrack;if(!rt||(it==null?void 0:it.length)!==(rt==null?void 0:rt.length)||rt!=null&&rt.some(ot=>(it==null?void 0:it.indexOf(ot))===-1)){this.groupIds=rt,this.trackId=-1,this.currentTrack=null;const ot=this.tracks.filter(ut=>!rt||rt.indexOf(ut.groupId)!==-1);if(ot.length)this.selectDefaultTrack&&!ot.some(ut=>ut.default)&&(this.selectDefaultTrack=!1),ot.forEach((ut,ht)=>{ut.id=ht});else if(!st&&!this.tracksInGroup.length)return;this.tracksInGroup=ot;const at=this.hls.config.subtitlePreference;if(!st&&at){this.selectDefaultTrack=!1;const ut=findMatchingOption(at,ot);if(ut>-1)st=ot[ut];else{const ht=findMatchingOption(at,this.tracks);st=this.tracks[ht]}}let lt=this.findTrackId(st);lt===-1&&st&&(lt=this.findTrackId(null));const ct={subtitleTracks:ot};this.log(`Updating subtitle tracks, ${ot.length} track(s) found in "${rt==null?void 0:rt.join(",")}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,ct),lt!==-1&&this.trackId===-1&&this.setSubtitleTrack(lt)}else this.shouldReloadPlaylist(st)&&this.setSubtitleTrack(this.trackId)}findTrackId(_e){const et=this.tracksInGroup,rt=this.selectDefaultTrack;for(let it=0;it<et.length;it++){const st=et[it];if(!(rt&&!st.default||!rt&&!_e)&&(!_e||matchesOption(st,_e)))return it}if(_e){for(let it=0;it<et.length;it++){const st=et[it];if(mediaAttributesIdentical(_e.attrs,st.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return it}for(let it=0;it<et.length;it++){const st=et[it];if(mediaAttributesIdentical(_e.attrs,st.attrs,["LANGUAGE"]))return it}}return-1}findTrackForTextTrack(_e){if(_e){const et=this.tracksInGroup;for(let rt=0;rt<et.length;rt++){const it=et[rt];if(subtitleTrackMatchesTextTrack(it,_e))return rt}}return-1}onError(_e,et){et.fatal||!et.context||et.context.type===PlaylistContextType.SUBTITLE_TRACK&&et.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(et.context.groupId)!==-1)&&this.checkRetry(et)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(_e){this.selectDefaultTrack=!1,this.setSubtitleTrack(_e)}setSubtitleOption(_e){if(this.hls.config.subtitlePreference=_e,_e){const et=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,et.length){const rt=this.currentTrack;if(rt&&matchesOption(_e,rt))return rt;const it=findMatchingOption(_e,this.tracksInGroup);if(it>-1){const st=this.tracksInGroup[it];return this.setSubtitleTrack(it),st}else{if(rt)return null;{const st=findMatchingOption(_e,et);if(st>-1)return et[st]}}}}return null}loadPlaylist(_e){super.loadPlaylist();const et=this.currentTrack;if(this.shouldLoadPlaylist(et)&&et){const rt=et.id,it=et.groupId;let st=et.url;if(_e)try{st=_e.addDirectives(st)}catch(ot){this.warn(`Could not construct new URL with HLS Delivery Directives: ${ot}`)}this.log(`Loading subtitle playlist for id ${rt}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url:st,id:rt,groupId:it,deliveryDirectives:_e||null})}}toggleTrackModes(){const{media:_e}=this;if(!_e)return;const et=filterSubtitleTracks(_e.textTracks),rt=this.currentTrack;let it;if(rt&&(it=et.filter(st=>subtitleTrackMatchesTextTrack(rt,st))[0],it||this.warn(`Unable to find subtitle TextTrack with name "${rt.name}" and language "${rt.lang}"`)),[].slice.call(et).forEach(st=>{st.mode!=="disabled"&&st!==it&&(st.mode="disabled")}),it){const st=this.subtitleDisplay?"showing":"hidden";it.mode!==st&&(it.mode=st)}}setSubtitleTrack(_e){const et=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=_e;return}if(_e<-1||_e>=et.length||!isFiniteNumber(_e)){this.warn(`Invalid subtitle track id: ${_e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const rt=this.currentTrack,it=et[_e]||null;if(this.trackId=_e,this.currentTrack=it,this.toggleTrackModes(),!it){this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:_e});return}const st=!!it.details&&!it.details.live;if(_e===this.trackId&&it===rt&&st)return;this.log(`Switching to subtitle-track ${_e}`+(it?` "${it.name}" lang:${it.lang} group:${it.groupId}`:""));const{id:ot,groupId:at="",name:lt,type:ct,url:ut}=it;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:ot,groupId:at,name:lt,type:ct,url:ut});const ht=this.switchParams(it.url,rt==null?void 0:rt.details,it.details);this.loadPlaylist(ht)}}class BufferOperationQueue{constructor(_e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=_e}append(_e,et,rt){const it=this.queues[et];it.push(_e),it.length===1&&!rt&&this.executeNext(et)}insertAbort(_e,et){this.queues[et].unshift(_e),this.executeNext(et)}appendBlocker(_e){let et;const rt=new Promise(st=>{et=st}),it={execute:et,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(it,_e),rt}executeNext(_e){const et=this.queues[_e];if(et.length){const rt=et[0];try{rt.execute()}catch(it){logger.warn(`[buffer-operation-queue]: Exception executing "${_e}" SourceBuffer operation: ${it}`),rt.onError(it);const st=this.buffers[_e];st!=null&&st.updating||this.shiftAndExecuteNext(_e)}}}shiftAndExecuteNext(_e){this.queues[_e].shift(),this.executeNext(_e)}current(_e){return this.queues[_e][0]}}const VIDEO_CODEC_PROFILE_REPLACE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class BufferController{constructor(_e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=rt=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=rt=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:rt,mediaSource:it}=this;this.log("Media source opened"),rt&&(rt.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media:rt,mediaSource:it})),it&&it.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:rt,_objectUrl:it}=this;rt!==it&&logger.error(`Media element src was set while attaching MediaSource (${it} > ${rt})`)},this.hls=_e;const et="[buffer-controller]";this.appendSource=isManagedMediaSource(getMediaSource(_e.config.preferManagedMediaSource)),this.log=logger.log.bind(logger,et),this.warn=logger.warn.bind(logger,et),this.error=logger.error.bind(logger,et),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:_e}=this;_e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.on(Events.BUFFER_RESET,this.onBufferReset,this),_e.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),_e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),_e.on(Events.BUFFER_EOS,this.onBufferEos,this),_e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),_e.on(Events.FRAG_PARSED,this.onFragParsed,this),_e.on(Events.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.off(Events.BUFFER_RESET,this.onBufferReset,this),_e.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),_e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),_e.off(Events.BUFFER_EOS,this.onBufferEos,this),_e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),_e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),_e.off(Events.FRAG_PARSED,this.onFragParsed,this),_e.off(Events.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new BufferOperationQueue(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(_e,et){let rt=2;(et.audio&&!et.video||!et.altAudio)&&(rt=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=rt,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(_e,et){const rt=this.media=et.media,it=getMediaSource(this.appendSource);if(rt&&it){var st;const ot=this.mediaSource=new it;this.log(`created media source: ${(st=ot.constructor)==null?void 0:st.name}`),ot.addEventListener("sourceopen",this._onMediaSourceOpen),ot.addEventListener("sourceended",this._onMediaSourceEnded),ot.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(ot.addEventListener("startstreaming",this._onStartStreaming),ot.addEventListener("endstreaming",this._onEndStreaming));const at=this._objectUrl=self.URL.createObjectURL(ot);if(this.appendSource)try{rt.removeAttribute("src");const lt=self.ManagedMediaSource;rt.disableRemotePlayback=rt.disableRemotePlayback||lt&&ot instanceof lt,removeSourceChildren(rt),addSource(rt,at),rt.load()}catch{rt.src=at}else rt.src=at;rt.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:_e,mediaSource:et,_objectUrl:rt}=this;if(et){if(this.log("media source detaching"),et.readyState==="open")try{et.endOfStream()}catch(it){this.warn(`onMediaDetaching: ${it.message} while calling endOfStream`)}this.onBufferReset(),et.removeEventListener("sourceopen",this._onMediaSourceOpen),et.removeEventListener("sourceended",this._onMediaSourceEnded),et.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(et.removeEventListener("startstreaming",this._onStartStreaming),et.removeEventListener("endstreaming",this._onEndStreaming)),_e&&(_e.removeEventListener("emptied",this._onMediaEmptied),rt&&self.URL.revokeObjectURL(rt),this.mediaSrc===rt?(_e.removeAttribute("src"),this.appendSource&&removeSourceChildren(_e),_e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(Events.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(_e=>{this.resetBuffer(_e)}),this._initSourceBuffer()}resetBuffer(_e){const et=this.sourceBuffer[_e];try{if(et){var rt;this.removeBufferListeners(_e),this.sourceBuffer[_e]=void 0,(rt=this.mediaSource)!=null&&rt.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(et)}}catch(it){this.warn(`onBufferReset ${_e}`,it)}}onBufferCodecs(_e,et){const rt=this.getSourceBufferTypes().length,it=Object.keys(et);if(it.forEach(ot=>{if(rt){const lt=this.tracks[ot];if(lt&&typeof lt.buffer.changeType=="function"){var at;const{id:ct,codec:ut,levelCodec:ht,container:dt,metadata:ft}=et[ot],pt=pickMostCompleteCodecName(lt.codec,lt.levelCodec),mt=pt==null?void 0:pt.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");let At=pickMostCompleteCodecName(ut,ht);const gt=(at=At)==null?void 0:at.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");if(At&&mt!==gt){ot.slice(0,5)==="audio"&&(At=getCodecCompatibleName(At,this.appendSource));const bt=`${dt};codecs=${At}`;this.appendChangeType(ot,bt),this.log(`switching codec ${pt} to ${At}`),this.tracks[ot]={buffer:lt.buffer,codec:ut,container:dt,levelCodec:ht,metadata:ft,id:ct}}}}else this.pendingTracks[ot]=et[ot]}),rt)return;const st=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==st&&(this.log(`${st} bufferCodec event(s) expected ${it.join(",")}`),this.bufferCodecEventsExpected=st),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(_e,et){const{operationQueue:rt}=this,it={execute:()=>{const st=this.sourceBuffer[_e];st&&(this.log(`changing ${_e} sourceBuffer type to ${et}`),st.changeType(et)),rt.shiftAndExecuteNext(_e)},onStart:()=>{},onComplete:()=>{},onError:st=>{this.warn(`Failed to change ${_e} SourceBuffer type`,st)}};rt.append(it,_e,!!this.pendingTracks[_e])}onBufferAppending(_e,et){const{hls:rt,operationQueue:it,tracks:st}=this,{data:ot,type:at,frag:lt,part:ct,chunkMeta:ut}=et,ht=ut.buffering[at],dt=self.performance.now();ht.start=dt;const ft=lt.stats.buffering,pt=ct?ct.stats.buffering:null;ft.start===0&&(ft.start=dt),pt&&pt.start===0&&(pt.start=dt);const mt=st.audio;let At=!1;at==="audio"&&(mt==null?void 0:mt.container)==="audio/mpeg"&&(At=!this.lastMpegAudioChunk||ut.id===1||this.lastMpegAudioChunk.sn!==ut.sn,this.lastMpegAudioChunk=ut);const gt=lt.start,bt={execute:()=>{if(ht.executeStart=self.performance.now(),At){const Tt=this.sourceBuffer[at];if(Tt){const wt=gt-Tt.timestampOffset;Math.abs(wt)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${gt} (delta: ${wt}) sn: ${lt.sn})`),Tt.timestampOffset=gt)}}this.appendExecutor(ot,at)},onStart:()=>{},onComplete:()=>{const Tt=self.performance.now();ht.executeEnd=ht.end=Tt,ft.first===0&&(ft.first=Tt),pt&&pt.first===0&&(pt.first=Tt);const{sourceBuffer:wt}=this,Rt={};for(const It in wt)Rt[It]=BufferHelper.getBuffered(wt[It]);this.appendErrors[at]=0,at==="audio"||at==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Events.BUFFER_APPENDED,{type:at,frag:lt,part:ct,chunkMeta:ut,parent:lt.type,timeRanges:Rt})},onError:Tt=>{const wt={type:ErrorTypes.MEDIA_ERROR,parent:lt.type,details:ErrorDetails.BUFFER_APPEND_ERROR,sourceBufferName:at,frag:lt,part:ct,chunkMeta:ut,error:Tt,err:Tt,fatal:!1};if(Tt.code===DOMException.QUOTA_EXCEEDED_ERR)wt.details=ErrorDetails.BUFFER_FULL_ERROR;else{const Rt=++this.appendErrors[at];wt.details=ErrorDetails.BUFFER_APPEND_ERROR,this.warn(`Failed ${Rt}/${rt.config.appendErrorMaxRetry} times to append segment in "${at}" sourceBuffer`),Rt>=rt.config.appendErrorMaxRetry&&(wt.fatal=!0)}rt.trigger(Events.ERROR,wt)}};it.append(bt,at,!!this.pendingTracks[at])}onBufferFlushing(_e,et){const{operationQueue:rt}=this,it=st=>({execute:this.removeExecutor.bind(this,st,et.startOffset,et.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type:st})},onError:ot=>{this.warn(`Failed to remove from ${st} SourceBuffer`,ot)}});et.type?rt.append(it(et.type),et.type):this.getSourceBufferTypes().forEach(st=>{rt.append(it(st),st)})}onFragParsed(_e,et){const{frag:rt,part:it}=et,st=[],ot=it?it.elementaryStreams:rt.elementaryStreams;ot[ElementaryStreamTypes.AUDIOVIDEO]?st.push("audiovideo"):(ot[ElementaryStreamTypes.AUDIO]&&st.push("audio"),ot[ElementaryStreamTypes.VIDEO]&&st.push("video"));const at=()=>{const lt=self.performance.now();rt.stats.buffering.end=lt,it&&(it.stats.buffering.end=lt);const ct=it?it.stats:rt.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag:rt,part:it,stats:ct,id:rt.type})};st.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${rt.type} level: ${rt.level} sn: ${rt.sn}`),this.blockBuffers(at,st)}onFragChanged(_e,et){this.trimBuffers()}onBufferEos(_e,et){this.getSourceBufferTypes().reduce((it,st)=>{const ot=this.sourceBuffer[st];return ot&&(!et.type||et.type===st)&&(ot.ending=!0,ot.ended||(ot.ended=!0,this.log(`${st} sourceBuffer now EOS`))),it&&!!(!ot||ot.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(st=>{const ot=this.sourceBuffer[st];ot&&(ot.ending=!1)});const{mediaSource:it}=this;if(!it||it.readyState!=="open"){it&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${it.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),it.endOfStream()}))}onLevelUpdated(_e,{details:et}){et.fragments.length&&(this.details=et,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:_e,details:et,media:rt}=this;if(!rt||et===null||!this.getSourceBufferTypes().length)return;const st=_e.config,ot=rt.currentTime,at=et.levelTargetDuration,lt=et.live&&st.liveBackBufferLength!==null?st.liveBackBufferLength:st.backBufferLength;if(isFiniteNumber(lt)&&lt>0){const ct=Math.max(lt,at),ut=Math.floor(ot/at)*at-ct;this.flushBackBuffer(ot,at,ut)}if(isFiniteNumber(st.frontBufferFlushThreshold)&&st.frontBufferFlushThreshold>0){const ct=Math.max(st.maxBufferLength,st.frontBufferFlushThreshold),ut=Math.max(ct,at),ht=Math.floor(ot/at)*at+ut;this.flushFrontBuffer(ot,at,ht)}}flushBackBuffer(_e,et,rt){const{details:it,sourceBuffer:st}=this;this.getSourceBufferTypes().forEach(at=>{const lt=st[at];if(lt){const ct=BufferHelper.getBuffered(lt);if(ct.length>0&&rt>ct.start(0)){if(this.hls.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:rt}),it!=null&&it.live)this.hls.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:rt});else if(lt.ended&&ct.end(ct.length-1)-_e<et*2){this.log(`Cannot flush ${at} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:rt,type:at})}}})}flushFrontBuffer(_e,et,rt){const{sourceBuffer:it}=this;this.getSourceBufferTypes().forEach(ot=>{const at=it[ot];if(at){const lt=BufferHelper.getBuffered(at),ct=lt.length;if(ct<2)return;const ut=lt.start(ct-1),ht=lt.end(ct-1);if(rt>ut||_e>=ut&&_e<=ht)return;if(at.ended&&_e-ht<2*et){this.log(`Cannot flush ${ot} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:ut,endOffset:1/0,type:ot})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:_e,hls:et,media:rt,mediaSource:it}=this,st=_e.fragments[0].start+_e.totalduration,ot=rt.duration,at=isFiniteNumber(it.duration)?it.duration:0;_e.live&&et.config.liveDurationInfinity?(it.duration=1/0,this.updateSeekableRange(_e)):(st>at&&st>ot||!isFiniteNumber(ot))&&(this.log(`Updating Media Source duration to ${st.toFixed(3)}`),it.duration=st)}updateSeekableRange(_e){const et=this.mediaSource,rt=_e.fragments;if(rt.length&&_e.live&&et!=null&&et.setLiveSeekableRange){const st=Math.max(0,rt[0].start),ot=Math.max(st,st+_e.totalduration);this.log(`Media Source duration is set to ${et.duration}. Setting seekable range to ${st}-${ot}.`),et.setLiveSeekableRange(st,ot)}}checkPendingTracks(){const{bufferCodecEventsExpected:_e,operationQueue:et,pendingTracks:rt}=this,it=Object.keys(rt).length;if(it&&(!_e||it===2||"audiovideo"in rt)){this.createSourceBuffers(rt),this.pendingTracks={};const st=this.getSourceBufferTypes();if(st.length)this.hls.trigger(Events.BUFFER_CREATED,{tracks:this.tracks}),st.forEach(ot=>{et.executeNext(ot)});else{const ot=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:ot,reason:ot.message})}}}createSourceBuffers(_e){const{sourceBuffer:et,mediaSource:rt}=this;if(!rt)throw Error("createSourceBuffers called when mediaSource was null");for(const st in _e)if(!et[st]){var it;const ot=_e[st];if(!ot)throw Error(`source buffer exists for track ${st}, however track does not`);let at=((it=ot.levelCodec)==null?void 0:it.indexOf(","))===-1?ot.levelCodec:ot.codec;at&&st.slice(0,5)==="audio"&&(at=getCodecCompatibleName(at,this.appendSource));const lt=`${ot.container};codecs=${at}`;this.log(`creating sourceBuffer(${lt})`);try{const ct=et[st]=rt.addSourceBuffer(lt),ut=st;this.addBufferListener(ut,"updatestart",this._onSBUpdateStart),this.addBufferListener(ut,"updateend",this._onSBUpdateEnd),this.addBufferListener(ut,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(ut,"bufferedchange",(ht,dt)=>{const ft=dt.removedRanges;ft!=null&&ft.length&&this.hls.trigger(Events.BUFFER_FLUSHED,{type:st})}),this.tracks[st]={buffer:ct,codec:at,container:ot.container,levelCodec:ot.levelCodec,metadata:ot.metadata,id:ot.id}}catch(ct){this.error(`error while trying to add sourceBuffer: ${ct.message}`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:ct,sourceBufferName:st,mimeType:lt})}}}get mediaSrc(){var _e,et;const rt=((_e=this.media)==null||(et=_e.querySelector)==null?void 0:et.call(_e,"source"))||this.media;return rt==null?void 0:rt.src}_onSBUpdateStart(_e){const{operationQueue:et}=this;et.current(_e).onStart()}_onSBUpdateEnd(_e){var et;if(((et=this.mediaSource)==null?void 0:et.readyState)==="closed"){this.resetBuffer(_e);return}const{operationQueue:rt}=this;rt.current(_e).onComplete(),rt.shiftAndExecuteNext(_e)}_onSBUpdateError(_e,et){var rt;const it=new Error(`${_e} SourceBuffer error. MediaSource readyState: ${(rt=this.mediaSource)==null?void 0:rt.readyState}`);this.error(`${it}`,et),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,sourceBufferName:_e,error:it,fatal:!1});const st=this.operationQueue.current(_e);st&&st.onError(it)}removeExecutor(_e,et,rt){const{media:it,mediaSource:st,operationQueue:ot,sourceBuffer:at}=this,lt=at[_e];if(!it||!st||!lt){this.warn(`Attempting to remove from the ${_e} SourceBuffer, but it does not exist`),ot.shiftAndExecuteNext(_e);return}const ct=isFiniteNumber(it.duration)?it.duration:1/0,ut=isFiniteNumber(st.duration)?st.duration:1/0,ht=Math.max(0,et),dt=Math.min(rt,ct,ut);dt>ht&&(!lt.ending||lt.ended)?(lt.ended=!1,this.log(`Removing [${ht},${dt}] from the ${_e} SourceBuffer`),lt.remove(ht,dt)):ot.shiftAndExecuteNext(_e)}appendExecutor(_e,et){const rt=this.sourceBuffer[et];if(!rt){if(!this.pendingTracks[et])throw new Error(`Attempting to append to the ${et} SourceBuffer, but it does not exist`);return}rt.ended=!1,rt.appendBuffer(_e)}blockBuffers(_e,et=this.getSourceBufferTypes()){if(!et.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(_e);return}const{operationQueue:rt}=this,it=et.map(st=>rt.appendBlocker(st));Promise.all(it).then(()=>{_e(),et.forEach(st=>{const ot=this.sourceBuffer[st];ot!=null&&ot.updating||rt.shiftAndExecuteNext(st)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(_e,et,rt){const it=this.sourceBuffer[_e];if(!it)return;const st=rt.bind(this,_e);this.listeners[_e].push({event:et,listener:st}),it.addEventListener(et,st)}removeBufferListeners(_e){const et=this.sourceBuffer[_e];et&&this.listeners[_e].forEach(rt=>{et.removeEventListener(rt.event,rt.listener)})}}function removeSourceChildren(nt){const _e=nt.querySelectorAll("source");[].slice.call(_e).forEach(et=>{nt.removeChild(et)})}function addSource(nt,_e){const et=self.document.createElement("source");et.type="video/mp4",et.src=_e,nt.appendChild(et)}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=nt=>String.fromCharCode(specialCea608CharsCodes[nt]||nt),NR_ROWS=15,NR_COLS=100,rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(_e,et){if(this.verboseLevel>=_e){const rt=typeof et=="function"?et():et;logger.log(`${this.time} [${_e}] ${rt}`)}}}const numArrayToHexArray=function(_e){const et=[];for(let rt=0;rt<_e.length;rt++)et.push(_e[rt].toString(16));return et};class PenState{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(_e){const et=["foreground","underline","italics","background","flash"];for(let rt=0;rt<et.length;rt++){const it=et[rt];_e.hasOwnProperty(it)&&(this[it]=_e[it])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(_e){return this.foreground===_e.foreground&&this.underline===_e.underline&&this.italics===_e.italics&&this.background===_e.background&&this.flash===_e.flash}copy(_e){this.foreground=_e.foreground,this.underline=_e.underline,this.italics=_e.italics,this.background=_e.background,this.flash=_e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(){this.uchar=" ",this.penState=new PenState}reset(){this.uchar=" ",this.penState.reset()}setChar(_e,et){this.uchar=_e,this.penState.copy(et)}setPenState(_e){this.penState.copy(_e)}equals(_e){return this.uchar===_e.uchar&&this.penState.equals(_e.penState)}copy(_e){this.uchar=_e.uchar,this.penState.copy(_e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Row{constructor(_e){this.chars=[],this.pos=0,this.currPenState=new PenState,this.cueStartTime=null,this.logger=void 0;for(let et=0;et<NR_COLS;et++)this.chars.push(new StyledUnicodeChar);this.logger=_e}equals(_e){for(let et=0;et<NR_COLS;et++)if(!this.chars[et].equals(_e.chars[et]))return!1;return!0}copy(_e){for(let et=0;et<NR_COLS;et++)this.chars[et].copy(_e.chars[et])}isEmpty(){let _e=!0;for(let et=0;et<NR_COLS;et++)if(!this.chars[et].isEmpty()){_e=!1;break}return _e}setCursor(_e){this.pos!==_e&&(this.pos=_e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>NR_COLS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=NR_COLS)}moveCursor(_e){const et=this.pos+_e;if(_e>1)for(let rt=this.pos+1;rt<et+1;rt++)this.chars[rt].setPenState(this.currPenState);this.setCursor(et)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(_e){_e>=144&&this.backSpace();const et=getCharForByte(_e);if(this.pos>=NR_COLS){this.logger.log(0,()=>"Cannot insert "+_e.toString(16)+" ("+et+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(et,this.currPenState),this.moveCursor(1)}clearFromPos(_e){let et;for(et=_e;et<NR_COLS;et++)this.chars[et].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const _e=[];let et=!0;for(let rt=0;rt<NR_COLS;rt++){const it=this.chars[rt].uchar;it!==" "&&(et=!1),_e.push(it)}return et?"":_e.join("")}setPenStyles(_e){this.currPenState.setStyles(_e),this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(_e){this.rows=[],this.currRow=NR_ROWS-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let et=0;et<NR_ROWS;et++)this.rows.push(new Row(_e));this.logger=_e}reset(){for(let _e=0;_e<NR_ROWS;_e++)this.rows[_e].clear();this.currRow=NR_ROWS-1}equals(_e){let et=!0;for(let rt=0;rt<NR_ROWS;rt++)if(!this.rows[rt].equals(_e.rows[rt])){et=!1;break}return et}copy(_e){for(let et=0;et<NR_ROWS;et++)this.rows[et].copy(_e.rows[et])}isEmpty(){let _e=!0;for(let et=0;et<NR_ROWS;et++)if(!this.rows[et].isEmpty()){_e=!1;break}return _e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(_e){this.rows[this.currRow].insertChar(_e)}setPen(_e){this.rows[this.currRow].setPenStyles(_e)}moveCursor(_e){this.rows[this.currRow].moveCursor(_e)}setCursor(_e){this.logger.log(2,"setCursor: "+_e),this.rows[this.currRow].setCursor(_e)}setPAC(_e){this.logger.log(2,()=>"pacData = "+JSON.stringify(_e));let et=_e.row-1;if(this.nrRollUpRows&&et<this.nrRollUpRows-1&&(et=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==et){for(let at=0;at<NR_ROWS;at++)this.rows[at].clear();const st=this.currRow+1-this.nrRollUpRows,ot=this.lastOutputScreen;if(ot){const at=ot.rows[st].cueStartTime,lt=this.logger.time;if(at!==null&&lt!==null&&at<lt)for(let ct=0;ct<this.nrRollUpRows;ct++)this.rows[et-this.nrRollUpRows+ct+1].copy(ot.rows[st+ct])}}this.currRow=et;const rt=this.rows[this.currRow];if(_e.indent!==null){const st=_e.indent,ot=Math.max(st-1,0);rt.setCursor(_e.indent),_e.color=rt.chars[ot].penState.foreground}const it={foreground:_e.color,underline:_e.underline,italics:_e.italics,background:"black",flash:!1};this.setPen(it)}setBkgData(_e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(_e)),this.backSpace(),this.setPen(_e),this.insertChar(32)}setRollUpRows(_e){this.nrRollUpRows=_e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const _e=this.currRow+1-this.nrRollUpRows,et=this.rows.splice(_e,1)[0];et.clear(),this.rows.splice(this.currRow,0,et),this.logger.log(2,"Rolling up")}getDisplayText(_e){_e=_e||!1;const et=[];let rt="",it=-1;for(let st=0;st<NR_ROWS;st++){const ot=this.rows[st].getTextString();ot&&(it=st+1,_e?et.push("Row "+it+": '"+ot+"'"):et.push(ot.trim()))}return et.length>0&&(_e?rt="["+et.join(" | ")+"]":rt=et.join(`
`)),rt}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(_e,et,rt){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=_e,this.outputFilter=et,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(rt),this.nonDisplayedMemory=new CaptionScreen(rt),this.lastOutputScreen=new CaptionScreen(rt),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=rt}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(_e){this.outputFilter=_e}setPAC(_e){this.writeScreen.setPAC(_e)}setBkgData(_e){this.writeScreen.setBkgData(_e)}setMode(_e){_e!==this.mode&&(this.mode=_e,this.logger.log(2,()=>"MODE="+_e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=_e)}insertChars(_e){for(let rt=0;rt<_e.length;rt++)this.writeScreen.insertChar(_e[rt]);const et=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>et+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(_e){this.logger.log(2,"RU("+_e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(_e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const _e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=_e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(_e){this.logger.log(2,"TO("+_e+") - Tab Offset"),this.writeScreen.moveCursor(_e)}ccMIDROW(_e){const et={flash:!1};if(et.underline=_e%2===1,et.italics=_e>=46,et.italics)et.foreground="white";else{const rt=Math.floor(_e/2)-16,it=["white","green","blue","cyan","red","yellow","magenta"];et.foreground=it[rt]}this.logger.log(2,"MIDROW: "+JSON.stringify(et)),this.writeScreen.setPen(et)}outputDataUpdate(_e=!1){const et=this.logger.time;et!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=et:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,et,this.lastOutputScreen),_e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:et),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(_e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,_e,this.displayedMemory),this.cueStartTime=_e))}}class Cea608Parser{constructor(_e,et,rt){this.channels=void 0,this.currentChannel=0,this.cmdHistory=createCmdHistory(),this.logger=void 0;const it=this.logger=new CaptionsLogger;this.channels=[null,new Cea608Channel(_e,et,it),new Cea608Channel(_e+1,rt,it)]}getHandler(_e){return this.channels[_e].getHandler()}setHandler(_e,et){this.channels[_e].setHandler(et)}addData(_e,et){this.logger.time=_e;for(let rt=0;rt<et.length;rt+=2){const it=et[rt]&127,st=et[rt+1]&127;let ot=!1,at=null;if(it===0&&st===0)continue;this.logger.log(3,()=>"["+numArrayToHexArray([et[rt],et[rt+1]])+"] -> ("+numArrayToHexArray([it,st])+")");const lt=this.cmdHistory;if(it>=16&&it<=31){if(hasCmdRepeated(it,st,lt)){setLastCmd(null,null,lt),this.logger.log(3,()=>"Repeated command ("+numArrayToHexArray([it,st])+") is dropped");continue}setLastCmd(it,st,this.cmdHistory),ot=this.parseCmd(it,st),ot||(ot=this.parseMidrow(it,st)),ot||(ot=this.parsePAC(it,st)),ot||(ot=this.parseBackgroundAttributes(it,st))}else setLastCmd(null,null,lt);if(!ot&&(at=this.parseChars(it,st),at)){const ut=this.currentChannel;ut&&ut>0?this.channels[ut].insertChars(at):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!ot&&!at&&this.logger.log(2,()=>"Couldn't parse cleaned data "+numArrayToHexArray([it,st])+" orig: "+numArrayToHexArray([et[rt],et[rt+1]]))}}parseCmd(_e,et){const rt=(_e===20||_e===28||_e===21||_e===29)&&et>=32&&et<=47,it=(_e===23||_e===31)&&et>=33&&et<=35;if(!(rt||it))return!1;const st=_e===20||_e===21||_e===23?1:2,ot=this.channels[st];return _e===20||_e===21||_e===28||_e===29?et===32?ot.ccRCL():et===33?ot.ccBS():et===34?ot.ccAOF():et===35?ot.ccAON():et===36?ot.ccDER():et===37?ot.ccRU(2):et===38?ot.ccRU(3):et===39?ot.ccRU(4):et===40?ot.ccFON():et===41?ot.ccRDC():et===42?ot.ccTR():et===43?ot.ccRTD():et===44?ot.ccEDM():et===45?ot.ccCR():et===46?ot.ccENM():et===47&&ot.ccEOC():ot.ccTO(et-32),this.currentChannel=st,!0}parseMidrow(_e,et){let rt=0;if((_e===17||_e===25)&&et>=32&&et<=47){if(_e===17?rt=1:rt=2,rt!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const it=this.channels[rt];return it?(it.ccMIDROW(et),this.logger.log(3,()=>"MIDROW ("+numArrayToHexArray([_e,et])+")"),!0):!1}return!1}parsePAC(_e,et){let rt;const it=(_e>=17&&_e<=23||_e>=25&&_e<=31)&&et>=64&&et<=127,st=(_e===16||_e===24)&&et>=64&&et<=95;if(!(it||st))return!1;const ot=_e<=23?1:2;et>=64&&et<=95?rt=ot===1?rowsLowCh1[_e]:rowsLowCh2[_e]:rt=ot===1?rowsHighCh1[_e]:rowsHighCh2[_e];const at=this.channels[ot];return at?(at.setPAC(this.interpretPAC(rt,et)),this.currentChannel=ot,!0):!1}interpretPAC(_e,et){let rt;const it={color:null,italics:!1,indent:null,underline:!1,row:_e};return et>95?rt=et-96:rt=et-64,it.underline=(rt&1)===1,rt<=13?it.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(rt/2)]:rt<=15?(it.italics=!0,it.color="white"):it.indent=Math.floor((rt-16)/2)*4,it}parseChars(_e,et){let rt,it=null,st=null;if(_e>=25?(rt=2,st=_e-8):(rt=1,st=_e),st>=17&&st<=19){let ot;st===17?ot=et+80:st===18?ot=et+112:ot=et+144,this.logger.log(2,()=>"Special char '"+getCharForByte(ot)+"' in channel "+rt),it=[ot]}else _e>=32&&_e<=127&&(it=et===0?[_e]:[_e,et]);return it&&this.logger.log(3,()=>"Char codes =  "+numArrayToHexArray(it).join(",")),it}parseBackgroundAttributes(_e,et){const rt=(_e===16||_e===24)&&et>=32&&et<=47,it=(_e===23||_e===31)&&et>=45&&et<=47;if(!(rt||it))return!1;let st;const ot={};_e===16||_e===24?(st=Math.floor((et-32)/2),ot.background=backgroundColors[st],et%2===1&&(ot.background=ot.background+"_semi")):et===45?ot.background="transparent":(ot.foreground="black",et===47&&(ot.underline=!0));const at=_e<=23?1:2;return this.channels[at].setBkgData(ot),!0}reset(){for(let _e=0;_e<Object.keys(this.channels).length;_e++){const et=this.channels[_e];et&&et.reset()}setLastCmd(null,null,this.cmdHistory)}cueSplitAtTime(_e){for(let et=0;et<this.channels.length;et++){const rt=this.channels[et];rt&&rt.cueSplitAtTime(_e)}}}function setLastCmd(nt,_e,et){et.a=nt,et.b=_e}function hasCmdRepeated(nt,_e,et){return et.a===nt&&et.b===_e}function createCmdHistory(){return{a:null,b:null}}class OutputFilter{constructor(_e,et){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=_e,this.trackName=et}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(_e,et,rt){(this.startTime===null||this.startTime>_e)&&(this.startTime=_e),this.endTime=et,this.screen=rt,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var VTTCue=function(){if(optionalSelf!=null&&optionalSelf.VTTCue)return self.VTTCue;const nt=["","lr","rl"],_e=["start","middle","end","left","right"];function et(at,lt){if(typeof lt!="string"||!Array.isArray(at))return!1;const ct=lt.toLowerCase();return~at.indexOf(ct)?ct:!1}function rt(at){return et(nt,at)}function it(at){return et(_e,at)}function st(at,...lt){let ct=1;for(;ct<arguments.length;ct++){const ut=arguments[ct];for(const ht in ut)at[ht]=ut[ht]}return at}function ot(at,lt,ct){const ut=this,ht={enumerable:!0};ut.hasBeenReset=!1;let dt="",ft=!1,pt=at,mt=lt,At=ct,gt=null,bt="",Tt=!0,wt="auto",Rt="start",It=50,Lt="middle",$t=50,kt="middle";Object.defineProperty(ut,"id",st({},ht,{get:function(){return dt},set:function(Dt){dt=""+Dt}})),Object.defineProperty(ut,"pauseOnExit",st({},ht,{get:function(){return ft},set:function(Dt){ft=!!Dt}})),Object.defineProperty(ut,"startTime",st({},ht,{get:function(){return pt},set:function(Dt){if(typeof Dt!="number")throw new TypeError("Start time must be set to a number.");pt=Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"endTime",st({},ht,{get:function(){return mt},set:function(Dt){if(typeof Dt!="number")throw new TypeError("End time must be set to a number.");mt=Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"text",st({},ht,{get:function(){return At},set:function(Dt){At=""+Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"region",st({},ht,{get:function(){return gt},set:function(Dt){gt=Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"vertical",st({},ht,{get:function(){return bt},set:function(Dt){const Ot=rt(Dt);if(Ot===!1)throw new SyntaxError("An invalid or illegal string was specified.");bt=Ot,this.hasBeenReset=!0}})),Object.defineProperty(ut,"snapToLines",st({},ht,{get:function(){return Tt},set:function(Dt){Tt=!!Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"line",st({},ht,{get:function(){return wt},set:function(Dt){if(typeof Dt!="number"&&Dt!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");wt=Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"lineAlign",st({},ht,{get:function(){return Rt},set:function(Dt){const Ot=it(Dt);if(!Ot)throw new SyntaxError("An invalid or illegal string was specified.");Rt=Ot,this.hasBeenReset=!0}})),Object.defineProperty(ut,"position",st({},ht,{get:function(){return It},set:function(Dt){if(Dt<0||Dt>100)throw new Error("Position must be between 0 and 100.");It=Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"positionAlign",st({},ht,{get:function(){return Lt},set:function(Dt){const Ot=it(Dt);if(!Ot)throw new SyntaxError("An invalid or illegal string was specified.");Lt=Ot,this.hasBeenReset=!0}})),Object.defineProperty(ut,"size",st({},ht,{get:function(){return $t},set:function(Dt){if(Dt<0||Dt>100)throw new Error("Size must be between 0 and 100.");$t=Dt,this.hasBeenReset=!0}})),Object.defineProperty(ut,"align",st({},ht,{get:function(){return kt},set:function(Dt){const Ot=it(Dt);if(!Ot)throw new SyntaxError("An invalid or illegal string was specified.");kt=Ot,this.hasBeenReset=!0}})),ut.displayState=void 0}return ot.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},ot}();class StringDecoder{decode(_e,et){if(!_e)return"";if(typeof _e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(_e))}}function parseTimeStamp(nt){function _e(rt,it,st,ot){return(rt|0)*3600+(it|0)*60+(st|0)+parseFloat(ot||0)}const et=nt.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return et?parseFloat(et[2])>59?_e(et[2],et[3],0,et[4]):_e(et[1],et[2],et[3],et[4]):null}class Settings{constructor(){this.values=Object.create(null)}set(_e,et){!this.get(_e)&&et!==""&&(this.values[_e]=et)}get(_e,et,rt){return rt?this.has(_e)?this.values[_e]:et[rt]:this.has(_e)?this.values[_e]:et}has(_e){return _e in this.values}alt(_e,et,rt){for(let it=0;it<rt.length;++it)if(et===rt[it]){this.set(_e,et);break}}integer(_e,et){/^-?\d+$/.test(et)&&this.set(_e,parseInt(et,10))}percent(_e,et){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(et)){const rt=parseFloat(et);if(rt>=0&&rt<=100)return this.set(_e,rt),!0}return!1}}function parseOptions(nt,_e,et,rt){const it=rt?nt.split(rt):[nt];for(const st in it){if(typeof it[st]!="string")continue;const ot=it[st].split(et);if(ot.length!==2)continue;const at=ot[0],lt=ot[1];_e(at,lt)}}const defaults=new VTTCue(0,0,""),center=defaults.align==="middle"?"middle":"center";function parseCue(nt,_e,et){const rt=nt;function it(){const at=parseTimeStamp(nt);if(at===null)throw new Error("Malformed timestamp: "+rt);return nt=nt.replace(/^[^\sa-zA-Z-]+/,""),at}function st(at,lt){const ct=new Settings;parseOptions(at,function(dt,ft){let pt;switch(dt){case"region":for(let mt=et.length-1;mt>=0;mt--)if(et[mt].id===ft){ct.set(dt,et[mt].region);break}break;case"vertical":ct.alt(dt,ft,["rl","lr"]);break;case"line":pt=ft.split(","),ct.integer(dt,pt[0]),ct.percent(dt,pt[0])&&ct.set("snapToLines",!1),ct.alt(dt,pt[0],["auto"]),pt.length===2&&ct.alt("lineAlign",pt[1],["start",center,"end"]);break;case"position":pt=ft.split(","),ct.percent(dt,pt[0]),pt.length===2&&ct.alt("positionAlign",pt[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":ct.percent(dt,ft);break;case"align":ct.alt(dt,ft,["start",center,"end","left","right"]);break}},/:/,/\s/),lt.region=ct.get("region",null),lt.vertical=ct.get("vertical","");let ut=ct.get("line","auto");ut==="auto"&&defaults.line===-1&&(ut=-1),lt.line=ut,lt.lineAlign=ct.get("lineAlign","start"),lt.snapToLines=ct.get("snapToLines",!0),lt.size=ct.get("size",100),lt.align=ct.get("align",center);let ht=ct.get("position","auto");ht==="auto"&&defaults.position===50&&(ht=lt.align==="start"||lt.align==="left"?0:lt.align==="end"||lt.align==="right"?100:50),lt.position=ht}function ot(){nt=nt.replace(/^\s+/,"")}if(ot(),_e.startTime=it(),ot(),nt.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+rt);nt=nt.slice(3),ot(),_e.endTime=it(),ot(),st(nt,_e)}function fixLineBreaks(nt){return nt.replace(/<br(?: \/)?>/gi,`
`)}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(_e){const et=this;_e&&(et.buffer+=et.decoder.decode(_e,{stream:!0}));function rt(){let st=et.buffer,ot=0;for(st=fixLineBreaks(st);ot<st.length&&st[ot]!=="\r"&&st[ot]!==`
`;)++ot;const at=st.slice(0,ot);return st[ot]==="\r"&&++ot,st[ot]===`
`&&++ot,et.buffer=st.slice(ot),at}function it(st){parseOptions(st,function(ot,at){},/:/)}try{let st="";if(et.state==="INITIAL"){if(!/\r\n|\n/.test(et.buffer))return this;st=rt();const at=st.match(/^()?WEBVTT([ \t].*)?$/);if(!(at!=null&&at[0]))throw new Error("Malformed WebVTT signature.");et.state="HEADER"}let ot=!1;for(;et.buffer;){if(!/\r\n|\n/.test(et.buffer))return this;switch(ot?ot=!1:st=rt(),et.state){case"HEADER":/:/.test(st)?it(st):st||(et.state="ID");continue;case"NOTE":st||(et.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(st)){et.state="NOTE";break}if(!st)continue;if(et.cue=new VTTCue(0,0,""),et.state="CUE",st.indexOf("-->")===-1){et.cue.id=st;continue}case"CUE":if(!et.cue){et.state="BADCUE";continue}try{parseCue(st,et.cue,et.regionList)}catch{et.cue=null,et.state="BADCUE";continue}et.state="CUETEXT";continue;case"CUETEXT":{const at=st.indexOf("-->")!==-1;if(!st||at&&(ot=!0)){et.oncue&&et.cue&&et.oncue(et.cue),et.cue=null,et.state="ID";continue}if(et.cue===null)continue;et.cue.text&&(et.cue.text+=`
`),et.cue.text+=st}continue;case"BADCUE":st||(et.state="ID")}}}catch{et.state==="CUETEXT"&&et.cue&&et.oncue&&et.oncue(et.cue),et.cue=null,et.state=et.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const _e=this;try{if((_e.cue||_e.state==="HEADER")&&(_e.buffer+=`

`,_e.parse()),_e.state==="INITIAL"||_e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(et){_e.onparsingerror&&_e.onparsingerror(et)}return _e.onflush&&_e.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function(_e,et,rt=0){return _e.slice(rt,rt+et.length)===et},cueString2millis=function(_e){let et=parseInt(_e.slice(-3));const rt=parseInt(_e.slice(-6,-4)),it=parseInt(_e.slice(-9,-7)),st=_e.length>9?parseInt(_e.substring(0,_e.indexOf(":"))):0;if(!isFiniteNumber(et)||!isFiniteNumber(rt)||!isFiniteNumber(it)||!isFiniteNumber(st))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${_e}`);return et+=1e3*rt,et+=60*1e3*it,et+=60*60*1e3*st,et},hash=function(_e){let et=5381,rt=_e.length;for(;rt;)et=et*33^_e.charCodeAt(--rt);return(et>>>0).toString()};function generateCueId(nt,_e,et){return hash(nt.toString())+hash(_e.toString())+hash(et)}const calculateOffset=function(_e,et,rt){let it=_e[et],st=_e[it.prevCC];if(!st||!st.new&&it.new){_e.ccOffset=_e.presentationOffset=it.start,it.new=!1;return}for(;(ot=st)!=null&&ot.new;){var ot;_e.ccOffset+=it.start-st.start,it.new=!1,it=st,st=_e[it.prevCC]}_e.presentationOffset=rt};function parseWebVTT(nt,_e,et,rt,it,st,ot){const at=new VTTParser,lt=utf8ArrayToStr(new Uint8Array(nt)).trim().replace(LINEBREAKS,`
`).split(`
`),ct=[],ut=_e?toMpegTsClockFromTimescale(_e.baseTime,_e.timescale):0;let ht="00:00.000",dt=0,ft=0,pt,mt=!0;at.oncue=function(At){const gt=et[rt];let bt=et.ccOffset;const Tt=(dt-ut)/9e4;if(gt!=null&&gt.new&&(ft!==void 0?bt=et.ccOffset=gt.start:calculateOffset(et,rt,Tt)),Tt){if(!_e){pt=new Error("Missing initPTS for VTT MPEGTS");return}bt=Tt-et.presentationOffset}const wt=At.endTime-At.startTime,Rt=normalizePts((At.startTime+bt-ft)*9e4,it*9e4)/9e4;At.startTime=Math.max(Rt,0),At.endTime=Math.max(Rt+wt,0);const It=At.text.trim();At.text=decodeURIComponent(encodeURIComponent(It)),At.id||(At.id=generateCueId(At.startTime,At.endTime,It)),At.endTime>0&&ct.push(At)},at.onparsingerror=function(At){pt=At},at.onflush=function(){if(pt){ot(pt);return}st(ct)},lt.forEach(At=>{if(mt)if(startsWith(At,"X-TIMESTAMP-MAP=")){mt=!1,At.slice(16).split(",").forEach(gt=>{startsWith(gt,"LOCAL:")?ht=gt.slice(6):startsWith(gt,"MPEGTS:")&&(dt=parseInt(gt.slice(7)))});try{ft=cueString2millis(ht)/1e3}catch(gt){pt=gt}return}else At===""&&(mt=!1);at.parse(At+`
`)}),at.flush()}const IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(nt,_e,et,rt){const it=findBox(new Uint8Array(nt),["mdat"]);if(it.length===0){rt(new Error("Could not parse IMSC1 mdat"));return}const st=it.map(at=>utf8ArrayToStr(at)),ot=toTimescaleFromScale(_e.baseTime,1,_e.timescale);try{st.forEach(at=>et(parseTTML(at,ot)))}catch(at){rt(at)}}function parseTTML(nt,_e){const it=new DOMParser().parseFromString(nt,"text/xml").getElementsByTagName("tt")[0];if(!it)throw new Error("Invalid ttml");const st={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},ot=Object.keys(st).reduce((ht,dt)=>(ht[dt]=it.getAttribute(`ttp:${dt}`)||st[dt],ht),{}),at=it.getAttribute("xml:space")!=="preserve",lt=collectionToDictionary(getElementCollection(it,"styling","style")),ct=collectionToDictionary(getElementCollection(it,"layout","region")),ut=getElementCollection(it,"body","[begin]");return[].map.call(ut,ht=>{const dt=getTextContent(ht,at);if(!dt||!ht.hasAttribute("begin"))return null;const ft=parseTtmlTime(ht.getAttribute("begin"),ot),pt=parseTtmlTime(ht.getAttribute("dur"),ot);let mt=parseTtmlTime(ht.getAttribute("end"),ot);if(ft===null)throw timestampParsingError(ht);if(mt===null){if(pt===null)throw timestampParsingError(ht);mt=ft+pt}const At=new VTTCue(ft-_e,mt-_e,dt);At.id=generateCueId(At.startTime,At.endTime,At.text);const gt=ct[ht.getAttribute("region")],bt=lt[ht.getAttribute("style")],Tt=getTtmlStyles(gt,bt,lt),{textAlign:wt}=Tt;if(wt){const Rt=textAlignToLineAlign[wt];Rt&&(At.lineAlign=Rt),At.align=wt}return _extends$1(At,Tt),At}).filter(ht=>ht!==null)}function getElementCollection(nt,_e,et){const rt=nt.getElementsByTagName(_e)[0];return rt?[].slice.call(rt.querySelectorAll(et)):[]}function collectionToDictionary(nt){return nt.reduce((_e,et)=>{const rt=et.getAttribute("xml:id");return rt&&(_e[rt]=et),_e},{})}function getTextContent(nt,_e){return[].slice.call(nt.childNodes).reduce((et,rt,it)=>{var st;return rt.nodeName==="br"&&it?et+`
`:(st=rt.childNodes)!=null&&st.length?getTextContent(rt,_e):_e?et+rt.textContent.trim().replace(/\s+/g," "):et+rt.textContent},"")}function getTtmlStyles(nt,_e,et){const rt="http://www.w3.org/ns/ttml#styling";let it=null;const st=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],ot=nt!=null&&nt.hasAttribute("style")?nt.getAttribute("style"):null;return ot&&et.hasOwnProperty(ot)&&(it=et[ot]),st.reduce((at,lt)=>{const ct=getAttributeNS(_e,rt,lt)||getAttributeNS(nt,rt,lt)||getAttributeNS(it,rt,lt);return ct&&(at[lt]=ct),at},{})}function getAttributeNS(nt,_e,et){return nt&&nt.hasAttributeNS(_e,et)?nt.getAttributeNS(_e,et):null}function timestampParsingError(nt){return new Error(`Could not parse ttml timestamp ${nt}`)}function parseTtmlTime(nt,_e){if(!nt)return null;let et=parseTimeStamp(nt);return et===null&&(HMSF_REGEX.test(nt)?et=parseHoursMinutesSecondsFrames(nt,_e):TIME_UNIT_REGEX.test(nt)&&(et=parseTimeUnits(nt,_e))),et}function parseHoursMinutesSecondsFrames(nt,_e){const et=HMSF_REGEX.exec(nt),rt=(et[4]|0)+(et[5]|0)/_e.subFrameRate;return(et[1]|0)*3600+(et[2]|0)*60+(et[3]|0)+rt/_e.frameRate}function parseTimeUnits(nt,_e){const et=TIME_UNIT_REGEX.exec(nt),rt=Number(et[1]);switch(et[2]){case"h":return rt*3600;case"m":return rt*60;case"ms":return rt*1e3;case"f":return rt/_e.frameRate;case"t":return rt/_e.tickRate}return rt}class TimelineController{constructor(_e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this.captionsProperties=void 0,this.hls=_e,this.config=_e.config,this.Cues=_e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},_e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),_e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),_e.on(Events.FRAG_LOADING,this.onFragLoading,this),_e.on(Events.FRAG_LOADED,this.onFragLoaded,this),_e.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),_e.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),_e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),_e.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),_e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),_e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),_e.off(Events.FRAG_LOADING,this.onFragLoading,this),_e.off(Events.FRAG_LOADED,this.onFragLoaded,this),_e.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),_e.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),_e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),_e.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),_e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const _e=new OutputFilter(this,"textTrack1"),et=new OutputFilter(this,"textTrack2"),rt=new OutputFilter(this,"textTrack3"),it=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,_e,et),this.cea608Parser2=new Cea608Parser(3,rt,it)}}addCues(_e,et,rt,it,st){let ot=!1;for(let at=st.length;at--;){const lt=st[at],ct=intersection(lt[0],lt[1],et,rt);if(ct>=0&&(lt[0]=Math.min(lt[0],et),lt[1]=Math.max(lt[1],rt),ot=!0,ct/(rt-et)>.5))return}if(ot||st.push([et,rt]),this.config.renderTextTracksNatively){const at=this.captionsTracks[_e];this.Cues.newCue(at,et,rt,it)}else{const at=this.Cues.newCue(null,et,rt,it);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues:at,track:_e})}}onInitPtsFound(_e,{frag:et,id:rt,initPTS:it,timescale:st}){const{unparsedVttFrags:ot}=this;rt==="main"&&(this.initPTS[et.cc]={baseTime:it,timescale:st}),ot.length&&(this.unparsedVttFrags=[],ot.forEach(at=>{this.onFragLoaded(Events.FRAG_LOADED,at)}))}getExistingTrack(_e,et){const{media:rt}=this;if(rt)for(let it=0;it<rt.textTracks.length;it++){const st=rt.textTracks[it];if(canReuseVttTextTrack(st,{name:_e,lang:et,attrs:{}}))return st}return null}createCaptionsTrack(_e){this.config.renderTextTracksNatively?this.createNativeTrack(_e):this.createNonNativeTrack(_e)}createNativeTrack(_e){if(this.captionsTracks[_e])return;const{captionsProperties:et,captionsTracks:rt,media:it}=this,{label:st,languageCode:ot}=et[_e],at=this.getExistingTrack(st,ot);if(at)rt[_e]=at,clearCurrentCues(rt[_e]),sendAddTrackEvent(rt[_e],it);else{const lt=this.createTextTrack("captions",st,ot);lt&&(lt[_e]=!0,rt[_e]=lt)}}createNonNativeTrack(_e){if(this.nonNativeCaptionsTracks[_e])return;const et=this.captionsProperties[_e];if(!et)return;const rt=et.label,it={_id:_e,label:rt,kind:"captions",default:et.media?!!et.media.default:!1,closedCaptions:et.media};this.nonNativeCaptionsTracks[_e]=it,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[it]})}createTextTrack(_e,et,rt){const it=this.media;if(it)return it.addTextTrack(_e,et,rt)}onMediaAttaching(_e,et){this.media=et.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:_e}=this;Object.keys(_e).forEach(et=>{clearCurrentCues(_e[et]),delete _e[et]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:_e}=this;if(!_e)return;const et=_e.textTracks;if(et)for(let rt=0;rt<et.length;rt++)clearCurrentCues(et[rt])}onSubtitleTracksUpdated(_e,et){const rt=et.subtitleTracks||[],it=rt.some(st=>st.textCodec===IMSC1_CODEC);if(this.config.enableWebVTT||it&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,rt)){this.tracks=rt;return}if(this.textTracks=[],this.tracks=rt,this.config.renderTextTracksNatively){const ot=this.media,at=ot?filterSubtitleTracks(ot.textTracks):null;if(this.tracks.forEach((lt,ct)=>{let ut;if(at){let ht=null;for(let dt=0;dt<at.length;dt++)if(at[dt]&&canReuseVttTextTrack(at[dt],lt)){ht=at[dt],at[dt]=null;break}ht&&(ut=ht)}if(ut)clearCurrentCues(ut);else{const ht=captionsOrSubtitlesFromCharacteristics(lt);ut=this.createTextTrack(ht,lt.name,lt.lang),ut&&(ut.mode="disabled")}ut&&this.textTracks.push(ut)}),at!=null&&at.length){const lt=at.filter(ct=>ct!==null).map(ct=>ct.label);lt.length&&logger.warn(`Media element contains unused subtitle tracks: ${lt.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const ot=this.tracks.map(at=>({label:at.name,kind:at.type.toLowerCase(),default:at.default,subtitleTrack:at}));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:ot})}}}onManifestLoaded(_e,et){this.config.enableCEA708Captions&&et.captions&&et.captions.forEach(rt=>{const it=/(?:CC|SERVICE)([1-4])/.exec(rt.instreamId);if(!it)return;const st=`textTrack${it[1]}`,ot=this.captionsProperties[st];ot&&(ot.label=rt.name,rt.lang&&(ot.languageCode=rt.lang),ot.media=rt)})}closedCaptionsForLevel(_e){const et=this.hls.levels[_e.level];return et==null?void 0:et.attrs["CLOSED-CAPTIONS"]}onFragLoading(_e,et){if(this.enabled&&et.frag.type===PlaylistLevelType.MAIN){var rt,it;const{cea608Parser1:st,cea608Parser2:ot,lastSn:at}=this,{cc:lt,sn:ct}=et.frag,ut=(rt=(it=et.part)==null?void 0:it.index)!=null?rt:-1;st&&ot&&(ct!==at+1||ct===at&&ut!==this.lastPartIndex+1||lt!==this.lastCc)&&(st.reset(),ot.reset()),this.lastCc=lt,this.lastSn=ct,this.lastPartIndex=ut}}onFragLoaded(_e,et){const{frag:rt,payload:it}=et;if(rt.type===PlaylistLevelType.SUBTITLE)if(it.byteLength){const st=rt.decryptdata,ot="stats"in et;if(st==null||!st.encrypted||ot){const at=this.tracks[rt.level],lt=this.vttCCs;lt[rt.cc]||(lt[rt.cc]={start:rt.start,prevCC:this.prevCC,new:!0},this.prevCC=rt.cc),at&&at.textCodec===IMSC1_CODEC?this._parseIMSC1(rt,it):this._parseVTTs(et)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:rt,error:new Error("Empty subtitle payload")})}_parseIMSC1(_e,et){const rt=this.hls;parseIMSC1(et,this.initPTS[_e.cc],it=>{this._appendCues(it,_e.level),rt.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:_e})},it=>{logger.log(`Failed to parse IMSC1: ${it}`),rt.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:_e,error:it})})}_parseVTTs(_e){var et;const{frag:rt,payload:it}=_e,{initPTS:st,unparsedVttFrags:ot}=this,at=st.length-1;if(!st[rt.cc]&&at===-1){ot.push(_e);return}const lt=this.hls,ct=(et=rt.initSegment)!=null&&et.data?appendUint8Array(rt.initSegment.data,new Uint8Array(it)):it;parseWebVTT(ct,this.initPTS[rt.cc],this.vttCCs,rt.cc,rt.start,ut=>{this._appendCues(ut,rt.level),lt.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:rt})},ut=>{const ht=ut.message==="Missing initPTS for VTT MPEGTS";ht?ot.push(_e):this._fallbackToIMSC1(rt,it),logger.log(`Failed to parse VTT cue: ${ut}`),!(ht&&at>rt.cc)&&lt.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:rt,error:ut})})}_fallbackToIMSC1(_e,et){const rt=this.tracks[_e.level];rt.textCodec||parseIMSC1(et,this.initPTS[_e.cc],()=>{rt.textCodec=IMSC1_CODEC,this._parseIMSC1(_e,et)},()=>{rt.textCodec="wvtt"})}_appendCues(_e,et){const rt=this.hls;if(this.config.renderTextTracksNatively){const it=this.textTracks[et];if(!it||it.mode==="disabled")return;_e.forEach(st=>addCueToTrack(it,st))}else{const it=this.tracks[et];if(!it)return;const st=it.default?"default":"subtitles"+et;rt.trigger(Events.CUES_PARSED,{type:"subtitles",cues:_e,track:st})}}onFragDecrypted(_e,et){const{frag:rt}=et;rt.type===PlaylistLevelType.SUBTITLE&&this.onFragLoaded(Events.FRAG_LOADED,et)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(_e,et){this.initCea608Parsers();const{cea608Parser1:rt,cea608Parser2:it}=this;if(!this.enabled||!rt||!it)return;const{frag:st,samples:ot}=et;if(!(st.type===PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(st)==="NONE"))for(let at=0;at<ot.length;at++){const lt=ot[at].bytes;if(lt){const ct=this.extractCea608Data(lt);rt.addData(ot[at].pts,ct[0]),it.addData(ot[at].pts,ct[1])}}}onBufferFlushing(_e,{startOffset:et,endOffset:rt,endOffsetSubtitles:it,type:st}){const{media:ot}=this;if(!(!ot||ot.currentTime<rt)){if(!st||st==="video"){const{captionsTracks:at}=this;Object.keys(at).forEach(lt=>removeCuesInRange(at[lt],et,rt))}if(this.config.renderTextTracksNatively&&et===0&&it!==void 0){const{textTracks:at}=this;Object.keys(at).forEach(lt=>removeCuesInRange(at[lt],et,it))}}}extractCea608Data(_e){const et=[[],[]],rt=_e[0]&31;let it=2;for(let st=0;st<rt;st++){const ot=_e[it++],at=127&_e[it++],lt=127&_e[it++];if(at===0&&lt===0)continue;if((4&ot)!==0){const ut=3&ot;(ut===0||ut===1)&&(et[ut].push(at),et[ut].push(lt))}}return et}}function captionsOrSubtitlesFromCharacteristics(nt){return nt.characteristics&&/transcribes-spoken-dialog/gi.test(nt.characteristics)&&/describes-music-and-sound/gi.test(nt.characteristics)?"captions":"subtitles"}function canReuseVttTextTrack(nt,_e){return!!nt&&nt.kind===captionsOrSubtitlesFromCharacteristics(_e)&&subtitleTrackMatchesTextTrack(_e,nt)}function intersection(nt,_e,et,rt){return Math.min(_e,rt)-Math.max(nt,et)}function newVTTCCs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class CapLevelController{constructor(_e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=_e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(_e){this.streamController=_e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:_e}=this;_e.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),_e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:_e}=this;_e.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),_e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(_e,et){const rt=this.hls.levels[et.droppedLevel];this.isLevelAllowed(rt)&&this.restrictedLevels.push({bitrate:rt.bitrate,height:rt.height,width:rt.width})}onMediaAttaching(_e,et){this.media=et.media instanceof HTMLVideoElement?et.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(_e,et){const rt=this.hls;this.restrictedLevels=[],this.firstLevel=et.firstLevel,rt.config.capLevelToPlayerSize&&et.video&&this.startCapping()}onLevelsUpdated(_e,et){this.timer&&isFiniteNumber(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(_e,et){this.hls.config.capLevelToPlayerSize&&et.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const _e=this.hls.levels;if(_e.length){const et=this.hls,rt=this.getMaxLevel(_e.length-1);rt!==this.autoLevelCapping&&logger.log(`Setting autoLevelCapping to ${rt}: ${_e[rt].height}p@${_e[rt].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),et.autoLevelCapping=rt,et.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=et.autoLevelCapping}}}getMaxLevel(_e){const et=this.hls.levels;if(!et.length)return-1;const rt=et.filter((it,st)=>this.isLevelAllowed(it)&&st<=_e);return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(rt,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const _e=this.media,et={width:0,height:0};if(_e){const rt=_e.getBoundingClientRect();et.width=rt.width,et.height=rt.height,!et.width&&!et.height&&(et.width=rt.right-rt.left||_e.width||0,et.height=rt.bottom-rt.top||_e.height||0)}return this.clientRect=et,et}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let _e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{_e=self.devicePixelRatio}catch{}return _e}isLevelAllowed(_e){return!this.restrictedLevels.some(rt=>_e.bitrate===rt.bitrate&&_e.width===rt.width&&_e.height===rt.height)}static getMaxLevelByMediaSize(_e,et,rt){if(!(_e!=null&&_e.length))return-1;const it=(at,lt)=>lt?at.width!==lt.width||at.height!==lt.height:!0;let st=_e.length-1;const ot=Math.max(et,rt);for(let at=0;at<_e.length;at+=1){const lt=_e[at];if((lt.width>=ot||lt.height>=ot)&&it(lt,_e[at+1])){st=at;break}}return st}}class FPSController{constructor(_e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=_e,this.registerListeners()}setStreamController(_e){this.streamController=_e}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(_e,et){const rt=this.hls.config;if(rt.capLevelOnFPSDrop){const it=et.media instanceof self.HTMLVideoElement?et.media:null;this.media=it,it&&typeof it.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),rt.fpsDroppedMonitoringPeriod)}}checkFPS(_e,et,rt){const it=performance.now();if(et){if(this.lastTime){const st=it-this.lastTime,ot=rt-this.lastDroppedFrames,at=et-this.lastDecodedFrames,lt=1e3*ot/st,ct=this.hls;if(ct.trigger(Events.FPS_DROP,{currentDropped:ot,currentDecoded:at,totalDroppedFrames:rt}),lt>0&&ot>ct.config.fpsDroppedMonitoringThreshold*at){let ut=ct.currentLevel;logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+ut),ut>0&&(ct.autoLevelCapping===-1||ct.autoLevelCapping>=ut)&&(ut=ut-1,ct.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:ut,droppedLevel:ct.currentLevel}),ct.autoLevelCapping=ut,this.streamController.nextLevelSwitch())}}this.lastTime=it,this.lastDroppedFrames=rt,this.lastDecodedFrames=et}}checkFPSInterval(){const _e=this.media;if(_e)if(this.isVideoPlaybackQualityAvailable){const et=_e.getVideoPlaybackQuality();this.checkFPS(_e,et.totalVideoFrames,et.droppedVideoFrames)}else this.checkFPS(_e,_e.webkitDecodedFrameCount,_e.webkitDroppedFrameCount)}}const LOGGER_PREFIX="[eme]";class EMEController{constructor(_e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=logger.debug.bind(logger,LOGGER_PREFIX),this.log=logger.log.bind(logger,LOGGER_PREFIX),this.warn=logger.warn.bind(logger,LOGGER_PREFIX),this.error=logger.error.bind(logger,LOGGER_PREFIX),this.hls=_e,this.config=_e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const _e=this.config;_e.requestMediaKeySystemAccessFunc=null,_e.licenseXhrSetup=_e.licenseResponseCallback=void 0,_e.drmSystems=_e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(_e){const{drmSystems:et,widevineLicenseUrl:rt}=this.config,it=et[_e];if(it)return it.licenseUrl;if(_e===KeySystems.WIDEVINE&&rt)return rt;throw new Error(`no license server URL configured for key-system "${_e}"`)}getServerCertificateUrl(_e){const{drmSystems:et}=this.config,rt=et[_e];if(rt)return rt.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${_e}"]`)}attemptKeySystemAccess(_e){const et=this.hls.levels,rt=(ot,at,lt)=>!!ot&&lt.indexOf(ot)===at,it=et.map(ot=>ot.audioCodec).filter(rt),st=et.map(ot=>ot.videoCodec).filter(rt);return it.length+st.length===0&&st.push("avc1.42e01e"),new Promise((ot,at)=>{const lt=ct=>{const ut=ct.shift();this.getMediaKeysPromise(ut,it,st).then(ht=>ot({keySystem:ut,mediaKeys:ht})).catch(ht=>{ct.length?lt(ct):ht instanceof EMEKeyError?at(ht):at(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:ht,fatal:!0},ht.message))})};lt(_e)})}requestMediaKeySystemAccess(_e,et){const{requestMediaKeySystemAccessFunc:rt}=this.config;if(typeof rt!="function"){let it=`Configured requestMediaKeySystemAccess is not a function ${rt}`;return requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(it=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(it))}return rt(_e,et)}getMediaKeysPromise(_e,et,rt){const it=getSupportedMediaKeySystemConfigurations(_e,et,rt,this.config.drmSystemOptions),st=this.keySystemAccessPromises[_e];let ot=st==null?void 0:st.keySystemAccess;if(!ot){this.log(`Requesting encrypted media "${_e}" key-system access with config: ${JSON.stringify(it)}`),ot=this.requestMediaKeySystemAccess(_e,it);const at=this.keySystemAccessPromises[_e]={keySystemAccess:ot};return ot.catch(lt=>{this.log(`Failed to obtain access to key-system "${_e}": ${lt}`)}),ot.then(lt=>{this.log(`Access for key-system "${lt.keySystem}" obtained`);const ct=this.fetchServerCertificate(_e);return this.log(`Create media-keys for "${_e}"`),at.mediaKeys=lt.createMediaKeys().then(ut=>(this.log(`Media-keys created for "${_e}"`),ct.then(ht=>ht?this.setMediaKeysServerCertificate(ut,_e,ht):ut))),at.mediaKeys.catch(ut=>{this.error(`Failed to create media-keys for "${_e}"}: ${ut}`)}),at.mediaKeys})}return ot.then(()=>st.mediaKeys)}createMediaKeySessionContext({decryptdata:_e,keySystem:et,mediaKeys:rt}){this.log(`Creating key-system session "${et}" keyId: ${Hex.hexDump(_e.keyId||[])}`);const it=rt.createSession(),st={decryptdata:_e,keySystem:et,mediaKeys:rt,mediaKeysSession:it,keyStatus:"status-pending"};return this.mediaKeySessions.push(st),st}renewKeySession(_e){const et=_e.decryptdata;if(et.pssh){const rt=this.createMediaKeySessionContext(_e),it=this.getKeyIdString(et),st="cenc";this.keyIdToKeySessionPromise[it]=this.generateRequestWithPreferredKeySession(rt,st,et.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(_e)}getKeyIdString(_e){if(!_e)throw new Error("Could not read keyId of undefined decryptdata");if(_e.keyId===null)throw new Error("keyId is null");return Hex.hexDump(_e.keyId)}updateKeySession(_e,et){var rt;const it=_e.mediaKeysSession;return this.log(`Updating key-session "${it.sessionId}" for keyID ${Hex.hexDump(((rt=_e.decryptdata)==null?void 0:rt.keyId)||[])}
      } (data length: ${et&&et.byteLength})`),it.update(et)}selectKeySystemFormat(_e){const et=Object.keys(_e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${_e.sn} ${_e.type}: ${_e.level}) key formats ${et.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(et)),this.keyFormatPromise}getKeyFormatPromise(_e){return new Promise((et,rt)=>{const it=getKeySystemsForConfig(this.config),st=_e.map(keySystemFormatToKeySystemDomain).filter(ot=>!!ot&&it.indexOf(ot)!==-1);return this.getKeySystemSelectionPromise(st).then(({keySystem:ot})=>{const at=keySystemDomainToKeySystemFormat(ot);at?et(at):rt(new Error(`Unable to find format for key-system "${ot}"`))}).catch(rt)})}loadKey(_e){const et=_e.keyInfo.decryptdata,rt=this.getKeyIdString(et),it=`(keyId: ${rt} format: "${et.keyFormat}" method: ${et.method} uri: ${et.uri})`;this.log(`Starting session for key ${it}`);let st=this.keyIdToKeySessionPromise[rt];return st||(st=this.keyIdToKeySessionPromise[rt]=this.getKeySystemForKeyPromise(et).then(({keySystem:ot,mediaKeys:at})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${_e.frag.sn} ${_e.frag.type}: ${_e.frag.level} using key ${it}`),this.attemptSetMediaKeys(ot,at).then(()=>{this.throwIfDestroyed();const lt=this.createMediaKeySessionContext({keySystem:ot,mediaKeys:at,decryptdata:et});return this.generateRequestWithPreferredKeySession(lt,"cenc",et.pssh,"playlist-key")}))),st.catch(ot=>this.handleError(ot))),st}throwIfDestroyed(_e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(_e){this.hls&&(this.error(_e.message),_e instanceof EMEKeyError?this.hls.trigger(Events.ERROR,_e.data):this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error:_e,fatal:!0}))}getKeySystemForKeyPromise(_e){const et=this.getKeyIdString(_e),rt=this.keyIdToKeySessionPromise[et];if(!rt){const it=keySystemFormatToKeySystemDomain(_e.keyFormat),st=it?[it]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(st)}return rt}getKeySystemSelectionPromise(_e){if(_e.length||(_e=getKeySystemsForConfig(this.config)),_e.length===0)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(_e)}_onMediaEncrypted(_e){const{initDataType:et,initData:rt}=_e,it=`"${_e.type}" event: init data type: "${et}"`;if(this.debug(it),rt===null)return;let st,ot;if(et==="sinf"&&this.config.drmSystems[KeySystems.FAIRPLAY]){const ht=bin2str(new Uint8Array(rt));try{const dt=base64Decode(JSON.parse(ht).sinf),ft=parseSinf(new Uint8Array(dt));if(!ft)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");st=ft.subarray(8,24),ot=KeySystems.FAIRPLAY}catch(dt){this.warn(`${it} Failed to parse sinf: ${dt}`);return}}else{const ht=parseMultiPssh(rt),dt=ht.filter(ft=>ft.systemId===KeySystemIds.WIDEVINE)[0];if(!dt){ht.length===0||ht.some(ft=>!ft.systemId)?this.warn(`${it} contains incomplete or invalid pssh data`):this.log(`ignoring ${it} for ${ht.map(ft=>keySystemIdToKeySystemDomain(ft.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(ot=keySystemIdToKeySystemDomain(dt.systemId),dt.version===0&&dt.data){const ft=dt.data.length-22;st=dt.data.subarray(ft,ft+16)}}if(!ot||!st)return;const at=Hex.hexDump(st),{keyIdToKeySessionPromise:lt,mediaKeySessions:ct}=this;let ut=lt[at];for(let ht=0;ht<ct.length;ht++){const dt=ct[ht],ft=dt.decryptdata;if(!ft.keyId)continue;const pt=Hex.hexDump(ft.keyId);if(at===pt||ft.uri.replace(/-/g,"").indexOf(at)!==-1){if(ut=lt[pt],ft.pssh)break;delete lt[pt],ft.pssh=new Uint8Array(rt),ft.keyId=st,ut=lt[at]=ut.then(()=>this.generateRequestWithPreferredKeySession(dt,et,rt,"encrypted-event-key-match"));break}}ut||(ut=lt[at]=this.getKeySystemSelectionPromise([ot]).then(({keySystem:ht,mediaKeys:dt})=>{var ft;this.throwIfDestroyed();const pt=new LevelKey("ISO-23001-7",at,(ft=keySystemDomainToKeySystemFormat(ht))!=null?ft:"");return pt.pssh=new Uint8Array(rt),pt.keyId=st,this.attemptSetMediaKeys(ht,dt).then(()=>{this.throwIfDestroyed();const mt=this.createMediaKeySessionContext({decryptdata:pt,keySystem:ht,mediaKeys:dt});return this.generateRequestWithPreferredKeySession(mt,et,rt,"encrypted-event-no-match")})})),ut.catch(ht=>this.handleError(ht))}_onWaitingForKey(_e){this.log(`"${_e.type}" event`)}attemptSetMediaKeys(_e,et){const rt=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${_e}"`);const it=Promise.all(rt).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(et)});return this.setMediaKeysQueue.push(it),it.then(()=>{this.log(`Media-keys set for "${_e}"`),rt.push(it),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(st=>rt.indexOf(st)===-1)})}generateRequestWithPreferredKeySession(_e,et,rt,it){var st,ot;const at=(st=this.config.drmSystems)==null||(ot=st[_e.keySystem])==null?void 0:ot.generateRequest;if(at)try{const pt=at.call(this.hls,et,rt,_e);if(!pt)throw new Error("Invalid response from configured generateRequest filter");et=pt.initDataType,rt=_e.decryptdata.pssh=pt.initData?new Uint8Array(pt.initData):null}catch(pt){var lt;if(this.warn(pt.message),(lt=this.hls)!=null&&lt.config.debug)throw pt}if(rt===null)return this.log(`Skipping key-session request for "${it}" (no initData)`),Promise.resolve(_e);const ct=this.getKeyIdString(_e.decryptdata);this.log(`Generating key-session request for "${it}": ${ct} (init data type: ${et} length: ${rt?rt.byteLength:null})`);const ut=new EventEmitter,ht=_e._onmessage=pt=>{const mt=_e.mediaKeysSession;if(!mt){ut.emit("error",new Error("invalid state"));return}const{messageType:At,message:gt}=pt;this.log(`"${At}" message event for session "${mt.sessionId}" message size: ${gt.byteLength}`),At==="license-request"||At==="license-renewal"?this.renewLicense(_e,gt).catch(bt=>{this.handleError(bt),ut.emit("error",bt)}):At==="license-release"?_e.keySystem===KeySystems.FAIRPLAY&&(this.updateKeySession(_e,strToUtf8array("acknowledged")),this.removeSession(_e)):this.warn(`unhandled media key message type "${At}"`)},dt=_e._onkeystatuseschange=pt=>{if(!_e.mediaKeysSession){ut.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(_e);const At=_e.keyStatus;ut.emit("keyStatus",At),At==="expired"&&(this.warn(`${_e.keySystem} expired for key ${ct}`),this.renewKeySession(_e))};_e.mediaKeysSession.addEventListener("message",ht),_e.mediaKeysSession.addEventListener("keystatuseschange",dt);const ft=new Promise((pt,mt)=>{ut.on("error",mt),ut.on("keyStatus",At=>{At.startsWith("usable")?pt():At==="output-restricted"?mt(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):At==="internal-error"?mt(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${At}"`)):At==="expired"?mt(new Error("key expired while generating request")):this.warn(`unhandled key status change "${At}"`)})});return _e.mediaKeysSession.generateRequest(et,rt).then(()=>{var pt;this.log(`Request generated for key-session "${(pt=_e.mediaKeysSession)==null?void 0:pt.sessionId}" keyId: ${ct}`)}).catch(pt=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error:pt,fatal:!1},`Error generating key-session request: ${pt}`)}).then(()=>ft).catch(pt=>{throw ut.removeAllListeners(),this.removeSession(_e),pt}).then(()=>(ut.removeAllListeners(),_e))}onKeyStatusChange(_e){_e.mediaKeysSession.keyStatuses.forEach((et,rt)=>{this.log(`key status change "${et}" for keyStatuses keyId: ${Hex.hexDump("buffer"in rt?new Uint8Array(rt.buffer,rt.byteOffset,rt.byteLength):new Uint8Array(rt))} session keyId: ${Hex.hexDump(new Uint8Array(_e.decryptdata.keyId||[]))} uri: ${_e.decryptdata.uri}`),_e.keyStatus=et})}fetchServerCertificate(_e){const et=this.config,rt=et.loader,it=new rt(et),st=this.getServerCertificateUrl(_e);return st?(this.log(`Fetching server certificate for "${_e}"`),new Promise((ot,at)=>{const lt={responseType:"arraybuffer",url:st},ct=et.certLoadPolicy.default,ut={loadPolicy:ct,timeout:ct.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},ht={onSuccess:(dt,ft,pt,mt)=>{ot(dt.data)},onError:(dt,ft,pt,mt)=>{at(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:pt,response:_objectSpread2$3({url:lt.url,data:void 0},dt)},`"${_e}" certificate request failed (${st}). Status: ${dt.code} (${dt.text})`))},onTimeout:(dt,ft,pt)=>{at(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:pt,response:{url:lt.url,data:void 0}},`"${_e}" certificate request timed out (${st})`))},onAbort:(dt,ft,pt)=>{at(new Error("aborted"))}};it.load(lt,ut,ht)})):Promise.resolve()}setMediaKeysServerCertificate(_e,et,rt){return new Promise((it,st)=>{_e.setServerCertificate(rt).then(ot=>{this.log(`setServerCertificate ${ot?"success":"not supported by CDM"} (${rt==null?void 0:rt.byteLength}) on "${et}"`),it(_e)}).catch(ot=>{st(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:ot,fatal:!0},ot.message))})})}renewLicense(_e,et){return this.requestLicense(_e,new Uint8Array(et)).then(rt=>this.updateKeySession(_e,new Uint8Array(rt)).catch(it=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:it,fatal:!0},it.message)}))}unpackPlayReadyKeyMessage(_e,et){const rt=String.fromCharCode.apply(null,new Uint16Array(et.buffer));if(!rt.includes("PlayReadyKeyMessage"))return _e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),et;const it=new DOMParser().parseFromString(rt,"application/xml"),st=it.querySelectorAll("HttpHeader");if(st.length>0){let ut;for(let ht=0,dt=st.length;ht<dt;ht++){var ot,at;ut=st[ht];const ft=(ot=ut.querySelector("name"))==null?void 0:ot.textContent,pt=(at=ut.querySelector("value"))==null?void 0:at.textContent;ft&&pt&&_e.setRequestHeader(ft,pt)}}const lt=it.querySelector("Challenge"),ct=lt==null?void 0:lt.textContent;if(!ct)throw new Error("Cannot find <Challenge> in key message");return strToUtf8array(atob(ct))}setupLicenseXHR(_e,et,rt,it){const st=this.config.licenseXhrSetup;return st?Promise.resolve().then(()=>{if(!rt.decryptdata)throw new Error("Key removed");return st.call(this.hls,_e,et,rt,it)}).catch(ot=>{if(!rt.decryptdata)throw ot;return _e.open("POST",et,!0),st.call(this.hls,_e,et,rt,it)}).then(ot=>(_e.readyState||_e.open("POST",et,!0),{xhr:_e,licenseChallenge:ot||it})):(_e.open("POST",et,!0),Promise.resolve({xhr:_e,licenseChallenge:it}))}requestLicense(_e,et){const rt=this.config.keyLoadPolicy.default;return new Promise((it,st)=>{const ot=this.getLicenseServerUrl(_e.keySystem);this.log(`Sending license request to URL: ${ot}`);const at=new XMLHttpRequest;at.responseType="arraybuffer",at.onreadystatechange=()=>{if(!this.hls||!_e.mediaKeysSession)return st(new Error("invalid state"));if(at.readyState===4)if(at.status===200){this._requestLicenseFailureCount=0;let lt=at.response;this.log(`License received ${lt instanceof ArrayBuffer?lt.byteLength:lt}`);const ct=this.config.licenseResponseCallback;if(ct)try{lt=ct.call(this.hls,at,ot,_e)}catch(ut){this.error(ut)}it(lt)}else{const lt=rt.errorRetry,ct=lt?lt.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>ct||at.status>=400&&at.status<500)st(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:at,response:{url:ot,data:void 0,code:at.status,text:at.statusText}},`License Request XHR failed (${ot}). Status: ${at.status} (${at.statusText})`));else{const ut=ct-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${ut} attempts left`),this.requestLicense(_e,et).then(it,st)}}},_e.licenseXhr&&_e.licenseXhr.readyState!==XMLHttpRequest.DONE&&_e.licenseXhr.abort(),_e.licenseXhr=at,this.setupLicenseXHR(at,ot,_e,et).then(({xhr:lt,licenseChallenge:ct})=>{_e.keySystem==KeySystems.PLAYREADY&&(ct=this.unpackPlayReadyKeyMessage(lt,ct)),lt.send(ct)})})}onMediaAttached(_e,et){if(!this.config.emeEnabled)return;const rt=et.media;this.media=rt,rt.addEventListener("encrypted",this.onMediaEncrypted),rt.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const _e=this.media,et=this.mediaKeySessions;_e&&(_e.removeEventListener("encrypted",this.onMediaEncrypted),_e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},LevelKey.clearKeyUriToKeyIdMap();const rt=et.length;EMEController.CDMCleanupPromise=Promise.all(et.map(it=>this.removeSession(it)).concat(_e==null?void 0:_e.setMediaKeys(null).catch(it=>{this.log(`Could not clear media keys: ${it}`)}))).then(()=>{rt&&(this.log("finished closing key sessions and clearing media keys"),et.length=0)}).catch(it=>{this.log(`Could not close sessions and clear media keys: ${it}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(_e,{sessionKeys:et}){if(!(!et||!this.config.emeEnabled)&&!this.keyFormatPromise){const rt=et.reduce((it,st)=>(it.indexOf(st.keyFormat)===-1&&it.push(st.keyFormat),it),[]);this.log(`Selecting key-system from session-keys ${rt.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(rt)}}removeSession(_e){const{mediaKeysSession:et,licenseXhr:rt}=_e;if(et){this.log(`Remove licenses and keys and close session ${et.sessionId}`),_e._onmessage&&(et.removeEventListener("message",_e._onmessage),_e._onmessage=void 0),_e._onkeystatuseschange&&(et.removeEventListener("keystatuseschange",_e._onkeystatuseschange),_e._onkeystatuseschange=void 0),rt&&rt.readyState!==XMLHttpRequest.DONE&&rt.abort(),_e.mediaKeysSession=_e.decryptdata=_e.licenseXhr=void 0;const it=this.mediaKeySessions.indexOf(_e);return it>-1&&this.mediaKeySessions.splice(it,1),et.remove().catch(st=>{this.log(`Could not remove session: ${st}`)}).then(()=>et.close()).catch(st=>{this.log(`Could not close session: ${st}`)})}}}EMEController.CDMCleanupPromise=void 0;class EMEKeyError extends Error{constructor(_e,et){super(et),this.data=void 0,_e.error||(_e.error=new Error(et)),this.data=_e,_e.err=_e.error}}var CmObjectType;(function(nt){nt.MANIFEST="m",nt.AUDIO="a",nt.VIDEO="v",nt.MUXED="av",nt.INIT="i",nt.CAPTION="c",nt.TIMED_TEXT="tt",nt.KEY="k",nt.OTHER="o"})(CmObjectType||(CmObjectType={}));var CmStreamingFormat;(function(nt){nt.DASH="d",nt.HLS="h",nt.SMOOTH="s",nt.OTHER="o"})(CmStreamingFormat||(CmStreamingFormat={}));var CmcdHeaderField;(function(nt){nt.OBJECT="CMCD-Object",nt.REQUEST="CMCD-Request",nt.SESSION="CMCD-Session",nt.STATUS="CMCD-Status"})(CmcdHeaderField||(CmcdHeaderField={}));const CmcdHeaderMap={[CmcdHeaderField.OBJECT]:["br","d","ot","tb"],[CmcdHeaderField.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[CmcdHeaderField.SESSION]:["cid","pr","sf","sid","st","v"],[CmcdHeaderField.STATUS]:["bs","rtp"]};class SfItem{constructor(_e,et){this.value=void 0,this.params=void 0,Array.isArray(_e)&&(_e=_e.map(rt=>rt instanceof SfItem?rt:new SfItem(rt))),this.value=_e,this.params=et}}class SfToken{constructor(_e){this.description=void 0,this.description=_e}}const DICT="Dict";function format$1(nt){return Array.isArray(nt)?JSON.stringify(nt):nt instanceof Map?"Map{}":nt instanceof Set?"Set{}":typeof nt=="object"?JSON.stringify(nt):String(nt)}function throwError(nt,_e,et,rt){return new Error(`failed to ${nt} "${format$1(_e)}" as ${et}`,{cause:rt})}const BARE_ITEM="Bare Item",BOOLEAN$1="Boolean",BYTES="Byte Sequence",DECIMAL="Decimal",INTEGER="Integer";function isInvalidInt(nt){return nt<-999999999999999||999999999999999<nt}const STRING_REGEX=/[\x00-\x1f\x7f]+/,TOKEN="Token",KEY="Key";function serializeError(nt,_e,et){return throwError("serialize",nt,_e,et)}function serializeBoolean(nt){if(typeof nt!="boolean")throw serializeError(nt,BOOLEAN$1);return nt?"?1":"?0"}function base64encode(nt){return btoa(String.fromCharCode(...nt))}function serializeByteSequence(nt){if(ArrayBuffer.isView(nt)===!1)throw serializeError(nt,BYTES);return`:${base64encode(nt)}:`}function serializeInteger(nt){if(isInvalidInt(nt))throw serializeError(nt,INTEGER);return nt.toString()}function serializeDate(nt){return`@${serializeInteger(nt.getTime()/1e3)}`}function roundToEven(nt,_e){if(nt<0)return-roundToEven(-nt,_e);const et=Math.pow(10,_e);if(Math.abs(nt*et%1-.5)<Number.EPSILON){const it=Math.floor(nt*et);return(it%2===0?it:it+1)/et}else return Math.round(nt*et)/et}function serializeDecimal(nt){const _e=roundToEven(nt,3);if(Math.floor(Math.abs(_e)).toString().length>12)throw serializeError(nt,DECIMAL);const et=_e.toString();return et.includes(".")?et:`${et}.0`}const STRING="String";function serializeString(nt){if(STRING_REGEX.test(nt))throw serializeError(nt,STRING);return`"${nt.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function symbolToStr(nt){return nt.description||nt.toString().slice(7,-1)}function serializeToken(nt){const _e=symbolToStr(nt);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(_e)===!1)throw serializeError(_e,TOKEN);return _e}function serializeBareItem(nt){switch(typeof nt){case"number":if(!isFiniteNumber(nt))throw serializeError(nt,BARE_ITEM);return Number.isInteger(nt)?serializeInteger(nt):serializeDecimal(nt);case"string":return serializeString(nt);case"symbol":return serializeToken(nt);case"boolean":return serializeBoolean(nt);case"object":if(nt instanceof Date)return serializeDate(nt);if(nt instanceof Uint8Array)return serializeByteSequence(nt);if(nt instanceof SfToken)return serializeToken(nt);default:throw serializeError(nt,BARE_ITEM)}}function serializeKey(nt){if(/^[a-z*][a-z0-9\-_.*]*$/.test(nt)===!1)throw serializeError(nt,KEY);return nt}function serializeParams(nt){return nt==null?"":Object.entries(nt).map(([_e,et])=>et===!0?`;${serializeKey(_e)}`:`;${serializeKey(_e)}=${serializeBareItem(et)}`).join("")}function serializeItem(nt){return nt instanceof SfItem?`${serializeBareItem(nt.value)}${serializeParams(nt.params)}`:serializeBareItem(nt)}function serializeInnerList(nt){return`(${nt.value.map(serializeItem).join(" ")})${serializeParams(nt.params)}`}function serializeDict(nt,_e={whitespace:!0}){if(typeof nt!="object")throw serializeError(nt,DICT);const et=nt instanceof Map?nt.entries():Object.entries(nt),rt=_e!=null&&_e.whitespace?" ":"";return Array.from(et).map(([it,st])=>{st instanceof SfItem||(st=new SfItem(st));let ot=serializeKey(it);return st.value===!0?ot+=serializeParams(st.params):(ot+="=",Array.isArray(st.value)?ot+=serializeInnerList(st):ot+=serializeItem(st)),ot}).join(`,${rt}`)}function encodeSfDict(nt,_e){return serializeDict(nt,_e)}const isTokenField=nt=>nt==="ot"||nt==="sf"||nt==="st",isValid=nt=>typeof nt=="number"?isFiniteNumber(nt):nt!=null&&nt!==""&&nt!==!1;function urlToRelativePath(nt,_e){const et=new URL(nt),rt=new URL(_e);if(et.origin!==rt.origin)return nt;const it=et.pathname.split("/").slice(1),st=rt.pathname.split("/").slice(1,-1);for(;it[0]===st[0];)it.shift(),st.shift();for(;st.length;)st.shift(),it.unshift("..");return it.join("/")}function uuid(){try{return crypto.randomUUID()}catch{try{const _e=URL.createObjectURL(new Blob),et=_e.toString();return URL.revokeObjectURL(_e),et.slice(et.lastIndexOf("/")+1)}catch{let et=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,it=>{const st=(et+Math.random()*16)%16|0;return et=Math.floor(et/16),(it=="x"?st:st&3|8).toString(16)})}}}const toRounded=nt=>Math.round(nt),toUrlSafe=(nt,_e)=>(_e!=null&&_e.baseUrl&&(nt=urlToRelativePath(nt,_e.baseUrl)),encodeURIComponent(nt)),toHundred=nt=>toRounded(nt/100)*100,CmcdFormatters={br:toRounded,d:toRounded,bl:toHundred,dl:toHundred,mtp:toHundred,nor:toUrlSafe,rtp:toHundred,tb:toRounded};function processCmcd(nt,_e){const et={};if(nt==null||typeof nt!="object")return et;const rt=Object.keys(nt).sort(),it=_extends$1({},CmcdFormatters,_e==null?void 0:_e.formatters),st=_e==null?void 0:_e.filter;return rt.forEach(ot=>{if(st!=null&&st(ot))return;let at=nt[ot];const lt=it[ot];lt&&(at=lt(at,_e)),!(ot==="v"&&at===1)&&(ot=="pr"&&at===1||isValid(at)&&(isTokenField(ot)&&typeof at=="string"&&(at=new SfToken(at)),et[ot]=at))}),et}function encodeCmcd(nt,_e={}){return nt?encodeSfDict(processCmcd(nt,_e),_extends$1({whitespace:!1},_e)):""}function toCmcdHeaders(nt,_e={}){if(!nt)return{};const et=Object.entries(nt),rt=Object.entries(CmcdHeaderMap).concat(Object.entries((_e==null?void 0:_e.customHeaderMap)||{})),it=et.reduce((st,ot)=>{var at,lt;const[ct,ut]=ot,ht=((at=rt.find(dt=>dt[1].includes(ct)))==null?void 0:at[0])||CmcdHeaderField.REQUEST;return(lt=st[ht])!=null||(st[ht]={}),st[ht][ct]=ut,st},{});return Object.entries(it).reduce((st,[ot,at])=>(st[ot]=encodeCmcd(at,_e),st),{})}function appendCmcdHeaders(nt,_e,et){return _extends$1(nt,toCmcdHeaders(_e,et))}const CMCD_PARAM="CMCD";function toCmcdQuery(nt,_e={}){if(!nt)return"";const et=encodeCmcd(nt,_e);return`${CMCD_PARAM}=${encodeURIComponent(et)}`}const REGEX=/CMCD=[^&#]+/;function appendCmcdQuery(nt,_e,et){const rt=toCmcdQuery(_e,et);if(!rt)return nt;if(REGEX.test(nt))return nt.replace(REGEX,rt);const it=nt.includes("?")?"&":"?";return`${nt}${it}${rt}`}class CMCDController{constructor(_e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=it=>{try{this.apply(it,{ot:CmObjectType.MANIFEST,su:!this.initialized})}catch(st){logger.warn("Could not generate manifest CMCD data.",st)}},this.applyFragmentData=it=>{try{const st=it.frag,ot=this.hls.levels[st.level],at=this.getObjectType(st),lt={d:st.duration*1e3,ot:at};(at===CmObjectType.VIDEO||at===CmObjectType.AUDIO||at==CmObjectType.MUXED)&&(lt.br=ot.bitrate/1e3,lt.tb=this.getTopBandwidth(at)/1e3,lt.bl=this.getBufferLength(at)),this.apply(it,lt)}catch(st){logger.warn("Could not generate segment CMCD data.",st)}},this.hls=_e;const et=this.config=_e.config,{cmcd:rt}=et;rt!=null&&(et.pLoader=this.createPlaylistLoader(),et.fLoader=this.createFragmentLoader(),this.sid=rt.sessionId||uuid(),this.cid=rt.contentId,this.useHeaders=rt.useHeaders===!0,this.includeKeys=rt.includeKeys,this.registerListeners())}registerListeners(){const _e=this.hls;_e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),_e.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const _e=this.hls;_e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),_e.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(_e,et){this.media=et.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(_e,et){var rt,it;this.audioBuffer=(rt=et.tracks.audio)==null?void 0:rt.buffer,this.videoBuffer=(it=et.tracks.video)==null?void 0:it.buffer}createData(){var _e;return{v:1,sf:CmStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(_e=this.media)==null?void 0:_e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(_e,et={}){_extends$1(et,this.createData());const rt=et.ot===CmObjectType.INIT||et.ot===CmObjectType.VIDEO||et.ot===CmObjectType.MUXED;this.starved&&rt&&(et.bs=!0,et.su=!0,this.starved=!1),et.su==null&&(et.su=this.buffering);const{includeKeys:it}=this;it&&(et=Object.keys(et).reduce((st,ot)=>(it.includes(ot)&&(st[ot]=et[ot]),st),{})),this.useHeaders?(_e.headers||(_e.headers={}),appendCmcdHeaders(_e.headers,et)):_e.url=appendCmcdQuery(_e.url,et)}getObjectType(_e){const{type:et}=_e;if(et==="subtitle")return CmObjectType.TIMED_TEXT;if(_e.sn==="initSegment")return CmObjectType.INIT;if(et==="audio")return CmObjectType.AUDIO;if(et==="main")return this.hls.audioTracks.length?CmObjectType.VIDEO:CmObjectType.MUXED}getTopBandwidth(_e){let et=0,rt;const it=this.hls;if(_e===CmObjectType.AUDIO)rt=it.audioTracks;else{const st=it.maxAutoLevel,ot=st>-1?st+1:it.levels.length;rt=it.levels.slice(0,ot)}for(const st of rt)st.bitrate>et&&(et=st.bitrate);return et>0?et:NaN}getBufferLength(_e){const et=this.hls.media,rt=_e===CmObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return!rt||!et?NaN:BufferHelper.bufferInfo(rt,et.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:_e}=this.config,et=this.applyPlaylistData,rt=_e||this.config.loader;return class{constructor(st){this.loader=void 0,this.loader=new rt(st)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(st,ot,at){et(st),this.loader.load(st,ot,at)}}}createFragmentLoader(){const{fLoader:_e}=this.config,et=this.applyFragmentData,rt=_e||this.config.loader;return class{constructor(st){this.loader=void 0,this.loader=new rt(st)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(st,ot,at){et(st),this.loader.load(st,ot,at)}}}}const PATHWAY_PENALTY_DURATION_MS=3e5;class ContentSteeringController{constructor(_e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=_e,this.log=logger.log.bind(logger,"[content-steering]:"),this.registerListeners()}registerListeners(){const _e=this.hls;_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),_e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const _e=this.hls;_e&&(_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),_e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.off(Events.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const _e=this.timeToLoad*1e3-(performance.now()-this.updated);if(_e>0){this.scheduleRefresh(this.uri,_e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(_e){const et=this.levels;et&&(this.levels=et.filter(rt=>rt!==_e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(_e,et){const{contentSteering:rt}=et;rt!==null&&(this.pathwayId=rt.pathwayId,this.uri=rt.uri,this.started&&this.startLoad())}onManifestParsed(_e,et){this.audioTracks=et.audioTracks,this.subtitleTracks=et.subtitleTracks}onError(_e,et){const{errorAction:rt}=et;if((rt==null?void 0:rt.action)===NetworkErrorAction.SendAlternateToPenaltyBox&&rt.flags===ErrorActionFlags.MoveAllAlternatesMatchingHost){const it=this.levels;let st=this.pathwayPriority,ot=this.pathwayId;if(et.context){const{groupId:at,pathwayId:lt,type:ct}=et.context;at&&it?ot=this.getPathwayForGroupId(at,ct,ot):lt&&(ot=lt)}ot in this.penalizedPathways||(this.penalizedPathways[ot]=performance.now()),!st&&it&&(st=it.reduce((at,lt)=>(at.indexOf(lt.pathwayId)===-1&&at.push(lt.pathwayId),at),[])),st&&st.length>1&&(this.updatePathwayPriority(st),rt.resolved=this.pathwayId!==ot),rt.resolved||logger.warn(`Could not resolve ${et.details} ("${et.error.message}") with content-steering for Pathway: ${ot} levels: ${it&&it.length} priorities: ${JSON.stringify(st)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(_e){this.levels=_e;let et=this.getLevelsForPathway(this.pathwayId);if(et.length===0){const rt=_e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${rt}"`),et=this.getLevelsForPathway(rt),this.pathwayId=rt}return et.length!==_e.length&&this.log(`Found ${et.length}/${_e.length} levels in Pathway "${this.pathwayId}"`),et}getLevelsForPathway(_e){return this.levels===null?[]:this.levels.filter(et=>_e===et.pathwayId)}updatePathwayPriority(_e){this.pathwayPriority=_e;let et;const rt=this.penalizedPathways,it=performance.now();Object.keys(rt).forEach(st=>{it-rt[st]>PATHWAY_PENALTY_DURATION_MS&&delete rt[st]});for(let st=0;st<_e.length;st++){const ot=_e[st];if(ot in rt)continue;if(ot===this.pathwayId)return;const at=this.hls.nextLoadLevel,lt=this.hls.levels[at];if(et=this.getLevelsForPathway(ot),et.length>0){this.log(`Setting Pathway to "${ot}"`),this.pathwayId=ot,reassignFragmentLevelIndexes(et),this.hls.trigger(Events.LEVELS_UPDATED,{levels:et});const ct=this.hls.levels[at];lt&&ct&&this.levels&&(ct.attrs["STABLE-VARIANT-ID"]!==lt.attrs["STABLE-VARIANT-ID"]&&ct.bitrate!==lt.bitrate&&this.log(`Unstable Pathways change from bitrate ${lt.bitrate} to ${ct.bitrate}`),this.hls.nextLoadLevel=at);break}}}getPathwayForGroupId(_e,et,rt){const it=this.getLevelsForPathway(rt).concat(this.levels||[]);for(let st=0;st<it.length;st++)if(et===PlaylistContextType.AUDIO_TRACK&&it[st].hasAudioGroup(_e)||et===PlaylistContextType.SUBTITLE_TRACK&&it[st].hasSubtitleGroup(_e))return it[st].pathwayId;return rt}clonePathways(_e){const et=this.levels;if(!et)return;const rt={},it={};_e.forEach(st=>{const{ID:ot,"BASE-ID":at,"URI-REPLACEMENT":lt}=st;if(et.some(ut=>ut.pathwayId===ot))return;const ct=this.getLevelsForPathway(at).map(ut=>{const ht=new AttrList(ut.attrs);ht["PATHWAY-ID"]=ot;const dt=ht.AUDIO&&`${ht.AUDIO}_clone_${ot}`,ft=ht.SUBTITLES&&`${ht.SUBTITLES}_clone_${ot}`;dt&&(rt[ht.AUDIO]=dt,ht.AUDIO=dt),ft&&(it[ht.SUBTITLES]=ft,ht.SUBTITLES=ft);const pt=performUriReplacement(ut.uri,ht["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",lt),mt=new Level({attrs:ht,audioCodec:ut.audioCodec,bitrate:ut.bitrate,height:ut.height,name:ut.name,url:pt,videoCodec:ut.videoCodec,width:ut.width});if(ut.audioGroups)for(let At=1;At<ut.audioGroups.length;At++)mt.addGroupId("audio",`${ut.audioGroups[At]}_clone_${ot}`);if(ut.subtitleGroups)for(let At=1;At<ut.subtitleGroups.length;At++)mt.addGroupId("text",`${ut.subtitleGroups[At]}_clone_${ot}`);return mt});et.push(...ct),cloneRenditionGroups(this.audioTracks,rt,lt,ot),cloneRenditionGroups(this.subtitleTracks,it,lt,ot)})}loadSteeringManifest(_e){const et=this.hls.config,rt=et.loader;this.loader&&this.loader.destroy(),this.loader=new rt(et);let it;try{it=new self.URL(_e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${_e}`);return}if(it.protocol!=="data:"){const ut=(this.hls.bandwidthEstimate||et.abrEwmaDefaultEstimate)|0;it.searchParams.set("_HLS_pathway",this.pathwayId),it.searchParams.set("_HLS_throughput",""+ut)}const st={responseType:"json",url:it.href},ot=et.steeringManifestLoadPolicy.default,at=ot.errorRetry||ot.timeoutRetry||{},lt={loadPolicy:ot,timeout:ot.maxLoadTimeMs,maxRetry:at.maxNumRetry||0,retryDelay:at.retryDelayMs||0,maxRetryDelay:at.maxRetryDelayMs||0},ct={onSuccess:(ut,ht,dt,ft)=>{this.log(`Loaded steering manifest: "${it}"`);const pt=ut.data;if(pt.VERSION!==1){this.log(`Steering VERSION ${pt.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=pt.TTL;const{"RELOAD-URI":mt,"PATHWAY-CLONES":At,"PATHWAY-PRIORITY":gt}=pt;if(mt)try{this.uri=new self.URL(mt,it).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${mt}`);return}this.scheduleRefresh(this.uri||dt.url),At&&this.clonePathways(At);const bt={steeringManifest:pt,url:it.toString()};this.hls.trigger(Events.STEERING_MANIFEST_LOADED,bt),gt&&this.updatePathwayPriority(gt)},onError:(ut,ht,dt,ft)=>{if(this.log(`Error loading steering manifest: ${ut.code} ${ut.text} (${ht.url})`),this.stopLoad(),ut.code===410){this.enabled=!1,this.log(`Steering manifest ${ht.url} no longer available`);return}let pt=this.timeToLoad*1e3;if(ut.code===429){const mt=this.loader;if(typeof(mt==null?void 0:mt.getResponseHeader)=="function"){const At=mt.getResponseHeader("Retry-After");At&&(pt=parseFloat(At)*1e3)}this.log(`Steering manifest ${ht.url} rate limited`);return}this.scheduleRefresh(this.uri||ht.url,pt)},onTimeout:(ut,ht,dt)=>{this.log(`Timeout loading steering manifest (${ht.url})`),this.scheduleRefresh(this.uri||ht.url)}};this.log(`Requesting steering manifest: ${it}`),this.loader.load(st,lt,ct)}scheduleRefresh(_e,et=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var rt;const it=(rt=this.hls)==null?void 0:rt.media;if(it&&!it.ended){this.loadSteeringManifest(_e);return}this.scheduleRefresh(_e,this.timeToLoad*1e3)},et)}}function cloneRenditionGroups(nt,_e,et,rt){nt&&Object.keys(_e).forEach(it=>{const st=nt.filter(ot=>ot.groupId===it).map(ot=>{const at=_extends$1({},ot);return at.details=void 0,at.attrs=new AttrList(at.attrs),at.url=at.attrs.URI=performUriReplacement(ot.url,ot.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",et),at.groupId=at.attrs["GROUP-ID"]=_e[it],at.attrs["PATHWAY-ID"]=rt,at});nt.push(...st)})}function performUriReplacement(nt,_e,et,rt){const{HOST:it,PARAMS:st,[et]:ot}=rt;let at;_e&&(at=ot==null?void 0:ot[_e],at&&(nt=at));const lt=new self.URL(nt);return it&&!at&&(lt.host=it),st&&Object.keys(st).sort().forEach(ct=>{ct&&lt.searchParams.set(ct,st[ct])}),lt.href}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(_e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=_e&&_e.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const _e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),_e&&(_e.onreadystatechange=null,_e.onprogress=null,_e.readyState!==4&&(this.stats.aborted=!0,_e.abort()))}abort(){var _e;this.abortInternal(),(_e=this.callbacks)!=null&&_e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(_e,et,rt){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=_e,this.config=et,this.callbacks=rt,this.loadInternal()}loadInternal(){const{config:_e,context:et}=this;if(!_e||!et)return;const rt=this.loader=new self.XMLHttpRequest,it=this.stats;it.loading.first=0,it.loaded=0,it.aborted=!1;const st=this.xhrSetup;st?Promise.resolve().then(()=>{if(!(this.loader!==rt||this.stats.aborted))return st(rt,et.url)}).catch(ot=>{if(!(this.loader!==rt||this.stats.aborted))return rt.open("GET",et.url,!0),st(rt,et.url)}).then(()=>{this.loader!==rt||this.stats.aborted||this.openAndSendXhr(rt,et,_e)}).catch(ot=>{this.callbacks.onError({code:rt.status,text:ot.message},et,rt,it)}):this.openAndSendXhr(rt,et,_e)}openAndSendXhr(_e,et,rt){_e.readyState||_e.open("GET",et.url,!0);const it=et.headers,{maxTimeToFirstByteMs:st,maxLoadTimeMs:ot}=rt.loadPolicy;if(it)for(const at in it)_e.setRequestHeader(at,it[at]);et.rangeEnd&&_e.setRequestHeader("Range","bytes="+et.rangeStart+"-"+(et.rangeEnd-1)),_e.onreadystatechange=this.readystatechange.bind(this),_e.onprogress=this.loadprogress.bind(this),_e.responseType=et.responseType,self.clearTimeout(this.requestTimeout),rt.timeout=st&&isFiniteNumber(st)?st:ot,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),rt.timeout),_e.send()}readystatechange(){const{context:_e,loader:et,stats:rt}=this;if(!_e||!et)return;const it=et.readyState,st=this.config;if(!rt.aborted&&it>=2&&(rt.loading.first===0&&(rt.loading.first=Math.max(self.performance.now(),rt.loading.start),st.timeout!==st.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),st.timeout=st.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),st.loadPolicy.maxLoadTimeMs-(rt.loading.first-rt.loading.start)))),it===4)){self.clearTimeout(this.requestTimeout),et.onreadystatechange=null,et.onprogress=null;const ot=et.status,at=et.responseType!=="text";if(ot>=200&&ot<300&&(at&&et.response||et.responseText!==null)){rt.loading.end=Math.max(self.performance.now(),rt.loading.first);const lt=at?et.response:et.responseText,ct=et.responseType==="arraybuffer"?lt.byteLength:lt.length;if(rt.loaded=rt.total=ct,rt.bwEstimate=rt.total*8e3/(rt.loading.end-rt.loading.first),!this.callbacks)return;const ut=this.callbacks.onProgress;if(ut&&ut(rt,_e,lt,et),!this.callbacks)return;const ht={url:et.responseURL,data:lt,code:ot};this.callbacks.onSuccess(ht,rt,_e,et)}else{const lt=st.loadPolicy.errorRetry,ct=rt.retry,ut={url:_e.url,data:void 0,code:ot};shouldRetry(lt,ct,!1,ut)?this.retry(lt):(logger.error(`${ot} while loading ${_e.url}`),this.callbacks.onError({code:ot,text:et.statusText},_e,et,rt))}}}loadtimeout(){if(!this.config)return;const _e=this.config.loadPolicy.timeoutRetry,et=this.stats.retry;if(shouldRetry(_e,et,!0))this.retry(_e);else{var rt;logger.warn(`timeout while loading ${(rt=this.context)==null?void 0:rt.url}`);const it=this.callbacks;it&&(this.abortInternal(),it.onTimeout(this.stats,this.context,this.loader))}}retry(_e){const{context:et,stats:rt}=this;this.retryDelay=getRetryDelay(_e,rt.retry),rt.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${et==null?void 0:et.url}, retrying ${rt.retry}/${_e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(_e){const et=this.stats;et.loaded=_e.loaded,_e.lengthComputable&&(et.total=_e.total)}getCacheAge(){let _e=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const et=this.loader.getResponseHeader("age");_e=et?parseFloat(et):null}return _e}getResponseHeader(_e){return this.loader&&new RegExp(`^${_e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(_e):null}}function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(_e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=_e.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var _e;this.abortInternal(),(_e=this.callbacks)!=null&&_e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(_e,et,rt){const it=this.stats;if(it.loading.start)throw new Error("Loader can only be used once.");it.loading.start=self.performance.now();const st=getRequestParameters(_e,this.controller.signal),ot=rt.onProgress,at=_e.responseType==="arraybuffer",lt=at?"byteLength":"length",{maxTimeToFirstByteMs:ct,maxLoadTimeMs:ut}=et.loadPolicy;this.context=_e,this.config=et,this.callbacks=rt,this.request=this.fetchSetup(_e,st),self.clearTimeout(this.requestTimeout),et.timeout=ct&&isFiniteNumber(ct)?ct:ut,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),rt.onTimeout(it,_e,this.response)},et.timeout),self.fetch(this.request).then(ht=>{this.response=this.loader=ht;const dt=Math.max(self.performance.now(),it.loading.start);if(self.clearTimeout(this.requestTimeout),et.timeout=ut,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),rt.onTimeout(it,_e,this.response)},ut-(dt-it.loading.start)),!ht.ok){const{status:ft,statusText:pt}=ht;throw new FetchError(pt||"fetch, bad network response",ft,ht)}return it.loading.first=dt,it.total=getContentLength(ht.headers)||it.total,ot&&isFiniteNumber(et.highWaterMark)?this.loadProgressively(ht,it,_e,et.highWaterMark,ot):at?ht.arrayBuffer():_e.responseType==="json"?ht.json():ht.text()}).then(ht=>{const dt=this.response;if(!dt)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),it.loading.end=Math.max(self.performance.now(),it.loading.first);const ft=ht[lt];ft&&(it.loaded=it.total=ft);const pt={url:dt.url,data:ht,code:dt.status};ot&&!isFiniteNumber(et.highWaterMark)&&ot(it,_e,ht,dt),rt.onSuccess(pt,it,_e,dt)}).catch(ht=>{if(self.clearTimeout(this.requestTimeout),it.aborted)return;const dt=ht&&ht.code||0,ft=ht?ht.message:null;rt.onError({code:dt,text:ft},_e,ht?ht.details:null,it)})}getCacheAge(){let _e=null;if(this.response){const et=this.response.headers.get("age");_e=et?parseFloat(et):null}return _e}getResponseHeader(_e){return this.response?this.response.headers.get(_e):null}loadProgressively(_e,et,rt,it=0,st){const ot=new ChunkCache,at=_e.body.getReader(),lt=()=>at.read().then(ct=>{if(ct.done)return ot.dataLength&&st(et,rt,ot.flush(),_e),Promise.resolve(new ArrayBuffer(0));const ut=ct.value,ht=ut.length;return et.loaded+=ht,ht<it||ot.dataLength?(ot.push(ut),ot.dataLength>=it&&st(et,rt,ot.flush(),_e)):st(et,rt,ut,_e),lt()}).catch(()=>Promise.reject());return lt()}}function getRequestParameters(nt,_e){const et={method:"GET",mode:"cors",credentials:"same-origin",signal:_e,headers:new self.Headers(_extends$1({},nt.headers))};return nt.rangeEnd&&et.headers.set("Range","bytes="+nt.rangeStart+"-"+String(nt.rangeEnd-1)),et}function getByteRangeLength(nt){const _e=BYTERANGE.exec(nt);if(_e)return parseInt(_e[2])-parseInt(_e[1])+1}function getContentLength(nt){const _e=nt.get("Content-Range");if(_e){const rt=getByteRangeLength(_e);if(isFiniteNumber(rt))return rt}const et=nt.get("Content-Length");if(et)return parseInt(et)}function getRequest(nt,_e){return new self.Request(nt.url,_e)}class FetchError extends Error{constructor(_e,et,rt){super(_e),this.code=void 0,this.details=void 0,this.code=et,this.details=rt}}const WHITESPACE_CHAR=/\s/,Cues={newCue(nt,_e,et,rt){const it=[];let st,ot,at,lt,ct;const ut=self.VTTCue||self.TextTrackCue;for(let dt=0;dt<rt.rows.length;dt++)if(st=rt.rows[dt],at=!0,lt=0,ct="",!st.isEmpty()){var ht;for(let mt=0;mt<st.chars.length;mt++)WHITESPACE_CHAR.test(st.chars[mt].uchar)&&at?lt++:(ct+=st.chars[mt].uchar,at=!1);st.cueStartTime=_e,_e===et&&(et+=1e-4),lt>=16?lt--:lt++;const ft=fixLineBreaks(ct.trim()),pt=generateCueId(_e,et,ft);nt!=null&&(ht=nt.cues)!=null&&ht.getCueById(pt)||(ot=new ut(_e,et,ft),ot.id=pt,ot.line=dt+1,ot.align="left",ot.position=10+Math.min(80,Math.floor(lt*8/32)*10),it.push(ot))}return nt&&it.length&&(it.sort((dt,ft)=>dt.line==="auto"||ft.line==="auto"?0:dt.line>8&&ft.line>8?ft.line-dt.line:dt.line-ft.line),it.forEach(dt=>addCueToTrack(nt,dt))),it}},defaultLoadPolicy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},hlsDefaultConfig=_objectSpread2$3(_objectSpread2$3({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AbrController,bufferController:BufferController,capLevelController:CapLevelController,errorController:ErrorController,fpsController:FPSController,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:defaultLoadPolicy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},timelineConfig()),{},{subtitleStreamController:SubtitleStreamController,subtitleTrackController:SubtitleTrackController,timelineController:TimelineController,audioStreamController:AudioStreamController,audioTrackController:AudioTrackController,emeController:EMEController,cmcdController:CMCDController,contentSteeringController:ContentSteeringController});function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function mergeConfig(nt,_e){if((_e.liveSyncDurationCount||_e.liveMaxLatencyDurationCount)&&(_e.liveSyncDuration||_e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(_e.liveMaxLatencyDurationCount!==void 0&&(_e.liveSyncDurationCount===void 0||_e.liveMaxLatencyDurationCount<=_e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(_e.liveMaxLatencyDuration!==void 0&&(_e.liveSyncDuration===void 0||_e.liveMaxLatencyDuration<=_e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const et=deepCpy(nt),rt=["manifest","level","frag"],it=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return rt.forEach(st=>{const ot=`${st==="level"?"playlist":st}LoadPolicy`,at=_e[ot]===void 0,lt=[];it.forEach(ct=>{const ut=`${st}Loading${ct}`,ht=_e[ut];if(ht!==void 0&&at){lt.push(ut);const dt=et[ot].default;switch(_e[ot]={default:dt},ct){case"TimeOut":dt.maxLoadTimeMs=ht,dt.maxTimeToFirstByteMs=ht;break;case"MaxRetry":dt.errorRetry.maxNumRetry=ht,dt.timeoutRetry.maxNumRetry=ht;break;case"RetryDelay":dt.errorRetry.retryDelayMs=ht,dt.timeoutRetry.retryDelayMs=ht;break;case"MaxRetryTimeout":dt.errorRetry.maxRetryDelayMs=ht,dt.timeoutRetry.maxRetryDelayMs=ht;break}}}),lt.length&&logger.warn(`hls.js config: "${lt.join('", "')}" setting(s) are deprecated, use "${ot}": ${JSON.stringify(_e[ot])}`)}),_objectSpread2$3(_objectSpread2$3({},et),_e)}function deepCpy(nt){return nt&&typeof nt=="object"?Array.isArray(nt)?nt.map(deepCpy):Object.keys(nt).reduce((_e,et)=>(_e[et]=deepCpy(nt[et]),_e),{}):nt}function enableStreamingMode(nt){const _e=nt.loader;_e!==FetchLoader&&_e!==XhrLoader?(logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),nt.progressive=!1):fetchSupported()&&(nt.loader=FetchLoader,nt.progressive=!0,nt.enableSoftwareAES=!0,logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}let chromeOrFirefox;class LevelController extends BasePlaylistController{constructor(_e,et){super(_e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=et,this._registerListeners()}_registerListeners(){const{hls:_e}=this;_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),_e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),_e.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls:_e}=this;_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),_e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),_e.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(et=>{et.loadError=0,et.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(_e,et){this.resetLevels()}onManifestLoaded(_e,et){const rt=this.hls.config.preferManagedMediaSource,it=[],st={},ot={};let at=!1,lt=!1,ct=!1;et.levels.forEach(ut=>{var ht,dt;const ft=ut.attrs;let{audioCodec:pt,videoCodec:mt}=ut;((ht=pt)==null?void 0:ht.indexOf("mp4a.40.34"))!==-1&&(chromeOrFirefox||(chromeOrFirefox=/chrome|firefox/i.test(navigator.userAgent)),chromeOrFirefox&&(ut.audioCodec=pt=void 0)),pt&&(ut.audioCodec=pt=getCodecCompatibleName(pt,rt)),((dt=mt)==null?void 0:dt.indexOf("avc1"))===0&&(mt=ut.videoCodec=convertAVC1ToAVCOTI(mt));const{width:At,height:gt,unknownCodecs:bt}=ut;if(at||(at=!!(At&&gt)),lt||(lt=!!mt),ct||(ct=!!pt),bt!=null&&bt.length||pt&&!areCodecsMediaSourceSupported(pt,"audio",rt)||mt&&!areCodecsMediaSourceSupported(mt,"video",rt))return;const{CODECS:Tt,"FRAME-RATE":wt,"HDCP-LEVEL":Rt,"PATHWAY-ID":It,RESOLUTION:Lt,"VIDEO-RANGE":$t}=ft,Dt=`${`${It||"."}-`}${ut.bitrate}-${Lt}-${wt}-${Tt}-${$t}-${Rt}`;if(st[Dt])if(st[Dt].uri!==ut.url&&!ut.attrs["PATHWAY-ID"]){const Ot=ot[Dt]+=1;ut.attrs["PATHWAY-ID"]=new Array(Ot+1).join(".");const zt=new Level(ut);st[Dt]=zt,it.push(zt)}else st[Dt].addGroupId("audio",ft.AUDIO),st[Dt].addGroupId("text",ft.SUBTITLES);else{const Ot=new Level(ut);st[Dt]=Ot,ot[Dt]=1,it.push(Ot)}}),this.filterAndSortMediaOptions(it,et,at,lt,ct)}filterAndSortMediaOptions(_e,et,rt,it,st){let ot=[],at=[],lt=_e;if((rt||it)&&st&&(lt=lt.filter(({videoCodec:pt,videoRange:mt,width:At,height:gt})=>(!!pt||!!(At&&gt))&&isVideoRange(mt))),lt.length===0){Promise.resolve().then(()=>{if(this.hls){et.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(et.levels[0].attrs)}`);const pt=new Error("no level with compatible codecs found in manifest");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:et.url,error:pt,reason:pt.message})}});return}if(et.audioTracks){const{preferManagedMediaSource:pt}=this.hls.config;ot=et.audioTracks.filter(mt=>!mt.audioCodec||areCodecsMediaSourceSupported(mt.audioCodec,"audio",pt)),assignTrackIdsByGroup(ot)}et.subtitles&&(at=et.subtitles,assignTrackIdsByGroup(at));const ct=lt.slice(0);lt.sort((pt,mt)=>{if(pt.attrs["HDCP-LEVEL"]!==mt.attrs["HDCP-LEVEL"])return(pt.attrs["HDCP-LEVEL"]||"")>(mt.attrs["HDCP-LEVEL"]||"")?1:-1;if(rt&&pt.height!==mt.height)return pt.height-mt.height;if(pt.frameRate!==mt.frameRate)return pt.frameRate-mt.frameRate;if(pt.videoRange!==mt.videoRange)return VideoRangeValues.indexOf(pt.videoRange)-VideoRangeValues.indexOf(mt.videoRange);if(pt.videoCodec!==mt.videoCodec){const At=videoCodecPreferenceValue(pt.videoCodec),gt=videoCodecPreferenceValue(mt.videoCodec);if(At!==gt)return gt-At}if(pt.uri===mt.uri&&pt.codecSet!==mt.codecSet){const At=codecsSetSelectionPreferenceValue(pt.codecSet),gt=codecsSetSelectionPreferenceValue(mt.codecSet);if(At!==gt)return gt-At}return pt.averageBitrate!==mt.averageBitrate?pt.averageBitrate-mt.averageBitrate:0});let ut=ct[0];if(this.steering&&(lt=this.steering.filterParsedLevels(lt),lt.length!==ct.length)){for(let pt=0;pt<ct.length;pt++)if(ct[pt].pathwayId===lt[0].pathwayId){ut=ct[pt];break}}this._levels=lt;for(let pt=0;pt<lt.length;pt++)if(lt[pt]===ut){var ht;this._firstLevel=pt;const mt=ut.bitrate,At=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${lt.length} level(s) found, first bitrate: ${mt}`),((ht=this.hls.userConfig)==null?void 0:ht.abrEwmaDefaultEstimate)===void 0){const gt=Math.min(mt,this.hls.config.abrEwmaDefaultEstimateMax);gt>At&&At===hlsDefaultConfig.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=gt)}break}const dt=st&&!it,ft={levels:lt,audioTracks:ot,subtitleTracks:at,sessionData:et.sessionData,sessionKeys:et.sessionKeys,firstLevel:this._firstLevel,stats:et.stats,audio:st,video:it,altAudio:!dt&&ot.some(pt=>!!pt.url)};this.hls.trigger(Events.MANIFEST_PARSED,ft),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(_e){const et=this._levels;if(et.length===0)return;if(_e<0||_e>=et.length){const ut=new Error("invalid level idx"),ht=_e<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:_e,fatal:ht,error:ut,reason:ut.message}),ht)return;_e=Math.min(_e,et.length-1)}const rt=this.currentLevelIndex,it=this.currentLevel,st=it?it.attrs["PATHWAY-ID"]:void 0,ot=et[_e],at=ot.attrs["PATHWAY-ID"];if(this.currentLevelIndex=_e,this.currentLevel=ot,rt===_e&&ot.details&&it&&st===at)return;this.log(`Switching to level ${_e} (${ot.height?ot.height+"p ":""}${ot.videoRange?ot.videoRange+" ":""}${ot.codecSet?ot.codecSet+" ":""}@${ot.bitrate})${at?" with Pathway "+at:""} from level ${rt}${st?" with Pathway "+st:""}`);const lt={level:_e,attrs:ot.attrs,details:ot.details,bitrate:ot.bitrate,averageBitrate:ot.averageBitrate,maxBitrate:ot.maxBitrate,realBitrate:ot.realBitrate,width:ot.width,height:ot.height,codecSet:ot.codecSet,audioCodec:ot.audioCodec,videoCodec:ot.videoCodec,audioGroups:ot.audioGroups,subtitleGroups:ot.subtitleGroups,loaded:ot.loaded,loadError:ot.loadError,fragmentError:ot.fragmentError,name:ot.name,id:ot.id,uri:ot.uri,url:ot.url,urlId:0,audioGroupIds:ot.audioGroupIds,textGroupIds:ot.textGroupIds};this.hls.trigger(Events.LEVEL_SWITCHING,lt);const ct=ot.details;if(!ct||ct.live){const ut=this.switchParams(ot.uri,it==null?void 0:it.details,ct);this.loadPlaylist(ut)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(_e){this.manualLevelIndex=_e,this._startLevel===void 0&&(this._startLevel=_e),_e!==-1&&(this.level=_e)}get firstLevel(){return this._firstLevel}set firstLevel(_e){this._firstLevel=_e}get startLevel(){if(this._startLevel===void 0){const _e=this.hls.config.startLevel;return _e!==void 0?_e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(_e){this._startLevel=_e}onError(_e,et){et.fatal||!et.context||et.context.type===PlaylistContextType.LEVEL&&et.context.level===this.level&&this.checkRetry(et)}onFragBuffered(_e,{frag:et}){if(et!==void 0&&et.type===PlaylistLevelType.MAIN){const rt=et.elementaryStreams;if(!Object.keys(rt).some(st=>!!rt[st]))return;const it=this._levels[et.level];it!=null&&it.loadError&&(this.log(`Resetting level error count of ${it.loadError} on frag buffered`),it.loadError=0)}}onLevelLoaded(_e,et){var rt;const{level:it,details:st}=et,ot=this._levels[it];if(!ot){var at;this.warn(`Invalid level index ${it}`),(at=et.deliveryDirectives)!=null&&at.skip&&(st.deltaUpdateFailed=!0);return}it===this.currentLevelIndex?(ot.fragmentError===0&&(ot.loadError=0),this.playlistLoaded(it,et,ot.details)):(rt=et.deliveryDirectives)!=null&&rt.skip&&(st.deltaUpdateFailed=!0)}loadPlaylist(_e){super.loadPlaylist();const et=this.currentLevelIndex,rt=this.currentLevel;if(rt&&this.shouldLoadPlaylist(rt)){let it=rt.uri;if(_e)try{it=_e.addDirectives(it)}catch(ot){this.warn(`Could not construct new URL with HLS Delivery Directives: ${ot}`)}const st=rt.attrs["PATHWAY-ID"];this.log(`Loading level index ${et}${(_e==null?void 0:_e.msn)!==void 0?" at sn "+_e.msn+" part "+_e.part:""} with${st?" Pathway "+st:""} ${it}`),this.clearTimer(),this.hls.trigger(Events.LEVEL_LOADING,{url:it,level:et,pathwayId:rt.attrs["PATHWAY-ID"],id:0,deliveryDirectives:_e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(_e){this.level=_e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=_e)}removeLevel(_e){var et;const rt=this._levels.filter((it,st)=>st!==_e?!0:(this.steering&&this.steering.removeLevel(it),it===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,it.details&&it.details.fragments.forEach(ot=>ot.level=-1)),!1));reassignFragmentLevelIndexes(rt),this._levels=rt,this.currentLevelIndex>-1&&(et=this.currentLevel)!=null&&et.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(Events.LEVELS_UPDATED,{levels:rt})}onLevelsUpdated(_e,{levels:et}){this._levels=et}checkMaxAutoUpdated(){const{autoLevelCapping:_e,maxAutoLevel:et,maxHdcpLevel:rt}=this.hls;this._maxAutoLevel!==et&&(this._maxAutoLevel=et,this.hls.trigger(Events.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:_e,levels:this.levels,maxAutoLevel:et,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:rt}))}}function assignTrackIdsByGroup(nt){const _e={};nt.forEach(et=>{const rt=et.groupId||"";et.id=_e[rt]=_e[rt]||0,_e[rt]++})}class KeyLoader{constructor(_e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=_e}abort(_e){for(const rt in this.keyUriToKeyInfo){const it=this.keyUriToKeyInfo[rt].loader;if(it){var et;if(_e&&_e!==((et=it.context)==null?void 0:et.frag.type))return;it.abort()}}}detach(){for(const _e in this.keyUriToKeyInfo){const et=this.keyUriToKeyInfo[_e];(et.mediaKeySessionContext||et.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[_e]}}destroy(){this.detach();for(const _e in this.keyUriToKeyInfo){const et=this.keyUriToKeyInfo[_e].loader;et&&et.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(_e,et=ErrorDetails.KEY_LOAD_ERROR,rt,it,st){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details:et,fatal:!1,frag:_e,response:st,error:rt,networkDetails:it})}loadClear(_e,et){if(this.emeController&&this.config.emeEnabled){const{sn:rt,cc:it}=_e;for(let st=0;st<et.length;st++){const ot=et[st];if(it<=ot.cc&&(rt==="initSegment"||ot.sn==="initSegment"||rt<ot.sn)){this.emeController.selectKeySystemFormat(ot).then(at=>{ot.setKeyFormat(at)});break}}}}load(_e){return!_e.decryptdata&&_e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(_e).then(et=>this.loadInternal(_e,et)):this.loadInternal(_e)}loadInternal(_e,et){var rt,it;et&&_e.setKeyFormat(et);const st=_e.decryptdata;if(!st){const ct=new Error(et?`Expected frag.decryptdata to be defined after setting format ${et}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(_e,ErrorDetails.KEY_LOAD_ERROR,ct))}const ot=st.uri;if(!ot)return Promise.reject(this.createKeyLoadError(_e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${ot}"`)));let at=this.keyUriToKeyInfo[ot];if((rt=at)!=null&&rt.decryptdata.key)return st.key=at.decryptdata.key,Promise.resolve({frag:_e,keyInfo:at});if((it=at)!=null&&it.keyLoadPromise){var lt;switch((lt=at.mediaKeySessionContext)==null?void 0:lt.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return at.keyLoadPromise.then(ct=>(st.key=ct.keyInfo.decryptdata.key,{frag:_e,keyInfo:at}))}}switch(at=this.keyUriToKeyInfo[ot]={decryptdata:st,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},st.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return st.keyFormat==="identity"?this.loadKeyHTTP(at,_e):this.loadKeyEME(at,_e);case"AES-128":return this.loadKeyHTTP(at,_e);default:return Promise.reject(this.createKeyLoadError(_e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${st.method}"`)))}}loadKeyEME(_e,et){const rt={frag:et,keyInfo:_e};if(this.emeController&&this.config.emeEnabled){const it=this.emeController.loadKey(rt);if(it)return(_e.keyLoadPromise=it.then(st=>(_e.mediaKeySessionContext=st,rt))).catch(st=>{throw _e.keyLoadPromise=null,st})}return Promise.resolve(rt)}loadKeyHTTP(_e,et){const rt=this.config,it=rt.loader,st=new it(rt);return et.keyLoader=_e.loader=st,_e.keyLoadPromise=new Promise((ot,at)=>{const lt={keyInfo:_e,frag:et,responseType:"arraybuffer",url:_e.decryptdata.uri},ct=rt.keyLoadPolicy.default,ut={loadPolicy:ct,timeout:ct.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},ht={onSuccess:(dt,ft,pt,mt)=>{const{frag:At,keyInfo:gt,url:bt}=pt;if(!At.decryptdata||gt!==this.keyUriToKeyInfo[bt])return at(this.createKeyLoadError(At,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),mt));gt.decryptdata.key=At.decryptdata.key=new Uint8Array(dt.data),At.keyLoader=null,gt.loader=null,ot({frag:At,keyInfo:gt})},onError:(dt,ft,pt,mt)=>{this.resetLoader(ft),at(this.createKeyLoadError(et,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${dt.code} loading key ${dt.text}`),pt,_objectSpread2$3({url:lt.url,data:void 0},dt)))},onTimeout:(dt,ft,pt)=>{this.resetLoader(ft),at(this.createKeyLoadError(et,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),pt))},onAbort:(dt,ft,pt)=>{this.resetLoader(ft),at(this.createKeyLoadError(et,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),pt))}};st.load(lt,ut,ht)})}resetLoader(_e){const{frag:et,keyInfo:rt,url:it}=_e,st=rt.loader;et.keyLoader===st&&(et.keyLoader=null,rt.loader=null),delete this.keyUriToKeyInfo[it],st&&st.destroy()}}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isMSESupported(){if(!getMediaSource())return!1;const _e=getSourceBuffer();return!_e||_e.prototype&&typeof _e.prototype.appendBuffer=="function"&&typeof _e.prototype.remove=="function"}function isSupported(){if(!isMSESupported())return!1;const nt=getMediaSource();return typeof(nt==null?void 0:nt.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(_e=>nt.isTypeSupported(mimeTypeForCodec(_e,"video")))||["mp4a.40.2","fLaC"].some(_e=>nt.isTypeSupported(mimeTypeForCodec(_e,"audio"))))}function changeTypeSupported(){var nt;const _e=getSourceBuffer();return typeof(_e==null||(nt=_e.prototype)==null?void 0:nt.changeType)=="function"}const STALL_MINIMUM_DURATION_MS=250,MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05;class GapController{constructor(_e,et,rt,it){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=_e,this.media=et,this.fragmentTracker=rt,this.hls=it}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(_e,et){const{config:rt,media:it,stalled:st}=this;if(it===null)return;const{currentTime:ot,seeking:at}=it,lt=this.seeking&&!at,ct=!this.seeking&&at;if(this.seeking=at,ot!==_e){if(this.moved=!0,at||(this.nudgeRetry=0),st!==null){if(this.stallReported){const At=self.performance.now()-st;logger.warn(`playback not stuck anymore @${ot}, after ${Math.round(At)}ms`),this.stallReported=!1}this.stalled=null}return}if(ct||lt){this.stalled=null;return}if(it.paused&&!at||it.ended||it.playbackRate===0||!BufferHelper.getBuffered(it).length){this.nudgeRetry=0;return}const ut=BufferHelper.bufferInfo(it,ot,0),ht=ut.nextStart||0;if(at){const At=ut.len>MAX_START_GAP_JUMP,gt=!ht||et&&et.start<=ot||ht-ot>MAX_START_GAP_JUMP&&!this.fragmentTracker.getPartialFragment(ot);if(At||gt)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var dt;if(!(ut.len>0)&&!ht)return;const gt=Math.max(ht,ut.start||0)-ot,bt=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,wt=(bt==null||(dt=bt.details)==null?void 0:dt.live)?bt.details.targetduration*2:MAX_START_GAP_JUMP,Rt=this.fragmentTracker.getPartialFragment(ot);if(gt>0&&(gt<=wt||Rt)){it.paused||this._trySkipBufferHole(Rt);return}}const ft=self.performance.now();if(st===null){this.stalled=ft;return}const pt=ft-st;if(!at&&pt>=STALL_MINIMUM_DURATION_MS&&(this._reportStall(ut),!this.media))return;const mt=BufferHelper.bufferInfo(it,ot,rt.maxBufferHole);this._tryFixBufferStall(mt,pt)}_tryFixBufferStall(_e,et){const{config:rt,fragmentTracker:it,media:st}=this;if(st===null)return;const ot=st.currentTime,at=it.getPartialFragment(ot);at&&(this._trySkipBufferHole(at)||!this.media)||(_e.len>rt.maxBufferHole||_e.nextStart&&_e.nextStart-ot<rt.maxBufferHole)&&et>rt.highBufferWatchdogPeriod*1e3&&(logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(_e){const{hls:et,media:rt,stallReported:it}=this;if(!it&&rt){this.stallReported=!0;const st=new Error(`Playback stalling at @${rt.currentTime} due to low buffer (${JSON.stringify(_e)})`);logger.warn(st.message),et.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error:st,buffer:_e.len})}}_trySkipBufferHole(_e){const{config:et,hls:rt,media:it}=this;if(it===null)return 0;const st=it.currentTime,ot=BufferHelper.bufferInfo(it,st,0),at=st<ot.start?ot.start:ot.nextStart;if(at){const lt=ot.len<=et.maxBufferHole,ct=ot.len>0&&ot.len<1&&it.readyState<3,ut=at-st;if(ut>0&&(lt||ct)){if(ut>et.maxBufferHole){const{fragmentTracker:dt}=this;let ft=!1;if(st===0){const pt=dt.getAppendedFrag(0,PlaylistLevelType.MAIN);pt&&at<pt.end&&(ft=!0)}if(!ft){const pt=_e||dt.getAppendedFrag(st,PlaylistLevelType.MAIN);if(pt){let mt=!1,At=pt.end;for(;At<at;){const gt=dt.getPartialFragment(At);if(gt)At+=gt.duration;else{mt=!0;break}}if(mt)return 0}}}const ht=Math.max(at+SKIP_BUFFER_RANGE_START,st+SKIP_BUFFER_HOLE_STEP_SECONDS);if(logger.warn(`skipping hole, adjusting currentTime from ${st} to ${ht}`),this.moved=!0,this.stalled=null,it.currentTime=ht,_e&&!_e.gap){const dt=new Error(`fragment loaded with buffer holes, seeking from ${st} to ${ht}`);rt.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:dt,reason:dt.message,frag:_e})}return ht}}return 0}_tryNudgeBuffer(){const{config:_e,hls:et,media:rt,nudgeRetry:it}=this;if(rt===null)return;const st=rt.currentTime;if(this.nudgeRetry++,it<_e.nudgeMaxRetry){const ot=st+(it+1)*_e.nudgeOffset,at=new Error(`Nudging 'currentTime' from ${st} to ${ot}`);logger.warn(at.message),rt.currentTime=ot,et.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error:at,fatal:!1})}else{const ot=new Error(`Playhead still not moving while enough data buffered @${st} after ${_e.nudgeMaxRetry} nudges`);logger.error(ot.message),et.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error:ot,fatal:!0})}}}const TICK_INTERVAL=100;class StreamController extends BaseStreamController{constructor(_e,et,rt){super(_e,et,rt,"[stream-controller]",PlaylistLevelType.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:_e}=this;_e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),_e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),_e.on(Events.ERROR,this.onError,this),_e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),_e.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),_e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),_e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),_e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:_e}=this;_e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),_e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),_e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),_e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),_e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),_e.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),_e.off(Events.ERROR,this.onError,this),_e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),_e.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),_e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),_e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),_e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),_e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(_e){if(this.levels){const{lastCurrentTime:et,hls:rt}=this;if(this.stopLoad(),this.setInterval(TICK_INTERVAL),this.level=-1,!this.startFragRequested){let it=rt.startLevel;it===-1&&(rt.config.testBandwidth&&this.levels.length>1?(it=0,this.bitrateTest=!0):it=rt.firstAutoLevel),rt.nextLoadLevel=it,this.level=rt.loadLevel,this.loadedmetadata=!1}et>0&&_e===-1&&(this.log(`Override startPosition with lastCurrentTime @${et.toFixed(3)}`),_e=et),this.state=State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=_e,this.tick()}else this._forceStartLoad=!0,this.state=State.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State.WAITING_LEVEL:{const{levels:et,level:rt}=this,it=et==null?void 0:et[rt],st=it==null?void 0:it.details;if(st&&(!st.live||this.levelLastLoaded===it)){if(this.waitForCdnTuneIn(st))break;this.state=State.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=State.IDLE;break}break}case State.FRAG_LOADING_WAITING_RETRY:{var _e;const et=self.performance.now(),rt=this.retryDate;if(!rt||et>=rt||(_e=this.media)!=null&&_e.seeking){const{levels:it,level:st}=this,ot=it==null?void 0:it[st];this.resetStartWhenNotLoaded(ot||null),this.state=State.IDLE}}break}this.state===State.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:_e,levelLastLoaded:et,levels:rt,media:it}=this;if(et===null||!it&&(this.startFragRequested||!_e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const st=_e.nextLoadLevel;if(!(rt!=null&&rt[st]))return;const ot=rt[st],at=this.getMainFwdBufferInfo();if(at===null)return;const lt=this.getLevelDetails();if(lt&&this._streamEnded(at,lt)){const mt={};this.altAudio&&(mt.type="video"),this.hls.trigger(Events.BUFFER_EOS,mt),this.state=State.ENDED;return}_e.loadLevel!==st&&_e.manualLevel===-1&&this.log(`Adapting to level ${st} from level ${this.level}`),this.level=_e.nextLoadLevel=st;const ct=ot.details;if(!ct||this.state===State.WAITING_LEVEL||ct.live&&this.levelLastLoaded!==ot){this.level=st,this.state=State.WAITING_LEVEL;return}const ut=at.len,ht=this.getMaxBufferLength(ot.maxBitrate);if(ut>=ht)return;this.backtrackFragment&&this.backtrackFragment.start>at.end&&(this.backtrackFragment=null);const dt=this.backtrackFragment?this.backtrackFragment.start:at.end;let ft=this.getNextFragment(dt,ct);if(this.couldBacktrack&&!this.fragPrevious&&ft&&ft.sn!=="initSegment"&&this.fragmentTracker.getState(ft)!==FragmentState.OK){var pt;const At=((pt=this.backtrackFragment)!=null?pt:ft).sn-ct.startSN,gt=ct.fragments[At-1];gt&&ft.cc===gt.cc&&(ft=gt,this.fragmentTracker.removeFragment(gt))}else this.backtrackFragment&&at.len&&(this.backtrackFragment=null);if(ft&&this.isLoopLoading(ft,dt)){if(!ft.gap){const At=this.audioOnly&&!this.altAudio?ElementaryStreamTypes.AUDIO:ElementaryStreamTypes.VIDEO,gt=(At===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;gt&&this.afterBufferFlushed(gt,At,PlaylistLevelType.MAIN)}ft=this.getNextFragmentLoopLoading(ft,ct,at,PlaylistLevelType.MAIN,ht)}ft&&(ft.initSegment&&!ft.initSegment.data&&!this.bitrateTest&&(ft=ft.initSegment),this.loadFragment(ft,ot,dt))}loadFragment(_e,et,rt){const it=this.fragmentTracker.getState(_e);this.fragCurrent=_e,it===FragmentState.NOT_LOADED||it===FragmentState.PARTIAL?_e.sn==="initSegment"?this._loadInitSegment(_e,et):this.bitrateTest?(this.log(`Fragment ${_e.sn} of level ${_e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(_e,et)):(this.startFragRequested=!0,super.loadFragment(_e,et,rt)):this.clearTrackerIfNeeded(_e)}getBufferedFrag(_e){return this.fragmentTracker.getBufferedFrag(_e,PlaylistLevelType.MAIN)}followingBufferedFrag(_e){return _e?this.getBufferedFrag(_e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:_e,media:et}=this;if(et!=null&&et.readyState){let rt;const it=this.getAppendedFrag(et.currentTime);it&&it.start>1&&this.flushMainBuffer(0,it.start-1);const st=this.getLevelDetails();if(st!=null&&st.live){const at=this.getMainFwdBufferInfo();if(!at||at.len<st.targetduration*2)return}if(!et.paused&&_e){const at=this.hls.nextLoadLevel,lt=_e[at],ct=this.fragLastKbps;ct&&this.fragCurrent?rt=this.fragCurrent.duration*lt.maxBitrate/(1e3*ct)+1:rt=0}else rt=0;const ot=this.getBufferedFrag(et.currentTime+rt);if(ot){const at=this.followingBufferedFrag(ot);if(at){this.abortCurrentFrag();const lt=at.maxStartPTS?at.maxStartPTS:at.start,ct=at.duration,ut=Math.max(ot.end,lt+Math.min(Math.max(ct-this.config.maxFragLookUpTolerance,ct*(this.couldBacktrack?.5:.125)),ct*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(ut,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const _e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,_e&&(_e.abortRequests(),this.fragmentTracker.removeFragment(_e)),this.state){case State.KEY_LOADING:case State.FRAG_LOADING:case State.FRAG_LOADING_WAITING_RETRY:case State.PARSING:case State.PARSED:this.state=State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(_e,et){super.flushMainBuffer(_e,et,this.altAudio?"video":null)}onMediaAttached(_e,et){super.onMediaAttached(_e,et);const rt=et.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),rt.addEventListener("playing",this.onvplaying),rt.addEventListener("seeked",this.onvseeked),this.gapController=new GapController(this.config,rt,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:_e}=this;_e&&this.onvplaying&&this.onvseeked&&(_e.removeEventListener("playing",this.onvplaying),_e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const _e=this.media,et=_e?_e.currentTime:null;isFiniteNumber(et)&&this.log(`Media seeked to ${et.toFixed(3)}`);const rt=this.getMainFwdBufferInfo();if(rt===null||rt.len===0){this.warn(`Main forward buffer length on "seeked" event ${rt?rt.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(_e,et){let rt=!1,it=!1;et.levels.forEach(st=>{const ot=st.audioCodec;ot&&(rt=rt||ot.indexOf("mp4a.40.2")!==-1,it=it||ot.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=rt&&it&&!changeTypeSupported(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=et.levels,this.startFragRequested=!1}onLevelLoading(_e,et){const{levels:rt}=this;if(!rt||this.state!==State.IDLE)return;const it=rt[et.level];(!it.details||it.details.live&&this.levelLastLoaded!==it||this.waitForCdnTuneIn(it.details))&&(this.state=State.WAITING_LEVEL)}onLevelLoaded(_e,et){var rt;const{levels:it}=this,st=et.level,ot=et.details,at=ot.totalduration;if(!it){this.warn(`Levels were reset while loading level ${st}`);return}this.log(`Level ${st} loaded [${ot.startSN},${ot.endSN}]${ot.lastPartSn?`[part-${ot.lastPartSn}-${ot.lastPartIndex}]`:""}, cc [${ot.startCC}, ${ot.endCC}] duration:${at}`);const lt=it[st],ct=this.fragCurrent;ct&&(this.state===State.FRAG_LOADING||this.state===State.FRAG_LOADING_WAITING_RETRY)&&ct.level!==et.level&&ct.loader&&this.abortCurrentFrag();let ut=0;if(ot.live||(rt=lt.details)!=null&&rt.live){var ht;if(this.checkLiveUpdate(ot),ot.deltaUpdateFailed)return;ut=this.alignPlaylists(ot,lt.details,(ht=this.levelLastLoaded)==null?void 0:ht.details)}if(lt.details=ot,this.levelLastLoaded=lt,this.hls.trigger(Events.LEVEL_UPDATED,{details:ot,level:st}),this.state===State.WAITING_LEVEL){if(this.waitForCdnTuneIn(ot))return;this.state=State.IDLE}this.startFragRequested?ot.live&&this.synchronizeToLiveEdge(ot):this.setStartPosition(ot,ut),this.tick()}_handleFragmentLoadProgress(_e){var et;const{frag:rt,part:it,payload:st}=_e,{levels:ot}=this;if(!ot){this.warn(`Levels were reset while fragment load was in progress. Fragment ${rt.sn} of level ${rt.level} will not be buffered`);return}const at=ot[rt.level],lt=at.details;if(!lt){this.warn(`Dropping fragment ${rt.sn} of level ${rt.level} after level details were reset`),this.fragmentTracker.removeFragment(rt);return}const ct=at.videoCodec,ut=lt.PTSKnown||!lt.live,ht=(et=rt.initSegment)==null?void 0:et.data,dt=this._getAudioCodec(at),ft=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),pt=it?it.index:-1,mt=pt!==-1,At=new ChunkMetadata(rt.level,rt.sn,rt.stats.chunkCount,st.byteLength,pt,mt),gt=this.initPTS[rt.cc];ft.push(st,ht,dt,ct,rt,it,lt.totalduration,ut,At,gt)}onAudioTrackSwitching(_e,et){const rt=this.altAudio;if(!!!et.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const ot=this.fragCurrent;ot&&(this.log("Switching to main audio track, cancel main fragment load"),ot.abortRequests(),this.fragmentTracker.removeFragment(ot)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const st=this.hls;rt&&(st.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),st.trigger(Events.AUDIO_TRACK_SWITCHED,et)}}onAudioTrackSwitched(_e,et){const rt=et.id,it=!!this.hls.audioTracks[rt].url;if(it){const st=this.videoBuffer;st&&this.mediaBuffer!==st&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=st)}this.altAudio=it,this.tick()}onBufferCreated(_e,et){const rt=et.tracks;let it,st,ot=!1;for(const at in rt){const lt=rt[at];if(lt.id==="main"){if(st=at,it=lt,at==="video"){const ct=rt[at];ct&&(this.videoBuffer=ct.buffer)}}else ot=!0}ot&&it?(this.log(`Alternate track found, use ${st}.buffered to schedule main fragment loading`),this.mediaBuffer=it.buffer):this.mediaBuffer=this.media}onFragBuffered(_e,et){const{frag:rt,part:it}=et;if(rt&&rt.type!==PlaylistLevelType.MAIN)return;if(this.fragContextChanged(rt)){this.warn(`Fragment ${rt.sn}${it?" p: "+it.index:""} of level ${rt.level} finished buffering, but was aborted. state: ${this.state}`),this.state===State.PARSED&&(this.state=State.IDLE);return}const st=it?it.stats:rt.stats;this.fragLastKbps=Math.round(8*st.total/(st.buffering.end-st.loading.first)),rt.sn!=="initSegment"&&(this.fragPrevious=rt),this.fragBufferedComplete(rt,it)}onError(_e,et){var rt;if(et.fatal){this.state=State.ERROR;return}switch(et.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.MAIN,et);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!et.levelRetry&&this.state===State.WAITING_LEVEL&&((rt=et.context)==null?void 0:rt.type)===PlaylistContextType.LEVEL&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:if(!et.parent||et.parent!=="main")return;if(et.details===ErrorDetails.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(et)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(et);break}}checkBuffer(){const{media:_e,gapController:et}=this;if(!(!_e||!et||!_e.readyState)){if(this.loadedmetadata||!BufferHelper.getBuffered(_e).length){const rt=this.state!==State.IDLE?this.fragCurrent:null;et.poll(this.lastCurrentTime,rt)}this.lastCurrentTime=_e.currentTime}}onFragLoadEmergencyAborted(){this.state=State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(_e,{type:et}){if(et!==ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){const rt=(et===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(rt,et,PlaylistLevelType.MAIN),this.tick()}}onLevelsUpdated(_e,et){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=et.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:_e}=this;if(!_e)return;const et=_e.currentTime;let rt=this.startPosition;if(rt>=0&&et<rt){if(_e.seeking){this.log(`could not seek to ${rt}, already seeking at ${et}`);return}const it=BufferHelper.getBuffered(_e),ot=(it.length?it.start(0):0)-rt;ot>0&&(ot<this.config.maxBufferHole||ot<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${ot} to match buffer start`),rt+=ot,this.startPosition=rt),this.log(`seek to target start position ${rt} from current time ${et}`),_e.currentTime=rt}}_getAudioCodec(_e){let et=this.config.defaultAudioCodec||_e.audioCodec;return this.audioCodecSwap&&et&&(this.log("Swapping audio codec"),et.indexOf("mp4a.40.5")!==-1?et="mp4a.40.2":et="mp4a.40.5"),et}_loadBitrateTestFrag(_e,et){_e.bitrateTest=!0,this._doFragLoad(_e,et).then(rt=>{const{hls:it}=this;if(!rt||this.fragContextChanged(_e))return;et.fragmentError=0,this.state=State.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const st=_e.stats;st.parsing.start=st.parsing.end=st.buffering.start=st.buffering.end=self.performance.now(),it.trigger(Events.FRAG_LOADED,rt),_e.bitrateTest=!1})}_handleTransmuxComplete(_e){var et;const rt="main",{hls:it}=this,{remuxResult:st,chunkMeta:ot}=_e,at=this.getCurrentContext(ot);if(!at){this.resetWhenMissingContext(ot);return}const{frag:lt,part:ct,level:ut}=at,{video:ht,text:dt,id3:ft,initSegment:pt}=st,{details:mt}=ut,At=this.altAudio?void 0:st.audio;if(this.fragContextChanged(lt)){this.fragmentTracker.removeFragment(lt);return}if(this.state=State.PARSING,pt){if(pt!=null&&pt.tracks){const Tt=lt.initSegment||lt;this._bufferInitSegment(ut,pt.tracks,Tt,ot),it.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:Tt,id:rt,tracks:pt.tracks})}const gt=pt.initPTS,bt=pt.timescale;isFiniteNumber(gt)&&(this.initPTS[lt.cc]={baseTime:gt,timescale:bt},it.trigger(Events.INIT_PTS_FOUND,{frag:lt,id:rt,initPTS:gt,timescale:bt}))}if(ht&&mt&&lt.sn!=="initSegment"){const gt=mt.fragments[lt.sn-1-mt.startSN],bt=lt.sn===mt.startSN,Tt=!gt||lt.cc>gt.cc;if(st.independent!==!1){const{startPTS:wt,endPTS:Rt,startDTS:It,endDTS:Lt}=ht;if(ct)ct.elementaryStreams[ht.type]={startPTS:wt,endPTS:Rt,startDTS:It,endDTS:Lt};else if(ht.firstKeyFrame&&ht.independent&&ot.id===1&&!Tt&&(this.couldBacktrack=!0),ht.dropped&&ht.independent){const $t=this.getMainFwdBufferInfo(),kt=($t?$t.end:this.getLoadPosition())+this.config.maxBufferHole,Dt=ht.firstKeyFramePTS?ht.firstKeyFramePTS:wt;if(!bt&&kt<Dt-this.config.maxBufferHole&&!Tt){this.backtrack(lt);return}else Tt&&(lt.gap=!0);lt.setElementaryStreamInfo(ht.type,lt.start,Rt,lt.start,Lt,!0)}else bt&&wt>MAX_START_GAP_JUMP&&(lt.gap=!0);lt.setElementaryStreamInfo(ht.type,wt,Rt,It,Lt),this.backtrackFragment&&(this.backtrackFragment=lt),this.bufferFragmentData(ht,lt,ct,ot,bt||Tt)}else if(bt||Tt)lt.gap=!0;else{this.backtrack(lt);return}}if(At){const{startPTS:gt,endPTS:bt,startDTS:Tt,endDTS:wt}=At;ct&&(ct.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:gt,endPTS:bt,startDTS:Tt,endDTS:wt}),lt.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,gt,bt,Tt,wt),this.bufferFragmentData(At,lt,ct,ot)}if(mt&&ft!=null&&(et=ft.samples)!=null&&et.length){const gt={id:rt,frag:lt,details:mt,samples:ft.samples};it.trigger(Events.FRAG_PARSING_METADATA,gt)}if(mt&&dt){const gt={id:rt,frag:lt,details:mt,samples:dt.samples};it.trigger(Events.FRAG_PARSING_USERDATA,gt)}}_bufferInitSegment(_e,et,rt,it){if(this.state!==State.PARSING)return;this.audioOnly=!!et.audio&&!et.video,this.altAudio&&!this.audioOnly&&delete et.audio;const{audio:st,video:ot,audiovideo:at}=et;if(st){let lt=_e.audioCodec;const ct=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){lt&&(lt.indexOf("mp4a.40.5")!==-1?lt="mp4a.40.2":lt="mp4a.40.5");const ut=st.metadata;ut&&"channelCount"in ut&&(ut.channelCount||1)!==1&&ct.indexOf("firefox")===-1&&(lt="mp4a.40.5")}lt&&lt.indexOf("mp4a.40.5")!==-1&&ct.indexOf("android")!==-1&&st.container!=="audio/mpeg"&&(lt="mp4a.40.2",this.log(`Android: force audio codec to ${lt}`)),_e.audioCodec&&_e.audioCodec!==lt&&this.log(`Swapping manifest audio codec "${_e.audioCodec}" for "${lt}"`),st.levelCodec=lt,st.id="main",this.log(`Init audio buffer, container:${st.container}, codecs[selected/level/parsed]=[${lt||""}/${_e.audioCodec||""}/${st.codec}]`)}ot&&(ot.levelCodec=_e.videoCodec,ot.id="main",this.log(`Init video buffer, container:${ot.container}, codecs[level/parsed]=[${_e.videoCodec||""}/${ot.codec}]`)),at&&this.log(`Init audiovideo buffer, container:${at.container}, codecs[level/parsed]=[${_e.codecs}/${at.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,et),Object.keys(et).forEach(lt=>{const ut=et[lt].initSegment;ut!=null&&ut.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:lt,data:ut,frag:rt,part:null,chunkMeta:it,parent:rt.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,PlaylistLevelType.MAIN)}backtrack(_e){this.couldBacktrack=!0,this.backtrackFragment=_e,this.resetTransmuxer(),this.flushBufferGap(_e),this.fragmentTracker.removeFragment(_e),this.fragPrevious=null,this.nextLoadPosition=_e.start,this.state=State.IDLE}checkFragmentChanged(){const _e=this.media;let et=null;if(_e&&_e.readyState>1&&_e.seeking===!1){const rt=_e.currentTime;if(BufferHelper.isBuffered(_e,rt)?et=this.getAppendedFrag(rt):BufferHelper.isBuffered(_e,rt+.1)&&(et=this.getAppendedFrag(rt+.1)),et){this.backtrackFragment=null;const it=this.fragPlaying,st=et.level;(!it||et.sn!==it.sn||it.level!==st)&&(this.fragPlaying=et,this.hls.trigger(Events.FRAG_CHANGED,{frag:et}),(!it||it.level!==st)&&this.hls.trigger(Events.LEVEL_SWITCHED,{level:st}))}}}get nextLevel(){const _e=this.nextBufferedFrag;return _e?_e.level:-1}get currentFrag(){const _e=this.media;return _e?this.fragPlaying||this.getAppendedFrag(_e.currentTime):null}get currentProgramDateTime(){const _e=this.media;if(_e){const et=_e.currentTime,rt=this.currentFrag;if(rt&&isFiniteNumber(et)&&isFiniteNumber(rt.programDateTime)){const it=rt.programDateTime+(et-rt.start)*1e3;return new Date(it)}}return null}get currentLevel(){const _e=this.currentFrag;return _e?_e.level:-1}get nextBufferedFrag(){const _e=this.currentFrag;return _e?this.followingBufferedFrag(_e):null}get forceStartLoad(){return this._forceStartLoad}}class Hls{static get version(){return"1.5.17"}static isMSESupported(){return isMSESupported()}static isSupported(){return isSupported()}static getMediaSource(){return getMediaSource()}static get Events(){return Events}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(_e){Hls.defaultConfig=_e}constructor(_e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new EventEmitter,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,enableLogs(_e.debug||!1,"Hls instance");const et=this.config=mergeConfig(Hls.DefaultConfig,_e);this.userConfig=_e,et.progressive&&enableStreamingMode(et);const{abrController:rt,bufferController:it,capLevelController:st,errorController:ot,fpsController:at}=et,lt=new ot(this),ct=this.abrController=new rt(this),ut=this.bufferController=new it(this),ht=this.capLevelController=new st(this),dt=new at(this),ft=new PlaylistLoader(this),pt=new ID3TrackController(this),mt=et.contentSteeringController,At=mt?new mt(this):null,gt=this.levelController=new LevelController(this,At),bt=new FragmentTracker(this),Tt=new KeyLoader(this.config),wt=this.streamController=new StreamController(this,bt,Tt);ht.setStreamController(wt),dt.setStreamController(wt);const Rt=[ft,gt,wt];At&&Rt.splice(1,0,At),this.networkControllers=Rt;const It=[ct,ut,ht,dt,pt,bt];this.audioTrackController=this.createController(et.audioTrackController,Rt);const Lt=et.audioStreamController;Lt&&Rt.push(new Lt(this,bt,Tt)),this.subtitleTrackController=this.createController(et.subtitleTrackController,Rt);const $t=et.subtitleStreamController;$t&&Rt.push(new $t(this,bt,Tt)),this.createController(et.timelineController,It),Tt.emeController=this.emeController=this.createController(et.emeController,It),this.cmcdController=this.createController(et.cmcdController,It),this.latencyController=this.createController(LatencyController,It),this.coreComponents=It,Rt.push(lt);const kt=lt.onErrorOut;typeof kt=="function"&&this.on(Events.ERROR,kt,lt)}createController(_e,et){if(_e){const rt=new _e(this);return et&&et.push(rt),rt}return null}on(_e,et,rt=this){this._emitter.on(_e,et,rt)}once(_e,et,rt=this){this._emitter.once(_e,et,rt)}removeAllListeners(_e){this._emitter.removeAllListeners(_e)}off(_e,et,rt=this,it){this._emitter.off(_e,et,rt,it)}listeners(_e){return this._emitter.listeners(_e)}emit(_e,et,rt){return this._emitter.emit(_e,et,rt)}trigger(_e,et){if(this.config.debug)return this.emit(_e,_e,et);try{return this.emit(_e,_e,et)}catch(rt){if(logger.error("An internal error happened while handling event "+_e+'. Error message: "'+rt.message+'". Here is a stacktrace:',rt),!this.triggeringException){this.triggeringException=!0;const it=_e===Events.ERROR;this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:it,event:_e,error:rt}),this.triggeringException=!1}}return!1}listenerCount(_e){return this._emitter.listenerCount(_e)}destroy(){logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(et=>et.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(et=>et.destroy()),this.coreComponents.length=0;const _e=this.config;_e.xhrSetup=_e.fetchSetup=void 0,this.userConfig=null}attachMedia(_e){logger.log("attachMedia"),this._media=_e,this.trigger(Events.MEDIA_ATTACHING,{media:_e})}detachMedia(){logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,void 0),this._media=null}loadSource(_e){this.stopLoad();const et=this.media,rt=this.url,it=this.url=urlToolkitExports.buildAbsoluteURL(self.location.href,_e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,logger.log(`loadSource:${it}`),et&&rt&&(rt!==it||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(et)),this.trigger(Events.MANIFEST_LOADING,{url:_e})}startLoad(_e=-1){logger.log(`startLoad(${_e})`),this.started=!0,this.networkControllers.forEach(et=>{et.startLoad(_e)})}stopLoad(){logger.log("stopLoad"),this.started=!1,this.networkControllers.forEach(_e=>{_e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(_e=>{"fragmentLoader"in _e&&_e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(_e=>{"fragmentLoader"in _e&&_e.stopLoad()})}swapAudioCodec(){logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){logger.log("recoverMediaError");const _e=this._media;this.detachMedia(),_e&&this.attachMedia(_e)}removeLevel(_e){this.levelController.removeLevel(_e)}get levels(){const _e=this.levelController.levels;return _e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(_e){logger.log(`set currentLevel:${_e}`),this.levelController.manualLevel=_e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(_e){logger.log(`set nextLevel:${_e}`),this.levelController.manualLevel=_e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(_e){logger.log(`set loadLevel:${_e}`),this.levelController.manualLevel=_e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(_e){this.levelController.nextLoadLevel=_e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(_e){logger.log(`set firstLevel:${_e}`),this.levelController.firstLevel=_e}get startLevel(){const _e=this.levelController.startLevel;return _e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:_e}set startLevel(_e){logger.log(`set startLevel:${_e}`),_e!==-1&&(_e=Math.max(_e,this.minAutoLevel)),this.levelController.startLevel=_e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(_e){const et=!!_e;et!==this.config.capLevelToPlayerSize&&(et?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=et)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:_e}=this.abrController;return _e?_e.getEstimate():NaN}set bandwidthEstimate(_e){this.abrController.resetEstimator(_e)}get ttfbEstimate(){const{bwEstimator:_e}=this.abrController;return _e?_e.getEstimateTTFB():NaN}set autoLevelCapping(_e){this._autoLevelCapping!==_e&&(logger.log(`set autoLevelCapping:${_e}`),this._autoLevelCapping=_e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(_e){isHdcpLevel(_e)&&this._maxHdcpLevel!==_e&&(this._maxHdcpLevel=_e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:_e,config:{minAutoBitrate:et}}=this;if(!_e)return 0;const rt=_e.length;for(let it=0;it<rt;it++)if(_e[it].maxBitrate>=et)return it;return 0}get maxAutoLevel(){const{levels:_e,autoLevelCapping:et,maxHdcpLevel:rt}=this;let it;if(et===-1&&_e!=null&&_e.length?it=_e.length-1:it=et,rt)for(let st=it;st--;){const ot=_e[st].attrs["HDCP-LEVEL"];if(ot&&ot<=rt)return st}return it}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(_e){this.abrController.nextAutoLevel=_e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(_e){var et;return(et=this.audioTrackController)==null?void 0:et.setAudioOption(_e)}setSubtitleOption(_e){var et;return(et=this.subtitleTrackController)==null||et.setSubtitleOption(_e),null}get allAudioTracks(){const _e=this.audioTrackController;return _e?_e.allAudioTracks:[]}get audioTracks(){const _e=this.audioTrackController;return _e?_e.audioTracks:[]}get audioTrack(){const _e=this.audioTrackController;return _e?_e.audioTrack:-1}set audioTrack(_e){const et=this.audioTrackController;et&&(et.audioTrack=_e)}get allSubtitleTracks(){const _e=this.subtitleTrackController;return _e?_e.allSubtitleTracks:[]}get subtitleTracks(){const _e=this.subtitleTrackController;return _e?_e.subtitleTracks:[]}get subtitleTrack(){const _e=this.subtitleTrackController;return _e?_e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(_e){const et=this.subtitleTrackController;et&&(et.subtitleTrack=_e)}get subtitleDisplay(){const _e=this.subtitleTrackController;return _e?_e.subtitleDisplay:!1}set subtitleDisplay(_e){const et=this.subtitleTrackController;et&&(et.subtitleDisplay=_e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(_e){this.config.lowLatencyMode=_e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Hls.defaultConfig=void 0;const hls=Object.freeze(Object.defineProperty({__proto__:null,AbrController,AttrList,AudioStreamController,AudioTrackController,BasePlaylistController,BaseSegment,BaseStreamController,BufferController,CMCDController,CapLevelController,ChunkMetadata,ContentSteeringController,DateRange,EMEController,ErrorActionFlags,ErrorController,ErrorDetails,ErrorTypes,Events,FPSController,Fragment,Hls,HlsSkip,HlsUrlParameters,KeySystemFormats,KeySystems,Level,LevelDetails,LevelKey,LoadStats,MetadataSchema,NetworkErrorAction,Part,PlaylistLevelType,SubtitleStreamController,SubtitleTrackController,TimelineController,default:Hls,getMediaSource,isMSESupported,isSupported},Symbol.toStringTag,{value:"Module"}));var _window$document,_window$navigator;const IS_BROWSER=typeof window<"u"&&typeof((_window$document=window.document)==null?void 0:_window$document.createElement)=="function"&&typeof((_window$navigator=window.navigator)==null?void 0:_window$navigator.userAgent)=="string";let _HLSModule=null;async function getHls(...nt){var _e;(_e=_HLSModule)!==null&&_e!==void 0||(_HLSModule=await __vitePreload(()=>Promise.resolve().then(()=>hls),void 0));const et=_HLSModule.default;return et.isSupported()?new et(...nt):null}function useVideoTexture(nt,{unsuspend:_e="loadedmetadata",start:et=!0,hls:rt={},crossOrigin:it="anonymous",muted:st=!0,loop:ot=!0,playsInline:at=!0,...lt}={}){const ct=useThree(dt=>dt.gl),ut=reactExports.useRef(null),ht=suspend(()=>new Promise(async dt=>{let ft,pt;typeof nt=="string"?ft=nt:pt=nt;const mt=Object.assign(document.createElement("video"),{src:ft,srcObject:pt,crossOrigin:it,loop:ot,muted:st,playsInline:at,...lt});if(ft&&IS_BROWSER&&ft.endsWith(".m3u8")){const gt=ut.current=await getHls(rt);gt&&(gt.on(Events.MEDIA_ATTACHED,()=>void gt.loadSource(ft)),gt.attachMedia(mt))}const At=new VideoTexture(mt);"colorSpace"in At?At.colorSpace=ct.outputColorSpace:At.encoding=ct.outputEncoding,mt.addEventListener(_e,()=>dt(At))}),[nt]);return reactExports.useEffect(()=>(et&&ht.image.play(),()=>{ut.current&&(ut.current.destroy(),ut.current=null)}),[ht,et]),ht}function useAnimations(nt,_e){const et=reactExports.useRef(),[rt]=reactExports.useState(()=>_e?_e instanceof Object3D$1?{current:_e}:_e:et),[it]=reactExports.useState(()=>new AnimationMixer(void 0));reactExports.useLayoutEffect(()=>{_e&&(rt.current=_e instanceof Object3D$1?_e:_e.current),it._root=rt.current});const st=reactExports.useRef({}),ot=reactExports.useMemo(()=>{const at={};return nt.forEach(lt=>Object.defineProperty(at,lt.name,{enumerable:!0,get(){if(rt.current)return st.current[lt.name]||(st.current[lt.name]=it.clipAction(lt,rt.current))},configurable:!0})),{ref:rt,clips:nt,actions:at,names:nt.map(lt=>lt.name),mixer:it}},[nt]);return useFrame((at,lt)=>it.update(lt)),reactExports.useEffect(()=>{const at=rt.current;return()=>{st.current={},it.stopAllAction(),Object.values(ot.actions).forEach(lt=>{at&&it.uncacheAction(lt,at)})}},[nt]),ot}const Center=reactExports.forwardRef(function({children:_e,disable:et,disableX:rt,disableY:it,disableZ:st,left:ot,right:at,top:lt,bottom:ct,front:ut,back:ht,onCentered:dt,precise:ft=!0,cacheKey:pt=0,...mt},At){const gt=reactExports.useRef(null),bt=reactExports.useRef(null),Tt=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{bt.current.matrixWorld.identity();const wt=new Box3$1().setFromObject(Tt.current,ft),Rt=new Vector3$1,It=new Sphere$1,Lt=wt.max.x-wt.min.x,$t=wt.max.y-wt.min.y,kt=wt.max.z-wt.min.z;wt.getCenter(Rt),wt.getBoundingSphere(It);const Dt=lt?$t/2:ct?-$t/2:0,Ot=ot?-Lt/2:at?Lt/2:0,zt=ut?kt/2:ht?-kt/2:0;bt.current.position.set(et||rt?0:-Rt.x+Ot,et||it?0:-Rt.y+Dt,et||st?0:-Rt.z+zt),typeof dt<"u"&&dt({parent:gt.current.parent,container:gt.current,width:Lt,height:$t,depth:kt,boundingBox:wt,boundingSphere:It,center:Rt,verticalAlignment:Dt,horizontalAlignment:Ot,depthAlignment:zt})},[pt,dt,lt,ot,ut,et,rt,it,st,ft,at,ct,ht]),reactExports.useImperativeHandle(At,()=>gt.current,[]),reactExports.createElement("group",_extends$2({ref:gt},mt),reactExports.createElement("group",{ref:bt},reactExports.createElement("group",{ref:Tt},_e)))});function Composer(nt){return renderRecursive(nt.children,nt.components)}Composer.propTypes={children:PropTypes.func.isRequired,components:PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.element,PropTypes.func])).isRequired};function renderRecursive(nt,_e,et){if(et=et||[],!_e[0])return nt(et);function rt(it){return renderRecursive(nt,_e.slice(1),et.concat([it]))}return typeof _e[0]=="function"?_e[0]({results:et,render:rt}):reactExports.cloneElement(_e[0],{children:rt})}const setUpdateRange=(nt,_e)=>{"updateRanges"in nt?nt.updateRanges[0]=_e:nt.updateRange=_e};function isFunctionChild(nt){return typeof nt=="function"}const _instanceLocalMatrix=new Matrix4$1,_instanceWorldMatrix=new Matrix4$1,_instanceIntersects=[],_mesh=new Mesh$1;class PositionMesh extends Group$1{constructor(){super(),this.color=new Color$2("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var _e;return(_e=this.instance.current)==null?void 0:_e.geometry}raycast(_e,et){const rt=this.instance.current;if(!rt||!rt.geometry||!rt.material)return;_mesh.geometry=rt.geometry;const it=rt.matrixWorld,st=rt.userData.instances.indexOf(this.instanceKey);if(!(st===-1||st>rt.count)){rt.getMatrixAt(st,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(it,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,rt.material instanceof Material$1?_mesh.material.side=rt.material.side:_mesh.material.side=rt.material[0].side,_mesh.raycast(_e,_instanceIntersects);for(let ot=0,at=_instanceIntersects.length;ot<at;ot++){const lt=_instanceIntersects[ot];lt.instanceId=st,lt.object=this,et.push(lt)}_instanceIntersects.length=0}}}const globalContext=reactExports.createContext(null),parentMatrix=new Matrix4$1,instanceMatrix=new Matrix4$1,tempMatrix=new Matrix4$1,translation=new Vector3$1,rotation=new Quaternion$1,scale$1=new Vector3$1,isInstancedBufferAttribute=nt=>nt.isInstancedBufferAttribute,Instance=reactExports.forwardRef(({context:nt,children:_e,...et},rt)=>{reactExports.useMemo(()=>extend$1({PositionMesh}),[]);const it=reactExports.useRef();reactExports.useImperativeHandle(rt,()=>it.current,[]);const{subscribe:st,getParent:ot}=reactExports.useContext(nt||globalContext);return reactExports.useLayoutEffect(()=>st(it),[]),reactExports.createElement("positionMesh",_extends$2({instance:ot(),instanceKey:it,ref:it},et),_e)}),Instances$1=reactExports.forwardRef(({context:nt,children:_e,range:et,limit:rt=1e3,frames:it=1/0,...st},ot)=>{const[{localContext:at,instance:lt}]=reactExports.useState(()=>{const bt=reactExports.createContext(null);return{localContext:bt,instance:reactExports.forwardRef((Tt,wt)=>reactExports.createElement(Instance,_extends$2({context:bt},Tt,{ref:wt})))}}),ct=reactExports.useRef(null);reactExports.useImperativeHandle(ot,()=>ct.current,[]);const[ut,ht]=reactExports.useState([]),[[dt,ft]]=reactExports.useState(()=>{const bt=new Float32Array(rt*16);for(let Tt=0;Tt<rt;Tt++)tempMatrix.identity().toArray(bt,Tt*16);return[bt,new Float32Array([...new Array(rt*3)].map(()=>1))]});reactExports.useEffect(()=>{ct.current.instanceMatrix.needsUpdate=!0});let pt=0,mt=0;const At=reactExports.useRef([]);reactExports.useLayoutEffect(()=>{At.current=Object.entries(ct.current.geometry.attributes).filter(([bt,Tt])=>isInstancedBufferAttribute(Tt))}),useFrame(()=>{if(it===1/0||pt<it){ct.current.updateMatrix(),ct.current.updateMatrixWorld(),parentMatrix.copy(ct.current.matrixWorld).invert(),mt=Math.min(rt,et!==void 0?et:rt,ut.length),ct.current.count=mt,setUpdateRange(ct.current.instanceMatrix,{offset:0,count:mt*16}),setUpdateRange(ct.current.instanceColor,{offset:0,count:mt*3});for(let bt=0;bt<ut.length;bt++){const Tt=ut[bt].current;Tt.matrixWorld.decompose(translation,rotation,scale$1),instanceMatrix.compose(translation,rotation,scale$1).premultiply(parentMatrix),instanceMatrix.toArray(dt,bt*16),ct.current.instanceMatrix.needsUpdate=!0,Tt.color.toArray(ft,bt*3),ct.current.instanceColor.needsUpdate=!0}pt++}});const gt=reactExports.useMemo(()=>({getParent:()=>ct,subscribe:bt=>(ht(Tt=>[...Tt,bt]),()=>ht(Tt=>Tt.filter(wt=>wt.current!==bt.current)))}),[]);return reactExports.createElement("instancedMesh",_extends$2({userData:{instances:ut,limit:rt,frames:it},matrixAutoUpdate:!1,ref:ct,args:[null,null,0],raycast:()=>null},st),reactExports.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:dt.length/16,array:dt,itemSize:16,usage:DynamicDrawUsage$1}),reactExports.createElement("instancedBufferAttribute",{attach:"instanceColor",count:ft.length/3,array:ft,itemSize:3,usage:DynamicDrawUsage$1}),isFunctionChild(_e)?reactExports.createElement(at.Provider,{value:gt},_e(lt)):nt?reactExports.createElement(nt.Provider,{value:gt},_e):reactExports.createElement(globalContext.Provider,{value:gt},_e))}),Merged=reactExports.forwardRef(function({meshes:_e,children:et,...rt},it){const st=Array.isArray(_e);if(!st)for(const ot of Object.keys(_e))_e[ot].isMesh||delete _e[ot];return reactExports.createElement("group",{ref:it},reactExports.createElement(Composer,{components:(st?_e:Object.values(_e)).map(({geometry:ot,material:at})=>reactExports.createElement(Instances$1,_extends$2({key:ot.uuid,geometry:ot,material:at},rt)))},ot=>st?et(...ot):et(Object.keys(_e).filter(at=>_e[at].isMesh).reduce((at,lt,ct)=>({...at,[lt]:ot[ct]}),{}))))});class ConvolutionMaterial extends ShaderMaterial$1{constructor(_e=new Vector2$1){super({uniforms:{inputBuffer:new Uniform$1(null),depthBuffer:new Uniform$1(null),resolution:new Uniform$1(new Vector2$1),texelSize:new Uniform$1(new Vector2$1),halfTexelSize:new Uniform$1(new Vector2$1),kernel:new Uniform$1(0),scale:new Uniform$1(1),cameraNear:new Uniform$1(0),cameraFar:new Uniform$1(1),minDepthThreshold:new Uniform$1(0),maxDepthThreshold:new Uniform$1(1),depthScale:new Uniform$1(0),depthToBlurRatioBias:new Uniform$1(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <${version>=154?"colorspace_fragment":"encodings_fragment"}>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:NoBlending$1,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(_e.x,_e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(_e,et){this.uniforms.texelSize.value.set(_e,et),this.uniforms.halfTexelSize.value.set(_e,et).multiplyScalar(.5)}setResolution(_e){this.uniforms.resolution.value.copy(_e)}}class BlurPass{constructor({gl:_e,resolution:et,width:rt=500,height:it=500,minDepthThreshold:st=0,maxDepthThreshold:ot=1,depthScale:at=0,depthToBlurRatioBias:lt=.25}){this.renderToScreen=!1,this.renderTargetA=new WebGLRenderTarget$1(et,et,{minFilter:LinearFilter$1,magFilter:LinearFilter$1,stencilBuffer:!1,depthBuffer:!1,type:HalfFloatType$1}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new ConvolutionMaterial,this.convolutionMaterial.setTexelSize(1/rt,1/it),this.convolutionMaterial.setResolution(new Vector2$1(rt,it)),this.scene=new Scene$1,this.camera=new Camera$1,this.convolutionMaterial.uniforms.minDepthThreshold.value=st,this.convolutionMaterial.uniforms.maxDepthThreshold.value=ot,this.convolutionMaterial.uniforms.depthScale.value=at,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=lt,this.convolutionMaterial.defines.USE_DEPTH=at>0;const ct=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),ut=new Float32Array([0,0,2,0,0,2]),ht=new BufferGeometry$1;ht.setAttribute("position",new BufferAttribute$1(ct,3)),ht.setAttribute("uv",new BufferAttribute$1(ut,2)),this.screen=new Mesh$1(ht,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(_e,et,rt){const it=this.scene,st=this.camera,ot=this.renderTargetA,at=this.renderTargetB;let lt=this.convolutionMaterial,ct=lt.uniforms;ct.depthBuffer.value=et.depthTexture;const ut=lt.kernel;let ht=et,dt,ft,pt;for(ft=0,pt=ut.length-1;ft<pt;++ft)dt=ft&1?at:ot,ct.kernel.value=ut[ft],ct.inputBuffer.value=ht.texture,_e.setRenderTarget(dt),_e.render(it,st),ht=dt;ct.kernel.value=ut[ft],ct.inputBuffer.value=ht.texture,_e.setRenderTarget(this.renderToScreen?null:rt),_e.render(it,st)}}let MeshReflectorMaterial$1=class extends MeshStandardMaterial$1{constructor(_e={}){super(_e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(_e)}onBeforeCompile(_e){var et;(et=_e.defines)!=null&&et.USE_UV||(_e.defines.USE_UV=""),_e.uniforms.hasBlur=this._hasBlur,_e.uniforms.tDiffuse=this._tDiffuse,_e.uniforms.tDepth=this._tDepth,_e.uniforms.distortionMap=this._distortionMap,_e.uniforms.tDiffuseBlur=this._tDiffuseBlur,_e.uniforms.textureMatrix=this._textureMatrix,_e.uniforms.mirror=this._mirror,_e.uniforms.mixBlur=this._mixBlur,_e.uniforms.mixStrength=this._blurStrength,_e.uniforms.minDepthThreshold=this._minDepthThreshold,_e.uniforms.maxDepthThreshold=this._maxDepthThreshold,_e.uniforms.depthScale=this._depthScale,_e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,_e.uniforms.distortion=this._distortion,_e.uniforms.mixContrast=this._mixContrast,_e.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${_e.vertexShader}`,_e.vertexShader=_e.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),_e.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
			  uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${_e.fragmentShader}`,_e.fragmentShader=_e.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(_e){this._tDiffuse.value=_e}get tDepth(){return this._tDepth.value}set tDepth(_e){this._tDepth.value=_e}get distortionMap(){return this._distortionMap.value}set distortionMap(_e){this._distortionMap.value=_e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(_e){this._tDiffuseBlur.value=_e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(_e){this._textureMatrix.value=_e}get hasBlur(){return this._hasBlur.value}set hasBlur(_e){this._hasBlur.value=_e}get mirror(){return this._mirror.value}set mirror(_e){this._mirror.value=_e}get mixBlur(){return this._mixBlur.value}set mixBlur(_e){this._mixBlur.value=_e}get mixStrength(){return this._blurStrength.value}set mixStrength(_e){this._blurStrength.value=_e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(_e){this._minDepthThreshold.value=_e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(_e){this._maxDepthThreshold.value=_e}get depthScale(){return this._depthScale.value}set depthScale(_e){this._depthScale.value=_e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(_e){this._depthToBlurRatioBias.value=_e}get distortion(){return this._distortion.value}set distortion(_e){this._distortion.value=_e}get mixContrast(){return this._mixContrast.value}set mixContrast(_e){this._mixContrast.value=_e}};const MeshReflectorMaterial=reactExports.forwardRef(({mixBlur:nt=0,mixStrength:_e=1,resolution:et=256,blur:rt=[0,0],minDepthThreshold:it=.9,maxDepthThreshold:st=1,depthScale:ot=0,depthToBlurRatioBias:at=.25,mirror:lt=0,distortion:ct=1,mixContrast:ut=1,distortionMap:ht,reflectorOffset:dt=0,...ft},pt)=>{extend$1({MeshReflectorMaterialImpl:MeshReflectorMaterial$1});const mt=useThree(({gl:Jt})=>Jt),At=useThree(({camera:Jt})=>Jt),gt=useThree(({scene:Jt})=>Jt);rt=Array.isArray(rt)?rt:[rt,rt];const bt=rt[0]+rt[1]>0,Tt=reactExports.useRef(null);reactExports.useImperativeHandle(pt,()=>Tt.current,[]);const[wt]=reactExports.useState(()=>new Plane$1),[Rt]=reactExports.useState(()=>new Vector3$1),[It]=reactExports.useState(()=>new Vector3$1),[Lt]=reactExports.useState(()=>new Vector3$1),[$t]=reactExports.useState(()=>new Matrix4$1),[kt]=reactExports.useState(()=>new Vector3$1(0,0,-1)),[Dt]=reactExports.useState(()=>new Vector4$1),[Ot]=reactExports.useState(()=>new Vector3$1),[zt]=reactExports.useState(()=>new Vector3$1),[Ht]=reactExports.useState(()=>new Vector4$1),[Yt]=reactExports.useState(()=>new Matrix4$1),[Xt]=reactExports.useState(()=>new PerspectiveCamera$2),Zt=reactExports.useCallback(()=>{var Jt;const sn=Tt.current.parent||((Jt=Tt.current)==null?void 0:Jt.__r3f.parent);if(!sn||(It.setFromMatrixPosition(sn.matrixWorld),Lt.setFromMatrixPosition(At.matrixWorld),$t.extractRotation(sn.matrixWorld),Rt.set(0,0,1),Rt.applyMatrix4($t),It.addScaledVector(Rt,dt),Ot.subVectors(It,Lt),Ot.dot(Rt)>0))return;Ot.reflect(Rt).negate(),Ot.add(It),$t.extractRotation(At.matrixWorld),kt.set(0,0,-1),kt.applyMatrix4($t),kt.add(Lt),zt.subVectors(It,kt),zt.reflect(Rt).negate(),zt.add(It),Xt.position.copy(Ot),Xt.up.set(0,1,0),Xt.up.applyMatrix4($t),Xt.up.reflect(Rt),Xt.lookAt(zt),Xt.far=At.far,Xt.updateMatrixWorld(),Xt.projectionMatrix.copy(At.projectionMatrix),Yt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Yt.multiply(Xt.projectionMatrix),Yt.multiply(Xt.matrixWorldInverse),Yt.multiply(sn.matrixWorld),wt.setFromNormalAndCoplanarPoint(Rt,It),wt.applyMatrix4(Xt.matrixWorldInverse),Dt.set(wt.normal.x,wt.normal.y,wt.normal.z,wt.constant);const hn=Xt.projectionMatrix;Ht.x=(Math.sign(Dt.x)+hn.elements[8])/hn.elements[0],Ht.y=(Math.sign(Dt.y)+hn.elements[9])/hn.elements[5],Ht.z=-1,Ht.w=(1+hn.elements[10])/hn.elements[14],Dt.multiplyScalar(2/Dt.dot(Ht)),hn.elements[2]=Dt.x,hn.elements[6]=Dt.y,hn.elements[10]=Dt.z+1,hn.elements[14]=Dt.w},[At,dt]),[rn,Gt,jt,Kt]=reactExports.useMemo(()=>{const Jt={minFilter:LinearFilter$1,magFilter:LinearFilter$1,type:HalfFloatType$1},sn=new WebGLRenderTarget$1(et,et,Jt);sn.depthBuffer=!0,sn.depthTexture=new DepthTexture$1(et,et),sn.depthTexture.format=DepthFormat$1,sn.depthTexture.type=UnsignedShortType$1;const hn=new WebGLRenderTarget$1(et,et,Jt),an=new BlurPass({gl:mt,resolution:et,width:rt[0],height:rt[1],minDepthThreshold:it,maxDepthThreshold:st,depthScale:ot,depthToBlurRatioBias:at}),pn={mirror:lt,textureMatrix:Yt,mixBlur:nt,tDiffuse:sn.texture,tDepth:sn.depthTexture,tDiffuseBlur:hn.texture,hasBlur:bt,mixStrength:_e,minDepthThreshold:it,maxDepthThreshold:st,depthScale:ot,depthToBlurRatioBias:at,distortion:ct,distortionMap:ht,mixContrast:ut,"defines-USE_BLUR":bt?"":void 0,"defines-USE_DEPTH":ot>0?"":void 0,"defines-USE_DISTORTION":ht?"":void 0};return[sn,hn,an,pn]},[mt,rt,Yt,et,lt,bt,nt,_e,it,st,ot,at,ct,ht,ut]);return useFrame(()=>{var Jt;const sn=Tt.current.parent||((Jt=Tt.current)==null?void 0:Jt.__r3f.parent);if(!sn)return;sn.visible=!1;const hn=mt.xr.enabled,an=mt.shadowMap.autoUpdate;Zt(),mt.xr.enabled=!1,mt.shadowMap.autoUpdate=!1,mt.setRenderTarget(rn),mt.state.buffers.depth.setMask(!0),mt.autoClear||mt.clear(),mt.render(gt,Xt),bt&&jt.render(mt,rn,Gt),mt.xr.enabled=hn,mt.shadowMap.autoUpdate=an,sn.visible=!0,mt.setRenderTarget(null)}),reactExports.createElement("meshReflectorMaterialImpl",_extends$2({attach:"material",key:"key"+Kt["defines-USE_BLUR"]+Kt["defines-USE_DEPTH"]+Kt["defines-USE_DISTORTION"],ref:Tt},Kt,ft))});function BakeShadows(){const nt=useThree(_e=>_e.gl);return reactExports.useEffect(()=>(nt.shadowMap.autoUpdate=!1,nt.shadowMap.needsUpdate=!0,()=>{nt.shadowMap.autoUpdate=nt.shadowMap.needsUpdate=!0}),[nt.shadowMap]),null}const RenderTexture=reactExports.forwardRef(({children:nt,compute:_e,width:et,height:rt,samples:it=8,renderPriority:st=0,eventPriority:ot=0,frames:at=1/0,stencilBuffer:lt=!1,depthBuffer:ct=!0,generateMipmaps:ut=!1,...ht},dt)=>{const{size:ft,viewport:pt}=useThree(),mt=useFBO((et||ft.width)*pt.dpr,(rt||ft.height)*pt.dpr,{samples:it,stencilBuffer:lt,depthBuffer:ct,generateMipmaps:ut}),[At]=reactExports.useState(()=>new Scene$1),gt=reactExports.useCallback((bt,Tt,wt)=>{var Rt,It;let Lt=(Rt=mt.texture)==null?void 0:Rt.__r3f.parent;for(;Lt&&!(Lt instanceof Object3D$1);)Lt=Lt.__r3f.parent;if(!Lt)return!1;wt.raycaster.camera||wt.events.compute(bt,wt,(It=wt.previousRoot)==null?void 0:It.getState());const[$t]=wt.raycaster.intersectObject(Lt);if(!$t)return!1;const kt=$t.uv;if(!kt)return!1;Tt.raycaster.setFromCamera(Tt.pointer.set(kt.x*2-1,kt.y*2-1),Tt.camera)},[]);return reactExports.useImperativeHandle(dt,()=>mt.texture,[mt]),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(Container,{renderPriority:st,frames:at,fbo:mt},nt,reactExports.createElement("group",{onPointerOver:()=>null})),At,{events:{compute:_e||gt,priority:ot}}),reactExports.createElement("primitive",_extends$2({object:mt.texture},ht)))});function Container({frames:nt,renderPriority:_e,children:et,fbo:rt}){let it=0,st,ot,at,lt;return useFrame(ct=>{(nt===1/0||it<nt)&&(st=ct.gl.autoClear,ot=ct.gl.xr.enabled,at=ct.gl.getRenderTarget(),lt=ct.gl.xr.isPresenting,ct.gl.autoClear=!0,ct.gl.xr.enabled=!1,ct.gl.xr.isPresenting=!1,ct.gl.setRenderTarget(rt),ct.gl.render(ct.scene,ct.camera),ct.gl.setRenderTarget(at),ct.gl.autoClear=st,ct.gl.xr.enabled=ot,ct.gl.xr.isPresenting=lt,it++)},_e),reactExports.createElement(reactExports.Fragment,null,et)}function _assertThisInitialized$4(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _inheritsLoose$1(nt,_e){nt.prototype=Object.create(_e.prototype),nt.prototype.constructor=nt,nt.__proto__=_e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults={duration:.5,overwrite:!1,delay:0},_suppressOverwrites,_reverting$1,_context,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString=function(_e){return typeof _e=="string"},_isFunction=function(_e){return typeof _e=="function"},_isNumber=function(_e){return typeof _e=="number"},_isUndefined=function(_e){return typeof _e>"u"},_isObject=function(_e){return typeof _e=="object"},_isNotFalse=function(_e){return _e!==!1},_windowExists$1=function(){return typeof window<"u"},_isFuncOrString=function(_e){return _isFunction(_e)||_isString(_e)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$1,_coreInitted,_doc$1,_globals={},_installScope={},_coreReady,_install=function(_e){return(_installScope=_merge(_e,_globals))&&gsap},_missingPlugin=function(_e,et){return console.warn("Invalid property",_e,"set to",et,"Missing plugin? gsap.registerPlugin()")},_warn=function(_e,et){return!et&&console.warn(_e)},_addGlobal=function(_e,et){return _e&&(_globals[_e]=et)&&_installScope&&(_installScope[_e]=et)||_globals},_emptyFunc=function(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function(_e){var et=_e[0],rt,it;if(_isObject(et)||_isFunction(et)||(_e=[_e]),!(rt=(et._gsap||{}).harness)){for(it=_harnessPlugins.length;it--&&!_harnessPlugins[it].targetTest(et););rt=_harnessPlugins[it]}for(it=_e.length;it--;)_e[it]&&(_e[it]._gsap||(_e[it]._gsap=new GSCache(_e[it],rt)))||_e.splice(it,1);return _e},_getCache=function(_e){return _e._gsap||_harness(toArray(_e))[0]._gsap},_getProperty=function(_e,et,rt){return(rt=_e[et])&&_isFunction(rt)?_e[et]():_isUndefined(rt)&&_e.getAttribute&&_e.getAttribute(et)||rt},_forEachName=function(_e,et){return(_e=_e.split(",")).forEach(et)||_e},_round=function(_e){return Math.round(_e*1e5)/1e5||0},_roundPrecise=function(_e){return Math.round(_e*1e7)/1e7||0},_parseRelative=function(_e,et){var rt=et.charAt(0),it=parseFloat(et.substr(2));return _e=parseFloat(_e),rt==="+"?_e+it:rt==="-"?_e-it:rt==="*"?_e*it:_e/it},_arrayContainsAny=function(_e,et){for(var rt=et.length,it=0;_e.indexOf(et[it])<0&&++it<rt;);return it<rt},_lazyRender=function(){var _e=_lazyTweens.length,et=_lazyTweens.slice(0),rt,it;for(_lazyLookup={},_lazyTweens.length=0,rt=0;rt<_e;rt++)it=et[rt],it&&it._lazy&&(it.render(it._lazy[0],it._lazy[1],!0)._lazy=0)},_lazySafeRender=function(_e,et,rt,it){_lazyTweens.length&&!_reverting$1&&_lazyRender(),_e.render(et,rt,_reverting$1&&et<0&&(_e._initted||_e._startAt)),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function(_e){var et=parseFloat(_e);return(et||et===0)&&(_e+"").match(_delimitedValueExp).length<2?et:_isString(_e)?_e.trim():_e},_passThrough=function(_e){return _e},_setDefaults=function(_e,et){for(var rt in et)rt in _e||(_e[rt]=et[rt]);return _e},_setKeyframeDefaults=function(_e){return function(et,rt){for(var it in rt)it in et||it==="duration"&&_e||it==="ease"||(et[it]=rt[it])}},_merge=function(_e,et){for(var rt in et)_e[rt]=et[rt];return _e},_mergeDeep=function nt(_e,et){for(var rt in et)rt!=="__proto__"&&rt!=="constructor"&&rt!=="prototype"&&(_e[rt]=_isObject(et[rt])?nt(_e[rt]||(_e[rt]={}),et[rt]):et[rt]);return _e},_copyExcluding=function(_e,et){var rt={},it;for(it in _e)it in et||(rt[it]=_e[it]);return rt},_inheritDefaults=function(_e){var et=_e.parent||_globalTimeline,rt=_e.keyframes?_setKeyframeDefaults(_isArray(_e.keyframes)):_setDefaults;if(_isNotFalse(_e.inherit))for(;et;)rt(_e,et.vars.defaults),et=et.parent||et._dp;return _e},_arraysMatch=function(_e,et){for(var rt=_e.length,it=rt===et.length;it&&rt--&&_e[rt]===et[rt];);return rt<0},_addLinkedListItem=function(_e,et,rt,it,st){var ot=_e[it],at;if(st)for(at=et[st];ot&&ot[st]>at;)ot=ot._prev;return ot?(et._next=ot._next,ot._next=et):(et._next=_e[rt],_e[rt]=et),et._next?et._next._prev=et:_e[it]=et,et._prev=ot,et.parent=et._dp=_e,et},_removeLinkedListItem=function(_e,et,rt,it){rt===void 0&&(rt="_first"),it===void 0&&(it="_last");var st=et._prev,ot=et._next;st?st._next=ot:_e[rt]===et&&(_e[rt]=ot),ot?ot._prev=st:_e[it]===et&&(_e[it]=st),et._next=et._prev=et.parent=null},_removeFromParent=function(_e,et){_e.parent&&(!et||_e.parent.autoRemoveChildren)&&_e.parent.remove&&_e.parent.remove(_e),_e._act=0},_uncache=function(_e,et){if(_e&&(!et||et._end>_e._dur||et._start<0))for(var rt=_e;rt;)rt._dirty=1,rt=rt.parent;return _e},_recacheAncestors=function(_e){for(var et=_e.parent;et&&et.parent;)et._dirty=1,et.totalDuration(),et=et.parent;return _e},_rewindStartAt=function(_e,et,rt,it){return _e._startAt&&(_reverting$1?_e._startAt.revert(_revertConfigNoKill):_e.vars.immediateRender&&!_e.vars.autoRevert||_e._startAt.render(et,!0,it))},_hasNoPausedAncestors=function nt(_e){return!_e||_e._ts&&nt(_e.parent)},_elapsedCycleDuration=function(_e){return _e._repeat?_animationCycle(_e._tTime,_e=_e.duration()+_e._rDelay)*_e:0},_animationCycle=function(_e,et){var rt=Math.floor(_e/=et);return _e&&rt===_e?rt-1:rt},_parentToChildTotalTime=function(_e,et){return(_e-et._start)*et._ts+(et._ts>=0?0:et._dirty?et.totalDuration():et._tDur)},_setEnd=function(_e){return _e._end=_roundPrecise(_e._start+(_e._tDur/Math.abs(_e._ts||_e._rts||_tinyNum)||0))},_alignPlayhead=function(_e,et){var rt=_e._dp;return rt&&rt.smoothChildTiming&&_e._ts&&(_e._start=_roundPrecise(rt._time-(_e._ts>0?et/_e._ts:((_e._dirty?_e.totalDuration():_e._tDur)-et)/-_e._ts)),_setEnd(_e),rt._dirty||_uncache(rt,_e)),_e},_postAddChecks=function(_e,et){var rt;if((et._time||!et._dur&&et._initted||et._start<_e._time&&(et._dur||!et.add))&&(rt=_parentToChildTotalTime(_e.rawTime(),et),(!et._dur||_clamp(0,et.totalDuration(),rt)-et._tTime>_tinyNum)&&et.render(rt,!0)),_uncache(_e,et)._dp&&_e._initted&&_e._time>=_e._dur&&_e._ts){if(_e._dur<_e.duration())for(rt=_e;rt._dp;)rt.rawTime()>=0&&rt.totalTime(rt._tTime),rt=rt._dp;_e._zTime=-_tinyNum}},_addToTimeline=function(_e,et,rt,it){return et.parent&&_removeFromParent(et),et._start=_roundPrecise((_isNumber(rt)?rt:rt||_e!==_globalTimeline?_parsePosition(_e,rt,et):_e._time)+et._delay),et._end=_roundPrecise(et._start+(et.totalDuration()/Math.abs(et.timeScale())||0)),_addLinkedListItem(_e,et,"_first","_last",_e._sort?"_start":0),_isFromOrFromStart(et)||(_e._recent=et),it||_postAddChecks(_e,et),_e._ts<0&&_alignPlayhead(_e,_e._tTime),_e},_scrollTrigger=function(_e,et){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",et))&&_globals.ScrollTrigger.create(et,_e)},_attemptInitTween=function(_e,et,rt,it,st){if(_initTween(_e,et,st),!_e._initted)return 1;if(!rt&&_e._pt&&!_reverting$1&&(_e._dur&&_e.vars.lazy!==!1||!_e._dur&&_e.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(_e),_e._lazy=[st,it],1},_parentPlayheadIsBeforeStart=function nt(_e){var et=_e.parent;return et&&et._ts&&et._initted&&!et._lock&&(et.rawTime()<0||nt(et))},_isFromOrFromStart=function(_e){var et=_e.data;return et==="isFromStart"||et==="isStart"},_renderZeroDurationTween=function(_e,et,rt,it){var st=_e.ratio,ot=et<0||!et&&(!_e._start&&_parentPlayheadIsBeforeStart(_e)&&!(!_e._initted&&_isFromOrFromStart(_e))||(_e._ts<0||_e._dp._ts<0)&&!_isFromOrFromStart(_e))?0:1,at=_e._rDelay,lt=0,ct,ut,ht;if(at&&_e._repeat&&(lt=_clamp(0,_e._tDur,et),ut=_animationCycle(lt,at),_e._yoyo&&ut&1&&(ot=1-ot),ut!==_animationCycle(_e._tTime,at)&&(st=1-ot,_e.vars.repeatRefresh&&_e._initted&&_e.invalidate())),ot!==st||_reverting$1||it||_e._zTime===_tinyNum||!et&&_e._zTime){if(!_e._initted&&_attemptInitTween(_e,et,it,rt,lt))return;for(ht=_e._zTime,_e._zTime=et||(rt?_tinyNum:0),rt||(rt=et&&!ht),_e.ratio=ot,_e._from&&(ot=1-ot),_e._time=0,_e._tTime=lt,ct=_e._pt;ct;)ct.r(ot,ct.d),ct=ct._next;et<0&&_rewindStartAt(_e,et,rt,!0),_e._onUpdate&&!rt&&_callback(_e,"onUpdate"),lt&&_e._repeat&&!rt&&_e.parent&&_callback(_e,"onRepeat"),(et>=_e._tDur||et<0)&&_e.ratio===ot&&(ot&&_removeFromParent(_e,1),!rt&&!_reverting$1&&(_callback(_e,ot?"onComplete":"onReverseComplete",!0),_e._prom&&_e._prom()))}else _e._zTime||(_e._zTime=et)},_findNextPauseTween=function(_e,et,rt){var it;if(rt>et)for(it=_e._first;it&&it._start<=rt;){if(it.data==="isPause"&&it._start>et)return it;it=it._next}else for(it=_e._last;it&&it._start>=rt;){if(it.data==="isPause"&&it._start<et)return it;it=it._prev}},_setDuration=function(_e,et,rt,it){var st=_e._repeat,ot=_roundPrecise(et)||0,at=_e._tTime/_e._tDur;return at&&!it&&(_e._time*=ot/_e._dur),_e._dur=ot,_e._tDur=st?st<0?1e10:_roundPrecise(ot*(st+1)+_e._rDelay*st):ot,at>0&&!it&&_alignPlayhead(_e,_e._tTime=_e._tDur*at),_e.parent&&_setEnd(_e),rt||_uncache(_e.parent,_e),_e},_onUpdateTotalDuration=function(_e){return _e instanceof Timeline?_uncache(_e):_setDuration(_e,_e._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition=function nt(_e,et,rt){var it=_e.labels,st=_e._recent||_zeroPosition,ot=_e.duration()>=_bigNum$1?st.endTime(!1):_e._dur,at,lt,ct;return _isString(et)&&(isNaN(et)||et in it)?(lt=et.charAt(0),ct=et.substr(-1)==="%",at=et.indexOf("="),lt==="<"||lt===">"?(at>=0&&(et=et.replace(/=/,"")),(lt==="<"?st._start:st.endTime(st._repeat>=0))+(parseFloat(et.substr(1))||0)*(ct?(at<0?st:rt).totalDuration()/100:1)):at<0?(et in it||(it[et]=ot),it[et]):(lt=parseFloat(et.charAt(at-1)+et.substr(at+1)),ct&&rt&&(lt=lt/100*(_isArray(rt)?rt[0]:rt).totalDuration()),at>1?nt(_e,et.substr(0,at-1),rt)+lt:ot+lt)):et==null?ot:+et},_createTweenType=function(_e,et,rt){var it=_isNumber(et[1]),st=(it?2:1)+(_e<2?0:1),ot=et[st],at,lt;if(it&&(ot.duration=et[1]),ot.parent=rt,_e){for(at=ot,lt=rt;lt&&!("immediateRender"in at);)at=lt.vars.defaults||{},lt=_isNotFalse(lt.vars.inherit)&&lt.parent;ot.immediateRender=_isNotFalse(at.immediateRender),_e<2?ot.runBackwards=1:ot.startAt=et[st-1]}return new Tween$1(et[0],ot,et[st+1])},_conditionalReturn=function(_e,et){return _e||_e===0?et(_e):et},_clamp=function(_e,et,rt){return rt<_e?_e:rt>et?et:rt},getUnit=function(_e,et){return!_isString(_e)||!(et=_unitExp.exec(_e))?"":et[1]},clamp$3=function(_e,et,rt){return _conditionalReturn(rt,function(it){return _clamp(_e,et,it)})},_slice=[].slice,_isArrayLike=function(_e,et){return _e&&_isObject(_e)&&"length"in _e&&(!et&&!_e.length||_e.length-1 in _e&&_isObject(_e[0]))&&!_e.nodeType&&_e!==_win$1},_flatten=function(_e,et,rt){return rt===void 0&&(rt=[]),_e.forEach(function(it){var st;return _isString(it)&&!et||_isArrayLike(it,1)?(st=rt).push.apply(st,toArray(it)):rt.push(it)})||rt},toArray=function(_e,et,rt){return _context&&!et&&_context.selector?_context.selector(_e):_isString(_e)&&!rt&&(_coreInitted||!_wake())?_slice.call((et||_doc$1).querySelectorAll(_e),0):_isArray(_e)?_flatten(_e,rt):_isArrayLike(_e)?_slice.call(_e,0):_e?[_e]:[]},selector=function(_e){return _e=toArray(_e)[0]||_warn("Invalid scope")||{},function(et){var rt=_e.current||_e.nativeElement||_e;return toArray(et,rt.querySelectorAll?rt:rt===_e?_warn("Invalid scope")||_doc$1.createElement("div"):_e)}},shuffle=function(_e){return _e.sort(function(){return .5-Math.random()})},distribute=function(_e){if(_isFunction(_e))return _e;var et=_isObject(_e)?_e:{each:_e},rt=_parseEase(et.ease),it=et.from||0,st=parseFloat(et.base)||0,ot={},at=it>0&&it<1,lt=isNaN(it)||at,ct=et.axis,ut=it,ht=it;return _isString(it)?ut=ht={center:.5,edges:.5,end:1}[it]||0:!at&&lt&&(ut=it[0],ht=it[1]),function(dt,ft,pt){var mt=(pt||et).length,At=ot[mt],gt,bt,Tt,wt,Rt,It,Lt,$t,kt;if(!At){if(kt=et.grid==="auto"?0:(et.grid||[1,_bigNum$1])[1],!kt){for(Lt=-_bigNum$1;Lt<(Lt=pt[kt++].getBoundingClientRect().left)&&kt<mt;);kt<mt&&kt--}for(At=ot[mt]=[],gt=lt?Math.min(kt,mt)*ut-.5:it%kt,bt=kt===_bigNum$1?0:lt?mt*ht/kt-.5:it/kt|0,Lt=0,$t=_bigNum$1,It=0;It<mt;It++)Tt=It%kt-gt,wt=bt-(It/kt|0),At[It]=Rt=ct?Math.abs(ct==="y"?wt:Tt):_sqrt(Tt*Tt+wt*wt),Rt>Lt&&(Lt=Rt),Rt<$t&&($t=Rt);it==="random"&&shuffle(At),At.max=Lt-$t,At.min=$t,At.v=mt=(parseFloat(et.amount)||parseFloat(et.each)*(kt>mt?mt-1:ct?ct==="y"?mt/kt:kt:Math.max(kt,mt/kt))||0)*(it==="edges"?-1:1),At.b=mt<0?st-mt:st,At.u=getUnit(et.amount||et.each)||0,rt=rt&&mt<0?_invertEase(rt):rt}return mt=(At[dt]-At.min)/At.max||0,_roundPrecise(At.b+(rt?rt(mt):mt)*At.v)+At.u}},_roundModifier=function(_e){var et=Math.pow(10,((_e+"").split(".")[1]||"").length);return function(rt){var it=_roundPrecise(Math.round(parseFloat(rt)/_e)*_e*et);return(it-it%1)/et+(_isNumber(rt)?0:getUnit(rt))}},snap=function(_e,et){var rt=_isArray(_e),it,st;return!rt&&_isObject(_e)&&(it=rt=_e.radius||_bigNum$1,_e.values?(_e=toArray(_e.values),(st=!_isNumber(_e[0]))&&(it*=it)):_e=_roundModifier(_e.increment)),_conditionalReturn(et,rt?_isFunction(_e)?function(ot){return st=_e(ot),Math.abs(st-ot)<=it?st:ot}:function(ot){for(var at=parseFloat(st?ot.x:ot),lt=parseFloat(st?ot.y:0),ct=_bigNum$1,ut=0,ht=_e.length,dt,ft;ht--;)st?(dt=_e[ht].x-at,ft=_e[ht].y-lt,dt=dt*dt+ft*ft):dt=Math.abs(_e[ht]-at),dt<ct&&(ct=dt,ut=ht);return ut=!it||ct<=it?_e[ut]:ot,st||ut===ot||_isNumber(ot)?ut:ut+getUnit(ot)}:_roundModifier(_e))},random=function(_e,et,rt,it){return _conditionalReturn(_isArray(_e)?!et:rt===!0?!!(rt=0):!it,function(){return _isArray(_e)?_e[~~(Math.random()*_e.length)]:(rt=rt||1e-5)&&(it=rt<1?Math.pow(10,(rt+"").length-2):1)&&Math.floor(Math.round((_e-rt/2+Math.random()*(et-_e+rt*.99))/rt)*rt*it)/it})},pipe$1=function(){for(var _e=arguments.length,et=new Array(_e),rt=0;rt<_e;rt++)et[rt]=arguments[rt];return function(it){return et.reduce(function(st,ot){return ot(st)},it)}},unitize=function(_e,et){return function(rt){return _e(parseFloat(rt))+(et||getUnit(rt))}},normalize$3=function(_e,et,rt){return mapRange(_e,et,0,1,rt)},_wrapArray=function(_e,et,rt){return _conditionalReturn(rt,function(it){return _e[~~et(it)]})},wrap=function nt(_e,et,rt){var it=et-_e;return _isArray(_e)?_wrapArray(_e,nt(0,_e.length),et):_conditionalReturn(rt,function(st){return(it+(st-_e)%it)%it+_e})},wrapYoyo=function nt(_e,et,rt){var it=et-_e,st=it*2;return _isArray(_e)?_wrapArray(_e,nt(0,_e.length-1),et):_conditionalReturn(rt,function(ot){return ot=(st+(ot-_e)%st)%st||0,_e+(ot>it?st-ot:ot)})},_replaceRandom=function(_e){for(var et=0,rt="",it,st,ot,at;~(it=_e.indexOf("random(",et));)ot=_e.indexOf(")",it),at=_e.charAt(it+7)==="[",st=_e.substr(it+7,ot-it-7).match(at?_delimitedValueExp:_strictNumExp),rt+=_e.substr(et,it-et)+random(at?st:+st[0],at?0:+st[1],+st[2]||1e-5),et=ot+1;return rt+_e.substr(et,_e.length-et)},mapRange=function(_e,et,rt,it,st){var ot=et-_e,at=it-rt;return _conditionalReturn(st,function(lt){return rt+((lt-_e)/ot*at||0)})},interpolate$2=function nt(_e,et,rt,it){var st=isNaN(_e+et)?0:function(ft){return(1-ft)*_e+ft*et};if(!st){var ot=_isString(_e),at={},lt,ct,ut,ht,dt;if(rt===!0&&(it=1)&&(rt=null),ot)_e={p:_e},et={p:et};else if(_isArray(_e)&&!_isArray(et)){for(ut=[],ht=_e.length,dt=ht-2,ct=1;ct<ht;ct++)ut.push(nt(_e[ct-1],_e[ct]));ht--,st=function(pt){pt*=ht;var mt=Math.min(dt,~~pt);return ut[mt](pt-mt)},rt=et}else it||(_e=_merge(_isArray(_e)?[]:{},_e));if(!ut){for(lt in et)_addPropTween.call(at,_e,lt,"get",et[lt]);st=function(pt){return _renderPropTweens(pt,at)||(ot?_e.p:_e)}}}return _conditionalReturn(rt,st)},_getLabelInDirection=function(_e,et,rt){var it=_e.labels,st=_bigNum$1,ot,at,lt;for(ot in it)at=it[ot]-et,at<0==!!rt&&at&&st>(at=Math.abs(at))&&(lt=ot,st=at);return lt},_callback=function(_e,et,rt){var it=_e.vars,st=it[et],ot=_context,at=_e._ctx,lt,ct,ut;if(st)return lt=it[et+"Params"],ct=it.callbackScope||_e,rt&&_lazyTweens.length&&_lazyRender(),at&&(_context=at),ut=lt?st.apply(ct,lt):st.call(ct),_context=ot,ut},_interrupt=function(_e){return _removeFromParent(_e),_e.scrollTrigger&&_e.scrollTrigger.kill(!!_reverting$1),_e.progress()<1&&_callback(_e,"onInterrupt"),_e},_quickTween,_registerPluginQueue=[],_createPlugin=function(_e){if(_e)if(_e=!_e.name&&_e.default||_e,_windowExists$1()||_e.headless){var et=_e.name,rt=_isFunction(_e),it=et&&!rt&&_e.init?function(){this._props=[]}:_e,st={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},ot={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),_e!==it){if(_plugins[et])return;_setDefaults(it,_setDefaults(_copyExcluding(_e,st),ot)),_merge(it.prototype,_merge(st,_copyExcluding(_e,ot))),_plugins[it.prop=et]=it,_e.targetTest&&(_harnessPlugins.push(it),_reservedProps[et]=1),et=(et==="css"?"CSS":et.charAt(0).toUpperCase()+et.substr(1))+"Plugin"}_addGlobal(et,it),_e.register&&_e.register(gsap,it,PropTween)}else _registerPluginQueue.push(_e)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function(_e,et,rt){return _e+=_e<0?1:_e>1?-1:0,(_e*6<1?et+(rt-et)*_e*6:_e<.5?rt:_e*3<2?et+(rt-et)*(2/3-_e)*6:et)*_255+.5|0},splitColor$1=function(_e,et,rt){var it=_e?_isNumber(_e)?[_e>>16,_e>>8&_255,_e&_255]:0:_colorLookup.black,st,ot,at,lt,ct,ut,ht,dt,ft,pt;if(!it){if(_e.substr(-1)===","&&(_e=_e.substr(0,_e.length-1)),_colorLookup[_e])it=_colorLookup[_e];else if(_e.charAt(0)==="#"){if(_e.length<6&&(st=_e.charAt(1),ot=_e.charAt(2),at=_e.charAt(3),_e="#"+st+st+ot+ot+at+at+(_e.length===5?_e.charAt(4)+_e.charAt(4):"")),_e.length===9)return it=parseInt(_e.substr(1,6),16),[it>>16,it>>8&_255,it&_255,parseInt(_e.substr(7),16)/255];_e=parseInt(_e.substr(1),16),it=[_e>>16,_e>>8&_255,_e&_255]}else if(_e.substr(0,3)==="hsl"){if(it=pt=_e.match(_strictNumExp),!et)lt=+it[0]%360/360,ct=+it[1]/100,ut=+it[2]/100,ot=ut<=.5?ut*(ct+1):ut+ct-ut*ct,st=ut*2-ot,it.length>3&&(it[3]*=1),it[0]=_hue(lt+1/3,st,ot),it[1]=_hue(lt,st,ot),it[2]=_hue(lt-1/3,st,ot);else if(~_e.indexOf("="))return it=_e.match(_numExp),rt&&it.length<4&&(it[3]=1),it}else it=_e.match(_strictNumExp)||_colorLookup.transparent;it=it.map(Number)}return et&&!pt&&(st=it[0]/_255,ot=it[1]/_255,at=it[2]/_255,ht=Math.max(st,ot,at),dt=Math.min(st,ot,at),ut=(ht+dt)/2,ht===dt?lt=ct=0:(ft=ht-dt,ct=ut>.5?ft/(2-ht-dt):ft/(ht+dt),lt=ht===st?(ot-at)/ft+(ot<at?6:0):ht===ot?(at-st)/ft+2:(st-ot)/ft+4,lt*=60),it[0]=~~(lt+.5),it[1]=~~(ct*100+.5),it[2]=~~(ut*100+.5)),rt&&it.length<4&&(it[3]=1),it},_colorOrderData=function(_e){var et=[],rt=[],it=-1;return _e.split(_colorExp).forEach(function(st){var ot=st.match(_numWithUnitExp)||[];et.push.apply(et,ot),rt.push(it+=ot.length+1)}),et.c=rt,et},_formatColors=function(_e,et,rt){var it="",st=(_e+it).match(_colorExp),ot=et?"hsla(":"rgba(",at=0,lt,ct,ut,ht;if(!st)return _e;if(st=st.map(function(dt){return(dt=splitColor$1(dt,et,1))&&ot+(et?dt[0]+","+dt[1]+"%,"+dt[2]+"%,"+dt[3]:dt.join(","))+")"}),rt&&(ut=_colorOrderData(_e),lt=rt.c,lt.join(it)!==ut.c.join(it)))for(ct=_e.replace(_colorExp,"1").split(_numWithUnitExp),ht=ct.length-1;at<ht;at++)it+=ct[at]+(~lt.indexOf(at)?st.shift()||ot+"0,0,0,0)":(ut.length?ut:st.length?st:rt).shift());if(!ct)for(ct=_e.split(_colorExp),ht=ct.length-1;at<ht;at++)it+=ct[at]+st[at];return it+ct[ht]},_colorExp=function(){var nt="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",_e;for(_e in _colorLookup)nt+="|"+_e+"\\b";return new RegExp(nt+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function(_e){var et=_e.join(" "),rt;if(_colorExp.lastIndex=0,_colorExp.test(et))return rt=_hslExp.test(et),_e[1]=_formatColors(_e[1],rt),_e[0]=_formatColors(_e[0],rt,_colorOrderData(_e[1])),!0},_tickerActive,_ticker=function(){var nt=Date.now,_e=500,et=33,rt=nt(),it=rt,st=1e3/240,ot=st,at=[],lt,ct,ut,ht,dt,ft,pt=function mt(At){var gt=nt()-it,bt=At===!0,Tt,wt,Rt,It;if((gt>_e||gt<0)&&(rt+=gt-et),it+=gt,Rt=it-rt,Tt=Rt-ot,(Tt>0||bt)&&(It=++ht.frame,dt=Rt-ht.time*1e3,ht.time=Rt=Rt/1e3,ot+=Tt+(Tt>=st?4:st-Tt),wt=1),bt||(lt=ct(mt)),wt)for(ft=0;ft<at.length;ft++)at[ft](Rt,dt,It,At)};return ht={time:0,frame:0,tick:function(){pt(!0)},deltaRatio:function(At){return dt/(1e3/(At||60))},wake:function(){_coreReady&&(!_coreInitted&&_windowExists$1()&&(_win$1=_coreInitted=window,_doc$1=_win$1.document||{},_globals.gsap=gsap,(_win$1.gsapVersions||(_win$1.gsapVersions=[])).push(gsap.version),_install(_installScope||_win$1.GreenSockGlobals||!_win$1.gsap&&_win$1||{}),_registerPluginQueue.forEach(_createPlugin)),ut=typeof requestAnimationFrame<"u"&&requestAnimationFrame,lt&&ht.sleep(),ct=ut||function(At){return setTimeout(At,ot-ht.time*1e3+1|0)},_tickerActive=1,pt(2))},sleep:function(){(ut?cancelAnimationFrame:clearTimeout)(lt),_tickerActive=0,ct=_emptyFunc},lagSmoothing:function(At,gt){_e=At||1/0,et=Math.min(gt||33,_e)},fps:function(At){st=1e3/(At||240),ot=ht.time*1e3+st},add:function(At,gt,bt){var Tt=gt?function(wt,Rt,It,Lt){At(wt,Rt,It,Lt),ht.remove(Tt)}:At;return ht.remove(At),at[bt?"unshift":"push"](Tt),_wake(),Tt},remove:function(At,gt){~(gt=at.indexOf(At))&&at.splice(gt,1)&&ft>=gt&&ft--},_listeners:at},ht}(),_wake=function(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function(_e){for(var et={},rt=_e.substr(1,_e.length-3).split(":"),it=rt[0],st=1,ot=rt.length,at,lt,ct;st<ot;st++)lt=rt[st],at=st!==ot-1?lt.lastIndexOf(","):lt.length,ct=lt.substr(0,at),et[it]=isNaN(ct)?ct.replace(_quotesExp,"").trim():+ct,it=lt.substr(at+1).trim();return et},_valueInParentheses=function(_e){var et=_e.indexOf("(")+1,rt=_e.indexOf(")"),it=_e.indexOf("(",et);return _e.substring(et,~it&&it<rt?_e.indexOf(")",rt+1):rt)},_configEaseFromString=function(_e){var et=(_e+"").split("("),rt=_easeMap[et[0]];return rt&&et.length>1&&rt.config?rt.config.apply(null,~_e.indexOf("{")?[_parseObjectInString(et[1])]:_valueInParentheses(_e).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(_e)?_easeMap._CE("",_e):rt},_invertEase=function(_e){return function(et){return 1-_e(1-et)}},_propagateYoyoEase=function nt(_e,et){for(var rt=_e._first,it;rt;)rt instanceof Timeline?nt(rt,et):rt.vars.yoyoEase&&(!rt._yoyo||!rt._repeat)&&rt._yoyo!==et&&(rt.timeline?nt(rt.timeline,et):(it=rt._ease,rt._ease=rt._yEase,rt._yEase=it,rt._yoyo=et)),rt=rt._next},_parseEase=function(_e,et){return _e&&(_isFunction(_e)?_e:_easeMap[_e]||_configEaseFromString(_e))||et},_insertEase=function(_e,et,rt,it){rt===void 0&&(rt=function(lt){return 1-et(1-lt)}),it===void 0&&(it=function(lt){return lt<.5?et(lt*2)/2:1-et((1-lt)*2)/2});var st={easeIn:et,easeOut:rt,easeInOut:it},ot;return _forEachName(_e,function(at){_easeMap[at]=_globals[at]=st,_easeMap[ot=at.toLowerCase()]=rt;for(var lt in st)_easeMap[ot+(lt==="easeIn"?".in":lt==="easeOut"?".out":".inOut")]=_easeMap[at+"."+lt]=st[lt]}),st},_easeInOutFromOut=function(_e){return function(et){return et<.5?(1-_e(1-et*2))/2:.5+_e((et-.5)*2)/2}},_configElastic=function nt(_e,et,rt){var it=et>=1?et:1,st=(rt||(_e?.3:.45))/(et<1?et:1),ot=st/_2PI*(Math.asin(1/it)||0),at=function(ut){return ut===1?1:it*Math.pow(2,-10*ut)*_sin((ut-ot)*st)+1},lt=_e==="out"?at:_e==="in"?function(ct){return 1-at(1-ct)}:_easeInOutFromOut(at);return st=_2PI/st,lt.config=function(ct,ut){return nt(_e,ct,ut)},lt},_configBack=function nt(_e,et){et===void 0&&(et=1.70158);var rt=function(ot){return ot?--ot*ot*((et+1)*ot+et)+1:0},it=_e==="out"?rt:_e==="in"?function(st){return 1-rt(1-st)}:_easeInOutFromOut(rt);return it.config=function(st){return nt(_e,st)},it};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(nt,_e){var et=_e<5?_e+1:_e;_insertEase(nt+",Power"+(et-1),_e?function(rt){return Math.pow(rt,et)}:function(rt){return rt},function(rt){return 1-Math.pow(1-rt,et)},function(rt){return rt<.5?Math.pow(rt*2,et)/2:1-Math.pow((1-rt)*2,et)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(nt,_e){var et=1/_e,rt=2*et,it=2.5*et,st=function(at){return at<et?nt*at*at:at<rt?nt*Math.pow(at-1.5/_e,2)+.75:at<it?nt*(at-=2.25/_e)*at+.9375:nt*Math.pow(at-2.625/_e,2)+.984375};_insertEase("Bounce",function(ot){return 1-st(1-ot)},st)})(7.5625,2.75);_insertEase("Expo",function(nt){return nt?Math.pow(2,10*(nt-1)):0});_insertEase("Circ",function(nt){return-(_sqrt(1-nt*nt)-1)});_insertEase("Sine",function(nt){return nt===1?1:-_cos(nt*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function(_e,et){_e===void 0&&(_e=1);var rt=1/_e,it=_e+(et?0:1),st=et?1:0,ot=1-_tinyNum;return function(at){return((it*_clamp(0,ot,at)|0)+st)*rt}}};_defaults.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(nt){return _callbackNames+=nt+","+nt+"Params,"});var GSCache=function(_e,et){this.id=_gsID++,_e._gsap=this,this.target=_e,this.harness=et,this.get=et?et.get:_getProperty,this.set=et?et.getSetter:_getSetter},Animation$1=function(){function nt(et){this.vars=et,this._delay=+et.delay||0,(this._repeat=et.repeat===1/0?-2:et.repeat||0)&&(this._rDelay=et.repeatDelay||0,this._yoyo=!!et.yoyo||!!et.yoyoEase),this._ts=1,_setDuration(this,+et.duration,1,1),this.data=et.data,_context&&(this._ctx=_context,_context.data.push(this)),_tickerActive||_ticker.wake()}var _e=nt.prototype;return _e.delay=function(rt){return rt||rt===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+rt-this._delay),this._delay=rt,this):this._delay},_e.duration=function(rt){return arguments.length?this.totalDuration(this._repeat>0?rt+(rt+this._rDelay)*this._repeat:rt):this.totalDuration()&&this._dur},_e.totalDuration=function(rt){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?rt:(rt-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},_e.totalTime=function(rt,it){if(_wake(),!arguments.length)return this._tTime;var st=this._dp;if(st&&st.smoothChildTiming&&this._ts){for(_alignPlayhead(this,rt),!st._dp||st.parent||_postAddChecks(st,this);st&&st.parent;)st.parent._time!==st._start+(st._ts>=0?st._tTime/st._ts:(st.totalDuration()-st._tTime)/-st._ts)&&st.totalTime(st._tTime,!0),st=st.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&rt<this._tDur||this._ts<0&&rt>0||!this._tDur&&!rt)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==rt||!this._dur&&!it||this._initted&&Math.abs(this._zTime)===_tinyNum||!rt&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=rt),_lazySafeRender(this,rt,it)),this},_e.time=function(rt,it){return arguments.length?this.totalTime(Math.min(this.totalDuration(),rt+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(rt?this._dur:0),it):this._time},_e.totalProgress=function(rt,it){return arguments.length?this.totalTime(this.totalDuration()*rt,it):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},_e.progress=function(rt,it){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-rt:rt)+_elapsedCycleDuration(this),it):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},_e.iteration=function(rt,it){var st=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(rt-1)*st,it):this._repeat?_animationCycle(this._tTime,st)+1:1},_e.timeScale=function(rt,it){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===rt)return this;var st=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+rt||0,this._ts=this._ps||rt===-_tinyNum?0:this._rts,this.totalTime(_clamp(-Math.abs(this._delay),this._tDur,st),it!==!1),_setEnd(this),_recacheAncestors(this)},_e.paused=function(rt){return arguments.length?(this._ps!==rt&&(this._ps=rt,rt?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},_e.startTime=function(rt){if(arguments.length){this._start=rt;var it=this.parent||this._dp;return it&&(it._sort||!this.parent)&&_addToTimeline(it,this,rt-this._delay),this}return this._start},_e.endTime=function(rt){return this._start+(_isNotFalse(rt)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},_e.rawTime=function(rt){var it=this.parent||this._dp;return it?rt&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(it.rawTime(rt),this):this._tTime:this._tTime},_e.revert=function(rt){rt===void 0&&(rt=_revertConfig);var it=_reverting$1;return _reverting$1=rt,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(rt),this.totalTime(-.01,rt.suppressEvents)),this.data!=="nested"&&rt.kill!==!1&&this.kill(),_reverting$1=it,this},_e.globalTime=function(rt){for(var it=this,st=arguments.length?rt:it.rawTime();it;)st=it._start+st/(Math.abs(it._ts)||1),it=it._dp;return!this.parent&&this._sat?this._sat.globalTime(rt):st},_e.repeat=function(rt){return arguments.length?(this._repeat=rt===1/0?-2:rt,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},_e.repeatDelay=function(rt){if(arguments.length){var it=this._time;return this._rDelay=rt,_onUpdateTotalDuration(this),it?this.time(it):this}return this._rDelay},_e.yoyo=function(rt){return arguments.length?(this._yoyo=rt,this):this._yoyo},_e.seek=function(rt,it){return this.totalTime(_parsePosition(this,rt),_isNotFalse(it))},_e.restart=function(rt,it){return this.play().totalTime(rt?-this._delay:0,_isNotFalse(it))},_e.play=function(rt,it){return rt!=null&&this.seek(rt,it),this.reversed(!1).paused(!1)},_e.reverse=function(rt,it){return rt!=null&&this.seek(rt||this.totalDuration(),it),this.reversed(!0).paused(!1)},_e.pause=function(rt,it){return rt!=null&&this.seek(rt,it),this.paused(!0)},_e.resume=function(){return this.paused(!1)},_e.reversed=function(rt){return arguments.length?(!!rt!==this.reversed()&&this.timeScale(-this._rts||(rt?-_tinyNum:0)),this):this._rts<0},_e.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},_e.isActive=function(){var rt=this.parent||this._dp,it=this._start,st;return!!(!rt||this._ts&&this._initted&&rt.isActive()&&(st=rt.rawTime(!0))>=it&&st<this.endTime(!0)-_tinyNum)},_e.eventCallback=function(rt,it,st){var ot=this.vars;return arguments.length>1?(it?(ot[rt]=it,st&&(ot[rt+"Params"]=st),rt==="onUpdate"&&(this._onUpdate=it)):delete ot[rt],this):ot[rt]},_e.then=function(rt){var it=this;return new Promise(function(st){var ot=_isFunction(rt)?rt:_passThrough,at=function(){var ct=it.then;it.then=null,_isFunction(ot)&&(ot=ot(it))&&(ot.then||ot===it)&&(it.then=ct),st(ot),it.then=ct};it._initted&&it.totalProgress()===1&&it._ts>=0||!it._tTime&&it._ts<0?at():it._prom=at})},_e.kill=function(){_interrupt(this)},nt}();_setDefaults(Animation$1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function(nt){_inheritsLoose$1(_e,nt);function _e(rt,it){var st;return rt===void 0&&(rt={}),st=nt.call(this,rt)||this,st.labels={},st.smoothChildTiming=!!rt.smoothChildTiming,st.autoRemoveChildren=!!rt.autoRemoveChildren,st._sort=_isNotFalse(rt.sortChildren),_globalTimeline&&_addToTimeline(rt.parent||_globalTimeline,_assertThisInitialized$4(st),it),rt.reversed&&st.reverse(),rt.paused&&st.paused(!0),rt.scrollTrigger&&_scrollTrigger(_assertThisInitialized$4(st),rt.scrollTrigger),st}var et=_e.prototype;return et.to=function(it,st,ot){return _createTweenType(0,arguments,this),this},et.from=function(it,st,ot){return _createTweenType(1,arguments,this),this},et.fromTo=function(it,st,ot,at){return _createTweenType(2,arguments,this),this},et.set=function(it,st,ot){return st.duration=0,st.parent=this,_inheritDefaults(st).repeatDelay||(st.repeat=0),st.immediateRender=!!st.immediateRender,new Tween$1(it,st,_parsePosition(this,ot),1),this},et.call=function(it,st,ot){return _addToTimeline(this,Tween$1.delayedCall(0,it,st),ot)},et.staggerTo=function(it,st,ot,at,lt,ct,ut){return ot.duration=st,ot.stagger=ot.stagger||at,ot.onComplete=ct,ot.onCompleteParams=ut,ot.parent=this,new Tween$1(it,ot,_parsePosition(this,lt)),this},et.staggerFrom=function(it,st,ot,at,lt,ct,ut){return ot.runBackwards=1,_inheritDefaults(ot).immediateRender=_isNotFalse(ot.immediateRender),this.staggerTo(it,st,ot,at,lt,ct,ut)},et.staggerFromTo=function(it,st,ot,at,lt,ct,ut,ht){return at.startAt=ot,_inheritDefaults(at).immediateRender=_isNotFalse(at.immediateRender),this.staggerTo(it,st,at,lt,ct,ut,ht)},et.render=function(it,st,ot){var at=this._time,lt=this._dirty?this.totalDuration():this._tDur,ct=this._dur,ut=it<=0?0:_roundPrecise(it),ht=this._zTime<0!=it<0&&(this._initted||!ct),dt,ft,pt,mt,At,gt,bt,Tt,wt,Rt,It,Lt;if(this!==_globalTimeline&&ut>lt&&it>=0&&(ut=lt),ut!==this._tTime||ot||ht){if(at!==this._time&&ct&&(ut+=this._time-at,it+=this._time-at),dt=ut,wt=this._start,Tt=this._ts,gt=!Tt,ht&&(ct||(at=this._zTime),(it||!st)&&(this._zTime=it)),this._repeat){if(It=this._yoyo,At=ct+this._rDelay,this._repeat<-1&&it<0)return this.totalTime(At*100+it,st,ot);if(dt=_roundPrecise(ut%At),ut===lt?(mt=this._repeat,dt=ct):(mt=~~(ut/At),mt&&mt===ut/At&&(dt=ct,mt--),dt>ct&&(dt=ct)),Rt=_animationCycle(this._tTime,At),!at&&this._tTime&&Rt!==mt&&this._tTime-Rt*At-this._dur<=0&&(Rt=mt),It&&mt&1&&(dt=ct-dt,Lt=1),mt!==Rt&&!this._lock){var $t=It&&Rt&1,kt=$t===(It&&mt&1);if(mt<Rt&&($t=!$t),at=$t?0:ut%ct?ct:ut,this._lock=1,this.render(at||(Lt?0:_roundPrecise(mt*At)),st,!ct)._lock=0,this._tTime=ut,!st&&this.parent&&_callback(this,"onRepeat"),this.vars.repeatRefresh&&!Lt&&(this.invalidate()._lock=1),at&&at!==this._time||gt!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(ct=this._dur,lt=this._tDur,kt&&(this._lock=2,at=$t?ct:-1e-4,this.render(at,!0),this.vars.repeatRefresh&&!Lt&&this.invalidate()),this._lock=0,!this._ts&&!gt)return this;_propagateYoyoEase(this,Lt)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(bt=_findNextPauseTween(this,_roundPrecise(at),_roundPrecise(dt)),bt&&(ut-=dt-(dt=bt._start))),this._tTime=ut,this._time=dt,this._act=!Tt,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=it,at=0),!at&&dt&&!st&&!mt&&(_callback(this,"onStart"),this._tTime!==ut))return this;if(dt>=at&&it>=0)for(ft=this._first;ft;){if(pt=ft._next,(ft._act||dt>=ft._start)&&ft._ts&&bt!==ft){if(ft.parent!==this)return this.render(it,st,ot);if(ft.render(ft._ts>0?(dt-ft._start)*ft._ts:(ft._dirty?ft.totalDuration():ft._tDur)+(dt-ft._start)*ft._ts,st,ot),dt!==this._time||!this._ts&&!gt){bt=0,pt&&(ut+=this._zTime=-_tinyNum);break}}ft=pt}else{ft=this._last;for(var Dt=it<0?it:dt;ft;){if(pt=ft._prev,(ft._act||Dt<=ft._end)&&ft._ts&&bt!==ft){if(ft.parent!==this)return this.render(it,st,ot);if(ft.render(ft._ts>0?(Dt-ft._start)*ft._ts:(ft._dirty?ft.totalDuration():ft._tDur)+(Dt-ft._start)*ft._ts,st,ot||_reverting$1&&(ft._initted||ft._startAt)),dt!==this._time||!this._ts&&!gt){bt=0,pt&&(ut+=this._zTime=Dt?-_tinyNum:_tinyNum);break}}ft=pt}}if(bt&&!st&&(this.pause(),bt.render(dt>=at?0:-_tinyNum)._zTime=dt>=at?1:-1,this._ts))return this._start=wt,_setEnd(this),this.render(it,st,ot);this._onUpdate&&!st&&_callback(this,"onUpdate",!0),(ut===lt&&this._tTime>=this.totalDuration()||!ut&&at)&&(wt===this._start||Math.abs(Tt)!==Math.abs(this._ts))&&(this._lock||((it||!ct)&&(ut===lt&&this._ts>0||!ut&&this._ts<0)&&_removeFromParent(this,1),!st&&!(it<0&&!at)&&(ut||at||!lt)&&(_callback(this,ut===lt&&it>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(ut<lt&&this.timeScale()>0)&&this._prom())))}return this},et.add=function(it,st){var ot=this;if(_isNumber(st)||(st=_parsePosition(this,st,it)),!(it instanceof Animation$1)){if(_isArray(it))return it.forEach(function(at){return ot.add(at,st)}),this;if(_isString(it))return this.addLabel(it,st);if(_isFunction(it))it=Tween$1.delayedCall(0,it);else return this}return this!==it?_addToTimeline(this,it,st):this},et.getChildren=function(it,st,ot,at){it===void 0&&(it=!0),st===void 0&&(st=!0),ot===void 0&&(ot=!0),at===void 0&&(at=-_bigNum$1);for(var lt=[],ct=this._first;ct;)ct._start>=at&&(ct instanceof Tween$1?st&&lt.push(ct):(ot&&lt.push(ct),it&&lt.push.apply(lt,ct.getChildren(!0,st,ot)))),ct=ct._next;return lt},et.getById=function(it){for(var st=this.getChildren(1,1,1),ot=st.length;ot--;)if(st[ot].vars.id===it)return st[ot]},et.remove=function(it){return _isString(it)?this.removeLabel(it):_isFunction(it)?this.killTweensOf(it):(_removeLinkedListItem(this,it),it===this._recent&&(this._recent=this._last),_uncache(this))},et.totalTime=function(it,st){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?it/this._ts:(this.totalDuration()-it)/-this._ts))),nt.prototype.totalTime.call(this,it,st),this._forcing=0,this):this._tTime},et.addLabel=function(it,st){return this.labels[it]=_parsePosition(this,st),this},et.removeLabel=function(it){return delete this.labels[it],this},et.addPause=function(it,st,ot){var at=Tween$1.delayedCall(0,st||_emptyFunc,ot);return at.data="isPause",this._hasPause=1,_addToTimeline(this,at,_parsePosition(this,it))},et.removePause=function(it){var st=this._first;for(it=_parsePosition(this,it);st;)st._start===it&&st.data==="isPause"&&_removeFromParent(st),st=st._next},et.killTweensOf=function(it,st,ot){for(var at=this.getTweensOf(it,ot),lt=at.length;lt--;)_overwritingTween!==at[lt]&&at[lt].kill(it,st);return this},et.getTweensOf=function(it,st){for(var ot=[],at=toArray(it),lt=this._first,ct=_isNumber(st),ut;lt;)lt instanceof Tween$1?_arrayContainsAny(lt._targets,at)&&(ct?(!_overwritingTween||lt._initted&&lt._ts)&&lt.globalTime(0)<=st&&lt.globalTime(lt.totalDuration())>st:!st||lt.isActive())&&ot.push(lt):(ut=lt.getTweensOf(at,st)).length&&ot.push.apply(ot,ut),lt=lt._next;return ot},et.tweenTo=function(it,st){st=st||{};var ot=this,at=_parsePosition(ot,it),lt=st,ct=lt.startAt,ut=lt.onStart,ht=lt.onStartParams,dt=lt.immediateRender,ft,pt=Tween$1.to(ot,_setDefaults({ease:st.ease||"none",lazy:!1,immediateRender:!1,time:at,overwrite:"auto",duration:st.duration||Math.abs((at-(ct&&"time"in ct?ct.time:ot._time))/ot.timeScale())||_tinyNum,onStart:function(){if(ot.pause(),!ft){var At=st.duration||Math.abs((at-(ct&&"time"in ct?ct.time:ot._time))/ot.timeScale());pt._dur!==At&&_setDuration(pt,At,0,1).render(pt._time,!0,!0),ft=1}ut&&ut.apply(pt,ht||[])}},st));return dt?pt.render(0):pt},et.tweenFromTo=function(it,st,ot){return this.tweenTo(st,_setDefaults({startAt:{time:_parsePosition(this,it)}},ot))},et.recent=function(){return this._recent},et.nextLabel=function(it){return it===void 0&&(it=this._time),_getLabelInDirection(this,_parsePosition(this,it))},et.previousLabel=function(it){return it===void 0&&(it=this._time),_getLabelInDirection(this,_parsePosition(this,it),1)},et.currentLabel=function(it){return arguments.length?this.seek(it,!0):this.previousLabel(this._time+_tinyNum)},et.shiftChildren=function(it,st,ot){ot===void 0&&(ot=0);for(var at=this._first,lt=this.labels,ct;at;)at._start>=ot&&(at._start+=it,at._end+=it),at=at._next;if(st)for(ct in lt)lt[ct]>=ot&&(lt[ct]+=it);return _uncache(this)},et.invalidate=function(it){var st=this._first;for(this._lock=0;st;)st.invalidate(it),st=st._next;return nt.prototype.invalidate.call(this,it)},et.clear=function(it){it===void 0&&(it=!0);for(var st=this._first,ot;st;)ot=st._next,this.remove(st),st=ot;return this._dp&&(this._time=this._tTime=this._pTime=0),it&&(this.labels={}),_uncache(this)},et.totalDuration=function(it){var st=0,ot=this,at=ot._last,lt=_bigNum$1,ct,ut,ht;if(arguments.length)return ot.timeScale((ot._repeat<0?ot.duration():ot.totalDuration())/(ot.reversed()?-it:it));if(ot._dirty){for(ht=ot.parent;at;)ct=at._prev,at._dirty&&at.totalDuration(),ut=at._start,ut>lt&&ot._sort&&at._ts&&!ot._lock?(ot._lock=1,_addToTimeline(ot,at,ut-at._delay,1)._lock=0):lt=ut,ut<0&&at._ts&&(st-=ut,(!ht&&!ot._dp||ht&&ht.smoothChildTiming)&&(ot._start+=ut/ot._ts,ot._time-=ut,ot._tTime-=ut),ot.shiftChildren(-ut,!1,-1/0),lt=0),at._end>st&&at._ts&&(st=at._end),at=ct;_setDuration(ot,ot===_globalTimeline&&ot._time>st?ot._time:st,1,1),ot._dirty=0}return ot._tDur},_e.updateRoot=function(it){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(it,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var st=_globalTimeline._first;if((!st||!st._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;st&&!st._ts;)st=st._next;st||_ticker.sleep()}}},_e}(Animation$1);_setDefaults(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function(_e,et,rt,it,st,ot,at){var lt=new PropTween(this._pt,_e,et,0,1,_renderComplexString,null,st),ct=0,ut=0,ht,dt,ft,pt,mt,At,gt,bt;for(lt.b=rt,lt.e=it,rt+="",it+="",(gt=~it.indexOf("random("))&&(it=_replaceRandom(it)),ot&&(bt=[rt,it],ot(bt,_e,et),rt=bt[0],it=bt[1]),dt=rt.match(_complexStringNumExp)||[];ht=_complexStringNumExp.exec(it);)pt=ht[0],mt=it.substring(ct,ht.index),ft?ft=(ft+1)%5:mt.substr(-5)==="rgba("&&(ft=1),pt!==dt[ut++]&&(At=parseFloat(dt[ut-1])||0,lt._pt={_next:lt._pt,p:mt||ut===1?mt:",",s:At,c:pt.charAt(1)==="="?_parseRelative(At,pt)-At:parseFloat(pt)-At,m:ft&&ft<4?Math.round:0},ct=_complexStringNumExp.lastIndex);return lt.c=ct<it.length?it.substring(ct,it.length):"",lt.fp=at,(_relExp.test(it)||gt)&&(lt.e=0),this._pt=lt,lt},_addPropTween=function(_e,et,rt,it,st,ot,at,lt,ct,ut){_isFunction(it)&&(it=it(st||0,_e,ot));var ht=_e[et],dt=rt!=="get"?rt:_isFunction(ht)?ct?_e[et.indexOf("set")||!_isFunction(_e["get"+et.substr(3)])?et:"get"+et.substr(3)](ct):_e[et]():ht,ft=_isFunction(ht)?ct?_setterFuncWithParam:_setterFunc:_setterPlain,pt;if(_isString(it)&&(~it.indexOf("random(")&&(it=_replaceRandom(it)),it.charAt(1)==="="&&(pt=_parseRelative(dt,it)+(getUnit(dt)||0),(pt||pt===0)&&(it=pt))),!ut||dt!==it||_forceAllPropTweens)return!isNaN(dt*it)&&it!==""?(pt=new PropTween(this._pt,_e,et,+dt||0,it-(dt||0),typeof ht=="boolean"?_renderBoolean:_renderPlain,0,ft),ct&&(pt.fp=ct),at&&pt.modifier(at,this,_e),this._pt=pt):(!ht&&!(et in _e)&&_missingPlugin(et,it),_addComplexStringPropTween.call(this,_e,et,dt,it,ft,lt||_config.stringFilter,ct))},_processVars=function(_e,et,rt,it,st){if(_isFunction(_e)&&(_e=_parseFuncOrString(_e,st,et,rt,it)),!_isObject(_e)||_e.style&&_e.nodeType||_isArray(_e)||_isTypedArray(_e))return _isString(_e)?_parseFuncOrString(_e,st,et,rt,it):_e;var ot={},at;for(at in _e)ot[at]=_parseFuncOrString(_e[at],st,et,rt,it);return ot},_checkPlugin=function(_e,et,rt,it,st,ot){var at,lt,ct,ut;if(_plugins[_e]&&(at=new _plugins[_e]).init(st,at.rawVars?et[_e]:_processVars(et[_e],it,st,ot,rt),rt,it,ot)!==!1&&(rt._pt=lt=new PropTween(rt._pt,st,_e,0,1,at.render,at,0,at.priority),rt!==_quickTween))for(ct=rt._ptLookup[rt._targets.indexOf(st)],ut=at._props.length;ut--;)ct[at._props[ut]]=lt;return at},_overwritingTween,_forceAllPropTweens,_initTween=function nt(_e,et,rt){var it=_e.vars,st=it.ease,ot=it.startAt,at=it.immediateRender,lt=it.lazy,ct=it.onUpdate,ut=it.runBackwards,ht=it.yoyoEase,dt=it.keyframes,ft=it.autoRevert,pt=_e._dur,mt=_e._startAt,At=_e._targets,gt=_e.parent,bt=gt&&gt.data==="nested"?gt.vars.targets:At,Tt=_e._overwrite==="auto"&&!_suppressOverwrites,wt=_e.timeline,Rt,It,Lt,$t,kt,Dt,Ot,zt,Ht,Yt,Xt,Zt,rn;if(wt&&(!dt||!st)&&(st="none"),_e._ease=_parseEase(st,_defaults.ease),_e._yEase=ht?_invertEase(_parseEase(ht===!0?st:ht,_defaults.ease)):0,ht&&_e._yoyo&&!_e._repeat&&(ht=_e._yEase,_e._yEase=_e._ease,_e._ease=ht),_e._from=!wt&&!!it.runBackwards,!wt||dt&&!it.stagger){if(zt=At[0]?_getCache(At[0]).harness:0,Zt=zt&&it[zt.prop],Rt=_copyExcluding(it,_reservedProps),mt&&(mt._zTime<0&&mt.progress(1),et<0&&ut&&at&&!ft?mt.render(-1,!0):mt.revert(ut&&pt?_revertConfigNoKill:_startAtRevertConfig),mt._lazy=0),ot){if(_removeFromParent(_e._startAt=Tween$1.set(At,_setDefaults({data:"isStart",overwrite:!1,parent:gt,immediateRender:!0,lazy:!mt&&_isNotFalse(lt),startAt:null,delay:0,onUpdate:ct&&function(){return _callback(_e,"onUpdate")},stagger:0},ot))),_e._startAt._dp=0,_e._startAt._sat=_e,et<0&&(_reverting$1||!at&&!ft)&&_e._startAt.revert(_revertConfigNoKill),at&&pt&&et<=0&&rt<=0){et&&(_e._zTime=et);return}}else if(ut&&pt&&!mt){if(et&&(at=!1),Lt=_setDefaults({overwrite:!1,data:"isFromStart",lazy:at&&!mt&&_isNotFalse(lt),immediateRender:at,stagger:0,parent:gt},Rt),Zt&&(Lt[zt.prop]=Zt),_removeFromParent(_e._startAt=Tween$1.set(At,Lt)),_e._startAt._dp=0,_e._startAt._sat=_e,et<0&&(_reverting$1?_e._startAt.revert(_revertConfigNoKill):_e._startAt.render(-1,!0)),_e._zTime=et,!at)nt(_e._startAt,_tinyNum,_tinyNum);else if(!et)return}for(_e._pt=_e._ptCache=0,lt=pt&&_isNotFalse(lt)||lt&&!pt,It=0;It<At.length;It++){if(kt=At[It],Ot=kt._gsap||_harness(At)[It]._gsap,_e._ptLookup[It]=Yt={},_lazyLookup[Ot.id]&&_lazyTweens.length&&_lazyRender(),Xt=bt===At?It:bt.indexOf(kt),zt&&(Ht=new zt).init(kt,Zt||Rt,_e,Xt,bt)!==!1&&(_e._pt=$t=new PropTween(_e._pt,kt,Ht.name,0,1,Ht.render,Ht,0,Ht.priority),Ht._props.forEach(function(Gt){Yt[Gt]=$t}),Ht.priority&&(Dt=1)),!zt||Zt)for(Lt in Rt)_plugins[Lt]&&(Ht=_checkPlugin(Lt,Rt,_e,Xt,kt,bt))?Ht.priority&&(Dt=1):Yt[Lt]=$t=_addPropTween.call(_e,kt,Lt,"get",Rt[Lt],Xt,bt,0,it.stringFilter);_e._op&&_e._op[It]&&_e.kill(kt,_e._op[It]),Tt&&_e._pt&&(_overwritingTween=_e,_globalTimeline.killTweensOf(kt,Yt,_e.globalTime(et)),rn=!_e.parent,_overwritingTween=0),_e._pt&&lt&&(_lazyLookup[Ot.id]=1)}Dt&&_sortPropTweensByPriority(_e),_e._onInit&&_e._onInit(_e)}_e._onUpdate=ct,_e._initted=(!_e._op||_e._pt)&&!rn,dt&&et<=0&&wt.render(_bigNum$1,!0,!0)},_updatePropTweens=function(_e,et,rt,it,st,ot,at,lt){var ct=(_e._pt&&_e._ptCache||(_e._ptCache={}))[et],ut,ht,dt,ft;if(!ct)for(ct=_e._ptCache[et]=[],dt=_e._ptLookup,ft=_e._targets.length;ft--;){if(ut=dt[ft][et],ut&&ut.d&&ut.d._pt)for(ut=ut.d._pt;ut&&ut.p!==et&&ut.fp!==et;)ut=ut._next;if(!ut)return _forceAllPropTweens=1,_e.vars[et]="+=0",_initTween(_e,at),_forceAllPropTweens=0,lt?_warn(et+" not eligible for reset"):1;ct.push(ut)}for(ft=ct.length;ft--;)ht=ct[ft],ut=ht._pt||ht,ut.s=(it||it===0)&&!st?it:ut.s+(it||0)+ot*ut.c,ut.c=rt-ut.s,ht.e&&(ht.e=_round(rt)+getUnit(ht.e)),ht.b&&(ht.b=ut.s+getUnit(ht.b))},_addAliasesToVars=function(_e,et){var rt=_e[0]?_getCache(_e[0]).harness:0,it=rt&&rt.aliases,st,ot,at,lt;if(!it)return et;st=_merge({},et);for(ot in it)if(ot in st)for(lt=it[ot].split(","),at=lt.length;at--;)st[lt[at]]=st[ot];return st},_parseKeyframe=function(_e,et,rt,it){var st=et.ease||it||"power1.inOut",ot,at;if(_isArray(et))at=rt[_e]||(rt[_e]=[]),et.forEach(function(lt,ct){return at.push({t:ct/(et.length-1)*100,v:lt,e:st})});else for(ot in et)at=rt[ot]||(rt[ot]=[]),ot==="ease"||at.push({t:parseFloat(_e),v:et[ot],e:st})},_parseFuncOrString=function(_e,et,rt,it,st){return _isFunction(_e)?_e.call(et,rt,it,st):_isString(_e)&&~_e.indexOf("random(")?_replaceRandom(_e):_e},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(nt){return _staggerPropsToSkip[nt]=1});var Tween$1=function(nt){_inheritsLoose$1(_e,nt);function _e(rt,it,st,ot){var at;typeof it=="number"&&(st.duration=it,it=st,st=null),at=nt.call(this,ot?it:_inheritDefaults(it))||this;var lt=at.vars,ct=lt.duration,ut=lt.delay,ht=lt.immediateRender,dt=lt.stagger,ft=lt.overwrite,pt=lt.keyframes,mt=lt.defaults,At=lt.scrollTrigger,gt=lt.yoyoEase,bt=it.parent||_globalTimeline,Tt=(_isArray(rt)||_isTypedArray(rt)?_isNumber(rt[0]):"length"in it)?[rt]:toArray(rt),wt,Rt,It,Lt,$t,kt,Dt,Ot;if(at._targets=Tt.length?_harness(Tt):_warn("GSAP target "+rt+" not found. https://gsap.com",!_config.nullTargetWarn)||[],at._ptLookup=[],at._overwrite=ft,pt||dt||_isFuncOrString(ct)||_isFuncOrString(ut)){if(it=at.vars,wt=at.timeline=new Timeline({data:"nested",defaults:mt||{},targets:bt&&bt.data==="nested"?bt.vars.targets:Tt}),wt.kill(),wt.parent=wt._dp=_assertThisInitialized$4(at),wt._start=0,dt||_isFuncOrString(ct)||_isFuncOrString(ut)){if(Lt=Tt.length,Dt=dt&&distribute(dt),_isObject(dt))for($t in dt)~_staggerTweenProps.indexOf($t)&&(Ot||(Ot={}),Ot[$t]=dt[$t]);for(Rt=0;Rt<Lt;Rt++)It=_copyExcluding(it,_staggerPropsToSkip),It.stagger=0,gt&&(It.yoyoEase=gt),Ot&&_merge(It,Ot),kt=Tt[Rt],It.duration=+_parseFuncOrString(ct,_assertThisInitialized$4(at),Rt,kt,Tt),It.delay=(+_parseFuncOrString(ut,_assertThisInitialized$4(at),Rt,kt,Tt)||0)-at._delay,!dt&&Lt===1&&It.delay&&(at._delay=ut=It.delay,at._start+=ut,It.delay=0),wt.to(kt,It,Dt?Dt(Rt,kt,Tt):0),wt._ease=_easeMap.none;wt.duration()?ct=ut=0:at.timeline=0}else if(pt){_inheritDefaults(_setDefaults(wt.vars.defaults,{ease:"none"})),wt._ease=_parseEase(pt.ease||it.ease||"none");var zt=0,Ht,Yt,Xt;if(_isArray(pt))pt.forEach(function(Zt){return wt.to(Tt,Zt,">")}),wt.duration();else{It={};for($t in pt)$t==="ease"||$t==="easeEach"||_parseKeyframe($t,pt[$t],It,pt.easeEach);for($t in It)for(Ht=It[$t].sort(function(Zt,rn){return Zt.t-rn.t}),zt=0,Rt=0;Rt<Ht.length;Rt++)Yt=Ht[Rt],Xt={ease:Yt.e,duration:(Yt.t-(Rt?Ht[Rt-1].t:0))/100*ct},Xt[$t]=Yt.v,wt.to(Tt,Xt,zt),zt+=Xt.duration;wt.duration()<ct&&wt.to({},{duration:ct-wt.duration()})}}ct||at.duration(ct=wt.duration())}else at.timeline=0;return ft===!0&&!_suppressOverwrites&&(_overwritingTween=_assertThisInitialized$4(at),_globalTimeline.killTweensOf(Tt),_overwritingTween=0),_addToTimeline(bt,_assertThisInitialized$4(at),st),it.reversed&&at.reverse(),it.paused&&at.paused(!0),(ht||!ct&&!pt&&at._start===_roundPrecise(bt._time)&&_isNotFalse(ht)&&_hasNoPausedAncestors(_assertThisInitialized$4(at))&&bt.data!=="nested")&&(at._tTime=-_tinyNum,at.render(Math.max(0,-ut)||0)),At&&_scrollTrigger(_assertThisInitialized$4(at),At),at}var et=_e.prototype;return et.render=function(it,st,ot){var at=this._time,lt=this._tDur,ct=this._dur,ut=it<0,ht=it>lt-_tinyNum&&!ut?lt:it<_tinyNum?0:it,dt,ft,pt,mt,At,gt,bt,Tt,wt;if(!ct)_renderZeroDurationTween(this,it,st,ot);else if(ht!==this._tTime||!it||ot||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==ut){if(dt=ht,Tt=this.timeline,this._repeat){if(mt=ct+this._rDelay,this._repeat<-1&&ut)return this.totalTime(mt*100+it,st,ot);if(dt=_roundPrecise(ht%mt),ht===lt?(pt=this._repeat,dt=ct):(pt=~~(ht/mt),pt&&pt===_roundPrecise(ht/mt)&&(dt=ct,pt--),dt>ct&&(dt=ct)),gt=this._yoyo&&pt&1,gt&&(wt=this._yEase,dt=ct-dt),At=_animationCycle(this._tTime,mt),dt===at&&!ot&&this._initted&&pt===At)return this._tTime=ht,this;pt!==At&&(Tt&&this._yEase&&_propagateYoyoEase(Tt,gt),this.vars.repeatRefresh&&!gt&&!this._lock&&this._time!==mt&&this._initted&&(this._lock=ot=1,this.render(_roundPrecise(mt*pt),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,ut?it:dt,ot,st,ht))return this._tTime=0,this;if(at!==this._time&&!(ot&&this.vars.repeatRefresh&&pt!==At))return this;if(ct!==this._dur)return this.render(it,st,ot)}if(this._tTime=ht,this._time=dt,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=bt=(wt||this._ease)(dt/ct),this._from&&(this.ratio=bt=1-bt),dt&&!at&&!st&&!pt&&(_callback(this,"onStart"),this._tTime!==ht))return this;for(ft=this._pt;ft;)ft.r(bt,ft.d),ft=ft._next;Tt&&Tt.render(it<0?it:Tt._dur*Tt._ease(dt/this._dur),st,ot)||this._startAt&&(this._zTime=it),this._onUpdate&&!st&&(ut&&_rewindStartAt(this,it,st,ot),_callback(this,"onUpdate")),this._repeat&&pt!==At&&this.vars.onRepeat&&!st&&this.parent&&_callback(this,"onRepeat"),(ht===this._tDur||!ht)&&this._tTime===ht&&(ut&&!this._onUpdate&&_rewindStartAt(this,it,!0,!0),(it||!ct)&&(ht===this._tDur&&this._ts>0||!ht&&this._ts<0)&&_removeFromParent(this,1),!st&&!(ut&&!at)&&(ht||at||gt)&&(_callback(this,ht===lt?"onComplete":"onReverseComplete",!0),this._prom&&!(ht<lt&&this.timeScale()>0)&&this._prom()))}return this},et.targets=function(){return this._targets},et.invalidate=function(it){return(!it||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(it),nt.prototype.invalidate.call(this,it)},et.resetTo=function(it,st,ot,at,lt){_tickerActive||_ticker.wake(),this._ts||this.play();var ct=Math.min(this._dur,(this._dp._time-this._start)*this._ts),ut;return this._initted||_initTween(this,ct),ut=this._ease(ct/this._dur),_updatePropTweens(this,it,st,ot,at,ut,ct,lt)?this.resetTo(it,st,ot,at,1):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},et.kill=function(it,st){if(st===void 0&&(st="all"),!it&&(!st||st==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this;if(this.timeline){var ot=this.timeline.totalDuration();return this.timeline.killTweensOf(it,st,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&ot!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/ot,0,1),this}var at=this._targets,lt=it?toArray(it):at,ct=this._ptLookup,ut=this._pt,ht,dt,ft,pt,mt,At,gt;if((!st||st==="all")&&_arraysMatch(at,lt))return st==="all"&&(this._pt=0),_interrupt(this);for(ht=this._op=this._op||[],st!=="all"&&(_isString(st)&&(mt={},_forEachName(st,function(bt){return mt[bt]=1}),st=mt),st=_addAliasesToVars(at,st)),gt=at.length;gt--;)if(~lt.indexOf(at[gt])){dt=ct[gt],st==="all"?(ht[gt]=st,pt=dt,ft={}):(ft=ht[gt]=ht[gt]||{},pt=st);for(mt in pt)At=dt&&dt[mt],At&&((!("kill"in At.d)||At.d.kill(mt)===!0)&&_removeLinkedListItem(this,At,"_pt"),delete dt[mt]),ft!=="all"&&(ft[mt]=1)}return this._initted&&!this._pt&&ut&&_interrupt(this),this},_e.to=function(it,st){return new _e(it,st,arguments[2])},_e.from=function(it,st){return _createTweenType(1,arguments)},_e.delayedCall=function(it,st,ot,at){return new _e(st,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:it,onComplete:st,onReverseComplete:st,onCompleteParams:ot,onReverseCompleteParams:ot,callbackScope:at})},_e.fromTo=function(it,st,ot){return _createTweenType(2,arguments)},_e.set=function(it,st){return st.duration=0,st.repeatDelay||(st.repeat=0),new _e(it,st)},_e.killTweensOf=function(it,st,ot){return _globalTimeline.killTweensOf(it,st,ot)},_e}(Animation$1);_setDefaults(Tween$1.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(nt){Tween$1[nt]=function(){var _e=new Timeline,et=_slice.call(arguments,0);return et.splice(nt==="staggerFromTo"?5:4,0,0),_e[nt].apply(_e,et)}});var _setterPlain=function(_e,et,rt){return _e[et]=rt},_setterFunc=function(_e,et,rt){return _e[et](rt)},_setterFuncWithParam=function(_e,et,rt,it){return _e[et](it.fp,rt)},_setterAttribute=function(_e,et,rt){return _e.setAttribute(et,rt)},_getSetter=function(_e,et){return _isFunction(_e[et])?_setterFunc:_isUndefined(_e[et])&&_e.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function(_e,et){return et.set(et.t,et.p,Math.round((et.s+et.c*_e)*1e6)/1e6,et)},_renderBoolean=function(_e,et){return et.set(et.t,et.p,!!(et.s+et.c*_e),et)},_renderComplexString=function(_e,et){var rt=et._pt,it="";if(!_e&&et.b)it=et.b;else if(_e===1&&et.e)it=et.e;else{for(;rt;)it=rt.p+(rt.m?rt.m(rt.s+rt.c*_e):Math.round((rt.s+rt.c*_e)*1e4)/1e4)+it,rt=rt._next;it+=et.c}et.set(et.t,et.p,it,et)},_renderPropTweens=function(_e,et){for(var rt=et._pt;rt;)rt.r(_e,rt.d),rt=rt._next},_addPluginModifier=function(_e,et,rt,it){for(var st=this._pt,ot;st;)ot=st._next,st.p===it&&st.modifier(_e,et,rt),st=ot},_killPropTweensOf=function(_e){for(var et=this._pt,rt,it;et;)it=et._next,et.p===_e&&!et.op||et.op===_e?_removeLinkedListItem(this,et,"_pt"):et.dep||(rt=1),et=it;return!rt},_setterWithModifier=function(_e,et,rt,it){it.mSet(_e,et,it.m.call(it.tween,rt,it.mt),it)},_sortPropTweensByPriority=function(_e){for(var et=_e._pt,rt,it,st,ot;et;){for(rt=et._next,it=st;it&&it.pr>et.pr;)it=it._next;(et._prev=it?it._prev:ot)?et._prev._next=et:st=et,(et._next=it)?it._prev=et:ot=et,et=rt}_e._pt=st},PropTween=function(){function nt(et,rt,it,st,ot,at,lt,ct,ut){this.t=rt,this.s=st,this.c=ot,this.p=it,this.r=at||_renderPlain,this.d=lt||this,this.set=ct||_setterPlain,this.pr=ut||0,this._next=et,et&&(et._prev=this)}var _e=nt.prototype;return _e.modifier=function(rt,it,st){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=rt,this.mt=st,this.tween=it},nt}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(nt){return _reservedProps[nt]=1});_globals.TweenMax=_globals.TweenLite=Tween$1;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners={},_emptyArray=[],_lastMediaTime=0,_contextID=0,_dispatch=function(_e){return(_listeners[_e]||_emptyArray).map(function(et){return et()})},_onMediaChange=function(){var _e=Date.now(),et=[];_e-_lastMediaTime>2&&(_dispatch("matchMediaInit"),_media.forEach(function(rt){var it=rt.queries,st=rt.conditions,ot,at,lt,ct;for(at in it)ot=_win$1.matchMedia(it[at]).matches,ot&&(lt=1),ot!==st[at]&&(st[at]=ot,ct=1);ct&&(rt.revert(),lt&&et.push(rt))}),_dispatch("matchMediaRevert"),et.forEach(function(rt){return rt.onMatch(rt,function(it){return rt.add(null,it)})}),_lastMediaTime=_e,_dispatch("matchMedia"))},Context=function(){function nt(et,rt){this.selector=rt&&selector(rt),this.data=[],this._r=[],this.isReverted=!1,this.id=_contextID++,et&&this.add(et)}var _e=nt.prototype;return _e.add=function(rt,it,st){_isFunction(rt)&&(st=it,it=rt,rt=_isFunction);var ot=this,at=function(){var ct=_context,ut=ot.selector,ht;return ct&&ct!==ot&&ct.data.push(ot),st&&(ot.selector=selector(st)),_context=ot,ht=it.apply(ot,arguments),_isFunction(ht)&&ot._r.push(ht),_context=ct,ot.selector=ut,ot.isReverted=!1,ht};return ot.last=at,rt===_isFunction?at(ot,function(lt){return ot.add(null,lt)}):rt?ot[rt]=at:at},_e.ignore=function(rt){var it=_context;_context=null,rt(this),_context=it},_e.getTweens=function(){var rt=[];return this.data.forEach(function(it){return it instanceof nt?rt.push.apply(rt,it.getTweens()):it instanceof Tween$1&&!(it.parent&&it.parent.data==="nested")&&rt.push(it)}),rt},_e.clear=function(){this._r.length=this.data.length=0},_e.kill=function(rt,it){var st=this;if(rt?function(){for(var at=st.getTweens(),lt=st.data.length,ct;lt--;)ct=st.data[lt],ct.data==="isFlip"&&(ct.revert(),ct.getChildren(!0,!0,!1).forEach(function(ut){return at.splice(at.indexOf(ut),1)}));for(at.map(function(ut){return{g:ut._dur||ut._delay||ut._sat&&!ut._sat.vars.immediateRender?ut.globalTime(0):-1/0,t:ut}}).sort(function(ut,ht){return ht.g-ut.g||-1/0}).forEach(function(ut){return ut.t.revert(rt)}),lt=st.data.length;lt--;)ct=st.data[lt],ct instanceof Timeline?ct.data!=="nested"&&(ct.scrollTrigger&&ct.scrollTrigger.revert(),ct.kill()):!(ct instanceof Tween$1)&&ct.revert&&ct.revert(rt);st._r.forEach(function(ut){return ut(rt,st)}),st.isReverted=!0}():this.data.forEach(function(at){return at.kill&&at.kill()}),this.clear(),it)for(var ot=_media.length;ot--;)_media[ot].id===this.id&&_media.splice(ot,1)},_e.revert=function(rt){this.kill(rt||{})},nt}(),MatchMedia=function(){function nt(et){this.contexts=[],this.scope=et,_context&&_context.data.push(this)}var _e=nt.prototype;return _e.add=function(rt,it,st){_isObject(rt)||(rt={matches:rt});var ot=new Context(0,st||this.scope),at=ot.conditions={},lt,ct,ut;_context&&!ot.selector&&(ot.selector=_context.selector),this.contexts.push(ot),it=ot.add("onMatch",it),ot.queries=rt;for(ct in rt)ct==="all"?ut=1:(lt=_win$1.matchMedia(rt[ct]),lt&&(_media.indexOf(ot)<0&&_media.push(ot),(at[ct]=lt.matches)&&(ut=1),lt.addListener?lt.addListener(_onMediaChange):lt.addEventListener("change",_onMediaChange)));return ut&&it(ot,function(ht){return ot.add(null,ht)}),this},_e.revert=function(rt){this.kill(rt||{})},_e.kill=function(rt){this.contexts.forEach(function(it){return it.kill(rt,!0)})},nt}(),_gsap$1={registerPlugin:function(){for(var _e=arguments.length,et=new Array(_e),rt=0;rt<_e;rt++)et[rt]=arguments[rt];et.forEach(function(it){return _createPlugin(it)})},timeline:function(_e){return new Timeline(_e)},getTweensOf:function(_e,et){return _globalTimeline.getTweensOf(_e,et)},getProperty:function(_e,et,rt,it){_isString(_e)&&(_e=toArray(_e)[0]);var st=_getCache(_e||{}).get,ot=rt?_passThrough:_numericIfPossible;return rt==="native"&&(rt=""),_e&&(et?ot((_plugins[et]&&_plugins[et].get||st)(_e,et,rt,it)):function(at,lt,ct){return ot((_plugins[at]&&_plugins[at].get||st)(_e,at,lt,ct))})},quickSetter:function(_e,et,rt){if(_e=toArray(_e),_e.length>1){var it=_e.map(function(ut){return gsap.quickSetter(ut,et,rt)}),st=it.length;return function(ut){for(var ht=st;ht--;)it[ht](ut)}}_e=_e[0]||{};var ot=_plugins[et],at=_getCache(_e),lt=at.harness&&(at.harness.aliases||{})[et]||et,ct=ot?function(ut){var ht=new ot;_quickTween._pt=0,ht.init(_e,rt?ut+rt:ut,_quickTween,0,[_e]),ht.render(1,ht),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:at.set(_e,lt);return ot?ct:function(ut){return ct(_e,lt,rt?ut+rt:ut,at,1)}},quickTo:function(_e,et,rt){var it,st=gsap.to(_e,_merge((it={},it[et]="+=0.1",it.paused=!0,it),rt||{})),ot=function(lt,ct,ut){return st.resetTo(et,lt,ct,ut)};return ot.tween=st,ot},isTweening:function(_e){return _globalTimeline.getTweensOf(_e,!0).length>0},defaults:function(_e){return _e&&_e.ease&&(_e.ease=_parseEase(_e.ease,_defaults.ease)),_mergeDeep(_defaults,_e||{})},config:function(_e){return _mergeDeep(_config,_e||{})},registerEffect:function(_e){var et=_e.name,rt=_e.effect,it=_e.plugins,st=_e.defaults,ot=_e.extendTimeline;(it||"").split(",").forEach(function(at){return at&&!_plugins[at]&&!_globals[at]&&_warn(et+" effect requires "+at+" plugin.")}),_effects[et]=function(at,lt,ct){return rt(toArray(at),_setDefaults(lt||{},st),ct)},ot&&(Timeline.prototype[et]=function(at,lt,ct){return this.add(_effects[et](at,_isObject(lt)?lt:(ct=lt)&&{},this),ct)})},registerEase:function(_e,et){_easeMap[_e]=_parseEase(et)},parseEase:function(_e,et){return arguments.length?_parseEase(_e,et):_easeMap},getById:function(_e){return _globalTimeline.getById(_e)},exportRoot:function(_e,et){_e===void 0&&(_e={});var rt=new Timeline(_e),it,st;for(rt.smoothChildTiming=_isNotFalse(_e.smoothChildTiming),_globalTimeline.remove(rt),rt._dp=0,rt._time=rt._tTime=_globalTimeline._time,it=_globalTimeline._first;it;)st=it._next,(et||!(!it._dur&&it instanceof Tween$1&&it.vars.onComplete===it._targets[0]))&&_addToTimeline(rt,it,it._start-it._delay),it=st;return _addToTimeline(_globalTimeline,rt,0),rt},context:function(_e,et){return _e?new Context(_e,et):_context},matchMedia:function(_e){return new MatchMedia(_e)},matchMediaRefresh:function(){return _media.forEach(function(_e){var et=_e.conditions,rt,it;for(it in et)et[it]&&(et[it]=!1,rt=1);rt&&_e.revert()})||_onMediaChange()},addEventListener:function(_e,et){var rt=_listeners[_e]||(_listeners[_e]=[]);~rt.indexOf(et)||rt.push(et)},removeEventListener:function(_e,et){var rt=_listeners[_e],it=rt&&rt.indexOf(et);it>=0&&rt.splice(it,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize:normalize$3,getUnit,clamp:clamp$3,splitColor:splitColor$1,toArray,selector,mapRange,pipe:pipe$1,unitize,interpolate:interpolate$2,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween:Tween$1,Timeline,Animation:Animation$1,getCache:_getCache,_removeLinkedListItem,reverting:function(){return _reverting$1},context:function(_e){return _e&&_context&&(_context.data.push(_e),_e._ctx=_context),_context},suppressOverwrites:function(_e){return _suppressOverwrites=_e}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(nt){return _gsap$1[nt]=Tween$1[nt]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap$1.to({},{duration:0});var _getPluginPropTween=function(_e,et){for(var rt=_e._pt;rt&&rt.p!==et&&rt.op!==et&&rt.fp!==et;)rt=rt._next;return rt},_addModifiers=function(_e,et){var rt=_e._targets,it,st,ot;for(it in et)for(st=rt.length;st--;)ot=_e._ptLookup[st][it],ot&&(ot=ot.d)&&(ot._pt&&(ot=_getPluginPropTween(ot,it)),ot&&ot.modifier&&ot.modifier(et[it],_e,rt[st],it))},_buildModifierPlugin=function(_e,et){return{name:_e,rawVars:1,init:function(it,st,ot){ot._onInit=function(at){var lt,ct;if(_isString(st)&&(lt={},_forEachName(st,function(ut){return lt[ut]=1}),st=lt),et){lt={};for(ct in st)lt[ct]=et(st[ct]);st=lt}_addModifiers(at,st)}}}},gsap=_gsap$1.registerPlugin({name:"attr",init:function(_e,et,rt,it,st){var ot,at,lt;this.tween=rt;for(ot in et)lt=_e.getAttribute(ot)||"",at=this.add(_e,"setAttribute",(lt||0)+"",et[ot],it,st,0,0,ot),at.op=ot,at.b=lt,this._props.push(ot)},render:function(_e,et){for(var rt=et._pt;rt;)_reverting$1?rt.set(rt.t,rt.p,rt.b,rt):rt.r(_e,rt.d),rt=rt._next}},{name:"endArray",init:function(_e,et){for(var rt=et.length;rt--;)this.add(_e,rt,_e[rt]||0,et[rt],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap$1;Tween$1.version=Timeline.version=gsap.version="3.12.5";_coreReady=1;_windowExists$1()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _win,_doc,_docElement,_pluginInitted,_tempDiv,_recentSetterPlugin,_reverting,_windowExists=function(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function(_e,et){return et.set(et.t,et.p,Math.round((et.s+et.c*_e)*1e4)/1e4+et.u,et)},_renderPropWithEnd=function(_e,et){return et.set(et.t,et.p,_e===1?et.e:Math.round((et.s+et.c*_e)*1e4)/1e4+et.u,et)},_renderCSSPropWithBeginning=function(_e,et){return et.set(et.t,et.p,_e?Math.round((et.s+et.c*_e)*1e4)/1e4+et.u:et.b,et)},_renderRoundedCSSProp=function(_e,et){var rt=et.s+et.c*_e;et.set(et.t,et.p,~~(rt+(rt<0?-.5:.5))+et.u,et)},_renderNonTweeningValue=function(_e,et){return et.set(et.t,et.p,_e?et.e:et.b,et)},_renderNonTweeningValueOnlyAtEnd=function(_e,et){return et.set(et.t,et.p,_e!==1?et.b:et.e,et)},_setterCSSStyle=function(_e,et,rt){return _e.style[et]=rt},_setterCSSProp=function(_e,et,rt){return _e.style.setProperty(et,rt)},_setterTransform=function(_e,et,rt){return _e._gsap[et]=rt},_setterScale=function(_e,et,rt){return _e._gsap.scaleX=_e._gsap.scaleY=rt},_setterScaleWithRender=function(_e,et,rt,it,st){var ot=_e._gsap;ot.scaleX=ot.scaleY=rt,ot.renderTransform(st,ot)},_setterTransformWithRender=function(_e,et,rt,it,st){var ot=_e._gsap;ot[et]=rt,ot.renderTransform(st,ot)},_transformProp="transform",_transformOriginProp=_transformProp+"Origin",_saveStyle=function nt(_e,et){var rt=this,it=this.target,st=it.style,ot=it._gsap;if(_e in _transformProps&&st){if(this.tfm=this.tfm||{},_e!=="transform")_e=_propertyAliases[_e]||_e,~_e.indexOf(",")?_e.split(",").forEach(function(at){return rt.tfm[at]=_get(it,at)}):this.tfm[_e]=ot.x?ot[_e]:_get(it,_e),_e===_transformOriginProp&&(this.tfm.zOrigin=ot.zOrigin);else return _propertyAliases.transform.split(",").forEach(function(at){return nt.call(rt,at,et)});if(this.props.indexOf(_transformProp)>=0)return;ot.svg&&(this.svgo=it.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,et,"")),_e=_transformProp}(st||et)&&this.props.push(_e,et,st[_e])},_removeIndependentTransforms=function(_e){_e.translate&&(_e.removeProperty("translate"),_e.removeProperty("scale"),_e.removeProperty("rotate"))},_revertStyle=function(){var _e=this.props,et=this.target,rt=et.style,it=et._gsap,st,ot;for(st=0;st<_e.length;st+=3)_e[st+1]?et[_e[st]]=_e[st+2]:_e[st+2]?rt[_e[st]]=_e[st+2]:rt.removeProperty(_e[st].substr(0,2)==="--"?_e[st]:_e[st].replace(_capsExp,"-$1").toLowerCase());if(this.tfm){for(ot in this.tfm)it[ot]=this.tfm[ot];it.svg&&(it.renderTransform(),et.setAttribute("data-svg-origin",this.svgo||"")),st=_reverting(),(!st||!st.isStart)&&!rt[_transformProp]&&(_removeIndependentTransforms(rt),it.zOrigin&&rt[_transformOriginProp]&&(rt[_transformOriginProp]+=" "+it.zOrigin+"px",it.zOrigin=0,it.renderTransform()),it.uncache=1)}},_getStyleSaver=function(_e,et){var rt={target:_e,props:[],revert:_revertStyle,save:_saveStyle};return _e._gsap||gsap.core.getCache(_e),et&&et.split(",").forEach(function(it){return rt.save(it)}),rt},_supports3D,_createElement=function(_e,et){var rt=_doc.createElementNS?_doc.createElementNS((et||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),_e):_doc.createElement(_e);return rt&&rt.style?rt:_doc.createElement(_e)},_getComputedProperty=function nt(_e,et,rt){var it=getComputedStyle(_e);return it[et]||it.getPropertyValue(et.replace(_capsExp,"-$1").toLowerCase())||it.getPropertyValue(et)||!rt&&nt(_e,_checkPropPrefix(et)||et,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function(_e,et,rt){var it=et||_tempDiv,st=it.style,ot=5;if(_e in st&&!rt)return _e;for(_e=_e.charAt(0).toUpperCase()+_e.substr(1);ot--&&!(_prefixes[ot]+_e in st););return ot<0?null:(ot===3?"ms":ot>=0?_prefixes[ot]:"")+_e},_initCore=function(){_windowExists()&&window.document&&(_win=window,_doc=_win.document,_docElement=_doc.documentElement,_tempDiv=_createElement("div")||{style:{}},_createElement("div"),_transformProp=_checkPropPrefix(_transformProp),_transformOriginProp=_transformProp+"Origin",_tempDiv.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap.core.reverting,_pluginInitted=1)},_getBBoxHack=function nt(_e){var et=_createElement("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),rt=this.parentNode,it=this.nextSibling,st=this.style.cssText,ot;if(_docElement.appendChild(et),et.appendChild(this),this.style.display="block",_e)try{ot=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=nt}catch{}else this._gsapBBox&&(ot=this._gsapBBox());return rt&&(it?rt.insertBefore(this,it):rt.appendChild(this)),_docElement.removeChild(et),this.style.cssText=st,ot},_getAttributeFallbacks=function(_e,et){for(var rt=et.length;rt--;)if(_e.hasAttribute(et[rt]))return _e.getAttribute(et[rt])},_getBBox=function(_e){var et;try{et=_e.getBBox()}catch{et=_getBBoxHack.call(_e,!0)}return et&&(et.width||et.height)||_e.getBBox===_getBBoxHack||(et=_getBBoxHack.call(_e,!0)),et&&!et.width&&!et.x&&!et.y?{x:+_getAttributeFallbacks(_e,["x","cx","x1"])||0,y:+_getAttributeFallbacks(_e,["y","cy","y1"])||0,width:0,height:0}:et},_isSVG=function(_e){return!!(_e.getCTM&&(!_e.parentNode||_e.ownerSVGElement)&&_getBBox(_e))},_removeProperty=function(_e,et){if(et){var rt=_e.style,it;et in _transformProps&&et!==_transformOriginProp&&(et=_transformProp),rt.removeProperty?(it=et.substr(0,2),(it==="ms"||et.substr(0,6)==="webkit")&&(et="-"+et),rt.removeProperty(it==="--"?et:et.replace(_capsExp,"-$1").toLowerCase())):rt.removeAttribute(et)}},_addNonTweeningPT=function(_e,et,rt,it,st,ot){var at=new PropTween(_e._pt,et,rt,0,1,ot?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return _e._pt=at,at.b=it,at.e=st,_e._props.push(rt),at},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function nt(_e,et,rt,it){var st=parseFloat(rt)||0,ot=(rt+"").trim().substr((st+"").length)||"px",at=_tempDiv.style,lt=_horizontalExp.test(et),ct=_e.tagName.toLowerCase()==="svg",ut=(ct?"client":"offset")+(lt?"Width":"Height"),ht=100,dt=it==="px",ft=it==="%",pt,mt,At,gt;if(it===ot||!st||_nonConvertibleUnits[it]||_nonConvertibleUnits[ot])return st;if(ot!=="px"&&!dt&&(st=nt(_e,et,rt,"px")),gt=_e.getCTM&&_isSVG(_e),(ft||ot==="%")&&(_transformProps[et]||~et.indexOf("adius")))return pt=gt?_e.getBBox()[lt?"width":"height"]:_e[ut],_round(ft?st/pt*ht:st/100*pt);if(at[lt?"width":"height"]=ht+(dt?ot:it),mt=~et.indexOf("adius")||it==="em"&&_e.appendChild&&!ct?_e:_e.parentNode,gt&&(mt=(_e.ownerSVGElement||{}).parentNode),(!mt||mt===_doc||!mt.appendChild)&&(mt=_doc.body),At=mt._gsap,At&&ft&&At.width&&lt&&At.time===_ticker.time&&!At.uncache)return _round(st/At.width*ht);if(ft&&(et==="height"||et==="width")){var bt=_e.style[et];_e.style[et]=ht+it,pt=_e[ut],bt?_e.style[et]=bt:_removeProperty(_e,et)}else(ft||ot==="%")&&!_nonStandardLayouts[_getComputedProperty(mt,"display")]&&(at.position=_getComputedProperty(_e,"position")),mt===_e&&(at.position="static"),mt.appendChild(_tempDiv),pt=_tempDiv[ut],mt.removeChild(_tempDiv),at.position="absolute";return lt&&ft&&(At=_getCache(mt),At.time=_ticker.time,At.width=mt[ut]),_round(dt?pt*st/ht:pt&&st?ht/pt*st:0)},_get=function(_e,et,rt,it){var st;return _pluginInitted||_initCore(),et in _propertyAliases&&et!=="transform"&&(et=_propertyAliases[et],~et.indexOf(",")&&(et=et.split(",")[0])),_transformProps[et]&&et!=="transform"?(st=_parseTransform(_e,it),st=et!=="transformOrigin"?st[et]:st.svg?st.origin:_firstTwoOnly(_getComputedProperty(_e,_transformOriginProp))+" "+st.zOrigin+"px"):(st=_e.style[et],(!st||st==="auto"||it||~(st+"").indexOf("calc("))&&(st=_specialProps[et]&&_specialProps[et](_e,et,rt)||_getComputedProperty(_e,et)||_getProperty(_e,et)||(et==="opacity"?1:0))),rt&&!~(st+"").trim().indexOf(" ")?_convertToUnit(_e,et,st,rt)+rt:st},_tweenComplexCSSString=function(_e,et,rt,it){if(!rt||rt==="none"){var st=_checkPropPrefix(et,_e,1),ot=st&&_getComputedProperty(_e,st,1);ot&&ot!==rt?(et=st,rt=ot):et==="borderColor"&&(rt=_getComputedProperty(_e,"borderTopColor"))}var at=new PropTween(this._pt,_e.style,et,0,1,_renderComplexString),lt=0,ct=0,ut,ht,dt,ft,pt,mt,At,gt,bt,Tt,wt,Rt;if(at.b=rt,at.e=it,rt+="",it+="",it==="auto"&&(mt=_e.style[et],_e.style[et]=it,it=_getComputedProperty(_e,et)||it,mt?_e.style[et]=mt:_removeProperty(_e,et)),ut=[rt,it],_colorStringFilter(ut),rt=ut[0],it=ut[1],dt=rt.match(_numWithUnitExp)||[],Rt=it.match(_numWithUnitExp)||[],Rt.length){for(;ht=_numWithUnitExp.exec(it);)At=ht[0],bt=it.substring(lt,ht.index),pt?pt=(pt+1)%5:(bt.substr(-5)==="rgba("||bt.substr(-5)==="hsla(")&&(pt=1),At!==(mt=dt[ct++]||"")&&(ft=parseFloat(mt)||0,wt=mt.substr((ft+"").length),At.charAt(1)==="="&&(At=_parseRelative(ft,At)+wt),gt=parseFloat(At),Tt=At.substr((gt+"").length),lt=_numWithUnitExp.lastIndex-Tt.length,Tt||(Tt=Tt||_config.units[et]||wt,lt===it.length&&(it+=Tt,at.e+=Tt)),wt!==Tt&&(ft=_convertToUnit(_e,et,mt,Tt)||0),at._pt={_next:at._pt,p:bt||ct===1?bt:",",s:ft,c:gt-ft,m:pt&&pt<4||et==="zIndex"?Math.round:0});at.c=lt<it.length?it.substring(lt,it.length):""}else at.r=et==="display"&&it==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(it)&&(at.e=0),this._pt=at,at},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function(_e){var et=_e.split(" "),rt=et[0],it=et[1]||"50%";return(rt==="top"||rt==="bottom"||it==="left"||it==="right")&&(_e=rt,rt=it,it=_e),et[0]=_keywordToPercent[rt]||rt,et[1]=_keywordToPercent[it]||it,et.join(" ")},_renderClearProps=function(_e,et){if(et.tween&&et.tween._time===et.tween._dur){var rt=et.t,it=rt.style,st=et.u,ot=rt._gsap,at,lt,ct;if(st==="all"||st===!0)it.cssText="",lt=1;else for(st=st.split(","),ct=st.length;--ct>-1;)at=st[ct],_transformProps[at]&&(lt=1,at=at==="transformOrigin"?_transformOriginProp:_transformProp),_removeProperty(rt,at);lt&&(_removeProperty(rt,_transformProp),ot&&(ot.svg&&rt.removeAttribute("transform"),_parseTransform(rt,1),ot.uncache=1,_removeIndependentTransforms(it)))}},_specialProps={clearProps:function(_e,et,rt,it,st){if(st.data!=="isFromStart"){var ot=_e._pt=new PropTween(_e._pt,et,rt,0,0,_renderClearProps);return ot.u=it,ot.pr=-10,ot.tween=st,_e._props.push(rt),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function(_e){return _e==="matrix(1, 0, 0, 1, 0, 0)"||_e==="none"||!_e},_getComputedTransformMatrixAsArray=function(_e){var et=_getComputedProperty(_e,_transformProp);return _isNullTransform(et)?_identity2DMatrix:et.substr(7).match(_numExp).map(_round)},_getMatrix=function(_e,et){var rt=_e._gsap||_getCache(_e),it=_e.style,st=_getComputedTransformMatrixAsArray(_e),ot,at,lt,ct;return rt.svg&&_e.getAttribute("transform")?(lt=_e.transform.baseVal.consolidate().matrix,st=[lt.a,lt.b,lt.c,lt.d,lt.e,lt.f],st.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:st):(st===_identity2DMatrix&&!_e.offsetParent&&_e!==_docElement&&!rt.svg&&(lt=it.display,it.display="block",ot=_e.parentNode,(!ot||!_e.offsetParent)&&(ct=1,at=_e.nextElementSibling,_docElement.appendChild(_e)),st=_getComputedTransformMatrixAsArray(_e),lt?it.display=lt:_removeProperty(_e,"display"),ct&&(at?ot.insertBefore(_e,at):ot?ot.appendChild(_e):_docElement.removeChild(_e))),et&&st.length>6?[st[0],st[1],st[4],st[5],st[12],st[13]]:st)},_applySVGOrigin=function(_e,et,rt,it,st,ot){var at=_e._gsap,lt=st||_getMatrix(_e,!0),ct=at.xOrigin||0,ut=at.yOrigin||0,ht=at.xOffset||0,dt=at.yOffset||0,ft=lt[0],pt=lt[1],mt=lt[2],At=lt[3],gt=lt[4],bt=lt[5],Tt=et.split(" "),wt=parseFloat(Tt[0])||0,Rt=parseFloat(Tt[1])||0,It,Lt,$t,kt;rt?lt!==_identity2DMatrix&&(Lt=ft*At-pt*mt)&&($t=wt*(At/Lt)+Rt*(-mt/Lt)+(mt*bt-At*gt)/Lt,kt=wt*(-pt/Lt)+Rt*(ft/Lt)-(ft*bt-pt*gt)/Lt,wt=$t,Rt=kt):(It=_getBBox(_e),wt=It.x+(~Tt[0].indexOf("%")?wt/100*It.width:wt),Rt=It.y+(~(Tt[1]||Tt[0]).indexOf("%")?Rt/100*It.height:Rt)),it||it!==!1&&at.smooth?(gt=wt-ct,bt=Rt-ut,at.xOffset=ht+(gt*ft+bt*mt)-gt,at.yOffset=dt+(gt*pt+bt*At)-bt):at.xOffset=at.yOffset=0,at.xOrigin=wt,at.yOrigin=Rt,at.smooth=!!it,at.origin=et,at.originIsAbsolute=!!rt,_e.style[_transformOriginProp]="0px 0px",ot&&(_addNonTweeningPT(ot,at,"xOrigin",ct,wt),_addNonTweeningPT(ot,at,"yOrigin",ut,Rt),_addNonTweeningPT(ot,at,"xOffset",ht,at.xOffset),_addNonTweeningPT(ot,at,"yOffset",dt,at.yOffset)),_e.setAttribute("data-svg-origin",wt+" "+Rt)},_parseTransform=function(_e,et){var rt=_e._gsap||new GSCache(_e);if("x"in rt&&!et&&!rt.uncache)return rt;var it=_e.style,st=rt.scaleX<0,ot="px",at="deg",lt=getComputedStyle(_e),ct=_getComputedProperty(_e,_transformOriginProp)||"0",ut,ht,dt,ft,pt,mt,At,gt,bt,Tt,wt,Rt,It,Lt,$t,kt,Dt,Ot,zt,Ht,Yt,Xt,Zt,rn,Gt,jt,Kt,Jt,sn,hn,an,pn;return ut=ht=dt=mt=At=gt=bt=Tt=wt=0,ft=pt=1,rt.svg=!!(_e.getCTM&&_isSVG(_e)),lt.translate&&((lt.translate!=="none"||lt.scale!=="none"||lt.rotate!=="none")&&(it[_transformProp]=(lt.translate!=="none"?"translate3d("+(lt.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(lt.rotate!=="none"?"rotate("+lt.rotate+") ":"")+(lt.scale!=="none"?"scale("+lt.scale.split(" ").join(",")+") ":"")+(lt[_transformProp]!=="none"?lt[_transformProp]:"")),it.scale=it.rotate=it.translate="none"),Lt=_getMatrix(_e,rt.svg),rt.svg&&(rt.uncache?(Gt=_e.getBBox(),ct=rt.xOrigin-Gt.x+"px "+(rt.yOrigin-Gt.y)+"px",rn=""):rn=!et&&_e.getAttribute("data-svg-origin"),_applySVGOrigin(_e,rn||ct,!!rn||rt.originIsAbsolute,rt.smooth!==!1,Lt)),Rt=rt.xOrigin||0,It=rt.yOrigin||0,Lt!==_identity2DMatrix&&(Ot=Lt[0],zt=Lt[1],Ht=Lt[2],Yt=Lt[3],ut=Xt=Lt[4],ht=Zt=Lt[5],Lt.length===6?(ft=Math.sqrt(Ot*Ot+zt*zt),pt=Math.sqrt(Yt*Yt+Ht*Ht),mt=Ot||zt?_atan2(zt,Ot)*_RAD2DEG:0,bt=Ht||Yt?_atan2(Ht,Yt)*_RAD2DEG+mt:0,bt&&(pt*=Math.abs(Math.cos(bt*_DEG2RAD))),rt.svg&&(ut-=Rt-(Rt*Ot+It*Ht),ht-=It-(Rt*zt+It*Yt))):(pn=Lt[6],hn=Lt[7],Kt=Lt[8],Jt=Lt[9],sn=Lt[10],an=Lt[11],ut=Lt[12],ht=Lt[13],dt=Lt[14],$t=_atan2(pn,sn),At=$t*_RAD2DEG,$t&&(kt=Math.cos(-$t),Dt=Math.sin(-$t),rn=Xt*kt+Kt*Dt,Gt=Zt*kt+Jt*Dt,jt=pn*kt+sn*Dt,Kt=Xt*-Dt+Kt*kt,Jt=Zt*-Dt+Jt*kt,sn=pn*-Dt+sn*kt,an=hn*-Dt+an*kt,Xt=rn,Zt=Gt,pn=jt),$t=_atan2(-Ht,sn),gt=$t*_RAD2DEG,$t&&(kt=Math.cos(-$t),Dt=Math.sin(-$t),rn=Ot*kt-Kt*Dt,Gt=zt*kt-Jt*Dt,jt=Ht*kt-sn*Dt,an=Yt*Dt+an*kt,Ot=rn,zt=Gt,Ht=jt),$t=_atan2(zt,Ot),mt=$t*_RAD2DEG,$t&&(kt=Math.cos($t),Dt=Math.sin($t),rn=Ot*kt+zt*Dt,Gt=Xt*kt+Zt*Dt,zt=zt*kt-Ot*Dt,Zt=Zt*kt-Xt*Dt,Ot=rn,Xt=Gt),At&&Math.abs(At)+Math.abs(mt)>359.9&&(At=mt=0,gt=180-gt),ft=_round(Math.sqrt(Ot*Ot+zt*zt+Ht*Ht)),pt=_round(Math.sqrt(Zt*Zt+pn*pn)),$t=_atan2(Xt,Zt),bt=Math.abs($t)>2e-4?$t*_RAD2DEG:0,wt=an?1/(an<0?-an:an):0),rt.svg&&(rn=_e.getAttribute("transform"),rt.forceCSS=_e.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(_e,_transformProp)),rn&&_e.setAttribute("transform",rn))),Math.abs(bt)>90&&Math.abs(bt)<270&&(st?(ft*=-1,bt+=mt<=0?180:-180,mt+=mt<=0?180:-180):(pt*=-1,bt+=bt<=0?180:-180)),et=et||rt.uncache,rt.x=ut-((rt.xPercent=ut&&(!et&&rt.xPercent||(Math.round(_e.offsetWidth/2)===Math.round(-ut)?-50:0)))?_e.offsetWidth*rt.xPercent/100:0)+ot,rt.y=ht-((rt.yPercent=ht&&(!et&&rt.yPercent||(Math.round(_e.offsetHeight/2)===Math.round(-ht)?-50:0)))?_e.offsetHeight*rt.yPercent/100:0)+ot,rt.z=dt+ot,rt.scaleX=_round(ft),rt.scaleY=_round(pt),rt.rotation=_round(mt)+at,rt.rotationX=_round(At)+at,rt.rotationY=_round(gt)+at,rt.skewX=bt+at,rt.skewY=Tt+at,rt.transformPerspective=wt+ot,(rt.zOrigin=parseFloat(ct.split(" ")[2])||!et&&rt.zOrigin||0)&&(it[_transformOriginProp]=_firstTwoOnly(ct)),rt.xOffset=rt.yOffset=0,rt.force3D=_config.force3D,rt.renderTransform=rt.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,rt.uncache=0,rt},_firstTwoOnly=function(_e){return(_e=_e.split(" "))[0]+" "+_e[1]},_addPxTranslate=function(_e,et,rt){var it=getUnit(et);return _round(parseFloat(et)+parseFloat(_convertToUnit(_e,"x",rt+"px",it)))+it},_renderNon3DTransforms=function(_e,et){et.z="0px",et.rotationY=et.rotationX="0deg",et.force3D=0,_renderCSSTransforms(_e,et)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function(_e,et){var rt=et||this,it=rt.xPercent,st=rt.yPercent,ot=rt.x,at=rt.y,lt=rt.z,ct=rt.rotation,ut=rt.rotationY,ht=rt.rotationX,dt=rt.skewX,ft=rt.skewY,pt=rt.scaleX,mt=rt.scaleY,At=rt.transformPerspective,gt=rt.force3D,bt=rt.target,Tt=rt.zOrigin,wt="",Rt=gt==="auto"&&_e&&_e!==1||gt===!0;if(Tt&&(ht!==_zeroDeg||ut!==_zeroDeg)){var It=parseFloat(ut)*_DEG2RAD,Lt=Math.sin(It),$t=Math.cos(It),kt;It=parseFloat(ht)*_DEG2RAD,kt=Math.cos(It),ot=_addPxTranslate(bt,ot,Lt*kt*-Tt),at=_addPxTranslate(bt,at,-Math.sin(It)*-Tt),lt=_addPxTranslate(bt,lt,$t*kt*-Tt+Tt)}At!==_zeroPx&&(wt+="perspective("+At+_endParenthesis),(it||st)&&(wt+="translate("+it+"%, "+st+"%) "),(Rt||ot!==_zeroPx||at!==_zeroPx||lt!==_zeroPx)&&(wt+=lt!==_zeroPx||Rt?"translate3d("+ot+", "+at+", "+lt+") ":"translate("+ot+", "+at+_endParenthesis),ct!==_zeroDeg&&(wt+="rotate("+ct+_endParenthesis),ut!==_zeroDeg&&(wt+="rotateY("+ut+_endParenthesis),ht!==_zeroDeg&&(wt+="rotateX("+ht+_endParenthesis),(dt!==_zeroDeg||ft!==_zeroDeg)&&(wt+="skew("+dt+", "+ft+_endParenthesis),(pt!==1||mt!==1)&&(wt+="scale("+pt+", "+mt+_endParenthesis),bt.style[_transformProp]=wt||"translate(0, 0)"},_renderSVGTransforms=function(_e,et){var rt=et||this,it=rt.xPercent,st=rt.yPercent,ot=rt.x,at=rt.y,lt=rt.rotation,ct=rt.skewX,ut=rt.skewY,ht=rt.scaleX,dt=rt.scaleY,ft=rt.target,pt=rt.xOrigin,mt=rt.yOrigin,At=rt.xOffset,gt=rt.yOffset,bt=rt.forceCSS,Tt=parseFloat(ot),wt=parseFloat(at),Rt,It,Lt,$t,kt;lt=parseFloat(lt),ct=parseFloat(ct),ut=parseFloat(ut),ut&&(ut=parseFloat(ut),ct+=ut,lt+=ut),lt||ct?(lt*=_DEG2RAD,ct*=_DEG2RAD,Rt=Math.cos(lt)*ht,It=Math.sin(lt)*ht,Lt=Math.sin(lt-ct)*-dt,$t=Math.cos(lt-ct)*dt,ct&&(ut*=_DEG2RAD,kt=Math.tan(ct-ut),kt=Math.sqrt(1+kt*kt),Lt*=kt,$t*=kt,ut&&(kt=Math.tan(ut),kt=Math.sqrt(1+kt*kt),Rt*=kt,It*=kt)),Rt=_round(Rt),It=_round(It),Lt=_round(Lt),$t=_round($t)):(Rt=ht,$t=dt,It=Lt=0),(Tt&&!~(ot+"").indexOf("px")||wt&&!~(at+"").indexOf("px"))&&(Tt=_convertToUnit(ft,"x",ot,"px"),wt=_convertToUnit(ft,"y",at,"px")),(pt||mt||At||gt)&&(Tt=_round(Tt+pt-(pt*Rt+mt*Lt)+At),wt=_round(wt+mt-(pt*It+mt*$t)+gt)),(it||st)&&(kt=ft.getBBox(),Tt=_round(Tt+it/100*kt.width),wt=_round(wt+st/100*kt.height)),kt="matrix("+Rt+","+It+","+Lt+","+$t+","+Tt+","+wt+")",ft.setAttribute("transform",kt),bt&&(ft.style[_transformProp]=kt)},_addRotationalPropTween=function(_e,et,rt,it,st){var ot=360,at=_isString(st),lt=parseFloat(st)*(at&&~st.indexOf("rad")?_RAD2DEG:1),ct=lt-it,ut=it+ct+"deg",ht,dt;return at&&(ht=st.split("_")[1],ht==="short"&&(ct%=ot,ct!==ct%(ot/2)&&(ct+=ct<0?ot:-ot)),ht==="cw"&&ct<0?ct=(ct+ot*_bigNum)%ot-~~(ct/ot)*ot:ht==="ccw"&&ct>0&&(ct=(ct-ot*_bigNum)%ot-~~(ct/ot)*ot)),_e._pt=dt=new PropTween(_e._pt,et,rt,it,ct,_renderPropWithEnd),dt.e=ut,dt.u="deg",_e._props.push(rt),dt},_assign=function(_e,et){for(var rt in et)_e[rt]=et[rt];return _e},_addRawTransformPTs=function(_e,et,rt){var it=_assign({},rt._gsap),st="perspective,force3D,transformOrigin,svgOrigin",ot=rt.style,at,lt,ct,ut,ht,dt,ft,pt;it.svg?(ct=rt.getAttribute("transform"),rt.setAttribute("transform",""),ot[_transformProp]=et,at=_parseTransform(rt,1),_removeProperty(rt,_transformProp),rt.setAttribute("transform",ct)):(ct=getComputedStyle(rt)[_transformProp],ot[_transformProp]=et,at=_parseTransform(rt,1),ot[_transformProp]=ct);for(lt in _transformProps)ct=it[lt],ut=at[lt],ct!==ut&&st.indexOf(lt)<0&&(ft=getUnit(ct),pt=getUnit(ut),ht=ft!==pt?_convertToUnit(rt,lt,ct,pt):parseFloat(ct),dt=parseFloat(ut),_e._pt=new PropTween(_e._pt,at,lt,ht,dt-ht,_renderCSSProp),_e._pt.u=pt||0,_e._props.push(lt));_assign(at,it)};_forEachName("padding,margin,Width,Radius",function(nt,_e){var et="Top",rt="Right",it="Bottom",st="Left",ot=(_e<3?[et,rt,it,st]:[et+st,et+rt,it+rt,it+st]).map(function(at){return _e<2?nt+at:"border"+at+nt});_specialProps[_e>1?"border"+nt:nt]=function(at,lt,ct,ut,ht){var dt,ft;if(arguments.length<4)return dt=ot.map(function(pt){return _get(at,pt,ct)}),ft=dt.join(" "),ft.split(dt[0]).length===5?dt[0]:ft;dt=(ut+"").split(" "),ft={},ot.forEach(function(pt,mt){return ft[pt]=dt[mt]=dt[mt]||dt[(mt-1)/2|0]}),at.init(lt,ft,ht)}});var CSSPlugin={name:"css",register:_initCore,targetTest:function(_e){return _e.style&&_e.nodeType},init:function(_e,et,rt,it,st){var ot=this._props,at=_e.style,lt=rt.vars.startAt,ct,ut,ht,dt,ft,pt,mt,At,gt,bt,Tt,wt,Rt,It,Lt,$t;_pluginInitted||_initCore(),this.styles=this.styles||_getStyleSaver(_e),$t=this.styles.props,this.tween=rt;for(mt in et)if(mt!=="autoRound"&&(ut=et[mt],!(_plugins[mt]&&_checkPlugin(mt,et,rt,it,_e,st)))){if(ft=typeof ut,pt=_specialProps[mt],ft==="function"&&(ut=ut.call(rt,it,_e,st),ft=typeof ut),ft==="string"&&~ut.indexOf("random(")&&(ut=_replaceRandom(ut)),pt)pt(this,_e,mt,ut,rt)&&(Lt=1);else if(mt.substr(0,2)==="--")ct=(getComputedStyle(_e).getPropertyValue(mt)+"").trim(),ut+="",_colorExp.lastIndex=0,_colorExp.test(ct)||(At=getUnit(ct),gt=getUnit(ut)),gt?At!==gt&&(ct=_convertToUnit(_e,mt,ct,gt)+gt):At&&(ut+=At),this.add(at,"setProperty",ct,ut,it,st,0,0,mt),ot.push(mt),$t.push(mt,0,at[mt]);else if(ft!=="undefined"){if(lt&&mt in lt?(ct=typeof lt[mt]=="function"?lt[mt].call(rt,it,_e,st):lt[mt],_isString(ct)&&~ct.indexOf("random(")&&(ct=_replaceRandom(ct)),getUnit(ct+"")||ct==="auto"||(ct+=_config.units[mt]||getUnit(_get(_e,mt))||""),(ct+"").charAt(1)==="="&&(ct=_get(_e,mt))):ct=_get(_e,mt),dt=parseFloat(ct),bt=ft==="string"&&ut.charAt(1)==="="&&ut.substr(0,2),bt&&(ut=ut.substr(2)),ht=parseFloat(ut),mt in _propertyAliases&&(mt==="autoAlpha"&&(dt===1&&_get(_e,"visibility")==="hidden"&&ht&&(dt=0),$t.push("visibility",0,at.visibility),_addNonTweeningPT(this,at,"visibility",dt?"inherit":"hidden",ht?"inherit":"hidden",!ht)),mt!=="scale"&&mt!=="transform"&&(mt=_propertyAliases[mt],~mt.indexOf(",")&&(mt=mt.split(",")[0]))),Tt=mt in _transformProps,Tt){if(this.styles.save(mt),wt||(Rt=_e._gsap,Rt.renderTransform&&!et.parseTransform||_parseTransform(_e,et.parseTransform),It=et.smoothOrigin!==!1&&Rt.smooth,wt=this._pt=new PropTween(this._pt,at,_transformProp,0,1,Rt.renderTransform,Rt,0,-1),wt.dep=1),mt==="scale")this._pt=new PropTween(this._pt,Rt,"scaleY",Rt.scaleY,(bt?_parseRelative(Rt.scaleY,bt+ht):ht)-Rt.scaleY||0,_renderCSSProp),this._pt.u=0,ot.push("scaleY",mt),mt+="X";else if(mt==="transformOrigin"){$t.push(_transformOriginProp,0,at[_transformOriginProp]),ut=_convertKeywordsToPercentages(ut),Rt.svg?_applySVGOrigin(_e,ut,0,It,0,this):(gt=parseFloat(ut.split(" ")[2])||0,gt!==Rt.zOrigin&&_addNonTweeningPT(this,Rt,"zOrigin",Rt.zOrigin,gt),_addNonTweeningPT(this,at,mt,_firstTwoOnly(ct),_firstTwoOnly(ut)));continue}else if(mt==="svgOrigin"){_applySVGOrigin(_e,ut,1,It,0,this);continue}else if(mt in _rotationalProperties){_addRotationalPropTween(this,Rt,mt,dt,bt?_parseRelative(dt,bt+ut):ut);continue}else if(mt==="smoothOrigin"){_addNonTweeningPT(this,Rt,"smooth",Rt.smooth,ut);continue}else if(mt==="force3D"){Rt[mt]=ut;continue}else if(mt==="transform"){_addRawTransformPTs(this,ut,_e);continue}}else mt in at||(mt=_checkPropPrefix(mt)||mt);if(Tt||(ht||ht===0)&&(dt||dt===0)&&!_complexExp.test(ut)&&mt in at)At=(ct+"").substr((dt+"").length),ht||(ht=0),gt=getUnit(ut)||(mt in _config.units?_config.units[mt]:At),At!==gt&&(dt=_convertToUnit(_e,mt,ct,gt)),this._pt=new PropTween(this._pt,Tt?Rt:at,mt,dt,(bt?_parseRelative(dt,bt+ht):ht)-dt,!Tt&&(gt==="px"||mt==="zIndex")&&et.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=gt||0,At!==gt&&gt!=="%"&&(this._pt.b=ct,this._pt.r=_renderCSSPropWithBeginning);else if(mt in at)_tweenComplexCSSString.call(this,_e,mt,ct,bt?bt+ut:ut);else if(mt in _e)this.add(_e,mt,ct||_e[mt],bt?bt+ut:ut,it,st);else if(mt!=="parseTransform"){_missingPlugin(mt,ut);continue}Tt||(mt in at?$t.push(mt,0,at[mt]):$t.push(mt,1,ct||_e[mt])),ot.push(mt)}}Lt&&_sortPropTweensByPriority(this)},render:function(_e,et){if(et.tween._time||!_reverting())for(var rt=et._pt;rt;)rt.r(_e,rt.d),rt=rt._next;else et.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function(_e,et,rt){var it=_propertyAliases[et];return it&&it.indexOf(",")<0&&(et=it),et in _transformProps&&et!==_transformOriginProp&&(_e._gsap.x||_get(_e,"x"))?rt&&_recentSetterPlugin===rt?et==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=rt||{})&&(et==="scale"?_setterScaleWithRender:_setterTransformWithRender):_e.style&&!_isUndefined(_e.style[et])?_setterCSSStyle:~et.indexOf("-")?_setterCSSProp:_getSetter(_e,et)},core:{_removeProperty,_getMatrix}};gsap.utils.checkPrefix=_checkPropPrefix;gsap.core.getStyleSaver=_getStyleSaver;(function(nt,_e,et,rt){var it=_forEachName(nt+","+_e+","+et,function(st){_transformProps[st]=1});_forEachName(_e,function(st){_config.units[st]="deg",_rotationalProperties[st]=1}),_propertyAliases[it[13]]=nt+","+_e,_forEachName(rt,function(st){var ot=st.split(":");_propertyAliases[ot[1]]=it[ot[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(nt){_config.units[nt]="px"});gsap.registerPlugin(CSSPlugin);var gsapWithCSS=gsap.registerPlugin(CSSPlugin)||gsap;gsapWithCSS.core.Tween;/*!
 * @gsap/react 2.1.1
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let useIsomorphicLayoutEffect$1=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,isConfig=nt=>nt&&!Array.isArray(nt)&&typeof nt=="object",emptyArray=[],defaultConfig={},_gsap=gsapWithCSS;const useGSAP=(nt,_e=emptyArray)=>{let et=defaultConfig;isConfig(nt)?(et=nt,nt=null,_e="dependencies"in et?et.dependencies:emptyArray):isConfig(_e)&&(et=_e,_e="dependencies"in et?et.dependencies:emptyArray),nt&&typeof nt!="function"&&console.warn("First parameter must be a function or config object");const{scope:rt,revertOnUpdate:it}=et,st=reactExports.useRef(!1),ot=reactExports.useRef(_gsap.context(()=>{},rt)),at=reactExports.useRef(ct=>ot.current.add(null,ct)),lt=_e&&_e.length&&!it;return useIsomorphicLayoutEffect$1(()=>{if(nt&&ot.current.add(nt,rt),!lt||!st.current)return()=>ot.current.revert()},_e),lt&&useIsomorphicLayoutEffect$1(()=>(st.current=!0,()=>ot.current.revert()),emptyArray),{context:ot.current,contextSafe:at.current}};useGSAP.register=nt=>{_gsap=nt};useGSAP.headless=!0;useGLTF.preload("models/cube.glb");useGLTF.preload("models/react.glb");const Button=({name:nt,isBeam:_e=!1,containerClass:et})=>jsxRuntimeExports.jsxs("button",{className:`btn ${et}`,children:[_e&&jsxRuntimeExports.jsxs("span",{className:"relative flex h-3 w-3",children:[jsxRuntimeExports.jsx("span",{className:"btn-ping"}),jsxRuntimeExports.jsx("span",{className:"btn-ping_dot"})]}),nt]}),CanvasLoader=()=>{const{progress:nt}=useProgress();return jsxRuntimeExports.jsxs(Html,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[jsxRuntimeExports.jsx("span",{className:"canvas-loader"}),jsxRuntimeExports.jsx("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:nt!==0?`${nt.toFixed(2)}%`:"Loading..."})]})},navLinks=[{id:1,name:"Home",href:"#home"},{id:2,name:"About",href:"#about"},{id:3,name:"Projects",href:"#projects"},{id:4,name:"Contact",href:"#contact"}],myProjects=[{title:"Podcastr - AI Podcast Platform",desc:"Podcastr is a revolutionary Software-as-a-Service platform that transforms the way podcasts are created. With advanced AI-powered features like text-to-multiple-voices functionality, it allows creators to generate diverse voiceovers from a single text input.",subdesc:"Built as a unique Software-as-a-Service app with Next.js 14, Tailwind CSS, TypeScript, Framer Motion and Convex, Podcastr is designed for optimal performance and scalability.",href:"https://www.youtube.com/watch?v=zfAb95tJvZQ",texture:"/textures/project/project1.mp4",logo:"/assets/project-logo1.png",logoStyle:{backgroundColor:"#2A1816",border:"0.2px solid #36201D",boxShadow:"0px 0px 60px 0px #AA3C304D"},spotlight:"/assets/spotlight1.png",tags:[{id:1,name:"React.js",path:"/assets/react.svg"},{id:2,name:"TailwindCSS",path:"assets/tailwindcss.png"},{id:3,name:"TypeScript",path:"/assets/typescript.png"},{id:4,name:"Framer Motion",path:"/assets/framer.png"}]},{title:"LiveDoc - Real-Time Google Docs Clone",desc:"LiveDoc is a powerful collaborative app that elevates the capabilities of real-time document editing. As an enhanced version of Google Docs, It supports millions of collaborators simultaneously, ensuring that every change is captured instantly and accurately.",subdesc:"With LiveDoc, users can experience the future of collaboration, where multiple contributors work together in real time without any lag, by using Next.js and Liveblocks newest features.",href:"https://www.youtube.com/watch?v=y5vE8y_f_OM",texture:"/textures/project/project2.mp4",logo:"/assets/project-logo2.png",logoStyle:{backgroundColor:"#13202F",border:"0.2px solid #17293E",boxShadow:"0px 0px 60px 0px #2F6DB54D"},spotlight:"/assets/spotlight2.png",tags:[{id:1,name:"React.js",path:"/assets/react.svg"},{id:2,name:"TailwindCSS",path:"assets/tailwindcss.png"},{id:3,name:"TypeScript",path:"/assets/typescript.png"},{id:4,name:"Framer Motion",path:"/assets/framer.png"}]},{title:"CarePulse - Health Management System",desc:"An innovative healthcare platform designed to streamline essential medical processes. It simplifies patient registration, appointment scheduling, and medical record management, providing a seamless experience for both healthcare providers and patients.",subdesc:"With a focus on efficiency, CarePulse integrantes complex forms and SMS notifications, by using Next.js, Appwrite, Twillio and Sentry that enhance operational workflows.",href:"https://www.youtube.com/watch?v=lEflo_sc82g",texture:"/textures/project/project3.mp4",logo:"/assets/project-logo3.png",logoStyle:{backgroundColor:"#60f5a1",background:"linear-gradient(0deg, #60F5A150, #60F5A150), linear-gradient(180deg, rgba(255, 255, 255, 0.9) 0%, rgba(208, 213, 221, 0.8) 100%)",border:"0.2px solid rgba(208, 213, 221, 1)",boxShadow:"0px 0px 60px 0px rgba(35, 131, 96, 0.3)"},spotlight:"/assets/spotlight3.png",tags:[{id:1,name:"React.js",path:"/assets/react.svg"},{id:2,name:"TailwindCSS",path:"assets/tailwindcss.png"},{id:3,name:"TypeScript",path:"/assets/typescript.png"},{id:4,name:"Framer Motion",path:"/assets/framer.png"}]},{title:"Horizon - Online Banking Platform",desc:"Horizon is a comprehensive online banking platform that offers users a centralized finance management dashboard. It allows users to connect multiple bank accounts, monitor real-time transactions, and seamlessly transfer money to other users.",subdesc:"Built with Next.js 14 Appwrite, Dwolla and Plaid, Horizon ensures a smooth and secure banking experience, tailored to meet the needs of modern consumers.",href:"https://www.youtube.com/watch?v=PuOVqP_cjkE",texture:"/textures/project/project4.mp4",logo:"/assets/project-logo4.png",logoStyle:{backgroundColor:"#0E1F38",border:"0.2px solid #0E2D58",boxShadow:"0px 0px 60px 0px #2F67B64D"},spotlight:"/assets/spotlight4.png",tags:[{id:1,name:"React.js",path:"/assets/react.svg"},{id:2,name:"TailwindCSS",path:"assets/tailwindcss.png"},{id:3,name:"TypeScript",path:"/assets/typescript.png"},{id:4,name:"Framer Motion",path:"/assets/framer.png"}]},{title:"Imaginify - AI Photo Manipulation App",desc:"Imaginify is a groundbreaking Software-as-a-Service application that empowers users to create stunning photo manipulations using AI technology. With features like AI-driven image editing, a payments system, and a credits-based model.",subdesc:"Built with Next.js 14, Cloudinary AI, Clerk, and Stripe, Imaginify combines cutting-edge technology with a user-centric approach. It can be turned into a side income or even a full-fledged business.",href:"https://www.youtube.com/watch?v=Ahwoks_dawU",texture:"/textures/project/project5.mp4",logo:"/assets/project-logo5.png",logoStyle:{backgroundColor:"#1C1A43",border:"0.2px solid #252262",boxShadow:"0px 0px 60px 0px #635BFF4D"},spotlight:"/assets/spotlight5.png",tags:[{id:1,name:"React.js",path:"/assets/react.svg"},{id:2,name:"TailwindCSS",path:"assets/tailwindcss.png"},{id:3,name:"TypeScript",path:"/assets/typescript.png"},{id:4,name:"Framer Motion",path:"/assets/framer.png"}]}],calculateSizes=(nt,_e,et)=>{const rt=typeof window<"u"&&window.innerWidth>=1440,it=typeof window<"u"&&window.innerWidth>=1920,st={deskScale:nt?.05:_e?.06:et?.065:.07,deskPosition:_e?[.5,-4.5,0]:et?[.25,-5.5,0]:[.25,-5.5,0],cubePosition:nt?[4,-5,0]:_e?[5,-5,0]:et?[5,-5,0]:[9,-5.5,0],reactLogoPosition:nt?[3,4,0]:_e?[5,4,0]:et?[5,4,0]:[12,3,0],ringPosition:nt?[-5,7,0]:_e?[-10,10,0]:et?[-12,10,0]:[-24,10,0],targetPosition:nt?[-5,-10,-10]:_e?[-9,-10,-10]:et?[-11,-7,-10]:[-13,-13,-10]};return rt?{deskScale:st.deskScale*.8,deskPosition:[st.deskPosition[0],st.deskPosition[1],st.deskPosition[2]],cubePosition:[st.cubePosition[0]*1.3,st.cubePosition[1],st.cubePosition[2]],reactLogoPosition:[st.reactLogoPosition[0]*.25,st.reactLogoPosition[1],st.reactLogoPosition[2]],ringPosition:[st.ringPosition[0]*1.3,st.ringPosition[1],st.ringPosition[2]],targetPosition:[st.targetPosition[0]*1.3,st.targetPosition[1],st.targetPosition[2]]}:it?{deskScale:st.deskScale*1.4,deskPosition:[st.deskPosition[0],st.deskPosition[1],st.deskPosition[2]],cubePosition:[st.cubePosition[0]*1.5,st.cubePosition[1],st.cubePosition[2]],reactLogoPosition:[st.reactLogoPosition[0]*1.5,st.reactLogoPosition[1],st.reactLogoPosition[2]],ringPosition:[st.ringPosition[0]*1.5,st.ringPosition[1],st.ringPosition[2]],targetPosition:[st.targetPosition[0]*1.5,st.targetPosition[1],st.targetPosition[2]]}:st};useGLTF.preload("/models/hacker-room.glb");function _iterableToArrayLimit$8(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e===0){if(Object(et)!==et)return;lt=!1}else for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _defineProperty$4(nt,_e,et){return _e=_toPropertyKey$5(_e),_e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _slicedToArray$8(nt,_e){return _arrayWithHoles$8(nt)||_iterableToArrayLimit$8(nt,_e)||_unsupportedIterableToArray$9(nt,_e)||_nonIterableRest$8()}function _toConsumableArray$7(nt){return _arrayWithoutHoles$7(nt)||_iterableToArray$7(nt)||_unsupportedIterableToArray$9(nt)||_nonIterableSpread$7()}function _arrayWithoutHoles$7(nt){if(Array.isArray(nt))return _arrayLikeToArray$9(nt)}function _arrayWithHoles$8(nt){if(Array.isArray(nt))return nt}function _iterableToArray$7(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _unsupportedIterableToArray$9(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$9(nt,_e);var et=Object.prototype.toString.call(nt).slice(8,-1);if(et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set")return Array.from(nt);if(et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et))return _arrayLikeToArray$9(nt,_e)}}function _arrayLikeToArray$9(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=new Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _nonIterableSpread$7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest$8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toPrimitive$5(nt,_e){if(typeof nt!="object"||nt===null)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey$5(nt){var _e=_toPrimitive$5(nt,"string");return typeof _e=="symbol"?_e:String(_e)}var omit=function(_e,et){var rt=new Set(et);return Object.assign.apply(Object,[{}].concat(_toConsumableArray$7(Object.entries(_e).filter(function(it){var st=_slicedToArray$8(it,1),ot=st[0];return!rt.has(ot)}).map(function(it){var st=_slicedToArray$8(it,2),ot=st[0],at=st[1];return _defineProperty$4({},ot,at)}))))};/*! fromentries. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var fromentries=function(_e){return[..._e].reduce((et,[rt,it])=>(et[rt]=it,et),{})};const fromEntries=getDefaultExportFromCjs$1(fromentries);function _arrayLikeToArray$8(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles$7(nt){if(Array.isArray(nt))return nt}function _arrayWithoutHoles$6(nt){if(Array.isArray(nt))return _arrayLikeToArray$8(nt)}function _iterableToArray$6(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _iterableToArrayLimit$7(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e!==0)for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest$7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread$6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray$7(nt,_e){return _arrayWithHoles$7(nt)||_iterableToArrayLimit$7(nt,_e)||_unsupportedIterableToArray$8(nt,_e)||_nonIterableRest$7()}function _toConsumableArray$6(nt){return _arrayWithoutHoles$6(nt)||_iterableToArray$6(nt)||_unsupportedIterableToArray$8(nt)||_nonIterableSpread$6()}function _typeof$1(nt){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},_typeof$1(nt)}function _unsupportedIterableToArray$8(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$8(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$8(nt,_e):void 0}}function index$3(nt,_e){var et=_typeof$1(_e)==="object"?_e:{wrapperElementType:_e,methodNames:(arguments.length<=2?void 0:arguments[2])||void 0,initPropNames:(arguments.length<=3?void 0:arguments[3])||void 0},rt=et.wrapperElementType,it=rt===void 0?"div":rt,st=et.nodeMapper,ot=st===void 0?function(ht){return ht}:st,at=et.methodNames,lt=at===void 0?[]:at,ct=et.initPropNames,ut=ct===void 0?[]:ct;return reactExports.forwardRef(function(ht,dt){var ft=reactExports.useRef(),pt=reactExports.useState({}),mt=_slicedToArray$7(pt,2),At=mt[0],gt=mt[1];reactExports.useEffect(function(){return gt(ht)});var bt=reactExports.useMemo(function(){var Rt=fromEntries(ut.filter(function(It){return ht.hasOwnProperty(It)}).map(function(It){return[It,ht[It]]}));return nt(Rt)},[]);useEffectOnce(function(){bt(ot(ft.current))},reactExports.useLayoutEffect),useEffectOnce(function(){return bt._destructor instanceof Function?bt._destructor:void 0});var Tt=reactExports.useCallback(function(Rt){for(var It=arguments.length,Lt=new Array(It>1?It-1:0),$t=1;$t<It;$t++)Lt[$t-1]=arguments[$t];return bt[Rt]instanceof Function?bt[Rt].apply(bt,Lt):void 0},[bt]),wt=omit(ht,[].concat(_toConsumableArray$6(lt),_toConsumableArray$6(ut)));return Object.keys(wt).filter(function(Rt){return At[Rt]!==ht[Rt]}).forEach(function(Rt){return Tt(Rt,ht[Rt])}),reactExports.useImperativeHandle(dt,function(){return fromEntries(lt.map(function(Rt){return[Rt,function(){for(var It=arguments.length,Lt=new Array(It),$t=0;$t<It;$t++)Lt[$t]=arguments[$t];return Tt.apply(void 0,[Rt].concat(Lt))}]}))}),React.createElement(it,{ref:ft})})}function useEffectOnce(nt){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:reactExports.useEffect,et=reactExports.useRef(),rt=reactExports.useRef(!1),it=reactExports.useRef(!1),st=reactExports.useState(0),ot=_slicedToArray$7(st,2);ot[0];var at=ot[1];rt.current&&(it.current=!0),_e(function(){return rt.current||(et.current=nt(),rt.current=!0),at(function(lt){return lt+1}),function(){it.current&&et.current&&et.current()}},[])}class CSS2DObject extends Object3D$1{constructor(_e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=_e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Vector2$1(.5,.5),this.addEventListener("removed",function(){this.traverse(function(et){et.element instanceof Element&&et.element.parentNode!==null&&et.element.parentNode.removeChild(et.element)})})}copy(_e,et){return super.copy(_e,et),this.element=_e.element.cloneNode(!0),this.center=_e.center,this}}const _vector$1=new Vector3$1,_viewMatrix=new Matrix4$1,_viewProjectionMatrix=new Matrix4$1,_a=new Vector3$1,_b=new Vector3$1;class CSS2DRenderer{constructor(_e={}){const et=this;let rt,it,st,ot;const at={objects:new WeakMap},lt=_e.element!==void 0?_e.element:document.createElement("div");lt.style.overflow="hidden",this.domElement=lt,this.getSize=function(){return{width:rt,height:it}},this.render=function(pt,mt){pt.matrixWorldAutoUpdate===!0&&pt.updateMatrixWorld(),mt.parent===null&&mt.matrixWorldAutoUpdate===!0&&mt.updateMatrixWorld(),_viewMatrix.copy(mt.matrixWorldInverse),_viewProjectionMatrix.multiplyMatrices(mt.projectionMatrix,_viewMatrix),ut(pt,pt,mt),ft(pt)},this.setSize=function(pt,mt){rt=pt,it=mt,st=rt/2,ot=it/2,lt.style.width=pt+"px",lt.style.height=mt+"px"};function ct(pt){pt.isCSS2DObject&&(pt.element.style.display="none");for(let mt=0,At=pt.children.length;mt<At;mt++)ct(pt.children[mt])}function ut(pt,mt,At){if(pt.visible===!1){ct(pt);return}if(pt.isCSS2DObject){_vector$1.setFromMatrixPosition(pt.matrixWorld),_vector$1.applyMatrix4(_viewProjectionMatrix);const gt=_vector$1.z>=-1&&_vector$1.z<=1&&pt.layers.test(At.layers)===!0,bt=pt.element;bt.style.display=gt===!0?"":"none",gt===!0&&(pt.onBeforeRender(et,mt,At),bt.style.transform="translate("+-100*pt.center.x+"%,"+-100*pt.center.y+"%)translate("+(_vector$1.x*st+st)+"px,"+(-_vector$1.y*ot+ot)+"px)",bt.parentNode!==lt&&lt.appendChild(bt),pt.onAfterRender(et,mt,At));const Tt={distanceToCameraSquared:ht(At,pt)};at.objects.set(pt,Tt)}for(let gt=0,bt=pt.children.length;gt<bt;gt++)ut(pt.children[gt],mt,At)}function ht(pt,mt){return _a.setFromMatrixPosition(pt.matrixWorld),_b.setFromMatrixPosition(mt.matrixWorld),_a.distanceToSquared(_b)}function dt(pt){const mt=[];return pt.traverseVisible(function(At){At.isCSS2DObject&&mt.push(At)}),mt}function ft(pt){const mt=dt(pt).sort(function(gt,bt){if(gt.renderOrder!==bt.renderOrder)return bt.renderOrder-gt.renderOrder;const Tt=at.objects.get(gt).distanceToCameraSquared,wt=at.objects.get(bt).distanceToCameraSquared;return Tt-wt}),At=mt.length;for(let gt=0,bt=mt.length;gt<bt;gt++)mt[gt].element.style.zIndex=At-gt}}}function isObject(nt){var _e=typeof nt;return nt!=null&&(_e=="object"||_e=="function")}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),now$2=function(){return root.Date.now()},reWhitespace=/\s/;function trimmedEndIndex(nt){for(var _e=nt.length;_e--&&reWhitespace.test(nt.charAt(_e)););return _e}var reTrimStart=/^\s+/;function baseTrim(nt){return nt&&nt.slice(0,trimmedEndIndex(nt)+1).replace(reTrimStart,"")}var Symbol$1=root.Symbol,objectProto$1=Object.prototype,hasOwnProperty=objectProto$1.hasOwnProperty,nativeObjectToString$1=objectProto$1.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(nt){var _e=hasOwnProperty.call(nt,symToStringTag$1),et=nt[symToStringTag$1];try{nt[symToStringTag$1]=void 0;var rt=!0}catch{}var it=nativeObjectToString$1.call(nt);return rt&&(_e?nt[symToStringTag$1]=et:delete nt[symToStringTag$1]),it}var objectProto=Object.prototype,nativeObjectToString=objectProto.toString;function objectToString(nt){return nativeObjectToString.call(nt)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(nt){return nt==null?nt===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(nt)?getRawTag(nt):objectToString(nt)}function isObjectLike(nt){return nt!=null&&typeof nt=="object"}var symbolTag="[object Symbol]";function isSymbol(nt){return typeof nt=="symbol"||isObjectLike(nt)&&baseGetTag(nt)==symbolTag}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(nt){if(typeof nt=="number")return nt;if(isSymbol(nt))return NAN;if(isObject(nt)){var _e=typeof nt.valueOf=="function"?nt.valueOf():nt;nt=isObject(_e)?_e+"":_e}if(typeof nt!="string")return nt===0?nt:+nt;nt=baseTrim(nt);var et=reIsBinary.test(nt);return et||reIsOctal.test(nt)?freeParseInt(nt.slice(2),et?2:8):reIsBadHex.test(nt)?NAN:+nt}var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(nt,_e,et){var rt,it,st,ot,at,lt,ct=0,ut=!1,ht=!1,dt=!0;if(typeof nt!="function")throw new TypeError(FUNC_ERROR_TEXT);_e=toNumber(_e)||0,isObject(et)&&(ut=!!et.leading,ht="maxWait"in et,st=ht?nativeMax(toNumber(et.maxWait)||0,_e):st,dt="trailing"in et?!!et.trailing:dt);function ft(It){var Lt=rt,$t=it;return rt=it=void 0,ct=It,ot=nt.apply($t,Lt),ot}function pt(It){return ct=It,at=setTimeout(gt,_e),ut?ft(It):ot}function mt(It){var Lt=It-lt,$t=It-ct,kt=_e-Lt;return ht?nativeMin(kt,st-$t):kt}function At(It){var Lt=It-lt,$t=It-ct;return lt===void 0||Lt>=_e||Lt<0||ht&&$t>=st}function gt(){var It=now$2();if(At(It))return bt(It);at=setTimeout(gt,mt(It))}function bt(It){return at=void 0,dt&&rt?ft(It):(rt=it=void 0,ot)}function Tt(){at!==void 0&&clearTimeout(at),ct=0,rt=lt=it=at=void 0}function wt(){return at===void 0?ot:bt(now$2())}function Rt(){var It=now$2(),Lt=At(It);if(rt=arguments,it=this,lt=It,Lt){if(at===void 0)return pt(lt);if(ht)return clearTimeout(at),at=setTimeout(gt,_e),ft(lt)}return at===void 0&&(at=setTimeout(gt,_e)),ot}return Rt.cancel=Tt,Rt.flush=wt,Rt}function _arrayLikeToArray$7(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles$6(nt){if(Array.isArray(nt))return nt}function _classCallCheck$3(nt,_e){if(!(nt instanceof _e))throw new TypeError("Cannot call a class as a function")}function _createClass$3(nt,_e,et){return Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _iterableToArrayLimit$6(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e!==0)for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest$6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray$6(nt,_e){return _arrayWithHoles$6(nt)||_iterableToArrayLimit$6(nt,_e)||_unsupportedIterableToArray$7(nt,_e)||_nonIterableRest$6()}function _unsupportedIterableToArray$7(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$7(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$7(nt,_e):void 0}}var Prop=_createClass$3(function nt(_e,et){var rt=et.default,it=rt===void 0?null:rt,st=et.triggerUpdate,ot=st===void 0?!0:st,at=et.onChange,lt=at===void 0?function(ct,ut){}:at;_classCallCheck$3(this,nt),this.name=_e,this.defaultVal=it,this.triggerUpdate=ot,this.onChange=lt});function index$2(nt){var _e=nt.stateInit,et=_e===void 0?function(){return{}}:_e,rt=nt.props,it=rt===void 0?{}:rt,st=nt.methods,ot=st===void 0?{}:st,at=nt.aliases,lt=at===void 0?{}:at,ct=nt.init,ut=ct===void 0?function(){}:ct,ht=nt.update,dt=ht===void 0?function(){}:ht,ft=Object.keys(it).map(function(pt){return new Prop(pt,it[pt])});return function(){var pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},mt=Object.assign({},et instanceof Function?et(pt):et,{initialised:!1}),At={};function gt(wt){return bt(wt,pt),Tt(),gt}var bt=function(Rt,It){ut.call(gt,Rt,mt,It),mt.initialised=!0},Tt=debounce(function(){mt.initialised&&(dt.call(gt,mt,At),At={})},1);return ft.forEach(function(wt){gt[wt.name]=Rt(wt);function Rt(It){var Lt=It.name,$t=It.triggerUpdate,kt=$t===void 0?!1:$t,Dt=It.onChange,Ot=Dt===void 0?function(Yt,Xt){}:Dt,zt=It.defaultVal,Ht=zt===void 0?null:zt;return function(Yt){var Xt=mt[Lt];if(!arguments.length)return Xt;var Zt=Yt===void 0?Ht:Yt;return mt[Lt]=Zt,Ot.call(gt,Zt,mt,Xt),!At.hasOwnProperty(Lt)&&(At[Lt]=Xt),kt&&Tt(),gt}}}),Object.keys(ot).forEach(function(wt){gt[wt]=function(){for(var Rt,It=arguments.length,Lt=new Array(It),$t=0;$t<It;$t++)Lt[$t]=arguments[$t];return(Rt=ot[wt]).call.apply(Rt,[gt,mt].concat(Lt))}}),Object.entries(lt).forEach(function(wt){var Rt=_slicedToArray$6(wt,2),It=Rt[0],Lt=Rt[1];return gt[It]=gt[Lt]}),gt.resetProps=function(){return ft.forEach(function(wt){gt[wt.name](wt.defaultVal)}),gt},gt.resetProps(),mt._rerender=Tt,gt}}var Easing=Object.freeze({Linear:Object.freeze({None:function(nt){return nt},In:function(nt){return nt},Out:function(nt){return nt},InOut:function(nt){return nt}}),Quadratic:Object.freeze({In:function(nt){return nt*nt},Out:function(nt){return nt*(2-nt)},InOut:function(nt){return(nt*=2)<1?.5*nt*nt:-.5*(--nt*(nt-2)-1)}}),Cubic:Object.freeze({In:function(nt){return nt*nt*nt},Out:function(nt){return--nt*nt*nt+1},InOut:function(nt){return(nt*=2)<1?.5*nt*nt*nt:.5*((nt-=2)*nt*nt+2)}}),Quartic:Object.freeze({In:function(nt){return nt*nt*nt*nt},Out:function(nt){return 1- --nt*nt*nt*nt},InOut:function(nt){return(nt*=2)<1?.5*nt*nt*nt*nt:-.5*((nt-=2)*nt*nt*nt-2)}}),Quintic:Object.freeze({In:function(nt){return nt*nt*nt*nt*nt},Out:function(nt){return--nt*nt*nt*nt*nt+1},InOut:function(nt){return(nt*=2)<1?.5*nt*nt*nt*nt*nt:.5*((nt-=2)*nt*nt*nt*nt+2)}}),Sinusoidal:Object.freeze({In:function(nt){return 1-Math.sin((1-nt)*Math.PI/2)},Out:function(nt){return Math.sin(nt*Math.PI/2)},InOut:function(nt){return .5*(1-Math.sin(Math.PI*(.5-nt)))}}),Exponential:Object.freeze({In:function(nt){return nt===0?0:Math.pow(1024,nt-1)},Out:function(nt){return nt===1?1:1-Math.pow(2,-10*nt)},InOut:function(nt){return nt===0?0:nt===1?1:(nt*=2)<1?.5*Math.pow(1024,nt-1):.5*(-Math.pow(2,-10*(nt-1))+2)}}),Circular:Object.freeze({In:function(nt){return 1-Math.sqrt(1-nt*nt)},Out:function(nt){return Math.sqrt(1- --nt*nt)},InOut:function(nt){return(nt*=2)<1?-.5*(Math.sqrt(1-nt*nt)-1):.5*(Math.sqrt(1-(nt-=2)*nt)+1)}}),Elastic:Object.freeze({In:function(nt){return nt===0?0:nt===1?1:-Math.pow(2,10*(nt-1))*Math.sin((nt-1.1)*5*Math.PI)},Out:function(nt){return nt===0?0:nt===1?1:Math.pow(2,-10*nt)*Math.sin((nt-.1)*5*Math.PI)+1},InOut:function(nt){return nt===0?0:nt===1?1:(nt*=2,nt<1?-.5*Math.pow(2,10*(nt-1))*Math.sin((nt-1.1)*5*Math.PI):.5*Math.pow(2,-10*(nt-1))*Math.sin((nt-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(nt){var _e=1.70158;return nt===1?1:nt*nt*((_e+1)*nt-_e)},Out:function(nt){var _e=1.70158;return nt===0?0:--nt*nt*((_e+1)*nt+_e)+1},InOut:function(nt){var _e=2.5949095;return(nt*=2)<1?.5*(nt*nt*((_e+1)*nt-_e)):.5*((nt-=2)*nt*((_e+1)*nt+_e)+2)}}),Bounce:Object.freeze({In:function(nt){return 1-Easing.Bounce.Out(1-nt)},Out:function(nt){return nt<1/2.75?7.5625*nt*nt:nt<2/2.75?7.5625*(nt-=1.5/2.75)*nt+.75:nt<2.5/2.75?7.5625*(nt-=2.25/2.75)*nt+.9375:7.5625*(nt-=2.625/2.75)*nt+.984375},InOut:function(nt){return nt<.5?Easing.Bounce.In(nt*2)*.5:Easing.Bounce.Out(nt*2-1)*.5+.5}}),generatePow:function(nt){return nt===void 0&&(nt=4),nt=nt<Number.EPSILON?Number.EPSILON:nt,nt=nt>1e4?1e4:nt,{In:function(_e){return Math.pow(_e,nt)},Out:function(_e){return 1-Math.pow(1-_e,nt)},InOut:function(_e){return _e<.5?Math.pow(_e*2,nt)/2:(1-Math.pow(2-_e*2,nt))/2+.5}}}}),now$1=function(){return performance.now()},Group=function(){function nt(){this._tweens={},this._tweensAddedDuringUpdate={}}return nt.prototype.getAll=function(){var _e=this;return Object.keys(this._tweens).map(function(et){return _e._tweens[et]})},nt.prototype.removeAll=function(){this._tweens={}},nt.prototype.add=function(_e){this._tweens[_e.getId()]=_e,this._tweensAddedDuringUpdate[_e.getId()]=_e},nt.prototype.remove=function(_e){delete this._tweens[_e.getId()],delete this._tweensAddedDuringUpdate[_e.getId()]},nt.prototype.update=function(_e,et){_e===void 0&&(_e=now$1()),et===void 0&&(et=!1);var rt=Object.keys(this._tweens);if(rt.length===0)return!1;for(;rt.length>0;){this._tweensAddedDuringUpdate={};for(var it=0;it<rt.length;it++){var st=this._tweens[rt[it]],ot=!et;st&&st.update(_e,ot)===!1&&!et&&delete this._tweens[rt[it]]}rt=Object.keys(this._tweensAddedDuringUpdate)}return!0},nt}(),Interpolation={Linear:function(nt,_e){var et=nt.length-1,rt=et*_e,it=Math.floor(rt),st=Interpolation.Utils.Linear;return _e<0?st(nt[0],nt[1],rt):_e>1?st(nt[et],nt[et-1],et-rt):st(nt[it],nt[it+1>et?et:it+1],rt-it)},Bezier:function(nt,_e){for(var et=0,rt=nt.length-1,it=Math.pow,st=Interpolation.Utils.Bernstein,ot=0;ot<=rt;ot++)et+=it(1-_e,rt-ot)*it(_e,ot)*nt[ot]*st(rt,ot);return et},CatmullRom:function(nt,_e){var et=nt.length-1,rt=et*_e,it=Math.floor(rt),st=Interpolation.Utils.CatmullRom;return nt[0]===nt[et]?(_e<0&&(it=Math.floor(rt=et*(1+_e))),st(nt[(it-1+et)%et],nt[it],nt[(it+1)%et],nt[(it+2)%et],rt-it)):_e<0?nt[0]-(st(nt[0],nt[0],nt[1],nt[1],-rt)-nt[0]):_e>1?nt[et]-(st(nt[et],nt[et],nt[et-1],nt[et-1],rt-et)-nt[et]):st(nt[it?it-1:0],nt[it],nt[et<it+1?et:it+1],nt[et<it+2?et:it+2],rt-it)},Utils:{Linear:function(nt,_e,et){return(_e-nt)*et+nt},Bernstein:function(nt,_e){var et=Interpolation.Utils.Factorial;return et(nt)/et(_e)/et(nt-_e)},Factorial:function(){var nt=[1];return function(_e){var et=1;if(nt[_e])return nt[_e];for(var rt=_e;rt>1;rt--)et*=rt;return nt[_e]=et,et}}(),CatmullRom:function(nt,_e,et,rt,it){var st=(et-nt)*.5,ot=(rt-_e)*.5,at=it*it,lt=it*at;return(2*_e-2*et+st+ot)*lt+(-3*_e+3*et-2*st-ot)*at+st*it+_e}}},Sequence=function(){function nt(){}return nt.nextId=function(){return nt._nextId++},nt._nextId=0,nt}(),mainGroup=new Group,Tween=function(){function nt(_e,et){et===void 0&&(et=mainGroup),this._object=_e,this._group=et,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Sequence.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return nt.prototype.getId=function(){return this._id},nt.prototype.isPlaying=function(){return this._isPlaying},nt.prototype.isPaused=function(){return this._isPaused},nt.prototype.getDuration=function(){return this._duration},nt.prototype.to=function(_e,et){if(et===void 0&&(et=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=_e,this._propertiesAreSetUp=!1,this._duration=et<0?0:et,this},nt.prototype.duration=function(_e){return _e===void 0&&(_e=1e3),this._duration=_e<0?0:_e,this},nt.prototype.dynamic=function(_e){return _e===void 0&&(_e=!1),this._isDynamic=_e,this},nt.prototype.start=function(_e,et){if(_e===void 0&&(_e=now$1()),et===void 0&&(et=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var rt in this._valuesStartRepeat)this._swapEndStartRepeatValues(rt),this._valuesStart[rt]=this._valuesStartRepeat[rt]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=_e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||et){if(this._propertiesAreSetUp=!0,!this._isDynamic){var it={};for(var st in this._valuesEnd)it[st]=this._valuesEnd[st];this._valuesEnd=it}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,et)}return this},nt.prototype.startFromCurrentValues=function(_e){return this.start(_e,!0)},nt.prototype._setupProperties=function(_e,et,rt,it,st){for(var ot in rt){var at=_e[ot],lt=Array.isArray(at),ct=lt?"array":typeof at,ut=!lt&&Array.isArray(rt[ot]);if(!(ct==="undefined"||ct==="function")){if(ut){var ht=rt[ot];if(ht.length===0)continue;for(var dt=[at],ft=0,pt=ht.length;ft<pt;ft+=1){var mt=this._handleRelativeValue(at,ht[ft]);if(isNaN(mt)){ut=!1,console.warn("Found invalid interpolation list. Skipping.");break}dt.push(mt)}ut&&(rt[ot]=dt)}if((ct==="object"||lt)&&at&&!ut){et[ot]=lt?[]:{};var At=at;for(var gt in At)et[ot][gt]=At[gt];it[ot]=lt?[]:{};var ht=rt[ot];if(!this._isDynamic){var bt={};for(var gt in ht)bt[gt]=ht[gt];rt[ot]=ht=bt}this._setupProperties(At,et[ot],ht,it[ot],st)}else(typeof et[ot]>"u"||st)&&(et[ot]=at),lt||(et[ot]*=1),ut?it[ot]=rt[ot].slice().reverse():it[ot]=et[ot]||0}}},nt.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},nt.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},nt.prototype.pause=function(_e){return _e===void 0&&(_e=now$1()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=_e,this._group&&this._group.remove(this),this)},nt.prototype.resume=function(_e){return _e===void 0&&(_e=now$1()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=_e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},nt.prototype.stopChainedTweens=function(){for(var _e=0,et=this._chainedTweens.length;_e<et;_e++)this._chainedTweens[_e].stop();return this},nt.prototype.group=function(_e){return _e===void 0&&(_e=mainGroup),this._group=_e,this},nt.prototype.delay=function(_e){return _e===void 0&&(_e=0),this._delayTime=_e,this},nt.prototype.repeat=function(_e){return _e===void 0&&(_e=0),this._initialRepeat=_e,this._repeat=_e,this},nt.prototype.repeatDelay=function(_e){return this._repeatDelayTime=_e,this},nt.prototype.yoyo=function(_e){return _e===void 0&&(_e=!1),this._yoyo=_e,this},nt.prototype.easing=function(_e){return _e===void 0&&(_e=Easing.Linear.None),this._easingFunction=_e,this},nt.prototype.interpolation=function(_e){return _e===void 0&&(_e=Interpolation.Linear),this._interpolationFunction=_e,this},nt.prototype.chain=function(){for(var _e=[],et=0;et<arguments.length;et++)_e[et]=arguments[et];return this._chainedTweens=_e,this},nt.prototype.onStart=function(_e){return this._onStartCallback=_e,this},nt.prototype.onEveryStart=function(_e){return this._onEveryStartCallback=_e,this},nt.prototype.onUpdate=function(_e){return this._onUpdateCallback=_e,this},nt.prototype.onRepeat=function(_e){return this._onRepeatCallback=_e,this},nt.prototype.onComplete=function(_e){return this._onCompleteCallback=_e,this},nt.prototype.onStop=function(_e){return this._onStopCallback=_e,this},nt.prototype.update=function(_e,et){var rt=this,it;if(_e===void 0&&(_e=now$1()),et===void 0&&(et=!0),this._isPaused)return!0;var st,ot=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(_e>ot)return!1;et&&this.start(_e,!0)}if(this._goToEnd=!1,_e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var at=_e-this._startTime,lt=this._duration+((it=this._repeatDelayTime)!==null&&it!==void 0?it:this._delayTime),ct=this._duration+this._repeat*lt,ut=function(){if(rt._duration===0||at>ct)return 1;var At=Math.trunc(at/lt),gt=at-At*lt,bt=Math.min(gt/rt._duration,1);return bt===0&&at===rt._duration?1:bt},ht=ut(),dt=this._easingFunction(ht);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,dt),this._onUpdateCallback&&this._onUpdateCallback(this._object,ht),this._duration===0||at>=this._duration)if(this._repeat>0){var ft=Math.min(Math.trunc((at-this._duration)/lt)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=ft);for(st in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[st]=="string"&&(this._valuesStartRepeat[st]=this._valuesStartRepeat[st]+parseFloat(this._valuesEnd[st])),this._yoyo&&this._swapEndStartRepeatValues(st),this._valuesStart[st]=this._valuesStartRepeat[st];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=lt*ft,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var pt=0,mt=this._chainedTweens.length;pt<mt;pt++)this._chainedTweens[pt].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},nt.prototype._updateProperties=function(_e,et,rt,it){for(var st in rt)if(et[st]!==void 0){var ot=et[st]||0,at=rt[st],lt=Array.isArray(_e[st]),ct=Array.isArray(at),ut=!lt&&ct;ut?_e[st]=this._interpolationFunction(at,it):typeof at=="object"&&at?this._updateProperties(_e[st],ot,at,it):(at=this._handleRelativeValue(ot,at),typeof at=="number"&&(_e[st]=ot+(at-ot)*it))}},nt.prototype._handleRelativeValue=function(_e,et){return typeof et!="string"?et:et.charAt(0)==="+"||et.charAt(0)==="-"?_e+parseFloat(et):parseFloat(et)},nt.prototype._swapEndStartRepeatValues=function(_e){var et=this._valuesStartRepeat[_e],rt=this._valuesEnd[_e];typeof rt=="string"?this._valuesStartRepeat[_e]=this._valuesStartRepeat[_e]+parseFloat(rt):this._valuesStartRepeat[_e]=this._valuesEnd[_e],this._valuesEnd[_e]=et},nt}(),TWEEN=mainGroup;TWEEN.getAll.bind(TWEEN);TWEEN.removeAll.bind(TWEEN);TWEEN.add.bind(TWEEN);TWEEN.remove.bind(TWEEN);TWEEN.update.bind(TWEEN);function earcut(nt,_e,et=2){const rt=_e&&_e.length,it=rt?_e[0]*et:nt.length;let st=linkedList(nt,0,it,et,!0);const ot=[];if(!st||st.next===st.prev)return ot;let at,lt,ct;if(rt&&(st=eliminateHoles(nt,_e,st,et)),nt.length>80*et){at=1/0,lt=1/0;let ut=-1/0,ht=-1/0;for(let dt=et;dt<it;dt+=et){const ft=nt[dt],pt=nt[dt+1];ft<at&&(at=ft),pt<lt&&(lt=pt),ft>ut&&(ut=ft),pt>ht&&(ht=pt)}ct=Math.max(ut-at,ht-lt),ct=ct!==0?32767/ct:0}return earcutLinked(st,ot,et,at,lt,ct,0),ot}function linkedList(nt,_e,et,rt,it){let st;if(it===signedArea(nt,_e,et,rt)>0)for(let ot=_e;ot<et;ot+=rt)st=insertNode(ot/rt|0,nt[ot],nt[ot+1],st);else for(let ot=et-rt;ot>=_e;ot-=rt)st=insertNode(ot/rt|0,nt[ot],nt[ot+1],st);return st&&equals$1(st,st.next)&&(removeNode(st),st=st.next),st}function filterPoints(nt,_e){if(!nt)return nt;_e||(_e=nt);let et=nt,rt;do if(rt=!1,!et.steiner&&(equals$1(et,et.next)||area(et.prev,et,et.next)===0)){if(removeNode(et),et=_e=et.prev,et===et.next)break;rt=!0}else et=et.next;while(rt||et!==_e);return _e}function earcutLinked(nt,_e,et,rt,it,st,ot){if(!nt)return;!ot&&st&&indexCurve(nt,rt,it,st);let at=nt;for(;nt.prev!==nt.next;){const lt=nt.prev,ct=nt.next;if(st?isEarHashed(nt,rt,it,st):isEar(nt)){_e.push(lt.i,nt.i,ct.i),removeNode(nt),nt=ct.next,at=ct.next;continue}if(nt=ct,nt===at){ot?ot===1?(nt=cureLocalIntersections(filterPoints(nt),_e),earcutLinked(nt,_e,et,rt,it,st,2)):ot===2&&splitEarcut(nt,_e,et,rt,it,st):earcutLinked(filterPoints(nt),_e,et,rt,it,st,1);break}}}function isEar(nt){const _e=nt.prev,et=nt,rt=nt.next;if(area(_e,et,rt)>=0)return!1;const it=_e.x,st=et.x,ot=rt.x,at=_e.y,lt=et.y,ct=rt.y,ut=it<st?it<ot?it:ot:st<ot?st:ot,ht=at<lt?at<ct?at:ct:lt<ct?lt:ct,dt=it>st?it>ot?it:ot:st>ot?st:ot,ft=at>lt?at>ct?at:ct:lt>ct?lt:ct;let pt=rt.next;for(;pt!==_e;){if(pt.x>=ut&&pt.x<=dt&&pt.y>=ht&&pt.y<=ft&&pointInTriangle(it,at,st,lt,ot,ct,pt.x,pt.y)&&area(pt.prev,pt,pt.next)>=0)return!1;pt=pt.next}return!0}function isEarHashed(nt,_e,et,rt){const it=nt.prev,st=nt,ot=nt.next;if(area(it,st,ot)>=0)return!1;const at=it.x,lt=st.x,ct=ot.x,ut=it.y,ht=st.y,dt=ot.y,ft=at<lt?at<ct?at:ct:lt<ct?lt:ct,pt=ut<ht?ut<dt?ut:dt:ht<dt?ht:dt,mt=at>lt?at>ct?at:ct:lt>ct?lt:ct,At=ut>ht?ut>dt?ut:dt:ht>dt?ht:dt,gt=zOrder(ft,pt,_e,et,rt),bt=zOrder(mt,At,_e,et,rt);let Tt=nt.prevZ,wt=nt.nextZ;for(;Tt&&Tt.z>=gt&&wt&&wt.z<=bt;){if(Tt.x>=ft&&Tt.x<=mt&&Tt.y>=pt&&Tt.y<=At&&Tt!==it&&Tt!==ot&&pointInTriangle(at,ut,lt,ht,ct,dt,Tt.x,Tt.y)&&area(Tt.prev,Tt,Tt.next)>=0||(Tt=Tt.prevZ,wt.x>=ft&&wt.x<=mt&&wt.y>=pt&&wt.y<=At&&wt!==it&&wt!==ot&&pointInTriangle(at,ut,lt,ht,ct,dt,wt.x,wt.y)&&area(wt.prev,wt,wt.next)>=0))return!1;wt=wt.nextZ}for(;Tt&&Tt.z>=gt;){if(Tt.x>=ft&&Tt.x<=mt&&Tt.y>=pt&&Tt.y<=At&&Tt!==it&&Tt!==ot&&pointInTriangle(at,ut,lt,ht,ct,dt,Tt.x,Tt.y)&&area(Tt.prev,Tt,Tt.next)>=0)return!1;Tt=Tt.prevZ}for(;wt&&wt.z<=bt;){if(wt.x>=ft&&wt.x<=mt&&wt.y>=pt&&wt.y<=At&&wt!==it&&wt!==ot&&pointInTriangle(at,ut,lt,ht,ct,dt,wt.x,wt.y)&&area(wt.prev,wt,wt.next)>=0)return!1;wt=wt.nextZ}return!0}function cureLocalIntersections(nt,_e){let et=nt;do{const rt=et.prev,it=et.next.next;!equals$1(rt,it)&&intersects(rt,et,et.next,it)&&locallyInside(rt,it)&&locallyInside(it,rt)&&(_e.push(rt.i,et.i,it.i),removeNode(et),removeNode(et.next),et=nt=it),et=et.next}while(et!==nt);return filterPoints(et)}function splitEarcut(nt,_e,et,rt,it,st){let ot=nt;do{let at=ot.next.next;for(;at!==ot.prev;){if(ot.i!==at.i&&isValidDiagonal(ot,at)){let lt=splitPolygon(ot,at);ot=filterPoints(ot,ot.next),lt=filterPoints(lt,lt.next),earcutLinked(ot,_e,et,rt,it,st,0),earcutLinked(lt,_e,et,rt,it,st,0);return}at=at.next}ot=ot.next}while(ot!==nt)}function eliminateHoles(nt,_e,et,rt){const it=[];for(let st=0,ot=_e.length;st<ot;st++){const at=_e[st]*rt,lt=st<ot-1?_e[st+1]*rt:nt.length,ct=linkedList(nt,at,lt,rt,!1);ct===ct.next&&(ct.steiner=!0),it.push(getLeftmost(ct))}it.sort(compareX);for(let st=0;st<it.length;st++)et=eliminateHole(it[st],et);return et}function compareX(nt,_e){return nt.x-_e.x}function eliminateHole(nt,_e){const et=findHoleBridge(nt,_e);if(!et)return _e;const rt=splitPolygon(et,nt);return filterPoints(rt,rt.next),filterPoints(et,et.next)}function findHoleBridge(nt,_e){let et=_e;const rt=nt.x,it=nt.y;let st=-1/0,ot;do{if(it<=et.y&&it>=et.next.y&&et.next.y!==et.y){const ht=et.x+(it-et.y)*(et.next.x-et.x)/(et.next.y-et.y);if(ht<=rt&&ht>st&&(st=ht,ot=et.x<et.next.x?et:et.next,ht===rt))return ot}et=et.next}while(et!==_e);if(!ot)return null;const at=ot,lt=ot.x,ct=ot.y;let ut=1/0;et=ot;do{if(rt>=et.x&&et.x>=lt&&rt!==et.x&&pointInTriangle(it<ct?rt:st,it,lt,ct,it<ct?st:rt,it,et.x,et.y)){const ht=Math.abs(it-et.y)/(rt-et.x);locallyInside(et,nt)&&(ht<ut||ht===ut&&(et.x>ot.x||et.x===ot.x&&sectorContainsSector(ot,et)))&&(ot=et,ut=ht)}et=et.next}while(et!==at);return ot}function sectorContainsSector(nt,_e){return area(nt.prev,nt,_e.prev)<0&&area(_e.next,nt,nt.next)<0}function indexCurve(nt,_e,et,rt){let it=nt;do it.z===0&&(it.z=zOrder(it.x,it.y,_e,et,rt)),it.prevZ=it.prev,it.nextZ=it.next,it=it.next;while(it!==nt);it.prevZ.nextZ=null,it.prevZ=null,sortLinked(it)}function sortLinked(nt){let _e,et=1;do{let rt=nt,it;nt=null;let st=null;for(_e=0;rt;){_e++;let ot=rt,at=0;for(let ct=0;ct<et&&(at++,ot=ot.nextZ,!!ot);ct++);let lt=et;for(;at>0||lt>0&&ot;)at!==0&&(lt===0||!ot||rt.z<=ot.z)?(it=rt,rt=rt.nextZ,at--):(it=ot,ot=ot.nextZ,lt--),st?st.nextZ=it:nt=it,it.prevZ=st,st=it;rt=ot}st.nextZ=null,et*=2}while(_e>1);return nt}function zOrder(nt,_e,et,rt,it){return nt=(nt-et)*it|0,_e=(_e-rt)*it|0,nt=(nt|nt<<8)&16711935,nt=(nt|nt<<4)&252645135,nt=(nt|nt<<2)&858993459,nt=(nt|nt<<1)&1431655765,_e=(_e|_e<<8)&16711935,_e=(_e|_e<<4)&252645135,_e=(_e|_e<<2)&858993459,_e=(_e|_e<<1)&1431655765,nt|_e<<1}function getLeftmost(nt){let _e=nt,et=nt;do(_e.x<et.x||_e.x===et.x&&_e.y<et.y)&&(et=_e),_e=_e.next;while(_e!==nt);return et}function pointInTriangle(nt,_e,et,rt,it,st,ot,at){return(it-ot)*(_e-at)>=(nt-ot)*(st-at)&&(nt-ot)*(rt-at)>=(et-ot)*(_e-at)&&(et-ot)*(st-at)>=(it-ot)*(rt-at)}function isValidDiagonal(nt,_e){return nt.next.i!==_e.i&&nt.prev.i!==_e.i&&!intersectsPolygon(nt,_e)&&(locallyInside(nt,_e)&&locallyInside(_e,nt)&&middleInside(nt,_e)&&(area(nt.prev,nt,_e.prev)||area(nt,_e.prev,_e))||equals$1(nt,_e)&&area(nt.prev,nt,nt.next)>0&&area(_e.prev,_e,_e.next)>0)}function area(nt,_e,et){return(_e.y-nt.y)*(et.x-_e.x)-(_e.x-nt.x)*(et.y-_e.y)}function equals$1(nt,_e){return nt.x===_e.x&&nt.y===_e.y}function intersects(nt,_e,et,rt){const it=sign$3(area(nt,_e,et)),st=sign$3(area(nt,_e,rt)),ot=sign$3(area(et,rt,nt)),at=sign$3(area(et,rt,_e));return!!(it!==st&&ot!==at||it===0&&onSegment(nt,et,_e)||st===0&&onSegment(nt,rt,_e)||ot===0&&onSegment(et,nt,rt)||at===0&&onSegment(et,_e,rt))}function onSegment(nt,_e,et){return _e.x<=Math.max(nt.x,et.x)&&_e.x>=Math.min(nt.x,et.x)&&_e.y<=Math.max(nt.y,et.y)&&_e.y>=Math.min(nt.y,et.y)}function sign$3(nt){return nt>0?1:nt<0?-1:0}function intersectsPolygon(nt,_e){let et=nt;do{if(et.i!==nt.i&&et.next.i!==nt.i&&et.i!==_e.i&&et.next.i!==_e.i&&intersects(et,et.next,nt,_e))return!0;et=et.next}while(et!==nt);return!1}function locallyInside(nt,_e){return area(nt.prev,nt,nt.next)<0?area(nt,_e,nt.next)>=0&&area(nt,nt.prev,_e)>=0:area(nt,_e,nt.prev)<0||area(nt,nt.next,_e)<0}function middleInside(nt,_e){let et=nt,rt=!1;const it=(nt.x+_e.x)/2,st=(nt.y+_e.y)/2;do et.y>st!=et.next.y>st&&et.next.y!==et.y&&it<(et.next.x-et.x)*(st-et.y)/(et.next.y-et.y)+et.x&&(rt=!rt),et=et.next;while(et!==nt);return rt}function splitPolygon(nt,_e){const et=createNode(nt.i,nt.x,nt.y),rt=createNode(_e.i,_e.x,_e.y),it=nt.next,st=_e.prev;return nt.next=_e,_e.prev=nt,et.next=it,it.prev=et,rt.next=et,et.prev=rt,st.next=rt,rt.prev=st,rt}function insertNode(nt,_e,et,rt){const it=createNode(nt,_e,et);return rt?(it.next=rt.next,it.prev=rt,rt.next.prev=it,rt.next=it):(it.prev=it,it.next=it),it}function removeNode(nt){nt.next.prev=nt.prev,nt.prev.next=nt.next,nt.prevZ&&(nt.prevZ.nextZ=nt.nextZ),nt.nextZ&&(nt.nextZ.prevZ=nt.prevZ)}function createNode(nt,_e,et){return{i:nt,x:_e,y:et,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function signedArea(nt,_e,et,rt){let it=0;for(let st=_e,ot=et-rt;st<et;st+=rt)it+=(nt[ot]-nt[st])*(nt[st+1]+nt[ot+1]),ot=st;return it}function flatten$1(nt){const _e=[],et=[],rt=nt[0][0].length;let it=0,st=0;for(const ot of nt){for(const at of ot)for(let lt=0;lt<rt;lt++)_e.push(at[lt]);st&&(it+=st,et.push(it)),st=ot.length}return{vertices:_e,holes:et,dimensions:rt}}function ascending(nt,_e){return nt==null||_e==null?NaN:nt<_e?-1:nt>_e?1:nt>=_e?0:NaN}function descending(nt,_e){return nt==null||_e==null?NaN:_e<nt?-1:_e>nt?1:_e>=nt?0:NaN}function bisector(nt){let _e,et,rt;nt.length!==2?(_e=ascending,et=(at,lt)=>ascending(nt(at),lt),rt=(at,lt)=>nt(at)-lt):(_e=nt===ascending||nt===descending?nt:zero$1,et=nt,rt=nt);function it(at,lt,ct=0,ut=at.length){if(ct<ut){if(_e(lt,lt)!==0)return ut;do{const ht=ct+ut>>>1;et(at[ht],lt)<0?ct=ht+1:ut=ht}while(ct<ut)}return ct}function st(at,lt,ct=0,ut=at.length){if(ct<ut){if(_e(lt,lt)!==0)return ut;do{const ht=ct+ut>>>1;et(at[ht],lt)<=0?ct=ht+1:ut=ht}while(ct<ut)}return ct}function ot(at,lt,ct=0,ut=at.length){const ht=it(at,lt,ct,ut-1);return ht>ct&&rt(at[ht-1],lt)>-rt(at[ht],lt)?ht-1:ht}return{left:it,center:ot,right:st}}function zero$1(){return 0}function number$2(nt){return nt===null?NaN:+nt}const ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right;bisector(number$2).center;function extent(nt,_e){let et,rt;if(_e===void 0)for(const it of nt)it!=null&&(et===void 0?it>=it&&(et=rt=it):(et>it&&(et=it),rt<it&&(rt=it)));else{let it=-1;for(let st of nt)(st=_e(st,++it,nt))!=null&&(et===void 0?st>=st&&(et=rt=st):(et>st&&(et=st),rt<st&&(rt=st)))}return[et,rt]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(_e){const et=this._partials;let rt=0;for(let it=0;it<this._n&&it<32;it++){const st=et[it],ot=_e+st,at=Math.abs(_e)<Math.abs(st)?_e-(ot-st):st-(ot-_e);at&&(et[rt++]=at),_e=ot}return et[rt]=_e,this._n=rt+1,this}valueOf(){const _e=this._partials;let et=this._n,rt,it,st,ot=0;if(et>0){for(ot=_e[--et];et>0&&(rt=ot,it=_e[--et],ot=rt+it,st=it-(ot-rt),!st););et>0&&(st<0&&_e[et-1]<0||st>0&&_e[et-1]>0)&&(it=st*2,rt=ot+it,it==rt-ot&&(ot=rt))}return ot}}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(nt,_e,et){const rt=(_e-nt)/Math.max(0,et),it=Math.floor(Math.log10(rt)),st=rt/Math.pow(10,it),ot=st>=e10?10:st>=e5?5:st>=e2?2:1;let at,lt,ct;return it<0?(ct=Math.pow(10,-it)/ot,at=Math.round(nt*ct),lt=Math.round(_e*ct),at/ct<nt&&++at,lt/ct>_e&&--lt,ct=-ct):(ct=Math.pow(10,it)*ot,at=Math.round(nt/ct),lt=Math.round(_e/ct),at*ct<nt&&++at,lt*ct>_e&&--lt),lt<at&&.5<=et&&et<2?tickSpec(nt,_e,et*2):[at,lt,ct]}function ticks(nt,_e,et){if(_e=+_e,nt=+nt,et=+et,!(et>0))return[];if(nt===_e)return[nt];const rt=_e<nt,[it,st,ot]=rt?tickSpec(_e,nt,et):tickSpec(nt,_e,et);if(!(st>=it))return[];const at=st-it+1,lt=new Array(at);if(rt)if(ot<0)for(let ct=0;ct<at;++ct)lt[ct]=(st-ct)/-ot;else for(let ct=0;ct<at;++ct)lt[ct]=(st-ct)*ot;else if(ot<0)for(let ct=0;ct<at;++ct)lt[ct]=(it+ct)/-ot;else for(let ct=0;ct<at;++ct)lt[ct]=(it+ct)*ot;return lt}function tickIncrement(nt,_e,et){return _e=+_e,nt=+nt,et=+et,tickSpec(nt,_e,et)[2]}function tickStep(nt,_e,et){_e=+_e,nt=+nt,et=+et;const rt=_e<nt,it=rt?tickIncrement(_e,nt,et):tickIncrement(nt,_e,et);return(rt?-1:1)*(it<0?1/-it:it)}function max$2(nt,_e){let et;for(const rt of nt)rt!=null&&(et<rt||et===void 0&&rt>=rt)&&(et=rt);return et}function mean(nt,_e){let et=0,rt=0;if(_e===void 0)for(let it of nt)it!=null&&(it=+it)>=it&&(++et,rt+=it);else{let it=-1;for(let st of nt)(st=_e(st,++it,nt))!=null&&(st=+st)>=st&&(++et,rt+=st)}if(et)return rt/et}function*flatten(nt){for(const _e of nt)yield*_e}function merge(nt){return Array.from(flatten(nt))}function range$1(nt,_e,et){nt=+nt,_e=+_e,et=(it=arguments.length)<2?(_e=nt,nt=0,1):it<3?1:+et;for(var rt=-1,it=Math.max(0,Math.ceil((_e-nt)/et))|0,st=new Array(it);++rt<it;)st[rt]=nt+rt*et;return st}function sum$1(nt,_e){let et=0;for(let rt of nt)(rt=+rt)&&(et+=rt);return et}var epsilon$2=1e-6,epsilon2=1e-12,pi$1=Math.PI,halfPi$1=pi$1/2,quarterPi=pi$1/4,tau$1=pi$1*2,degrees$3=180/pi$1,radians$2=pi$1/180,abs$1=Math.abs,atan$1=Math.atan,atan2$2=Math.atan2,cos$2=Math.cos,ceil$1=Math.ceil,hypot=Math.hypot,sin$2=Math.sin,sign$2=Math.sign||function(nt){return nt>0?1:nt<0?-1:0},sqrt$2=Math.sqrt;function acos$1(nt){return nt>1?0:nt<-1?pi$1:Math.acos(nt)}function asin$2(nt){return nt>1?halfPi$1:nt<-1?-halfPi$1:Math.asin(nt)}function haversin(nt){return(nt=sin$2(nt/2))*nt}function noop$1(){}function streamGeometry(nt,_e){nt&&streamGeometryType.hasOwnProperty(nt.type)&&streamGeometryType[nt.type](nt,_e)}var streamObjectType={Feature:function(nt,_e){streamGeometry(nt.geometry,_e)},FeatureCollection:function(nt,_e){for(var et=nt.features,rt=-1,it=et.length;++rt<it;)streamGeometry(et[rt].geometry,_e)}},streamGeometryType={Sphere:function(nt,_e){_e.sphere()},Point:function(nt,_e){nt=nt.coordinates,_e.point(nt[0],nt[1],nt[2])},MultiPoint:function(nt,_e){for(var et=nt.coordinates,rt=-1,it=et.length;++rt<it;)nt=et[rt],_e.point(nt[0],nt[1],nt[2])},LineString:function(nt,_e){streamLine(nt.coordinates,_e,0)},MultiLineString:function(nt,_e){for(var et=nt.coordinates,rt=-1,it=et.length;++rt<it;)streamLine(et[rt],_e,0)},Polygon:function(nt,_e){streamPolygon(nt.coordinates,_e)},MultiPolygon:function(nt,_e){for(var et=nt.coordinates,rt=-1,it=et.length;++rt<it;)streamPolygon(et[rt],_e)},GeometryCollection:function(nt,_e){for(var et=nt.geometries,rt=-1,it=et.length;++rt<it;)streamGeometry(et[rt],_e)}};function streamLine(nt,_e,et){var rt=-1,it=nt.length-et,st;for(_e.lineStart();++rt<it;)st=nt[rt],_e.point(st[0],st[1],st[2]);_e.lineEnd()}function streamPolygon(nt,_e){var et=-1,rt=nt.length;for(_e.polygonStart();++et<rt;)streamLine(nt[et],_e,1);_e.polygonEnd()}function geoStream(nt,_e){nt&&streamObjectType.hasOwnProperty(nt.type)?streamObjectType[nt.type](nt,_e):streamGeometry(nt,_e)}var areaRingSum=new Adder,areaSum=new Adder,lambda00$2,phi00$2,lambda0$2,cosPhi0$1,sinPhi0$1,areaStream={point:noop$1,lineStart:noop$1,lineEnd:noop$1,polygonStart:function(){areaRingSum=new Adder,areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){var nt=+areaRingSum;areaSum.add(nt<0?tau$1+nt:nt),this.lineStart=this.lineEnd=this.point=noop$1},sphere:function(){areaSum.add(tau$1)}};function areaRingStart(){areaStream.point=areaPointFirst}function areaRingEnd(){areaPoint(lambda00$2,phi00$2)}function areaPointFirst(nt,_e){areaStream.point=areaPoint,lambda00$2=nt,phi00$2=_e,nt*=radians$2,_e*=radians$2,lambda0$2=nt,cosPhi0$1=cos$2(_e=_e/2+quarterPi),sinPhi0$1=sin$2(_e)}function areaPoint(nt,_e){nt*=radians$2,_e*=radians$2,_e=_e/2+quarterPi;var et=nt-lambda0$2,rt=et>=0?1:-1,it=rt*et,st=cos$2(_e),ot=sin$2(_e),at=sinPhi0$1*ot,lt=cosPhi0$1*st+at*cos$2(it),ct=at*rt*sin$2(it);areaRingSum.add(atan2$2(ct,lt)),lambda0$2=nt,cosPhi0$1=st,sinPhi0$1=ot}function spherical$1(nt){return[atan2$2(nt[1],nt[0]),asin$2(nt[2])]}function cartesian$1(nt){var _e=nt[0],et=nt[1],rt=cos$2(et);return[rt*cos$2(_e),rt*sin$2(_e),sin$2(et)]}function cartesianDot$1(nt,_e){return nt[0]*_e[0]+nt[1]*_e[1]+nt[2]*_e[2]}function cartesianCross$1(nt,_e){return[nt[1]*_e[2]-nt[2]*_e[1],nt[2]*_e[0]-nt[0]*_e[2],nt[0]*_e[1]-nt[1]*_e[0]]}function cartesianAddInPlace(nt,_e){nt[0]+=_e[0],nt[1]+=_e[1],nt[2]+=_e[2]}function cartesianScale(nt,_e){return[nt[0]*_e,nt[1]*_e,nt[2]*_e]}function cartesianNormalizeInPlace(nt){var _e=sqrt$2(nt[0]*nt[0]+nt[1]*nt[1]+nt[2]*nt[2]);nt[0]/=_e,nt[1]/=_e,nt[2]/=_e}var lambda0$1,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,deltaSum,ranges,range,boundsStream$1={point:boundsPoint$1,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream$1.point=boundsRingPoint,boundsStream$1.lineStart=boundsRingStart,boundsStream$1.lineEnd=boundsRingEnd,deltaSum=new Adder,areaStream.polygonStart()},polygonEnd:function(){areaStream.polygonEnd(),boundsStream$1.point=boundsPoint$1,boundsStream$1.lineStart=boundsLineStart,boundsStream$1.lineEnd=boundsLineEnd,areaRingSum<0?(lambda0$1=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon$2?phi1=90:deltaSum<-epsilon$2&&(phi0=-90),range[0]=lambda0$1,range[1]=lambda1},sphere:function(){lambda0$1=-(lambda1=180),phi0=-(phi1=90)}};function boundsPoint$1(nt,_e){ranges.push(range=[lambda0$1=nt,lambda1=nt]),_e<phi0&&(phi0=_e),_e>phi1&&(phi1=_e)}function linePoint(nt,_e){var et=cartesian$1([nt*radians$2,_e*radians$2]);if(p0){var rt=cartesianCross$1(p0,et),it=[rt[1],-rt[0],0],st=cartesianCross$1(it,rt);cartesianNormalizeInPlace(st),st=spherical$1(st);var ot=nt-lambda2,at=ot>0?1:-1,lt=st[0]*degrees$3*at,ct,ut=abs$1(ot)>180;ut^(at*lambda2<lt&&lt<at*nt)?(ct=st[1]*degrees$3,ct>phi1&&(phi1=ct)):(lt=(lt+360)%360-180,ut^(at*lambda2<lt&&lt<at*nt)?(ct=-st[1]*degrees$3,ct<phi0&&(phi0=ct)):(_e<phi0&&(phi0=_e),_e>phi1&&(phi1=_e))),ut?nt<lambda2?angle(lambda0$1,nt)>angle(lambda0$1,lambda1)&&(lambda1=nt):angle(nt,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=nt):lambda1>=lambda0$1?(nt<lambda0$1&&(lambda0$1=nt),nt>lambda1&&(lambda1=nt)):nt>lambda2?angle(lambda0$1,nt)>angle(lambda0$1,lambda1)&&(lambda1=nt):angle(nt,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=nt)}else ranges.push(range=[lambda0$1=nt,lambda1=nt]);_e<phi0&&(phi0=_e),_e>phi1&&(phi1=_e),p0=et,lambda2=nt}function boundsLineStart(){boundsStream$1.point=linePoint}function boundsLineEnd(){range[0]=lambda0$1,range[1]=lambda1,boundsStream$1.point=boundsPoint$1,p0=null}function boundsRingPoint(nt,_e){if(p0){var et=nt-lambda2;deltaSum.add(abs$1(et)>180?et+(et>0?360:-360):et)}else lambda00$1=nt,phi00$1=_e;areaStream.point(nt,_e),linePoint(nt,_e)}function boundsRingStart(){areaStream.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream.lineEnd(),abs$1(deltaSum)>epsilon$2&&(lambda0$1=-(lambda1=180)),range[0]=lambda0$1,range[1]=lambda1,p0=null}function angle(nt,_e){return(_e-=nt)<0?_e+360:_e}function rangeCompare(nt,_e){return nt[0]-_e[0]}function rangeContains(nt,_e){return nt[0]<=nt[1]?nt[0]<=_e&&_e<=nt[1]:_e<nt[0]||nt[1]<_e}function geoBounds(nt){var _e,et,rt,it,st,ot,at;if(phi1=lambda1=-(lambda0$1=phi0=1/0),ranges=[],geoStream(nt,boundsStream$1),et=ranges.length){for(ranges.sort(rangeCompare),_e=1,rt=ranges[0],st=[rt];_e<et;++_e)it=ranges[_e],rangeContains(rt,it[0])||rangeContains(rt,it[1])?(angle(rt[0],it[1])>angle(rt[0],rt[1])&&(rt[1]=it[1]),angle(it[0],rt[1])>angle(rt[0],rt[1])&&(rt[0]=it[0])):st.push(rt=it);for(ot=-1/0,et=st.length-1,_e=0,rt=st[et];_e<=et;rt=it,++_e)it=st[_e],(at=angle(rt[1],it[0]))>ot&&(ot=at,lambda0$1=it[0],lambda1=rt[1])}return ranges=range=null,lambda0$1===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0$1,phi0],[lambda1,phi1]]}var W0,W1,X0,Y0,Z0,X1,Y1,Z1,X2,Y2,Z2,lambda00,phi00,x0$1,y0$1,z0,centroidStream={sphere:noop$1,point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd}};function centroidPoint(nt,_e){nt*=radians$2,_e*=radians$2;var et=cos$2(_e);centroidPointCartesian(et*cos$2(nt),et*sin$2(nt),sin$2(_e))}function centroidPointCartesian(nt,_e,et){++W0,X0+=(nt-X0)/W0,Y0+=(_e-Y0)/W0,Z0+=(et-Z0)/W0}function centroidLineStart(){centroidStream.point=centroidLinePointFirst}function centroidLinePointFirst(nt,_e){nt*=radians$2,_e*=radians$2;var et=cos$2(_e);x0$1=et*cos$2(nt),y0$1=et*sin$2(nt),z0=sin$2(_e),centroidStream.point=centroidLinePoint,centroidPointCartesian(x0$1,y0$1,z0)}function centroidLinePoint(nt,_e){nt*=radians$2,_e*=radians$2;var et=cos$2(_e),rt=et*cos$2(nt),it=et*sin$2(nt),st=sin$2(_e),ot=atan2$2(sqrt$2((ot=y0$1*st-z0*it)*ot+(ot=z0*rt-x0$1*st)*ot+(ot=x0$1*it-y0$1*rt)*ot),x0$1*rt+y0$1*it+z0*st);W1+=ot,X1+=ot*(x0$1+(x0$1=rt)),Y1+=ot*(y0$1+(y0$1=it)),Z1+=ot*(z0+(z0=st)),centroidPointCartesian(x0$1,y0$1,z0)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidRingPointFirst}function centroidRingEnd(){centroidRingPoint(lambda00,phi00),centroidStream.point=centroidPoint}function centroidRingPointFirst(nt,_e){lambda00=nt,phi00=_e,nt*=radians$2,_e*=radians$2,centroidStream.point=centroidRingPoint;var et=cos$2(_e);x0$1=et*cos$2(nt),y0$1=et*sin$2(nt),z0=sin$2(_e),centroidPointCartesian(x0$1,y0$1,z0)}function centroidRingPoint(nt,_e){nt*=radians$2,_e*=radians$2;var et=cos$2(_e),rt=et*cos$2(nt),it=et*sin$2(nt),st=sin$2(_e),ot=y0$1*st-z0*it,at=z0*rt-x0$1*st,lt=x0$1*it-y0$1*rt,ct=hypot(ot,at,lt),ut=asin$2(ct),ht=ct&&-ut/ct;X2.add(ht*ot),Y2.add(ht*at),Z2.add(ht*lt),W1+=ut,X1+=ut*(x0$1+(x0$1=rt)),Y1+=ut*(y0$1+(y0$1=it)),Z1+=ut*(z0+(z0=st)),centroidPointCartesian(x0$1,y0$1,z0)}function geoCentroid(nt){W0=W1=X0=Y0=Z0=X1=Y1=Z1=0,X2=new Adder,Y2=new Adder,Z2=new Adder,geoStream(nt,centroidStream);var _e=+X2,et=+Y2,rt=+Z2,it=hypot(_e,et,rt);return it<epsilon2&&(_e=X1,et=Y1,rt=Z1,W1<epsilon$2&&(_e=X0,et=Y0,rt=Z0),it=hypot(_e,et,rt),it<epsilon2)?[NaN,NaN]:[atan2$2(et,_e)*degrees$3,asin$2(rt/it)*degrees$3]}function compose(nt,_e){function et(rt,it){return rt=nt(rt,it),_e(rt[0],rt[1])}return nt.invert&&_e.invert&&(et.invert=function(rt,it){return rt=_e.invert(rt,it),rt&&nt.invert(rt[0],rt[1])}),et}function rotationIdentity(nt,_e){return abs$1(nt)>pi$1&&(nt-=Math.round(nt/tau$1)*tau$1),[nt,_e]}rotationIdentity.invert=rotationIdentity;function rotateRadians(nt,_e,et){return(nt%=tau$1)?_e||et?compose(rotationLambda(nt),rotationPhiGamma(_e,et)):rotationLambda(nt):_e||et?rotationPhiGamma(_e,et):rotationIdentity}function forwardRotationLambda(nt){return function(_e,et){return _e+=nt,abs$1(_e)>pi$1&&(_e-=Math.round(_e/tau$1)*tau$1),[_e,et]}}function rotationLambda(nt){var _e=forwardRotationLambda(nt);return _e.invert=forwardRotationLambda(-nt),_e}function rotationPhiGamma(nt,_e){var et=cos$2(nt),rt=sin$2(nt),it=cos$2(_e),st=sin$2(_e);function ot(at,lt){var ct=cos$2(lt),ut=cos$2(at)*ct,ht=sin$2(at)*ct,dt=sin$2(lt),ft=dt*et+ut*rt;return[atan2$2(ht*it-ft*st,ut*et-dt*rt),asin$2(ft*it+ht*st)]}return ot.invert=function(at,lt){var ct=cos$2(lt),ut=cos$2(at)*ct,ht=sin$2(at)*ct,dt=sin$2(lt),ft=dt*it-ht*st;return[atan2$2(ht*it+dt*st,ut*et+ft*rt),asin$2(ft*et-ut*rt)]},ot}function geoRotation(nt){nt=rotateRadians(nt[0]*radians$2,nt[1]*radians$2,nt.length>2?nt[2]*radians$2:0);function _e(et){return et=nt(et[0]*radians$2,et[1]*radians$2),et[0]*=degrees$3,et[1]*=degrees$3,et}return _e.invert=function(et){return et=nt.invert(et[0]*radians$2,et[1]*radians$2),et[0]*=degrees$3,et[1]*=degrees$3,et},_e}function circleStream(nt,_e,et,rt,it,st){if(et){var ot=cos$2(_e),at=sin$2(_e),lt=rt*et;it==null?(it=_e+rt*tau$1,st=_e-lt/2):(it=circleRadius(ot,it),st=circleRadius(ot,st),(rt>0?it<st:it>st)&&(it+=rt*tau$1));for(var ct,ut=it;rt>0?ut>st:ut<st;ut-=lt)ct=spherical$1([ot,-at*cos$2(ut),-at*sin$2(ut)]),nt.point(ct[0],ct[1])}}function circleRadius(nt,_e){_e=cartesian$1(_e),_e[0]-=nt,cartesianNormalizeInPlace(_e);var et=acos$1(-_e[1]);return((-_e[2]<0?-et:et)+tau$1-epsilon$2)%tau$1}function clipBuffer(){var nt=[],_e;return{point:function(et,rt,it){_e.push([et,rt,it])},lineStart:function(){nt.push(_e=[])},lineEnd:noop$1,rejoin:function(){nt.length>1&&nt.push(nt.pop().concat(nt.shift()))},result:function(){var et=nt;return nt=[],_e=null,et}}}function pointEqual(nt,_e){return abs$1(nt[0]-_e[0])<epsilon$2&&abs$1(nt[1]-_e[1])<epsilon$2}function Intersection(nt,_e,et,rt){this.x=nt,this.z=_e,this.o=et,this.e=rt,this.v=!1,this.n=this.p=null}function clipRejoin(nt,_e,et,rt,it){var st=[],ot=[],at,lt;if(nt.forEach(function(pt){if(!((mt=pt.length-1)<=0)){var mt,At=pt[0],gt=pt[mt],bt;if(pointEqual(At,gt)){if(!At[2]&&!gt[2]){for(it.lineStart(),at=0;at<mt;++at)it.point((At=pt[at])[0],At[1]);it.lineEnd();return}gt[0]+=2*epsilon$2}st.push(bt=new Intersection(At,pt,null,!0)),ot.push(bt.o=new Intersection(At,null,bt,!1)),st.push(bt=new Intersection(gt,pt,null,!1)),ot.push(bt.o=new Intersection(gt,null,bt,!0))}}),!!st.length){for(ot.sort(_e),link(st),link(ot),at=0,lt=ot.length;at<lt;++at)ot[at].e=et=!et;for(var ct=st[0],ut,ht;;){for(var dt=ct,ft=!0;dt.v;)if((dt=dt.n)===ct)return;ut=dt.z,it.lineStart();do{if(dt.v=dt.o.v=!0,dt.e){if(ft)for(at=0,lt=ut.length;at<lt;++at)it.point((ht=ut[at])[0],ht[1]);else rt(dt.x,dt.n.x,1,it);dt=dt.n}else{if(ft)for(ut=dt.p.z,at=ut.length-1;at>=0;--at)it.point((ht=ut[at])[0],ht[1]);else rt(dt.x,dt.p.x,-1,it);dt=dt.p}dt=dt.o,ut=dt.z,ft=!ft}while(!dt.v);it.lineEnd()}}}function link(nt){if(_e=nt.length){for(var _e,et=0,rt=nt[0],it;++et<_e;)rt.n=it=nt[et],it.p=rt,rt=it;rt.n=it=nt[0],it.p=rt}}function longitude(nt){return abs$1(nt[0])<=pi$1?nt[0]:sign$2(nt[0])*((abs$1(nt[0])+pi$1)%tau$1-pi$1)}function polygonContains(nt,_e){var et=longitude(_e),rt=_e[1],it=sin$2(rt),st=[sin$2(et),-cos$2(et),0],ot=0,at=0,lt=new Adder;it===1?rt=halfPi$1+epsilon$2:it===-1&&(rt=-halfPi$1-epsilon$2);for(var ct=0,ut=nt.length;ct<ut;++ct)if(dt=(ht=nt[ct]).length)for(var ht,dt,ft=ht[dt-1],pt=longitude(ft),mt=ft[1]/2+quarterPi,At=sin$2(mt),gt=cos$2(mt),bt=0;bt<dt;++bt,pt=wt,At=It,gt=Lt,ft=Tt){var Tt=ht[bt],wt=longitude(Tt),Rt=Tt[1]/2+quarterPi,It=sin$2(Rt),Lt=cos$2(Rt),$t=wt-pt,kt=$t>=0?1:-1,Dt=kt*$t,Ot=Dt>pi$1,zt=At*It;if(lt.add(atan2$2(zt*kt*sin$2(Dt),gt*Lt+zt*cos$2(Dt))),ot+=Ot?$t+kt*tau$1:$t,Ot^pt>=et^wt>=et){var Ht=cartesianCross$1(cartesian$1(ft),cartesian$1(Tt));cartesianNormalizeInPlace(Ht);var Yt=cartesianCross$1(st,Ht);cartesianNormalizeInPlace(Yt);var Xt=(Ot^$t>=0?-1:1)*asin$2(Yt[2]);(rt>Xt||rt===Xt&&(Ht[0]||Ht[1]))&&(at+=Ot^$t>=0?1:-1)}}return(ot<-epsilon$2||ot<epsilon$2&&lt<-epsilon2)^at&1}function clip(nt,_e,et,rt){return function(it){var st=_e(it),ot=clipBuffer(),at=_e(ot),lt=!1,ct,ut,ht,dt={point:ft,lineStart:mt,lineEnd:At,polygonStart:function(){dt.point=gt,dt.lineStart=bt,dt.lineEnd=Tt,ut=[],ct=[]},polygonEnd:function(){dt.point=ft,dt.lineStart=mt,dt.lineEnd=At,ut=merge(ut);var wt=polygonContains(ct,rt);ut.length?(lt||(it.polygonStart(),lt=!0),clipRejoin(ut,compareIntersection,wt,et,it)):wt&&(lt||(it.polygonStart(),lt=!0),it.lineStart(),et(null,null,1,it),it.lineEnd()),lt&&(it.polygonEnd(),lt=!1),ut=ct=null},sphere:function(){it.polygonStart(),it.lineStart(),et(null,null,1,it),it.lineEnd(),it.polygonEnd()}};function ft(wt,Rt){nt(wt,Rt)&&it.point(wt,Rt)}function pt(wt,Rt){st.point(wt,Rt)}function mt(){dt.point=pt,st.lineStart()}function At(){dt.point=ft,st.lineEnd()}function gt(wt,Rt){ht.push([wt,Rt]),at.point(wt,Rt)}function bt(){at.lineStart(),ht=[]}function Tt(){gt(ht[0][0],ht[0][1]),at.lineEnd();var wt=at.clean(),Rt=ot.result(),It,Lt=Rt.length,$t,kt,Dt;if(ht.pop(),ct.push(ht),ht=null,!!Lt){if(wt&1){if(kt=Rt[0],($t=kt.length-1)>0){for(lt||(it.polygonStart(),lt=!0),it.lineStart(),It=0;It<$t;++It)it.point((Dt=kt[It])[0],Dt[1]);it.lineEnd()}return}Lt>1&&wt&2&&Rt.push(Rt.pop().concat(Rt.shift())),ut.push(Rt.filter(validSegment))}}return dt}}function validSegment(nt){return nt.length>1}function compareIntersection(nt,_e){return((nt=nt.x)[0]<0?nt[1]-halfPi$1-epsilon$2:halfPi$1-nt[1])-((_e=_e.x)[0]<0?_e[1]-halfPi$1-epsilon$2:halfPi$1-_e[1])}const clipAntimeridian=clip(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi$1,-halfPi$1]);function clipAntimeridianLine(nt){var _e=NaN,et=NaN,rt=NaN,it;return{lineStart:function(){nt.lineStart(),it=1},point:function(st,ot){var at=st>0?pi$1:-pi$1,lt=abs$1(st-_e);abs$1(lt-pi$1)<epsilon$2?(nt.point(_e,et=(et+ot)/2>0?halfPi$1:-halfPi$1),nt.point(rt,et),nt.lineEnd(),nt.lineStart(),nt.point(at,et),nt.point(st,et),it=0):rt!==at&&lt>=pi$1&&(abs$1(_e-rt)<epsilon$2&&(_e-=rt*epsilon$2),abs$1(st-at)<epsilon$2&&(st-=at*epsilon$2),et=clipAntimeridianIntersect(_e,et,st,ot),nt.point(rt,et),nt.lineEnd(),nt.lineStart(),nt.point(at,et),it=0),nt.point(_e=st,et=ot),rt=at},lineEnd:function(){nt.lineEnd(),_e=et=NaN},clean:function(){return 2-it}}}function clipAntimeridianIntersect(nt,_e,et,rt){var it,st,ot=sin$2(nt-et);return abs$1(ot)>epsilon$2?atan$1((sin$2(_e)*(st=cos$2(rt))*sin$2(et)-sin$2(rt)*(it=cos$2(_e))*sin$2(nt))/(it*st*ot)):(_e+rt)/2}function clipAntimeridianInterpolate(nt,_e,et,rt){var it;if(nt==null)it=et*halfPi$1,rt.point(-pi$1,it),rt.point(0,it),rt.point(pi$1,it),rt.point(pi$1,0),rt.point(pi$1,-it),rt.point(0,-it),rt.point(-pi$1,-it),rt.point(-pi$1,0),rt.point(-pi$1,it);else if(abs$1(nt[0]-_e[0])>epsilon$2){var st=nt[0]<_e[0]?pi$1:-pi$1;it=et*st/2,rt.point(-st,it),rt.point(0,it),rt.point(st,it)}else rt.point(_e[0],_e[1])}function clipCircle(nt){var _e=cos$2(nt),et=2*radians$2,rt=_e>0,it=abs$1(_e)>epsilon$2;function st(ut,ht,dt,ft){circleStream(ft,nt,et,dt,ut,ht)}function ot(ut,ht){return cos$2(ut)*cos$2(ht)>_e}function at(ut){var ht,dt,ft,pt,mt;return{lineStart:function(){pt=ft=!1,mt=1},point:function(At,gt){var bt=[At,gt],Tt,wt=ot(At,gt),Rt=rt?wt?0:ct(At,gt):wt?ct(At+(At<0?pi$1:-pi$1),gt):0;if(!ht&&(pt=ft=wt)&&ut.lineStart(),wt!==ft&&(Tt=lt(ht,bt),(!Tt||pointEqual(ht,Tt)||pointEqual(bt,Tt))&&(bt[2]=1)),wt!==ft)mt=0,wt?(ut.lineStart(),Tt=lt(bt,ht),ut.point(Tt[0],Tt[1])):(Tt=lt(ht,bt),ut.point(Tt[0],Tt[1],2),ut.lineEnd()),ht=Tt;else if(it&&ht&&rt^wt){var It;!(Rt&dt)&&(It=lt(bt,ht,!0))&&(mt=0,rt?(ut.lineStart(),ut.point(It[0][0],It[0][1]),ut.point(It[1][0],It[1][1]),ut.lineEnd()):(ut.point(It[1][0],It[1][1]),ut.lineEnd(),ut.lineStart(),ut.point(It[0][0],It[0][1],3)))}wt&&(!ht||!pointEqual(ht,bt))&&ut.point(bt[0],bt[1]),ht=bt,ft=wt,dt=Rt},lineEnd:function(){ft&&ut.lineEnd(),ht=null},clean:function(){return mt|(pt&&ft)<<1}}}function lt(ut,ht,dt){var ft=cartesian$1(ut),pt=cartesian$1(ht),mt=[1,0,0],At=cartesianCross$1(ft,pt),gt=cartesianDot$1(At,At),bt=At[0],Tt=gt-bt*bt;if(!Tt)return!dt&&ut;var wt=_e*gt/Tt,Rt=-_e*bt/Tt,It=cartesianCross$1(mt,At),Lt=cartesianScale(mt,wt),$t=cartesianScale(At,Rt);cartesianAddInPlace(Lt,$t);var kt=It,Dt=cartesianDot$1(Lt,kt),Ot=cartesianDot$1(kt,kt),zt=Dt*Dt-Ot*(cartesianDot$1(Lt,Lt)-1);if(!(zt<0)){var Ht=sqrt$2(zt),Yt=cartesianScale(kt,(-Dt-Ht)/Ot);if(cartesianAddInPlace(Yt,Lt),Yt=spherical$1(Yt),!dt)return Yt;var Xt=ut[0],Zt=ht[0],rn=ut[1],Gt=ht[1],jt;Zt<Xt&&(jt=Xt,Xt=Zt,Zt=jt);var Kt=Zt-Xt,Jt=abs$1(Kt-pi$1)<epsilon$2,sn=Jt||Kt<epsilon$2;if(!Jt&&Gt<rn&&(jt=rn,rn=Gt,Gt=jt),sn?Jt?rn+Gt>0^Yt[1]<(abs$1(Yt[0]-Xt)<epsilon$2?rn:Gt):rn<=Yt[1]&&Yt[1]<=Gt:Kt>pi$1^(Xt<=Yt[0]&&Yt[0]<=Zt)){var hn=cartesianScale(kt,(-Dt+Ht)/Ot);return cartesianAddInPlace(hn,Lt),[Yt,spherical$1(hn)]}}}function ct(ut,ht){var dt=rt?nt:pi$1-nt,ft=0;return ut<-dt?ft|=1:ut>dt&&(ft|=2),ht<-dt?ft|=4:ht>dt&&(ft|=8),ft}return clip(ot,at,st,rt?[0,-nt]:[-pi$1,nt-pi$1])}function clipLine(nt,_e,et,rt,it,st){var ot=nt[0],at=nt[1],lt=_e[0],ct=_e[1],ut=0,ht=1,dt=lt-ot,ft=ct-at,pt;if(pt=et-ot,!(!dt&&pt>0)){if(pt/=dt,dt<0){if(pt<ut)return;pt<ht&&(ht=pt)}else if(dt>0){if(pt>ht)return;pt>ut&&(ut=pt)}if(pt=it-ot,!(!dt&&pt<0)){if(pt/=dt,dt<0){if(pt>ht)return;pt>ut&&(ut=pt)}else if(dt>0){if(pt<ut)return;pt<ht&&(ht=pt)}if(pt=rt-at,!(!ft&&pt>0)){if(pt/=ft,ft<0){if(pt<ut)return;pt<ht&&(ht=pt)}else if(ft>0){if(pt>ht)return;pt>ut&&(ut=pt)}if(pt=st-at,!(!ft&&pt<0)){if(pt/=ft,ft<0){if(pt>ht)return;pt>ut&&(ut=pt)}else if(ft>0){if(pt<ut)return;pt<ht&&(ht=pt)}return ut>0&&(nt[0]=ot+ut*dt,nt[1]=at+ut*ft),ht<1&&(_e[0]=ot+ht*dt,_e[1]=at+ht*ft),!0}}}}}var clipMax=1e9,clipMin=-clipMax;function clipRectangle(nt,_e,et,rt){function it(ct,ut){return nt<=ct&&ct<=et&&_e<=ut&&ut<=rt}function st(ct,ut,ht,dt){var ft=0,pt=0;if(ct==null||(ft=ot(ct,ht))!==(pt=ot(ut,ht))||lt(ct,ut)<0^ht>0)do dt.point(ft===0||ft===3?nt:et,ft>1?rt:_e);while((ft=(ft+ht+4)%4)!==pt);else dt.point(ut[0],ut[1])}function ot(ct,ut){return abs$1(ct[0]-nt)<epsilon$2?ut>0?0:3:abs$1(ct[0]-et)<epsilon$2?ut>0?2:1:abs$1(ct[1]-_e)<epsilon$2?ut>0?1:0:ut>0?3:2}function at(ct,ut){return lt(ct.x,ut.x)}function lt(ct,ut){var ht=ot(ct,1),dt=ot(ut,1);return ht!==dt?ht-dt:ht===0?ut[1]-ct[1]:ht===1?ct[0]-ut[0]:ht===2?ct[1]-ut[1]:ut[0]-ct[0]}return function(ct){var ut=ct,ht=clipBuffer(),dt,ft,pt,mt,At,gt,bt,Tt,wt,Rt,It,Lt={point:$t,lineStart:zt,lineEnd:Ht,polygonStart:Dt,polygonEnd:Ot};function $t(Xt,Zt){it(Xt,Zt)&&ut.point(Xt,Zt)}function kt(){for(var Xt=0,Zt=0,rn=ft.length;Zt<rn;++Zt)for(var Gt=ft[Zt],jt=1,Kt=Gt.length,Jt=Gt[0],sn,hn,an=Jt[0],pn=Jt[1];jt<Kt;++jt)sn=an,hn=pn,Jt=Gt[jt],an=Jt[0],pn=Jt[1],hn<=rt?pn>rt&&(an-sn)*(rt-hn)>(pn-hn)*(nt-sn)&&++Xt:pn<=rt&&(an-sn)*(rt-hn)<(pn-hn)*(nt-sn)&&--Xt;return Xt}function Dt(){ut=ht,dt=[],ft=[],It=!0}function Ot(){var Xt=kt(),Zt=It&&Xt,rn=(dt=merge(dt)).length;(Zt||rn)&&(ct.polygonStart(),Zt&&(ct.lineStart(),st(null,null,1,ct),ct.lineEnd()),rn&&clipRejoin(dt,at,Xt,st,ct),ct.polygonEnd()),ut=ct,dt=ft=pt=null}function zt(){Lt.point=Yt,ft&&ft.push(pt=[]),Rt=!0,wt=!1,bt=Tt=NaN}function Ht(){dt&&(Yt(mt,At),gt&&wt&&ht.rejoin(),dt.push(ht.result())),Lt.point=$t,wt&&ut.lineEnd()}function Yt(Xt,Zt){var rn=it(Xt,Zt);if(ft&&pt.push([Xt,Zt]),Rt)mt=Xt,At=Zt,gt=rn,Rt=!1,rn&&(ut.lineStart(),ut.point(Xt,Zt));else if(rn&&wt)ut.point(Xt,Zt);else{var Gt=[bt=Math.max(clipMin,Math.min(clipMax,bt)),Tt=Math.max(clipMin,Math.min(clipMax,Tt))],jt=[Xt=Math.max(clipMin,Math.min(clipMax,Xt)),Zt=Math.max(clipMin,Math.min(clipMax,Zt))];clipLine(Gt,jt,nt,_e,et,rt)?(wt||(ut.lineStart(),ut.point(Gt[0],Gt[1])),ut.point(jt[0],jt[1]),rn||ut.lineEnd(),It=!1):rn&&(ut.lineStart(),ut.point(Xt,Zt),It=!1)}bt=Xt,Tt=Zt,wt=rn}return Lt}}var lengthSum,lambda0,sinPhi0,cosPhi0,lengthStream={sphere:noop$1,point:noop$1,lineStart:lengthLineStart,lineEnd:noop$1,polygonStart:noop$1,polygonEnd:noop$1};function lengthLineStart(){lengthStream.point=lengthPointFirst,lengthStream.lineEnd=lengthLineEnd}function lengthLineEnd(){lengthStream.point=lengthStream.lineEnd=noop$1}function lengthPointFirst(nt,_e){nt*=radians$2,_e*=radians$2,lambda0=nt,sinPhi0=sin$2(_e),cosPhi0=cos$2(_e),lengthStream.point=lengthPoint}function lengthPoint(nt,_e){nt*=radians$2,_e*=radians$2;var et=sin$2(_e),rt=cos$2(_e),it=abs$1(nt-lambda0),st=cos$2(it),ot=sin$2(it),at=rt*ot,lt=cosPhi0*et-sinPhi0*rt*st,ct=sinPhi0*et+cosPhi0*rt*st;lengthSum.add(atan2$2(sqrt$2(at*at+lt*lt),ct)),lambda0=nt,sinPhi0=et,cosPhi0=rt}function length$1(nt){return lengthSum=new Adder,geoStream(nt,lengthStream),+lengthSum}var coordinates=[null,null],object$1={type:"LineString",coordinates};function geoDistance$1(nt,_e){return coordinates[0]=nt,coordinates[1]=_e,length$1(object$1)}var containsObjectType={Feature:function(nt,_e){return containsGeometry(nt.geometry,_e)},FeatureCollection:function(nt,_e){for(var et=nt.features,rt=-1,it=et.length;++rt<it;)if(containsGeometry(et[rt].geometry,_e))return!0;return!1}},containsGeometryType={Sphere:function(){return!0},Point:function(nt,_e){return containsPoint(nt.coordinates,_e)},MultiPoint:function(nt,_e){for(var et=nt.coordinates,rt=-1,it=et.length;++rt<it;)if(containsPoint(et[rt],_e))return!0;return!1},LineString:function(nt,_e){return containsLine(nt.coordinates,_e)},MultiLineString:function(nt,_e){for(var et=nt.coordinates,rt=-1,it=et.length;++rt<it;)if(containsLine(et[rt],_e))return!0;return!1},Polygon:function(nt,_e){return containsPolygon(nt.coordinates,_e)},MultiPolygon:function(nt,_e){for(var et=nt.coordinates,rt=-1,it=et.length;++rt<it;)if(containsPolygon(et[rt],_e))return!0;return!1},GeometryCollection:function(nt,_e){for(var et=nt.geometries,rt=-1,it=et.length;++rt<it;)if(containsGeometry(et[rt],_e))return!0;return!1}};function containsGeometry(nt,_e){return nt&&containsGeometryType.hasOwnProperty(nt.type)?containsGeometryType[nt.type](nt,_e):!1}function containsPoint(nt,_e){return geoDistance$1(nt,_e)===0}function containsLine(nt,_e){for(var et,rt,it,st=0,ot=nt.length;st<ot;st++){if(rt=geoDistance$1(nt[st],_e),rt===0||st>0&&(it=geoDistance$1(nt[st],nt[st-1]),it>0&&et<=it&&rt<=it&&(et+rt-it)*(1-Math.pow((et-rt)/it,2))<epsilon2*it))return!0;et=rt}return!1}function containsPolygon(nt,_e){return!!polygonContains(nt.map(ringRadians),pointRadians(_e))}function ringRadians(nt){return nt=nt.map(pointRadians),nt.pop(),nt}function pointRadians(nt){return[nt[0]*radians$2,nt[1]*radians$2]}function geoContains(nt,_e){return(nt&&containsObjectType.hasOwnProperty(nt.type)?containsObjectType[nt.type]:containsGeometry)(nt,_e)}function graticuleX(nt,_e,et){var rt=range$1(nt,_e-epsilon$2,et).concat(_e);return function(it){return rt.map(function(st){return[it,st]})}}function graticuleY(nt,_e,et){var rt=range$1(nt,_e-epsilon$2,et).concat(_e);return function(it){return rt.map(function(st){return[st,it]})}}function graticule(){var nt,_e,et,rt,it,st,ot,at,lt=10,ct=lt,ut=90,ht=360,dt,ft,pt,mt,At=2.5;function gt(){return{type:"MultiLineString",coordinates:bt()}}function bt(){return range$1(ceil$1(rt/ut)*ut,et,ut).map(pt).concat(range$1(ceil$1(at/ht)*ht,ot,ht).map(mt)).concat(range$1(ceil$1(_e/lt)*lt,nt,lt).filter(function(Tt){return abs$1(Tt%ut)>epsilon$2}).map(dt)).concat(range$1(ceil$1(st/ct)*ct,it,ct).filter(function(Tt){return abs$1(Tt%ht)>epsilon$2}).map(ft))}return gt.lines=function(){return bt().map(function(Tt){return{type:"LineString",coordinates:Tt}})},gt.outline=function(){return{type:"Polygon",coordinates:[pt(rt).concat(mt(ot).slice(1),pt(et).reverse().slice(1),mt(at).reverse().slice(1))]}},gt.extent=function(Tt){return arguments.length?gt.extentMajor(Tt).extentMinor(Tt):gt.extentMinor()},gt.extentMajor=function(Tt){return arguments.length?(rt=+Tt[0][0],et=+Tt[1][0],at=+Tt[0][1],ot=+Tt[1][1],rt>et&&(Tt=rt,rt=et,et=Tt),at>ot&&(Tt=at,at=ot,ot=Tt),gt.precision(At)):[[rt,at],[et,ot]]},gt.extentMinor=function(Tt){return arguments.length?(_e=+Tt[0][0],nt=+Tt[1][0],st=+Tt[0][1],it=+Tt[1][1],_e>nt&&(Tt=_e,_e=nt,nt=Tt),st>it&&(Tt=st,st=it,it=Tt),gt.precision(At)):[[_e,st],[nt,it]]},gt.step=function(Tt){return arguments.length?gt.stepMajor(Tt).stepMinor(Tt):gt.stepMinor()},gt.stepMajor=function(Tt){return arguments.length?(ut=+Tt[0],ht=+Tt[1],gt):[ut,ht]},gt.stepMinor=function(Tt){return arguments.length?(lt=+Tt[0],ct=+Tt[1],gt):[lt,ct]},gt.precision=function(Tt){return arguments.length?(At=+Tt,dt=graticuleX(st,it,90),ft=graticuleY(_e,nt,At),pt=graticuleX(at,ot,90),mt=graticuleY(rt,et,At),gt):At},gt.extentMajor([[-180,-90+epsilon$2],[180,90-epsilon$2]]).extentMinor([[-180,-80-epsilon$2],[180,80+epsilon$2]])}function graticule10(){return graticule()()}function geoInterpolate(nt,_e){var et=nt[0]*radians$2,rt=nt[1]*radians$2,it=_e[0]*radians$2,st=_e[1]*radians$2,ot=cos$2(rt),at=sin$2(rt),lt=cos$2(st),ct=sin$2(st),ut=ot*cos$2(et),ht=ot*sin$2(et),dt=lt*cos$2(it),ft=lt*sin$2(it),pt=2*asin$2(sqrt$2(haversin(st-rt)+ot*lt*haversin(it-et))),mt=sin$2(pt),At=pt?function(gt){var bt=sin$2(gt*=pt)/mt,Tt=sin$2(pt-gt)/mt,wt=Tt*ut+bt*dt,Rt=Tt*ht+bt*ft,It=Tt*at+bt*ct;return[atan2$2(Rt,wt)*degrees$3,atan2$2(It,sqrt$2(wt*wt+Rt*Rt))*degrees$3]}:function(){return[et*degrees$3,rt*degrees$3]};return At.distance=pt,At}const identity$2=nt=>nt;var x0=1/0,y0=x0,x1=-x0,y1=x1,boundsStream={point:boundsPoint,lineStart:noop$1,lineEnd:noop$1,polygonStart:noop$1,polygonEnd:noop$1,result:function(){var nt=[[x0,y0],[x1,y1]];return x1=y1=-(y0=x0=1/0),nt}};function boundsPoint(nt,_e){nt<x0&&(x0=nt),nt>x1&&(x1=nt),_e<y0&&(y0=_e),_e>y1&&(y1=_e)}function transformer$1(nt){return function(_e){var et=new TransformStream;for(var rt in nt)et[rt]=nt[rt];return et.stream=_e,et}}function TransformStream(){}TransformStream.prototype={constructor:TransformStream,point:function(nt,_e){this.stream.point(nt,_e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fit(nt,_e,et){var rt=nt.clipExtent&&nt.clipExtent();return nt.scale(150).translate([0,0]),rt!=null&&nt.clipExtent(null),geoStream(et,nt.stream(boundsStream)),_e(boundsStream.result()),rt!=null&&nt.clipExtent(rt),nt}function fitExtent(nt,_e,et){return fit(nt,function(rt){var it=_e[1][0]-_e[0][0],st=_e[1][1]-_e[0][1],ot=Math.min(it/(rt[1][0]-rt[0][0]),st/(rt[1][1]-rt[0][1])),at=+_e[0][0]+(it-ot*(rt[1][0]+rt[0][0]))/2,lt=+_e[0][1]+(st-ot*(rt[1][1]+rt[0][1]))/2;nt.scale(150*ot).translate([at,lt])},et)}function fitSize(nt,_e,et){return fitExtent(nt,[[0,0],_e],et)}function fitWidth(nt,_e,et){return fit(nt,function(rt){var it=+_e,st=it/(rt[1][0]-rt[0][0]),ot=(it-st*(rt[1][0]+rt[0][0]))/2,at=-st*rt[0][1];nt.scale(150*st).translate([ot,at])},et)}function fitHeight(nt,_e,et){return fit(nt,function(rt){var it=+_e,st=it/(rt[1][1]-rt[0][1]),ot=-st*rt[0][0],at=(it-st*(rt[1][1]+rt[0][1]))/2;nt.scale(150*st).translate([ot,at])},et)}var maxDepth=16,cosMinDistance=cos$2(30*radians$2);function resample(nt,_e){return+_e?resample$1(nt,_e):resampleNone(nt)}function resampleNone(nt){return transformer$1({point:function(_e,et){_e=nt(_e,et),this.stream.point(_e[0],_e[1])}})}function resample$1(nt,_e){function et(rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At){var gt=ct-rt,bt=ut-it,Tt=gt*gt+bt*bt;if(Tt>4*_e&&mt--){var wt=ot+dt,Rt=at+ft,It=lt+pt,Lt=sqrt$2(wt*wt+Rt*Rt+It*It),$t=asin$2(It/=Lt),kt=abs$1(abs$1(It)-1)<epsilon$2||abs$1(st-ht)<epsilon$2?(st+ht)/2:atan2$2(Rt,wt),Dt=nt(kt,$t),Ot=Dt[0],zt=Dt[1],Ht=Ot-rt,Yt=zt-it,Xt=bt*Ht-gt*Yt;(Xt*Xt/Tt>_e||abs$1((gt*Ht+bt*Yt)/Tt-.5)>.3||ot*dt+at*ft+lt*pt<cosMinDistance)&&(et(rt,it,st,ot,at,lt,Ot,zt,kt,wt/=Lt,Rt/=Lt,It,mt,At),At.point(Ot,zt),et(Ot,zt,kt,wt,Rt,It,ct,ut,ht,dt,ft,pt,mt,At))}}return function(rt){var it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At={point:gt,lineStart:bt,lineEnd:wt,polygonStart:function(){rt.polygonStart(),At.lineStart=Rt},polygonEnd:function(){rt.polygonEnd(),At.lineStart=bt}};function gt($t,kt){$t=nt($t,kt),rt.point($t[0],$t[1])}function bt(){ht=NaN,At.point=Tt,rt.lineStart()}function Tt($t,kt){var Dt=cartesian$1([$t,kt]),Ot=nt($t,kt);et(ht,dt,ut,ft,pt,mt,ht=Ot[0],dt=Ot[1],ut=$t,ft=Dt[0],pt=Dt[1],mt=Dt[2],maxDepth,rt),rt.point(ht,dt)}function wt(){At.point=gt,rt.lineEnd()}function Rt(){bt(),At.point=It,At.lineEnd=Lt}function It($t,kt){Tt(it=$t,kt),st=ht,ot=dt,at=ft,lt=pt,ct=mt,At.point=Tt}function Lt(){et(ht,dt,ut,ft,pt,mt,st,ot,it,at,lt,ct,maxDepth,rt),At.lineEnd=wt,wt()}return At}}var transformRadians=transformer$1({point:function(nt,_e){this.stream.point(nt*radians$2,_e*radians$2)}});function transformRotate(nt){return transformer$1({point:function(_e,et){var rt=nt(_e,et);return this.stream.point(rt[0],rt[1])}})}function scaleTranslate(nt,_e,et,rt,it){function st(ot,at){return ot*=rt,at*=it,[_e+nt*ot,et-nt*at]}return st.invert=function(ot,at){return[(ot-_e)/nt*rt,(et-at)/nt*it]},st}function scaleTranslateRotate(nt,_e,et,rt,it,st){if(!st)return scaleTranslate(nt,_e,et,rt,it);var ot=cos$2(st),at=sin$2(st),lt=ot*nt,ct=at*nt,ut=ot/nt,ht=at/nt,dt=(at*et-ot*_e)/nt,ft=(at*_e+ot*et)/nt;function pt(mt,At){return mt*=rt,At*=it,[lt*mt-ct*At+_e,et-ct*mt-lt*At]}return pt.invert=function(mt,At){return[rt*(ut*mt-ht*At+dt),it*(ft-ht*mt-ut*At)]},pt}function projection(nt){return projectionMutator(function(){return nt})()}function projectionMutator(nt){var _e,et=150,rt=480,it=250,st=0,ot=0,at=0,lt=0,ct=0,ut,ht=0,dt=1,ft=1,pt=null,mt=clipAntimeridian,At=null,gt,bt,Tt,wt=identity$2,Rt=.5,It,Lt,$t,kt,Dt;function Ot(Xt){return $t(Xt[0]*radians$2,Xt[1]*radians$2)}function zt(Xt){return Xt=$t.invert(Xt[0],Xt[1]),Xt&&[Xt[0]*degrees$3,Xt[1]*degrees$3]}Ot.stream=function(Xt){return kt&&Dt===Xt?kt:kt=transformRadians(transformRotate(ut)(mt(It(wt(Dt=Xt)))))},Ot.preclip=function(Xt){return arguments.length?(mt=Xt,pt=void 0,Yt()):mt},Ot.postclip=function(Xt){return arguments.length?(wt=Xt,At=gt=bt=Tt=null,Yt()):wt},Ot.clipAngle=function(Xt){return arguments.length?(mt=+Xt?clipCircle(pt=Xt*radians$2):(pt=null,clipAntimeridian),Yt()):pt*degrees$3},Ot.clipExtent=function(Xt){return arguments.length?(wt=Xt==null?(At=gt=bt=Tt=null,identity$2):clipRectangle(At=+Xt[0][0],gt=+Xt[0][1],bt=+Xt[1][0],Tt=+Xt[1][1]),Yt()):At==null?null:[[At,gt],[bt,Tt]]},Ot.scale=function(Xt){return arguments.length?(et=+Xt,Ht()):et},Ot.translate=function(Xt){return arguments.length?(rt=+Xt[0],it=+Xt[1],Ht()):[rt,it]},Ot.center=function(Xt){return arguments.length?(st=Xt[0]%360*radians$2,ot=Xt[1]%360*radians$2,Ht()):[st*degrees$3,ot*degrees$3]},Ot.rotate=function(Xt){return arguments.length?(at=Xt[0]%360*radians$2,lt=Xt[1]%360*radians$2,ct=Xt.length>2?Xt[2]%360*radians$2:0,Ht()):[at*degrees$3,lt*degrees$3,ct*degrees$3]},Ot.angle=function(Xt){return arguments.length?(ht=Xt%360*radians$2,Ht()):ht*degrees$3},Ot.reflectX=function(Xt){return arguments.length?(dt=Xt?-1:1,Ht()):dt<0},Ot.reflectY=function(Xt){return arguments.length?(ft=Xt?-1:1,Ht()):ft<0},Ot.precision=function(Xt){return arguments.length?(It=resample(Lt,Rt=Xt*Xt),Yt()):sqrt$2(Rt)},Ot.fitExtent=function(Xt,Zt){return fitExtent(Ot,Xt,Zt)},Ot.fitSize=function(Xt,Zt){return fitSize(Ot,Xt,Zt)},Ot.fitWidth=function(Xt,Zt){return fitWidth(Ot,Xt,Zt)},Ot.fitHeight=function(Xt,Zt){return fitHeight(Ot,Xt,Zt)};function Ht(){var Xt=scaleTranslateRotate(et,0,0,dt,ft,ht).apply(null,_e(st,ot)),Zt=scaleTranslateRotate(et,rt-Xt[0],it-Xt[1],dt,ft,ht);return ut=rotateRadians(at,lt,ct),Lt=compose(_e,Zt),$t=compose(ut,Lt),It=resample(Lt,Rt),Yt()}function Yt(){return kt=Dt=null,Ot}return function(){return _e=nt.apply(this,arguments),Ot.invert=_e.invert&&zt,Ht()}}function azimuthalInvert(nt){return function(_e,et){var rt=sqrt$2(_e*_e+et*et),it=nt(rt),st=sin$2(it),ot=cos$2(it);return[atan2$2(_e*st,rt*ot),asin$2(rt&&et*st/rt)]}}function stereographicRaw(nt,_e){var et=cos$2(_e),rt=1+cos$2(nt)*et;return[et*sin$2(nt)/rt,sin$2(_e)/rt]}stereographicRaw.invert=azimuthalInvert(function(nt){return 2*atan$1(nt)});function geoStereographic(){return projection(stereographicRaw).scale(250).clipAngle(142)}function _arrayLikeToArray$6(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles$5(nt){if(Array.isArray(nt))return nt}function _assertThisInitialized$3(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _callSuper$2(nt,_e,et){return _e=_getPrototypeOf$3(_e),_possibleConstructorReturn$2(nt,_isNativeReflectConstruct$3()?Reflect.construct(_e,[],_getPrototypeOf$3(nt).constructor):_e.apply(nt,et))}function _classCallCheck$2(nt,_e){if(!(nt instanceof _e))throw new TypeError("Cannot call a class as a function")}function _createClass$2(nt,_e,et){return Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _createForOfIteratorHelper(nt,_e){var et=typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(!et){if(Array.isArray(nt)||(et=_unsupportedIterableToArray$6(nt))||_e){et&&(nt=et);var rt=0,it=function(){};return{s:it,n:function(){return rt>=nt.length?{done:!0}:{done:!1,value:nt[rt++]}},e:function(lt){throw lt},f:it}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var st,ot=!0,at=!1;return{s:function(){et=et.call(nt)},n:function(){var lt=et.next();return ot=lt.done,lt},e:function(lt){at=!0,st=lt},f:function(){try{ot||et.return==null||et.return()}finally{if(at)throw st}}}}function _getPrototypeOf$3(nt){return _getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf$3(nt)}function _inherits$2(nt,_e){if(typeof _e!="function"&&_e!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(_e&&_e.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),_e&&_setPrototypeOf$3(nt,_e)}function _isNativeReflectConstruct$3(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$3=function(){return!!nt})()}function _iterableToArrayLimit$5(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e===0){if(Object(et)!==et)return;lt=!1}else for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest$5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _possibleConstructorReturn$2(nt,_e){if(_e&&(typeof _e=="object"||typeof _e=="function"))return _e;if(_e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$3(nt)}function _setPrototypeOf$3(nt,_e){return _setPrototypeOf$3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(et,rt){return et.__proto__=rt,et},_setPrototypeOf$3(nt,_e)}function _slicedToArray$5(nt,_e){return _arrayWithHoles$5(nt)||_iterableToArrayLimit$5(nt,_e)||_unsupportedIterableToArray$6(nt,_e)||_nonIterableRest$5()}function _unsupportedIterableToArray$6(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$6(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$6(nt,_e):void 0}}var interpolateLine=function(){var _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,rt=[],it=null;return _e.forEach(function(st){if(it){var ot=geoDistance$1(st,it)*180/Math.PI;if(ot>et)for(var at=geoInterpolate(it,st),lt=1/Math.ceil(ot/et),ct=lt;ct<1;)rt.push(at(ct)),ct+=lt}rt.push(it=st)}),rt},THREE$k=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,Float32BufferAttribute:Float32BufferAttribute$1},setAttributeFn$1=new THREE$k.BufferGeometry().setAttribute?"setAttribute":"addAttribute",GeoJsonGeometry=function(nt){function _e(et){var rt,it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,st=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;_classCallCheck$2(this,_e),rt=_callSuper$2(this,_e),rt.type="GeoJsonGeometry",rt.parameters={geoJson:et,radius:it,resolution:st};var ot=({Point:ut,MultiPoint:ht,LineString:dt,MultiLineString:ft,Polygon:pt,MultiPolygon:mt}[et.type]||function(){return[]})(et.coordinates,it),at=[],lt=[],ct=0;ot.forEach(function(At){var gt=at.length;concatGroup({indices:at,vertices:lt},At),rt.addGroup(gt,at.length-gt,ct++)}),at.length&&rt.setIndex(at),lt.length&&rt[setAttributeFn$1]("position",new THREE$k.Float32BufferAttribute(lt,3));function ut(At,gt){var bt=polar2Cartesian$2(At[1],At[0],gt),Tt=[];return[{vertices:bt,indices:Tt}]}function ht(At,gt){var bt={vertices:[],indices:[]};return At.map(function(Tt){return ut(Tt,gt)}).forEach(function(Tt){var wt=_slicedToArray$5(Tt,1),Rt=wt[0];concatGroup(bt,Rt)}),[bt]}function dt(At,gt){for(var bt=interpolateLine(At,st).map(function($t){var kt=_slicedToArray$5($t,2),Dt=kt[0],Ot=kt[1];return polar2Cartesian$2(Ot,Dt,gt)}),Tt=flatten$1([bt]),wt=Tt.vertices,Rt=Math.round(wt.length/3),It=[],Lt=1;Lt<Rt;Lt++)It.push(Lt-1,Lt);return[{vertices:wt,indices:It}]}function ft(At,gt){var bt={vertices:[],indices:[]};return At.map(function(Tt){return dt(Tt,gt)}).forEach(function(Tt){var wt=_slicedToArray$5(Tt,1),Rt=wt[0];concatGroup(bt,Rt)}),[bt]}function pt(At,gt){for(var bt=At.map(function(Xt){return interpolateLine(Xt,st).map(function(Zt){var rn=_slicedToArray$5(Zt,2),Gt=rn[0],jt=rn[1];return polar2Cartesian$2(jt,Gt,gt)})}),Tt=flatten$1(bt),wt=Tt.vertices,Rt=Tt.holes,It=Rt[0]||1/0,Lt=wt.slice(0,It*3),$t=wt.slice(It*3),kt=new Set(Rt),Dt=Math.round(wt.length/3),Ot=[],zt=[],Ht=1;Ht<Dt;Ht++)kt.has(Ht)||(Ht<It?Ot.push(Ht-1,Ht):zt.push(Ht-1-It,Ht-It));var Yt=[{indices:Ot,vertices:Lt}];return Rt.length&&Yt.push({indices:zt,vertices:$t}),Yt}function mt(At,gt){var bt={vertices:[],indices:[]},Tt={vertices:[],indices:[]};At.map(function(Rt){return pt(Rt,gt)}).forEach(function(Rt){var It=_slicedToArray$5(Rt,2),Lt=It[0],$t=It[1];concatGroup(bt,Lt),$t&&concatGroup(Tt,$t)});var wt=[bt];return Tt.vertices.length&&wt.push(Tt),wt}return rt}return _inherits$2(_e,nt),_createClass$2(_e)}(THREE$k.BufferGeometry);function concatGroup(nt,_e){var et=Math.round(nt.vertices.length/3);concatArr(nt.vertices,_e.vertices),concatArr(nt.indices,_e.indices.map(function(rt){return rt+et}))}function concatArr(nt,_e){var et=_createForOfIteratorHelper(_e),rt;try{for(et.s();!(rt=et.n()).done;){var it=rt.value;nt.push(it)}}catch(st){et.e(st)}finally{et.f()}}function polar2Cartesian$2(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,rt=(90-nt)*Math.PI/180,it=(90-_e)*Math.PI/180;return[et*Math.sin(rt)*Math.cos(it),et*Math.cos(rt),et*Math.sin(rt)*Math.sin(it)]}function computeMikkTSpaceTangents(nt,_e,et=!0){if(!_e||!_e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!nt.hasAttribute("position")||!nt.hasAttribute("normal")||!nt.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function rt(ot){if(ot.normalized||ot.isInterleavedBufferAttribute){const at=new Float32Array(ot.count*ot.itemSize);for(let lt=0,ct=0;lt<ot.count;lt++)at[ct++]=ot.getX(lt),at[ct++]=ot.getY(lt),ot.itemSize>2&&(at[ct++]=ot.getZ(lt));return at}return ot.array instanceof Float32Array?ot.array:new Float32Array(ot.array)}const it=nt.index?nt.toNonIndexed():nt,st=_e.generateTangents(rt(it.attributes.position),rt(it.attributes.normal),rt(it.attributes.uv));if(et)for(let ot=3;ot<st.length;ot+=4)st[ot]*=-1;return it.setAttribute("tangent",new BufferAttribute$1(st,4)),nt!==it&&nt.copy(it),nt}function mergeGeometries(nt,_e=!1){const et=nt[0].index!==null,rt=new Set(Object.keys(nt[0].attributes)),it=new Set(Object.keys(nt[0].morphAttributes)),st={},ot={},at=nt[0].morphTargetsRelative,lt=new BufferGeometry$1;let ct=0;for(let ut=0;ut<nt.length;++ut){const ht=nt[ut];let dt=0;if(et!==(ht.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+ut+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const ft in ht.attributes){if(!rt.has(ft))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+ut+'. All geometries must have compatible attributes; make sure "'+ft+'" attribute exists among all geometries, or in none of them.'),null;st[ft]===void 0&&(st[ft]=[]),st[ft].push(ht.attributes[ft]),dt++}if(dt!==rt.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+ut+". Make sure all geometries have the same number of attributes."),null;if(at!==ht.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+ut+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const ft in ht.morphAttributes){if(!it.has(ft))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+ut+".  .morphAttributes must be consistent throughout all geometries."),null;ot[ft]===void 0&&(ot[ft]=[]),ot[ft].push(ht.morphAttributes[ft])}if(_e){let ft;if(et)ft=ht.index.count;else if(ht.attributes.position!==void 0)ft=ht.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+ut+". The geometry must have either an index or a position attribute"),null;lt.addGroup(ct,ft,ut),ct+=ft}}if(et){let ut=0;const ht=[];for(let dt=0;dt<nt.length;++dt){const ft=nt[dt].index;for(let pt=0;pt<ft.count;++pt)ht.push(ft.getX(pt)+ut);ut+=nt[dt].attributes.position.count}lt.setIndex(ht)}for(const ut in st){const ht=mergeAttributes(st[ut]);if(!ht)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+ut+" attribute."),null;lt.setAttribute(ut,ht)}for(const ut in ot){const ht=ot[ut][0].length;if(ht===0)break;lt.morphAttributes=lt.morphAttributes||{},lt.morphAttributes[ut]=[];for(let dt=0;dt<ht;++dt){const ft=[];for(let mt=0;mt<ot[ut].length;++mt)ft.push(ot[ut][mt][dt]);const pt=mergeAttributes(ft);if(!pt)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+ut+" morphAttribute."),null;lt.morphAttributes[ut].push(pt)}}return lt}function mergeAttributes(nt){let _e,et,rt,it=-1,st=0;for(let ct=0;ct<nt.length;++ct){const ut=nt[ct];if(_e===void 0&&(_e=ut.array.constructor),_e!==ut.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(et===void 0&&(et=ut.itemSize),et!==ut.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(rt===void 0&&(rt=ut.normalized),rt!==ut.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(it===-1&&(it=ut.gpuType),it!==ut.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;st+=ut.count*et}const ot=new _e(st),at=new BufferAttribute$1(ot,et,rt);let lt=0;for(let ct=0;ct<nt.length;++ct){const ut=nt[ct];if(ut.isInterleavedBufferAttribute){const ht=lt/et;for(let dt=0,ft=ut.count;dt<ft;dt++)for(let pt=0;pt<et;pt++){const mt=ut.getComponent(dt,pt);at.setComponent(dt+ht,pt,mt)}}else ot.set(ut.array,lt);lt+=ut.count*et}return it!==void 0&&(at.gpuType=it),at}function deepCloneAttribute(nt){return nt.isInstancedInterleavedBufferAttribute||nt.isInterleavedBufferAttribute?deinterleaveAttribute(nt):nt.isInstancedBufferAttribute?new InstancedBufferAttribute$1().copy(nt):new BufferAttribute$1().copy(nt)}function interleaveAttributes(nt){let _e,et=0,rt=0;for(let ct=0,ut=nt.length;ct<ut;++ct){const ht=nt[ct];if(_e===void 0&&(_e=ht.array.constructor),_e!==ht.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;et+=ht.array.length,rt+=ht.itemSize}const it=new InterleavedBuffer$1(new _e(et),rt);let st=0;const ot=[],at=["getX","getY","getZ","getW"],lt=["setX","setY","setZ","setW"];for(let ct=0,ut=nt.length;ct<ut;ct++){const ht=nt[ct],dt=ht.itemSize,ft=ht.count,pt=new InterleavedBufferAttribute$1(it,dt,st,ht.normalized);ot.push(pt),st+=dt;for(let mt=0;mt<ft;mt++)for(let At=0;At<dt;At++)pt[lt[At]](mt,ht[at[At]](mt))}return ot}function deinterleaveAttribute(nt){const _e=nt.data.array.constructor,et=nt.count,rt=nt.itemSize,it=nt.normalized,st=new _e(et*rt);let ot;nt.isInstancedInterleavedBufferAttribute?ot=new InstancedBufferAttribute$1(st,rt,it,nt.meshPerAttribute):ot=new BufferAttribute$1(st,rt,it);for(let at=0;at<et;at++)ot.setX(at,nt.getX(at)),rt>=2&&ot.setY(at,nt.getY(at)),rt>=3&&ot.setZ(at,nt.getZ(at)),rt>=4&&ot.setW(at,nt.getW(at));return ot}function deinterleaveGeometry(nt){const _e=nt.attributes,et=nt.morphTargets,rt=new Map;for(const it in _e){const st=_e[it];st.isInterleavedBufferAttribute&&(rt.has(st)||rt.set(st,deinterleaveAttribute(st)),_e[it]=rt.get(st))}for(const it in et){const st=et[it];st.isInterleavedBufferAttribute&&(rt.has(st)||rt.set(st,deinterleaveAttribute(st)),et[it]=rt.get(st))}}function estimateBytesUsed(nt){let _e=0;for(const rt in nt.attributes){const it=nt.getAttribute(rt);_e+=it.count*it.itemSize*it.array.BYTES_PER_ELEMENT}const et=nt.getIndex();return _e+=et?et.count*et.itemSize*et.array.BYTES_PER_ELEMENT:0,_e}function mergeVertices(nt,_e=1e-4){_e=Math.max(_e,Number.EPSILON);const et={},rt=nt.getIndex(),it=nt.getAttribute("position"),st=rt?rt.count:it.count;let ot=0;const at=Object.keys(nt.attributes),lt={},ct={},ut=[],ht=["getX","getY","getZ","getW"],dt=["setX","setY","setZ","setW"];for(let bt=0,Tt=at.length;bt<Tt;bt++){const wt=at[bt],Rt=nt.attributes[wt];lt[wt]=new Rt.constructor(new Rt.array.constructor(Rt.count*Rt.itemSize),Rt.itemSize,Rt.normalized);const It=nt.morphAttributes[wt];It&&(ct[wt]||(ct[wt]=[]),It.forEach((Lt,$t)=>{const kt=new Lt.array.constructor(Lt.count*Lt.itemSize);ct[wt][$t]=new Lt.constructor(kt,Lt.itemSize,Lt.normalized)}))}const ft=_e*.5,pt=Math.log10(1/_e),mt=Math.pow(10,pt),At=ft*mt;for(let bt=0;bt<st;bt++){const Tt=rt?rt.getX(bt):bt;let wt="";for(let Rt=0,It=at.length;Rt<It;Rt++){const Lt=at[Rt],$t=nt.getAttribute(Lt),kt=$t.itemSize;for(let Dt=0;Dt<kt;Dt++)wt+=`${~~($t[ht[Dt]](Tt)*mt+At)},`}if(wt in et)ut.push(et[wt]);else{for(let Rt=0,It=at.length;Rt<It;Rt++){const Lt=at[Rt],$t=nt.getAttribute(Lt),kt=nt.morphAttributes[Lt],Dt=$t.itemSize,Ot=lt[Lt],zt=ct[Lt];for(let Ht=0;Ht<Dt;Ht++){const Yt=ht[Ht],Xt=dt[Ht];if(Ot[Xt](ot,$t[Yt](Tt)),kt)for(let Zt=0,rn=kt.length;Zt<rn;Zt++)zt[Zt][Xt](ot,kt[Zt][Yt](Tt))}}et[wt]=ot,ut.push(ot),ot++}}const gt=nt.clone();for(const bt in nt.attributes){const Tt=lt[bt];if(gt.setAttribute(bt,new Tt.constructor(Tt.array.slice(0,ot*Tt.itemSize),Tt.itemSize,Tt.normalized)),bt in ct)for(let wt=0;wt<ct[bt].length;wt++){const Rt=ct[bt][wt];gt.morphAttributes[bt][wt]=new Rt.constructor(Rt.array.slice(0,ot*Rt.itemSize),Rt.itemSize,Rt.normalized)}}return gt.setIndex(ut),gt}function toTrianglesDrawMode(nt,_e){if(_e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),nt;if(_e===TriangleFanDrawMode||_e===TriangleStripDrawMode){let et=nt.getIndex();if(et===null){const ot=[],at=nt.getAttribute("position");if(at!==void 0){for(let lt=0;lt<at.count;lt++)ot.push(lt);nt.setIndex(ot),et=nt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),nt}const rt=et.count-2,it=[];if(_e===TriangleFanDrawMode)for(let ot=1;ot<=rt;ot++)it.push(et.getX(0)),it.push(et.getX(ot)),it.push(et.getX(ot+1));else for(let ot=0;ot<rt;ot++)ot%2===0?(it.push(et.getX(ot)),it.push(et.getX(ot+1)),it.push(et.getX(ot+2))):(it.push(et.getX(ot+2)),it.push(et.getX(ot+1)),it.push(et.getX(ot)));it.length/3!==rt&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const st=nt.clone();return st.setIndex(it),st.clearGroups(),st}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_e),nt}function computeMorphedAttributes(nt){const _e=new Vector3$1,et=new Vector3$1,rt=new Vector3$1,it=new Vector3$1,st=new Vector3$1,ot=new Vector3$1,at=new Vector3$1,lt=new Vector3$1,ct=new Vector3$1;function ut(jt,Kt,Jt,sn,hn,an,pn,_n){_e.fromBufferAttribute(Kt,hn),et.fromBufferAttribute(Kt,an),rt.fromBufferAttribute(Kt,pn);const yn=jt.morphTargetInfluences;if(Jt&&yn){at.set(0,0,0),lt.set(0,0,0),ct.set(0,0,0);for(let $n=0,Jn=Jt.length;$n<Jn;$n++){const Xn=yn[$n],Vn=Jt[$n];Xn!==0&&(it.fromBufferAttribute(Vn,hn),st.fromBufferAttribute(Vn,an),ot.fromBufferAttribute(Vn,pn),sn?(at.addScaledVector(it,Xn),lt.addScaledVector(st,Xn),ct.addScaledVector(ot,Xn)):(at.addScaledVector(it.sub(_e),Xn),lt.addScaledVector(st.sub(et),Xn),ct.addScaledVector(ot.sub(rt),Xn)))}_e.add(at),et.add(lt),rt.add(ct)}jt.isSkinnedMesh&&(jt.applyBoneTransform(hn,_e),jt.applyBoneTransform(an,et),jt.applyBoneTransform(pn,rt)),_n[hn*3+0]=_e.x,_n[hn*3+1]=_e.y,_n[hn*3+2]=_e.z,_n[an*3+0]=et.x,_n[an*3+1]=et.y,_n[an*3+2]=et.z,_n[pn*3+0]=rt.x,_n[pn*3+1]=rt.y,_n[pn*3+2]=rt.z}const ht=nt.geometry,dt=nt.material;let ft,pt,mt;const At=ht.index,gt=ht.attributes.position,bt=ht.morphAttributes.position,Tt=ht.morphTargetsRelative,wt=ht.attributes.normal,Rt=ht.morphAttributes.position,It=ht.groups,Lt=ht.drawRange;let $t,kt,Dt,Ot,zt,Ht,Yt;const Xt=new Float32Array(gt.count*gt.itemSize),Zt=new Float32Array(wt.count*wt.itemSize);if(At!==null)if(Array.isArray(dt))for($t=0,Dt=It.length;$t<Dt;$t++)for(zt=It[$t],Ht=Math.max(zt.start,Lt.start),Yt=Math.min(zt.start+zt.count,Lt.start+Lt.count),kt=Ht,Ot=Yt;kt<Ot;kt+=3)ft=At.getX(kt),pt=At.getX(kt+1),mt=At.getX(kt+2),ut(nt,gt,bt,Tt,ft,pt,mt,Xt),ut(nt,wt,Rt,Tt,ft,pt,mt,Zt);else for(Ht=Math.max(0,Lt.start),Yt=Math.min(At.count,Lt.start+Lt.count),$t=Ht,Dt=Yt;$t<Dt;$t+=3)ft=At.getX($t),pt=At.getX($t+1),mt=At.getX($t+2),ut(nt,gt,bt,Tt,ft,pt,mt,Xt),ut(nt,wt,Rt,Tt,ft,pt,mt,Zt);else if(Array.isArray(dt))for($t=0,Dt=It.length;$t<Dt;$t++)for(zt=It[$t],Ht=Math.max(zt.start,Lt.start),Yt=Math.min(zt.start+zt.count,Lt.start+Lt.count),kt=Ht,Ot=Yt;kt<Ot;kt+=3)ft=kt,pt=kt+1,mt=kt+2,ut(nt,gt,bt,Tt,ft,pt,mt,Xt),ut(nt,wt,Rt,Tt,ft,pt,mt,Zt);else for(Ht=Math.max(0,Lt.start),Yt=Math.min(gt.count,Lt.start+Lt.count),$t=Ht,Dt=Yt;$t<Dt;$t+=3)ft=$t,pt=$t+1,mt=$t+2,ut(nt,gt,bt,Tt,ft,pt,mt,Xt),ut(nt,wt,Rt,Tt,ft,pt,mt,Zt);const rn=new Float32BufferAttribute$1(Xt,3),Gt=new Float32BufferAttribute$1(Zt,3);return{positionAttribute:gt,normalAttribute:wt,morphedPositionAttribute:rn,morphedNormalAttribute:Gt}}function mergeGroups(nt){if(nt.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),nt;let _e=nt.groups;if(_e=_e.sort((ot,at)=>ot.materialIndex!==at.materialIndex?ot.materialIndex-at.materialIndex:ot.start-at.start),nt.getIndex()===null){const ot=nt.getAttribute("position"),at=[];for(let lt=0;lt<ot.count;lt+=3)at.push(lt,lt+1,lt+2);nt.setIndex(at)}const et=nt.getIndex(),rt=[];for(let ot=0;ot<_e.length;ot++){const at=_e[ot],lt=at.start,ct=lt+at.count;for(let ut=lt;ut<ct;ut++)rt.push(et.getX(ut))}nt.dispose(),nt.setIndex(rt);let it=0;for(let ot=0;ot<_e.length;ot++){const at=_e[ot];at.start=it,it+=at.count}let st=_e[0];nt.groups=[st];for(let ot=1;ot<_e.length;ot++){const at=_e[ot];st.materialIndex===at.materialIndex?st.count+=at.count:(st=at,nt.groups.push(st))}return nt}function toCreasedNormals(nt,_e=Math.PI/3){const et=Math.cos(_e),rt=(1+1e-10)*100,it=[new Vector3$1,new Vector3$1,new Vector3$1],st=new Vector3$1,ot=new Vector3$1,at=new Vector3$1,lt=new Vector3$1;function ct(mt){const At=~~(mt.x*rt),gt=~~(mt.y*rt),bt=~~(mt.z*rt);return`${At},${gt},${bt}`}const ut=nt.index?nt.toNonIndexed():nt,ht=ut.attributes.position,dt={};for(let mt=0,At=ht.count/3;mt<At;mt++){const gt=3*mt,bt=it[0].fromBufferAttribute(ht,gt+0),Tt=it[1].fromBufferAttribute(ht,gt+1),wt=it[2].fromBufferAttribute(ht,gt+2);st.subVectors(wt,Tt),ot.subVectors(bt,Tt);const Rt=new Vector3$1().crossVectors(st,ot).normalize();for(let It=0;It<3;It++){const Lt=it[It],$t=ct(Lt);$t in dt||(dt[$t]=[]),dt[$t].push(Rt)}}const ft=new Float32Array(ht.count*3),pt=new BufferAttribute$1(ft,3,!1);for(let mt=0,At=ht.count/3;mt<At;mt++){const gt=3*mt,bt=it[0].fromBufferAttribute(ht,gt+0),Tt=it[1].fromBufferAttribute(ht,gt+1),wt=it[2].fromBufferAttribute(ht,gt+2);st.subVectors(wt,Tt),ot.subVectors(bt,Tt),at.crossVectors(st,ot).normalize();for(let Rt=0;Rt<3;Rt++){const It=it[Rt],Lt=ct(It),$t=dt[Lt];lt.set(0,0,0);for(let kt=0,Dt=$t.length;kt<Dt;kt++){const Ot=$t[kt];at.dot(Ot)>et&&lt.add(Ot)}lt.normalize(),pt.setXYZ(gt+Rt,lt.x,lt.y,lt.z)}}return ut.setAttribute("normal",pt),ut}const _bfg=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents,computeMorphedAttributes,deepCloneAttribute,deinterleaveAttribute,deinterleaveGeometry,estimateBytesUsed,interleaveAttributes,mergeAttributes,mergeGeometries,mergeGroups,mergeVertices,toCreasedNormals,toTrianglesDrawMode},Symbol.toStringTag,{value:"Module"}));var index$1=function(nt){return typeof nt=="function"?nt:typeof nt=="string"?function(_e){return _e[nt]}:function(_e){return nt}};function define(nt,_e,et){nt.prototype=_e.prototype=et,et.constructor=nt}function extend(nt,_e){var et=Object.create(nt.prototype);for(var rt in _e)et[rt]=_e[rt];return et}function Color$1(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color$1,color$3,{copy(nt){return Object.assign(new this.constructor,this,nt)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color$3(nt){var _e,et;return nt=(nt+"").trim().toLowerCase(),(_e=reHex.exec(nt))?(et=_e[1].length,_e=parseInt(_e[1],16),et===6?rgbn(_e):et===3?new Rgb(_e>>8&15|_e>>4&240,_e>>4&15|_e&240,(_e&15)<<4|_e&15,1):et===8?rgba$2(_e>>24&255,_e>>16&255,_e>>8&255,(_e&255)/255):et===4?rgba$2(_e>>12&15|_e>>8&240,_e>>8&15|_e>>4&240,_e>>4&15|_e&240,((_e&15)<<4|_e&15)/255):null):(_e=reRgbInteger.exec(nt))?new Rgb(_e[1],_e[2],_e[3],1):(_e=reRgbPercent.exec(nt))?new Rgb(_e[1]*255/100,_e[2]*255/100,_e[3]*255/100,1):(_e=reRgbaInteger.exec(nt))?rgba$2(_e[1],_e[2],_e[3],_e[4]):(_e=reRgbaPercent.exec(nt))?rgba$2(_e[1]*255/100,_e[2]*255/100,_e[3]*255/100,_e[4]):(_e=reHslPercent.exec(nt))?hsla$2(_e[1],_e[2]/100,_e[3]/100,1):(_e=reHslaPercent.exec(nt))?hsla$2(_e[1],_e[2]/100,_e[3]/100,_e[4]):named.hasOwnProperty(nt)?rgbn(named[nt]):nt==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(nt){return new Rgb(nt>>16&255,nt>>8&255,nt&255,1)}function rgba$2(nt,_e,et,rt){return rt<=0&&(nt=_e=et=NaN),new Rgb(nt,_e,et,rt)}function rgbConvert(nt){return nt instanceof Color$1||(nt=color$3(nt)),nt?(nt=nt.rgb(),new Rgb(nt.r,nt.g,nt.b,nt.opacity)):new Rgb}function rgb$2(nt,_e,et,rt){return arguments.length===1?rgbConvert(nt):new Rgb(nt,_e,et,rt??1)}function Rgb(nt,_e,et,rt){this.r=+nt,this.g=+_e,this.b=+et,this.opacity=+rt}define(Rgb,rgb$2,extend(Color$1,{brighter(nt){return nt=nt==null?brighter:Math.pow(brighter,nt),new Rgb(this.r*nt,this.g*nt,this.b*nt,this.opacity)},darker(nt){return nt=nt==null?darker:Math.pow(darker,nt),new Rgb(this.r*nt,this.g*nt,this.b*nt,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex$1(this.r)}${hex$1(this.g)}${hex$1(this.b)}`}function rgb_formatHex8(){return`#${hex$1(this.r)}${hex$1(this.g)}${hex$1(this.b)}${hex$1((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const nt=clampa(this.opacity);return`${nt===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${nt===1?")":`, ${nt})`}`}function clampa(nt){return isNaN(nt)?1:Math.max(0,Math.min(1,nt))}function clampi(nt){return Math.max(0,Math.min(255,Math.round(nt)||0))}function hex$1(nt){return nt=clampi(nt),(nt<16?"0":"")+nt.toString(16)}function hsla$2(nt,_e,et,rt){return rt<=0?nt=_e=et=NaN:et<=0||et>=1?nt=_e=NaN:_e<=0&&(nt=NaN),new Hsl(nt,_e,et,rt)}function hslConvert(nt){if(nt instanceof Hsl)return new Hsl(nt.h,nt.s,nt.l,nt.opacity);if(nt instanceof Color$1||(nt=color$3(nt)),!nt)return new Hsl;if(nt instanceof Hsl)return nt;nt=nt.rgb();var _e=nt.r/255,et=nt.g/255,rt=nt.b/255,it=Math.min(_e,et,rt),st=Math.max(_e,et,rt),ot=NaN,at=st-it,lt=(st+it)/2;return at?(_e===st?ot=(et-rt)/at+(et<rt)*6:et===st?ot=(rt-_e)/at+2:ot=(_e-et)/at+4,at/=lt<.5?st+it:2-st-it,ot*=60):at=lt>0&&lt<1?0:ot,new Hsl(ot,at,lt,nt.opacity)}function hsl$1(nt,_e,et,rt){return arguments.length===1?hslConvert(nt):new Hsl(nt,_e,et,rt??1)}function Hsl(nt,_e,et,rt){this.h=+nt,this.s=+_e,this.l=+et,this.opacity=+rt}define(Hsl,hsl$1,extend(Color$1,{brighter(nt){return nt=nt==null?brighter:Math.pow(brighter,nt),new Hsl(this.h,this.s,this.l*nt,this.opacity)},darker(nt){return nt=nt==null?darker:Math.pow(darker,nt),new Hsl(this.h,this.s,this.l*nt,this.opacity)},rgb(){var nt=this.h%360+(this.h<0)*360,_e=isNaN(nt)||isNaN(this.s)?0:this.s,et=this.l,rt=et+(et<.5?et:1-et)*_e,it=2*et-rt;return new Rgb(hsl2rgb(nt>=240?nt-240:nt+120,it,rt),hsl2rgb(nt,it,rt),hsl2rgb(nt<120?nt+240:nt-120,it,rt),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const nt=clampa(this.opacity);return`${nt===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${nt===1?")":`, ${nt})`}`}}));function clamph(nt){return nt=(nt||0)%360,nt<0?nt+360:nt}function clampt(nt){return Math.max(0,Math.min(1,nt||0))}function hsl2rgb(nt,_e,et){return(nt<60?_e+(et-_e)*nt/60:nt<180?et:nt<240?_e+(et-_e)*(240-nt)/60:_e)*255}function _typeof(nt){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},_typeof(nt)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(nt,_e){if(nt=nt||"",_e=_e||{},nt instanceof tinycolor)return nt;if(!(this instanceof tinycolor))return new tinycolor(nt,_e);var et=inputToRGB(nt);this._originalInput=nt,this._r=et.r,this._g=et.g,this._b=et.b,this._a=et.a,this._roundA=Math.round(100*this._a)/100,this._format=_e.format||et.format,this._gradientType=_e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=et.ok}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var _e=this.toRgb();return(_e.r*299+_e.g*587+_e.b*114)/1e3},getLuminance:function(){var _e=this.toRgb(),et,rt,it,st,ot,at;return et=_e.r/255,rt=_e.g/255,it=_e.b/255,et<=.03928?st=et/12.92:st=Math.pow((et+.055)/1.055,2.4),rt<=.03928?ot=rt/12.92:ot=Math.pow((rt+.055)/1.055,2.4),it<=.03928?at=it/12.92:at=Math.pow((it+.055)/1.055,2.4),.2126*st+.7152*ot+.0722*at},setAlpha:function(_e){return this._a=boundAlpha(_e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var _e=rgbToHsv(this._r,this._g,this._b);return{h:_e.h*360,s:_e.s,v:_e.v,a:this._a}},toHsvString:function(){var _e=rgbToHsv(this._r,this._g,this._b),et=Math.round(_e.h*360),rt=Math.round(_e.s*100),it=Math.round(_e.v*100);return this._a==1?"hsv("+et+", "+rt+"%, "+it+"%)":"hsva("+et+", "+rt+"%, "+it+"%, "+this._roundA+")"},toHsl:function(){var _e=rgbToHsl$1(this._r,this._g,this._b);return{h:_e.h*360,s:_e.s,l:_e.l,a:this._a}},toHslString:function(){var _e=rgbToHsl$1(this._r,this._g,this._b),et=Math.round(_e.h*360),rt=Math.round(_e.s*100),it=Math.round(_e.l*100);return this._a==1?"hsl("+et+", "+rt+"%, "+it+"%)":"hsla("+et+", "+rt+"%, "+it+"%, "+this._roundA+")"},toHex:function(_e){return rgbToHex(this._r,this._g,this._b,_e)},toHexString:function(_e){return"#"+this.toHex(_e)},toHex8:function(_e){return rgbaToHex(this._r,this._g,this._b,this._a,_e)},toHex8String:function(_e){return"#"+this.toHex8(_e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(bound01(this._r,255)*100)+"%",g:Math.round(bound01(this._g,255)*100)+"%",b:Math.round(bound01(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%)":"rgba("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function(_e){var et="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),rt=et,it=this._gradientType?"GradientType = 1, ":"";if(_e){var st=tinycolor(_e);rt="#"+rgbaToArgbHex(st._r,st._g,st._b,st._a)}return"progid:DXImageTransform.Microsoft.gradient("+it+"startColorstr="+et+",endColorstr="+rt+")"},toString:function(_e){var et=!!_e;_e=_e||this._format;var rt=!1,it=this._a<1&&this._a>=0,st=!et&&it&&(_e==="hex"||_e==="hex6"||_e==="hex3"||_e==="hex4"||_e==="hex8"||_e==="name");return st?_e==="name"&&this._a===0?this.toName():this.toRgbString():(_e==="rgb"&&(rt=this.toRgbString()),_e==="prgb"&&(rt=this.toPercentageRgbString()),(_e==="hex"||_e==="hex6")&&(rt=this.toHexString()),_e==="hex3"&&(rt=this.toHexString(!0)),_e==="hex4"&&(rt=this.toHex8String(!0)),_e==="hex8"&&(rt=this.toHex8String()),_e==="name"&&(rt=this.toName()),_e==="hsl"&&(rt=this.toHslString()),_e==="hsv"&&(rt=this.toHsvString()),rt||this.toHexString())},clone:function(){return tinycolor(this.toString())},_applyModification:function(_e,et){var rt=_e.apply(null,[this].concat([].slice.call(et)));return this._r=rt._r,this._g=rt._g,this._b=rt._b,this.setAlpha(rt._a),this},lighten:function(){return this._applyModification(_lighten,arguments)},brighten:function(){return this._applyModification(_brighten,arguments)},darken:function(){return this._applyModification(_darken,arguments)},desaturate:function(){return this._applyModification(_desaturate,arguments)},saturate:function(){return this._applyModification(_saturate,arguments)},greyscale:function(){return this._applyModification(_greyscale,arguments)},spin:function(){return this._applyModification(_spin,arguments)},_applyCombination:function(_e,et){return _e.apply(null,[this].concat([].slice.call(et)))},analogous:function(){return this._applyCombination(_analogous,arguments)},complement:function(){return this._applyCombination(_complement,arguments)},monochromatic:function(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(_splitcomplement,arguments)},triad:function(){return this._applyCombination(polyad,[3])},tetrad:function(){return this._applyCombination(polyad,[4])}};tinycolor.fromRatio=function(nt,_e){if(_typeof(nt)=="object"){var et={};for(var rt in nt)nt.hasOwnProperty(rt)&&(rt==="a"?et[rt]=nt[rt]:et[rt]=convertToPercentage(nt[rt]));nt=et}return tinycolor(nt,_e)};function inputToRGB(nt){var _e={r:0,g:0,b:0},et=1,rt=null,it=null,st=null,ot=!1,at=!1;return typeof nt=="string"&&(nt=stringInputToObject(nt)),_typeof(nt)=="object"&&(isValidCSSUnit(nt.r)&&isValidCSSUnit(nt.g)&&isValidCSSUnit(nt.b)?(_e=rgbToRgb(nt.r,nt.g,nt.b),ot=!0,at=String(nt.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(nt.h)&&isValidCSSUnit(nt.s)&&isValidCSSUnit(nt.v)?(rt=convertToPercentage(nt.s),it=convertToPercentage(nt.v),_e=hsvToRgb(nt.h,rt,it),ot=!0,at="hsv"):isValidCSSUnit(nt.h)&&isValidCSSUnit(nt.s)&&isValidCSSUnit(nt.l)&&(rt=convertToPercentage(nt.s),st=convertToPercentage(nt.l),_e=hslToRgb$1(nt.h,rt,st),ot=!0,at="hsl"),nt.hasOwnProperty("a")&&(et=nt.a)),et=boundAlpha(et),{ok:ot,format:nt.format||at,r:Math.min(255,Math.max(_e.r,0)),g:Math.min(255,Math.max(_e.g,0)),b:Math.min(255,Math.max(_e.b,0)),a:et}}function rgbToRgb(nt,_e,et){return{r:bound01(nt,255)*255,g:bound01(_e,255)*255,b:bound01(et,255)*255}}function rgbToHsl$1(nt,_e,et){nt=bound01(nt,255),_e=bound01(_e,255),et=bound01(et,255);var rt=Math.max(nt,_e,et),it=Math.min(nt,_e,et),st,ot,at=(rt+it)/2;if(rt==it)st=ot=0;else{var lt=rt-it;switch(ot=at>.5?lt/(2-rt-it):lt/(rt+it),rt){case nt:st=(_e-et)/lt+(_e<et?6:0);break;case _e:st=(et-nt)/lt+2;break;case et:st=(nt-_e)/lt+4;break}st/=6}return{h:st,s:ot,l:at}}function hslToRgb$1(nt,_e,et){var rt,it,st;nt=bound01(nt,360),_e=bound01(_e,100),et=bound01(et,100);function ot(ct,ut,ht){return ht<0&&(ht+=1),ht>1&&(ht-=1),ht<1/6?ct+(ut-ct)*6*ht:ht<1/2?ut:ht<2/3?ct+(ut-ct)*(2/3-ht)*6:ct}if(_e===0)rt=it=st=et;else{var at=et<.5?et*(1+_e):et+_e-et*_e,lt=2*et-at;rt=ot(lt,at,nt+1/3),it=ot(lt,at,nt),st=ot(lt,at,nt-1/3)}return{r:rt*255,g:it*255,b:st*255}}function rgbToHsv(nt,_e,et){nt=bound01(nt,255),_e=bound01(_e,255),et=bound01(et,255);var rt=Math.max(nt,_e,et),it=Math.min(nt,_e,et),st,ot,at=rt,lt=rt-it;if(ot=rt===0?0:lt/rt,rt==it)st=0;else{switch(rt){case nt:st=(_e-et)/lt+(_e<et?6:0);break;case _e:st=(et-nt)/lt+2;break;case et:st=(nt-_e)/lt+4;break}st/=6}return{h:st,s:ot,v:at}}function hsvToRgb(nt,_e,et){nt=bound01(nt,360)*6,_e=bound01(_e,100),et=bound01(et,100);var rt=Math.floor(nt),it=nt-rt,st=et*(1-_e),ot=et*(1-it*_e),at=et*(1-(1-it)*_e),lt=rt%6,ct=[et,ot,st,st,at,et][lt],ut=[at,et,et,ot,st,st][lt],ht=[st,st,at,et,et,ot][lt];return{r:ct*255,g:ut*255,b:ht*255}}function rgbToHex(nt,_e,et,rt){var it=[pad2(Math.round(nt).toString(16)),pad2(Math.round(_e).toString(16)),pad2(Math.round(et).toString(16))];return rt&&it[0].charAt(0)==it[0].charAt(1)&&it[1].charAt(0)==it[1].charAt(1)&&it[2].charAt(0)==it[2].charAt(1)?it[0].charAt(0)+it[1].charAt(0)+it[2].charAt(0):it.join("")}function rgbaToHex(nt,_e,et,rt,it){var st=[pad2(Math.round(nt).toString(16)),pad2(Math.round(_e).toString(16)),pad2(Math.round(et).toString(16)),pad2(convertDecimalToHex(rt))];return it&&st[0].charAt(0)==st[0].charAt(1)&&st[1].charAt(0)==st[1].charAt(1)&&st[2].charAt(0)==st[2].charAt(1)&&st[3].charAt(0)==st[3].charAt(1)?st[0].charAt(0)+st[1].charAt(0)+st[2].charAt(0)+st[3].charAt(0):st.join("")}function rgbaToArgbHex(nt,_e,et,rt){var it=[pad2(convertDecimalToHex(rt)),pad2(Math.round(nt).toString(16)),pad2(Math.round(_e).toString(16)),pad2(Math.round(et).toString(16))];return it.join("")}tinycolor.equals=function(nt,_e){return!nt||!_e?!1:tinycolor(nt).toRgbString()==tinycolor(_e).toRgbString()};tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function _desaturate(nt,_e){_e=_e===0?0:_e||10;var et=tinycolor(nt).toHsl();return et.s-=_e/100,et.s=clamp01(et.s),tinycolor(et)}function _saturate(nt,_e){_e=_e===0?0:_e||10;var et=tinycolor(nt).toHsl();return et.s+=_e/100,et.s=clamp01(et.s),tinycolor(et)}function _greyscale(nt){return tinycolor(nt).desaturate(100)}function _lighten(nt,_e){_e=_e===0?0:_e||10;var et=tinycolor(nt).toHsl();return et.l+=_e/100,et.l=clamp01(et.l),tinycolor(et)}function _brighten(nt,_e){_e=_e===0?0:_e||10;var et=tinycolor(nt).toRgb();return et.r=Math.max(0,Math.min(255,et.r-Math.round(255*-(_e/100)))),et.g=Math.max(0,Math.min(255,et.g-Math.round(255*-(_e/100)))),et.b=Math.max(0,Math.min(255,et.b-Math.round(255*-(_e/100)))),tinycolor(et)}function _darken(nt,_e){_e=_e===0?0:_e||10;var et=tinycolor(nt).toHsl();return et.l-=_e/100,et.l=clamp01(et.l),tinycolor(et)}function _spin(nt,_e){var et=tinycolor(nt).toHsl(),rt=(et.h+_e)%360;return et.h=rt<0?360+rt:rt,tinycolor(et)}function _complement(nt){var _e=tinycolor(nt).toHsl();return _e.h=(_e.h+180)%360,tinycolor(_e)}function polyad(nt,_e){if(isNaN(_e)||_e<=0)throw new Error("Argument to polyad must be a positive number");for(var et=tinycolor(nt).toHsl(),rt=[tinycolor(nt)],it=360/_e,st=1;st<_e;st++)rt.push(tinycolor({h:(et.h+st*it)%360,s:et.s,l:et.l}));return rt}function _splitcomplement(nt){var _e=tinycolor(nt).toHsl(),et=_e.h;return[tinycolor(nt),tinycolor({h:(et+72)%360,s:_e.s,l:_e.l}),tinycolor({h:(et+216)%360,s:_e.s,l:_e.l})]}function _analogous(nt,_e,et){_e=_e||6,et=et||30;var rt=tinycolor(nt).toHsl(),it=360/et,st=[tinycolor(nt)];for(rt.h=(rt.h-(it*_e>>1)+720)%360;--_e;)rt.h=(rt.h+it)%360,st.push(tinycolor(rt));return st}function _monochromatic(nt,_e){_e=_e||6;for(var et=tinycolor(nt).toHsv(),rt=et.h,it=et.s,st=et.v,ot=[],at=1/_e;_e--;)ot.push(tinycolor({h:rt,s:it,v:st})),st=(st+at)%1;return ot}tinycolor.mix=function(nt,_e,et){et=et===0?0:et||50;var rt=tinycolor(nt).toRgb(),it=tinycolor(_e).toRgb(),st=et/100,ot={r:(it.r-rt.r)*st+rt.r,g:(it.g-rt.g)*st+rt.g,b:(it.b-rt.b)*st+rt.b,a:(it.a-rt.a)*st+rt.a};return tinycolor(ot)};tinycolor.readability=function(nt,_e){var et=tinycolor(nt),rt=tinycolor(_e);return(Math.max(et.getLuminance(),rt.getLuminance())+.05)/(Math.min(et.getLuminance(),rt.getLuminance())+.05)};tinycolor.isReadable=function(nt,_e,et){var rt=tinycolor.readability(nt,_e),it,st;switch(st=!1,it=validateWCAG2Parms(et),it.level+it.size){case"AAsmall":case"AAAlarge":st=rt>=4.5;break;case"AAlarge":st=rt>=3;break;case"AAAsmall":st=rt>=7;break}return st};tinycolor.mostReadable=function(nt,_e,et){var rt=null,it=0,st,ot,at,lt;et=et||{},ot=et.includeFallbackColors,at=et.level,lt=et.size;for(var ct=0;ct<_e.length;ct++)st=tinycolor.readability(nt,_e[ct]),st>it&&(it=st,rt=tinycolor(_e[ct]));return tinycolor.isReadable(nt,rt,{level:at,size:lt})||!ot?rt:(et.includeFallbackColors=!1,tinycolor.mostReadable(nt,["#fff","#000"],et))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names);function flip(nt){var _e={};for(var et in nt)nt.hasOwnProperty(et)&&(_e[nt[et]]=et);return _e}function boundAlpha(nt){return nt=parseFloat(nt),(isNaN(nt)||nt<0||nt>1)&&(nt=1),nt}function bound01(nt,_e){isOnePointZero(nt)&&(nt="100%");var et=isPercentage(nt);return nt=Math.min(_e,Math.max(0,parseFloat(nt))),et&&(nt=parseInt(nt*_e,10)/100),Math.abs(nt-_e)<1e-6?1:nt%_e/parseFloat(_e)}function clamp01(nt){return Math.min(1,Math.max(0,nt))}function parseIntFromHex(nt){return parseInt(nt,16)}function isOnePointZero(nt){return typeof nt=="string"&&nt.indexOf(".")!=-1&&parseFloat(nt)===1}function isPercentage(nt){return typeof nt=="string"&&nt.indexOf("%")!=-1}function pad2(nt){return nt.length==1?"0"+nt:""+nt}function convertToPercentage(nt){return nt<=1&&(nt=nt*100+"%"),nt}function convertDecimalToHex(nt){return Math.round(parseFloat(nt)*255).toString(16)}function convertHexToDecimal(nt){return parseIntFromHex(nt)/255}var matchers=function(){var nt="[-\\+]?\\d+%?",_e="[-\\+]?\\d*\\.\\d+%?",et="(?:"+_e+")|(?:"+nt+")",rt="[\\s|\\(]+("+et+")[,|\\s]+("+et+")[,|\\s]+("+et+")\\s*\\)?",it="[\\s|\\(]+("+et+")[,|\\s]+("+et+")[,|\\s]+("+et+")[,|\\s]+("+et+")\\s*\\)?";return{CSS_UNIT:new RegExp(et),rgb:new RegExp("rgb"+rt),rgba:new RegExp("rgba"+it),hsl:new RegExp("hsl"+rt),hsla:new RegExp("hsla"+it),hsv:new RegExp("hsv"+rt),hsva:new RegExp("hsva"+it),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit(nt){return!!matchers.CSS_UNIT.exec(nt)}function stringInputToObject(nt){nt=nt.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var _e=!1;if(names[nt])nt=names[nt],_e=!0;else if(nt=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var et;return(et=matchers.rgb.exec(nt))?{r:et[1],g:et[2],b:et[3]}:(et=matchers.rgba.exec(nt))?{r:et[1],g:et[2],b:et[3],a:et[4]}:(et=matchers.hsl.exec(nt))?{h:et[1],s:et[2],l:et[3]}:(et=matchers.hsla.exec(nt))?{h:et[1],s:et[2],l:et[3],a:et[4]}:(et=matchers.hsv.exec(nt))?{h:et[1],s:et[2],v:et[3]}:(et=matchers.hsva.exec(nt))?{h:et[1],s:et[2],v:et[3],a:et[4]}:(et=matchers.hex8.exec(nt))?{r:parseIntFromHex(et[1]),g:parseIntFromHex(et[2]),b:parseIntFromHex(et[3]),a:convertHexToDecimal(et[4]),format:_e?"name":"hex8"}:(et=matchers.hex6.exec(nt))?{r:parseIntFromHex(et[1]),g:parseIntFromHex(et[2]),b:parseIntFromHex(et[3]),format:_e?"name":"hex"}:(et=matchers.hex4.exec(nt))?{r:parseIntFromHex(et[1]+""+et[1]),g:parseIntFromHex(et[2]+""+et[2]),b:parseIntFromHex(et[3]+""+et[3]),a:convertHexToDecimal(et[4]+""+et[4]),format:_e?"name":"hex8"}:(et=matchers.hex3.exec(nt))?{r:parseIntFromHex(et[1]+""+et[1]),g:parseIntFromHex(et[2]+""+et[2]),b:parseIntFromHex(et[3]+""+et[3]),format:_e?"name":"hex"}:!1}function validateWCAG2Parms(nt){var _e,et;return nt=nt||{level:"AA",size:"small"},_e=(nt.level||"AA").toUpperCase(),et=(nt.size||"small").toLowerCase(),_e!=="AA"&&_e!=="AAA"&&(_e="AA"),et!=="small"&&et!=="large"&&(et="small"),{level:_e,size:et}}function _arrayLikeToArray$5(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles$4(nt){if(Array.isArray(nt))return nt}function _arrayWithoutHoles$5(nt){if(Array.isArray(nt))return _arrayLikeToArray$5(nt)}function _iterableToArray$5(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _iterableToArrayLimit$4(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e!==0)for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest$4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread$5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _objectWithoutProperties$3(nt,_e){if(nt==null)return{};var et,rt,it=_objectWithoutPropertiesLoose$3(nt,_e);if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(rt=0;rt<st.length;rt++)et=st[rt],_e.includes(et)||{}.propertyIsEnumerable.call(nt,et)&&(it[et]=nt[et])}return it}function _objectWithoutPropertiesLoose$3(nt,_e){if(nt==null)return{};var et={};for(var rt in nt)if({}.hasOwnProperty.call(nt,rt)){if(_e.includes(rt))continue;et[rt]=nt[rt]}return et}function _slicedToArray$4(nt,_e){return _arrayWithHoles$4(nt)||_iterableToArrayLimit$4(nt,_e)||_unsupportedIterableToArray$5(nt,_e)||_nonIterableRest$4()}function _toConsumableArray$5(nt){return _arrayWithoutHoles$5(nt)||_iterableToArray$5(nt)||_unsupportedIterableToArray$5(nt)||_nonIterableSpread$5()}function _toPrimitive$4(nt,_e){if(typeof nt!="object"||!nt)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e);if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(nt)}function _toPropertyKey$4(nt){var _e=_toPrimitive$4(nt,"string");return typeof _e=="symbol"?_e:_e+""}function _unsupportedIterableToArray$5(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$5(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$5(nt,_e):void 0}}var index=function(){var nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,rt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,it=(_e instanceof Array?_e.length?_e:[void 0]:[_e]).map(function(at){return{keyAccessor:at,isProp:!(at instanceof Function)}}),st=nt.reduce(function(at,lt){var ct=at,ut=lt;return it.forEach(function(ht,dt){var ft=ht.keyAccessor,pt=ht.isProp,mt;if(pt){var At=ut,gt=At[ft],bt=_objectWithoutProperties$3(At,[ft].map(_toPropertyKey$4));mt=gt,ut=bt}else mt=ft(ut,dt);dt+1<it.length?(ct.hasOwnProperty(mt)||(ct[mt]={}),ct=ct[mt]):et?(ct.hasOwnProperty(mt)||(ct[mt]=[]),ct[mt].push(ut)):ct[mt]=ut}),at},{});et instanceof Function&&function at(lt){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ct===it.length?Object.keys(lt).forEach(function(ut){return lt[ut]=et(lt[ut])}):Object.values(lt).forEach(function(ut){return at(ut,ct+1)})}(st);var ot=st;return rt&&(ot=[],function at(lt){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];ct.length===it.length?ot.push({keys:ct,vals:lt}):Object.entries(lt).forEach(function(ut){var ht=_slicedToArray$4(ut,2),dt=ht[0],ft=ht[1];return at(ft,[].concat(_toConsumableArray$5(ct),[dt]))})}(st),_e instanceof Array&&_e.length===0&&ot.length===1&&(ot[0].keys=[])),ot};function _iterableToArrayLimit$3(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e!==0)for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function ownKeys$2(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread2$2(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$2(Object(et),!0).forEach(function(rt){_defineProperty$3(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$2(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}function _defineProperty$3(nt,_e,et){return _e=_toPropertyKey$3(_e),_e in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _objectWithoutPropertiesLoose$2(nt,_e){if(nt==null)return{};var et={},rt=Object.keys(nt),it,st;for(st=0;st<rt.length;st++)it=rt[st],!(_e.indexOf(it)>=0)&&(et[it]=nt[it]);return et}function _objectWithoutProperties$2(nt,_e){if(nt==null)return{};var et=_objectWithoutPropertiesLoose$2(nt,_e),rt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(it=0;it<st.length;it++)rt=st[it],!(_e.indexOf(rt)>=0)&&Object.prototype.propertyIsEnumerable.call(nt,rt)&&(et[rt]=nt[rt])}return et}function _slicedToArray$3(nt,_e){return _arrayWithHoles$3(nt)||_iterableToArrayLimit$3(nt,_e)||_unsupportedIterableToArray$4(nt,_e)||_nonIterableRest$3()}function _toConsumableArray$4(nt){return _arrayWithoutHoles$4(nt)||_iterableToArray$4(nt)||_unsupportedIterableToArray$4(nt)||_nonIterableSpread$4()}function _arrayWithoutHoles$4(nt){if(Array.isArray(nt))return _arrayLikeToArray$4(nt)}function _arrayWithHoles$3(nt){if(Array.isArray(nt))return nt}function _iterableToArray$4(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _unsupportedIterableToArray$4(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$4(nt,_e);var et=Object.prototype.toString.call(nt).slice(8,-1);if(et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set")return Array.from(nt);if(et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et))return _arrayLikeToArray$4(nt,_e)}}function _arrayLikeToArray$4(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=new Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _nonIterableSpread$4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest$3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toPrimitive$3(nt,_e){if(typeof nt!="object"||nt===null)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey$3(nt){var _e=_toPrimitive$3(nt,"string");return typeof _e=="symbol"?_e:String(_e)}var _excluded$2=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function diffArrays(nt,_e,et){var rt={enter:[],update:[],exit:[]};if(et){var ot=index(nt,et,!1),at=index(_e,et,!1),lt=Object.assign({},ot,at);Object.entries(lt).forEach(function(ct){var ut=_slicedToArray$3(ct,2),ht=ut[0],dt=ut[1],ft=ot.hasOwnProperty(ht)?at.hasOwnProperty(ht)?"update":"exit":"enter";rt[ft].push(ft==="update"?[ot[ht],at[ht]]:dt)})}else{var it=new Set(nt),st=new Set(_e);new Set([].concat(_toConsumableArray$4(it),_toConsumableArray$4(st))).forEach(function(ct){var ut=it.has(ct)?st.has(ct)?"update":"exit":"enter";rt[ut].push(ut==="update"?[ct,ct]:ct)})}return rt}function dataBindDiff(nt,_e,et){var rt=et.objBindAttr,it=rt===void 0?"__obj":rt,st=et.dataBindAttr,ot=st===void 0?"__data":st,at=et.idAccessor,lt=et.purge,ct=lt===void 0?!1:lt,ut=function(At){return At.hasOwnProperty(ot)},ht=_e.filter(function(mt){return!ut(mt)}),dt=_e.filter(ut).map(function(mt){return mt[ot]}),ft=nt,pt=ct?{enter:ft,exit:dt,update:[]}:diffArrays(dt,ft,at);return pt.update=pt.update.map(function(mt){var At=_slicedToArray$3(mt,2),gt=At[0],bt=At[1];return gt!==bt&&(bt[it]=gt[it],bt[it][ot]=bt),bt}),pt.exit=pt.exit.concat(ht.map(function(mt){return _defineProperty$3({},it,mt)})),pt}function viewDigest(nt,_e,et,rt,it){var st=it.createObj,ot=st===void 0?function($t){return{}}:st,at=it.updateObj,lt=at===void 0?function($t,kt){}:at,ct=it.exitObj,ut=ct===void 0?function($t){}:ct,ht=it.objBindAttr,dt=ht===void 0?"__obj":ht,ft=it.dataBindAttr,pt=ft===void 0?"__data":ft,mt=_objectWithoutProperties$2(it,_excluded$2),At=dataBindDiff(nt,_e,_objectSpread2$2({objBindAttr:dt,dataBindAttr:pt},mt)),gt=At.enter,bt=At.update,Tt=At.exit;Tt.forEach(function($t){var kt=$t[dt];delete $t[dt],ut(kt),rt(kt)});var wt=It(gt),Rt=[].concat(_toConsumableArray$4(gt),_toConsumableArray$4(bt));Lt(Rt),wt.forEach(et);function It($t){var kt=[];return $t.forEach(function(Dt){var Ot=ot(Dt);Ot&&(Ot[pt]=Dt,Dt[dt]=Ot,kt.push(Ot))}),kt}function Lt($t){$t.forEach(function(kt){var Dt=kt[dt];Dt&&(Dt[pt]=kt,lt(Dt,kt))})}}var FrameTicker$3={exports:{}};(function(nt,_e){(function(et,rt){nt.exports=rt()})(commonjsGlobal,function(){return function(et){function rt(st){if(it[st])return it[st].exports;var ot=it[st]={exports:{},id:st,loaded:!1};return et[st].call(ot.exports,ot,ot.exports,rt),ot.loaded=!0,ot.exports}var it={};return rt.m=et,rt.c=it,rt.p="",rt(0)}([function(et,rt,it){var st=it(1),ot=function(){function at(lt,ct,ut){lt===void 0&&(lt=NaN),ct===void 0&&(ct=NaN),ut===void 0&&(ut=!1),this._minFPS=ct,this._maxFPS=lt,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new st.default,this._onPause=new st.default,this._onTick=new st.default,this._onTickOncePerFrame=new st.default,ut||this.resume()}return at.prototype.updateOnce=function(lt){lt(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},at.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},at.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},at.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(at.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"timeScale",{get:function(){return this._timeScale},set:function(lt){this._timeScale!==lt&&(this._timeScale=lt)},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(at.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),at.prototype.animateOnce=function(){var lt=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return lt.onFrame()})},at.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},at.prototype.update=function(lt,ct){ct===void 0&&(ct=!0),this._currentTick++,this._currentTime+=lt,this._tickDeltaTime=lt,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),ct&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},at.prototype.getTimer=function(){return Date.now()},at}();Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=ot},function(et,rt,it){(function(st,ot){et.exports=ot()})(this,function(){return function(st){function ot(lt){if(at[lt])return at[lt].exports;var ct=at[lt]={exports:{},id:lt,loaded:!1};return st[lt].call(ct.exports,ct,ct.exports,ot),ct.loaded=!0,ct.exports}var at={};return ot.m=st,ot.c=at,ot.p="",ot(0)}([function(st,ot){var at=function(){function lt(){this.functions=[]}return lt.prototype.add=function(ct){return this.functions.indexOf(ct)===-1&&(this.functions.push(ct),!0)},lt.prototype.remove=function(ct){var ut=this.functions.indexOf(ct);return ut>-1&&(this.functions.splice(ut,1),!0)},lt.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},lt.prototype.dispatch=function(){for(var ct=[],ut=0;ut<arguments.length;ut++)ct[ut]=arguments[ut];var ht=this.functions.concat();ht.forEach(function(dt){dt.apply(void 0,ct)})},Object.defineProperty(lt.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),lt}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=at}])})}])})})(FrameTicker$3);var FrameTickerExports=FrameTicker$3.exports;const _FrameTicker=getDefaultExportFromCjs$1(FrameTickerExports);function initRange(nt,_e){switch(arguments.length){case 0:break;case 1:this.range(nt);break;default:this.range(_e).domain(nt);break}return this}const constant=nt=>()=>nt;function linear$1(nt,_e){return function(et){return nt+et*_e}}function exponential(nt,_e,et){return nt=Math.pow(nt,et),_e=Math.pow(_e,et)-nt,et=1/et,function(rt){return Math.pow(nt+rt*_e,et)}}function gamma(nt){return(nt=+nt)==1?nogamma:function(_e,et){return et-_e?exponential(_e,et,nt):constant(isNaN(_e)?et:_e)}}function nogamma(nt,_e){var et=_e-nt;return et?linear$1(nt,et):constant(isNaN(nt)?_e:nt)}const rgb$1=function nt(_e){var et=gamma(_e);function rt(it,st){var ot=et((it=rgb$2(it)).r,(st=rgb$2(st)).r),at=et(it.g,st.g),lt=et(it.b,st.b),ct=nogamma(it.opacity,st.opacity);return function(ut){return it.r=ot(ut),it.g=at(ut),it.b=lt(ut),it.opacity=ct(ut),it+""}}return rt.gamma=nt,rt}(1);function numberArray(nt,_e){_e||(_e=[]);var et=nt?Math.min(_e.length,nt.length):0,rt=_e.slice(),it;return function(st){for(it=0;it<et;++it)rt[it]=nt[it]*(1-st)+_e[it]*st;return rt}}function isNumberArray(nt){return ArrayBuffer.isView(nt)&&!(nt instanceof DataView)}function interpolateArray(nt,_e){return(isNumberArray(_e)?numberArray:genericArray)(nt,_e)}function genericArray(nt,_e){var et=_e?_e.length:0,rt=nt?Math.min(et,nt.length):0,it=new Array(rt),st=new Array(et),ot;for(ot=0;ot<rt;++ot)it[ot]=interpolate$1(nt[ot],_e[ot]);for(;ot<et;++ot)st[ot]=_e[ot];return function(at){for(ot=0;ot<rt;++ot)st[ot]=it[ot](at);return st}}function date(nt,_e){var et=new Date;return nt=+nt,_e=+_e,function(rt){return et.setTime(nt*(1-rt)+_e*rt),et}}function interpolateNumber(nt,_e){return nt=+nt,_e=+_e,function(et){return nt*(1-et)+_e*et}}function object(nt,_e){var et={},rt={},it;(nt===null||typeof nt!="object")&&(nt={}),(_e===null||typeof _e!="object")&&(_e={});for(it in _e)it in nt?et[it]=interpolate$1(nt[it],_e[it]):rt[it]=_e[it];return function(st){for(it in et)rt[it]=et[it](st);return rt}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(nt){return function(){return nt}}function one(nt){return function(_e){return nt(_e)+""}}function string(nt,_e){var et=reA.lastIndex=reB.lastIndex=0,rt,it,st,ot=-1,at=[],lt=[];for(nt=nt+"",_e=_e+"";(rt=reA.exec(nt))&&(it=reB.exec(_e));)(st=it.index)>et&&(st=_e.slice(et,st),at[ot]?at[ot]+=st:at[++ot]=st),(rt=rt[0])===(it=it[0])?at[ot]?at[ot]+=it:at[++ot]=it:(at[++ot]=null,lt.push({i:ot,x:interpolateNumber(rt,it)})),et=reB.lastIndex;return et<_e.length&&(st=_e.slice(et),at[ot]?at[ot]+=st:at[++ot]=st),at.length<2?lt[0]?one(lt[0].x):zero(_e):(_e=lt.length,function(ct){for(var ut=0,ht;ut<_e;++ut)at[(ht=lt[ut]).i]=ht.x(ct);return at.join("")})}function interpolate$1(nt,_e){var et=typeof _e,rt;return _e==null||et==="boolean"?constant(_e):(et==="number"?interpolateNumber:et==="string"?(rt=color$3(_e))?(_e=rt,rgb$1):string:_e instanceof color$3?rgb$1:_e instanceof Date?date:isNumberArray(_e)?numberArray:Array.isArray(_e)?genericArray:typeof _e.valueOf!="function"&&typeof _e.toString!="function"||isNaN(_e)?object:interpolateNumber)(nt,_e)}function interpolateRound(nt,_e){return nt=+nt,_e=+_e,function(et){return Math.round(nt*(1-et)+_e*et)}}function constants(nt){return function(){return nt}}function number$1(nt){return+nt}var unit=[0,1];function identity$1(nt){return nt}function normalize$2(nt,_e){return(_e-=nt=+nt)?function(et){return(et-nt)/_e}:constants(isNaN(_e)?NaN:.5)}function clamper(nt,_e){var et;return nt>_e&&(et=nt,nt=_e,_e=et),function(rt){return Math.max(nt,Math.min(_e,rt))}}function bimap(nt,_e,et){var rt=nt[0],it=nt[1],st=_e[0],ot=_e[1];return it<rt?(rt=normalize$2(it,rt),st=et(ot,st)):(rt=normalize$2(rt,it),st=et(st,ot)),function(at){return st(rt(at))}}function polymap(nt,_e,et){var rt=Math.min(nt.length,_e.length)-1,it=new Array(rt),st=new Array(rt),ot=-1;for(nt[rt]<nt[0]&&(nt=nt.slice().reverse(),_e=_e.slice().reverse());++ot<rt;)it[ot]=normalize$2(nt[ot],nt[ot+1]),st[ot]=et(_e[ot],_e[ot+1]);return function(at){var lt=bisectRight(nt,at,1,rt)-1;return st[lt](it[lt](at))}}function copy(nt,_e){return _e.domain(nt.domain()).range(nt.range()).interpolate(nt.interpolate()).clamp(nt.clamp()).unknown(nt.unknown())}function transformer(){var nt=unit,_e=unit,et=interpolate$1,rt,it,st,ot=identity$1,at,lt,ct;function ut(){var dt=Math.min(nt.length,_e.length);return ot!==identity$1&&(ot=clamper(nt[0],nt[dt-1])),at=dt>2?polymap:bimap,lt=ct=null,ht}function ht(dt){return dt==null||isNaN(dt=+dt)?st:(lt||(lt=at(nt.map(rt),_e,et)))(rt(ot(dt)))}return ht.invert=function(dt){return ot(it((ct||(ct=at(_e,nt.map(rt),interpolateNumber)))(dt)))},ht.domain=function(dt){return arguments.length?(nt=Array.from(dt,number$1),ut()):nt.slice()},ht.range=function(dt){return arguments.length?(_e=Array.from(dt),ut()):_e.slice()},ht.rangeRound=function(dt){return _e=Array.from(dt),et=interpolateRound,ut()},ht.clamp=function(dt){return arguments.length?(ot=dt?!0:identity$1,ut()):ot!==identity$1},ht.interpolate=function(dt){return arguments.length?(et=dt,ut()):et},ht.unknown=function(dt){return arguments.length?(st=dt,ht):st},function(dt,ft){return rt=dt,it=ft,ut()}}function continuous(){return transformer()(identity$1,identity$1)}function formatDecimal(nt){return Math.abs(nt=Math.round(nt))>=1e21?nt.toLocaleString("en").replace(/,/g,""):nt.toString(10)}function formatDecimalParts(nt,_e){if((et=(nt=_e?nt.toExponential(_e-1):nt.toExponential()).indexOf("e"))<0)return null;var et,rt=nt.slice(0,et);return[rt.length>1?rt[0]+rt.slice(2):rt,+nt.slice(et+1)]}function exponent(nt){return nt=formatDecimalParts(Math.abs(nt)),nt?nt[1]:NaN}function formatGroup(nt,_e){return function(et,rt){for(var it=et.length,st=[],ot=0,at=nt[0],lt=0;it>0&&at>0&&(lt+at+1>rt&&(at=Math.max(1,rt-lt)),st.push(et.substring(it-=at,it+at)),!((lt+=at+1)>rt));)at=nt[ot=(ot+1)%nt.length];return st.reverse().join(_e)}}function formatNumerals(nt){return function(_e){return _e.replace(/[0-9]/g,function(et){return nt[+et]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(nt){if(!(_e=re.exec(nt)))throw new Error("invalid format: "+nt);var _e;return new FormatSpecifier({fill:_e[1],align:_e[2],sign:_e[3],symbol:_e[4],zero:_e[5],width:_e[6],comma:_e[7],precision:_e[8]&&_e[8].slice(1),trim:_e[9],type:_e[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(nt){this.fill=nt.fill===void 0?" ":nt.fill+"",this.align=nt.align===void 0?">":nt.align+"",this.sign=nt.sign===void 0?"-":nt.sign+"",this.symbol=nt.symbol===void 0?"":nt.symbol+"",this.zero=!!nt.zero,this.width=nt.width===void 0?void 0:+nt.width,this.comma=!!nt.comma,this.precision=nt.precision===void 0?void 0:+nt.precision,this.trim=!!nt.trim,this.type=nt.type===void 0?"":nt.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(nt){e:for(var _e=nt.length,et=1,rt=-1,it;et<_e;++et)switch(nt[et]){case".":rt=it=et;break;case"0":rt===0&&(rt=et),it=et;break;default:if(!+nt[et])break e;rt>0&&(rt=0);break}return rt>0?nt.slice(0,rt)+nt.slice(it+1):nt}var prefixExponent;function formatPrefixAuto(nt,_e){var et=formatDecimalParts(nt,_e);if(!et)return nt+"";var rt=et[0],it=et[1],st=it-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(it/3)))*3)+1,ot=rt.length;return st===ot?rt:st>ot?rt+new Array(st-ot+1).join("0"):st>0?rt.slice(0,st)+"."+rt.slice(st):"0."+new Array(1-st).join("0")+formatDecimalParts(nt,Math.max(0,_e+st-1))[0]}function formatRounded(nt,_e){var et=formatDecimalParts(nt,_e);if(!et)return nt+"";var rt=et[0],it=et[1];return it<0?"0."+new Array(-it).join("0")+rt:rt.length>it+1?rt.slice(0,it+1)+"."+rt.slice(it+1):rt+new Array(it-rt.length+2).join("0")}const formatTypes={"%":(nt,_e)=>(nt*100).toFixed(_e),b:nt=>Math.round(nt).toString(2),c:nt=>nt+"",d:formatDecimal,e:(nt,_e)=>nt.toExponential(_e),f:(nt,_e)=>nt.toFixed(_e),g:(nt,_e)=>nt.toPrecision(_e),o:nt=>Math.round(nt).toString(8),p:(nt,_e)=>formatRounded(nt*100,_e),r:formatRounded,s:formatPrefixAuto,X:nt=>Math.round(nt).toString(16).toUpperCase(),x:nt=>Math.round(nt).toString(16)};function identity(nt){return nt}var map=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale(nt){var _e=nt.grouping===void 0||nt.thousands===void 0?identity:formatGroup(map.call(nt.grouping,Number),nt.thousands+""),et=nt.currency===void 0?"":nt.currency[0]+"",rt=nt.currency===void 0?"":nt.currency[1]+"",it=nt.decimal===void 0?".":nt.decimal+"",st=nt.numerals===void 0?identity:formatNumerals(map.call(nt.numerals,String)),ot=nt.percent===void 0?"%":nt.percent+"",at=nt.minus===void 0?"":nt.minus+"",lt=nt.nan===void 0?"NaN":nt.nan+"";function ct(ht){ht=formatSpecifier(ht);var dt=ht.fill,ft=ht.align,pt=ht.sign,mt=ht.symbol,At=ht.zero,gt=ht.width,bt=ht.comma,Tt=ht.precision,wt=ht.trim,Rt=ht.type;Rt==="n"?(bt=!0,Rt="g"):formatTypes[Rt]||(Tt===void 0&&(Tt=12),wt=!0,Rt="g"),(At||dt==="0"&&ft==="=")&&(At=!0,dt="0",ft="=");var It=mt==="$"?et:mt==="#"&&/[boxX]/.test(Rt)?"0"+Rt.toLowerCase():"",Lt=mt==="$"?rt:/[%p]/.test(Rt)?ot:"",$t=formatTypes[Rt],kt=/[defgprs%]/.test(Rt);Tt=Tt===void 0?6:/[gprs]/.test(Rt)?Math.max(1,Math.min(21,Tt)):Math.max(0,Math.min(20,Tt));function Dt(Ot){var zt=It,Ht=Lt,Yt,Xt,Zt;if(Rt==="c")Ht=$t(Ot)+Ht,Ot="";else{Ot=+Ot;var rn=Ot<0||1/Ot<0;if(Ot=isNaN(Ot)?lt:$t(Math.abs(Ot),Tt),wt&&(Ot=formatTrim(Ot)),rn&&+Ot==0&&pt!=="+"&&(rn=!1),zt=(rn?pt==="("?pt:at:pt==="-"||pt==="("?"":pt)+zt,Ht=(Rt==="s"?prefixes[8+prefixExponent/3]:"")+Ht+(rn&&pt==="("?")":""),kt){for(Yt=-1,Xt=Ot.length;++Yt<Xt;)if(Zt=Ot.charCodeAt(Yt),48>Zt||Zt>57){Ht=(Zt===46?it+Ot.slice(Yt+1):Ot.slice(Yt))+Ht,Ot=Ot.slice(0,Yt);break}}}bt&&!At&&(Ot=_e(Ot,1/0));var Gt=zt.length+Ot.length+Ht.length,jt=Gt<gt?new Array(gt-Gt+1).join(dt):"";switch(bt&&At&&(Ot=_e(jt+Ot,jt.length?gt-Ht.length:1/0),jt=""),ft){case"<":Ot=zt+Ot+Ht+jt;break;case"=":Ot=zt+jt+Ot+Ht;break;case"^":Ot=jt.slice(0,Gt=jt.length>>1)+zt+Ot+Ht+jt.slice(Gt);break;default:Ot=jt+zt+Ot+Ht;break}return st(Ot)}return Dt.toString=function(){return ht+""},Dt}function ut(ht,dt){var ft=ct((ht=formatSpecifier(ht),ht.type="f",ht)),pt=Math.max(-8,Math.min(8,Math.floor(exponent(dt)/3)))*3,mt=Math.pow(10,-pt),At=prefixes[8+pt/3];return function(gt){return ft(mt*gt)+At}}return{format:ct,formatPrefix:ut}}var locale,format,formatPrefix;defaultLocale({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale(nt){return locale=formatLocale(nt),format=locale.format,formatPrefix=locale.formatPrefix,locale}function precisionFixed(nt){return Math.max(0,-exponent(Math.abs(nt)))}function precisionPrefix(nt,_e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(_e)/3)))*3-exponent(Math.abs(nt)))}function precisionRound(nt,_e){return nt=Math.abs(nt),_e=Math.abs(_e)-nt,Math.max(0,exponent(_e)-exponent(nt))+1}function tickFormat(nt,_e,et,rt){var it=tickStep(nt,_e,et),st;switch(rt=formatSpecifier(rt??",f"),rt.type){case"s":{var ot=Math.max(Math.abs(nt),Math.abs(_e));return rt.precision==null&&!isNaN(st=precisionPrefix(it,ot))&&(rt.precision=st),formatPrefix(rt,ot)}case"":case"e":case"g":case"p":case"r":{rt.precision==null&&!isNaN(st=precisionRound(it,Math.max(Math.abs(nt),Math.abs(_e))))&&(rt.precision=st-(rt.type==="e"));break}case"f":case"%":{rt.precision==null&&!isNaN(st=precisionFixed(it))&&(rt.precision=st-(rt.type==="%")*2);break}}return format(rt)}function linearish(nt){var _e=nt.domain;return nt.ticks=function(et){var rt=_e();return ticks(rt[0],rt[rt.length-1],et??10)},nt.tickFormat=function(et,rt){var it=_e();return tickFormat(it[0],it[it.length-1],et??10,rt)},nt.nice=function(et){et==null&&(et=10);var rt=_e(),it=0,st=rt.length-1,ot=rt[it],at=rt[st],lt,ct,ut=10;for(at<ot&&(ct=ot,ot=at,at=ct,ct=it,it=st,st=ct);ut-- >0;){if(ct=tickIncrement(ot,at,et),ct===lt)return rt[it]=ot,rt[st]=at,_e(rt);if(ct>0)ot=Math.floor(ot/ct)*ct,at=Math.ceil(at/ct)*ct;else if(ct<0)ot=Math.ceil(ot*ct)/ct,at=Math.floor(at*ct)/ct;else break;lt=ct}return nt},nt}function linear(){var nt=continuous();return nt.copy=function(){return copy(nt,linear())},initRange.apply(nt,arguments),linearish(nt)}const epsilon$1=11102230246251565e-32,splitter=134217729,resulterrbound=(3+8*epsilon$1)*epsilon$1;function sum(nt,_e,et,rt,it){let st,ot,at,lt,ct=_e[0],ut=rt[0],ht=0,dt=0;ut>ct==ut>-ct?(st=ct,ct=_e[++ht]):(st=ut,ut=rt[++dt]);let ft=0;if(ht<nt&&dt<et)for(ut>ct==ut>-ct?(ot=ct+st,at=st-(ot-ct),ct=_e[++ht]):(ot=ut+st,at=st-(ot-ut),ut=rt[++dt]),st=ot,at!==0&&(it[ft++]=at);ht<nt&&dt<et;)ut>ct==ut>-ct?(ot=st+ct,lt=ot-st,at=st-(ot-lt)+(ct-lt),ct=_e[++ht]):(ot=st+ut,lt=ot-st,at=st-(ot-lt)+(ut-lt),ut=rt[++dt]),st=ot,at!==0&&(it[ft++]=at);for(;ht<nt;)ot=st+ct,lt=ot-st,at=st-(ot-lt)+(ct-lt),ct=_e[++ht],st=ot,at!==0&&(it[ft++]=at);for(;dt<et;)ot=st+ut,lt=ot-st,at=st-(ot-lt)+(ut-lt),ut=rt[++dt],st=ot,at!==0&&(it[ft++]=at);return(st!==0||ft===0)&&(it[ft++]=st),ft}function estimate(nt,_e){let et=_e[0];for(let rt=1;rt<nt;rt++)et+=_e[rt];return et}function vec(nt){return new Float64Array(nt)}const ccwerrboundA=(3+16*epsilon$1)*epsilon$1,ccwerrboundB=(2+12*epsilon$1)*epsilon$1,ccwerrboundC=(9+64*epsilon$1)*epsilon$1*epsilon$1,B=vec(4),C1=vec(8),C2=vec(12),D=vec(16),u=vec(4);function orient2dadapt(nt,_e,et,rt,it,st,ot){let at,lt,ct,ut,ht,dt,ft,pt,mt,At,gt,bt,Tt,wt,Rt,It,Lt,$t;const kt=nt-it,Dt=et-it,Ot=_e-st,zt=rt-st;wt=kt*zt,dt=splitter*kt,ft=dt-(dt-kt),pt=kt-ft,dt=splitter*zt,mt=dt-(dt-zt),At=zt-mt,Rt=pt*At-(wt-ft*mt-pt*mt-ft*At),It=Ot*Dt,dt=splitter*Ot,ft=dt-(dt-Ot),pt=Ot-ft,dt=splitter*Dt,mt=dt-(dt-Dt),At=Dt-mt,Lt=pt*At-(It-ft*mt-pt*mt-ft*At),gt=Rt-Lt,ht=Rt-gt,B[0]=Rt-(gt+ht)+(ht-Lt),bt=wt+gt,ht=bt-wt,Tt=wt-(bt-ht)+(gt-ht),gt=Tt-It,ht=Tt-gt,B[1]=Tt-(gt+ht)+(ht-It),$t=bt+gt,ht=$t-bt,B[2]=bt-($t-ht)+(gt-ht),B[3]=$t;let Ht=estimate(4,B),Yt=ccwerrboundB*ot;if(Ht>=Yt||-Ht>=Yt||(ht=nt-kt,at=nt-(kt+ht)+(ht-it),ht=et-Dt,ct=et-(Dt+ht)+(ht-it),ht=_e-Ot,lt=_e-(Ot+ht)+(ht-st),ht=rt-zt,ut=rt-(zt+ht)+(ht-st),at===0&&lt===0&&ct===0&&ut===0)||(Yt=ccwerrboundC*ot+resulterrbound*Math.abs(Ht),Ht+=kt*ut+zt*at-(Ot*ct+Dt*lt),Ht>=Yt||-Ht>=Yt))return Ht;wt=at*zt,dt=splitter*at,ft=dt-(dt-at),pt=at-ft,dt=splitter*zt,mt=dt-(dt-zt),At=zt-mt,Rt=pt*At-(wt-ft*mt-pt*mt-ft*At),It=lt*Dt,dt=splitter*lt,ft=dt-(dt-lt),pt=lt-ft,dt=splitter*Dt,mt=dt-(dt-Dt),At=Dt-mt,Lt=pt*At-(It-ft*mt-pt*mt-ft*At),gt=Rt-Lt,ht=Rt-gt,u[0]=Rt-(gt+ht)+(ht-Lt),bt=wt+gt,ht=bt-wt,Tt=wt-(bt-ht)+(gt-ht),gt=Tt-It,ht=Tt-gt,u[1]=Tt-(gt+ht)+(ht-It),$t=bt+gt,ht=$t-bt,u[2]=bt-($t-ht)+(gt-ht),u[3]=$t;const Xt=sum(4,B,4,u,C1);wt=kt*ut,dt=splitter*kt,ft=dt-(dt-kt),pt=kt-ft,dt=splitter*ut,mt=dt-(dt-ut),At=ut-mt,Rt=pt*At-(wt-ft*mt-pt*mt-ft*At),It=Ot*ct,dt=splitter*Ot,ft=dt-(dt-Ot),pt=Ot-ft,dt=splitter*ct,mt=dt-(dt-ct),At=ct-mt,Lt=pt*At-(It-ft*mt-pt*mt-ft*At),gt=Rt-Lt,ht=Rt-gt,u[0]=Rt-(gt+ht)+(ht-Lt),bt=wt+gt,ht=bt-wt,Tt=wt-(bt-ht)+(gt-ht),gt=Tt-It,ht=Tt-gt,u[1]=Tt-(gt+ht)+(ht-It),$t=bt+gt,ht=$t-bt,u[2]=bt-($t-ht)+(gt-ht),u[3]=$t;const Zt=sum(Xt,C1,4,u,C2);wt=at*ut,dt=splitter*at,ft=dt-(dt-at),pt=at-ft,dt=splitter*ut,mt=dt-(dt-ut),At=ut-mt,Rt=pt*At-(wt-ft*mt-pt*mt-ft*At),It=lt*ct,dt=splitter*lt,ft=dt-(dt-lt),pt=lt-ft,dt=splitter*ct,mt=dt-(dt-ct),At=ct-mt,Lt=pt*At-(It-ft*mt-pt*mt-ft*At),gt=Rt-Lt,ht=Rt-gt,u[0]=Rt-(gt+ht)+(ht-Lt),bt=wt+gt,ht=bt-wt,Tt=wt-(bt-ht)+(gt-ht),gt=Tt-It,ht=Tt-gt,u[1]=Tt-(gt+ht)+(ht-It),$t=bt+gt,ht=$t-bt,u[2]=bt-($t-ht)+(gt-ht),u[3]=$t;const rn=sum(Zt,C2,4,u,D);return D[rn-1]}function orient2d(nt,_e,et,rt,it,st){const ot=(_e-st)*(et-it),at=(nt-it)*(rt-st),lt=ot-at,ct=Math.abs(ot+at);return Math.abs(lt)>=ccwerrboundA*ct?lt:-orient2dadapt(nt,_e,et,rt,it,st,ct)}const EPSILON$1=Math.pow(2,-52),EDGE_STACK=new Uint32Array(512);class Delaunator{static from(_e,et=defaultGetX,rt=defaultGetY){const it=_e.length,st=new Float64Array(it*2);for(let ot=0;ot<it;ot++){const at=_e[ot];st[2*ot]=et(at),st[2*ot+1]=rt(at)}return new Delaunator(st)}constructor(_e){const et=_e.length>>1;if(et>0&&typeof _e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=_e;const rt=Math.max(2*et-5,0);this._triangles=new Uint32Array(rt*3),this._halfedges=new Int32Array(rt*3),this._hashSize=Math.ceil(Math.sqrt(et)),this._hullPrev=new Uint32Array(et),this._hullNext=new Uint32Array(et),this._hullTri=new Uint32Array(et),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(et),this._dists=new Float64Array(et),this.update()}update(){const{coords:_e,_hullPrev:et,_hullNext:rt,_hullTri:it,_hullHash:st}=this,ot=_e.length>>1;let at=1/0,lt=1/0,ct=-1/0,ut=-1/0;for(let kt=0;kt<ot;kt++){const Dt=_e[2*kt],Ot=_e[2*kt+1];Dt<at&&(at=Dt),Ot<lt&&(lt=Ot),Dt>ct&&(ct=Dt),Ot>ut&&(ut=Ot),this._ids[kt]=kt}const ht=(at+ct)/2,dt=(lt+ut)/2;let ft,pt,mt;for(let kt=0,Dt=1/0;kt<ot;kt++){const Ot=dist(ht,dt,_e[2*kt],_e[2*kt+1]);Ot<Dt&&(ft=kt,Dt=Ot)}const At=_e[2*ft],gt=_e[2*ft+1];for(let kt=0,Dt=1/0;kt<ot;kt++){if(kt===ft)continue;const Ot=dist(At,gt,_e[2*kt],_e[2*kt+1]);Ot<Dt&&Ot>0&&(pt=kt,Dt=Ot)}let bt=_e[2*pt],Tt=_e[2*pt+1],wt=1/0;for(let kt=0;kt<ot;kt++){if(kt===ft||kt===pt)continue;const Dt=circumradius(At,gt,bt,Tt,_e[2*kt],_e[2*kt+1]);Dt<wt&&(mt=kt,wt=Dt)}let Rt=_e[2*mt],It=_e[2*mt+1];if(wt===1/0){for(let Ot=0;Ot<ot;Ot++)this._dists[Ot]=_e[2*Ot]-_e[0]||_e[2*Ot+1]-_e[1];quicksort(this._ids,this._dists,0,ot-1);const kt=new Uint32Array(ot);let Dt=0;for(let Ot=0,zt=-1/0;Ot<ot;Ot++){const Ht=this._ids[Ot],Yt=this._dists[Ht];Yt>zt&&(kt[Dt++]=Ht,zt=Yt)}this.hull=kt.subarray(0,Dt),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(orient2d(At,gt,bt,Tt,Rt,It)<0){const kt=pt,Dt=bt,Ot=Tt;pt=mt,bt=Rt,Tt=It,mt=kt,Rt=Dt,It=Ot}const Lt=circumcenter(At,gt,bt,Tt,Rt,It);this._cx=Lt.x,this._cy=Lt.y;for(let kt=0;kt<ot;kt++)this._dists[kt]=dist(_e[2*kt],_e[2*kt+1],Lt.x,Lt.y);quicksort(this._ids,this._dists,0,ot-1),this._hullStart=ft;let $t=3;rt[ft]=et[mt]=pt,rt[pt]=et[ft]=mt,rt[mt]=et[pt]=ft,it[ft]=0,it[pt]=1,it[mt]=2,st.fill(-1),st[this._hashKey(At,gt)]=ft,st[this._hashKey(bt,Tt)]=pt,st[this._hashKey(Rt,It)]=mt,this.trianglesLen=0,this._addTriangle(ft,pt,mt,-1,-1,-1);for(let kt=0,Dt,Ot;kt<this._ids.length;kt++){const zt=this._ids[kt],Ht=_e[2*zt],Yt=_e[2*zt+1];if(kt>0&&Math.abs(Ht-Dt)<=EPSILON$1&&Math.abs(Yt-Ot)<=EPSILON$1||(Dt=Ht,Ot=Yt,zt===ft||zt===pt||zt===mt))continue;let Xt=0;for(let Kt=0,Jt=this._hashKey(Ht,Yt);Kt<this._hashSize&&(Xt=st[(Jt+Kt)%this._hashSize],!(Xt!==-1&&Xt!==rt[Xt]));Kt++);Xt=et[Xt];let Zt=Xt,rn;for(;rn=rt[Zt],orient2d(Ht,Yt,_e[2*Zt],_e[2*Zt+1],_e[2*rn],_e[2*rn+1])>=0;)if(Zt=rn,Zt===Xt){Zt=-1;break}if(Zt===-1)continue;let Gt=this._addTriangle(Zt,zt,rt[Zt],-1,-1,it[Zt]);it[zt]=this._legalize(Gt+2),it[Zt]=Gt,$t++;let jt=rt[Zt];for(;rn=rt[jt],orient2d(Ht,Yt,_e[2*jt],_e[2*jt+1],_e[2*rn],_e[2*rn+1])<0;)Gt=this._addTriangle(jt,zt,rn,it[zt],-1,it[jt]),it[zt]=this._legalize(Gt+2),rt[jt]=jt,$t--,jt=rn;if(Zt===Xt)for(;rn=et[Zt],orient2d(Ht,Yt,_e[2*rn],_e[2*rn+1],_e[2*Zt],_e[2*Zt+1])<0;)Gt=this._addTriangle(rn,zt,Zt,-1,it[Zt],it[rn]),this._legalize(Gt+2),it[rn]=Gt,rt[Zt]=Zt,$t--,Zt=rn;this._hullStart=et[zt]=Zt,rt[Zt]=et[jt]=zt,rt[zt]=jt,st[this._hashKey(Ht,Yt)]=zt,st[this._hashKey(_e[2*Zt],_e[2*Zt+1])]=Zt}this.hull=new Uint32Array($t);for(let kt=0,Dt=this._hullStart;kt<$t;kt++)this.hull[kt]=Dt,Dt=rt[Dt];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(_e,et){return Math.floor(pseudoAngle(_e-this._cx,et-this._cy)*this._hashSize)%this._hashSize}_legalize(_e){const{_triangles:et,_halfedges:rt,coords:it}=this;let st=0,ot=0;for(;;){const at=rt[_e],lt=_e-_e%3;if(ot=lt+(_e+2)%3,at===-1){if(st===0)break;_e=EDGE_STACK[--st];continue}const ct=at-at%3,ut=lt+(_e+1)%3,ht=ct+(at+2)%3,dt=et[ot],ft=et[_e],pt=et[ut],mt=et[ht];if(inCircle(it[2*dt],it[2*dt+1],it[2*ft],it[2*ft+1],it[2*pt],it[2*pt+1],it[2*mt],it[2*mt+1])){et[_e]=mt,et[at]=dt;const gt=rt[ht];if(gt===-1){let Tt=this._hullStart;do{if(this._hullTri[Tt]===ht){this._hullTri[Tt]=_e;break}Tt=this._hullPrev[Tt]}while(Tt!==this._hullStart)}this._link(_e,gt),this._link(at,rt[ot]),this._link(ot,ht);const bt=ct+(at+1)%3;st<EDGE_STACK.length&&(EDGE_STACK[st++]=bt)}else{if(st===0)break;_e=EDGE_STACK[--st]}}return ot}_link(_e,et){this._halfedges[_e]=et,et!==-1&&(this._halfedges[et]=_e)}_addTriangle(_e,et,rt,it,st,ot){const at=this.trianglesLen;return this._triangles[at]=_e,this._triangles[at+1]=et,this._triangles[at+2]=rt,this._link(at,it),this._link(at+1,st),this._link(at+2,ot),this.trianglesLen+=3,at}}function pseudoAngle(nt,_e){const et=nt/(Math.abs(nt)+Math.abs(_e));return(_e>0?3-et:1+et)/4}function dist(nt,_e,et,rt){const it=nt-et,st=_e-rt;return it*it+st*st}function inCircle(nt,_e,et,rt,it,st,ot,at){const lt=nt-ot,ct=_e-at,ut=et-ot,ht=rt-at,dt=it-ot,ft=st-at,pt=lt*lt+ct*ct,mt=ut*ut+ht*ht,At=dt*dt+ft*ft;return lt*(ht*At-mt*ft)-ct*(ut*At-mt*dt)+pt*(ut*ft-ht*dt)<0}function circumradius(nt,_e,et,rt,it,st){const ot=et-nt,at=rt-_e,lt=it-nt,ct=st-_e,ut=ot*ot+at*at,ht=lt*lt+ct*ct,dt=.5/(ot*ct-at*lt),ft=(ct*ut-at*ht)*dt,pt=(ot*ht-lt*ut)*dt;return ft*ft+pt*pt}function circumcenter(nt,_e,et,rt,it,st){const ot=et-nt,at=rt-_e,lt=it-nt,ct=st-_e,ut=ot*ot+at*at,ht=lt*lt+ct*ct,dt=.5/(ot*ct-at*lt),ft=nt+(ct*ut-at*ht)*dt,pt=_e+(ot*ht-lt*ut)*dt;return{x:ft,y:pt}}function quicksort(nt,_e,et,rt){if(rt-et<=20)for(let it=et+1;it<=rt;it++){const st=nt[it],ot=_e[st];let at=it-1;for(;at>=et&&_e[nt[at]]>ot;)nt[at+1]=nt[at--];nt[at+1]=st}else{const it=et+rt>>1;let st=et+1,ot=rt;swap(nt,it,st),_e[nt[et]]>_e[nt[rt]]&&swap(nt,et,rt),_e[nt[st]]>_e[nt[rt]]&&swap(nt,st,rt),_e[nt[et]]>_e[nt[st]]&&swap(nt,et,st);const at=nt[st],lt=_e[at];for(;;){do st++;while(_e[nt[st]]<lt);do ot--;while(_e[nt[ot]]>lt);if(ot<st)break;swap(nt,st,ot)}nt[et+1]=nt[ot],nt[ot]=at,rt-st+1>=ot-et?(quicksort(nt,_e,st,rt),quicksort(nt,_e,et,ot-1)):(quicksort(nt,_e,et,ot-1),quicksort(nt,_e,st,rt))}}function swap(nt,_e,et){const rt=nt[_e];nt[_e]=nt[et],nt[et]=rt}function defaultGetX(nt){return nt[0]}function defaultGetY(nt){return nt[1]}function pointInPolygon(nt,_e){var et=0,rt=0,it=0,st=0,ot=0,at=0,lt=0,ct=0,ut=null,ht=null,dt=nt[0],ft=nt[1],pt=_e.length;for(et;et<pt;et++){rt=0;var mt=_e[et].length-1,At=_e[et];if(ut=At[0],ut[0]!==At[mt][0]&&ut[1]!==At[mt][1])throw new Error("First and last coordinates in a ring must be the same");for(ot=ut[0]-dt,at=ut[1]-ft,rt;rt<mt;rt++){if(ht=At[rt+1],ct=ht[1]-ft,at<0&&ct<0||at>0&&ct>0){ut=ht,at=ct,ot=ut[0]-dt;continue}if(lt=ht[0]-nt[0],ct>0&&at<=0){if(st=ot*ct-lt*at,st>0)it=it+1;else if(st===0)return 0}else if(at>0&&ct<=0){if(st=ot*ct-lt*at,st<0)it=it+1;else if(st===0)return 0}else if(ct===0&&at<0){if(st=ot*ct-lt*at,st===0)return 0}else if(at===0&&ct<0){if(st=ot*ct-lt*at,st===0)return 0}else if(at===0&&ct===0){if(lt<=0&&ot>=0)return 0;if(ot<=0&&lt>=0)return 0}ut=ht,at=ct,ot=lt}}return it%2!==0}function getCoord(nt){if(!nt)throw new Error("coord is required");if(!Array.isArray(nt)){if(nt.type==="Feature"&&nt.geometry!==null&&nt.geometry.type==="Point")return[...nt.geometry.coordinates];if(nt.type==="Point")return[...nt.coordinates]}if(Array.isArray(nt)&&nt.length>=2&&!Array.isArray(nt[0])&&!Array.isArray(nt[1]))return[...nt];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function getGeom(nt){return nt.type==="Feature"?nt.geometry:nt}function booleanPointInPolygon(nt,_e,et={}){if(!nt)throw new Error("point is required");if(!_e)throw new Error("polygon is required");const rt=getCoord(nt),it=getGeom(_e),st=it.type,ot=_e.bbox;let at=it.coordinates;if(ot&&inBBox(rt,ot)===!1)return!1;st==="Polygon"&&(at=[at]);let lt=!1;for(var ct=0;ct<at.length;++ct){const ut=pointInPolygon(rt,at[ct]);if(ut===0)return!et.ignoreBoundary;ut&&(lt=!0)}return lt}function inBBox(nt,_e){return _e[0]<=nt[0]&&_e[1]<=nt[1]&&_e[2]>=nt[0]&&_e[3]>=nt[1]}var turf_boolean_point_in_polygon_default=booleanPointInPolygon;const epsilon=1e-6;class Path{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(_e,et){this._+=`M${this._x0=this._x1=+_e},${this._y0=this._y1=+et}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(_e,et){this._+=`L${this._x1=+_e},${this._y1=+et}`}arc(_e,et,rt){_e=+_e,et=+et,rt=+rt;const it=_e+rt,st=et;if(rt<0)throw new Error("negative radius");this._x1===null?this._+=`M${it},${st}`:(Math.abs(this._x1-it)>epsilon||Math.abs(this._y1-st)>epsilon)&&(this._+="L"+it+","+st),rt&&(this._+=`A${rt},${rt},0,1,1,${_e-rt},${et}A${rt},${rt},0,1,1,${this._x1=it},${this._y1=st}`)}rect(_e,et,rt,it){this._+=`M${this._x0=this._x1=+_e},${this._y0=this._y1=+et}h${+rt}v${+it}h${-rt}Z`}value(){return this._||null}}class Polygon{constructor(){this._=[]}moveTo(_e,et){this._.push([_e,et])}closePath(){this._.push(this._[0].slice())}lineTo(_e,et){this._.push([_e,et])}value(){return this._.length?this._:null}}class Voronoi{constructor(_e,[et,rt,it,st]=[0,0,960,500]){if(!((it=+it)>=(et=+et))||!((st=+st)>=(rt=+rt)))throw new Error("invalid bounds");this.delaunay=_e,this._circumcenters=new Float64Array(_e.points.length*2),this.vectors=new Float64Array(_e.points.length*2),this.xmax=it,this.xmin=et,this.ymax=st,this.ymin=rt,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:_e,hull:et,triangles:rt},vectors:it}=this;let st,ot;const at=this.circumcenters=this._circumcenters.subarray(0,rt.length/3*2);for(let mt=0,At=0,gt=rt.length,bt,Tt;mt<gt;mt+=3,At+=2){const wt=rt[mt]*2,Rt=rt[mt+1]*2,It=rt[mt+2]*2,Lt=_e[wt],$t=_e[wt+1],kt=_e[Rt],Dt=_e[Rt+1],Ot=_e[It],zt=_e[It+1],Ht=kt-Lt,Yt=Dt-$t,Xt=Ot-Lt,Zt=zt-$t,rn=(Ht*Zt-Yt*Xt)*2;if(Math.abs(rn)<1e-9){if(st===void 0){st=ot=0;for(const jt of et)st+=_e[jt*2],ot+=_e[jt*2+1];st/=et.length,ot/=et.length}const Gt=1e9*Math.sign((st-Lt)*Zt-(ot-$t)*Xt);bt=(Lt+Ot)/2-Gt*Zt,Tt=($t+zt)/2+Gt*Xt}else{const Gt=1/rn,jt=Ht*Ht+Yt*Yt,Kt=Xt*Xt+Zt*Zt;bt=Lt+(Zt*jt-Yt*Kt)*Gt,Tt=$t+(Ht*Kt-Xt*jt)*Gt}at[At]=bt,at[At+1]=Tt}let lt=et[et.length-1],ct,ut=lt*4,ht,dt=_e[2*lt],ft,pt=_e[2*lt+1];it.fill(0);for(let mt=0;mt<et.length;++mt)lt=et[mt],ct=ut,ht=dt,ft=pt,ut=lt*4,dt=_e[2*lt],pt=_e[2*lt+1],it[ct+2]=it[ut]=ft-pt,it[ct+3]=it[ut+1]=dt-ht}render(_e){const et=_e==null?_e=new Path:void 0,{delaunay:{halfedges:rt,inedges:it,hull:st},circumcenters:ot,vectors:at}=this;if(st.length<=1)return null;for(let ut=0,ht=rt.length;ut<ht;++ut){const dt=rt[ut];if(dt<ut)continue;const ft=Math.floor(ut/3)*2,pt=Math.floor(dt/3)*2,mt=ot[ft],At=ot[ft+1],gt=ot[pt],bt=ot[pt+1];this._renderSegment(mt,At,gt,bt,_e)}let lt,ct=st[st.length-1];for(let ut=0;ut<st.length;++ut){lt=ct,ct=st[ut];const ht=Math.floor(it[ct]/3)*2,dt=ot[ht],ft=ot[ht+1],pt=lt*4,mt=this._project(dt,ft,at[pt+2],at[pt+3]);mt&&this._renderSegment(dt,ft,mt[0],mt[1],_e)}return et&&et.value()}renderBounds(_e){const et=_e==null?_e=new Path:void 0;return _e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),et&&et.value()}renderCell(_e,et){const rt=et==null?et=new Path:void 0,it=this._clip(_e);if(it===null||!it.length)return;et.moveTo(it[0],it[1]);let st=it.length;for(;it[0]===it[st-2]&&it[1]===it[st-1]&&st>1;)st-=2;for(let ot=2;ot<st;ot+=2)(it[ot]!==it[ot-2]||it[ot+1]!==it[ot-1])&&et.lineTo(it[ot],it[ot+1]);return et.closePath(),rt&&rt.value()}*cellPolygons(){const{delaunay:{points:_e}}=this;for(let et=0,rt=_e.length/2;et<rt;++et){const it=this.cellPolygon(et);it&&(it.index=et,yield it)}}cellPolygon(_e){const et=new Polygon;return this.renderCell(_e,et),et.value()}_renderSegment(_e,et,rt,it,st){let ot;const at=this._regioncode(_e,et),lt=this._regioncode(rt,it);at===0&&lt===0?(st.moveTo(_e,et),st.lineTo(rt,it)):(ot=this._clipSegment(_e,et,rt,it,at,lt))&&(st.moveTo(ot[0],ot[1]),st.lineTo(ot[2],ot[3]))}contains(_e,et,rt){return et=+et,et!==et||(rt=+rt,rt!==rt)?!1:this.delaunay._step(_e,et,rt)===_e}*neighbors(_e){const et=this._clip(_e);if(et)for(const rt of this.delaunay.neighbors(_e)){const it=this._clip(rt);if(it){e:for(let st=0,ot=et.length;st<ot;st+=2)for(let at=0,lt=it.length;at<lt;at+=2)if(et[st]===it[at]&&et[st+1]===it[at+1]&&et[(st+2)%ot]===it[(at+lt-2)%lt]&&et[(st+3)%ot]===it[(at+lt-1)%lt]){yield rt;break e}}}}_cell(_e){const{circumcenters:et,delaunay:{inedges:rt,halfedges:it,triangles:st}}=this,ot=rt[_e];if(ot===-1)return null;const at=[];let lt=ot;do{const ct=Math.floor(lt/3);if(at.push(et[ct*2],et[ct*2+1]),lt=lt%3===2?lt-2:lt+1,st[lt]!==_e)break;lt=it[lt]}while(lt!==ot&&lt!==-1);return at}_clip(_e){if(_e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const et=this._cell(_e);if(et===null)return null;const{vectors:rt}=this,it=_e*4;return this._simplify(rt[it]||rt[it+1]?this._clipInfinite(_e,et,rt[it],rt[it+1],rt[it+2],rt[it+3]):this._clipFinite(_e,et))}_clipFinite(_e,et){const rt=et.length;let it=null,st,ot,at=et[rt-2],lt=et[rt-1],ct,ut=this._regioncode(at,lt),ht,dt=0;for(let ft=0;ft<rt;ft+=2)if(st=at,ot=lt,at=et[ft],lt=et[ft+1],ct=ut,ut=this._regioncode(at,lt),ct===0&&ut===0)ht=dt,dt=0,it?it.push(at,lt):it=[at,lt];else{let pt,mt,At,gt,bt;if(ct===0){if((pt=this._clipSegment(st,ot,at,lt,ct,ut))===null)continue;[mt,At,gt,bt]=pt}else{if((pt=this._clipSegment(at,lt,st,ot,ut,ct))===null)continue;[gt,bt,mt,At]=pt,ht=dt,dt=this._edgecode(mt,At),ht&&dt&&this._edge(_e,ht,dt,it,it.length),it?it.push(mt,At):it=[mt,At]}ht=dt,dt=this._edgecode(gt,bt),ht&&dt&&this._edge(_e,ht,dt,it,it.length),it?it.push(gt,bt):it=[gt,bt]}if(it)ht=dt,dt=this._edgecode(it[0],it[1]),ht&&dt&&this._edge(_e,ht,dt,it,it.length);else if(this.contains(_e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return it}_clipSegment(_e,et,rt,it,st,ot){const at=st<ot;for(at&&([_e,et,rt,it,st,ot]=[rt,it,_e,et,ot,st]);;){if(st===0&&ot===0)return at?[rt,it,_e,et]:[_e,et,rt,it];if(st&ot)return null;let lt,ct,ut=st||ot;ut&8?(lt=_e+(rt-_e)*(this.ymax-et)/(it-et),ct=this.ymax):ut&4?(lt=_e+(rt-_e)*(this.ymin-et)/(it-et),ct=this.ymin):ut&2?(ct=et+(it-et)*(this.xmax-_e)/(rt-_e),lt=this.xmax):(ct=et+(it-et)*(this.xmin-_e)/(rt-_e),lt=this.xmin),st?(_e=lt,et=ct,st=this._regioncode(_e,et)):(rt=lt,it=ct,ot=this._regioncode(rt,it))}}_clipInfinite(_e,et,rt,it,st,ot){let at=Array.from(et),lt;if((lt=this._project(at[0],at[1],rt,it))&&at.unshift(lt[0],lt[1]),(lt=this._project(at[at.length-2],at[at.length-1],st,ot))&&at.push(lt[0],lt[1]),at=this._clipFinite(_e,at))for(let ct=0,ut=at.length,ht,dt=this._edgecode(at[ut-2],at[ut-1]);ct<ut;ct+=2)ht=dt,dt=this._edgecode(at[ct],at[ct+1]),ht&&dt&&(ct=this._edge(_e,ht,dt,at,ct),ut=at.length);else this.contains(_e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(at=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return at}_edge(_e,et,rt,it,st){for(;et!==rt;){let ot,at;switch(et){case 5:et=4;continue;case 4:et=6,ot=this.xmax,at=this.ymin;break;case 6:et=2;continue;case 2:et=10,ot=this.xmax,at=this.ymax;break;case 10:et=8;continue;case 8:et=9,ot=this.xmin,at=this.ymax;break;case 9:et=1;continue;case 1:et=5,ot=this.xmin,at=this.ymin;break}(it[st]!==ot||it[st+1]!==at)&&this.contains(_e,ot,at)&&(it.splice(st,0,ot,at),st+=2)}return st}_project(_e,et,rt,it){let st=1/0,ot,at,lt;if(it<0){if(et<=this.ymin)return null;(ot=(this.ymin-et)/it)<st&&(lt=this.ymin,at=_e+(st=ot)*rt)}else if(it>0){if(et>=this.ymax)return null;(ot=(this.ymax-et)/it)<st&&(lt=this.ymax,at=_e+(st=ot)*rt)}if(rt>0){if(_e>=this.xmax)return null;(ot=(this.xmax-_e)/rt)<st&&(at=this.xmax,lt=et+(st=ot)*it)}else if(rt<0){if(_e<=this.xmin)return null;(ot=(this.xmin-_e)/rt)<st&&(at=this.xmin,lt=et+(st=ot)*it)}return[at,lt]}_edgecode(_e,et){return(_e===this.xmin?1:_e===this.xmax?2:0)|(et===this.ymin?4:et===this.ymax?8:0)}_regioncode(_e,et){return(_e<this.xmin?1:_e>this.xmax?2:0)|(et<this.ymin?4:et>this.ymax?8:0)}_simplify(_e){if(_e&&_e.length>4){for(let et=0;et<_e.length;et+=2){const rt=(et+2)%_e.length,it=(et+4)%_e.length;(_e[et]===_e[rt]&&_e[rt]===_e[it]||_e[et+1]===_e[rt+1]&&_e[rt+1]===_e[it+1])&&(_e.splice(rt,2),et-=2)}_e.length||(_e=null)}return _e}}const tau=2*Math.PI,pow$1=Math.pow;function pointX(nt){return nt[0]}function pointY(nt){return nt[1]}function collinear(nt){const{triangles:_e,coords:et}=nt;for(let rt=0;rt<_e.length;rt+=3){const it=2*_e[rt],st=2*_e[rt+1],ot=2*_e[rt+2];if((et[ot]-et[it])*(et[st+1]-et[it+1])-(et[st]-et[it])*(et[ot+1]-et[it+1])>1e-10)return!1}return!0}function jitter(nt,_e,et){return[nt+Math.sin(nt+_e)*et,_e+Math.cos(nt-_e)*et]}class Delaunay{static from(_e,et=pointX,rt=pointY,it){return new Delaunay("length"in _e?flatArray(_e,et,rt,it):Float64Array.from(flatIterable(_e,et,rt,it)))}constructor(_e){this._delaunator=new Delaunator(_e),this.inedges=new Int32Array(_e.length/2),this._hullIndex=new Int32Array(_e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const _e=this._delaunator,et=this.points;if(_e.hull&&_e.hull.length>2&&collinear(_e)){this.collinear=Int32Array.from({length:et.length/2},(dt,ft)=>ft).sort((dt,ft)=>et[2*dt]-et[2*ft]||et[2*dt+1]-et[2*ft+1]);const lt=this.collinear[0],ct=this.collinear[this.collinear.length-1],ut=[et[2*lt],et[2*lt+1],et[2*ct],et[2*ct+1]],ht=1e-8*Math.hypot(ut[3]-ut[1],ut[2]-ut[0]);for(let dt=0,ft=et.length/2;dt<ft;++dt){const pt=jitter(et[2*dt],et[2*dt+1],ht);et[2*dt]=pt[0],et[2*dt+1]=pt[1]}this._delaunator=new Delaunator(et)}else delete this.collinear;const rt=this.halfedges=this._delaunator.halfedges,it=this.hull=this._delaunator.hull,st=this.triangles=this._delaunator.triangles,ot=this.inedges.fill(-1),at=this._hullIndex.fill(-1);for(let lt=0,ct=rt.length;lt<ct;++lt){const ut=st[lt%3===2?lt-2:lt+1];(rt[lt]===-1||ot[ut]===-1)&&(ot[ut]=lt)}for(let lt=0,ct=it.length;lt<ct;++lt)at[it[lt]]=lt;it.length<=2&&it.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=it[0],ot[it[0]]=1,it.length===2&&(ot[it[1]]=0,this.triangles[1]=it[1],this.triangles[2]=it[1]))}voronoi(_e){return new Voronoi(this,_e)}*neighbors(_e){const{inedges:et,hull:rt,_hullIndex:it,halfedges:st,triangles:ot,collinear:at}=this;if(at){const ht=at.indexOf(_e);ht>0&&(yield at[ht-1]),ht<at.length-1&&(yield at[ht+1]);return}const lt=et[_e];if(lt===-1)return;let ct=lt,ut=-1;do{if(yield ut=ot[ct],ct=ct%3===2?ct-2:ct+1,ot[ct]!==_e)return;if(ct=st[ct],ct===-1){const ht=rt[(it[_e]+1)%rt.length];ht!==ut&&(yield ht);return}}while(ct!==lt)}find(_e,et,rt=0){if(_e=+_e,_e!==_e||(et=+et,et!==et))return-1;const it=rt;let st;for(;(st=this._step(rt,_e,et))>=0&&st!==rt&&st!==it;)rt=st;return st}_step(_e,et,rt){const{inedges:it,hull:st,_hullIndex:ot,halfedges:at,triangles:lt,points:ct}=this;if(it[_e]===-1||!ct.length)return(_e+1)%(ct.length>>1);let ut=_e,ht=pow$1(et-ct[_e*2],2)+pow$1(rt-ct[_e*2+1],2);const dt=it[_e];let ft=dt;do{let pt=lt[ft];const mt=pow$1(et-ct[pt*2],2)+pow$1(rt-ct[pt*2+1],2);if(mt<ht&&(ht=mt,ut=pt),ft=ft%3===2?ft-2:ft+1,lt[ft]!==_e)break;if(ft=at[ft],ft===-1){if(ft=st[(ot[_e]+1)%st.length],ft!==pt&&pow$1(et-ct[ft*2],2)+pow$1(rt-ct[ft*2+1],2)<ht)return ft;break}}while(ft!==dt);return ut}render(_e){const et=_e==null?_e=new Path:void 0,{points:rt,halfedges:it,triangles:st}=this;for(let ot=0,at=it.length;ot<at;++ot){const lt=it[ot];if(lt<ot)continue;const ct=st[ot]*2,ut=st[lt]*2;_e.moveTo(rt[ct],rt[ct+1]),_e.lineTo(rt[ut],rt[ut+1])}return this.renderHull(_e),et&&et.value()}renderPoints(_e,et){et===void 0&&(!_e||typeof _e.moveTo!="function")&&(et=_e,_e=null),et=et==null?2:+et;const rt=_e==null?_e=new Path:void 0,{points:it}=this;for(let st=0,ot=it.length;st<ot;st+=2){const at=it[st],lt=it[st+1];_e.moveTo(at+et,lt),_e.arc(at,lt,et,0,tau)}return rt&&rt.value()}renderHull(_e){const et=_e==null?_e=new Path:void 0,{hull:rt,points:it}=this,st=rt[0]*2,ot=rt.length;_e.moveTo(it[st],it[st+1]);for(let at=1;at<ot;++at){const lt=2*rt[at];_e.lineTo(it[lt],it[lt+1])}return _e.closePath(),et&&et.value()}hullPolygon(){const _e=new Polygon;return this.renderHull(_e),_e.value()}renderTriangle(_e,et){const rt=et==null?et=new Path:void 0,{points:it,triangles:st}=this,ot=st[_e*=3]*2,at=st[_e+1]*2,lt=st[_e+2]*2;return et.moveTo(it[ot],it[ot+1]),et.lineTo(it[at],it[at+1]),et.lineTo(it[lt],it[lt+1]),et.closePath(),rt&&rt.value()}*trianglePolygons(){const{triangles:_e}=this;for(let et=0,rt=_e.length/3;et<rt;++et)yield this.trianglePolygon(et)}trianglePolygon(_e){const et=new Polygon;return this.renderTriangle(_e,et),et.value()}}function flatArray(nt,_e,et,rt){const it=nt.length,st=new Float64Array(it*2);for(let ot=0;ot<it;++ot){const at=nt[ot];st[ot*2]=_e.call(rt,at,ot,nt),st[ot*2+1]=et.call(rt,at,ot,nt)}return st}function*flatIterable(nt,_e,et,rt){let it=0;for(const st of nt)yield _e.call(rt,st,it,nt),yield et.call(rt,st,it,nt),++it}const pi=Math.PI,halfPi=pi/2,degrees$2=180/pi,radians$1=pi/180,atan2$1=Math.atan2,cos$1=Math.cos,max=Math.max,min=Math.min,sin$1=Math.sin,sign$1=Math.sign||function(nt){return nt>0?1:nt<0?-1:0},sqrt$1=Math.sqrt;function asin$1(nt){return nt>1?halfPi:nt<-1?-halfPi:Math.asin(nt)}function cartesianDot(nt,_e){return nt[0]*_e[0]+nt[1]*_e[1]+nt[2]*_e[2]}function cartesianCross(nt,_e){return[nt[1]*_e[2]-nt[2]*_e[1],nt[2]*_e[0]-nt[0]*_e[2],nt[0]*_e[1]-nt[1]*_e[0]]}function cartesianAdd(nt,_e){return[nt[0]+_e[0],nt[1]+_e[1],nt[2]+_e[2]]}function cartesianNormalize(nt){var _e=sqrt$1(nt[0]*nt[0]+nt[1]*nt[1]+nt[2]*nt[2]);return[nt[0]/_e,nt[1]/_e,nt[2]/_e]}function spherical(nt){return[atan2$1(nt[1],nt[0])*degrees$2,asin$1(max(-1,min(1,nt[2])))*degrees$2]}function cartesian(nt){const _e=nt[0]*radians$1,et=nt[1]*radians$1,rt=cos$1(et);return[rt*cos$1(_e),rt*sin$1(_e),sin$1(et)]}function excess(nt){return nt=nt.map(_e=>cartesian(_e)),cartesianDot(nt[0],cartesianCross(nt[2],nt[1]))}function geoDelaunay(nt){const _e=geo_delaunay_from(nt),et=geo_triangles(_e),rt=geo_edges(et,nt),it=geo_neighbors(et,nt.length),st=geo_find(it,nt),ot=geo_circumcenters(et,nt),{polygons:at,centers:lt}=geo_polygons(ot,et,nt),ct=geo_mesh(at),ut=geo_hull(et,nt),ht=geo_urquhart(rt,et);return{delaunay:_e,edges:rt,triangles:et,centers:lt,neighbors:it,polygons:at,mesh:ct,hull:ut,urquhart:ht,find:st}}function geo_find(nt,_e){function et(rt,it){let st=rt[0]-it[0],ot=rt[1]-it[1],at=rt[2]-it[2];return st*st+ot*ot+at*at}return function(it,st,ot){ot===void 0&&(ot=0);let at,lt,ct=ot;const ut=cartesian([it,st]);do at=ot,ot=null,lt=et(ut,cartesian(_e[at])),nt[at].forEach(ht=>{let dt=et(ut,cartesian(_e[ht]));if(dt<lt){lt=dt,ot=ht,ct=ht;return}});while(ot!==null);return ct}}function geo_delaunay_from(nt){if(nt.length<2)return{};let _e=0;for(;isNaN(nt[_e][0]+nt[_e][1])&&_e++<nt.length;);const et=geoRotation(nt[_e]),rt=geoStereographic().translate([0,0]).scale(1).rotate(et.invert([180,0]));nt=nt.map(rt);const it=[];let st=1;for(let ht=0,dt=nt.length;ht<dt;ht++){let ft=nt[ht][0]**2+nt[ht][1]**2;!isFinite(ft)||ft>1e32?it.push(ht):ft>st&&(st=ft)}const ot=1e6*sqrt$1(st);it.forEach(ht=>nt[ht]=[ot,0]),nt.push([0,ot]),nt.push([-ot,0]),nt.push([0,-ot]);const at=Delaunay.from(nt);at.projection=rt;const{triangles:lt,halfedges:ct,inedges:ut}=at;for(let ht=0,dt=ct.length;ht<dt;ht++)if(ct[ht]<0){const ft=ht%3==2?ht-2:ht+1,pt=ht%3==0?ht+2:ht-1,mt=ct[ft],At=ct[pt];ct[mt]=At,ct[At]=mt,ct[ft]=ct[pt]=-1,lt[ht]=lt[ft]=lt[pt]=_e,ut[lt[mt]]=mt%3==0?mt+2:mt-1,ut[lt[At]]=At%3==0?At+2:At-1,ht+=2-ht%3}else lt[ht]>nt.length-3-1&&(lt[ht]=_e);return at}function geo_edges(nt,_e){const et=new Set;return _e.length===2?[[0,1]]:(nt.forEach(rt=>{if(rt[0]!==rt[1]&&!(excess(rt.map(it=>_e[it]))<0))for(let it=0,st;it<3;it++)st=(it+1)%3,et.add(extent([rt[it],rt[st]]).join("-"))}),Array.from(et,rt=>rt.split("-").map(Number)))}function geo_triangles(nt){const{triangles:_e}=nt;if(!_e)return[];const et=[];for(let rt=0,it=_e.length/3;rt<it;rt++){const st=_e[3*rt],ot=_e[3*rt+1],at=_e[3*rt+2];st!==ot&&ot!==at&&et.push([st,at,ot])}return et}function geo_circumcenters(nt,_e){return nt.map(et=>{const rt=et.map(st=>_e[st]).map(cartesian),it=cartesianAdd(cartesianAdd(cartesianCross(rt[1],rt[0]),cartesianCross(rt[2],rt[1])),cartesianCross(rt[0],rt[2]));return spherical(cartesianNormalize(it))})}function geo_neighbors(nt,_e){const et=[];return nt.forEach(rt=>{for(let it=0;it<3;it++){const st=rt[it],ot=rt[(it+1)%3];et[st]=et[st]||[],et[st].push(ot)}}),nt.length===0&&(_e===2?(et[0]=[1],et[1]=[0]):_e===1&&(et[0]=[])),et}function geo_polygons(nt,_e,et){const rt=[],it=nt.slice();if(_e.length===0){if(et.length<2)return{polygons:rt,centers:it};if(et.length===2){const at=cartesian(et[0]),lt=cartesian(et[1]),ct=cartesianNormalize(cartesianAdd(at,lt)),ut=cartesianNormalize(cartesianCross(at,lt)),ht=cartesianCross(ct,ut),dt=[ct,cartesianCross(ct,ht),cartesianCross(cartesianCross(ct,ht),ht),cartesianCross(cartesianCross(cartesianCross(ct,ht),ht),ht)].map(spherical).map(ot);return rt.push(dt),rt.push(dt.slice().reverse()),{polygons:rt,centers:it}}}_e.forEach((at,lt)=>{for(let ct=0;ct<3;ct++){const ut=at[ct],ht=at[(ct+1)%3],dt=at[(ct+2)%3];rt[ut]=rt[ut]||[],rt[ut].push([ht,dt,lt,[ut,ht,dt]])}});const st=rt.map(at=>{const lt=[at[0][2]];let ct=at[0][1];for(let ut=1;ut<at.length;ut++)for(let ht=0;ht<at.length;ht++)if(at[ht][0]==ct){ct=at[ht][1],lt.push(at[ht][2]);break}if(lt.length>2)return lt;if(lt.length==2){const ut=o_midpoint(et[at[0][3][0]],et[at[0][3][1]],it[lt[0]]),ht=o_midpoint(et[at[0][3][2]],et[at[0][3][0]],it[lt[0]]),dt=ot(ut),ft=ot(ht);return[lt[0],ft,lt[1],dt]}});function ot(at){let lt=-1;return it.slice(_e.length,1/0).forEach((ct,ut)=>{ct[0]===at[0]&&ct[1]===at[1]&&(lt=ut+_e.length)}),lt<0&&(lt=it.length,it.push(at)),lt}return{polygons:st,centers:it}}function o_midpoint(nt,_e,et){nt=cartesian(nt),_e=cartesian(_e),et=cartesian(et);const rt=sign$1(cartesianDot(cartesianCross(_e,nt),et));return spherical(cartesianNormalize(cartesianAdd(nt,_e)).map(it=>rt*it))}function geo_mesh(nt){const _e=[];return nt.forEach(et=>{if(!et)return;let rt=et[et.length-1];for(let it of et)it>rt&&_e.push([rt,it]),rt=it}),_e}function geo_urquhart(nt,_e){return function(et){const rt=new Map,it=new Map;return nt.forEach((st,ot)=>{const at=st.join("-");rt.set(at,et[ot]),it.set(at,!0)}),_e.forEach(st=>{let ot=0,at=-1;for(let lt=0;lt<3;lt++){let ct=extent([st[lt],st[(lt+1)%3]]).join("-");rt.get(ct)>ot&&(ot=rt.get(ct),at=ct)}it.set(at,!1)}),nt.map(st=>it.get(st.join("-")))}}function geo_hull(nt,_e){const et=new Set,rt=[];nt.map(at=>{if(!(excess(at.map(lt=>_e[lt>_e.length?0:lt]))>1e-12))for(let lt=0;lt<3;lt++){let ct=[at[lt],at[(lt+1)%3]],ut=`${ct[0]}-${ct[1]}`;et.has(ut)?et.delete(ut):et.add(`${ct[1]}-${ct[0]}`)}});const it=new Map;let st;if(et.forEach(at=>{at=at.split("-").map(Number),it.set(at[0],at[1]),st=at[0]}),st===void 0)return rt;let ot=st;do{rt.push(ot);let at=it.get(ot);it.set(ot,-1),ot=at}while(ot>-1&&ot!==st);return rt}function geoVoronoi(nt){const _e=function(et){if(_e.delaunay=null,_e._data=et,typeof _e._data=="object"&&_e._data.type==="FeatureCollection"&&(_e._data=_e._data.features),typeof _e._data=="object"){const rt=_e._data.map(it=>[_e._vx(it),_e._vy(it),it]).filter(it=>isFinite(it[0]+it[1]));_e.points=rt.map(it=>[it[0],it[1]]),_e.valid=rt.map(it=>it[2]),_e.delaunay=geoDelaunay(_e.points)}return _e};return _e._vx=function(et){if(typeof et=="object"&&"type"in et)return geoCentroid(et)[0];if(0 in et)return et[0]},_e._vy=function(et){if(typeof et=="object"&&"type"in et)return geoCentroid(et)[1];if(1 in et)return et[1]},_e.x=function(et){return et?(_e._vx=et,_e):_e._vx},_e.y=function(et){return et?(_e._vy=et,_e):_e._vy},_e.polygons=function(et){if(et!==void 0&&_e(et),!_e.delaunay)return!1;const rt={type:"FeatureCollection",features:[]};return _e.valid.length===0||(_e.delaunay.polygons.forEach((it,st)=>rt.features.push({type:"Feature",geometry:it?{type:"Polygon",coordinates:[[...it,it[0]].map(ot=>_e.delaunay.centers[ot])]}:null,properties:{site:_e.valid[st],sitecoordinates:_e.points[st],neighbours:_e.delaunay.neighbors[st]}})),_e.valid.length===1&&rt.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:_e.valid[0],sitecoordinates:_e.points[0],neighbours:[]}})),rt},_e.triangles=function(et){return et!==void 0&&_e(et),_e.delaunay?{type:"FeatureCollection",features:_e.delaunay.triangles.map((rt,it)=>(rt=rt.map(st=>_e.points[st]),rt.center=_e.delaunay.centers[it],rt)).filter(rt=>excess(rt)>0).map(rt=>({type:"Feature",properties:{circumcenter:rt.center},geometry:{type:"Polygon",coordinates:[[...rt,rt[0]]]}}))}:!1},_e.links=function(et){if(et!==void 0&&_e(et),!_e.delaunay)return!1;const rt=_e.delaunay.edges.map(st=>geoDistance$1(_e.points[st[0]],_e.points[st[1]])),it=_e.delaunay.urquhart(rt);return{type:"FeatureCollection",features:_e.delaunay.edges.map((st,ot)=>({type:"Feature",properties:{source:_e.valid[st[0]],target:_e.valid[st[1]],length:rt[ot],urquhart:!!it[ot]},geometry:{type:"LineString",coordinates:[_e.points[st[0]],_e.points[st[1]]]}}))}},_e.mesh=function(et){return et!==void 0&&_e(et),_e.delaunay?{type:"MultiLineString",coordinates:_e.delaunay.edges.map(rt=>[_e.points[rt[0]],_e.points[rt[1]]])}:!1},_e.cellMesh=function(et){if(et!==void 0&&_e(et),!_e.delaunay)return!1;const{centers:rt,polygons:it}=_e.delaunay,st=[];for(const ot of it)if(ot)for(let at=ot.length,lt=ot[at-1],ct=ot[0],ut=0;ut<at;lt=ct,ct=ot[++ut])ct>lt&&st.push([rt[lt],rt[ct]]);return{type:"MultiLineString",coordinates:st}},_e._found=void 0,_e.find=function(et,rt,it){if(_e._found=_e.delaunay.find(et,rt,_e._found),!it||geoDistance$1([et,rt],_e.points[_e._found])<it)return _e._found},_e.hull=function(et){et!==void 0&&_e(et);const rt=_e.delaunay.hull,it=_e.points;return rt.length===0?null:{type:"Polygon",coordinates:[[...rt.map(st=>it[st]),it[rt[0]]]]}},nt?_e(nt):_e}function _arrayLikeToArray$3(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles$2(nt){if(Array.isArray(nt))return nt}function _arrayWithoutHoles$3(nt){if(Array.isArray(nt))return _arrayLikeToArray$3(nt)}function _assertThisInitialized$2(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _callSuper$1(nt,_e,et){return _e=_getPrototypeOf$2(_e),_possibleConstructorReturn$1(nt,_isNativeReflectConstruct$2()?Reflect.construct(_e,[],_getPrototypeOf$2(nt).constructor):_e.apply(nt,et))}function _classCallCheck$1(nt,_e){if(!(nt instanceof _e))throw new TypeError("Cannot call a class as a function")}function _createClass$1(nt,_e,et){return Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _getPrototypeOf$2(nt){return _getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf$2(nt)}function _inherits$1(nt,_e){if(typeof _e!="function"&&_e!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(_e&&_e.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),_e&&_setPrototypeOf$2(nt,_e)}function _isNativeReflectConstruct$2(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$2=function(){return!!nt})()}function _iterableToArray$3(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _iterableToArrayLimit$2(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e!==0)for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread$3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _possibleConstructorReturn$1(nt,_e){if(_e&&(typeof _e=="object"||typeof _e=="function"))return _e;if(_e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(nt)}function _setPrototypeOf$2(nt,_e){return _setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(et,rt){return et.__proto__=rt,et},_setPrototypeOf$2(nt,_e)}function _slicedToArray$2(nt,_e){return _arrayWithHoles$2(nt)||_iterableToArrayLimit$2(nt,_e)||_unsupportedIterableToArray$3(nt,_e)||_nonIterableRest$2()}function _toConsumableArray$3(nt){return _arrayWithoutHoles$3(nt)||_iterableToArray$3(nt)||_unsupportedIterableToArray$3(nt)||_nonIterableSpread$3()}function _unsupportedIterableToArray$3(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$3(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$3(nt,_e):void 0}}function geoPolygonTriangulate(nt){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},et=_e.resolution,rt=et===void 0?1/0:et,it=interpolateContourPoints(nt,rt),st=merge(it),ot=getInnerGeoPoints(nt,rt),at=[].concat(_toConsumableArray$3(st),_toConsumableArray$3(ot)),lt={type:"Polygon",coordinates:nt},ct=geoBounds(lt),ut=_slicedToArray$2(ct,2),ht=_slicedToArray$2(ut[0],2),dt=ht[0],ft=ht[1],pt=_slicedToArray$2(ut[1],2),mt=pt[0],At=pt[1],gt=dt>mt||At>=89||ft<=-89,bt=[];if(gt){var Tt=geoVoronoi(at).triangles(),wt=new Map(at.map(function(rn,Gt){var jt=_slicedToArray$2(rn,2),Kt=jt[0],Jt=jt[1];return["".concat(Kt,"-").concat(Jt),Gt]}));Tt.features.forEach(function(rn){var Gt,jt=rn.geometry.coordinates[0].slice(0,3).reverse(),Kt=[];if(jt.forEach(function(sn){var hn=_slicedToArray$2(sn,2),an=hn[0],pn=hn[1],_n="".concat(an,"-").concat(pn);wt.has(_n)&&Kt.push(wt.get(_n))}),Kt.length===3){if(Kt.some(function(sn){return sn<st.length})){var Jt=rn.properties.circumcenter;if(!pointInside(Jt,lt,gt))return}(Gt=bt).push.apply(Gt,Kt)}})}else if(ot.length)for(var kt=Delaunator.from(at),Dt=function(Gt){var jt,Kt=[2,1,0].map(function(hn){return kt.triangles[Gt+hn]}),Jt=Kt.map(function(hn){return at[hn]});if(Kt.some(function(hn){return hn<st.length})){var sn=[0,1].map(function(hn){return mean(Jt,function(an){return an[hn]})});if(!pointInside(sn,lt,gt))return 1}(jt=bt).push.apply(jt,_toConsumableArray$3(Kt))},Ot=0,zt=kt.triangles.length;Ot<zt;Ot+=3)Dt(Ot);else{var Rt=flatten$1(it),It=Rt.vertices,Lt=Rt.holes,$t=Lt===void 0?[]:Lt;bt=earcut(It,$t,2)}var Ht=linear(extent(at,function(rn){return rn[0]}),[0,1]),Yt=linear(extent(at,function(rn){return rn[1]}),[0,1]),Xt=at.map(function(rn){var Gt=_slicedToArray$2(rn,2),jt=Gt[0],Kt=Gt[1];return[Ht(jt),Yt(Kt)]}),Zt={points:at,indices:bt,uvs:Xt};return{contour:it,triangles:Zt}}function interpolateContourPoints(nt,_e){return nt.map(function(et){var rt=[],it;return et.forEach(function(st){if(it){var ot=geoDistance$1(st,it)*180/Math.PI;if(ot>_e)for(var at=geoInterpolate(it,st),lt=1/Math.ceil(ot/_e),ct=lt;ct<1;)rt.push(at(ct)),ct+=lt}rt.push(it=st)}),rt})}function getInnerGeoPoints(nt,_e){var et={type:"Polygon",coordinates:nt},rt=geoBounds(et),it=_slicedToArray$2(rt,2),st=_slicedToArray$2(it[0],2),ot=st[0],at=st[1],lt=_slicedToArray$2(it[1],2),ct=lt[0],ut=lt[1];if(Math.min(Math.abs(ct-ot),Math.abs(ut-at))<_e)return[];var ht=ot>ct||ut>=89||at<=-89;return getGeoSpiralGrid(_e,{minLng:ot,maxLng:ct,minLat:at,maxLat:ut}).filter(function(dt){return pointInside(dt,et,ht)})}function getGeoSpiralGrid(nt){for(var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},et=_e.minLng,rt=_e.maxLng,it=_e.minLat,st=_e.maxLat,ot=Math.round(Math.pow(360/nt,2)/Math.PI),at=(1+Math.sqrt(5))/2,lt=function(gt){return gt/at*360%360-180},ct=function(gt){return Math.acos(2*gt/ot-1)/Math.PI*180-90},ut=function(gt){return ot*(Math.cos((gt+90)*Math.PI/180)+1)/2},ht=[st!==void 0?Math.ceil(ut(st)):0,it!==void 0?Math.floor(ut(it)):ot-1],dt=et===void 0&&rt===void 0?function(){return!0}:et===void 0?function(At){return At<=rt}:rt===void 0?function(At){return At>=et}:rt>=et?function(At){return At>=et&&At<=rt}:function(At){return At>=et||At<=rt},ft=[],pt=ht[0];pt<=ht[1];pt++){var mt=lt(pt);dt(mt)&&ft.push([mt,ct(pt)])}return ft}function pointInside(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return et?geoContains(_e,nt):turf_boolean_point_in_polygon_default(nt,_e)}var THREE$j=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,Float32BufferAttribute:Float32BufferAttribute$1},setAttributeFn=new THREE$j.BufferGeometry().setAttribute?"setAttribute":"addAttribute",ConicPolygonBufferGeometry=function(nt){function _e(et,rt,it,st,ot,at,lt){var ct;_classCallCheck$1(this,_e),ct=_callSuper$1(this,_e),ct.type="ConicPolygonBufferGeometry",ct.parameters={polygonGeoJson:et,startHeight:rt,endHeight:it,closedBottom:st,closedTop:ot,includeSides:at,curvatureResolution:lt},rt=rt||0,it=it||1,st=st!==void 0?st:!0,ot=ot!==void 0?ot:!0,at=at!==void 0?at:!0,lt=lt||5;var ut=geoPolygonTriangulate(et,{resolution:lt}),ht=ut.contour,dt=ut.triangles,ft=merge(dt.uvs),pt=[],mt=[],At=[],gt=0,bt=function(Lt){var $t=Math.round(pt.length/3),kt=At.length;pt=pt.concat(Lt.vertices),mt=mt.concat(Lt.uvs),At=At.concat($t?Lt.indices.map(function(Dt){return Dt+$t}):Lt.indices),ct.addGroup(kt,At.length-kt,gt++)};at&&bt(wt()),st&&bt(Rt(rt,!1)),ot&&bt(Rt(it,!0)),ct.setIndex(At),ct[setAttributeFn]("position",new THREE$j.Float32BufferAttribute(pt,3)),ct[setAttributeFn]("uv",new THREE$j.Float32BufferAttribute(mt,2)),ct.computeVertexNormals();function Tt(It,Lt){var $t=It.map(function(kt){return kt.map(function(Dt){var Ot=_slicedToArray$2(Dt,2),zt=Ot[0],Ht=Ot[1];return polar2Cartesian$1(Ht,zt,Lt)})});return flatten$1($t)}function wt(){for(var It=Tt(ht,rt),Lt=It.vertices,$t=It.holes,kt=Tt(ht,it),Dt=kt.vertices,Ot=merge([Dt,Lt]),zt=Math.round(Dt.length/3),Ht=new Set($t),Yt=0,Xt=[],Zt=0;Zt<zt;Zt++){var rn=Zt+1;if(rn===zt)rn=Yt;else if(Ht.has(rn)){var Gt=rn;rn=Yt,Yt=Gt}Xt.push(Zt,Zt+zt,rn+zt),Xt.push(rn+zt,rn,Zt)}for(var jt=[],Kt=1;Kt>=0;Kt--)for(var Jt=0;Jt<zt;Jt+=1)jt.push(Jt/(zt-1),Kt);return{indices:Xt,vertices:Ot,uvs:jt}}function Rt(It){var Lt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:Lt?dt.indices:dt.indices.slice().reverse(),vertices:Tt([dt.points],It).vertices,uvs:ft}}return ct}return _inherits$1(_e,nt),_createClass$1(_e)}(THREE$j.BufferGeometry);function polar2Cartesian$1(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,rt=(90-nt)*Math.PI/180,it=(90-_e)*Math.PI/180;return[et*Math.sin(rt)*Math.cos(it),et*Math.cos(rt),et*Math.sin(rt)*Math.sin(it)]}var libh3=function(nt){nt=nt||{};var _e=typeof nt<"u"?nt:{},et={},rt;for(rt in _e)_e.hasOwnProperty(rt)&&(et[rt]=_e[rt]);var it="";function st(zn){return _e.locateFile?_e.locateFile(zn,it):it+zn}var ot;typeof document<"u"&&document.currentScript&&(it=document.currentScript.src),it.indexOf("blob:")!==0?it=it.substr(0,it.lastIndexOf("/")+1):it="",ot=function(lr,Sr,Or){var xt=new XMLHttpRequest;xt.open("GET",lr,!0),xt.responseType="arraybuffer",xt.onload=function(){if(xt.status==200||xt.status==0&&xt.response){Sr(xt.response);return}var os=Nn(lr);if(os){Sr(os.buffer);return}Or()},xt.onerror=Or,xt.send(null)};var at=_e.print||console.log.bind(console),lt=_e.printErr||console.warn.bind(console);for(rt in et)et.hasOwnProperty(rt)&&(_e[rt]=et[rt]);et=null,_e.arguments&&_e.arguments;var ct=0,ut=function(zn){ct=zn},ht=function(){return ct},dt=8;function ft(zn,lr,Sr,Or){switch(Sr=Sr||"i8",Sr.charAt(Sr.length-1)==="*"&&(Sr="i32"),Sr){case"i1":zt[zn>>0]=lr;break;case"i8":zt[zn>>0]=lr;break;case"i16":Yt[zn>>1]=lr;break;case"i32":Xt[zn>>2]=lr;break;case"i64":In=[lr>>>0,(Mn=lr,+dn(Mn)>=1?Mn>0?(Yn(+er(Mn/4294967296),4294967295)|0)>>>0:~~+rr((Mn-+(~~Mn>>>0))/4294967296)>>>0:0)],Xt[zn>>2]=In[0],Xt[zn+4>>2]=In[1];break;case"float":Zt[zn>>2]=lr;break;case"double":rn[zn>>3]=lr;break;default:Us("invalid type for setValue: "+Sr)}}function pt(zn,lr,Sr){switch(lr=lr||"i8",lr.charAt(lr.length-1)==="*"&&(lr="i32"),lr){case"i1":return zt[zn>>0];case"i8":return zt[zn>>0];case"i16":return Yt[zn>>1];case"i32":return Xt[zn>>2];case"i64":return Xt[zn>>2];case"float":return Zt[zn>>2];case"double":return rn[zn>>3];default:Us("invalid type for getValue: "+lr)}return null}var mt=!1;function At(zn,lr){zn||Us("Assertion failed: "+lr)}function gt(zn){var lr=_e["_"+zn];return At(lr,"Cannot call unknown function "+zn+", make sure it is exported"),lr}function bt(zn,lr,Sr,Or,xt){var mn={string:function(Cn){var xr=0;if(Cn!=null&&Cn!==0){var Nr=(Cn.length<<2)+1;xr=jr(Nr),$t(Cn,xr,Nr)}return xr},array:function(Cn){var xr=jr(Cn.length);return kt(Cn,xr),xr}};function os(Cn){return lr==="string"?It(Cn):lr==="boolean"?!!Cn:Cn}var gs=gt(zn),Bs=[],ln=0;if(Or)for(var Rn=0;Rn<Or.length;Rn++){var Wn=mn[Sr[Rn]];Wn?(ln===0&&(ln=Lr()),Bs[Rn]=Wn(Or[Rn])):Bs[Rn]=Or[Rn]}var Un=gs.apply(null,Bs);return Un=os(Un),ln!==0&&Jr(ln),Un}function Tt(zn,lr,Sr,Or){Sr=Sr||[];var xt=Sr.every(function(os){return os==="number"}),mn=lr!=="string";return mn&&xt&&!Or?gt(zn):function(){return bt(zn,lr,Sr,arguments)}}var wt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Rt(zn,lr,Sr){for(var Or=lr+Sr,xt=lr;zn[xt]&&!(xt>=Or);)++xt;if(xt-lr>16&&zn.subarray&&wt)return wt.decode(zn.subarray(lr,xt));for(var mn="";lr<xt;){var os=zn[lr++];if(!(os&128)){mn+=String.fromCharCode(os);continue}var gs=zn[lr++]&63;if((os&224)==192){mn+=String.fromCharCode((os&31)<<6|gs);continue}var Bs=zn[lr++]&63;if((os&240)==224?os=(os&15)<<12|gs<<6|Bs:os=(os&7)<<18|gs<<12|Bs<<6|zn[lr++]&63,os<65536)mn+=String.fromCharCode(os);else{var ln=os-65536;mn+=String.fromCharCode(55296|ln>>10,56320|ln&1023)}}return mn}function It(zn,lr){return zn?Rt(Ht,zn,lr):""}function Lt(zn,lr,Sr,Or){if(!(Or>0))return 0;for(var xt=Sr,mn=Sr+Or-1,os=0;os<zn.length;++os){var gs=zn.charCodeAt(os);if(gs>=55296&&gs<=57343){var Bs=zn.charCodeAt(++os);gs=65536+((gs&1023)<<10)|Bs&1023}if(gs<=127){if(Sr>=mn)break;lr[Sr++]=gs}else if(gs<=2047){if(Sr+1>=mn)break;lr[Sr++]=192|gs>>6,lr[Sr++]=128|gs&63}else if(gs<=65535){if(Sr+2>=mn)break;lr[Sr++]=224|gs>>12,lr[Sr++]=128|gs>>6&63,lr[Sr++]=128|gs&63}else{if(Sr+3>=mn)break;lr[Sr++]=240|gs>>18,lr[Sr++]=128|gs>>12&63,lr[Sr++]=128|gs>>6&63,lr[Sr++]=128|gs&63}}return lr[Sr]=0,Sr-xt}function $t(zn,lr,Sr){return Lt(zn,Ht,lr,Sr)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function kt(zn,lr){zt.set(zn,lr)}function Dt(zn,lr){return zn%lr>0&&(zn+=lr-zn%lr),zn}var Ot,zt,Ht,Yt,Xt,Zt,rn;function Gt(zn){Ot=zn,_e.HEAP8=zt=new Int8Array(zn),_e.HEAP16=Yt=new Int16Array(zn),_e.HEAP32=Xt=new Int32Array(zn),_e.HEAPU8=Ht=new Uint8Array(zn),_e.HEAPU16=new Uint16Array(zn),_e.HEAPU32=new Uint32Array(zn),_e.HEAPF32=Zt=new Float32Array(zn),_e.HEAPF64=rn=new Float64Array(zn)}var jt=5267040,Kt=24128,Jt=_e.TOTAL_MEMORY||33554432;_e.buffer?Ot=_e.buffer:Ot=new ArrayBuffer(Jt),Jt=Ot.byteLength,Gt(Ot),Xt[Kt>>2]=jt;function sn(zn){for(;zn.length>0;){var lr=zn.shift();if(typeof lr=="function"){lr();continue}var Sr=lr.func;typeof Sr=="number"?lr.arg===void 0?_e.dynCall_v(Sr):_e.dynCall_vi(Sr,lr.arg):Sr(lr.arg===void 0?null:lr.arg)}}var hn=[],an=[],pn=[],_n=[];function yn(){if(_e.preRun)for(typeof _e.preRun=="function"&&(_e.preRun=[_e.preRun]);_e.preRun.length;)Vn(_e.preRun.shift());sn(hn)}function $n(){sn(an)}function Jn(){sn(pn)}function Xn(){if(_e.postRun)for(typeof _e.postRun=="function"&&(_e.postRun=[_e.postRun]);_e.postRun.length;)En(_e.postRun.shift());sn(_n)}function Vn(zn){hn.unshift(zn)}function En(zn){_n.unshift(zn)}var dn=Math.abs,rr=Math.ceil,er=Math.floor,Yn=Math.min,ir=0,Qn=null;function sr(zn){ir++,_e.monitorRunDependencies&&_e.monitorRunDependencies(ir)}function un(zn){if(ir--,_e.monitorRunDependencies&&_e.monitorRunDependencies(ir),ir==0&&Qn){var lr=Qn;Qn=null,lr()}}_e.preloadedImages={},_e.preloadedAudios={};var en=null,wn="data:application/octet-stream;base64,";function gn(zn){return String.prototype.startsWith?zn.startsWith(wn):zn.indexOf(wn)===0}var Mn,In;en="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var gr=24144;function jn(zn){return zn}function hr(zn){var lr=/\b__Z[\w\d_]+/g;return zn.replace(lr,function(Sr){var Or=Sr;return Sr===Or?Sr:Or+" ["+Sr+"]"})}function Tr(){var zn=new Error;if(!zn.stack){try{throw new Error(0)}catch(lr){zn=lr}if(!zn.stack)return"(no stack trace available)"}return zn.stack.toString()}function cr(){var zn=Tr();return _e.extraStackTrace&&(zn+=`
`+_e.extraStackTrace()),hr(zn)}function yr(zn,lr,Sr,Or){Us("Assertion failed: "+It(zn)+", at: "+[lr?It(lr):"unknown filename",Sr,Or?It(Or):"unknown function"])}function Rr(){return zt.length}function br(zn,lr,Sr){Ht.set(Ht.subarray(lr,lr+Sr),zn)}function pr(zn){return _e.___errno_location&&(Xt[_e.___errno_location()>>2]=zn),zn}function vn(zn){Us("OOM")}function qn(zn){try{var lr=new ArrayBuffer(zn);return lr.byteLength!=zn?void 0:(new Int8Array(lr).set(zt),Pr(lr),Gt(lr),1)}catch{}}function vr(zn){var lr=Rr(),Sr=16777216,Or=2147483648-Sr;if(zn>Or)return!1;for(var xt=16777216,mn=Math.max(lr,xt);mn<zn;)mn<=536870912?mn=Dt(2*mn,Sr):mn=Math.min(Dt((3*mn+2147483648)/4,Sr),Or);var os=qn(mn);return!!os}var Sn=typeof atob=="function"?atob:function(zn){var lr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Sr="",Or,xt,mn,os,gs,Bs,ln,Rn=0;zn=zn.replace(/[^A-Za-z0-9\+\/\=]/g,"");do os=lr.indexOf(zn.charAt(Rn++)),gs=lr.indexOf(zn.charAt(Rn++)),Bs=lr.indexOf(zn.charAt(Rn++)),ln=lr.indexOf(zn.charAt(Rn++)),Or=os<<2|gs>>4,xt=(gs&15)<<4|Bs>>2,mn=(Bs&3)<<6|ln,Sr=Sr+String.fromCharCode(Or),Bs!==64&&(Sr=Sr+String.fromCharCode(xt)),ln!==64&&(Sr=Sr+String.fromCharCode(mn));while(Rn<zn.length);return Sr};function Ar(zn){try{for(var lr=Sn(zn),Sr=new Uint8Array(lr.length),Or=0;Or<lr.length;++Or)Sr[Or]=lr.charCodeAt(Or);return Sr}catch{throw new Error("Converting base64 string to bytes failed.")}}function Nn(zn){if(gn(zn))return Ar(zn.slice(wn.length))}var nr={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Ir={a:Us,b:ut,c:ht,d:yr,e:pr,f:Rr,g:br,h:vr,i:vn,j:jn,k:hr,l:qn,m:Tr,n:cr,o:gr,p:Kt},Dn=function(zn,lr,Sr){"almost asm";var Or=new zn.Int8Array(Sr),xt=new zn.Int32Array(Sr);new zn.Uint8Array(Sr),new zn.Float32Array(Sr);var mn=new zn.Float64Array(Sr),os=lr.o|0,gs=lr.p|0,Bs=zn.Math.floor,ln=zn.Math.abs,Rn=zn.Math.sqrt,Wn=zn.Math.pow,Un=zn.Math.cos,Cn=zn.Math.sin,xr=zn.Math.tan,Nr=zn.Math.acos,fr=zn.Math.asin,Fr=zn.Math.atan,Gr=zn.Math.atan2,zr=zn.Math.ceil,kr=zn.Math.imul,ls=zn.Math.min,ds=zn.Math.max,ns=zn.Math.clz32,wr=lr.b,cn=lr.c,mr=lr.d,cs=lr.e,Xr=lr.f,Gs=lr.g,Ws=lr.h,ys=lr.i,fn=24160;function Ts(vt){return Or=new Int8Array(vt),xt=new Int32Array(vt),mn=new Float64Array(vt),Sr=vt,!0}function Ao(vt){vt=vt|0;var yt=0;return yt=fn,fn=fn+vt|0,fn=fn+15&-16,yt|0}function Io(){return fn|0}function ws(vt){vt=vt|0,fn=vt}function to(vt,yt){vt=vt|0,fn=vt}function Pl(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0;return(vt|0)<0?(yt=2,yt|0):(vt|0)>13780509?(yt=js(15,yt)|0,yt|0):(_t=((vt|0)<0)<<31>>31,Ct=fo(vt|0,_t|0,3,0)|0,Mt=cn()|0,_t=ts(vt|0,_t|0,1,0)|0,_t=fo(Ct|0,Mt|0,_t|0,cn()|0)|0,_t=ts(_t|0,cn()|0,1,0)|0,vt=cn()|0,xt[yt>>2]=_t,xt[yt+4>>2]=vt,yt=0,yt|0)}function Go(vt,yt,_t,Mt){return vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Su(vt,yt,_t,Mt,0)|0}function Su(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;if(Vt=fn,fn=fn+16|0,Nt=Vt,!(Wo(vt,yt,_t,Mt,Ct)|0))return Mt=0,fn=Vt,Mt|0;do if((_t|0)>=0){if((_t|0)>13780509){if(Pt=js(15,Nt)|0,Pt|0)break;Ft=Nt,Nt=xt[Ft>>2]|0,Ft=xt[Ft+4>>2]|0}else Pt=((_t|0)<0)<<31>>31,Qt=fo(_t|0,Pt|0,3,0)|0,Ft=cn()|0,Pt=ts(_t|0,Pt|0,1,0)|0,Pt=fo(Qt|0,Ft|0,Pt|0,cn()|0)|0,Pt=ts(Pt|0,cn()|0,1,0)|0,Ft=cn()|0,xt[Nt>>2]=Pt,xt[Nt+4>>2]=Ft,Nt=Pt;if(Ol(Mt|0,0,Nt<<3|0)|0,Ct|0){Ol(Ct|0,0,Nt<<2|0)|0,Pt=no(vt,yt,_t,Mt,Ct,Nt,Ft,0)|0;break}Pt=So(Nt,4)|0,Pt?(Qt=no(vt,yt,_t,Mt,Pt,Nt,Ft,0)|0,Qr(Pt),Pt=Qt):Pt=13}else Pt=2;while(!1);return Qt=Pt,fn=Vt,Qt|0}function Wo(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0;if(Bn=fn,fn=fn+16|0,Pn=Bn,bn=Bn+8|0,Tn=Pn,xt[Tn>>2]=vt,xt[Tn+4>>2]=yt,(_t|0)<0)return bn=2,fn=Bn,bn|0;if(Pt=Mt,xt[Pt>>2]=vt,xt[Pt+4>>2]=yt,Pt=(Ct|0)!=0,Pt&&(xt[Ct>>2]=0),Es(vt,yt)|0)return bn=9,fn=Bn,bn|0;xt[bn>>2]=0;e:do if((_t|0)>=1)if(Pt)for(on=1,Qt=0,An=0,Tn=1,Pt=vt;;){if(!(Qt|An)){if(Pt=Cs(Pt,yt,4,bn,Pn)|0,Pt|0)break e;if(yt=Pn,Pt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,Es(Pt,yt)|0){Pt=9;break e}}if(Pt=Cs(Pt,yt,xt[22384+(An<<2)>>2]|0,bn,Pn)|0,Pt|0)break e;if(yt=Pn,Pt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,vt=Mt+(on<<3)|0,xt[vt>>2]=Pt,xt[vt+4>>2]=yt,xt[Ct+(on<<2)>>2]=Tn,vt=Qt+1|0,Nt=(vt|0)==(Tn|0),Ft=An+1|0,Vt=(Ft|0)==6,Es(Pt,yt)|0){Pt=9;break e}if(Tn=Tn+(Vt&Nt&1)|0,(Tn|0)>(_t|0)){Pt=0;break}else on=on+1|0,Qt=Nt?0:vt,An=Nt?Vt?0:Ft:An}else for(on=1,Qt=0,An=0,Tn=1,Pt=vt;;){if(!(Qt|An)){if(Pt=Cs(Pt,yt,4,bn,Pn)|0,Pt|0)break e;if(yt=Pn,Pt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,Es(Pt,yt)|0){Pt=9;break e}}if(Pt=Cs(Pt,yt,xt[22384+(An<<2)>>2]|0,bn,Pn)|0,Pt|0)break e;if(yt=Pn,Pt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,vt=Mt+(on<<3)|0,xt[vt>>2]=Pt,xt[vt+4>>2]=yt,vt=Qt+1|0,Nt=(vt|0)==(Tn|0),Ft=An+1|0,Vt=(Ft|0)==6,Es(Pt,yt)|0){Pt=9;break e}if(Tn=Tn+(Vt&Nt&1)|0,(Tn|0)>(_t|0)){Pt=0;break}else on=on+1|0,Qt=Nt?0:vt,An=Nt?Vt?0:Ft:An}else Pt=0;while(!1);return bn=Pt,fn=Bn,bn|0}function no(vt,yt,_t,Mt,Ct,Pt,Nt,Ft){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0,Pt=Pt|0,Nt=Nt|0,Ft=Ft|0;var Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0;if(Bn=fn,fn=fn+16|0,Pn=Bn+8|0,bn=Bn,Vt=Qs(vt|0,yt|0,Pt|0,Nt|0)|0,on=cn()|0,An=Mt+(Vt<<3)|0,ur=An,Ln=xt[ur>>2]|0,ur=xt[ur+4>>2]|0,Qt=(Ln|0)==(vt|0)&(ur|0)==(yt|0),!((Ln|0)==0&(ur|0)==0|Qt))do Vt=ts(Vt|0,on|0,1,0)|0,Vt=tp(Vt|0,cn()|0,Pt|0,Nt|0)|0,on=cn()|0,An=Mt+(Vt<<3)|0,Ln=An,ur=xt[Ln>>2]|0,Ln=xt[Ln+4>>2]|0,Qt=(ur|0)==(vt|0)&(Ln|0)==(yt|0);while(!((ur|0)==0&(Ln|0)==0|Qt));if(Vt=Ct+(Vt<<2)|0,Qt&&(xt[Vt>>2]|0)<=(Ft|0)||(Ln=An,xt[Ln>>2]=vt,xt[Ln+4>>2]=yt,xt[Vt>>2]=Ft,(Ft|0)>=(_t|0)))return Ln=0,fn=Bn,Ln|0;switch(Qt=Ft+1|0,xt[Pn>>2]=0,Vt=Cs(vt,yt,2,Pn,bn)|0,Vt|0){case 9:{Tn=9;break}case 0:{Vt=bn,Vt=no(xt[Vt>>2]|0,xt[Vt+4>>2]|0,_t,Mt,Ct,Pt,Nt,Qt)|0,Vt||(Tn=9);break}}e:do if((Tn|0)==9){switch(xt[Pn>>2]=0,Vt=Cs(vt,yt,3,Pn,bn)|0,Vt|0){case 9:break;case 0:{if(Vt=bn,Vt=no(xt[Vt>>2]|0,xt[Vt+4>>2]|0,_t,Mt,Ct,Pt,Nt,Qt)|0,Vt|0)break e;break}default:break e}switch(xt[Pn>>2]=0,Vt=Cs(vt,yt,1,Pn,bn)|0,Vt|0){case 9:break;case 0:{if(Vt=bn,Vt=no(xt[Vt>>2]|0,xt[Vt+4>>2]|0,_t,Mt,Ct,Pt,Nt,Qt)|0,Vt|0)break e;break}default:break e}switch(xt[Pn>>2]=0,Vt=Cs(vt,yt,5,Pn,bn)|0,Vt|0){case 9:break;case 0:{if(Vt=bn,Vt=no(xt[Vt>>2]|0,xt[Vt+4>>2]|0,_t,Mt,Ct,Pt,Nt,Qt)|0,Vt|0)break e;break}default:break e}switch(xt[Pn>>2]=0,Vt=Cs(vt,yt,4,Pn,bn)|0,Vt|0){case 9:break;case 0:{if(Vt=bn,Vt=no(xt[Vt>>2]|0,xt[Vt+4>>2]|0,_t,Mt,Ct,Pt,Nt,Qt)|0,Vt|0)break e;break}default:break e}switch(xt[Pn>>2]=0,Vt=Cs(vt,yt,6,Pn,bn)|0,Vt|0){case 9:break;case 0:{if(Vt=bn,Vt=no(xt[Vt>>2]|0,xt[Vt+4>>2]|0,_t,Mt,Ct,Pt,Nt,Qt)|0,Vt|0)break e;break}default:break e}return Ln=0,fn=Bn,Ln|0}while(!1);return Ln=Vt,fn=Bn,Ln|0}function Cs(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0;if(_t>>>0>6)return Ct=1,Ct|0;if(An=(xt[Mt>>2]|0)%6|0,xt[Mt>>2]=An,(An|0)>0){Pt=0;do _t=Yo(_t)|0,Pt=Pt+1|0;while((Pt|0)<(xt[Mt>>2]|0))}if(An=_r(vt|0,yt|0,45)|0,cn()|0,on=An&127,on>>>0>121)return Ct=5,Ct|0;Vt=yo(vt,yt)|0,Pt=_r(vt|0,yt|0,52)|0,cn()|0,Pt=Pt&15;e:do if(!Pt)Qt=8;else{for(;;){if(Nt=(15-Pt|0)*3|0,Ft=_r(vt|0,yt|0,Nt|0)|0,cn()|0,Ft=Ft&7,(Ft|0)==7){yt=5;break}if(bn=(bo(Pt)|0)==0,Pt=Pt+-1|0,Tn=Cr(7,0,Nt|0)|0,yt=yt&~(cn()|0),Pn=Cr(xt[(bn?432:16)+(Ft*28|0)+(_t<<2)>>2]|0,0,Nt|0)|0,Nt=cn()|0,_t=xt[(bn?640:224)+(Ft*28|0)+(_t<<2)>>2]|0,vt=Pn|vt&~Tn,yt=Nt|yt,!_t){_t=0;break e}if(!Pt){Qt=8;break e}}return yt|0}while(!1);(Qt|0)==8&&(bn=xt[848+(on*28|0)+(_t<<2)>>2]|0,Pn=Cr(bn|0,0,45)|0,vt=Pn|vt,yt=cn()|0|yt&-1040385,_t=xt[4272+(on*28|0)+(_t<<2)>>2]|0,(bn&127|0)==127&&(bn=Cr(xt[848+(on*28|0)+20>>2]|0,0,45)|0,yt=cn()|0|yt&-1040385,_t=xt[4272+(on*28|0)+20>>2]|0,vt=Ml(bn|vt,yt)|0,yt=cn()|0,xt[Mt>>2]=(xt[Mt>>2]|0)+1)),Ft=_r(vt|0,yt|0,45)|0,cn()|0,Ft=Ft&127;e:do if(ps(Ft)|0){t:do if((yo(vt,yt)|0)==1){if((on|0)!=(Ft|0))if(Mu(Ft,xt[7696+(on*28|0)>>2]|0)|0){vt=Kl(vt,yt)|0,Nt=1,yt=cn()|0;break}else mr(23313,22416,436,22424);switch(Vt|0){case 3:{vt=Ml(vt,yt)|0,yt=cn()|0,xt[Mt>>2]=(xt[Mt>>2]|0)+1,Nt=0;break t}case 5:{vt=Kl(vt,yt)|0,yt=cn()|0,xt[Mt>>2]=(xt[Mt>>2]|0)+5,Nt=0;break t}case 0:return bn=9,bn|0;default:return bn=1,bn|0}}else Nt=0;while(!1);if((_t|0)>0){Pt=0;do vt=Pu(vt,yt)|0,yt=cn()|0,Pt=Pt+1|0;while((Pt|0)!=(_t|0))}if((on|0)!=(Ft|0)){if(!(as(Ft)|0)){if((Nt|0)!=0|(yo(vt,yt)|0)!=5)break;xt[Mt>>2]=(xt[Mt>>2]|0)+1;break}switch(An&127){case 8:case 118:break e}(yo(vt,yt)|0)!=3&&(xt[Mt>>2]=(xt[Mt>>2]|0)+1)}}else if((_t|0)>0){Pt=0;do vt=Ml(vt,yt)|0,yt=cn()|0,Pt=Pt+1|0;while((Pt|0)!=(_t|0))}while(!1);return xt[Mt>>2]=((xt[Mt>>2]|0)+_t|0)%6|0,bn=Ct,xt[bn>>2]=vt,xt[bn+4>>2]=yt,bn=0,bn|0}function $a(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;for(Ft=fn,fn=fn+16|0,Pt=Ft,Nt=Ft+8|0,Ct=(Es(vt,yt)|0)==0,Ct=Ct?1:2;;){if(xt[Nt>>2]=0,Qt=(Cs(vt,yt,Ct,Nt,Pt)|0)==0,Vt=Pt,Qt&((xt[Vt>>2]|0)==(_t|0)?(xt[Vt+4>>2]|0)==(Mt|0):0)){vt=4;break}if(Ct=Ct+1|0,Ct>>>0>=7){Ct=7,vt=4;break}}return(vt|0)==4?(fn=Ft,Ct|0):0}function Vu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0;if(bn=fn,fn=fn+16|0,Tn=bn,Pn=bn+8|0,An=Tn,xt[An>>2]=vt,xt[An+4>>2]=yt,!_t)return Pn=Mt,xt[Pn>>2]=vt,xt[Pn+4>>2]=yt,Pn=0,fn=bn,Pn|0;xt[Pn>>2]=0;e:do if(Es(vt,yt)|0)vt=9;else{if(Pt=(_t|0)>0,Pt){Ct=0,An=vt;do{if(vt=Cs(An,yt,4,Pn,Tn)|0,vt|0)break e;if(yt=Tn,An=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,Ct=Ct+1|0,Es(An,yt)|0){vt=9;break e}}while((Ct|0)<(_t|0));if(on=Mt,xt[on>>2]=An,xt[on+4>>2]=yt,on=_t+-1|0,Pt){Qt=0,vt=1;do{if(Ct=22384+(Qt<<2)|0,(Qt|0)==5)for(Nt=xt[Ct>>2]|0,Pt=0,Ct=vt;;){if(vt=Tn,vt=Cs(xt[vt>>2]|0,xt[vt+4>>2]|0,Nt,Pn,Tn)|0,vt|0)break e;if((Pt|0)!=(on|0))if(Vt=Tn,Ft=xt[Vt>>2]|0,Vt=xt[Vt+4>>2]|0,vt=Mt+(Ct<<3)|0,xt[vt>>2]=Ft,xt[vt+4>>2]=Vt,!(Es(Ft,Vt)|0))vt=Ct+1|0;else{vt=9;break e}else vt=Ct;if(Pt=Pt+1|0,(Pt|0)>=(_t|0))break;Ct=vt}else for(Nt=Tn,Vt=xt[Ct>>2]|0,Ft=0,Ct=vt,Pt=xt[Nt>>2]|0,Nt=xt[Nt+4>>2]|0;;){if(vt=Cs(Pt,Nt,Vt,Pn,Tn)|0,vt|0)break e;if(Nt=Tn,Pt=xt[Nt>>2]|0,Nt=xt[Nt+4>>2]|0,vt=Mt+(Ct<<3)|0,xt[vt>>2]=Pt,xt[vt+4>>2]=Nt,vt=Ct+1|0,Es(Pt,Nt)|0){vt=9;break e}if(Ft=Ft+1|0,(Ft|0)>=(_t|0))break;Ct=vt}Qt=Qt+1|0}while(Qt>>>0<6);vt=Tn,Nt=An,Ct=xt[vt>>2]|0,Pt=yt,vt=xt[vt+4>>2]|0}else Nt=An,Ct=An,Pt=yt,vt=yt}else Nt=Mt,xt[Nt>>2]=vt,xt[Nt+4>>2]=yt,Nt=vt,Ct=vt,Pt=yt,vt=yt;vt=(Nt|0)==(Ct|0)&(Pt|0)==(vt|0)?0:9}while(!1);return Pn=vt,fn=bn,Pn|0}function Tu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;if(Ft=fn,fn=fn+48|0,Ct=Ft+16|0,Pt=Ft+8|0,Nt=Ft,_t|0)return Nt=15,fn=Ft,Nt|0;if(Qt=vt,Vt=xt[Qt+4>>2]|0,_t=Pt,xt[_t>>2]=xt[Qt>>2],xt[_t+4>>2]=Vt,Ap(Pt,Ct),yt=xo(Ct,yt,Nt)|0,!yt){if(_t=xt[Pt>>2]|0,Pt=xt[vt+8>>2]|0,(Pt|0)>0){Ct=xt[vt+12>>2]|0,yt=0;do _t=(xt[Ct+(yt<<3)>>2]|0)+_t|0,yt=yt+1|0;while((yt|0)<(Pt|0))}yt=Nt,Ct=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,Pt=((_t|0)<0)<<31>>31,(yt|0)<(Pt|0)|(yt|0)==(Pt|0)&Ct>>>0<_t>>>0?(yt=Nt,xt[yt>>2]=_t,xt[yt+4>>2]=Pt,yt=Pt):_t=Ct,Vt=ts(_t|0,yt|0,12,0)|0,Qt=cn()|0,yt=Nt,xt[yt>>2]=Vt,xt[yt+4>>2]=Qt,yt=Mt,xt[yt>>2]=Vt,xt[yt+4>>2]=Qt,yt=0}return Qt=yt,fn=Ft,Qt|0}function Ko(vt,yt,_t,Mt,Ct,Pt,Nt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0,Pt=Pt|0,Nt=Nt|0;var Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0,vs=0,fs=0,ms=0,_i=0,Zr=0,es=0,xs=0,Yr=0,Ms=0,io=0,Fu=0;if(xs=fn,fn=fn+64|0,ms=xs+48|0,_i=xs+32|0,Zr=xs+24|0,$r=xs+8|0,Br=xs,Vt=xt[vt>>2]|0,(Vt|0)<=0)return es=0,fn=xs,es|0;for(Er=vt+4|0,Dr=ms+8|0,vs=_i+8|0,fs=$r+8|0,Ft=0,Kn=0;;){Qt=xt[Er>>2]|0,Hn=Qt+(Kn<<4)|0,xt[ms>>2]=xt[Hn>>2],xt[ms+4>>2]=xt[Hn+4>>2],xt[ms+8>>2]=xt[Hn+8>>2],xt[ms+12>>2]=xt[Hn+12>>2],(Kn|0)==(Vt+-1|0)?(xt[_i>>2]=xt[Qt>>2],xt[_i+4>>2]=xt[Qt+4>>2],xt[_i+8>>2]=xt[Qt+8>>2],xt[_i+12>>2]=xt[Qt+12>>2]):(Hn=Qt+(Kn+1<<4)|0,xt[_i>>2]=xt[Hn>>2],xt[_i+4>>2]=xt[Hn+4>>2],xt[_i+8>>2]=xt[Hn+8>>2],xt[_i+12>>2]=xt[Hn+12>>2]),Vt=wu(ms,_i,Mt,Zr)|0;e:do if(Vt)Qt=0,Ft=Vt;else if(Qt=Zr,Vt=xt[Qt>>2]|0,Qt=xt[Qt+4>>2]|0,(Qt|0)>0|(Qt|0)==0&Vt>>>0>0){Ln=0,Hn=0;t:for(;;){if(Fu=+mn[ms>>3],ur=Xs(Vt|0,Qt|0,Ln|0,Hn|0)|0,io=+(ur>>>0)+4294967296*+(cn()|0),Yr=+(Vt>>>0)+4294967296*+(Qt|0),Ms=+(Ln>>>0)+4294967296*+(Hn|0),mn[$r>>3]=Fu*io/Yr+ +mn[_i>>3]*Ms/Yr,mn[fs>>3]=+mn[Dr>>3]*io/Yr+ +mn[vs>>3]*Ms/Yr,Vt=au($r,Mt,Br)|0,Vt|0){Ft=Vt;break}ur=Br,Bn=xt[ur>>2]|0,ur=xt[ur+4>>2]|0,Tn=Qs(Bn|0,ur|0,yt|0,_t|0)|0,on=cn()|0,Vt=Nt+(Tn<<3)|0,An=Vt,Qt=xt[An>>2]|0,An=xt[An+4>>2]|0;n:do if((Qt|0)==0&(An|0)==0)kn=Vt,es=16;else for(Pn=0,bn=0;;){if((Pn|0)>(_t|0)|(Pn|0)==(_t|0)&bn>>>0>yt>>>0){Ft=1;break t}if((Qt|0)==(Bn|0)&(An|0)==(ur|0))break n;if(Vt=ts(Tn|0,on|0,1,0)|0,Tn=tp(Vt|0,cn()|0,yt|0,_t|0)|0,on=cn()|0,bn=ts(bn|0,Pn|0,1,0)|0,Pn=cn()|0,Vt=Nt+(Tn<<3)|0,An=Vt,Qt=xt[An>>2]|0,An=xt[An+4>>2]|0,(Qt|0)==0&(An|0)==0){kn=Vt,es=16;break}}while(!1);if((es|0)==16&&(es=0,!((Bn|0)==0&(ur|0)==0))&&(bn=kn,xt[bn>>2]=Bn,xt[bn+4>>2]=ur,bn=Pt+(xt[Ct>>2]<<3)|0,xt[bn>>2]=Bn,xt[bn+4>>2]=ur,bn=Ct,bn=ts(xt[bn>>2]|0,xt[bn+4>>2]|0,1,0)|0,Bn=cn()|0,ur=Ct,xt[ur>>2]=bn,xt[ur+4>>2]=Bn),Ln=ts(Ln|0,Hn|0,1,0)|0,Hn=cn()|0,Qt=Zr,Vt=xt[Qt>>2]|0,Qt=xt[Qt+4>>2]|0,!((Qt|0)>(Hn|0)|(Qt|0)==(Hn|0)&Vt>>>0>Ln>>>0)){Qt=1;break e}}Qt=0}else Qt=1;while(!1);if(Kn=Kn+1|0,!Qt){es=21;break}if(Vt=xt[vt>>2]|0,(Kn|0)>=(Vt|0)){Ft=0,es=21;break}}return(es|0)==21?(fn=xs,Ft|0):0}function _c(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0,vs=0,fs=0,ms=0,_i=0,Zr=0,es=0,xs=0,Yr=0,Ms=0,io=0;if(io=fn,fn=fn+112|0,es=io+80|0,Vt=io+72|0,xs=io,Yr=io+56|0,_t|0)return Ms=15,fn=io,Ms|0;if(Qt=vt+8|0,Ms=Ks((xt[Qt>>2]<<5)+32|0)|0,!Ms)return Ms=13,fn=io,Ms|0;if(Ju(vt,Ms),_i=vt,Zr=xt[_i+4>>2]|0,_t=Vt,xt[_t>>2]=xt[_i>>2],xt[_t+4>>2]=Zr,Ap(Vt,es),_t=xo(es,yt,xs)|0,_t)_i=0,Zr=0;else{if(_t=xt[Vt>>2]|0,Pt=xt[Qt>>2]|0,(Pt|0)>0){Nt=xt[vt+12>>2]|0,Ct=0;do _t=(xt[Nt+(Ct<<3)>>2]|0)+_t|0,Ct=Ct+1|0;while((Ct|0)!=(Pt|0));Ct=_t}else Ct=_t;_t=xs,Pt=xt[_t>>2]|0,_t=xt[_t+4>>2]|0,Nt=((Ct|0)<0)<<31>>31,(_t|0)<(Nt|0)|(_t|0)==(Nt|0)&Pt>>>0<Ct>>>0?(_t=xs,xt[_t>>2]=Ct,xt[_t+4>>2]=Nt,_t=Nt):Ct=Pt,_i=ts(Ct|0,_t|0,12,0)|0,Zr=cn()|0,_t=xs,xt[_t>>2]=_i,xt[_t+4>>2]=Zr,_t=0}if(_t|0)return Qr(Ms),Ms=_t,fn=io,Ms|0;if(Ct=So(_i,8)|0,!Ct)return Qr(Ms),Ms=13,fn=io,Ms|0;if(Ft=So(_i,8)|0,!Ft)return Qr(Ms),Qr(Ct),Ms=13,fn=io,Ms|0;fs=es,xt[fs>>2]=0,xt[fs+4>>2]=0,fs=vt,ms=xt[fs+4>>2]|0,_t=Vt,xt[_t>>2]=xt[fs>>2],xt[_t+4>>2]=ms,_t=Ko(Vt,_i,Zr,yt,es,Ct,Ft)|0;e:do if(_t)Qr(Ct),Qr(Ft),Qr(Ms);else{t:do if((xt[Qt>>2]|0)>0){for(Nt=vt+12|0,Pt=0;_t=Ko((xt[Nt>>2]|0)+(Pt<<3)|0,_i,Zr,yt,es,Ct,Ft)|0,Pt=Pt+1|0,!(_t|0);)if((Pt|0)>=(xt[Qt>>2]|0))break t;Qr(Ct),Qr(Ft),Qr(Ms);break e}while(!1);(Zr|0)>0|(Zr|0)==0&_i>>>0>0&&Ol(Ft|0,0,_i<<3|0)|0,ms=es,fs=xt[ms+4>>2]|0;t:do if((fs|0)>0|(fs|0)==0&(xt[ms>>2]|0)>>>0>0){Er=Ct,Dr=Ft,vs=Ct,fs=Ft,ms=Ct,_t=Ct,kn=Ct,$r=Ft,Br=Ft,Ct=Ft;n:for(;;){for(ur=0,Ln=0,Hn=0,Kn=0,Pt=0,Nt=0;;){Ft=xs,Vt=Ft+56|0;do xt[Ft>>2]=0,Ft=Ft+4|0;while((Ft|0)<(Vt|0));if(yt=Er+(ur<<3)|0,Qt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,Wo(Qt,yt,1,xs,0)|0){Ft=xs,Vt=Ft+56|0;do xt[Ft>>2]=0,Ft=Ft+4|0;while((Ft|0)<(Vt|0));Ft=So(7,4)|0,Ft|0&&(no(Qt,yt,1,xs,Ft,7,0,0)|0,Qr(Ft))}for(Bn=0;;){bn=xs+(Bn<<3)|0,Pn=xt[bn>>2]|0,bn=xt[bn+4>>2]|0;r:do if((Pn|0)==0&(bn|0)==0)Ft=Pt,Vt=Nt;else{if(on=Qs(Pn|0,bn|0,_i|0,Zr|0)|0,Qt=cn()|0,Ft=Mt+(on<<3)|0,yt=Ft,Vt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,!((Vt|0)==0&(yt|0)==0)){An=0,Tn=0;do{if((An|0)>(Zr|0)|(An|0)==(Zr|0)&Tn>>>0>_i>>>0)break n;if((Vt|0)==(Pn|0)&(yt|0)==(bn|0)){Ft=Pt,Vt=Nt;break r}Ft=ts(on|0,Qt|0,1,0)|0,on=tp(Ft|0,cn()|0,_i|0,Zr|0)|0,Qt=cn()|0,Tn=ts(Tn|0,An|0,1,0)|0,An=cn()|0,Ft=Mt+(on<<3)|0,yt=Ft,Vt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0}while(!((Vt|0)==0&(yt|0)==0))}(Pn|0)==0&(bn|0)==0?(Ft=Pt,Vt=Nt):(cu(Pn,bn,Yr)|0,Zu(vt,Ms,Yr)|0&&(Tn=ts(Pt|0,Nt|0,1,0)|0,Nt=cn()|0,An=Ft,xt[An>>2]=Pn,xt[An+4>>2]=bn,Pt=Dr+(Pt<<3)|0,xt[Pt>>2]=Pn,xt[Pt+4>>2]=bn,Pt=Tn),Ft=Pt,Vt=Nt)}while(!1);if(Bn=Bn+1|0,Bn>>>0>=7)break;Pt=Ft,Nt=Vt}if(ur=ts(ur|0,Ln|0,1,0)|0,Ln=cn()|0,Hn=ts(Hn|0,Kn|0,1,0)|0,Kn=cn()|0,Nt=es,Pt=xt[Nt>>2]|0,Nt=xt[Nt+4>>2]|0,(Kn|0)<(Nt|0)|(Kn|0)==(Nt|0)&Hn>>>0<Pt>>>0)Pt=Ft,Nt=Vt;else break}if((Nt|0)>0|(Nt|0)==0&Pt>>>0>0){Pt=0,Nt=0;do Kn=Er+(Pt<<3)|0,xt[Kn>>2]=0,xt[Kn+4>>2]=0,Pt=ts(Pt|0,Nt|0,1,0)|0,Nt=cn()|0,Kn=es,Hn=xt[Kn+4>>2]|0;while((Nt|0)<(Hn|0)|((Nt|0)==(Hn|0)?Pt>>>0<(xt[Kn>>2]|0)>>>0:0))}if(Kn=es,xt[Kn>>2]=Ft,xt[Kn+4>>2]=Vt,(Vt|0)>0|(Vt|0)==0&Ft>>>0>0)Bn=Ct,ur=Br,Ln=ms,Hn=$r,Kn=Dr,Ct=kn,Br=_t,$r=vs,kn=Bn,_t=ur,ms=fs,fs=Ln,vs=Hn,Dr=Er,Er=Kn;else break t}Qr(vs),Qr(fs),Qr(Ms),_t=1;break e}else _t=Ft;while(!1);Qr(Ms),Qr(Ct),Qr(_t),_t=0}while(!1);return Ms=_t,fn=io,Ms|0}function Xo(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(on=fn,fn=fn+176|0,Vt=on,(yt|0)<1)return Kp(_t,0,0),Qt=0,fn=on,Qt|0;for(Ft=vt,Ft=_r(xt[Ft>>2]|0,xt[Ft+4>>2]|0,52)|0,cn()|0,Kp(_t,(yt|0)>6?yt:6,Ft&15),Ft=0;Mt=vt+(Ft<<3)|0,Mt=Jo(xt[Mt>>2]|0,xt[Mt+4>>2]|0,Vt)|0,!(Mt|0);){if(Mt=xt[Vt>>2]|0,(Mt|0)>0){Nt=0;do Pt=Vt+8+(Nt<<4)|0,Nt=Nt+1|0,Mt=Vt+8+(((Nt|0)%(Mt|0)|0)<<4)|0,Ct=Yp(_t,Mt,Pt)|0,Ct?_f(_t,Ct)|0:_m(_t,Pt,Mt)|0,Mt=xt[Vt>>2]|0;while((Nt|0)<(Mt|0))}if(Ft=Ft+1|0,(Ft|0)>=(yt|0)){Mt=0,Qt=13;break}}return(Qt|0)==13?(fn=on,Mt|0):(Xp(_t),Qt=Mt,fn=on,Qt|0)}function Ll(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0;if(Pt=fn,fn=fn+32|0,Mt=Pt,Ct=Pt+16|0,vt=Xo(vt,yt,Ct)|0,vt|0)return _t=vt,fn=Pt,_t|0;if(xt[_t>>2]=0,xt[_t+4>>2]=0,xt[_t+8>>2]=0,vt=_d(Ct)|0,vt|0)do{yt=pp(_t)|0;do wl(yt,vt)|0,Nt=vt+16|0,xt[Mt>>2]=xt[Nt>>2],xt[Mt+4>>2]=xt[Nt+4>>2],xt[Mt+8>>2]=xt[Nt+8>>2],xt[Mt+12>>2]=xt[Nt+12>>2],_f(Ct,vt)|0,vt=Qp(Ct,Mt)|0;while(vt|0);vt=_d(Ct)|0}while(vt|0);return Xp(Ct),vt=Zl(_t)|0,vt?(Ho(_t),Nt=vt,fn=Pt,Nt|0):(Nt=0,fn=Pt,Nt|0)}function ps(vt){return vt=vt|0,vt>>>0>121?(vt=0,vt|0):(vt=xt[7696+(vt*28|0)+16>>2]|0,vt|0)}function as(vt){return vt=vt|0,(vt|0)==4|(vt|0)==117|0}function eu(vt){return vt=vt|0,xt[11120+((xt[vt>>2]|0)*216|0)+((xt[vt+4>>2]|0)*72|0)+((xt[vt+8>>2]|0)*24|0)+(xt[vt+12>>2]<<3)>>2]|0}function Al(vt){return vt=vt|0,xt[11120+((xt[vt>>2]|0)*216|0)+((xt[vt+4>>2]|0)*72|0)+((xt[vt+8>>2]|0)*24|0)+(xt[vt+12>>2]<<3)+4>>2]|0}function tu(vt,yt){vt=vt|0,yt=yt|0,vt=7696+(vt*28|0)|0,xt[yt>>2]=xt[vt>>2],xt[yt+4>>2]=xt[vt+4>>2],xt[yt+8>>2]=xt[vt+8>>2],xt[yt+12>>2]=xt[vt+12>>2]}function Eu(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0;if(yt>>>0>20)return yt=-1,yt|0;do if((xt[11120+(yt*216|0)>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+8>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+16>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+24>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+32>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+40>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+48>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+56>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+64>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+72>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+80>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+88>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+96>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+104>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+112>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+120>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+128>>2]|0)!=(vt|0))if((xt[11120+(yt*216|0)+136>>2]|0)==(vt|0))vt=2,_t=1,Mt=2;else{if((xt[11120+(yt*216|0)+144>>2]|0)==(vt|0)){vt=0,_t=2,Mt=0;break}if((xt[11120+(yt*216|0)+152>>2]|0)==(vt|0)){vt=0,_t=2,Mt=1;break}if((xt[11120+(yt*216|0)+160>>2]|0)==(vt|0)){vt=0,_t=2,Mt=2;break}if((xt[11120+(yt*216|0)+168>>2]|0)==(vt|0)){vt=1,_t=2,Mt=0;break}if((xt[11120+(yt*216|0)+176>>2]|0)==(vt|0)){vt=1,_t=2,Mt=1;break}if((xt[11120+(yt*216|0)+184>>2]|0)==(vt|0)){vt=1,_t=2,Mt=2;break}if((xt[11120+(yt*216|0)+192>>2]|0)==(vt|0)){vt=2,_t=2,Mt=0;break}if((xt[11120+(yt*216|0)+200>>2]|0)==(vt|0)){vt=2,_t=2,Mt=1;break}if((xt[11120+(yt*216|0)+208>>2]|0)==(vt|0)){vt=2,_t=2,Mt=2;break}else vt=-1;return vt|0}else vt=2,_t=1,Mt=1;else vt=2,_t=1,Mt=0;else vt=1,_t=1,Mt=2;else vt=1,_t=1,Mt=1;else vt=1,_t=1,Mt=0;else vt=0,_t=1,Mt=2;else vt=0,_t=1,Mt=1;else vt=0,_t=1,Mt=0;else vt=2,_t=0,Mt=2;else vt=2,_t=0,Mt=1;else vt=2,_t=0,Mt=0;else vt=1,_t=0,Mt=2;else vt=1,_t=0,Mt=1;else vt=1,_t=0,Mt=0;else vt=0,_t=0,Mt=2;else vt=0,_t=0,Mt=1;else vt=0,_t=0,Mt=0;while(!1);return yt=xt[11120+(yt*216|0)+(_t*72|0)+(vt*24|0)+(Mt<<3)+4>>2]|0,yt|0}function Mu(vt,yt){return vt=vt|0,yt=yt|0,(xt[7696+(vt*28|0)+20>>2]|0)==(yt|0)?(yt=1,yt|0):(yt=(xt[7696+(vt*28|0)+24>>2]|0)==(yt|0),yt|0)}function Ls(vt,yt){return vt=vt|0,yt=yt|0,xt[848+(vt*28|0)+(yt<<2)>>2]|0}function yl(vt,yt){return vt=vt|0,yt=yt|0,(xt[848+(vt*28|0)>>2]|0)==(yt|0)?(yt=0,yt|0):(xt[848+(vt*28|0)+4>>2]|0)==(yt|0)?(yt=1,yt|0):(xt[848+(vt*28|0)+8>>2]|0)==(yt|0)?(yt=2,yt|0):(xt[848+(vt*28|0)+12>>2]|0)==(yt|0)?(yt=3,yt|0):(xt[848+(vt*28|0)+16>>2]|0)==(yt|0)?(yt=4,yt|0):(xt[848+(vt*28|0)+20>>2]|0)==(yt|0)?(yt=5,yt|0):((xt[848+(vt*28|0)+24>>2]|0)==(yt|0)?6:7)|0}function zu(){return 122}function go(vt){vt=vt|0;var yt=0,_t=0,Mt=0;yt=0;do Cr(yt|0,0,45)|0,Mt=cn()|0|134225919,_t=vt+(yt<<3)|0,xt[_t>>2]=-1,xt[_t+4>>2]=Mt,yt=yt+1|0;while((yt|0)!=122);return 0}function nu(vt){return vt=vt|0,+mn[vt+16>>3]<+mn[vt+24>>3]|0}function Il(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0;return _t=+mn[yt>>3],!(_t>=+mn[vt+8>>3])||!(_t<=+mn[vt>>3])?(yt=0,yt|0):(Mt=+mn[vt+16>>3],_t=+mn[vt+24>>3],Ct=+mn[yt+8>>3],yt=Ct>=_t,vt=Ct<=Mt&1,Mt<_t?yt&&(vt=1):yt||(vt=0),yt=(vt|0)!=0,yt|0)}function xo(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0;bn=fn,fn=fn+288|0,on=bn+264|0,An=bn+96|0,Qt=bn,Ft=Qt,Vt=Ft+96|0;do xt[Ft>>2]=0,Ft=Ft+4|0;while((Ft|0)<(Vt|0));return yt=Yl(yt,Qt)|0,yt|0?(Pn=yt,fn=bn,Pn|0):(Vt=Qt,Qt=xt[Vt>>2]|0,Vt=xt[Vt+4>>2]|0,cu(Qt,Vt,on)|0,Jo(Qt,Vt,An)|0,Nt=+Fl(on,An+8|0),mn[on>>3]=+mn[vt>>3],Vt=on+8|0,mn[Vt>>3]=+mn[vt+16>>3],mn[An>>3]=+mn[vt+8>>3],Qt=An+8|0,mn[Qt>>3]=+mn[vt+24>>3],Ct=+Fl(on,An),ur=+mn[Vt>>3]-+mn[Qt>>3],Pt=+ln(+ur),Bn=+mn[on>>3]-+mn[An>>3],Mt=+ln(+Bn),!(ur==0|Bn==0)&&(ur=+xp(+Pt,+Mt),ur=+zr(+(Ct*Ct/+np(+(ur/+np(+Pt,+Mt)),3)/(Nt*(Nt*2.59807621135)*.8))),mn[os>>3]=ur,Tn=~~ur>>>0,Pn=+ln(ur)>=1?ur>0?~~+ls(+Bs(ur/4294967296),4294967295)>>>0:~~+zr((ur-+(~~ur>>>0))/4294967296)>>>0:0,(xt[os+4>>2]&2146435072|0)!=2146435072)?(An=(Tn|0)==0&(Pn|0)==0,yt=_t,xt[yt>>2]=An?1:Tn,xt[yt+4>>2]=An?0:Pn,yt=0):yt=1,Pn=yt,fn=bn,Pn|0)}function wu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;Qt=fn,fn=fn+288|0,Nt=Qt+264|0,Ft=Qt+96|0,Vt=Qt,Ct=Vt,Pt=Ct+96|0;do xt[Ct>>2]=0,Ct=Ct+4|0;while((Ct|0)<(Pt|0));return _t=Yl(_t,Vt)|0,_t|0?(Mt=_t,fn=Qt,Mt|0):(_t=Vt,Ct=xt[_t>>2]|0,_t=xt[_t+4>>2]|0,cu(Ct,_t,Nt)|0,Jo(Ct,_t,Ft)|0,on=+Fl(Nt,Ft+8|0),on=+zr(+(+Fl(vt,yt)/(on*2))),mn[os>>3]=on,_t=~~on>>>0,Ct=+ln(on)>=1?on>0?~~+ls(+Bs(on/4294967296),4294967295)>>>0:~~+zr((on-+(~~on>>>0))/4294967296)>>>0:0,(xt[os+4>>2]&2146435072|0)==2146435072?(Mt=1,fn=Qt,Mt|0):(Vt=(_t|0)==0&(Ct|0)==0,xt[Mt>>2]=Vt?1:_t,xt[Mt+4>>2]=Vt?0:Ct,Mt=0,fn=Qt,Mt|0))}function Hu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,xt[vt>>2]=yt,xt[vt+4>>2]=_t,xt[vt+8>>2]=Mt}function Eo(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0;An=yt+8|0,xt[An>>2]=0,Vt=+mn[vt>>3],Nt=+ln(+Vt),Qt=+mn[vt+8>>3],Ft=+ln(+Qt)/.8660254037844386,Nt=Nt+Ft*.5,_t=~~Nt,vt=~~Ft,Nt=Nt-+(_t|0),Ft=Ft-+(vt|0);do if(Nt<.5)if(Nt<.3333333333333333)if(xt[yt>>2]=_t,Ft<(Nt+1)*.5){xt[yt+4>>2]=vt;break}else{vt=vt+1|0,xt[yt+4>>2]=vt;break}else if(Tn=1-Nt,vt=(!(Ft<Tn)&1)+vt|0,xt[yt+4>>2]=vt,Tn<=Ft&Ft<Nt*2){_t=_t+1|0,xt[yt>>2]=_t;break}else{xt[yt>>2]=_t;break}else{if(!(Nt<.6666666666666666))if(_t=_t+1|0,xt[yt>>2]=_t,Ft<Nt*.5){xt[yt+4>>2]=vt;break}else{vt=vt+1|0,xt[yt+4>>2]=vt;break}if(Ft<1-Nt){if(xt[yt+4>>2]=vt,Nt*2+-1<Ft){xt[yt>>2]=_t;break}}else vt=vt+1|0,xt[yt+4>>2]=vt;_t=_t+1|0,xt[yt>>2]=_t}while(!1);do if(Vt<0)if(vt&1){on=(vt+1|0)/2|0,on=Xs(_t|0,((_t|0)<0)<<31>>31|0,on|0,((on|0)<0)<<31>>31|0)|0,_t=~~(+(_t|0)-((+(on>>>0)+4294967296*+(cn()|0))*2+1)),xt[yt>>2]=_t;break}else{on=(vt|0)/2|0,on=Xs(_t|0,((_t|0)<0)<<31>>31|0,on|0,((on|0)<0)<<31>>31|0)|0,_t=~~(+(_t|0)-(+(on>>>0)+4294967296*+(cn()|0))*2),xt[yt>>2]=_t;break}while(!1);on=yt+4|0,Qt<0&&(_t=_t-((vt<<1|1|0)/2|0)|0,xt[yt>>2]=_t,vt=0-vt|0,xt[on>>2]=vt),Mt=vt-_t|0,(_t|0)<0?(Ct=0-_t|0,xt[on>>2]=Mt,xt[An>>2]=Ct,xt[yt>>2]=0,vt=Mt,_t=0):Ct=0,(vt|0)<0&&(_t=_t-vt|0,xt[yt>>2]=_t,Ct=Ct-vt|0,xt[An>>2]=Ct,xt[on>>2]=0,vt=0),Pt=_t-Ct|0,Mt=vt-Ct|0,(Ct|0)<0&&(xt[yt>>2]=Pt,xt[on>>2]=Mt,xt[An>>2]=0,vt=Mt,_t=Pt,Ct=0),Mt=(vt|0)<(_t|0)?vt:_t,Mt=(Ct|0)<(Mt|0)?Ct:Mt,!((Mt|0)<=0)&&(xt[yt>>2]=_t-Mt,xt[on>>2]=vt-Mt,xt[An>>2]=Ct-Mt)}function _s(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0;yt=xt[vt>>2]|0,Nt=vt+4|0,_t=xt[Nt>>2]|0,(yt|0)<0&&(_t=_t-yt|0,xt[Nt>>2]=_t,Pt=vt+8|0,xt[Pt>>2]=(xt[Pt>>2]|0)-yt,xt[vt>>2]=0,yt=0),(_t|0)<0?(yt=yt-_t|0,xt[vt>>2]=yt,Pt=vt+8|0,Ct=(xt[Pt>>2]|0)-_t|0,xt[Pt>>2]=Ct,xt[Nt>>2]=0,_t=0):(Ct=vt+8|0,Pt=Ct,Ct=xt[Ct>>2]|0),(Ct|0)<0&&(yt=yt-Ct|0,xt[vt>>2]=yt,_t=_t-Ct|0,xt[Nt>>2]=_t,xt[Pt>>2]=0,Ct=0),Mt=(_t|0)<(yt|0)?_t:yt,Mt=(Ct|0)<(Mt|0)?Ct:Mt,!((Mt|0)<=0)&&(xt[vt>>2]=yt-Mt,xt[Nt>>2]=_t-Mt,xt[Pt>>2]=Ct-Mt)}function oo(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0;Mt=xt[vt+8>>2]|0,_t=+((xt[vt+4>>2]|0)-Mt|0),mn[yt>>3]=+((xt[vt>>2]|0)-Mt|0)-_t*.5,mn[yt+8>>3]=_t*.8660254037844386}function Rs(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0,xt[_t>>2]=(xt[yt>>2]|0)+(xt[vt>>2]|0),xt[_t+4>>2]=(xt[yt+4>>2]|0)+(xt[vt+4>>2]|0),xt[_t+8>>2]=(xt[yt+8>>2]|0)+(xt[vt+8>>2]|0)}function Ul(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0,xt[_t>>2]=(xt[vt>>2]|0)-(xt[yt>>2]|0),xt[_t+4>>2]=(xt[vt+4>>2]|0)-(xt[yt+4>>2]|0),xt[_t+8>>2]=(xt[vt+8>>2]|0)-(xt[yt+8>>2]|0)}function ru(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0;_t=kr(xt[vt>>2]|0,yt)|0,xt[vt>>2]=_t,_t=vt+4|0,Mt=kr(xt[_t>>2]|0,yt)|0,xt[_t>>2]=Mt,vt=vt+8|0,yt=kr(xt[vt>>2]|0,yt)|0,xt[vt>>2]=yt}function ro(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Nt=xt[vt>>2]|0,Ft=(Nt|0)<0,Mt=(xt[vt+4>>2]|0)-(Ft?Nt:0)|0,Pt=(Mt|0)<0,Ct=(Pt?0-Mt|0:0)+((xt[vt+8>>2]|0)-(Ft?Nt:0))|0,_t=(Ct|0)<0,vt=_t?0:Ct,yt=(Pt?0:Mt)-(_t?Ct:0)|0,Ct=(Ft?0:Nt)-(Pt?Mt:0)-(_t?Ct:0)|0,_t=(yt|0)<(Ct|0)?yt:Ct,_t=(vt|0)<(_t|0)?vt:_t,Mt=(_t|0)>0,vt=vt-(Mt?_t:0)|0,yt=yt-(Mt?_t:0)|0;e:do switch(Ct-(Mt?_t:0)|0){case 0:switch(yt|0){case 0:return Ft=vt|0?(vt|0)==1?1:7:0,Ft|0;case 1:return Ft=vt|0?(vt|0)==1?3:7:2,Ft|0;default:break e}case 1:switch(yt|0){case 0:return Ft=vt|0?(vt|0)==1?5:7:4,Ft|0;case 1:{if(!vt)vt=6;else break e;return vt|0}default:break e}}while(!1);return Ft=7,Ft|0}function Gl(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Nt=vt+8|0,Ct=xt[Nt>>2]|0,Pt=(xt[vt>>2]|0)-Ct|0,Ft=vt+4|0,Ct=(xt[Ft>>2]|0)-Ct|0;do if(Pt>>>0>715827881|Ct>>>0>715827881){if(_t=(Pt|0)>0,_t){if((2147483647-Pt|0)<(Pt|0)||(2147483647-(Pt<<1)|0)<(Pt|0))return Ft=1,Ft|0}else if((-2147483648-Pt|0)>(Pt|0)||(-2147483648-(Pt<<1)|0)>(Pt|0))return Ft=1,Ft|0;if(yt=Pt*3|0,(Ct|0)>0){if((2147483647-Ct|0)<(Ct|0))return Ft=1,Ft|0}else if((-2147483648-Ct|0)>(Ct|0))return Ft=1,Ft|0;if(Mt=Ct<<1,(Pt|0)>-1){if((yt|-2147483648|0)>=(Ct|0))return Ft=1,Ft|0}else if((yt^-2147483648|0)<(Ct|0))return Ft=1,Ft|0;if(_t){if((2147483647-Pt|0)<(Mt|0))yt=1;else{_t=Mt;break}return yt|0}else{if((-2147483648-Pt|0)>(Mt|0))yt=1;else{_t=Mt;break}return yt|0}}else _t=Ct<<1,yt=Pt*3|0;while(!1);Mt=Cl(+(yt-Ct|0)/7)|0,xt[vt>>2]=Mt,Ct=Cl(+(_t+Pt|0)/7)|0,xt[Ft>>2]=Ct,xt[Nt>>2]=0,_t=(Ct|0)<(Mt|0),yt=_t?Mt:Ct,_t=_t?Ct:Mt;do if((_t|0)<0){if((yt|0)>0){if((yt|-2147483648|0)<(_t|0)&((_t|0)!=-2147483648&(2147483647-yt|0)>=(_t|0)))break;mr(23313,22444,355,22455)}if((_t|0)==-2147483648|(-2147483648-yt|0)>(_t|0)&&mr(23313,22444,355,22455),(yt|0)>-1){if((yt|-2147483648|0)<(_t|0))break;mr(23313,22444,355,22455)}else{if((yt^-2147483648|0)>=(_t|0))break;mr(23313,22444,355,22455)}}while(!1);return yt=Ct-Mt|0,(Mt|0)<0?(_t=0-Mt|0,xt[Ft>>2]=yt,xt[Nt>>2]=_t,xt[vt>>2]=0,Mt=0):(yt=Ct,_t=0),(yt|0)<0&&(Mt=Mt-yt|0,xt[vt>>2]=Mt,_t=_t-yt|0,xt[Nt>>2]=_t,xt[Ft>>2]=0,yt=0),Pt=Mt-_t|0,Ct=yt-_t|0,(_t|0)<0?(xt[vt>>2]=Pt,xt[Ft>>2]=Ct,xt[Nt>>2]=0,yt=Ct,Ct=Pt,_t=0):Ct=Mt,Mt=(yt|0)<(Ct|0)?yt:Ct,Mt=(_t|0)<(Mt|0)?_t:Mt,(Mt|0)<=0?(Ft=0,Ft|0):(xt[vt>>2]=Ct-Mt,xt[Ft>>2]=yt-Mt,xt[Nt>>2]=_t-Mt,Ft=0,Ft|0)}function Vl(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Nt=vt+8|0,Ct=xt[Nt>>2]|0,Pt=(xt[vt>>2]|0)-Ct|0,Ft=vt+4|0,Ct=(xt[Ft>>2]|0)-Ct|0;do if(Pt>>>0>715827881|Ct>>>0>715827881){if(_t=(Pt|0)>0,_t){if((2147483647-Pt|0)<(Pt|0))return Ft=1,Ft|0}else if((-2147483648-Pt|0)>(Pt|0))return Ft=1,Ft|0;if(yt=Pt<<1,(Ct|0)>0){if((2147483647-Ct|0)<(Ct|0)||(2147483647-(Ct<<1)|0)<(Ct|0))return Ft=1,Ft|0}else if((-2147483648-Ct|0)>(Ct|0)||(-2147483648-(Ct<<1)|0)>(Ct|0))return Ft=1,Ft|0;if(Mt=Ct*3|0,_t){if((2147483647-yt|0)<(Ct|0))return Ft=1,Ft|0}else if((-2147483648-yt|0)>(Ct|0))return Ft=1,Ft|0;if((Ct|0)>-1){if((Mt|-2147483648|0)<(Pt|0)){_t=Mt;break}else yt=1;return yt|0}else{if((Mt^-2147483648|0)<(Pt|0))yt=1;else{_t=Mt;break}return yt|0}}else _t=Ct*3|0,yt=Pt<<1;while(!1);Mt=Cl(+(yt+Ct|0)/7)|0,xt[vt>>2]=Mt,Ct=Cl(+(_t-Pt|0)/7)|0,xt[Ft>>2]=Ct,xt[Nt>>2]=0,_t=(Ct|0)<(Mt|0),yt=_t?Mt:Ct,_t=_t?Ct:Mt;do if((_t|0)<0){if((yt|0)>0){if((yt|-2147483648|0)<(_t|0)&((_t|0)!=-2147483648&(2147483647-yt|0)>=(_t|0)))break;mr(23313,22444,404,22469)}if((_t|0)==-2147483648|(-2147483648-yt|0)>(_t|0)&&mr(23313,22444,404,22469),(yt|0)>-1){if((yt|-2147483648|0)<(_t|0))break;mr(23313,22444,404,22469)}else{if((yt^-2147483648|0)>=(_t|0))break;mr(23313,22444,404,22469)}}while(!1);return yt=Ct-Mt|0,(Mt|0)<0?(_t=0-Mt|0,xt[Ft>>2]=yt,xt[Nt>>2]=_t,xt[vt>>2]=0,Mt=0):(yt=Ct,_t=0),(yt|0)<0&&(Mt=Mt-yt|0,xt[vt>>2]=Mt,_t=_t-yt|0,xt[Nt>>2]=_t,xt[Ft>>2]=0,yt=0),Pt=Mt-_t|0,Ct=yt-_t|0,(_t|0)<0?(xt[vt>>2]=Pt,xt[Ft>>2]=Ct,xt[Nt>>2]=0,yt=Ct,Ct=Pt,_t=0):Ct=Mt,Mt=(yt|0)<(Ct|0)?yt:Ct,Mt=(_t|0)<(Mt|0)?_t:Mt,(Mt|0)<=0?(Ft=0,Ft|0):(xt[vt>>2]=Ct-Mt,xt[Ft>>2]=yt-Mt,xt[Nt>>2]=_t-Mt,Ft=0,Ft|0)}function zl(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Nt=vt+8|0,_t=xt[Nt>>2]|0,yt=(xt[vt>>2]|0)-_t|0,Ft=vt+4|0,_t=(xt[Ft>>2]|0)-_t|0,Mt=Cl(+((yt*3|0)-_t|0)/7)|0,xt[vt>>2]=Mt,yt=Cl(+((_t<<1)+yt|0)/7)|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=yt-Mt|0,(Mt|0)<0?(Pt=0-Mt|0,xt[Ft>>2]=_t,xt[Nt>>2]=Pt,xt[vt>>2]=0,yt=_t,Mt=0,_t=Pt):_t=0,(yt|0)<0&&(Mt=Mt-yt|0,xt[vt>>2]=Mt,_t=_t-yt|0,xt[Nt>>2]=_t,xt[Ft>>2]=0,yt=0),Pt=Mt-_t|0,Ct=yt-_t|0,(_t|0)<0?(xt[vt>>2]=Pt,xt[Ft>>2]=Ct,xt[Nt>>2]=0,yt=Ct,Ct=Pt,_t=0):Ct=Mt,Mt=(yt|0)<(Ct|0)?yt:Ct,Mt=(_t|0)<(Mt|0)?_t:Mt,!((Mt|0)<=0)&&(xt[vt>>2]=Ct-Mt,xt[Ft>>2]=yt-Mt,xt[Nt>>2]=_t-Mt)}function ao(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Nt=vt+8|0,_t=xt[Nt>>2]|0,yt=(xt[vt>>2]|0)-_t|0,Ft=vt+4|0,_t=(xt[Ft>>2]|0)-_t|0,Mt=Cl(+((yt<<1)+_t|0)/7)|0,xt[vt>>2]=Mt,yt=Cl(+((_t*3|0)-yt|0)/7)|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=yt-Mt|0,(Mt|0)<0?(Pt=0-Mt|0,xt[Ft>>2]=_t,xt[Nt>>2]=Pt,xt[vt>>2]=0,yt=_t,Mt=0,_t=Pt):_t=0,(yt|0)<0&&(Mt=Mt-yt|0,xt[vt>>2]=Mt,_t=_t-yt|0,xt[Nt>>2]=_t,xt[Ft>>2]=0,yt=0),Pt=Mt-_t|0,Ct=yt-_t|0,(_t|0)<0?(xt[vt>>2]=Pt,xt[Ft>>2]=Ct,xt[Nt>>2]=0,yt=Ct,Ct=Pt,_t=0):Ct=Mt,Mt=(yt|0)<(Ct|0)?yt:Ct,Mt=(_t|0)<(Mt|0)?_t:Mt,!((Mt|0)<=0)&&(xt[vt>>2]=Ct-Mt,xt[Ft>>2]=yt-Mt,xt[Nt>>2]=_t-Mt)}function Hs(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;yt=xt[vt>>2]|0,Nt=vt+4|0,_t=xt[Nt>>2]|0,Ft=vt+8|0,Mt=xt[Ft>>2]|0,Ct=_t+(yt*3|0)|0,xt[vt>>2]=Ct,_t=Mt+(_t*3|0)|0,xt[Nt>>2]=_t,yt=(Mt*3|0)+yt|0,xt[Ft>>2]=yt,Mt=_t-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Nt>>2]=Mt,xt[Ft>>2]=yt,xt[vt>>2]=0,_t=Mt,Mt=0):Mt=Ct,(_t|0)<0&&(Mt=Mt-_t|0,xt[vt>>2]=Mt,yt=yt-_t|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=0),Pt=Mt-yt|0,Ct=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Nt>>2]=Ct,xt[Ft>>2]=0,Mt=Pt,yt=0):Ct=_t,_t=(Ct|0)<(Mt|0)?Ct:Mt,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Mt-_t,xt[Nt>>2]=Ct-_t,xt[Ft>>2]=yt-_t)}function Do(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Ct=xt[vt>>2]|0,Nt=vt+4|0,yt=xt[Nt>>2]|0,Ft=vt+8|0,_t=xt[Ft>>2]|0,Mt=(yt*3|0)+Ct|0,Ct=_t+(Ct*3|0)|0,xt[vt>>2]=Ct,xt[Nt>>2]=Mt,yt=(_t*3|0)+yt|0,xt[Ft>>2]=yt,_t=Mt-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Nt>>2]=_t,xt[Ft>>2]=yt,xt[vt>>2]=0,Ct=0):_t=Mt,(_t|0)<0&&(Ct=Ct-_t|0,xt[vt>>2]=Ct,yt=yt-_t|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=0),Pt=Ct-yt|0,Mt=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Nt>>2]=Mt,xt[Ft>>2]=0,Ct=Pt,yt=0):Mt=_t,_t=(Mt|0)<(Ct|0)?Mt:Ct,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Ct-_t,xt[Nt>>2]=Mt-_t,xt[Ft>>2]=yt-_t)}function $o(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;(yt+-1|0)>>>0>=6||(Ct=(xt[15440+(yt*12|0)>>2]|0)+(xt[vt>>2]|0)|0,xt[vt>>2]=Ct,Ft=vt+4|0,Mt=(xt[15440+(yt*12|0)+4>>2]|0)+(xt[Ft>>2]|0)|0,xt[Ft>>2]=Mt,Nt=vt+8|0,yt=(xt[15440+(yt*12|0)+8>>2]|0)+(xt[Nt>>2]|0)|0,xt[Nt>>2]=yt,_t=Mt-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Ft>>2]=_t,xt[Nt>>2]=yt,xt[vt>>2]=0,Mt=0):(_t=Mt,Mt=Ct),(_t|0)<0&&(Mt=Mt-_t|0,xt[vt>>2]=Mt,yt=yt-_t|0,xt[Nt>>2]=yt,xt[Ft>>2]=0,_t=0),Pt=Mt-yt|0,Ct=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Ft>>2]=Ct,xt[Nt>>2]=0,Mt=Pt,yt=0):Ct=_t,_t=(Ct|0)<(Mt|0)?Ct:Mt,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Mt-_t,xt[Ft>>2]=Ct-_t,xt[Nt>>2]=yt-_t))}function xl(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Ct=xt[vt>>2]|0,Nt=vt+4|0,yt=xt[Nt>>2]|0,Ft=vt+8|0,_t=xt[Ft>>2]|0,Mt=yt+Ct|0,Ct=_t+Ct|0,xt[vt>>2]=Ct,xt[Nt>>2]=Mt,yt=_t+yt|0,xt[Ft>>2]=yt,_t=Mt-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Nt>>2]=_t,xt[Ft>>2]=yt,xt[vt>>2]=0,Mt=0):(_t=Mt,Mt=Ct),(_t|0)<0&&(Mt=Mt-_t|0,xt[vt>>2]=Mt,yt=yt-_t|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=0),Pt=Mt-yt|0,Ct=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Nt>>2]=Ct,xt[Ft>>2]=0,Mt=Pt,yt=0):Ct=_t,_t=(Ct|0)<(Mt|0)?Ct:Mt,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Mt-_t,xt[Nt>>2]=Ct-_t,xt[Ft>>2]=yt-_t)}function _l(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;yt=xt[vt>>2]|0,Nt=vt+4|0,Mt=xt[Nt>>2]|0,Ft=vt+8|0,_t=xt[Ft>>2]|0,Ct=Mt+yt|0,xt[vt>>2]=Ct,Mt=_t+Mt|0,xt[Nt>>2]=Mt,yt=_t+yt|0,xt[Ft>>2]=yt,_t=Mt-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Nt>>2]=_t,xt[Ft>>2]=yt,xt[vt>>2]=0,Mt=0):(_t=Mt,Mt=Ct),(_t|0)<0&&(Mt=Mt-_t|0,xt[vt>>2]=Mt,yt=yt-_t|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=0),Pt=Mt-yt|0,Ct=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Nt>>2]=Ct,xt[Ft>>2]=0,Mt=Pt,yt=0):Ct=_t,_t=(Ct|0)<(Mt|0)?Ct:Mt,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Mt-_t,xt[Nt>>2]=Ct-_t,xt[Ft>>2]=yt-_t)}function Yo(vt){switch(vt=vt|0,vt|0){case 1:{vt=5;break}case 5:{vt=4;break}case 4:{vt=6;break}case 6:{vt=2;break}case 2:{vt=3;break}case 3:{vt=1;break}}return vt|0}function Is(vt){switch(vt=vt|0,vt|0){case 1:{vt=3;break}case 3:{vt=2;break}case 2:{vt=6;break}case 6:{vt=4;break}case 4:{vt=5;break}case 5:{vt=1;break}}return vt|0}function lo(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;yt=xt[vt>>2]|0,Nt=vt+4|0,_t=xt[Nt>>2]|0,Ft=vt+8|0,Mt=xt[Ft>>2]|0,Ct=_t+(yt<<1)|0,xt[vt>>2]=Ct,_t=Mt+(_t<<1)|0,xt[Nt>>2]=_t,yt=(Mt<<1)+yt|0,xt[Ft>>2]=yt,Mt=_t-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Nt>>2]=Mt,xt[Ft>>2]=yt,xt[vt>>2]=0,_t=Mt,Mt=0):Mt=Ct,(_t|0)<0&&(Mt=Mt-_t|0,xt[vt>>2]=Mt,yt=yt-_t|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=0),Pt=Mt-yt|0,Ct=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Nt>>2]=Ct,xt[Ft>>2]=0,Mt=Pt,yt=0):Ct=_t,_t=(Ct|0)<(Mt|0)?Ct:Mt,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Mt-_t,xt[Nt>>2]=Ct-_t,xt[Ft>>2]=yt-_t)}function Vs(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Ct=xt[vt>>2]|0,Nt=vt+4|0,yt=xt[Nt>>2]|0,Ft=vt+8|0,_t=xt[Ft>>2]|0,Mt=(yt<<1)+Ct|0,Ct=_t+(Ct<<1)|0,xt[vt>>2]=Ct,xt[Nt>>2]=Mt,yt=(_t<<1)+yt|0,xt[Ft>>2]=yt,_t=Mt-Ct|0,(Ct|0)<0?(yt=yt-Ct|0,xt[Nt>>2]=_t,xt[Ft>>2]=yt,xt[vt>>2]=0,Ct=0):_t=Mt,(_t|0)<0&&(Ct=Ct-_t|0,xt[vt>>2]=Ct,yt=yt-_t|0,xt[Ft>>2]=yt,xt[Nt>>2]=0,_t=0),Pt=Ct-yt|0,Mt=_t-yt|0,(yt|0)<0?(xt[vt>>2]=Pt,xt[Nt>>2]=Mt,xt[Ft>>2]=0,Ct=Pt,yt=0):Mt=_t,_t=(Mt|0)<(Ct|0)?Mt:Ct,_t=(yt|0)<(_t|0)?yt:_t,!((_t|0)<=0)&&(xt[vt>>2]=Ct-_t,xt[Nt>>2]=Mt-_t,xt[Ft>>2]=yt-_t)}function Fs(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;return Nt=(xt[vt>>2]|0)-(xt[yt>>2]|0)|0,Ft=(Nt|0)<0,Mt=(xt[vt+4>>2]|0)-(xt[yt+4>>2]|0)-(Ft?Nt:0)|0,Pt=(Mt|0)<0,Ct=(Ft?0-Nt|0:0)+(xt[vt+8>>2]|0)-(xt[yt+8>>2]|0)+(Pt?0-Mt|0:0)|0,vt=(Ct|0)<0,yt=vt?0:Ct,_t=(Pt?0:Mt)-(vt?Ct:0)|0,Ct=(Ft?0:Nt)-(Pt?Mt:0)-(vt?Ct:0)|0,vt=(_t|0)<(Ct|0)?_t:Ct,vt=(yt|0)<(vt|0)?yt:vt,Mt=(vt|0)>0,yt=yt-(Mt?vt:0)|0,_t=_t-(Mt?vt:0)|0,vt=Ct-(Mt?vt:0)|0,vt=(vt|0)>-1?vt:0-vt|0,_t=(_t|0)>-1?_t:0-_t|0,yt=(yt|0)>-1?yt:0-yt|0,yt=(_t|0)>(yt|0)?_t:yt,((vt|0)>(yt|0)?vt:yt)|0}function Mo(vt,yt){vt=vt|0,yt=yt|0;var _t=0;_t=xt[vt+8>>2]|0,xt[yt>>2]=(xt[vt>>2]|0)-_t,xt[yt+4>>2]=(xt[vt+4>>2]|0)-_t}function Dl(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Mt=xt[vt>>2]|0,xt[yt>>2]=Mt,Ct=xt[vt+4>>2]|0,Nt=yt+4|0,xt[Nt>>2]=Ct,Ft=yt+8|0,xt[Ft>>2]=0,_t=(Ct|0)<(Mt|0),vt=_t?Mt:Ct,_t=_t?Ct:Mt;do if((_t|0)<0){if((vt|0)>0){if((vt|-2147483648|0)<(_t|0)&((_t|0)!=-2147483648&(2147483647-vt|0)>=(_t|0)))break;return vt=1,vt|0}if((_t|0)==-2147483648|(-2147483648-vt|0)>(_t|0))return yt=1,yt|0;if((vt|0)>-1){if((vt|-2147483648|0)<(_t|0))break;return vt=1,vt|0}else{if((vt^-2147483648|0)<(_t|0))vt=1;else break;return vt|0}}while(!1);return vt=Ct-Mt|0,(Mt|0)<0?(_t=0-Mt|0,xt[Nt>>2]=vt,xt[Ft>>2]=_t,xt[yt>>2]=0,Mt=0):(vt=Ct,_t=0),(vt|0)<0&&(Mt=Mt-vt|0,xt[yt>>2]=Mt,_t=_t-vt|0,xt[Ft>>2]=_t,xt[Nt>>2]=0,vt=0),Pt=Mt-_t|0,Ct=vt-_t|0,(_t|0)<0?(xt[yt>>2]=Pt,xt[Nt>>2]=Ct,xt[Ft>>2]=0,vt=Ct,Ct=Pt,_t=0):Ct=Mt,Mt=(vt|0)<(Ct|0)?vt:Ct,Mt=(_t|0)<(Mt|0)?_t:Mt,(Mt|0)<=0?(yt=0,yt|0):(xt[yt>>2]=Ct-Mt,xt[Nt>>2]=vt-Mt,xt[Ft>>2]=_t-Mt,yt=0,yt|0)}function ju(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0;yt=vt+8|0,Ct=xt[yt>>2]|0,_t=Ct-(xt[vt>>2]|0)|0,xt[vt>>2]=_t,Mt=vt+4|0,vt=(xt[Mt>>2]|0)-Ct|0,xt[Mt>>2]=vt,xt[yt>>2]=0-(vt+_t)}function Ep(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;_t=xt[vt>>2]|0,yt=0-_t|0,xt[vt>>2]=yt,Nt=vt+8|0,xt[Nt>>2]=0,Ft=vt+4|0,Mt=xt[Ft>>2]|0,Ct=Mt+_t|0,(_t|0)>0?(xt[Ft>>2]=Ct,xt[Nt>>2]=_t,xt[vt>>2]=0,yt=0,Mt=Ct):_t=0,(Mt|0)<0?(Pt=yt-Mt|0,xt[vt>>2]=Pt,_t=_t-Mt|0,xt[Nt>>2]=_t,xt[Ft>>2]=0,Ct=Pt-_t|0,yt=0-_t|0,(_t|0)<0?(xt[vt>>2]=Ct,xt[Ft>>2]=yt,xt[Nt>>2]=0,Mt=yt,_t=0):(Mt=0,Ct=Pt)):Ct=yt,yt=(Mt|0)<(Ct|0)?Mt:Ct,yt=(_t|0)<(yt|0)?_t:yt,!((yt|0)<=0)&&(xt[vt>>2]=Ct-yt,xt[Ft>>2]=Mt-yt,xt[Nt>>2]=_t-yt)}function Sl(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0;if(An=fn,fn=fn+64|0,on=An,Ft=An+56|0,!(!0&(yt&2013265920|0)==134217728&(!0&(Mt&2013265920|0)==134217728)))return Ct=5,fn=An,Ct|0;if((vt|0)==(_t|0)&(yt|0)==(Mt|0))return xt[Ct>>2]=0,Ct=0,fn=An,Ct|0;if(Nt=_r(vt|0,yt|0,52)|0,cn()|0,Nt=Nt&15,Qt=_r(_t|0,Mt|0,52)|0,cn()|0,(Nt|0)!=(Qt&15|0))return Ct=12,fn=An,Ct|0;if(Pt=Nt+-1|0,Nt>>>0>1){El(vt,yt,Pt,on)|0,El(_t,Mt,Pt,Ft)|0,Qt=on,Vt=xt[Qt>>2]|0,Qt=xt[Qt+4>>2]|0;e:do if((Vt|0)==(xt[Ft>>2]|0)&&(Qt|0)==(xt[Ft+4>>2]|0)){Nt=(Nt^15)*3|0,Pt=_r(vt|0,yt|0,Nt|0)|0,cn()|0,Pt=Pt&7,Nt=_r(_t|0,Mt|0,Nt|0)|0,cn()|0,Nt=Nt&7;do if((Pt|0)==0|(Nt|0)==0)xt[Ct>>2]=1,Pt=0;else if((Pt|0)==7)Pt=5;else{if((Pt|0)==1|(Nt|0)==1&&Es(Vt,Qt)|0){Pt=5;break}if((xt[15536+(Pt<<2)>>2]|0)!=(Nt|0)&&(xt[15568+(Pt<<2)>>2]|0)!=(Nt|0))break e;xt[Ct>>2]=1,Pt=0}while(!1);return Ct=Pt,fn=An,Ct|0}while(!1)}Pt=on,Nt=Pt+56|0;do xt[Pt>>2]=0,Pt=Pt+4|0;while((Pt|0)<(Nt|0));return Go(vt,yt,1,on)|0,yt=on,!((xt[yt>>2]|0)==(_t|0)&&(xt[yt+4>>2]|0)==(Mt|0))&&(yt=on+8|0,!((xt[yt>>2]|0)==(_t|0)&&(xt[yt+4>>2]|0)==(Mt|0)))&&(yt=on+16|0,!((xt[yt>>2]|0)==(_t|0)&&(xt[yt+4>>2]|0)==(Mt|0)))&&(yt=on+24|0,!((xt[yt>>2]|0)==(_t|0)&&(xt[yt+4>>2]|0)==(Mt|0)))&&(yt=on+32|0,!((xt[yt>>2]|0)==(_t|0)&&(xt[yt+4>>2]|0)==(Mt|0)))&&(yt=on+40|0,!((xt[yt>>2]|0)==(_t|0)&&(xt[yt+4>>2]|0)==(Mt|0)))?(Pt=on+48|0,Pt=((xt[Pt>>2]|0)==(_t|0)?(xt[Pt+4>>2]|0)==(Mt|0):0)&1):Pt=1,xt[Ct>>2]=Pt,Ct=0,fn=An,Ct|0}function $l(vt,yt,_t,Mt,Ct){return vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0,_t=$a(vt,yt,_t,Mt)|0,(_t|0)==7?(Ct=11,Ct|0):(Mt=Cr(_t|0,0,56)|0,yt=yt&-2130706433|(cn()|0)|268435456,xt[Ct>>2]=vt|Mt,xt[Ct+4>>2]=yt,Ct=0,Ct|0)}function qu(vt,yt,_t){return vt=vt|0,yt=yt|0,_t=_t|0,!0&(yt&2013265920|0)==268435456?(xt[_t>>2]=vt,xt[_t+4>>2]=yt&-2130706433|134217728,_t=0,_t|0):(_t=6,_t|0)}function Mp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;return Ct=fn,fn=fn+16|0,Mt=Ct,xt[Mt>>2]=0,!0&(yt&2013265920|0)==268435456?(Pt=_r(vt|0,yt|0,56)|0,cn()|0,Mt=Cs(vt,yt&-2130706433|134217728,Pt&7,Mt,_t)|0,fn=Ct,Mt|0):(Mt=6,fn=Ct,Mt|0)}function Wu(vt,yt){vt=vt|0,yt=yt|0;var _t=0;switch(_t=_r(vt|0,yt|0,56)|0,cn()|0,_t&7){case 0:case 7:return _t=0,_t|0}return _t=yt&-2130706433|134217728,!(!0&(yt&2013265920|0)==268435456)||!0&(yt&117440512|0)==16777216&(Es(vt,_t)|0)!=0?(_t=0,_t|0):(_t=Vo(vt,_t)|0,_t|0)}function wp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0;return Ct=fn,fn=fn+16|0,Mt=Ct,!0&(yt&2013265920|0)==268435456?(Pt=yt&-2130706433|134217728,Nt=_t,xt[Nt>>2]=vt,xt[Nt+4>>2]=Pt,xt[Mt>>2]=0,yt=_r(vt|0,yt|0,56)|0,cn()|0,Mt=Cs(vt,Pt,yt&7,Mt,_t+8|0)|0,fn=Ct,Mt|0):(Mt=6,fn=Ct,Mt|0)}function Cp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0;return Ct=(Es(vt,yt)|0)==0,yt=yt&-2130706433,Mt=_t,xt[Mt>>2]=Ct?vt:0,xt[Mt+4>>2]=Ct?yt|285212672:0,Mt=_t+8|0,xt[Mt>>2]=vt,xt[Mt+4>>2]=yt|301989888,Mt=_t+16|0,xt[Mt>>2]=vt,xt[Mt+4>>2]=yt|318767104,Mt=_t+24|0,xt[Mt>>2]=vt,xt[Mt+4>>2]=yt|335544320,Mt=_t+32|0,xt[Mt>>2]=vt,xt[Mt+4>>2]=yt|352321536,_t=_t+40|0,xt[_t>>2]=vt,xt[_t+4>>2]=yt|369098752,0}function iu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0;return Nt=fn,fn=fn+16|0,Ct=Nt,Pt=yt&-2130706433|134217728,!0&(yt&2013265920|0)==268435456?(Mt=_r(vt|0,yt|0,56)|0,cn()|0,Mt=qp(vt,Pt,Mt&7)|0,(Mt|0)==-1?(xt[_t>>2]=0,Pt=6,fn=Nt,Pt|0):(Xl(vt,Pt,Ct)|0&&mr(23313,22484,282,22499),yt=_r(vt|0,yt|0,52)|0,cn()|0,yt=yt&15,Es(vt,Pt)|0?Nl(Ct,yt,Mt,2,_t):_o(Ct,yt,Mt,2,_t),Pt=0,fn=Nt,Pt|0)):(Pt=6,fn=Nt,Pt|0)}function Ku(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0;Mt=fn,fn=fn+16|0,Ct=Mt,Rp(vt,yt,_t,Ct),Eo(Ct,_t+4|0),fn=Mt}function Rp(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;if(Ft=fn,fn=fn+16|0,Vt=Ft,Pp(vt,_t,Vt),Pt=+Nr(+(1-+mn[Vt>>3]*.5)),Pt<1e-16){xt[Mt>>2]=0,xt[Mt+4>>2]=0,xt[Mt+8>>2]=0,xt[Mt+12>>2]=0,fn=Ft;return}if(Vt=xt[_t>>2]|0,Ct=+mn[15920+(Vt*24|0)>>3],Ct=+du(Ct-+du(+hp(15600+(Vt<<4)|0,vt))),bo(yt)|0?Nt=+du(Ct+-.3334731722518321):Nt=Ct,Ct=+xr(+Pt)/.381966011250105,(yt|0)>0){vt=0;do Ct=Ct*2.6457513110645907,vt=vt+1|0;while((vt|0)!=(yt|0))}Pt=+Un(+Nt)*Ct,mn[Mt>>3]=Pt,Nt=+Cn(+Nt)*Ct,mn[Mt+8>>3]=Nt,fn=Ft}function Pp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;if(Pt=fn,fn=fn+32|0,Ct=Pt,vm(vt,Ct),xt[yt>>2]=0,mn[_t>>3]=5,Mt=+qs(16400,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=0,mn[_t>>3]=Mt),Mt=+qs(16424,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=1,mn[_t>>3]=Mt),Mt=+qs(16448,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=2,mn[_t>>3]=Mt),Mt=+qs(16472,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=3,mn[_t>>3]=Mt),Mt=+qs(16496,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=4,mn[_t>>3]=Mt),Mt=+qs(16520,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=5,mn[_t>>3]=Mt),Mt=+qs(16544,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=6,mn[_t>>3]=Mt),Mt=+qs(16568,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=7,mn[_t>>3]=Mt),Mt=+qs(16592,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=8,mn[_t>>3]=Mt),Mt=+qs(16616,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=9,mn[_t>>3]=Mt),Mt=+qs(16640,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=10,mn[_t>>3]=Mt),Mt=+qs(16664,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=11,mn[_t>>3]=Mt),Mt=+qs(16688,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=12,mn[_t>>3]=Mt),Mt=+qs(16712,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=13,mn[_t>>3]=Mt),Mt=+qs(16736,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=14,mn[_t>>3]=Mt),Mt=+qs(16760,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=15,mn[_t>>3]=Mt),Mt=+qs(16784,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=16,mn[_t>>3]=Mt),Mt=+qs(16808,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=17,mn[_t>>3]=Mt),Mt=+qs(16832,Ct),Mt<+mn[_t>>3]&&(xt[yt>>2]=18,mn[_t>>3]=Mt),Mt=+qs(16856,Ct),!(Mt<+mn[_t>>3])){fn=Pt;return}xt[yt>>2]=19,mn[_t>>3]=Mt,fn=Pt}function su(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0;if(Pt=+Hp(vt),Pt<1e-16){yt=15600+(yt<<4)|0,xt[Ct>>2]=xt[yt>>2],xt[Ct+4>>2]=xt[yt+4>>2],xt[Ct+8>>2]=xt[yt+8>>2],xt[Ct+12>>2]=xt[yt+12>>2];return}if(Nt=+Gr(+ +mn[vt+8>>3],+ +mn[vt>>3]),(_t|0)>0){vt=0;do Pt=Pt/2.6457513110645907,vt=vt+1|0;while((vt|0)!=(_t|0))}Mt?(Pt=Pt/3,_t=(bo(_t)|0)==0,Pt=+Fr(+((_t?Pt:Pt/2.6457513110645907)*.381966011250105))):(Pt=+Fr(+(Pt*.381966011250105)),bo(_t)|0&&(Nt=+du(Nt+.3334731722518321))),Qu(15600+(yt<<4)|0,+du(+mn[15920+(yt*24|0)>>3]-Nt),Pt,Ct)}function lp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0;Mt=fn,fn=fn+16|0,Ct=Mt,oo(vt+4|0,Ct),su(Ct,xt[vt>>2]|0,yt,0,_t),fn=Mt}function Nl(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0,vs=0,fs=0,ms=0,_i=0,Zr=0,es=0,xs=0,Yr=0;if(es=fn,fn=fn+272|0,Pt=es+256|0,Hn=es+240|0,ms=es,_i=es+224|0,Zr=es+208|0,Kn=es+176|0,kn=es+160|0,$r=es+192|0,Br=es+144|0,Er=es+128|0,Dr=es+112|0,vs=es+96|0,fs=es+80|0,xt[Pt>>2]=yt,xt[Hn>>2]=xt[vt>>2],xt[Hn+4>>2]=xt[vt+4>>2],xt[Hn+8>>2]=xt[vt+8>>2],xt[Hn+12>>2]=xt[vt+12>>2],Hl(Hn,Pt,ms),xt[Ct>>2]=0,Hn=Mt+_t+((Mt|0)==5&1)|0,(Hn|0)<=(_t|0)){fn=es;return}Vt=xt[Pt>>2]|0,Qt=_i+4|0,on=Kn+4|0,An=_t+5|0,Tn=16880+(Vt<<2)|0,Pn=16960+(Vt<<2)|0,bn=Er+8|0,Bn=Dr+8|0,ur=vs+8|0,Ln=Zr+4|0,Ft=_t;e:for(;;){Nt=ms+(((Ft|0)%5|0)<<4)|0,xt[Zr>>2]=xt[Nt>>2],xt[Zr+4>>2]=xt[Nt+4>>2],xt[Zr+8>>2]=xt[Nt+8>>2],xt[Zr+12>>2]=xt[Nt+12>>2];do;while((Tl(Zr,Vt,0,1)|0)==2);if((Ft|0)>(_t|0)&(bo(yt)|0)!=0){if(xt[Kn>>2]=xt[Zr>>2],xt[Kn+4>>2]=xt[Zr+4>>2],xt[Kn+8>>2]=xt[Zr+8>>2],xt[Kn+12>>2]=xt[Zr+12>>2],oo(Qt,kn),Mt=xt[Kn>>2]|0,Pt=xt[17040+(Mt*80|0)+(xt[_i>>2]<<2)>>2]|0,xt[Kn>>2]=xt[18640+(Mt*80|0)+(Pt*20|0)>>2],Nt=xt[18640+(Mt*80|0)+(Pt*20|0)+16>>2]|0,(Nt|0)>0){vt=0;do xl(on),vt=vt+1|0;while((vt|0)<(Nt|0))}switch(Nt=18640+(Mt*80|0)+(Pt*20|0)+4|0,xt[$r>>2]=xt[Nt>>2],xt[$r+4>>2]=xt[Nt+4>>2],xt[$r+8>>2]=xt[Nt+8>>2],ru($r,(xt[Tn>>2]|0)*3|0),Rs(on,$r,on),_s(on),oo(on,Br),xs=+(xt[Pn>>2]|0),mn[Er>>3]=xs*3,mn[bn>>3]=0,Yr=xs*-1.5,mn[Dr>>3]=Yr,mn[Bn>>3]=xs*2.598076211353316,mn[vs>>3]=Yr,mn[ur>>3]=xs*-2.598076211353316,xt[17040+((xt[Kn>>2]|0)*80|0)+(xt[Zr>>2]<<2)>>2]|0){case 1:{vt=Dr,Mt=Er;break}case 3:{vt=vs,Mt=Dr;break}case 2:{vt=Er,Mt=vs;break}default:{vt=12;break e}}jp(kn,Br,Mt,vt,fs),su(fs,xt[Kn>>2]|0,Vt,1,Ct+8+(xt[Ct>>2]<<4)|0),xt[Ct>>2]=(xt[Ct>>2]|0)+1}if((Ft|0)<(An|0)&&(oo(Ln,Kn),su(Kn,xt[Zr>>2]|0,Vt,1,Ct+8+(xt[Ct>>2]<<4)|0),xt[Ct>>2]=(xt[Ct>>2]|0)+1),xt[_i>>2]=xt[Zr>>2],xt[_i+4>>2]=xt[Zr+4>>2],xt[_i+8>>2]=xt[Zr+8>>2],xt[_i+12>>2]=xt[Zr+12>>2],Ft=Ft+1|0,(Ft|0)>=(Hn|0)){vt=3;break}}if((vt|0)==3){fn=es;return}else(vt|0)==12&&mr(22522,22569,571,22579)}function Hl(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;Vt=fn,fn=fn+128|0,Mt=Vt+64|0,Ct=Vt,Pt=Mt,Nt=20240,Ft=Pt+60|0;do xt[Pt>>2]=xt[Nt>>2],Pt=Pt+4|0,Nt=Nt+4|0;while((Pt|0)<(Ft|0));Pt=Ct,Nt=20304,Ft=Pt+60|0;do xt[Pt>>2]=xt[Nt>>2],Pt=Pt+4|0,Nt=Nt+4|0;while((Pt|0)<(Ft|0));Ft=(bo(xt[yt>>2]|0)|0)==0,Mt=Ft?Mt:Ct,Ct=vt+4|0,lo(Ct),Vs(Ct),bo(xt[yt>>2]|0)|0&&(Do(Ct),xt[yt>>2]=(xt[yt>>2]|0)+1),xt[_t>>2]=xt[vt>>2],yt=_t+4|0,Rs(Ct,Mt,yt),_s(yt),xt[_t+16>>2]=xt[vt>>2],yt=_t+20|0,Rs(Ct,Mt+12|0,yt),_s(yt),xt[_t+32>>2]=xt[vt>>2],yt=_t+36|0,Rs(Ct,Mt+24|0,yt),_s(yt),xt[_t+48>>2]=xt[vt>>2],yt=_t+52|0,Rs(Ct,Mt+36|0,yt),_s(yt),xt[_t+64>>2]=xt[vt>>2],_t=_t+68|0,Rs(Ct,Mt+48|0,_t),_s(_t),fn=Vt}function Tl(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0;if(bn=fn,fn=fn+32|0,Tn=bn+12|0,Ft=bn,Pn=vt+4|0,An=xt[16960+(yt<<2)>>2]|0,on=(Mt|0)!=0,An=on?An*3|0:An,Ct=xt[Pn>>2]|0,Qt=vt+8|0,Nt=xt[Qt>>2]|0,on){if(Pt=vt+12|0,Mt=xt[Pt>>2]|0,Ct=Nt+Ct+Mt|0,(Ct|0)==(An|0))return Pn=1,fn=bn,Pn|0;Vt=Pt}else Vt=vt+12|0,Mt=xt[Vt>>2]|0,Ct=Nt+Ct+Mt|0;if((Ct|0)<=(An|0))return Pn=0,fn=bn,Pn|0;do if((Mt|0)>0){if(Mt=xt[vt>>2]|0,(Nt|0)>0){Pt=18640+(Mt*80|0)+60|0,Mt=vt;break}Mt=18640+(Mt*80|0)+40|0,_t?(Hu(Tn,An,0,0),Ul(Pn,Tn,Ft),_l(Ft),Rs(Ft,Tn,Pn),Pt=Mt,Mt=vt):(Pt=Mt,Mt=vt)}else Pt=18640+((xt[vt>>2]|0)*80|0)+20|0,Mt=vt;while(!1);if(xt[Mt>>2]=xt[Pt>>2],Ct=Pt+16|0,(xt[Ct>>2]|0)>0){Mt=0;do xl(Pn),Mt=Mt+1|0;while((Mt|0)<(xt[Ct>>2]|0))}return vt=Pt+4|0,xt[Tn>>2]=xt[vt>>2],xt[Tn+4>>2]=xt[vt+4>>2],xt[Tn+8>>2]=xt[vt+8>>2],yt=xt[16880+(yt<<2)>>2]|0,ru(Tn,on?yt*3|0:yt),Rs(Pn,Tn,Pn),_s(Pn),on?Mt=((xt[Qt>>2]|0)+(xt[Pn>>2]|0)+(xt[Vt>>2]|0)|0)==(An|0)?1:2:Mt=2,Pn=Mt,fn=bn,Pn|0}function Xu(vt,yt){vt=vt|0,yt=yt|0;var _t=0;do _t=Tl(vt,yt,0,1)|0;while((_t|0)==2);return _t|0}function _o(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0,vs=0,fs=0,ms=0;if(vs=fn,fn=fn+240|0,Pt=vs+224|0,$r=vs+208|0,Br=vs,Er=vs+192|0,Dr=vs+176|0,ur=vs+160|0,Ln=vs+144|0,Hn=vs+128|0,Kn=vs+112|0,kn=vs+96|0,xt[Pt>>2]=yt,xt[$r>>2]=xt[vt>>2],xt[$r+4>>2]=xt[vt+4>>2],xt[$r+8>>2]=xt[vt+8>>2],xt[$r+12>>2]=xt[vt+12>>2],wo($r,Pt,Br),xt[Ct>>2]=0,Bn=Mt+_t+((Mt|0)==6&1)|0,(Bn|0)<=(_t|0)){fn=vs;return}Vt=xt[Pt>>2]|0,Qt=_t+6|0,on=16960+(Vt<<2)|0,An=Ln+8|0,Tn=Hn+8|0,Pn=Kn+8|0,bn=Er+4|0,Nt=0,Ft=_t,Mt=-1;e:for(;;){if(Pt=(Ft|0)%6|0,vt=Br+(Pt<<4)|0,xt[Er>>2]=xt[vt>>2],xt[Er+4>>2]=xt[vt+4>>2],xt[Er+8>>2]=xt[vt+8>>2],xt[Er+12>>2]=xt[vt+12>>2],vt=Nt,Nt=Tl(Er,Vt,0,1)|0,(Ft|0)>(_t|0)&(bo(yt)|0)!=0&&(vt|0)!=1&&(xt[Er>>2]|0)!=(Mt|0)){switch(oo(Br+(((Pt+5|0)%6|0)<<4)+4|0,Dr),oo(Br+(Pt<<4)+4|0,ur),fs=+(xt[on>>2]|0),mn[Ln>>3]=fs*3,mn[An>>3]=0,ms=fs*-1.5,mn[Hn>>3]=ms,mn[Tn>>3]=fs*2.598076211353316,mn[Kn>>3]=ms,mn[Pn>>3]=fs*-2.598076211353316,Pt=xt[$r>>2]|0,xt[17040+(Pt*80|0)+(((Mt|0)==(Pt|0)?xt[Er>>2]|0:Mt)<<2)>>2]|0){case 1:{vt=Hn,Mt=Ln;break}case 3:{vt=Kn,Mt=Hn;break}case 2:{vt=Ln,Mt=Kn;break}default:{vt=8;break e}}jp(Dr,ur,Mt,vt,kn),!(vp(Dr,kn)|0)&&!(vp(ur,kn)|0)&&(su(kn,xt[$r>>2]|0,Vt,1,Ct+8+(xt[Ct>>2]<<4)|0),xt[Ct>>2]=(xt[Ct>>2]|0)+1)}if((Ft|0)<(Qt|0)&&(oo(bn,Dr),su(Dr,xt[Er>>2]|0,Vt,1,Ct+8+(xt[Ct>>2]<<4)|0),xt[Ct>>2]=(xt[Ct>>2]|0)+1),Ft=Ft+1|0,(Ft|0)>=(Bn|0)){vt=3;break}else Mt=xt[Er>>2]|0}if((vt|0)==3){fn=vs;return}else(vt|0)==8&&mr(22606,22569,736,22651)}function wo(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;Vt=fn,fn=fn+160|0,Mt=Vt+80|0,Ct=Vt,Pt=Mt,Nt=20368,Ft=Pt+72|0;do xt[Pt>>2]=xt[Nt>>2],Pt=Pt+4|0,Nt=Nt+4|0;while((Pt|0)<(Ft|0));Pt=Ct,Nt=20448,Ft=Pt+72|0;do xt[Pt>>2]=xt[Nt>>2],Pt=Pt+4|0,Nt=Nt+4|0;while((Pt|0)<(Ft|0));Ft=(bo(xt[yt>>2]|0)|0)==0,Mt=Ft?Mt:Ct,Ct=vt+4|0,lo(Ct),Vs(Ct),bo(xt[yt>>2]|0)|0&&(Do(Ct),xt[yt>>2]=(xt[yt>>2]|0)+1),xt[_t>>2]=xt[vt>>2],yt=_t+4|0,Rs(Ct,Mt,yt),_s(yt),xt[_t+16>>2]=xt[vt>>2],yt=_t+20|0,Rs(Ct,Mt+12|0,yt),_s(yt),xt[_t+32>>2]=xt[vt>>2],yt=_t+36|0,Rs(Ct,Mt+24|0,yt),_s(yt),xt[_t+48>>2]=xt[vt>>2],yt=_t+52|0,Rs(Ct,Mt+36|0,yt),_s(yt),xt[_t+64>>2]=xt[vt>>2],yt=_t+68|0,Rs(Ct,Mt+48|0,yt),_s(yt),xt[_t+80>>2]=xt[vt>>2],_t=_t+84|0,Rs(Ct,Mt+60|0,_t),_s(_t),fn=Vt}function Wl(vt,yt){return vt=vt|0,yt=yt|0,yt=_r(vt|0,yt|0,52)|0,cn()|0,yt&15|0}function Qo(vt,yt){return vt=vt|0,yt=yt|0,yt=_r(vt|0,yt|0,45)|0,cn()|0,yt&127|0}function Vo(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;if(!(!0&(yt&-16777216|0)==134217728)||(Nt=_r(vt|0,yt|0,45)|0,cn()|0,Nt=Nt&127,Nt>>>0>121))return yt=0,yt|0;_t=_r(vt|0,yt|0,52)|0,cn()|0,_t=_t&15;do if(_t|0){for(Ct=1,Mt=0;;){if(Pt=_r(vt|0,yt|0,(15-Ct|0)*3|0)|0,cn()|0,Pt=Pt&7,(Pt|0)!=0&(Mt^1))if((Pt|0)==1&(ps(Nt)|0)!=0){Ft=0,Mt=13;break}else Mt=1;if((Pt|0)==7){Ft=0,Mt=13;break}if(Ct>>>0<_t>>>0)Ct=Ct+1|0;else{Mt=9;break}}if((Mt|0)==9){if((_t|0)==15)Ft=1;else break;return Ft|0}else if((Mt|0)==13)return Ft|0}while(!1);for(;;){if(Ft=_r(vt|0,yt|0,(14-_t|0)*3|0)|0,cn()|0,!((Ft&7|0)==7&!0)){Ft=0,Mt=13;break}if(_t>>>0<14)_t=_t+1|0;else{Ft=1,Mt=13;break}}return(Mt|0)==13?Ft|0:0}function El(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0;if(Pt=_r(vt|0,yt|0,52)|0,cn()|0,Pt=Pt&15,_t>>>0>15)return Mt=4,Mt|0;if((Pt|0)<(_t|0))return Mt=12,Mt|0;if((Pt|0)==(_t|0))return xt[Mt>>2]=vt,xt[Mt+4>>2]=yt,Mt=0,Mt|0;if(Ct=Cr(_t|0,0,52)|0,Ct=Ct|vt,vt=cn()|0|yt&-15728641,(Pt|0)>(_t|0))do yt=Cr(7,0,(14-_t|0)*3|0)|0,_t=_t+1|0,Ct=yt|Ct,vt=cn()|0|vt;while((_t|0)<(Pt|0));return xt[Mt>>2]=Ct,xt[Mt+4>>2]=vt,Mt=0,Mt|0}function Cu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0;if(Pt=_r(vt|0,yt|0,52)|0,cn()|0,Pt=Pt&15,!((_t|0)<16&(Pt|0)<=(_t|0)))return Mt=4,Mt|0;Ct=_t-Pt|0,_t=_r(vt|0,yt|0,45)|0,cn()|0;e:do if(!(ps(_t&127)|0))_t=na(7,0,Ct,((Ct|0)<0)<<31>>31)|0,Ct=cn()|0;else{t:do if(Pt|0){for(_t=1;Nt=Cr(7,0,(15-_t|0)*3|0)|0,!!((Nt&vt|0)==0&((cn()|0)&yt|0)==0);)if(_t>>>0<Pt>>>0)_t=_t+1|0;else break t;_t=na(7,0,Ct,((Ct|0)<0)<<31>>31)|0,Ct=cn()|0;break e}while(!1);_t=na(7,0,Ct,((Ct|0)<0)<<31>>31)|0,_t=fo(_t|0,cn()|0,5,0)|0,_t=ts(_t|0,cn()|0,-5,-1)|0,_t=jo(_t|0,cn()|0,6,0)|0,_t=ts(_t|0,cn()|0,1,0)|0,Ct=cn()|0}while(!1);return Nt=Mt,xt[Nt>>2]=_t,xt[Nt+4>>2]=Ct,Nt=0,Nt|0}function Es(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0;if(Ct=_r(vt|0,yt|0,45)|0,cn()|0,!(ps(Ct&127)|0))return Ct=0,Ct|0;Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ct=Ct&15;e:do if(!Ct)_t=0;else for(Mt=1;;){if(_t=_r(vt|0,yt|0,(15-Mt|0)*3|0)|0,cn()|0,_t=_t&7,_t|0)break e;if(Mt>>>0<Ct>>>0)Mt=Mt+1|0;else{_t=0;break}}while(!1);return Ct=(_t|0)==0&1,Ct|0}function cp(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0;if(Nt=fn,fn=fn+16|0,Pt=Nt,Yu(Pt,vt,yt,_t),yt=Pt,vt=xt[yt>>2]|0,yt=xt[yt+4>>2]|0,(vt|0)==0&(yt|0)==0)return fn=Nt,0;Ct=0,_t=0;do Ft=Mt+(Ct<<3)|0,xt[Ft>>2]=vt,xt[Ft+4>>2]=yt,Ct=ts(Ct|0,_t|0,1,0)|0,_t=cn()|0,Ql(Pt),Ft=Pt,vt=xt[Ft>>2]|0,yt=xt[Ft+4>>2]|0;while(!((vt|0)==0&(yt|0)==0));return fn=Nt,0}function Co(vt,yt,_t,Mt){return vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,(Mt|0)<(_t|0)?(_t=yt,Mt=vt,wr(_t|0),Mt|0):(_t=Cr(-1,-1,((Mt-_t|0)*3|0)+3|0)|0,Mt=Cr(~_t|0,~(cn()|0)|0,(15-Mt|0)*3|0)|0,_t=~(cn()|0)&yt,Mt=~Mt&vt,wr(_t|0),Mt|0)}function Ro(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0;return Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ct=Ct&15,(_t|0)<16&(Ct|0)<=(_t|0)?((Ct|0)<(_t|0)&&(Ct=Cr(-1,-1,((_t+-1-Ct|0)*3|0)+3|0)|0,Ct=Cr(~Ct|0,~(cn()|0)|0,(15-_t|0)*3|0)|0,yt=~(cn()|0)&yt,vt=~Ct&vt),Ct=Cr(_t|0,0,52)|0,_t=yt&-15728641|(cn()|0),xt[Mt>>2]=vt|Ct,xt[Mt+4>>2]=_t,Mt=0,Mt|0):(Mt=4,Mt|0)}function Ns(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0;if((_t|0)==0&(Mt|0)==0)return Er=0,Er|0;if(Ct=vt,Pt=xt[Ct>>2]|0,Ct=xt[Ct+4>>2]|0,!0&(Ct&15728640|0)==0){if(!((Mt|0)>0|(Mt|0)==0&_t>>>0>0)||(Er=yt,xt[Er>>2]=Pt,xt[Er+4>>2]=Ct,(_t|0)==1&(Mt|0)==0))return Er=0,Er|0;Ct=1;do $r=vt+(Ct<<3)|0,Br=xt[$r+4>>2]|0,Er=yt+(Ct<<3)|0,xt[Er>>2]=xt[$r>>2],xt[Er+4>>2]=Br,Ct=Ct+1|0;while(0<(Mt|0)|(Mt|0)==0&Ct>>>0<_t>>>0);return Ct=0,Ct|0}if(kn=_t<<3,Br=Ks(kn)|0,!Br)return Er=13,Er|0;if(Au(Br|0,vt|0,kn|0)|0,$r=So(_t,8)|0,!$r)return Qr(Br),Er=13,Er|0;e:do if(_t|0){t:for(;;){Ct=Br,Ln=xt[Ct>>2]|0,Ct=xt[Ct+4>>2]|0,Hn=_r(Ln|0,Ct|0,52)|0,cn()|0,Hn=Hn&15,Kn=Hn+-1|0,ur=(_t|0)>0;n:do if((Hn|0)!=0&ur){if(Pn=((_t|0)<0)<<31>>31,bn=Cr(Kn|0,0,52)|0,Bn=cn()|0,Kn>>>0>15){if(!((Ln|0)==0&(Ct|0)==0)){Er=17;break t}for(Pt=0;;){if(Pt=Pt+1|0,(Pt|0)>=(_t|0))break n;if(Mt=Br+(Pt<<3)|0,Bn=xt[Mt>>2]|0,Mt=xt[Mt+4>>2]|0,!((Bn|0)==0&(Mt|0)==0)){Ct=Mt,Er=17;break t}}}for(Pt=0,vt=Ln,Mt=Ct;;){if(!((vt|0)==0&(Mt|0)==0)){if(!(!0&(Mt&117440512|0)==0)){Er=22;break t}if(Ft=_r(vt|0,Mt|0,52)|0,cn()|0,Ft=Ft&15,(Ft|0)<(Kn|0)){Ct=12,Er=28;break t}if((Ft|0)!=(Kn|0)&&(vt=vt|bn,Mt=Mt&-15728641|Bn,Ft>>>0>=Hn>>>0)){Nt=Kn;do Tn=Cr(7,0,(14-Nt|0)*3|0)|0,Nt=Nt+1|0,vt=Tn|vt,Mt=cn()|0|Mt;while(Nt>>>0<Ft>>>0)}if(Nt=Qs(vt|0,Mt|0,_t|0,Pn|0)|0,cn()|0,Qt=$r+(Nt<<3)|0,Ft=Qt,Vt=xt[Ft>>2]|0,Ft=xt[Ft+4>>2]|0,(Vt|0)==0&(Ft|0)==0)Nt=Qt;else for(Tn=0;;){if((Tn|0)>(_t|0)){Er=32;break t}if((Vt|0)==(vt|0)&(Ft&-117440513|0)==(Mt|0)){on=_r(Vt|0,Ft|0,56)|0,cn()|0,on=on&7,An=on+1|0,Dr=_r(Vt|0,Ft|0,45)|0,cn()|0;r:do if(!(ps(Dr&127)|0))Ft=7;else{if(Vt=_r(Vt|0,Ft|0,52)|0,cn()|0,Vt=Vt&15,!Vt){Ft=6;break}for(Ft=1;;){if(Dr=Cr(7,0,(15-Ft|0)*3|0)|0,!((Dr&vt|0)==0&((cn()|0)&Mt|0)==0)){Ft=7;break r}if(Ft>>>0<Vt>>>0)Ft=Ft+1|0;else{Ft=6;break}}}while(!1);if((on+2|0)>>>0>Ft>>>0){Er=42;break t}Dr=Cr(An|0,0,56)|0,Mt=cn()|0|Mt&-117440513,An=Qt,xt[An>>2]=0,xt[An+4>>2]=0,vt=Dr|vt}else Nt=(Nt+1|0)%(_t|0)|0;if(Qt=$r+(Nt<<3)|0,Ft=Qt,Vt=xt[Ft>>2]|0,Ft=xt[Ft+4>>2]|0,(Vt|0)==0&(Ft|0)==0){Nt=Qt;break}else Tn=Tn+1|0}Dr=Nt,xt[Dr>>2]=vt,xt[Dr+4>>2]=Mt}if(Pt=Pt+1|0,(Pt|0)>=(_t|0))break n;Mt=Br+(Pt<<3)|0,vt=xt[Mt>>2]|0,Mt=xt[Mt+4>>2]|0}}while(!1);if((_t+5|0)>>>0<11){Er=85;break}if(Bn=So((_t|0)/6|0,8)|0,!Bn){Er=49;break}n:do if(ur){Tn=0,An=0;do{if(Ft=$r+(Tn<<3)|0,Mt=Ft,Pt=xt[Mt>>2]|0,Mt=xt[Mt+4>>2]|0,!((Pt|0)==0&(Mt|0)==0)){Vt=_r(Pt|0,Mt|0,56)|0,cn()|0,Vt=Vt&7,vt=Vt+1|0,Qt=Mt&-117440513,Dr=_r(Pt|0,Mt|0,45)|0,cn()|0;r:do if(ps(Dr&127)|0){if(on=_r(Pt|0,Mt|0,52)|0,cn()|0,on=on&15,on|0)for(Nt=1;;){if(Dr=Cr(7,0,(15-Nt|0)*3|0)|0,!((Pt&Dr|0)==0&(Qt&(cn()|0)|0)==0))break r;if(Nt>>>0<on>>>0)Nt=Nt+1|0;else break}Mt=Cr(vt|0,0,56)|0,Pt=Mt|Pt,Mt=cn()|0|Qt,vt=Ft,xt[vt>>2]=Pt,xt[vt+4>>2]=Mt,vt=Vt+2|0}while(!1);(vt|0)==7&&(Dr=Bn+(An<<3)|0,xt[Dr>>2]=Pt,xt[Dr+4>>2]=Mt&-117440513,An=An+1|0)}Tn=Tn+1|0}while((Tn|0)!=(_t|0));if(ur){if(Tn=((_t|0)<0)<<31>>31,Pn=Cr(Kn|0,0,52)|0,bn=cn()|0,Kn>>>0>15){if(!((Ln|0)==0&(Ct|0)==0)){Ct=4,Er=84;break t}for(Ct=0;;){if(Ct=Ct+1|0,(Ct|0)>=(_t|0)){Pt=0,Ct=An;break n}if(Dr=Br+(Ct<<3)|0,!((xt[Dr>>2]|0)==0&(xt[Dr+4>>2]|0)==0)){Ct=4,Er=84;break t}}}for(on=0,Pt=0,Qt=Ln;;){do if(!((Qt|0)==0&(Ct|0)==0)){if(Ft=_r(Qt|0,Ct|0,52)|0,cn()|0,Ft=Ft&15,(Ft|0)<(Kn|0)){Ct=12,Er=84;break t}do if((Ft|0)==(Kn|0))Mt=Qt,Ft=Ct;else{if(Mt=Qt|Pn,vt=Ct&-15728641|bn,Ft>>>0<Hn>>>0){Ft=vt;break}Nt=Kn;do Dr=Cr(7,0,(14-Nt|0)*3|0)|0,Nt=Nt+1|0,Mt=Dr|Mt,vt=cn()|0|vt;while(Nt>>>0<Ft>>>0);Ft=vt}while(!1);for(Nt=Qs(Mt|0,Ft|0,_t|0,Tn|0)|0,cn()|0,vt=0;;){if((vt|0)>(_t|0)){Er=77;break t}if(Dr=$r+(Nt<<3)|0,Vt=xt[Dr+4>>2]|0,(Vt&-117440513|0)==(Ft|0)&&(xt[Dr>>2]|0)==(Mt|0)){Er=79;break}if(Nt=(Nt+1|0)%(_t|0)|0,Dr=$r+(Nt<<3)|0,(xt[Dr>>2]|0)==(Mt|0)&&(xt[Dr+4>>2]|0)==(Ft|0))break;vt=vt+1|0}if((Er|0)==79&&(Er=0,!0&(Vt&117440512|0)==100663296))break;Dr=yt+(Pt<<3)|0,xt[Dr>>2]=Qt,xt[Dr+4>>2]=Ct,Pt=Pt+1|0}while(!1);if(Ct=on+1|0,(Ct|0)>=(_t|0)){Ct=An;break n}Dr=Br+(Ct<<3)|0,on=Ct,Qt=xt[Dr>>2]|0,Ct=xt[Dr+4>>2]|0}}else Pt=0,Ct=An}else Pt=0,Ct=0;while(!1);if(Ol($r|0,0,kn|0)|0,Au(Br|0,Bn|0,Ct<<3|0)|0,Qr(Bn),Ct)yt=yt+(Pt<<3)|0,_t=Ct;else break e}if((Er|0)==17)!0&(Ct&117440512|0)==0?(Ct=4,Er=28):Er=22;else if((Er|0)==32)mr(23313,22674,362,22684);else{if((Er|0)==42)return Qr(Br),Qr($r),Dr=10,Dr|0;if((Er|0)==49)return Qr(Br),Qr($r),Dr=13,Dr|0;if((Er|0)==77)mr(23313,22674,462,22684);else{if((Er|0)==84)return Qr(Bn),Qr(Br),Qr($r),Dr=Ct,Dr|0;if((Er|0)==85){Au(yt|0,Br|0,_t<<3|0)|0;break}}}if((Er|0)==22)return Qr(Br),Qr($r),Dr=5,Dr|0;if((Er|0)==28)return Qr(Br),Qr($r),Dr=Ct,Dr|0}while(!1);return Qr(Br),Qr($r),Dr=0,Dr|0}function Ru(vt,yt,_t,Mt,Ct,Pt,Nt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0,Pt=Pt|0,Nt=Nt|0;var Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0;if(Bn=fn,fn=fn+16|0,bn=Bn,!((_t|0)>0|(_t|0)==0&yt>>>0>0))return bn=0,fn=Bn,bn|0;if((Nt|0)>=16)return bn=12,fn=Bn,bn|0;Tn=0,Pn=0,An=0,Ft=0;e:for(;;){if(Qt=vt+(Tn<<3)|0,Vt=xt[Qt>>2]|0,Qt=xt[Qt+4>>2]|0,on=_r(Vt|0,Qt|0,52)|0,cn()|0,(on&15|0)>(Nt|0)){Ft=12,Vt=11;break}if(Yu(bn,Vt,Qt,Nt),on=bn,Qt=xt[on>>2]|0,on=xt[on+4>>2]|0,(Qt|0)==0&(on|0)==0)Vt=An;else{Vt=An;do{if(!((Ft|0)<(Pt|0)|(Ft|0)==(Pt|0)&Vt>>>0<Ct>>>0)){Vt=10;break e}An=Mt+(Vt<<3)|0,xt[An>>2]=Qt,xt[An+4>>2]=on,Vt=ts(Vt|0,Ft|0,1,0)|0,Ft=cn()|0,Ql(bn),An=bn,Qt=xt[An>>2]|0,on=xt[An+4>>2]|0}while(!((Qt|0)==0&(on|0)==0))}if(Tn=ts(Tn|0,Pn|0,1,0)|0,Pn=cn()|0,(Pn|0)<(_t|0)|(Pn|0)==(_t|0)&Tn>>>0<yt>>>0)An=Vt;else{Ft=0,Vt=11;break}}return(Vt|0)==10?(bn=14,fn=Bn,bn|0):(Vt|0)==11?(fn=Bn,Ft|0):0}function zo(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0;Tn=fn,fn=fn+16|0,An=Tn;e:do if((_t|0)>0|(_t|0)==0&yt>>>0>0){for(Qt=0,Nt=0,Pt=0,on=0;;){if(Vt=vt+(Qt<<3)|0,Ft=xt[Vt>>2]|0,Vt=xt[Vt+4>>2]|0,!((Ft|0)==0&(Vt|0)==0)&&(Vt=(Cu(Ft,Vt,Mt,An)|0)==0,Ft=An,Nt=ts(xt[Ft>>2]|0,xt[Ft+4>>2]|0,Nt|0,Pt|0)|0,Pt=cn()|0,!Vt)){Pt=12;break}if(Qt=ts(Qt|0,on|0,1,0)|0,on=cn()|0,!((on|0)<(_t|0)|(on|0)==(_t|0)&Qt>>>0<yt>>>0))break e}return fn=Tn,Pt|0}else Nt=0,Pt=0;while(!1);return xt[Ct>>2]=Nt,xt[Ct+4>>2]=Pt,Ct=0,fn=Tn,Ct|0}function Lp(vt,yt){return vt=vt|0,yt=yt|0,yt=_r(vt|0,yt|0,52)|0,cn()|0,yt&1|0}function yo(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0;if(Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ct=Ct&15,!Ct)return Ct=0,Ct|0;for(Mt=1;;){if(_t=_r(vt|0,yt|0,(15-Mt|0)*3|0)|0,cn()|0,_t=_t&7,_t|0){Mt=5;break}if(Mt>>>0<Ct>>>0)Mt=Mt+1|0;else{_t=0,Mt=5;break}}return(Mt|0)==5?_t|0:0}function Pu(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;if(Vt=_r(vt|0,yt|0,52)|0,cn()|0,Vt=Vt&15,!Vt)return Ft=yt,Vt=vt,wr(Ft|0),Vt|0;for(Ft=1,_t=0;;){Pt=(15-Ft|0)*3|0,Mt=Cr(7,0,Pt|0)|0,Ct=cn()|0,Nt=_r(vt|0,yt|0,Pt|0)|0,cn()|0,Pt=Cr(Yo(Nt&7)|0,0,Pt|0)|0,Nt=cn()|0,vt=Pt|vt&~Mt,yt=Nt|yt&~Ct;e:do if(!_t)if((Pt&Mt|0)==0&(Nt&Ct|0)==0)_t=0;else if(Mt=_r(vt|0,yt|0,52)|0,cn()|0,Mt=Mt&15,!Mt)_t=1;else{_t=1;t:for(;;){switch(Nt=_r(vt|0,yt|0,(15-_t|0)*3|0)|0,cn()|0,Nt&7){case 1:break t;case 0:break;default:{_t=1;break e}}if(_t>>>0<Mt>>>0)_t=_t+1|0;else{_t=1;break e}}for(_t=1;;)if(Nt=(15-_t|0)*3|0,Ct=_r(vt|0,yt|0,Nt|0)|0,cn()|0,Pt=Cr(7,0,Nt|0)|0,yt=yt&~(cn()|0),Nt=Cr(Yo(Ct&7)|0,0,Nt|0)|0,vt=vt&~Pt|Nt,yt=yt|(cn()|0),_t>>>0<Mt>>>0)_t=_t+1|0;else{_t=1;break}}while(!1);if(Ft>>>0<Vt>>>0)Ft=Ft+1|0;else break}return wr(yt|0),vt|0}function Ml(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0;if(Mt=_r(vt|0,yt|0,52)|0,cn()|0,Mt=Mt&15,!Mt)return _t=yt,Mt=vt,wr(_t|0),Mt|0;for(_t=1;Pt=(15-_t|0)*3|0,Nt=_r(vt|0,yt|0,Pt|0)|0,cn()|0,Ct=Cr(7,0,Pt|0)|0,yt=yt&~(cn()|0),Pt=Cr(Yo(Nt&7)|0,0,Pt|0)|0,vt=Pt|vt&~Ct,yt=cn()|0|yt,_t>>>0<Mt>>>0;)_t=_t+1|0;return wr(yt|0),vt|0}function Ip(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;if(Vt=_r(vt|0,yt|0,52)|0,cn()|0,Vt=Vt&15,!Vt)return Ft=yt,Vt=vt,wr(Ft|0),Vt|0;for(Ft=1,_t=0;;){Pt=(15-Ft|0)*3|0,Mt=Cr(7,0,Pt|0)|0,Ct=cn()|0,Nt=_r(vt|0,yt|0,Pt|0)|0,cn()|0,Pt=Cr(Is(Nt&7)|0,0,Pt|0)|0,Nt=cn()|0,vt=Pt|vt&~Mt,yt=Nt|yt&~Ct;e:do if(!_t)if((Pt&Mt|0)==0&(Nt&Ct|0)==0)_t=0;else if(Mt=_r(vt|0,yt|0,52)|0,cn()|0,Mt=Mt&15,!Mt)_t=1;else{_t=1;t:for(;;){switch(Nt=_r(vt|0,yt|0,(15-_t|0)*3|0)|0,cn()|0,Nt&7){case 1:break t;case 0:break;default:{_t=1;break e}}if(_t>>>0<Mt>>>0)_t=_t+1|0;else{_t=1;break e}}for(_t=1;;)if(Ct=(15-_t|0)*3|0,Pt=Cr(7,0,Ct|0)|0,Nt=yt&~(cn()|0),yt=_r(vt|0,yt|0,Ct|0)|0,cn()|0,yt=Cr(Is(yt&7)|0,0,Ct|0)|0,vt=vt&~Pt|yt,yt=Nt|(cn()|0),_t>>>0<Mt>>>0)_t=_t+1|0;else{_t=1;break}}while(!1);if(Ft>>>0<Vt>>>0)Ft=Ft+1|0;else break}return wr(yt|0),vt|0}function Kl(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0;if(Mt=_r(vt|0,yt|0,52)|0,cn()|0,Mt=Mt&15,!Mt)return _t=yt,Mt=vt,wr(_t|0),Mt|0;for(_t=1;Nt=(15-_t|0)*3|0,Pt=Cr(7,0,Nt|0)|0,Ct=yt&~(cn()|0),yt=_r(vt|0,yt|0,Nt|0)|0,cn()|0,yt=Cr(Is(yt&7)|0,0,Nt|0)|0,vt=yt|vt&~Pt,yt=cn()|0|Ct,_t>>>0<Mt>>>0;)_t=_t+1|0;return wr(yt|0),vt|0}function ou(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(Vt=fn,fn=fn+64|0,Ft=Vt+40|0,Mt=Vt+24|0,Ct=Vt+12|0,Pt=Vt,Cr(yt|0,0,52)|0,_t=cn()|0|134225919,!yt)return(xt[vt+4>>2]|0)>2||(xt[vt+8>>2]|0)>2||(xt[vt+12>>2]|0)>2?(Nt=0,Ft=0,wr(Nt|0),fn=Vt,Ft|0):(Cr(eu(vt)|0,0,45)|0,Nt=cn()|0|_t,Ft=-1,wr(Nt|0),fn=Vt,Ft|0);if(xt[Ft>>2]=xt[vt>>2],xt[Ft+4>>2]=xt[vt+4>>2],xt[Ft+8>>2]=xt[vt+8>>2],xt[Ft+12>>2]=xt[vt+12>>2],Nt=Ft+4|0,(yt|0)>0)for(vt=-1;xt[Mt>>2]=xt[Nt>>2],xt[Mt+4>>2]=xt[Nt+4>>2],xt[Mt+8>>2]=xt[Nt+8>>2],yt&1?(zl(Nt),xt[Ct>>2]=xt[Nt>>2],xt[Ct+4>>2]=xt[Nt+4>>2],xt[Ct+8>>2]=xt[Nt+8>>2],Hs(Ct)):(ao(Nt),xt[Ct>>2]=xt[Nt>>2],xt[Ct+4>>2]=xt[Nt+4>>2],xt[Ct+8>>2]=xt[Nt+8>>2],Do(Ct)),Ul(Mt,Ct,Pt),_s(Pt),on=(15-yt|0)*3|0,Qt=Cr(7,0,on|0)|0,_t=_t&~(cn()|0),on=Cr(ro(Pt)|0,0,on|0)|0,vt=on|vt&~Qt,_t=cn()|0|_t,(yt|0)>1;)yt=yt+-1|0;else vt=-1;e:do if((xt[Nt>>2]|0)<=2&&(xt[Ft+8>>2]|0)<=2&&(xt[Ft+12>>2]|0)<=2){if(Mt=eu(Ft)|0,yt=Cr(Mt|0,0,45)|0,yt=yt|vt,vt=cn()|0|_t&-1040385,Pt=Al(Ft)|0,!(ps(Mt)|0)){if((Pt|0)<=0)break;for(Ct=0;;){if(Mt=_r(yt|0,vt|0,52)|0,cn()|0,Mt=Mt&15,Mt)for(_t=1;on=(15-_t|0)*3|0,Ft=_r(yt|0,vt|0,on|0)|0,cn()|0,Qt=Cr(7,0,on|0)|0,vt=vt&~(cn()|0),on=Cr(Yo(Ft&7)|0,0,on|0)|0,yt=yt&~Qt|on,vt=vt|(cn()|0),_t>>>0<Mt>>>0;)_t=_t+1|0;if(Ct=Ct+1|0,(Ct|0)==(Pt|0))break e}}Ct=_r(yt|0,vt|0,52)|0,cn()|0,Ct=Ct&15;t:do if(Ct){_t=1;n:for(;;){switch(on=_r(yt|0,vt|0,(15-_t|0)*3|0)|0,cn()|0,on&7){case 1:break n;case 0:break;default:break t}if(_t>>>0<Ct>>>0)_t=_t+1|0;else break t}if(Mu(Mt,xt[Ft>>2]|0)|0)for(_t=1;Ft=(15-_t|0)*3|0,Qt=Cr(7,0,Ft|0)|0,on=vt&~(cn()|0),vt=_r(yt|0,vt|0,Ft|0)|0,cn()|0,vt=Cr(Is(vt&7)|0,0,Ft|0)|0,yt=yt&~Qt|vt,vt=on|(cn()|0),_t>>>0<Ct>>>0;)_t=_t+1|0;else for(_t=1;on=(15-_t|0)*3|0,Ft=_r(yt|0,vt|0,on|0)|0,cn()|0,Qt=Cr(7,0,on|0)|0,vt=vt&~(cn()|0),on=Cr(Yo(Ft&7)|0,0,on|0)|0,yt=yt&~Qt|on,vt=vt|(cn()|0),_t>>>0<Ct>>>0;)_t=_t+1|0}while(!1);if((Pt|0)>0){_t=0;do yt=Pu(yt,vt)|0,vt=cn()|0,_t=_t+1|0;while((_t|0)!=(Pt|0))}}else yt=0,vt=0;while(!1);return Qt=vt,on=yt,wr(Qt|0),fn=Vt,on|0}function bo(vt){return vt=vt|0,(vt|0)%2|0|0}function au(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0;return Ct=fn,fn=fn+16|0,Mt=Ct,yt>>>0>15?(Mt=4,fn=Ct,Mt|0):(xt[vt+4>>2]&2146435072|0)==2146435072||(xt[vt+8+4>>2]&2146435072|0)==2146435072?(Mt=3,fn=Ct,Mt|0):(Ku(vt,yt,Mt),yt=ou(Mt,yt)|0,Mt=cn()|0,xt[_t>>2]=yt,xt[_t+4>>2]=Mt,(yt|0)==0&(Mt|0)==0&&mr(23313,22674,786,22697),Mt=0,fn=Ct,Mt|0)}function lu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0;if(Ct=_t+4|0,Pt=_r(vt|0,yt|0,52)|0,cn()|0,Pt=Pt&15,Nt=_r(vt|0,yt|0,45)|0,cn()|0,Mt=(Pt|0)==0,ps(Nt&127)|0){if(Mt)return Nt=1,Nt|0;Mt=1}else{if(Mt)return Nt=0,Nt|0;!(xt[Ct>>2]|0)&&!(xt[_t+8>>2]|0)?Mt=(xt[_t+12>>2]|0)!=0&1:Mt=1}for(_t=1;_t&1?Hs(Ct):Do(Ct),Nt=_r(vt|0,yt|0,(15-_t|0)*3|0)|0,cn()|0,$o(Ct,Nt&7),_t>>>0<Pt>>>0;)_t=_t+1|0;return Mt|0}function Xl(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(on=fn,fn=fn+16|0,Vt=on,Qt=_r(vt|0,yt|0,45)|0,cn()|0,Qt=Qt&127,Qt>>>0>121)return xt[_t>>2]=0,xt[_t+4>>2]=0,xt[_t+8>>2]=0,xt[_t+12>>2]=0,Qt=5,fn=on,Qt|0;e:do if(ps(Qt)|0&&(Pt=_r(vt|0,yt|0,52)|0,cn()|0,Pt=Pt&15,(Pt|0)!=0)){Mt=1;t:for(;;){switch(Ft=_r(vt|0,yt|0,(15-Mt|0)*3|0)|0,cn()|0,Ft&7){case 5:break t;case 0:break;default:{Mt=yt;break e}}if(Mt>>>0<Pt>>>0)Mt=Mt+1|0;else{Mt=yt;break e}}for(Ct=1,Mt=yt;yt=(15-Ct|0)*3|0,Nt=Cr(7,0,yt|0)|0,Ft=Mt&~(cn()|0),Mt=_r(vt|0,Mt|0,yt|0)|0,cn()|0,Mt=Cr(Is(Mt&7)|0,0,yt|0)|0,vt=vt&~Nt|Mt,Mt=Ft|(cn()|0),Ct>>>0<Pt>>>0;)Ct=Ct+1|0}else Mt=yt;while(!1);if(Ft=7696+(Qt*28|0)|0,xt[_t>>2]=xt[Ft>>2],xt[_t+4>>2]=xt[Ft+4>>2],xt[_t+8>>2]=xt[Ft+8>>2],xt[_t+12>>2]=xt[Ft+12>>2],!(lu(vt,Mt,_t)|0))return Qt=0,fn=on,Qt|0;if(Nt=_t+4|0,xt[Vt>>2]=xt[Nt>>2],xt[Vt+4>>2]=xt[Nt+4>>2],xt[Vt+8>>2]=xt[Nt+8>>2],Pt=_r(vt|0,Mt|0,52)|0,cn()|0,Ft=Pt&15,Pt&1?(Do(Nt),Pt=Ft+1|0):Pt=Ft,!(ps(Qt)|0))Mt=0;else{e:do if(!Ft)Mt=0;else for(yt=1;;){if(Ct=_r(vt|0,Mt|0,(15-yt|0)*3|0)|0,cn()|0,Ct=Ct&7,Ct|0){Mt=Ct;break e}if(yt>>>0<Ft>>>0)yt=yt+1|0;else{Mt=0;break}}while(!1);Mt=(Mt|0)==4&1}if(!(Tl(_t,Pt,Mt,0)|0))(Pt|0)!=(Ft|0)&&(xt[Nt>>2]=xt[Vt>>2],xt[Nt+4>>2]=xt[Vt+4>>2],xt[Nt+8>>2]=xt[Vt+8>>2]);else{if(ps(Qt)|0)do;while(Tl(_t,Pt,0,0)|0);(Pt|0)!=(Ft|0)&&ao(Nt)}return Qt=0,fn=on,Qt|0}function cu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;return Pt=fn,fn=fn+16|0,Mt=Pt,Ct=Xl(vt,yt,Mt)|0,Ct|0?(fn=Pt,Ct|0):(Ct=_r(vt|0,yt|0,52)|0,cn()|0,lp(Mt,Ct&15,_t),Ct=0,fn=Pt,Ct|0)}function Jo(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;if(Nt=fn,fn=fn+16|0,Pt=Nt,Mt=Xl(vt,yt,Pt)|0,Mt|0)return Pt=Mt,fn=Nt,Pt|0;Mt=_r(vt|0,yt|0,45)|0,cn()|0,Mt=(ps(Mt&127)|0)==0,Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ct=Ct&15;e:do if(!Mt){if(Ct|0)for(Mt=1;;){if(Ft=Cr(7,0,(15-Mt|0)*3|0)|0,!((Ft&vt|0)==0&((cn()|0)&yt|0)==0))break e;if(Mt>>>0<Ct>>>0)Mt=Mt+1|0;else break}return Nl(Pt,Ct,0,5,_t),Ft=0,fn=Nt,Ft|0}while(!1);return _o(Pt,Ct,0,6,_t),Ft=0,fn=Nt,Ft|0}function Dp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;if(Ct=_r(vt|0,yt|0,45)|0,cn()|0,!(ps(Ct&127)|0))return Ct=2,xt[_t>>2]=Ct,0;if(Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ct=Ct&15,!Ct)return Ct=5,xt[_t>>2]=Ct,0;for(Mt=1;;){if(Pt=Cr(7,0,(15-Mt|0)*3|0)|0,!((Pt&vt|0)==0&((cn()|0)&yt|0)==0)){Mt=2,vt=6;break}if(Mt>>>0<Ct>>>0)Mt=Mt+1|0;else{Mt=5,vt=6;break}}return(vt|0)==6&&(xt[_t>>2]=Mt),0}function uu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0;An=fn,fn=fn+128|0,Qt=An+112|0,Pt=An+96|0,on=An,Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ft=Ct&15,xt[Qt>>2]=Ft,Nt=_r(vt|0,yt|0,45)|0,cn()|0,Nt=Nt&127;e:do if(ps(Nt)|0){if(Ft|0)for(Mt=1;;){if(Vt=Cr(7,0,(15-Mt|0)*3|0)|0,!((Vt&vt|0)==0&((cn()|0)&yt|0)==0)){Ct=0;break e}if(Mt>>>0<Ft>>>0)Mt=Mt+1|0;else break}if(Ct&1)Ct=1;else return Vt=Cr(Ft+1|0,0,52)|0,on=cn()|0|yt&-15728641,Qt=Cr(7,0,(14-Ft|0)*3|0)|0,on=uu((Vt|vt)&~Qt,on&~(cn()|0),_t)|0,fn=An,on|0}else Ct=0;while(!1);if(Mt=Xl(vt,yt,Pt)|0,!Mt){Ct?(Hl(Pt,Qt,on),Vt=5):(wo(Pt,Qt,on),Vt=6);e:do if(ps(Nt)|0)if(!Ft)vt=5;else for(Mt=1;;){if(Nt=Cr(7,0,(15-Mt|0)*3|0)|0,!((Nt&vt|0)==0&((cn()|0)&yt|0)==0)){vt=2;break e}if(Mt>>>0<Ft>>>0)Mt=Mt+1|0;else{vt=5;break}}else vt=2;while(!1);Ol(_t|0,-1,vt<<2|0)|0;e:do if(Ct)for(Pt=0;;){if(Nt=on+(Pt<<4)|0,Xu(Nt,xt[Qt>>2]|0)|0,Nt=xt[Nt>>2]|0,Ft=xt[_t>>2]|0,(Ft|0)==-1|(Ft|0)==(Nt|0))Mt=_t;else{Ct=0;do{if(Ct=Ct+1|0,Ct>>>0>=vt>>>0){Mt=1;break e}Mt=_t+(Ct<<2)|0,Ft=xt[Mt>>2]|0}while(!((Ft|0)==-1|(Ft|0)==(Nt|0)))}if(xt[Mt>>2]=Nt,Pt=Pt+1|0,Pt>>>0>=Vt>>>0){Mt=0;break}}else for(Pt=0;;){if(Nt=on+(Pt<<4)|0,Tl(Nt,xt[Qt>>2]|0,0,1)|0,Nt=xt[Nt>>2]|0,Ft=xt[_t>>2]|0,(Ft|0)==-1|(Ft|0)==(Nt|0))Mt=_t;else{Ct=0;do{if(Ct=Ct+1|0,Ct>>>0>=vt>>>0){Mt=1;break e}Mt=_t+(Ct<<2)|0,Ft=xt[Mt>>2]|0}while(!((Ft|0)==-1|(Ft|0)==(Nt|0)))}if(xt[Mt>>2]=Nt,Pt=Pt+1|0,Pt>>>0>=Vt>>>0){Mt=0;break}}while(!1)}return on=Mt,fn=An,on|0}function No(){return 12}function Yl(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;if(vt>>>0>15)return Ft=4,Ft|0;if(Cr(vt|0,0,52)|0,Ft=cn()|0|134225919,!vt){_t=0,Mt=0;do ps(Mt)|0&&(Cr(Mt|0,0,45)|0,Nt=Ft|(cn()|0),vt=yt+(_t<<3)|0,xt[vt>>2]=-1,xt[vt+4>>2]=Nt,_t=_t+1|0),Mt=Mt+1|0;while((Mt|0)!=122);return _t=0,_t|0}_t=0,Nt=0;do{if(ps(Nt)|0){for(Cr(Nt|0,0,45)|0,Mt=1,Ct=-1,Pt=Ft|(cn()|0);Vt=Cr(7,0,(15-Mt|0)*3|0)|0,Ct=Ct&~Vt,Pt=Pt&~(cn()|0),(Mt|0)!=(vt|0);)Mt=Mt+1|0;Vt=yt+(_t<<3)|0,xt[Vt>>2]=Ct,xt[Vt+4>>2]=Pt,_t=_t+1|0}Nt=Nt+1|0}while((Nt|0)!=122);return _t=0,_t|0}function hu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0;if(Hn=fn,fn=fn+16|0,ur=Hn,Ln=_r(vt|0,yt|0,52)|0,cn()|0,Ln=Ln&15,_t>>>0>15)return Ln=4,fn=Hn,Ln|0;if((Ln|0)<(_t|0))return Ln=12,fn=Hn,Ln|0;if((Ln|0)!=(_t|0))if(Pt=Cr(_t|0,0,52)|0,Pt=Pt|vt,Ft=cn()|0|yt&-15728641,(Ln|0)>(_t|0)){Vt=_t;do Bn=Cr(7,0,(14-Vt|0)*3|0)|0,Vt=Vt+1|0,Pt=Bn|Pt,Ft=cn()|0|Ft;while((Vt|0)<(Ln|0));Bn=Pt}else Bn=Pt;else Bn=vt,Ft=yt;bn=_r(Bn|0,Ft|0,45)|0,cn()|0;e:do if(ps(bn&127)|0){if(Vt=_r(Bn|0,Ft|0,52)|0,cn()|0,Vt=Vt&15,Vt|0)for(Pt=1;;){if(bn=Cr(7,0,(15-Pt|0)*3|0)|0,!((bn&Bn|0)==0&((cn()|0)&Ft|0)==0)){Qt=33;break e}if(Pt>>>0<Vt>>>0)Pt=Pt+1|0;else break}if(bn=Mt,xt[bn>>2]=0,xt[bn+4>>2]=0,(Ln|0)>(_t|0)){for(bn=yt&-15728641,Pn=Ln;;){if(Tn=Pn,Pn=Pn+-1|0,Pn>>>0>15|(Ln|0)<(Pn|0)){Qt=19;break}if((Ln|0)!=(Pn|0))if(Pt=Cr(Pn|0,0,52)|0,Pt=Pt|vt,Vt=cn()|0|bn,(Ln|0)<(Tn|0))An=Pt;else{Qt=Pn;do An=Cr(7,0,(14-Qt|0)*3|0)|0,Qt=Qt+1|0,Pt=An|Pt,Vt=cn()|0|Vt;while((Qt|0)<(Ln|0));An=Pt}else An=vt,Vt=yt;if(on=_r(An|0,Vt|0,45)|0,cn()|0,!(ps(on&127)|0))Pt=0;else{on=_r(An|0,Vt|0,52)|0,cn()|0,on=on&15;t:do if(!on)Pt=0;else for(Qt=1;;){if(Pt=_r(An|0,Vt|0,(15-Qt|0)*3|0)|0,cn()|0,Pt=Pt&7,Pt|0)break t;if(Qt>>>0<on>>>0)Qt=Qt+1|0;else{Pt=0;break}}while(!1);Pt=(Pt|0)==0&1}if(Vt=_r(vt|0,yt|0,(15-Tn|0)*3|0)|0,cn()|0,Vt=Vt&7,(Vt|0)==7){Ct=5,Qt=42;break}if(Pt=(Pt|0)!=0,(Vt|0)==1&Pt){Ct=5,Qt=42;break}if(An=Vt+(((Vt|0)!=0&Pt)<<31>>31)|0,An|0&&(Qt=Ln-Tn|0,Qt=na(7,0,Qt,((Qt|0)<0)<<31>>31)|0,on=cn()|0,Pt?(Pt=fo(Qt|0,on|0,5,0)|0,Pt=ts(Pt|0,cn()|0,-5,-1)|0,Pt=jo(Pt|0,cn()|0,6,0)|0,Pt=ts(Pt|0,cn()|0,1,0)|0,Vt=cn()|0):(Pt=Qt,Vt=on),Tn=An+-1|0,Tn=fo(Qt|0,on|0,Tn|0,((Tn|0)<0)<<31>>31|0)|0,Tn=ts(Pt|0,Vt|0,Tn|0,cn()|0)|0,An=cn()|0,on=Mt,on=ts(Tn|0,An|0,xt[on>>2]|0,xt[on+4>>2]|0)|0,An=cn()|0,Tn=Mt,xt[Tn>>2]=on,xt[Tn+4>>2]=An),(Pn|0)<=(_t|0)){Qt=37;break}}if((Qt|0)==19)mr(23313,22674,1099,22710);else if((Qt|0)==37){Nt=Mt,Ct=xt[Nt+4>>2]|0,Nt=xt[Nt>>2]|0;break}else if((Qt|0)==42)return fn=Hn,Ct|0}else Ct=0,Nt=0}else Qt=33;while(!1);e:do if((Qt|0)==33)if(bn=Mt,xt[bn>>2]=0,xt[bn+4>>2]=0,(Ln|0)>(_t|0)){for(Pt=Ln;;){if(Ct=_r(vt|0,yt|0,(15-Pt|0)*3|0)|0,cn()|0,Ct=Ct&7,(Ct|0)==7){Ct=5;break}if(Nt=Ln-Pt|0,Nt=na(7,0,Nt,((Nt|0)<0)<<31>>31)|0,Ct=fo(Nt|0,cn()|0,Ct|0,0)|0,Nt=cn()|0,bn=Mt,Nt=ts(xt[bn>>2]|0,xt[bn+4>>2]|0,Ct|0,Nt|0)|0,Ct=cn()|0,bn=Mt,xt[bn>>2]=Nt,xt[bn+4>>2]=Ct,Pt=Pt+-1|0,(Pt|0)<=(_t|0))break e}return fn=Hn,Ct|0}else Ct=0,Nt=0;while(!1);return Cu(Bn,Ft,Ln,ur)|0&&mr(23313,22674,1063,22725),Ln=ur,ur=xt[Ln+4>>2]|0,((Ct|0)>-1|(Ct|0)==-1&Nt>>>0>4294967295)&((ur|0)>(Ct|0)|((ur|0)==(Ct|0)?(xt[Ln>>2]|0)>>>0>Nt>>>0:0))?(Ln=0,fn=Hn,Ln|0):(mr(23313,22674,1139,22710),0)}function Zo(vt,yt,_t,Mt,Ct,Pt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0,Pt=Pt|0;var Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0;if(An=fn,fn=fn+16|0,Nt=An,Ct>>>0>15)return Pt=4,fn=An,Pt|0;if(Ft=_r(_t|0,Mt|0,52)|0,cn()|0,Ft=Ft&15,(Ft|0)>(Ct|0))return Pt=12,fn=An,Pt|0;if(Cu(_t,Mt,Ct,Nt)|0&&mr(23313,22674,1063,22725),on=Nt,Qt=xt[on+4>>2]|0,!(((yt|0)>-1|(yt|0)==-1&vt>>>0>4294967295)&((Qt|0)>(yt|0)|((Qt|0)==(yt|0)?(xt[on>>2]|0)>>>0>vt>>>0:0))))return Pt=2,fn=An,Pt|0;on=Ct-Ft|0,Ct=Cr(Ct|0,0,52)|0,Vt=cn()|0|Mt&-15728641,Qt=Pt,xt[Qt>>2]=Ct|_t,xt[Qt+4>>2]=Vt,Qt=_r(_t|0,Mt|0,45)|0,cn()|0;e:do if(ps(Qt&127)|0){if(Ft|0)for(Nt=1;;){if(Qt=Cr(7,0,(15-Nt|0)*3|0)|0,!((Qt&_t|0)==0&((cn()|0)&Mt|0)==0))break e;if(Nt>>>0<Ft>>>0)Nt=Nt+1|0;else break}if((on|0)<1)return Pt=0,fn=An,Pt|0;for(Qt=Ft^15,Mt=-1,Vt=1,Nt=1;;){Ft=on-Vt|0,Ft=na(7,0,Ft,((Ft|0)<0)<<31>>31)|0,_t=cn()|0;do if(Nt)if(Nt=fo(Ft|0,_t|0,5,0)|0,Nt=ts(Nt|0,cn()|0,-5,-1)|0,Nt=jo(Nt|0,cn()|0,6,0)|0,Ct=cn()|0,(yt|0)>(Ct|0)|(yt|0)==(Ct|0)&vt>>>0>Nt>>>0){yt=ts(vt|0,yt|0,-1,-1)|0,yt=Xs(yt|0,cn()|0,Nt|0,Ct|0)|0,Nt=cn()|0,Tn=Pt,bn=xt[Tn>>2]|0,Tn=xt[Tn+4>>2]|0,Bn=(Qt+Mt|0)*3|0,Pn=Cr(7,0,Bn|0)|0,Tn=Tn&~(cn()|0),Mt=jo(yt|0,Nt|0,Ft|0,_t|0)|0,vt=cn()|0,Ct=ts(Mt|0,vt|0,2,0)|0,Bn=Cr(Ct|0,cn()|0,Bn|0)|0,Tn=cn()|0|Tn,Ct=Pt,xt[Ct>>2]=Bn|bn&~Pn,xt[Ct+4>>2]=Tn,vt=fo(Mt|0,vt|0,Ft|0,_t|0)|0,vt=Xs(yt|0,Nt|0,vt|0,cn()|0)|0,Nt=0,yt=cn()|0;break}else{Bn=Pt,Pn=xt[Bn>>2]|0,Bn=xt[Bn+4>>2]|0,bn=Cr(7,0,(Qt+Mt|0)*3|0)|0,Bn=Bn&~(cn()|0),Nt=Pt,xt[Nt>>2]=Pn&~bn,xt[Nt+4>>2]=Bn,Nt=1;break}else Pn=Pt,Ct=xt[Pn>>2]|0,Pn=xt[Pn+4>>2]|0,Mt=(Qt+Mt|0)*3|0,Tn=Cr(7,0,Mt|0)|0,Pn=Pn&~(cn()|0),Bn=jo(vt|0,yt|0,Ft|0,_t|0)|0,Nt=cn()|0,Mt=Cr(Bn|0,Nt|0,Mt|0)|0,Pn=cn()|0|Pn,bn=Pt,xt[bn>>2]=Mt|Ct&~Tn,xt[bn+4>>2]=Pn,Nt=fo(Bn|0,Nt|0,Ft|0,_t|0)|0,vt=Xs(vt|0,yt|0,Nt|0,cn()|0)|0,Nt=0,yt=cn()|0;while(!1);if((on|0)>(Vt|0))Mt=~Vt,Vt=Vt+1|0;else{yt=0;break}}return fn=An,yt|0}while(!1);if((on|0)<1)return Bn=0,fn=An,Bn|0;for(Ct=Ft^15,Nt=1;;)if(bn=on-Nt|0,bn=na(7,0,bn,((bn|0)<0)<<31>>31)|0,Bn=cn()|0,Vt=Pt,_t=xt[Vt>>2]|0,Vt=xt[Vt+4>>2]|0,Ft=(Ct-Nt|0)*3|0,Mt=Cr(7,0,Ft|0)|0,Vt=Vt&~(cn()|0),Tn=jo(vt|0,yt|0,bn|0,Bn|0)|0,Pn=cn()|0,Ft=Cr(Tn|0,Pn|0,Ft|0)|0,Vt=cn()|0|Vt,Qt=Pt,xt[Qt>>2]=Ft|_t&~Mt,xt[Qt+4>>2]=Vt,Bn=fo(Tn|0,Pn|0,bn|0,Bn|0)|0,vt=Xs(vt|0,yt|0,Bn|0,cn()|0)|0,yt=cn()|0,(on|0)<=(Nt|0)){yt=0;break}else Nt=Nt+1|0;return fn=An,yt|0}function Yu(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0;Ct=_r(yt|0,_t|0,52)|0,cn()|0,Ct=Ct&15,(yt|0)==0&(_t|0)==0|((Mt|0)>15|(Ct|0)>(Mt|0))?(Mt=-1,Ct=-1,yt=0,_t=0):(Pt=Co(yt,_t,Ct+1|0,Mt)|0,_t=(cn()|0)&-15728641,yt=Cr(Mt|0,0,52)|0,yt=Pt|yt,_t=_t|(cn()|0),Pt=(Es(yt,_t)|0)==0,Mt=Pt?-1:Mt),Pt=vt,xt[Pt>>2]=yt,xt[Pt+4>>2]=_t,xt[vt+8>>2]=Ct,xt[vt+12>>2]=Mt}function Ql(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;if(_t=vt,yt=xt[_t>>2]|0,_t=xt[_t+4>>2]|0,!((yt|0)==0&(_t|0)==0)&&(Mt=_r(yt|0,_t|0,52)|0,cn()|0,Mt=Mt&15,Ft=Cr(1,0,(Mt^15)*3|0)|0,yt=ts(Ft|0,cn()|0,yt|0,_t|0)|0,_t=cn()|0,Ft=vt,xt[Ft>>2]=yt,xt[Ft+4>>2]=_t,Ft=vt+8|0,Nt=xt[Ft>>2]|0,!((Mt|0)<(Nt|0)))){for(Vt=vt+12|0,Pt=Mt;;){if((Pt|0)==(Nt|0)){Mt=5;break}if(Qt=(Pt|0)==(xt[Vt>>2]|0),Ct=(15-Pt|0)*3|0,Mt=_r(yt|0,_t|0,Ct|0)|0,cn()|0,Mt=Mt&7,Qt&((Mt|0)==1&!0)){Mt=7;break}if(!((Mt|0)==7&!0)){Mt=10;break}if(Qt=Cr(1,0,Ct|0)|0,yt=ts(yt|0,_t|0,Qt|0,cn()|0)|0,_t=cn()|0,Qt=vt,xt[Qt>>2]=yt,xt[Qt+4>>2]=_t,(Pt|0)>(Nt|0))Pt=Pt+-1|0;else{Mt=10;break}}if((Mt|0)==5){Qt=vt,xt[Qt>>2]=0,xt[Qt+4>>2]=0,xt[Ft>>2]=-1,xt[Vt>>2]=-1;return}else if((Mt|0)==7){Nt=Cr(1,0,Ct|0)|0,Nt=ts(yt|0,_t|0,Nt|0,cn()|0)|0,Ft=cn()|0,Qt=vt,xt[Qt>>2]=Nt,xt[Qt+4>>2]=Ft,xt[Vt>>2]=Pt+-1;return}else if((Mt|0)==10)return}}function du(vt){vt=+vt;var yt=0;return yt=vt<0?vt+6.283185307179586:vt,+(vt>=6.283185307179586?yt+-6.283185307179586:yt)}function Bl(vt,yt){return vt=vt|0,yt=yt|0,+ln(+(+mn[vt>>3]-+mn[yt>>3]))<17453292519943298e-27?(yt=+ln(+(+mn[vt+8>>3]-+mn[yt+8>>3]))<17453292519943298e-27,yt|0):(yt=0,yt|0)}function Os(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0;return Ct=+mn[yt>>3],Mt=+mn[vt>>3],Pt=+Cn(+((Ct-Mt)*.5)),_t=+Cn(+((+mn[yt+8>>3]-+mn[vt+8>>3])*.5)),_t=Pt*Pt+_t*(+Un(+Ct)*+Un(+Mt)*_t),+(+Gr(+ +Rn(+_t),+ +Rn(+(1-_t)))*2)}function Fl(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0;return Ct=+mn[yt>>3],Mt=+mn[vt>>3],Pt=+Cn(+((Ct-Mt)*.5)),_t=+Cn(+((+mn[yt+8>>3]-+mn[vt+8>>3])*.5)),_t=Pt*Pt+_t*(+Un(+Ct)*+Un(+Mt)*_t),+(+Gr(+ +Rn(+_t),+ +Rn(+(1-_t)))*2*6371.007180918475)}function up(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0;return Ct=+mn[yt>>3],Mt=+mn[vt>>3],Pt=+Cn(+((Ct-Mt)*.5)),_t=+Cn(+((+mn[yt+8>>3]-+mn[vt+8>>3])*.5)),_t=Pt*Pt+_t*(+Un(+Ct)*+Un(+Mt)*_t),+(+Gr(+ +Rn(+_t),+ +Rn(+(1-_t)))*2*6371.007180918475*1e3)}function hp(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0;return Pt=+mn[yt>>3],Mt=+Un(+Pt),Ct=+mn[yt+8>>3]-+mn[vt+8>>3],Nt=Mt*+Cn(+Ct),_t=+mn[vt>>3],+ +Gr(+Nt,+(+Cn(+Pt)*+Un(+_t)-+Un(+Ct)*(Mt*+Cn(+_t))))}function Qu(vt,yt,_t,Mt){vt=vt|0,yt=+yt,_t=+_t,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0;if(_t<1e-16){xt[Mt>>2]=xt[vt>>2],xt[Mt+4>>2]=xt[vt+4>>2],xt[Mt+8>>2]=xt[vt+8>>2],xt[Mt+12>>2]=xt[vt+12>>2];return}Pt=yt<0?yt+6.283185307179586:yt,Pt=yt>=6.283185307179586?Pt+-6.283185307179586:Pt;do if(Pt<1e-16)yt=+mn[vt>>3]+_t,mn[Mt>>3]=yt,Ct=Mt;else{if(Ct=+ln(+(Pt+-3.141592653589793))<1e-16,yt=+mn[vt>>3],Ct){yt=yt-_t,mn[Mt>>3]=yt,Ct=Mt;break}if(Nt=+Un(+_t),_t=+Cn(+_t),yt=Nt*+Cn(+yt)+ +Un(+Pt)*(_t*+Un(+yt)),yt=yt>1?1:yt,yt=+fr(+(yt<-1?-1:yt)),mn[Mt>>3]=yt,+ln(+(yt+-1.5707963267948966))<1e-16){mn[Mt>>3]=1.5707963267948966,mn[Mt+8>>3]=0;return}if(+ln(+(yt+1.5707963267948966))<1e-16){mn[Mt>>3]=-1.5707963267948966,mn[Mt+8>>3]=0;return}if(Ft=+Un(+yt),Pt=_t*+Cn(+Pt)/Ft,_t=+mn[vt>>3],yt=(Nt-+Cn(+yt)*+Cn(+_t))/+Un(+_t)/Ft,Nt=Pt>1?1:Pt,yt=yt>1?1:yt,yt=+mn[vt+8>>3]+ +Gr(+(Nt<-1?-1:Nt),+(yt<-1?-1:yt)),yt>3.141592653589793)do yt=yt+-6.283185307179586;while(yt>3.141592653589793);if(yt<-3.141592653589793)do yt=yt+6.283185307179586;while(yt<-3.141592653589793);mn[Mt+8>>3]=yt;return}while(!1);if(+ln(+(yt+-1.5707963267948966))<1e-16){mn[Ct>>3]=1.5707963267948966,mn[Mt+8>>3]=0;return}if(+ln(+(yt+1.5707963267948966))<1e-16){mn[Ct>>3]=-1.5707963267948966,mn[Mt+8>>3]=0;return}if(yt=+mn[vt+8>>3],yt>3.141592653589793)do yt=yt+-6.283185307179586;while(yt>3.141592653589793);if(yt<-3.141592653589793)do yt=yt+6.283185307179586;while(yt<-3.141592653589793);mn[Mt+8>>3]=yt}function Bo(vt,yt){return vt=vt|0,yt=yt|0,vt>>>0>15?(yt=4,yt|0):(mn[yt>>3]=+mn[20528+(vt<<3)>>3],yt=0,yt|0)}function fu(vt,yt){return vt=vt|0,yt=yt|0,vt>>>0>15?(yt=4,yt|0):(mn[yt>>3]=+mn[20656+(vt<<3)>>3],yt=0,yt|0)}function zs(vt,yt){return vt=vt|0,yt=yt|0,vt>>>0>15?(yt=4,yt|0):(mn[yt>>3]=+mn[20784+(vt<<3)>>3],yt=0,yt|0)}function co(vt,yt){return vt=vt|0,yt=yt|0,vt>>>0>15?(yt=4,yt|0):(mn[yt>>3]=+mn[20912+(vt<<3)>>3],yt=0,yt|0)}function js(vt,yt){vt=vt|0,yt=yt|0;var _t=0;return vt>>>0>15?(yt=4,yt|0):(_t=na(7,0,vt,((vt|0)<0)<<31>>31)|0,_t=fo(_t|0,cn()|0,120,0)|0,vt=cn()|0,xt[yt>>2]=_t|2,xt[yt+4>>2]=vt,yt=0,yt|0)}function Lu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0;return Tn=+mn[yt>>3],on=+mn[vt>>3],Vt=+Cn(+((Tn-on)*.5)),Pt=+mn[yt+8>>3],Qt=+mn[vt+8>>3],Nt=+Cn(+((Pt-Qt)*.5)),Ft=+Un(+on),An=+Un(+Tn),Nt=Vt*Vt+Nt*(An*Ft*Nt),Nt=+Gr(+ +Rn(+Nt),+ +Rn(+(1-Nt)))*2,Vt=+mn[_t>>3],Tn=+Cn(+((Vt-Tn)*.5)),Mt=+mn[_t+8>>3],Pt=+Cn(+((Mt-Pt)*.5)),Ct=+Un(+Vt),Pt=Tn*Tn+Pt*(An*Ct*Pt),Pt=+Gr(+ +Rn(+Pt),+ +Rn(+(1-Pt)))*2,Vt=+Cn(+((on-Vt)*.5)),Mt=+Cn(+((Qt-Mt)*.5)),Mt=Vt*Vt+Mt*(Ft*Ct*Mt),Mt=+Gr(+ +Rn(+Mt),+ +Rn(+(1-Mt)))*2,Ct=(Nt+Pt+Mt)*.5,+(+Fr(+ +Rn(+(+xr(+(Ct*.5))*+xr(+((Ct-Nt)*.5))*+xr(+((Ct-Pt)*.5))*+xr(+((Ct-Mt)*.5)))))*4)}function Jl(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;if(Ft=fn,fn=fn+192|0,Pt=Ft+168|0,Nt=Ft,Ct=cu(vt,yt,Pt)|0,Ct|0)return _t=Ct,fn=Ft,_t|0;if(Jo(vt,yt,Nt)|0&&mr(23313,22742,386,22751),yt=xt[Nt>>2]|0,(yt|0)>0){if(Mt=+Lu(Nt+8|0,Nt+8+(((yt|0)!=1&1)<<4)|0,Pt)+0,(yt|0)!=1){vt=1;do Ct=vt,vt=vt+1|0,Mt=Mt+ +Lu(Nt+8+(Ct<<4)|0,Nt+8+(((vt|0)%(yt|0)|0)<<4)|0,Pt);while((vt|0)<(yt|0))}}else Mt=0;return mn[_t>>3]=Mt,_t=0,fn=Ft,_t|0}function Iu(vt,yt,_t){return vt=vt|0,yt=yt|0,_t=_t|0,vt=Jl(vt,yt,_t)|0,vt|0||(mn[_t>>3]=+mn[_t>>3]*6371.007180918475*6371.007180918475),vt|0}function ym(vt,yt,_t){return vt=vt|0,yt=yt|0,_t=_t|0,vt=Jl(vt,yt,_t)|0,vt|0||(mn[_t>>3]=+mn[_t>>3]*6371.007180918475*6371.007180918475*1e3*1e3),vt|0}function uo(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(Ft=fn,fn=fn+176|0,Nt=Ft,vt=iu(vt,yt,Nt)|0,vt|0)return Nt=vt,fn=Ft,Nt|0;if(mn[_t>>3]=0,vt=xt[Nt>>2]|0,(vt|0)<=1)return Nt=0,fn=Ft,Nt|0;yt=vt+-1|0,vt=0,Mt=+mn[Nt+8>>3],Ct=+mn[Nt+16>>3],Pt=0;do vt=vt+1|0,Qt=Mt,Mt=+mn[Nt+8+(vt<<4)>>3],on=+Cn(+((Mt-Qt)*.5)),Vt=Ct,Ct=+mn[Nt+8+(vt<<4)+8>>3],Vt=+Cn(+((Ct-Vt)*.5)),Vt=on*on+Vt*(+Un(+Mt)*+Un(+Qt)*Vt),Pt=Pt+ +Gr(+ +Rn(+Vt),+ +Rn(+(1-Vt)))*2;while((vt|0)<(yt|0));return mn[_t>>3]=Pt,Nt=0,fn=Ft,Nt|0}function dp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(Ft=fn,fn=fn+176|0,Nt=Ft,vt=iu(vt,yt,Nt)|0,vt|0)return Nt=vt,Pt=+mn[_t>>3],Pt=Pt*6371.007180918475,mn[_t>>3]=Pt,fn=Ft,Nt|0;if(mn[_t>>3]=0,vt=xt[Nt>>2]|0,(vt|0)<=1)return Nt=0,Pt=0,Pt=Pt*6371.007180918475,mn[_t>>3]=Pt,fn=Ft,Nt|0;yt=vt+-1|0,vt=0,Mt=+mn[Nt+8>>3],Ct=+mn[Nt+16>>3],Pt=0;do vt=vt+1|0,Qt=Mt,Mt=+mn[Nt+8+(vt<<4)>>3],on=+Cn(+((Mt-Qt)*.5)),Vt=Ct,Ct=+mn[Nt+8+(vt<<4)+8>>3],Vt=+Cn(+((Ct-Vt)*.5)),Vt=on*on+Vt*(+Un(+Qt)*+Un(+Mt)*Vt),Pt=Pt+ +Gr(+ +Rn(+Vt),+ +Rn(+(1-Vt)))*2;while((vt|0)!=(yt|0));return mn[_t>>3]=Pt,Nt=0,on=Pt,on=on*6371.007180918475,mn[_t>>3]=on,fn=Ft,Nt|0}function fp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(Ft=fn,fn=fn+176|0,Nt=Ft,vt=iu(vt,yt,Nt)|0,vt|0)return Nt=vt,Pt=+mn[_t>>3],Pt=Pt*6371.007180918475,Pt=Pt*1e3,mn[_t>>3]=Pt,fn=Ft,Nt|0;if(mn[_t>>3]=0,vt=xt[Nt>>2]|0,(vt|0)<=1)return Nt=0,Pt=0,Pt=Pt*6371.007180918475,Pt=Pt*1e3,mn[_t>>3]=Pt,fn=Ft,Nt|0;yt=vt+-1|0,vt=0,Mt=+mn[Nt+8>>3],Ct=+mn[Nt+16>>3],Pt=0;do vt=vt+1|0,Qt=Mt,Mt=+mn[Nt+8+(vt<<4)>>3],on=+Cn(+((Mt-Qt)*.5)),Vt=Ct,Ct=+mn[Nt+8+(vt<<4)+8>>3],Vt=+Cn(+((Ct-Vt)*.5)),Vt=on*on+Vt*(+Un(+Qt)*+Un(+Mt)*Vt),Pt=Pt+ +Gr(+ +Rn(+Vt),+ +Rn(+(1-Vt)))*2;while((vt|0)!=(yt|0));return mn[_t>>3]=Pt,Nt=0,on=Pt,on=on*6371.007180918475,on=on*1e3,mn[_t>>3]=on,fn=Ft,Nt|0}function pp(vt){vt=vt|0;var yt=0,_t=0,Mt=0;return yt=So(1,12)|0,yt||mr(22832,22787,49,22845),_t=vt+4|0,Mt=xt[_t>>2]|0,Mt|0?(Mt=Mt+8|0,xt[Mt>>2]=yt,xt[_t>>2]=yt,yt|0):(xt[vt>>2]|0&&mr(22862,22787,61,22885),Mt=vt,xt[Mt>>2]=yt,xt[_t>>2]=yt,yt|0)}function wl(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0;return Mt=Ks(24)|0,Mt||mr(22899,22787,78,22913),xt[Mt>>2]=xt[yt>>2],xt[Mt+4>>2]=xt[yt+4>>2],xt[Mt+8>>2]=xt[yt+8>>2],xt[Mt+12>>2]=xt[yt+12>>2],xt[Mt+16>>2]=0,yt=vt+4|0,_t=xt[yt>>2]|0,_t|0?(xt[_t+16>>2]=Mt,xt[yt>>2]=Mt,Mt|0):(xt[vt>>2]|0&&mr(22928,22787,82,22913),xt[vt>>2]=Mt,xt[yt>>2]=Mt,Mt|0)}function Ho(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0;if(vt)for(Mt=1;;){if(yt=xt[vt>>2]|0,yt|0)do{if(_t=xt[yt>>2]|0,_t|0)do Ct=_t,_t=xt[_t+16>>2]|0,Qr(Ct);while(_t|0);Ct=yt,yt=xt[yt+8>>2]|0,Qr(Ct)}while(yt|0);if(yt=vt,vt=xt[vt+8>>2]|0,Mt||Qr(yt),vt)Mt=0;else break}}function Zl(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0,vs=0,fs=0,ms=0,_i=0,Zr=0,es=0,xs=0,Yr=0;if(Ct=vt+8|0,xt[Ct>>2]|0)return Yr=1,Yr|0;if(Mt=xt[vt>>2]|0,!Mt)return Yr=0,Yr|0;yt=Mt,_t=0;do _t=_t+1|0,yt=xt[yt+8>>2]|0;while(yt|0);if(_t>>>0<2)return Yr=0,Yr|0;es=Ks(_t<<2)|0,es||mr(22948,22787,317,22967),Zr=Ks(_t<<5)|0,Zr||mr(22989,22787,321,22967),xt[vt>>2]=0,Br=vt+4|0,xt[Br>>2]=0,xt[Ct>>2]=0,_t=0,_i=0,$r=0,An=0;e:for(;;){if(on=xt[Mt>>2]|0,on){Pt=0,Nt=on;do{if(Vt=+mn[Nt+8>>3],yt=Nt,Nt=xt[Nt+16>>2]|0,Qt=(Nt|0)==0,Ct=Qt?on:Nt,Ft=+mn[Ct+8>>3],+ln(+(Vt-Ft))>3.141592653589793){Yr=14;break}Pt=Pt+(Ft-Vt)*(+mn[yt>>3]+ +mn[Ct>>3])}while(!Qt);if((Yr|0)==14){Yr=0,Pt=0,yt=on;do kn=+mn[yt+8>>3],ms=yt+16|0,fs=xt[ms>>2]|0,fs=fs|0?fs:on,Kn=+mn[fs+8>>3],Pt=Pt+(+mn[yt>>3]+ +mn[fs>>3])*((Kn<0?Kn+6.283185307179586:Kn)-(kn<0?kn+6.283185307179586:kn)),yt=xt[(yt|0?ms:Mt)>>2]|0;while(yt|0)}Pt>0?(xt[es+(_i<<2)>>2]=Mt,_i=_i+1|0,Ct=$r,yt=An):Yr=19}else Yr=19;if((Yr|0)==19){Yr=0;do if(_t){if(yt=_t+8|0,xt[yt>>2]|0){Yr=21;break e}if(_t=So(1,12)|0,!_t){Yr=23;break e}xt[yt>>2]=_t,Ct=_t+4|0,Nt=_t,yt=An}else if(An){Ct=Br,Nt=An+8|0,yt=Mt,_t=vt;break}else if(xt[vt>>2]|0){Yr=27;break e}else{Ct=Br,Nt=vt,yt=Mt,_t=vt;break}while(!1);if(xt[Nt>>2]=Mt,xt[Ct>>2]=Mt,Nt=Zr+($r<<5)|0,Qt=xt[Mt>>2]|0,Qt){for(on=Zr+($r<<5)+8|0,mn[on>>3]=17976931348623157e292,An=Zr+($r<<5)+24|0,mn[An>>3]=17976931348623157e292,mn[Nt>>3]=-17976931348623157e292,Tn=Zr+($r<<5)+16|0,mn[Tn>>3]=-17976931348623157e292,Ln=17976931348623157e292,Hn=-17976931348623157e292,Ct=0,Pn=Qt,Vt=17976931348623157e292,Bn=17976931348623157e292,ur=-17976931348623157e292,Ft=-17976931348623157e292;Pt=+mn[Pn>>3],kn=+mn[Pn+8>>3],Pn=xt[Pn+16>>2]|0,bn=(Pn|0)==0,Kn=+mn[(bn?Qt:Pn)+8>>3],Pt<Vt&&(mn[on>>3]=Pt,Vt=Pt),kn<Bn&&(mn[An>>3]=kn,Bn=kn),Pt>ur?mn[Nt>>3]=Pt:Pt=ur,kn>Ft&&(mn[Tn>>3]=kn,Ft=kn),Ln=kn>0&kn<Ln?kn:Ln,Hn=kn<0&kn>Hn?kn:Hn,Ct=Ct|+ln(+(kn-Kn))>3.141592653589793,!bn;)ur=Pt;Ct&&(mn[Tn>>3]=Hn,mn[An>>3]=Ln)}else xt[Nt>>2]=0,xt[Nt+4>>2]=0,xt[Nt+8>>2]=0,xt[Nt+12>>2]=0,xt[Nt+16>>2]=0,xt[Nt+20>>2]=0,xt[Nt+24>>2]=0,xt[Nt+28>>2]=0;Ct=$r+1|0}if(ms=Mt+8|0,Mt=xt[ms>>2]|0,xt[ms>>2]=0,Mt)$r=Ct,An=yt;else{Yr=45;break}}if((Yr|0)==21)mr(22765,22787,35,22799);else if((Yr|0)==23)mr(22819,22787,37,22799);else if((Yr|0)==27)mr(22862,22787,61,22885);else if((Yr|0)==45){e:do if((_i|0)>0){for(ms=(Ct|0)==0,vs=Ct<<2,fs=(vt|0)==0,Dr=0,yt=0;;){if(Er=xt[es+(Dr<<2)>>2]|0,ms)Yr=73;else{if($r=Ks(vs)|0,!$r){Yr=50;break}if(Br=Ks(vs)|0,!Br){Yr=52;break}t:do if(fs)_t=0;else{for(Ct=0,_t=0,Nt=vt;Mt=Zr+(Ct<<5)|0,Du(xt[Nt>>2]|0,Mt,xt[Er>>2]|0)|0?(xt[$r+(_t<<2)>>2]=Nt,xt[Br+(_t<<2)>>2]=Mt,bn=_t+1|0):bn=_t,Nt=xt[Nt+8>>2]|0,Nt;)Ct=Ct+1|0,_t=bn;if((bn|0)>0)if(Mt=xt[$r>>2]|0,(bn|0)==1)_t=Mt;else for(Tn=0,Pn=-1,_t=Mt,An=Mt;;){for(Qt=xt[An>>2]|0,Mt=0,Nt=0;Ct=xt[xt[$r+(Nt<<2)>>2]>>2]|0,(Ct|0)==(Qt|0)?on=Mt:on=Mt+((Du(Ct,xt[Br+(Nt<<2)>>2]|0,xt[Qt>>2]|0)|0)&1)|0,Nt=Nt+1|0,(Nt|0)!=(bn|0);)Mt=on;if(Ct=(on|0)>(Pn|0),_t=Ct?An:_t,Mt=Tn+1|0,(Mt|0)==(bn|0))break t;Tn=Mt,Pn=Ct?on:Pn,An=xt[$r+(Mt<<2)>>2]|0}else _t=0}while(!1);if(Qr($r),Qr(Br),_t){if(Ct=_t+4|0,Mt=xt[Ct>>2]|0,Mt)_t=Mt+8|0;else if(xt[_t>>2]|0){Yr=70;break}xt[_t>>2]=Er,xt[Ct>>2]=Er}else Yr=73}if((Yr|0)==73){if(Yr=0,yt=xt[Er>>2]|0,yt|0)do Br=yt,yt=xt[yt+16>>2]|0,Qr(Br);while(yt|0);Qr(Er),yt=1}if(Dr=Dr+1|0,(Dr|0)>=(_i|0)){xs=yt;break e}}(Yr|0)==50?mr(23004,22787,249,23023):(Yr|0)==52?mr(23042,22787,252,23023):(Yr|0)==70&&mr(22862,22787,61,22885)}else xs=0;while(!1);return Qr(es),Qr(Zr),Yr=xs,Yr|0}return 0}function Du(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0;if(!(Il(yt,_t)|0)||(yt=nu(yt)|0,Mt=+mn[_t>>3],Ct=+mn[_t+8>>3],Ct=yt&Ct<0?Ct+6.283185307179586:Ct,vt=xt[vt>>2]|0,!vt))return vt=0,vt|0;if(yt){yt=0,Qt=Ct,_t=vt;e:for(;;){for(;Nt=+mn[_t>>3],Ct=+mn[_t+8>>3],_t=_t+16|0,on=xt[_t>>2]|0,on=on|0?on:vt,Pt=+mn[on>>3],Ft=+mn[on+8>>3],Nt>Pt?(Vt=Nt,Nt=Ft):(Vt=Pt,Pt=Nt,Nt=Ct,Ct=Ft),Mt=Mt==Pt|Mt==Vt?Mt+2220446049250313e-31:Mt,!!(Mt<Pt|Mt>Vt);)if(_t=xt[_t>>2]|0,!_t){_t=22;break e}if(Ft=Nt<0?Nt+6.283185307179586:Nt,Nt=Ct<0?Ct+6.283185307179586:Ct,Qt=Ft==Qt|Nt==Qt?Qt+-2220446049250313e-31:Qt,Vt=Ft+(Nt-Ft)*((Mt-Pt)/(Vt-Pt)),(Vt<0?Vt+6.283185307179586:Vt)>Qt&&(yt=yt^1),_t=xt[_t>>2]|0,!_t){_t=22;break}}if((_t|0)==22)return yt|0}else{yt=0,Qt=Ct,_t=vt;e:for(;;){for(;Nt=+mn[_t>>3],Ct=+mn[_t+8>>3],_t=_t+16|0,on=xt[_t>>2]|0,on=on|0?on:vt,Pt=+mn[on>>3],Ft=+mn[on+8>>3],Nt>Pt?(Vt=Nt,Nt=Ft):(Vt=Pt,Pt=Nt,Nt=Ct,Ct=Ft),Mt=Mt==Pt|Mt==Vt?Mt+2220446049250313e-31:Mt,!!(Mt<Pt|Mt>Vt);)if(_t=xt[_t>>2]|0,!_t){_t=22;break e}if(Qt=Nt==Qt|Ct==Qt?Qt+-2220446049250313e-31:Qt,Nt+(Ct-Nt)*((Mt-Pt)/(Vt-Pt))>Qt&&(yt=yt^1),_t=xt[_t>>2]|0,!_t){_t=22;break}}if((_t|0)==22)return yt|0}return 0}function Fo(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0;if(Hn=fn,fn=fn+32|0,Ln=Hn+16|0,ur=Hn,Pt=_r(vt|0,yt|0,52)|0,cn()|0,Pt=Pt&15,Pn=_r(_t|0,Mt|0,52)|0,cn()|0,(Pt|0)!=(Pn&15|0))return Ln=12,fn=Hn,Ln|0;if(Qt=_r(vt|0,yt|0,45)|0,cn()|0,Qt=Qt&127,on=_r(_t|0,Mt|0,45)|0,cn()|0,on=on&127,Qt>>>0>121|on>>>0>121)return Ln=5,fn=Hn,Ln|0;if(Pn=(Qt|0)!=(on|0),Pn){if(Ft=yl(Qt,on)|0,(Ft|0)==7)return Ln=1,fn=Hn,Ln|0;Vt=yl(on,Qt)|0,(Vt|0)==7?mr(23066,23090,161,23100):(bn=Ft,Nt=Vt)}else bn=0,Nt=0;An=ps(Qt)|0,Tn=ps(on)|0,xt[Ln>>2]=0,xt[Ln+4>>2]=0,xt[Ln+8>>2]=0,xt[Ln+12>>2]=0;do if(bn){if(on=xt[4272+(Qt*28|0)+(bn<<2)>>2]|0,Ft=(on|0)>0,Tn)if(Ft){Qt=0,Vt=_t,Ft=Mt;do Vt=Ip(Vt,Ft)|0,Ft=cn()|0,Nt=Is(Nt)|0,(Nt|0)==1&&(Nt=Is(1)|0),Qt=Qt+1|0;while((Qt|0)!=(on|0));on=Nt,Qt=Vt,Vt=Ft}else on=Nt,Qt=_t,Vt=Mt;else if(Ft){Qt=0,Vt=_t,Ft=Mt;do Vt=Kl(Vt,Ft)|0,Ft=cn()|0,Nt=Is(Nt)|0,Qt=Qt+1|0;while((Qt|0)!=(on|0));on=Nt,Qt=Vt,Vt=Ft}else on=Nt,Qt=_t,Vt=Mt;if(lu(Qt,Vt,Ln)|0,Pn||mr(23115,23090,191,23100),Ft=(An|0)!=0,Nt=(Tn|0)!=0,Ft&Nt&&mr(23142,23090,192,23100),Ft){if(Nt=yo(vt,yt)|0,(Nt|0)==7){Pt=5;break}if(Or[21872+(Nt*7|0)+bn>>0]|0){Pt=1;break}Vt=xt[21040+(Nt*28|0)+(bn<<2)>>2]|0,Qt=Vt}else if(Nt){if(Nt=yo(Qt,Vt)|0,(Nt|0)==7){Pt=5;break}if(Or[21872+(Nt*7|0)+on>>0]|0){Pt=1;break}Qt=0,Vt=xt[21040+(on*28|0)+(Nt<<2)>>2]|0}else Qt=0,Vt=0;if((Qt|Vt|0)<0)Pt=5;else{if((Vt|0)>0){Ft=Ln+4|0,Nt=0;do _l(Ft),Nt=Nt+1|0;while((Nt|0)!=(Vt|0))}if(xt[ur>>2]=0,xt[ur+4>>2]=0,xt[ur+8>>2]=0,$o(ur,bn),Pt|0)for(;bo(Pt)|0?Hs(ur):Do(ur),(Pt|0)>1;)Pt=Pt+-1|0;if((Qt|0)>0){Pt=0;do _l(ur),Pt=Pt+1|0;while((Pt|0)!=(Qt|0))}Bn=Ln+4|0,Rs(Bn,ur,Bn),_s(Bn),Bn=51}}else if(lu(_t,Mt,Ln)|0,(An|0)!=0&(Tn|0)!=0)if((on|0)!=(Qt|0)&&mr(23173,23090,261,23100),Nt=yo(vt,yt)|0,Pt=yo(_t,Mt)|0,(Nt|0)==7|(Pt|0)==7)Pt=5;else if(Or[21872+(Nt*7|0)+Pt>>0]|0)Pt=1;else if(Nt=xt[21040+(Nt*28|0)+(Pt<<2)>>2]|0,(Nt|0)>0){Ft=Ln+4|0,Pt=0;do _l(Ft),Pt=Pt+1|0;while((Pt|0)!=(Nt|0));Bn=51}else Bn=51;else Bn=51;while(!1);return(Bn|0)==51&&(Pt=Ln+4|0,xt[Ct>>2]=xt[Pt>>2],xt[Ct+4>>2]=xt[Pt+4>>2],xt[Ct+8>>2]=xt[Pt+8>>2],Pt=0),Ln=Pt,fn=Hn,Ln|0}function mp(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0;if(Bn=fn,fn=fn+48|0,Qt=Bn+36|0,Nt=Bn+24|0,Ft=Bn+12|0,Vt=Bn,Ct=_r(vt|0,yt|0,52)|0,cn()|0,Ct=Ct&15,Tn=_r(vt|0,yt|0,45)|0,cn()|0,Tn=Tn&127,Tn>>>0>121)return Mt=5,fn=Bn,Mt|0;if(on=ps(Tn)|0,Cr(Ct|0,0,52)|0,ur=cn()|0|134225919,Pt=Mt,xt[Pt>>2]=-1,xt[Pt+4>>2]=ur,!Ct)return Ct=ro(_t)|0,(Ct|0)==7||(Ct=Ls(Tn,Ct)|0,(Ct|0)==127)?(ur=1,fn=Bn,ur|0):(Pn=Cr(Ct|0,0,45)|0,bn=cn()|0,Tn=Mt,bn=xt[Tn+4>>2]&-1040385|bn,ur=Mt,xt[ur>>2]=xt[Tn>>2]|Pn,xt[ur+4>>2]=bn,ur=0,fn=Bn,ur|0);for(xt[Qt>>2]=xt[_t>>2],xt[Qt+4>>2]=xt[_t+4>>2],xt[Qt+8>>2]=xt[_t+8>>2],_t=Ct;;){if(Pt=_t,_t=_t+-1|0,xt[Nt>>2]=xt[Qt>>2],xt[Nt+4>>2]=xt[Qt+4>>2],xt[Nt+8>>2]=xt[Qt+8>>2],bo(Pt)|0){if(Ct=Gl(Qt)|0,Ct|0){_t=13;break}xt[Ft>>2]=xt[Qt>>2],xt[Ft+4>>2]=xt[Qt+4>>2],xt[Ft+8>>2]=xt[Qt+8>>2],Hs(Ft)}else{if(Ct=Vl(Qt)|0,Ct|0){_t=13;break}xt[Ft>>2]=xt[Qt>>2],xt[Ft+4>>2]=xt[Qt+4>>2],xt[Ft+8>>2]=xt[Qt+8>>2],Do(Ft)}if(Ul(Nt,Ft,Vt),_s(Vt),Ct=Mt,Hn=xt[Ct>>2]|0,Ct=xt[Ct+4>>2]|0,Kn=(15-Pt|0)*3|0,Ln=Cr(7,0,Kn|0)|0,Ct=Ct&~(cn()|0),Kn=Cr(ro(Vt)|0,0,Kn|0)|0,Ct=cn()|0|Ct,ur=Mt,xt[ur>>2]=Kn|Hn&~Ln,xt[ur+4>>2]=Ct,(Pt|0)<=1){_t=14;break}}e:do if((_t|0)!=13&&(_t|0)==14)if((xt[Qt>>2]|0)<=1&&(xt[Qt+4>>2]|0)<=1&&(xt[Qt+8>>2]|0)<=1){_t=ro(Qt)|0,Ct=Ls(Tn,_t)|0,(Ct|0)==127?Vt=0:Vt=ps(Ct)|0;t:do if(_t){if(on){if(Ct=yo(vt,yt)|0,(Ct|0)==7){Ct=5;break e}if(Pt=xt[21248+(Ct*28|0)+(_t<<2)>>2]|0,(Pt|0)>0){Ct=_t,_t=0;do Ct=Yo(Ct)|0,_t=_t+1|0;while((_t|0)!=(Pt|0))}else Ct=_t;if((Ct|0)==1){Ct=9;break e}_t=Ls(Tn,Ct)|0,(_t|0)==127&&mr(23200,23090,411,23230),ps(_t)|0?mr(23245,23090,412,23230):(bn=_t,Pn=Pt,An=Ct)}else bn=Ct,Pn=0,An=_t;if(Ft=xt[4272+(Tn*28|0)+(An<<2)>>2]|0,(Ft|0)<=-1&&mr(23276,23090,419,23230),!Vt){if((Pn|0)<0){Ct=5;break e}if(Pn|0){Pt=Mt,Ct=0,_t=xt[Pt>>2]|0,Pt=xt[Pt+4>>2]|0;do _t=Ml(_t,Pt)|0,Pt=cn()|0,Kn=Mt,xt[Kn>>2]=_t,xt[Kn+4>>2]=Pt,Ct=Ct+1|0;while((Ct|0)<(Pn|0))}if((Ft|0)<=0){Ct=bn,_t=58;break}for(Pt=Mt,Ct=0,_t=xt[Pt>>2]|0,Pt=xt[Pt+4>>2]|0;;)if(_t=Ml(_t,Pt)|0,Pt=cn()|0,Kn=Mt,xt[Kn>>2]=_t,xt[Kn+4>>2]=Pt,Ct=Ct+1|0,(Ct|0)==(Ft|0)){Ct=bn,_t=58;break t}}if(Nt=yl(bn,Tn)|0,(Nt|0)==7&&mr(23066,23090,428,23230),Ct=Mt,_t=xt[Ct>>2]|0,Ct=xt[Ct+4>>2]|0,(Ft|0)>0){Pt=0;do _t=Ml(_t,Ct)|0,Ct=cn()|0,Kn=Mt,xt[Kn>>2]=_t,xt[Kn+4>>2]=Ct,Pt=Pt+1|0;while((Pt|0)!=(Ft|0))}if(Ct=yo(_t,Ct)|0,(Ct|0)==7&&mr(23313,23090,440,23230),_t=as(bn)|0,_t=xt[(_t?21664:21456)+(Nt*28|0)+(Ct<<2)>>2]|0,(_t|0)<0&&mr(23313,23090,454,23230),!_t)Ct=bn,_t=58;else{Nt=Mt,Ct=0,Pt=xt[Nt>>2]|0,Nt=xt[Nt+4>>2]|0;do Pt=Pu(Pt,Nt)|0,Nt=cn()|0,Kn=Mt,xt[Kn>>2]=Pt,xt[Kn+4>>2]=Nt,Ct=Ct+1|0;while((Ct|0)<(_t|0));Ct=bn,_t=58}}else if((on|0)!=0&(Vt|0)!=0){if(_t=yo(vt,yt)|0,Pt=Mt,Pt=yo(xt[Pt>>2]|0,xt[Pt+4>>2]|0)|0,(_t|0)==7|(Pt|0)==7){Ct=5;break e}if(Pt=xt[21248+(_t*28|0)+(Pt<<2)>>2]|0,(Pt|0)<0){Ct=5;break e}if(!Pt)_t=59;else{Ft=Mt,_t=0,Nt=xt[Ft>>2]|0,Ft=xt[Ft+4>>2]|0;do Nt=Ml(Nt,Ft)|0,Ft=cn()|0,Kn=Mt,xt[Kn>>2]=Nt,xt[Kn+4>>2]=Ft,_t=_t+1|0;while((_t|0)<(Pt|0));_t=58}}else _t=58;while(!1);if((_t|0)==58&&Vt&&(_t=59),(_t|0)==59&&(Kn=Mt,(yo(xt[Kn>>2]|0,xt[Kn+4>>2]|0)|0)==1)){Ct=9;break}Kn=Mt,Ln=xt[Kn>>2]|0,Kn=xt[Kn+4>>2]&-1040385,Hn=Cr(Ct|0,0,45)|0,Kn=Kn|(cn()|0),Ct=Mt,xt[Ct>>2]=Ln|Hn,xt[Ct+4>>2]=Kn,Ct=0}else Ct=1;while(!1);return Kn=Ct,fn=Bn,Kn|0}function $p(vt,yt,_t,Mt,Ct,Pt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0,Pt=Pt|0;var Nt=0,Ft=0;return Ft=fn,fn=fn+16|0,Nt=Ft,Ct?vt=15:(vt=Fo(vt,yt,_t,Mt,Nt)|0,vt||(Mo(Nt,Pt),vt=0)),fn=Ft,vt|0}function Np(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0;return Nt=fn,fn=fn+16|0,Pt=Nt,Mt?_t=15:(_t=Dl(_t,Pt)|0,_t||(_t=mp(vt,yt,Pt,Ct)|0)),fn=Nt,_t|0}function Bp(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0;return Vt=fn,fn=fn+32|0,Nt=Vt+12|0,Ft=Vt,Pt=Fo(vt,yt,vt,yt,Nt)|0,Pt|0?(Ft=Pt,fn=Vt,Ft|0):(vt=Fo(vt,yt,_t,Mt,Ft)|0,vt|0?(Ft=vt,fn=Vt,Ft|0):(Nt=Fs(Nt,Ft)|0,Ft=Ct,xt[Ft>>2]=Nt,xt[Ft+4>>2]=((Nt|0)<0)<<31>>31,Ft=0,fn=Vt,Ft|0))}function Fp(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0;return Vt=fn,fn=fn+32|0,Nt=Vt+12|0,Ft=Vt,Pt=Fo(vt,yt,vt,yt,Nt)|0,!Pt&&(Pt=Fo(vt,yt,_t,Mt,Ft)|0,!Pt)?(Mt=Fs(Nt,Ft)|0,Mt=ts(Mt|0,((Mt|0)<0)<<31>>31|0,1,0)|0,Nt=cn()|0,Ft=Ct,xt[Ft>>2]=Mt,xt[Ft+4>>2]=Nt,Ft=0,fn=Vt,Ft|0):(Ft=Pt,fn=Vt,Ft|0)}function Op(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0,Dr=0;if(Er=fn,fn=fn+48|0,Nt=Er+24|0,Ft=Er+12|0,Br=Er,Pt=Fo(vt,yt,vt,yt,Nt)|0,!Pt&&(Pt=Fo(vt,yt,_t,Mt,Ft)|0,!Pt)){kn=Fs(Nt,Ft)|0,$r=((kn|0)<0)<<31>>31,xt[Nt>>2]=0,xt[Nt+4>>2]=0,xt[Nt+8>>2]=0,xt[Ft>>2]=0,xt[Ft+4>>2]=0,xt[Ft+8>>2]=0,Fo(vt,yt,vt,yt,Nt)|0&&mr(23313,23090,691,23299),Fo(vt,yt,_t,Mt,Ft)|0&&mr(23313,23090,696,23299),ju(Nt),ju(Ft),kn?(An=xt[Nt>>2]|0,bn=+(kn|0),Ln=Nt+4|0,Tn=xt[Ln>>2]|0,Hn=Nt+8|0,Pn=xt[Hn>>2]|0,Kn=Nt,Mt=An,Pt=Tn,_t=Pn,Bn=+((xt[Ft>>2]|0)-An|0)/bn,ur=+((xt[Ft+4>>2]|0)-Tn|0)/bn,bn=+((xt[Ft+8>>2]|0)-Pn|0)/bn):(Pt=Nt+4|0,_t=Nt+8|0,Ln=Pt,Hn=_t,Kn=Nt,Mt=xt[Nt>>2]|0,Pt=xt[Pt>>2]|0,_t=xt[_t>>2]|0,Bn=0,ur=0,bn=0),xt[Br>>2]=Mt,Pn=Br+4|0,xt[Pn>>2]=Pt,Tn=Br+8|0,xt[Tn>>2]=_t;e:do if((kn|0)<0)Pt=0;else for(on=0,An=0,Pt=Mt;;){Qt=+(An>>>0)+4294967296*+(on|0),Dr=Bn*Qt+ +(Pt|0),Vt=ur*Qt+ +(xt[Ln>>2]|0),Qt=bn*Qt+ +(xt[Hn>>2]|0),_t=~~+Bu(+Dr),Nt=~~+Bu(+Vt),Pt=~~+Bu(+Qt),Dr=+ln(+(+(_t|0)-Dr)),Vt=+ln(+(+(Nt|0)-Vt)),Qt=+ln(+(+(Pt|0)-Qt));do if(Dr>Vt&Dr>Qt)_t=0-(Nt+Pt)|0,Mt=Nt;else if(Ft=0-_t|0,Vt>Qt){Mt=Ft-Pt|0;break}else{Mt=Nt,Pt=Ft-Nt|0;break}while(!1);if(xt[Br>>2]=_t,xt[Pn>>2]=Mt,xt[Tn>>2]=Pt,Ep(Br),Pt=mp(vt,yt,Br,Ct+(An<<3)|0)|0,Pt|0)break e;if(!((on|0)<($r|0)|(on|0)==($r|0)&An>>>0<kn>>>0)){Pt=0;break e}Pt=ts(An|0,on|0,1,0)|0,Ft=cn()|0,on=Ft,An=Pt,Pt=xt[Kn>>2]|0}while(!1);return Br=Pt,fn=Er,Br|0}return Br=Pt,fn=Er,Br|0}function na(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0;if((_t|0)==0&(Mt|0)==0)return Ct=0,Pt=1,wr(Ct|0),Pt|0;Pt=vt,Ct=yt,vt=1,yt=0;do Nt=(_t&1|0)==0&!0,vt=fo((Nt?1:Pt)|0,(Nt?0:Ct)|0,vt|0,yt|0)|0,yt=cn()|0,_t=po(_t|0,Mt|0,1)|0,Mt=cn()|0,Pt=fo(Pt|0,Ct|0,Pt|0,Ct|0)|0,Ct=cn()|0;while(!((_t|0)==0&(Mt|0)==0));return wr(yt|0),vt|0}function pu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0;if(!(Il(yt,_t)|0)||(yt=nu(yt)|0,Mt=+mn[_t>>3],Ct=+mn[_t+8>>3],Ct=yt&Ct<0?Ct+6.283185307179586:Ct,Tn=xt[vt>>2]|0,(Tn|0)<=0))return Tn=0,Tn|0;if(An=xt[vt+4>>2]|0,yt){yt=0,on=Ct,_t=-1,vt=0;e:for(;;){for(Qt=vt;Nt=+mn[An+(Qt<<4)>>3],Ct=+mn[An+(Qt<<4)+8>>3],vt=(_t+2|0)%(Tn|0)|0,Pt=+mn[An+(vt<<4)>>3],Ft=+mn[An+(vt<<4)+8>>3],Nt>Pt?(Vt=Nt,Nt=Ft):(Vt=Pt,Pt=Nt,Nt=Ct,Ct=Ft),Mt=Mt==Pt|Mt==Vt?Mt+2220446049250313e-31:Mt,!!(Mt<Pt|Mt>Vt);)if(_t=Qt+1|0,(_t|0)>=(Tn|0)){_t=22;break e}else vt=Qt,Qt=_t,_t=vt;if(Ft=Nt<0?Nt+6.283185307179586:Nt,Nt=Ct<0?Ct+6.283185307179586:Ct,on=Ft==on|Nt==on?on+-2220446049250313e-31:on,Vt=Ft+(Nt-Ft)*((Mt-Pt)/(Vt-Pt)),(Vt<0?Vt+6.283185307179586:Vt)>on&&(yt=yt^1),vt=Qt+1|0,(vt|0)>=(Tn|0)){_t=22;break}else _t=Qt}if((_t|0)==22)return yt|0}else{yt=0,on=Ct,_t=-1,vt=0;e:for(;;){for(Qt=vt;Nt=+mn[An+(Qt<<4)>>3],Ct=+mn[An+(Qt<<4)+8>>3],vt=(_t+2|0)%(Tn|0)|0,Pt=+mn[An+(vt<<4)>>3],Ft=+mn[An+(vt<<4)+8>>3],Nt>Pt?(Vt=Nt,Nt=Ft):(Vt=Pt,Pt=Nt,Nt=Ct,Ct=Ft),Mt=Mt==Pt|Mt==Vt?Mt+2220446049250313e-31:Mt,!!(Mt<Pt|Mt>Vt);)if(_t=Qt+1|0,(_t|0)>=(Tn|0)){_t=22;break e}else vt=Qt,Qt=_t,_t=vt;if(on=Nt==on|Ct==on?on+-2220446049250313e-31:on,Nt+(Ct-Nt)*((Mt-Pt)/(Vt-Pt))>on&&(yt=yt^1),vt=Qt+1|0,(vt|0)>=(Tn|0)){_t=22;break}else _t=Qt}if((_t|0)==22)return yt|0}return 0}function Ap(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0;if(bn=xt[vt>>2]|0,!bn){xt[yt>>2]=0,xt[yt+4>>2]=0,xt[yt+8>>2]=0,xt[yt+12>>2]=0,xt[yt+16>>2]=0,xt[yt+20>>2]=0,xt[yt+24>>2]=0,xt[yt+28>>2]=0;return}if(Bn=yt+8|0,mn[Bn>>3]=17976931348623157e292,ur=yt+24|0,mn[ur>>3]=17976931348623157e292,mn[yt>>3]=-17976931348623157e292,Ln=yt+16|0,mn[Ln>>3]=-17976931348623157e292,!((bn|0)<=0)){for(Tn=xt[vt+4>>2]|0,Qt=17976931348623157e292,on=-17976931348623157e292,An=0,vt=-1,Pt=17976931348623157e292,Nt=17976931348623157e292,Vt=-17976931348623157e292,Mt=-17976931348623157e292,Pn=0;_t=+mn[Tn+(Pn<<4)>>3],Ft=+mn[Tn+(Pn<<4)+8>>3],vt=vt+2|0,Ct=+mn[Tn+(((vt|0)==(bn|0)?0:vt)<<4)+8>>3],_t<Pt&&(mn[Bn>>3]=_t,Pt=_t),Ft<Nt&&(mn[ur>>3]=Ft,Nt=Ft),_t>Vt?mn[yt>>3]=_t:_t=Vt,Ft>Mt&&(mn[Ln>>3]=Ft,Mt=Ft),Qt=Ft>0&Ft<Qt?Ft:Qt,on=Ft<0&Ft>on?Ft:on,An=An|+ln(+(Ft-Ct))>3.141592653589793,vt=Pn+1|0,(vt|0)!=(bn|0);)Hn=Pn,Vt=_t,Pn=vt,vt=Hn;An&&(mn[Ln>>3]=on,mn[ur>>3]=Qt)}}function Ju(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0,Br=0,Er=0;if(bn=xt[vt>>2]|0,bn){if(Bn=yt+8|0,mn[Bn>>3]=17976931348623157e292,ur=yt+24|0,mn[ur>>3]=17976931348623157e292,mn[yt>>3]=-17976931348623157e292,Ln=yt+16|0,mn[Ln>>3]=-17976931348623157e292,(bn|0)>0){for(Ct=xt[vt+4>>2]|0,Tn=17976931348623157e292,Pn=-17976931348623157e292,Mt=0,_t=-1,Vt=17976931348623157e292,Qt=17976931348623157e292,An=-17976931348623157e292,Nt=-17976931348623157e292,Hn=0;Pt=+mn[Ct+(Hn<<4)>>3],on=+mn[Ct+(Hn<<4)+8>>3],Br=_t+2|0,Ft=+mn[Ct+(((Br|0)==(bn|0)?0:Br)<<4)+8>>3],Pt<Vt&&(mn[Bn>>3]=Pt,Vt=Pt),on<Qt&&(mn[ur>>3]=on,Qt=on),Pt>An?mn[yt>>3]=Pt:Pt=An,on>Nt&&(mn[Ln>>3]=on,Nt=on),Tn=on>0&on<Tn?on:Tn,Pn=on<0&on>Pn?on:Pn,Mt=Mt|+ln(+(on-Ft))>3.141592653589793,_t=Hn+1|0,(_t|0)!=(bn|0);)Br=Hn,An=Pt,Hn=_t,_t=Br;Mt&&(mn[Ln>>3]=Pn,mn[ur>>3]=Tn)}}else xt[yt>>2]=0,xt[yt+4>>2]=0,xt[yt+8>>2]=0,xt[yt+12>>2]=0,xt[yt+16>>2]=0,xt[yt+20>>2]=0,xt[yt+24>>2]=0,xt[yt+28>>2]=0;if(Br=vt+8|0,_t=xt[Br>>2]|0,!((_t|0)<=0)){$r=vt+12|0,kn=0;do if(Ct=xt[$r>>2]|0,Mt=kn,kn=kn+1|0,ur=yt+(kn<<5)|0,Ln=xt[Ct+(Mt<<3)>>2]|0,Ln){if(Hn=yt+(kn<<5)+8|0,mn[Hn>>3]=17976931348623157e292,vt=yt+(kn<<5)+24|0,mn[vt>>3]=17976931348623157e292,mn[ur>>3]=-17976931348623157e292,Kn=yt+(kn<<5)+16|0,mn[Kn>>3]=-17976931348623157e292,(Ln|0)>0){for(bn=xt[Ct+(Mt<<3)+4>>2]|0,Tn=17976931348623157e292,Pn=-17976931348623157e292,Ct=0,Mt=-1,Bn=0,Vt=17976931348623157e292,Qt=17976931348623157e292,on=-17976931348623157e292,Nt=-17976931348623157e292;Pt=+mn[bn+(Bn<<4)>>3],An=+mn[bn+(Bn<<4)+8>>3],Mt=Mt+2|0,Ft=+mn[bn+(((Mt|0)==(Ln|0)?0:Mt)<<4)+8>>3],Pt<Vt&&(mn[Hn>>3]=Pt,Vt=Pt),An<Qt&&(mn[vt>>3]=An,Qt=An),Pt>on?mn[ur>>3]=Pt:Pt=on,An>Nt&&(mn[Kn>>3]=An,Nt=An),Tn=An>0&An<Tn?An:Tn,Pn=An<0&An>Pn?An:Pn,Ct=Ct|+ln(+(An-Ft))>3.141592653589793,Mt=Bn+1|0,(Mt|0)!=(Ln|0);)Er=Bn,Bn=Mt,on=Pt,Mt=Er;Ct&&(mn[Kn>>3]=Pn,mn[vt>>3]=Tn)}}else xt[ur>>2]=0,xt[ur+4>>2]=0,xt[ur+8>>2]=0,xt[ur+12>>2]=0,xt[ur+16>>2]=0,xt[ur+20>>2]=0,xt[ur+24>>2]=0,xt[ur+28>>2]=0,_t=xt[Br>>2]|0;while((kn|0)<(_t|0))}}function Zu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;if(!(pu(vt,yt,_t)|0))return Ct=0,Ct|0;if(Ct=vt+8|0,(xt[Ct>>2]|0)<=0)return Ct=1,Ct|0;for(Mt=vt+12|0,vt=0;;){if(Pt=vt,vt=vt+1|0,pu((xt[Mt>>2]|0)+(Pt<<3)|0,yt+(vt<<5)|0,_t)|0){vt=0,Mt=6;break}if((vt|0)>=(xt[Ct>>2]|0)){vt=1,Mt=6;break}}return(Mt|0)==6?vt|0:0}function gp(){return 8}function $u(){return 16}function kp(){return 168}function Up(){return 8}function Gp(){return 16}function Vp(){return 12}function yp(){return 8}function zp(vt){return vt=vt|0,+(+((xt[vt>>2]|0)>>>0)+4294967296*+(xt[vt+4>>2]|0))}function Hp(vt){vt=vt|0;var yt=0,_t=0;return _t=+mn[vt>>3],yt=+mn[vt+8>>3],+ +Rn(+(_t*_t+yt*yt))}function jp(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0;Qt=+mn[vt>>3],Vt=+mn[yt>>3]-Qt,Ft=+mn[vt+8>>3],Nt=+mn[yt+8>>3]-Ft,An=+mn[_t>>3],Pt=+mn[Mt>>3]-An,Tn=+mn[_t+8>>3],on=+mn[Mt+8>>3]-Tn,Pt=(Pt*(Ft-Tn)-(Qt-An)*on)/(Vt*on-Nt*Pt),mn[Ct>>3]=Qt+Vt*Pt,mn[Ct+8>>3]=Ft+Nt*Pt}function vp(vt,yt){return vt=vt|0,yt=yt|0,+ln(+(+mn[vt>>3]-+mn[yt>>3]))<11920928955078125e-23?(yt=+ln(+(+mn[vt+8>>3]-+mn[yt+8>>3]))<11920928955078125e-23,yt|0):(yt=0,yt|0)}function qs(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0;return Ct=+mn[vt>>3]-+mn[yt>>3],Mt=+mn[vt+8>>3]-+mn[yt+8>>3],_t=+mn[vt+16>>3]-+mn[yt+16>>3],+(Ct*Ct+Mt*Mt+_t*_t)}function vm(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0;_t=+mn[vt>>3],Mt=+Un(+_t),_t=+Cn(+_t),mn[yt+16>>3]=_t,_t=+mn[vt+8>>3],Ct=Mt*+Un(+_t),mn[yt>>3]=Ct,_t=Mt*+Cn(+_t),mn[yt+8>>3]=_t}function qp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;if(Pt=fn,fn=fn+16|0,Ct=Pt,Mt=Es(vt,yt)|0,(_t+-1|0)>>>0>5||(Mt=(Mt|0)!=0,(_t|0)==1&Mt))return Ct=-1,fn=Pt,Ct|0;do if(mu(vt,yt,Ct)|0)Mt=-1;else if(Mt){Mt=((xt[21936+(_t<<2)>>2]|0)+5-(xt[Ct>>2]|0)|0)%5|0;break}else{Mt=((xt[21968+(_t<<2)>>2]|0)+6-(xt[Ct>>2]|0)|0)%6|0;break}while(!1);return Ct=Mt,fn=Pt,Ct|0}function mu(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;if(Qt=fn,fn=fn+32|0,Nt=Qt+16|0,Ft=Qt,Mt=Xl(vt,yt,Nt)|0,Mt|0)return _t=Mt,fn=Qt,_t|0;Pt=Qo(vt,yt)|0,Vt=yo(vt,yt)|0,tu(Pt,Ft),Mt=Eu(Pt,xt[Nt>>2]|0)|0;e:do if(ps(Pt)|0){do switch(Pt|0){case 4:{vt=0;break}case 14:{vt=1;break}case 24:{vt=2;break}case 38:{vt=3;break}case 49:{vt=4;break}case 58:{vt=5;break}case 63:{vt=6;break}case 72:{vt=7;break}case 83:{vt=8;break}case 97:{vt=9;break}case 107:{vt=10;break}case 117:{vt=11;break}default:{Mt=1;break e}}while(!1);if(Ct=xt[22e3+(vt*24|0)+8>>2]|0,yt=xt[22e3+(vt*24|0)+16>>2]|0,vt=xt[Nt>>2]|0,(vt|0)!=(xt[Ft>>2]|0)&&(Ft=as(Pt)|0,vt=xt[Nt>>2]|0,Ft|(vt|0)==(yt|0)&&(Mt=(Mt+1|0)%6|0)),(Vt|0)==3&(vt|0)==(yt|0)){Mt=(Mt+5|0)%6|0,Ct=22;break}(Vt|0)==5&(vt|0)==(Ct|0)&&(Mt=(Mt+1|0)%6|0),Ct=22}else Ct=22;while(!1);return(Ct|0)==22&&(xt[_t>>2]=Mt,Mt=0),_t=Mt,fn=Qt,_t|0}function Po(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0;if(Kn=fn,fn=fn+32|0,Hn=Kn+24|0,ur=Kn+20|0,bn=Kn+8|0,Pn=Kn+16|0,Tn=Kn,Vt=(Es(vt,yt)|0)==0,Vt=Vt?6:5,on=_r(vt|0,yt|0,52)|0,cn()|0,on=on&15,Vt>>>0<=_t>>>0)return Mt=2,fn=Kn,Mt|0;An=(on|0)==0,!An&&(Bn=Cr(7,0,(on^15)*3|0)|0,(Bn&vt|0)==0&((cn()|0)&yt|0)==0)?Ct=_t:Pt=4;e:do if((Pt|0)==4){if(Ct=(Es(vt,yt)|0)!=0,((Ct?4:5)|0)<(_t|0)||mu(vt,yt,Hn)|0||(Pt=(xt[Hn>>2]|0)+_t|0,Ct?Ct=22288+(((Pt|0)%5|0)<<2)|0:Ct=22320+(((Pt|0)%6|0)<<2)|0,Bn=xt[Ct>>2]|0,(Bn|0)==7))return Mt=1,fn=Kn,Mt|0;xt[ur>>2]=0,Ct=Cs(vt,yt,Bn,ur,bn)|0;do if(!Ct){if(Ft=bn,Qt=xt[Ft>>2]|0,Ft=xt[Ft+4>>2]|0,Nt=Ft>>>0<yt>>>0|(Ft|0)==(yt|0)&Qt>>>0<vt>>>0,Pt=Nt?Qt:vt,Nt=Nt?Ft:yt,!An&&(An=Cr(7,0,(on^15)*3|0)|0,(Qt&An|0)==0&(Ft&(cn()|0)|0)==0))Ct=_t;else{if(Ft=(_t+-1+Vt|0)%(Vt|0)|0,Ct=Es(vt,yt)|0,(Ft|0)<0&&mr(23313,23315,245,23324),Vt=(Ct|0)!=0,((Vt?4:5)|0)<(Ft|0)&&mr(23313,23315,245,23324),mu(vt,yt,Hn)|0&&mr(23313,23315,245,23324),Ct=(xt[Hn>>2]|0)+Ft|0,Vt?Ct=22288+(((Ct|0)%5|0)<<2)|0:Ct=22320+(((Ct|0)%6|0)<<2)|0,Ft=xt[Ct>>2]|0,(Ft|0)==7&&mr(23313,23315,245,23324),xt[Pn>>2]=0,Ct=Cs(vt,yt,Ft,Pn,Tn)|0,Ct|0)break;Qt=Tn,Vt=xt[Qt>>2]|0,Qt=xt[Qt+4>>2]|0;do if(Qt>>>0<Nt>>>0|(Qt|0)==(Nt|0)&Vt>>>0<Pt>>>0){if(Es(Vt,Qt)|0?Pt=$a(Vt,Qt,vt,yt)|0:Pt=xt[22384+((((xt[Pn>>2]|0)+(xt[22352+(Ft<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,Ct=Es(Vt,Qt)|0,(Pt+-1|0)>>>0>5){Ct=-1,Pt=Vt,Nt=Qt;break}if(Ct=(Ct|0)!=0,(Pt|0)==1&Ct){Ct=-1,Pt=Vt,Nt=Qt;break}do if(mu(Vt,Qt,Hn)|0)Ct=-1;else if(Ct){Ct=((xt[21936+(Pt<<2)>>2]|0)+5-(xt[Hn>>2]|0)|0)%5|0;break}else{Ct=((xt[21968+(Pt<<2)>>2]|0)+6-(xt[Hn>>2]|0)|0)%6|0;break}while(!1);Pt=Vt,Nt=Qt}else Ct=_t;while(!1);Ft=bn,Qt=xt[Ft>>2]|0,Ft=xt[Ft+4>>2]|0}if((Pt|0)==(Qt|0)&(Nt|0)==(Ft|0)){if(Vt=(Es(Qt,Ft)|0)!=0,Vt?vt=$a(Qt,Ft,vt,yt)|0:vt=xt[22384+((((xt[ur>>2]|0)+(xt[22352+(Bn<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,Ct=Es(Qt,Ft)|0,(vt+-1|0)>>>0<=5&&(Ln=(Ct|0)!=0,!((vt|0)==1&Ln)))do if(mu(Qt,Ft,Hn)|0)Ct=-1;else if(Ln){Ct=((xt[21936+(vt<<2)>>2]|0)+5-(xt[Hn>>2]|0)|0)%5|0;break}else{Ct=((xt[21968+(vt<<2)>>2]|0)+6-(xt[Hn>>2]|0)|0)%6|0;break}while(!1);else Ct=-1;Ct=Ct+1|0,Ct=(Ct|0)==6|Vt&(Ct|0)==5?0:Ct}yt=Nt,vt=Pt;break e}while(!1);return Mt=Ct,fn=Kn,Mt|0}while(!1);return Ln=Cr(Ct|0,0,56)|0,Hn=cn()|0|yt&-2130706433|536870912,xt[Mt>>2]=Ln|vt,xt[Mt+4>>2]=Hn,Mt=0,fn=Kn,Mt|0}function Wp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;return Pt=(Es(vt,yt)|0)==0,Mt=Po(vt,yt,0,_t)|0,Ct=(Mt|0)==0,Pt?!Ct||(Mt=Po(vt,yt,1,_t+8|0)|0,Mt|0)||(Mt=Po(vt,yt,2,_t+16|0)|0,Mt|0)||(Mt=Po(vt,yt,3,_t+24|0)|0,Mt|0)||(Mt=Po(vt,yt,4,_t+32|0)|0,Mt)?(Pt=Mt,Pt|0):Po(vt,yt,5,_t+40|0)|0:!Ct||(Mt=Po(vt,yt,1,_t+8|0)|0,Mt|0)||(Mt=Po(vt,yt,2,_t+16|0)|0,Mt|0)||(Mt=Po(vt,yt,3,_t+24|0)|0,Mt|0)||(Mt=Po(vt,yt,4,_t+32|0)|0,Mt|0)?(Pt=Mt,Pt|0):(Pt=_t+40|0,xt[Pt>>2]=0,xt[Pt+4>>2]=0,Pt=0,Pt|0)}function _h(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;return Vt=fn,fn=fn+192|0,Ct=Vt,Pt=Vt+168|0,Nt=_r(vt|0,yt|0,56)|0,cn()|0,Nt=Nt&7,Ft=yt&-2130706433|134217728,Mt=Xl(vt,Ft,Pt)|0,Mt|0?(Ft=Mt,fn=Vt,Ft|0):(yt=_r(vt|0,yt|0,52)|0,cn()|0,yt=yt&15,Es(vt,Ft)|0?Nl(Pt,yt,Nt,1,Ct):_o(Pt,yt,Nt,1,Ct),Ft=Ct+8|0,xt[_t>>2]=xt[Ft>>2],xt[_t+4>>2]=xt[Ft+4>>2],xt[_t+8>>2]=xt[Ft+8>>2],xt[_t+12>>2]=xt[Ft+12>>2],Ft=0,fn=Vt,Ft|0)}function xm(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0;return Ct=fn,fn=fn+16|0,_t=Ct,!(!0&(yt&2013265920|0)==536870912)||(Mt=yt&-2130706433|134217728,!(Vo(vt,Mt)|0))?(Mt=0,fn=Ct,Mt|0):(Pt=_r(vt|0,yt|0,56)|0,cn()|0,Pt=(Po(vt,Mt,Pt&7,_t)|0)==0,Mt=_t,Mt=Pt&((xt[Mt>>2]|0)==(vt|0)?(xt[Mt+4>>2]|0)==(yt|0):0)&1,fn=Ct,Mt|0)}function Kp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0;(yt|0)>0?(Mt=So(yt,4)|0,xt[vt>>2]=Mt,Mt||mr(23337,23360,40,23374)):xt[vt>>2]=0,xt[vt+4>>2]=yt,xt[vt+8>>2]=0,xt[vt+12>>2]=_t}function Xp(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0;Ct=vt+4|0,Pt=vt+12|0,Nt=vt+8|0;e:for(;;){for(_t=xt[Ct>>2]|0,yt=0;;){if((yt|0)>=(_t|0))break e;if(Mt=xt[vt>>2]|0,Ft=xt[Mt+(yt<<2)>>2]|0,!Ft)yt=yt+1|0;else break}yt=Mt+(~~(+ln(+(+Wn(10,+ +(15-(xt[Pt>>2]|0)|0))*(+mn[Ft>>3]+ +mn[Ft+8>>3])))%+(_t|0))>>>0<<2)|0,_t=xt[yt>>2]|0;t:do if(_t|0){if(Mt=Ft+32|0,(_t|0)==(Ft|0))xt[yt>>2]=xt[Mt>>2];else{if(_t=_t+32|0,yt=xt[_t>>2]|0,!yt)break;for(;(yt|0)!=(Ft|0);)if(_t=yt+32|0,yt=xt[_t>>2]|0,!yt)break t;xt[_t>>2]=xt[Mt>>2]}Qr(Ft),xt[Nt>>2]=(xt[Nt>>2]|0)+-1}while(!1)}Qr(xt[vt>>2]|0)}function _d(vt){vt=vt|0;var yt=0,_t=0,Mt=0;for(Mt=xt[vt+4>>2]|0,_t=0;;){if((_t|0)>=(Mt|0)){yt=0,_t=4;break}if(yt=xt[(xt[vt>>2]|0)+(_t<<2)>>2]|0,!yt)_t=_t+1|0;else{_t=4;break}}return(_t|0)==4?yt|0:0}function _f(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0;if(_t=~~(+ln(+(+Wn(10,+ +(15-(xt[vt+12>>2]|0)|0))*(+mn[yt>>3]+ +mn[yt+8>>3])))%+(xt[vt+4>>2]|0))>>>0,_t=(xt[vt>>2]|0)+(_t<<2)|0,Mt=xt[_t>>2]|0,!Mt)return Pt=1,Pt|0;Pt=yt+32|0;do if((Mt|0)!=(yt|0)){if(_t=xt[Mt+32>>2]|0,!_t)return Pt=1,Pt|0;for(Ct=_t;;){if((Ct|0)==(yt|0)){Ct=8;break}if(_t=xt[Ct+32>>2]|0,_t)Mt=Ct,Ct=_t;else{_t=1,Ct=10;break}}if((Ct|0)==8){xt[Mt+32>>2]=xt[Pt>>2];break}else if((Ct|0)==10)return _t|0}else xt[_t>>2]=xt[Pt>>2];while(!1);return Qr(yt),Pt=vt+8|0,xt[Pt>>2]=(xt[Pt>>2]|0)+-1,Pt=0,Pt|0}function _m(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0;Pt=Ks(40)|0,Pt||mr(23390,23360,98,23403),xt[Pt>>2]=xt[yt>>2],xt[Pt+4>>2]=xt[yt+4>>2],xt[Pt+8>>2]=xt[yt+8>>2],xt[Pt+12>>2]=xt[yt+12>>2],Ct=Pt+16|0,xt[Ct>>2]=xt[_t>>2],xt[Ct+4>>2]=xt[_t+4>>2],xt[Ct+8>>2]=xt[_t+8>>2],xt[Ct+12>>2]=xt[_t+12>>2],xt[Pt+32>>2]=0,Ct=~~(+ln(+(+Wn(10,+ +(15-(xt[vt+12>>2]|0)|0))*(+mn[yt>>3]+ +mn[yt+8>>3])))%+(xt[vt+4>>2]|0))>>>0,Ct=(xt[vt>>2]|0)+(Ct<<2)|0,Mt=xt[Ct>>2]|0;do if(!Mt)xt[Ct>>2]=Pt;else{for(;!(Bl(Mt,yt)|0&&Bl(Mt+16|0,_t)|0);)if(Ct=xt[Mt+32>>2]|0,Mt=Ct|0?Ct:Mt,!(xt[Mt+32>>2]|0)){Nt=10;break}if((Nt|0)==10){xt[Mt+32>>2]=Pt;break}return Qr(Pt),Nt=Mt,Nt|0}while(!1);return Nt=vt+8|0,xt[Nt>>2]=(xt[Nt>>2]|0)+1,Nt=Pt,Nt|0}function Yp(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0;if(Ct=~~(+ln(+(+Wn(10,+ +(15-(xt[vt+12>>2]|0)|0))*(+mn[yt>>3]+ +mn[yt+8>>3])))%+(xt[vt+4>>2]|0))>>>0,Ct=xt[(xt[vt>>2]|0)+(Ct<<2)>>2]|0,!Ct)return _t=0,_t|0;if(!_t){for(vt=Ct;;){if(Bl(vt,yt)|0){Mt=10;break}if(vt=xt[vt+32>>2]|0,!vt){vt=0,Mt=10;break}}if((Mt|0)==10)return vt|0}for(vt=Ct;;){if(Bl(vt,yt)|0&&Bl(vt+16|0,_t)|0){Mt=10;break}if(vt=xt[vt+32>>2]|0,!vt){vt=0,Mt=10;break}}return(Mt|0)==10?vt|0:0}function Qp(vt,yt){vt=vt|0,yt=yt|0;var _t=0;if(_t=~~(+ln(+(+Wn(10,+ +(15-(xt[vt+12>>2]|0)|0))*(+mn[yt>>3]+ +mn[yt+8>>3])))%+(xt[vt+4>>2]|0))>>>0,vt=xt[(xt[vt>>2]|0)+(_t<<2)>>2]|0,!vt)return _t=0,_t|0;for(;;){if(Bl(vt,yt)|0){yt=5;break}if(vt=xt[vt+32>>2]|0,!vt){vt=0,yt=5;break}}return(yt|0)==5?vt|0:0}function Jp(){return 23424}function Zp(vt){return vt=+vt,+ +rp(+vt)}function Cl(vt){return vt=+vt,~~+Zp(vt)|0}function Ks(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0,Bn=0,ur=0,Ln=0,Hn=0,Kn=0,kn=0,$r=0;$r=fn,fn=fn+16|0,Tn=$r;do if(vt>>>0<245){if(Qt=vt>>>0<11?16:vt+11&-8,vt=Qt>>>3,An=xt[5857]|0,_t=An>>>vt,_t&3|0)return yt=(_t&1^1)+vt|0,vt=23468+(yt<<1<<2)|0,_t=vt+8|0,Mt=xt[_t>>2]|0,Ct=Mt+8|0,Pt=xt[Ct>>2]|0,(Pt|0)==(vt|0)?xt[5857]=An&~(1<<yt):(xt[Pt+12>>2]=vt,xt[_t>>2]=Pt),kn=yt<<3,xt[Mt+4>>2]=kn|3,kn=Mt+kn+4|0,xt[kn>>2]=xt[kn>>2]|1,kn=Ct,fn=$r,kn|0;if(on=xt[5859]|0,Qt>>>0>on>>>0){if(_t|0)return yt=2<<vt,yt=_t<<vt&(yt|0-yt),yt=(yt&0-yt)+-1|0,Ft=yt>>>12&16,yt=yt>>>Ft,_t=yt>>>5&8,yt=yt>>>_t,Pt=yt>>>2&4,yt=yt>>>Pt,vt=yt>>>1&2,yt=yt>>>vt,Mt=yt>>>1&1,Mt=(_t|Ft|Pt|vt|Mt)+(yt>>>Mt)|0,yt=23468+(Mt<<1<<2)|0,vt=yt+8|0,Pt=xt[vt>>2]|0,Ft=Pt+8|0,_t=xt[Ft>>2]|0,(_t|0)==(yt|0)?(vt=An&~(1<<Mt),xt[5857]=vt):(xt[_t+12>>2]=yt,xt[vt>>2]=_t,vt=An),kn=Mt<<3,Nt=kn-Qt|0,xt[Pt+4>>2]=Qt|3,Ct=Pt+Qt|0,xt[Ct+4>>2]=Nt|1,xt[Pt+kn>>2]=Nt,on|0&&(Mt=xt[5862]|0,yt=on>>>3,_t=23468+(yt<<1<<2)|0,yt=1<<yt,vt&yt?(vt=_t+8|0,yt=xt[vt>>2]|0):(xt[5857]=vt|yt,yt=_t,vt=_t+8|0),xt[vt>>2]=Mt,xt[yt+12>>2]=Mt,xt[Mt+8>>2]=yt,xt[Mt+12>>2]=_t),xt[5859]=Nt,xt[5862]=Ct,kn=Ft,fn=$r,kn|0;if(Pt=xt[5858]|0,Pt){for(_t=(Pt&0-Pt)+-1|0,Ct=_t>>>12&16,_t=_t>>>Ct,Mt=_t>>>5&8,_t=_t>>>Mt,Nt=_t>>>2&4,_t=_t>>>Nt,Ft=_t>>>1&2,_t=_t>>>Ft,Vt=_t>>>1&1,Vt=xt[23732+((Mt|Ct|Nt|Ft|Vt)+(_t>>>Vt)<<2)>>2]|0,_t=Vt,Ft=Vt,Vt=(xt[Vt+4>>2]&-8)-Qt|0;vt=xt[_t+16>>2]|0,!(!vt&&(vt=xt[_t+20>>2]|0,!vt));)Nt=(xt[vt+4>>2]&-8)-Qt|0,Ct=Nt>>>0<Vt>>>0,_t=vt,Ft=Ct?vt:Ft,Vt=Ct?Nt:Vt;if(Nt=Ft+Qt|0,Nt>>>0>Ft>>>0){Ct=xt[Ft+24>>2]|0,yt=xt[Ft+12>>2]|0;do if((yt|0)==(Ft|0)){if(vt=Ft+20|0,yt=xt[vt>>2]|0,!yt&&(vt=Ft+16|0,yt=xt[vt>>2]|0,!yt)){_t=0;break}for(;;)if(Mt=yt+20|0,_t=xt[Mt>>2]|0,_t)yt=_t,vt=Mt;else if(Mt=yt+16|0,_t=xt[Mt>>2]|0,_t)yt=_t,vt=Mt;else break;xt[vt>>2]=0,_t=yt}else _t=xt[Ft+8>>2]|0,xt[_t+12>>2]=yt,xt[yt+8>>2]=_t,_t=yt;while(!1);do if(Ct|0){if(yt=xt[Ft+28>>2]|0,vt=23732+(yt<<2)|0,(Ft|0)==(xt[vt>>2]|0)){if(xt[vt>>2]=_t,!_t){xt[5858]=Pt&~(1<<yt);break}}else if(kn=Ct+16|0,xt[((xt[kn>>2]|0)==(Ft|0)?kn:Ct+20|0)>>2]=_t,!_t)break;xt[_t+24>>2]=Ct,yt=xt[Ft+16>>2]|0,yt|0&&(xt[_t+16>>2]=yt,xt[yt+24>>2]=_t),yt=xt[Ft+20>>2]|0,yt|0&&(xt[_t+20>>2]=yt,xt[yt+24>>2]=_t)}while(!1);return Vt>>>0<16?(kn=Vt+Qt|0,xt[Ft+4>>2]=kn|3,kn=Ft+kn+4|0,xt[kn>>2]=xt[kn>>2]|1):(xt[Ft+4>>2]=Qt|3,xt[Nt+4>>2]=Vt|1,xt[Nt+Vt>>2]=Vt,on|0&&(Mt=xt[5862]|0,yt=on>>>3,_t=23468+(yt<<1<<2)|0,yt=1<<yt,yt&An?(vt=_t+8|0,yt=xt[vt>>2]|0):(xt[5857]=yt|An,yt=_t,vt=_t+8|0),xt[vt>>2]=Mt,xt[yt+12>>2]=Mt,xt[Mt+8>>2]=yt,xt[Mt+12>>2]=_t),xt[5859]=Vt,xt[5862]=Nt),kn=Ft+8|0,fn=$r,kn|0}else An=Qt}else An=Qt}else An=Qt}else if(vt>>>0<=4294967231)if(vt=vt+11|0,Qt=vt&-8,Mt=xt[5858]|0,Mt){Ct=0-Qt|0,vt=vt>>>8,vt?Qt>>>0>16777215?Vt=31:(An=(vt+1048320|0)>>>16&8,Bn=vt<<An,Ft=(Bn+520192|0)>>>16&4,Bn=Bn<<Ft,Vt=(Bn+245760|0)>>>16&2,Vt=14-(Ft|An|Vt)+(Bn<<Vt>>>15)|0,Vt=Qt>>>(Vt+7|0)&1|Vt<<1):Vt=0,_t=xt[23732+(Vt<<2)>>2]|0;e:do if(!_t)_t=0,vt=0,Bn=61;else for(vt=0,Ft=Qt<<((Vt|0)==31?0:25-(Vt>>>1)|0),Pt=0;;){if(Nt=(xt[_t+4>>2]&-8)-Qt|0,Nt>>>0<Ct>>>0)if(Nt)vt=_t,Ct=Nt;else{vt=_t,Ct=0,Bn=65;break e}if(Bn=xt[_t+20>>2]|0,_t=xt[_t+16+(Ft>>>31<<2)>>2]|0,Pt=(Bn|0)==0|(Bn|0)==(_t|0)?Pt:Bn,_t)Ft=Ft<<1;else{_t=Pt,Bn=61;break}}while(!1);if((Bn|0)==61){if((_t|0)==0&(vt|0)==0){if(vt=2<<Vt,vt=(vt|0-vt)&Mt,!vt){An=Qt;break}An=(vt&0-vt)+-1|0,Nt=An>>>12&16,An=An>>>Nt,Pt=An>>>5&8,An=An>>>Pt,Ft=An>>>2&4,An=An>>>Ft,Vt=An>>>1&2,An=An>>>Vt,_t=An>>>1&1,vt=0,_t=xt[23732+((Pt|Nt|Ft|Vt|_t)+(An>>>_t)<<2)>>2]|0}_t?Bn=65:(Ft=vt,Nt=Ct)}if((Bn|0)==65)for(Pt=_t;;)if(An=(xt[Pt+4>>2]&-8)-Qt|0,_t=An>>>0<Ct>>>0,Ct=_t?An:Ct,vt=_t?Pt:vt,_t=xt[Pt+16>>2]|0,_t||(_t=xt[Pt+20>>2]|0),_t)Pt=_t;else{Ft=vt,Nt=Ct;break}if(Ft|0&&Nt>>>0<((xt[5859]|0)-Qt|0)>>>0&&(on=Ft+Qt|0,on>>>0>Ft>>>0)){Pt=xt[Ft+24>>2]|0,yt=xt[Ft+12>>2]|0;do if((yt|0)==(Ft|0)){if(vt=Ft+20|0,yt=xt[vt>>2]|0,!yt&&(vt=Ft+16|0,yt=xt[vt>>2]|0,!yt)){yt=0;break}for(;;)if(Ct=yt+20|0,_t=xt[Ct>>2]|0,_t)yt=_t,vt=Ct;else if(Ct=yt+16|0,_t=xt[Ct>>2]|0,_t)yt=_t,vt=Ct;else break;xt[vt>>2]=0}else kn=xt[Ft+8>>2]|0,xt[kn+12>>2]=yt,xt[yt+8>>2]=kn;while(!1);do if(Pt){if(vt=xt[Ft+28>>2]|0,_t=23732+(vt<<2)|0,(Ft|0)==(xt[_t>>2]|0)){if(xt[_t>>2]=yt,!yt){Mt=Mt&~(1<<vt),xt[5858]=Mt;break}}else if(kn=Pt+16|0,xt[((xt[kn>>2]|0)==(Ft|0)?kn:Pt+20|0)>>2]=yt,!yt)break;xt[yt+24>>2]=Pt,vt=xt[Ft+16>>2]|0,vt|0&&(xt[yt+16>>2]=vt,xt[vt+24>>2]=yt),vt=xt[Ft+20>>2]|0,vt&&(xt[yt+20>>2]=vt,xt[vt+24>>2]=yt)}while(!1);e:do if(Nt>>>0<16)kn=Nt+Qt|0,xt[Ft+4>>2]=kn|3,kn=Ft+kn+4|0,xt[kn>>2]=xt[kn>>2]|1;else{if(xt[Ft+4>>2]=Qt|3,xt[on+4>>2]=Nt|1,xt[on+Nt>>2]=Nt,yt=Nt>>>3,Nt>>>0<256){_t=23468+(yt<<1<<2)|0,vt=xt[5857]|0,yt=1<<yt,vt&yt?(vt=_t+8|0,yt=xt[vt>>2]|0):(xt[5857]=vt|yt,yt=_t,vt=_t+8|0),xt[vt>>2]=on,xt[yt+12>>2]=on,xt[on+8>>2]=yt,xt[on+12>>2]=_t;break}if(yt=Nt>>>8,yt?Nt>>>0>16777215?_t=31:(Kn=(yt+1048320|0)>>>16&8,kn=yt<<Kn,Hn=(kn+520192|0)>>>16&4,kn=kn<<Hn,_t=(kn+245760|0)>>>16&2,_t=14-(Hn|Kn|_t)+(kn<<_t>>>15)|0,_t=Nt>>>(_t+7|0)&1|_t<<1):_t=0,yt=23732+(_t<<2)|0,xt[on+28>>2]=_t,vt=on+16|0,xt[vt+4>>2]=0,xt[vt>>2]=0,vt=1<<_t,!(Mt&vt)){xt[5858]=Mt|vt,xt[yt>>2]=on,xt[on+24>>2]=yt,xt[on+12>>2]=on,xt[on+8>>2]=on;break}yt=xt[yt>>2]|0;t:do if((xt[yt+4>>2]&-8|0)!=(Nt|0)){for(Mt=Nt<<((_t|0)==31?0:25-(_t>>>1)|0);_t=yt+16+(Mt>>>31<<2)|0,vt=xt[_t>>2]|0,!!vt;)if((xt[vt+4>>2]&-8|0)==(Nt|0)){yt=vt;break t}else Mt=Mt<<1,yt=vt;xt[_t>>2]=on,xt[on+24>>2]=yt,xt[on+12>>2]=on,xt[on+8>>2]=on;break e}while(!1);Kn=yt+8|0,kn=xt[Kn>>2]|0,xt[kn+12>>2]=on,xt[Kn>>2]=on,xt[on+8>>2]=kn,xt[on+12>>2]=yt,xt[on+24>>2]=0}while(!1);return kn=Ft+8|0,fn=$r,kn|0}else An=Qt}else An=Qt;else An=-1;while(!1);if(_t=xt[5859]|0,_t>>>0>=An>>>0)return yt=_t-An|0,vt=xt[5862]|0,yt>>>0>15?(kn=vt+An|0,xt[5862]=kn,xt[5859]=yt,xt[kn+4>>2]=yt|1,xt[vt+_t>>2]=yt,xt[vt+4>>2]=An|3):(xt[5859]=0,xt[5862]=0,xt[vt+4>>2]=_t|3,kn=vt+_t+4|0,xt[kn>>2]=xt[kn>>2]|1),kn=vt+8|0,fn=$r,kn|0;if(Nt=xt[5860]|0,Nt>>>0>An>>>0)return Hn=Nt-An|0,xt[5860]=Hn,kn=xt[5863]|0,Kn=kn+An|0,xt[5863]=Kn,xt[Kn+4>>2]=Hn|1,xt[kn+4>>2]=An|3,kn=kn+8|0,fn=$r,kn|0;if(xt[5975]|0?vt=xt[5977]|0:(xt[5977]=4096,xt[5976]=4096,xt[5978]=-1,xt[5979]=-1,xt[5980]=0,xt[5968]=0,xt[5975]=Tn&-16^1431655768,vt=4096),Ft=An+48|0,Vt=An+47|0,Pt=vt+Vt|0,Ct=0-vt|0,Qt=Pt&Ct,Qt>>>0<=An>>>0||(vt=xt[5967]|0,vt|0&&(on=xt[5965]|0,Tn=on+Qt|0,Tn>>>0<=on>>>0|Tn>>>0>vt>>>0)))return kn=0,fn=$r,kn|0;e:do if(xt[5968]&4)yt=0,Bn=143;else{_t=xt[5863]|0;t:do if(_t){for(Mt=23876;Tn=xt[Mt>>2]|0,!(Tn>>>0<=_t>>>0&&(Tn+(xt[Mt+4>>2]|0)|0)>>>0>_t>>>0);)if(vt=xt[Mt+8>>2]|0,vt)Mt=vt;else{Bn=128;break t}if(yt=Pt-Nt&Ct,yt>>>0<2147483647)if(vt=Rl(yt|0)|0,(vt|0)==((xt[Mt>>2]|0)+(xt[Mt+4>>2]|0)|0)){if((vt|0)!=-1){Nt=yt,Pt=vt,Bn=145;break e}}else Mt=vt,Bn=136;else yt=0}else Bn=128;while(!1);do if((Bn|0)==128)if(_t=Rl(0)|0,(_t|0)!=-1&&(yt=_t,Pn=xt[5976]|0,bn=Pn+-1|0,yt=(bn&yt|0?(bn+yt&0-Pn)-yt|0:0)+Qt|0,Pn=xt[5965]|0,bn=yt+Pn|0,yt>>>0>An>>>0&yt>>>0<2147483647)){if(Tn=xt[5967]|0,Tn|0&&bn>>>0<=Pn>>>0|bn>>>0>Tn>>>0){yt=0;break}if(vt=Rl(yt|0)|0,(vt|0)==(_t|0)){Nt=yt,Pt=_t,Bn=145;break e}else Mt=vt,Bn=136}else yt=0;while(!1);do if((Bn|0)==136){if(_t=0-yt|0,!(Ft>>>0>yt>>>0&(yt>>>0<2147483647&(Mt|0)!=-1)))if((Mt|0)==-1){yt=0;break}else{Nt=yt,Pt=Mt,Bn=145;break e}if(vt=xt[5977]|0,vt=Vt-yt+vt&0-vt,vt>>>0>=2147483647){Nt=yt,Pt=Mt,Bn=145;break e}if((Rl(vt|0)|0)==-1){Rl(_t|0)|0,yt=0;break}else{Nt=vt+yt|0,Pt=Mt,Bn=145;break e}}while(!1);xt[5968]=xt[5968]|4,Bn=143}while(!1);if((Bn|0)==143&&Qt>>>0<2147483647&&(Hn=Rl(Qt|0)|0,bn=Rl(0)|0,ur=bn-Hn|0,Ln=ur>>>0>(An+40|0)>>>0,!((Hn|0)==-1|Ln^1|Hn>>>0<bn>>>0&((Hn|0)!=-1&(bn|0)!=-1)^1))&&(Nt=Ln?ur:yt,Pt=Hn,Bn=145),(Bn|0)==145){yt=(xt[5965]|0)+Nt|0,xt[5965]=yt,yt>>>0>(xt[5966]|0)>>>0&&(xt[5966]=yt),Vt=xt[5863]|0;e:do if(Vt){for(yt=23876;;){if(vt=xt[yt>>2]|0,_t=xt[yt+4>>2]|0,(Pt|0)==(vt+_t|0)){Bn=154;break}if(Mt=xt[yt+8>>2]|0,Mt)yt=Mt;else break}if((Bn|0)==154&&(Kn=yt+4|0,(xt[yt+12>>2]&8|0)==0)&&Pt>>>0>Vt>>>0&vt>>>0<=Vt>>>0){xt[Kn>>2]=_t+Nt,kn=(xt[5860]|0)+Nt|0,Hn=Vt+8|0,Hn=Hn&7|0?0-Hn&7:0,Kn=Vt+Hn|0,Hn=kn-Hn|0,xt[5863]=Kn,xt[5860]=Hn,xt[Kn+4>>2]=Hn|1,xt[Vt+kn+4>>2]=40,xt[5864]=xt[5979];break}for(Pt>>>0<(xt[5861]|0)>>>0&&(xt[5861]=Pt),_t=Pt+Nt|0,yt=23876;;){if((xt[yt>>2]|0)==(_t|0)){Bn=162;break}if(vt=xt[yt+8>>2]|0,vt)yt=vt;else break}if((Bn|0)==162&&!(xt[yt+12>>2]&8|0)){xt[yt>>2]=Pt,on=yt+4|0,xt[on>>2]=(xt[on>>2]|0)+Nt,on=Pt+8|0,on=Pt+(on&7|0?0-on&7:0)|0,yt=_t+8|0,yt=_t+(yt&7|0?0-yt&7:0)|0,Qt=on+An|0,Ft=yt-on-An|0,xt[on+4>>2]=An|3;t:do if((Vt|0)==(yt|0))kn=(xt[5860]|0)+Ft|0,xt[5860]=kn,xt[5863]=Qt,xt[Qt+4>>2]=kn|1;else{if((xt[5862]|0)==(yt|0)){kn=(xt[5859]|0)+Ft|0,xt[5859]=kn,xt[5862]=Qt,xt[Qt+4>>2]=kn|1,xt[Qt+kn>>2]=kn;break}if(vt=xt[yt+4>>2]|0,(vt&3|0)==1){Nt=vt&-8,Mt=vt>>>3;n:do if(vt>>>0<256)if(vt=xt[yt+8>>2]|0,_t=xt[yt+12>>2]|0,(_t|0)==(vt|0)){xt[5857]=xt[5857]&~(1<<Mt);break}else{xt[vt+12>>2]=_t,xt[_t+8>>2]=vt;break}else{Pt=xt[yt+24>>2]|0,vt=xt[yt+12>>2]|0;do if((vt|0)==(yt|0)){if(_t=yt+16|0,Mt=_t+4|0,vt=xt[Mt>>2]|0,vt)_t=Mt;else if(vt=xt[_t>>2]|0,!vt){vt=0;break}for(;;)if(Ct=vt+20|0,Mt=xt[Ct>>2]|0,Mt)vt=Mt,_t=Ct;else if(Ct=vt+16|0,Mt=xt[Ct>>2]|0,Mt)vt=Mt,_t=Ct;else break;xt[_t>>2]=0}else kn=xt[yt+8>>2]|0,xt[kn+12>>2]=vt,xt[vt+8>>2]=kn;while(!1);if(!Pt)break;_t=xt[yt+28>>2]|0,Mt=23732+(_t<<2)|0;do if((xt[Mt>>2]|0)!=(yt|0)){if(kn=Pt+16|0,xt[((xt[kn>>2]|0)==(yt|0)?kn:Pt+20|0)>>2]=vt,!vt)break n}else{if(xt[Mt>>2]=vt,vt|0)break;xt[5858]=xt[5858]&~(1<<_t);break n}while(!1);if(xt[vt+24>>2]=Pt,_t=yt+16|0,Mt=xt[_t>>2]|0,Mt|0&&(xt[vt+16>>2]=Mt,xt[Mt+24>>2]=vt),_t=xt[_t+4>>2]|0,!_t)break;xt[vt+20>>2]=_t,xt[_t+24>>2]=vt}while(!1);yt=yt+Nt|0,Ct=Nt+Ft|0}else Ct=Ft;if(yt=yt+4|0,xt[yt>>2]=xt[yt>>2]&-2,xt[Qt+4>>2]=Ct|1,xt[Qt+Ct>>2]=Ct,yt=Ct>>>3,Ct>>>0<256){_t=23468+(yt<<1<<2)|0,vt=xt[5857]|0,yt=1<<yt,vt&yt?(vt=_t+8|0,yt=xt[vt>>2]|0):(xt[5857]=vt|yt,yt=_t,vt=_t+8|0),xt[vt>>2]=Qt,xt[yt+12>>2]=Qt,xt[Qt+8>>2]=yt,xt[Qt+12>>2]=_t;break}yt=Ct>>>8;do if(!yt)Mt=0;else{if(Ct>>>0>16777215){Mt=31;break}Kn=(yt+1048320|0)>>>16&8,kn=yt<<Kn,Hn=(kn+520192|0)>>>16&4,kn=kn<<Hn,Mt=(kn+245760|0)>>>16&2,Mt=14-(Hn|Kn|Mt)+(kn<<Mt>>>15)|0,Mt=Ct>>>(Mt+7|0)&1|Mt<<1}while(!1);if(yt=23732+(Mt<<2)|0,xt[Qt+28>>2]=Mt,vt=Qt+16|0,xt[vt+4>>2]=0,xt[vt>>2]=0,vt=xt[5858]|0,_t=1<<Mt,!(vt&_t)){xt[5858]=vt|_t,xt[yt>>2]=Qt,xt[Qt+24>>2]=yt,xt[Qt+12>>2]=Qt,xt[Qt+8>>2]=Qt;break}yt=xt[yt>>2]|0;n:do if((xt[yt+4>>2]&-8|0)!=(Ct|0)){for(Mt=Ct<<((Mt|0)==31?0:25-(Mt>>>1)|0);_t=yt+16+(Mt>>>31<<2)|0,vt=xt[_t>>2]|0,!!vt;)if((xt[vt+4>>2]&-8|0)==(Ct|0)){yt=vt;break n}else Mt=Mt<<1,yt=vt;xt[_t>>2]=Qt,xt[Qt+24>>2]=yt,xt[Qt+12>>2]=Qt,xt[Qt+8>>2]=Qt;break t}while(!1);Kn=yt+8|0,kn=xt[Kn>>2]|0,xt[kn+12>>2]=Qt,xt[Kn>>2]=Qt,xt[Qt+8>>2]=kn,xt[Qt+12>>2]=yt,xt[Qt+24>>2]=0}while(!1);return kn=on+8|0,fn=$r,kn|0}for(yt=23876;vt=xt[yt>>2]|0,!(vt>>>0<=Vt>>>0&&(kn=vt+(xt[yt+4>>2]|0)|0,kn>>>0>Vt>>>0));)yt=xt[yt+8>>2]|0;Ct=kn+-47|0,vt=Ct+8|0,vt=Ct+(vt&7|0?0-vt&7:0)|0,Ct=Vt+16|0,vt=vt>>>0<Ct>>>0?Vt:vt,yt=vt+8|0,_t=Nt+-40|0,Hn=Pt+8|0,Hn=Hn&7|0?0-Hn&7:0,Kn=Pt+Hn|0,Hn=_t-Hn|0,xt[5863]=Kn,xt[5860]=Hn,xt[Kn+4>>2]=Hn|1,xt[Pt+_t+4>>2]=40,xt[5864]=xt[5979],_t=vt+4|0,xt[_t>>2]=27,xt[yt>>2]=xt[5969],xt[yt+4>>2]=xt[5970],xt[yt+8>>2]=xt[5971],xt[yt+12>>2]=xt[5972],xt[5969]=Pt,xt[5970]=Nt,xt[5972]=0,xt[5971]=yt,yt=vt+24|0;do Kn=yt,yt=yt+4|0,xt[yt>>2]=7;while((Kn+8|0)>>>0<kn>>>0);if((vt|0)!=(Vt|0)){if(Pt=vt-Vt|0,xt[_t>>2]=xt[_t>>2]&-2,xt[Vt+4>>2]=Pt|1,xt[vt>>2]=Pt,yt=Pt>>>3,Pt>>>0<256){_t=23468+(yt<<1<<2)|0,vt=xt[5857]|0,yt=1<<yt,vt&yt?(vt=_t+8|0,yt=xt[vt>>2]|0):(xt[5857]=vt|yt,yt=_t,vt=_t+8|0),xt[vt>>2]=Vt,xt[yt+12>>2]=Vt,xt[Vt+8>>2]=yt,xt[Vt+12>>2]=_t;break}if(yt=Pt>>>8,yt?Pt>>>0>16777215?Mt=31:(Kn=(yt+1048320|0)>>>16&8,kn=yt<<Kn,Hn=(kn+520192|0)>>>16&4,kn=kn<<Hn,Mt=(kn+245760|0)>>>16&2,Mt=14-(Hn|Kn|Mt)+(kn<<Mt>>>15)|0,Mt=Pt>>>(Mt+7|0)&1|Mt<<1):Mt=0,_t=23732+(Mt<<2)|0,xt[Vt+28>>2]=Mt,xt[Vt+20>>2]=0,xt[Ct>>2]=0,yt=xt[5858]|0,vt=1<<Mt,!(yt&vt)){xt[5858]=yt|vt,xt[_t>>2]=Vt,xt[Vt+24>>2]=_t,xt[Vt+12>>2]=Vt,xt[Vt+8>>2]=Vt;break}yt=xt[_t>>2]|0;t:do if((xt[yt+4>>2]&-8|0)!=(Pt|0)){for(Mt=Pt<<((Mt|0)==31?0:25-(Mt>>>1)|0);_t=yt+16+(Mt>>>31<<2)|0,vt=xt[_t>>2]|0,!!vt;)if((xt[vt+4>>2]&-8|0)==(Pt|0)){yt=vt;break t}else Mt=Mt<<1,yt=vt;xt[_t>>2]=Vt,xt[Vt+24>>2]=yt,xt[Vt+12>>2]=Vt,xt[Vt+8>>2]=Vt;break e}while(!1);Kn=yt+8|0,kn=xt[Kn>>2]|0,xt[kn+12>>2]=Vt,xt[Kn>>2]=Vt,xt[Vt+8>>2]=kn,xt[Vt+12>>2]=yt,xt[Vt+24>>2]=0}}else kn=xt[5861]|0,(kn|0)==0|Pt>>>0<kn>>>0&&(xt[5861]=Pt),xt[5969]=Pt,xt[5970]=Nt,xt[5972]=0,xt[5866]=xt[5975],xt[5865]=-1,xt[5870]=23468,xt[5869]=23468,xt[5872]=23476,xt[5871]=23476,xt[5874]=23484,xt[5873]=23484,xt[5876]=23492,xt[5875]=23492,xt[5878]=23500,xt[5877]=23500,xt[5880]=23508,xt[5879]=23508,xt[5882]=23516,xt[5881]=23516,xt[5884]=23524,xt[5883]=23524,xt[5886]=23532,xt[5885]=23532,xt[5888]=23540,xt[5887]=23540,xt[5890]=23548,xt[5889]=23548,xt[5892]=23556,xt[5891]=23556,xt[5894]=23564,xt[5893]=23564,xt[5896]=23572,xt[5895]=23572,xt[5898]=23580,xt[5897]=23580,xt[5900]=23588,xt[5899]=23588,xt[5902]=23596,xt[5901]=23596,xt[5904]=23604,xt[5903]=23604,xt[5906]=23612,xt[5905]=23612,xt[5908]=23620,xt[5907]=23620,xt[5910]=23628,xt[5909]=23628,xt[5912]=23636,xt[5911]=23636,xt[5914]=23644,xt[5913]=23644,xt[5916]=23652,xt[5915]=23652,xt[5918]=23660,xt[5917]=23660,xt[5920]=23668,xt[5919]=23668,xt[5922]=23676,xt[5921]=23676,xt[5924]=23684,xt[5923]=23684,xt[5926]=23692,xt[5925]=23692,xt[5928]=23700,xt[5927]=23700,xt[5930]=23708,xt[5929]=23708,xt[5932]=23716,xt[5931]=23716,kn=Nt+-40|0,Hn=Pt+8|0,Hn=Hn&7|0?0-Hn&7:0,Kn=Pt+Hn|0,Hn=kn-Hn|0,xt[5863]=Kn,xt[5860]=Hn,xt[Kn+4>>2]=Hn|1,xt[Pt+kn+4>>2]=40,xt[5864]=xt[5979];while(!1);if(yt=xt[5860]|0,yt>>>0>An>>>0)return Hn=yt-An|0,xt[5860]=Hn,kn=xt[5863]|0,Kn=kn+An|0,xt[5863]=Kn,xt[Kn+4>>2]=Hn|1,xt[kn+4>>2]=An|3,kn=kn+8|0,fn=$r,kn|0}return kn=Jp()|0,xt[kn>>2]=12,kn=0,fn=$r,kn|0}function Qr(vt){vt=vt|0;var yt=0,_t=0,Mt=0,Ct=0,Pt=0,Nt=0,Ft=0,Vt=0;if(vt){_t=vt+-8|0,Ct=xt[5861]|0,vt=xt[vt+-4>>2]|0,yt=vt&-8,Vt=_t+yt|0;do if(vt&1)Ft=_t,Nt=_t;else{if(Mt=xt[_t>>2]|0,!(vt&3)||(Nt=_t+(0-Mt)|0,Pt=Mt+yt|0,Nt>>>0<Ct>>>0))return;if((xt[5862]|0)==(Nt|0)){if(vt=Vt+4|0,yt=xt[vt>>2]|0,(yt&3|0)!=3){Ft=Nt,yt=Pt;break}xt[5859]=Pt,xt[vt>>2]=yt&-2,xt[Nt+4>>2]=Pt|1,xt[Nt+Pt>>2]=Pt;return}if(_t=Mt>>>3,Mt>>>0<256)if(vt=xt[Nt+8>>2]|0,yt=xt[Nt+12>>2]|0,(yt|0)==(vt|0)){xt[5857]=xt[5857]&~(1<<_t),Ft=Nt,yt=Pt;break}else{xt[vt+12>>2]=yt,xt[yt+8>>2]=vt,Ft=Nt,yt=Pt;break}Ct=xt[Nt+24>>2]|0,vt=xt[Nt+12>>2]|0;do if((vt|0)==(Nt|0)){if(yt=Nt+16|0,_t=yt+4|0,vt=xt[_t>>2]|0,vt)yt=_t;else if(vt=xt[yt>>2]|0,!vt){vt=0;break}for(;;)if(Mt=vt+20|0,_t=xt[Mt>>2]|0,_t)vt=_t,yt=Mt;else if(Mt=vt+16|0,_t=xt[Mt>>2]|0,_t)vt=_t,yt=Mt;else break;xt[yt>>2]=0}else Ft=xt[Nt+8>>2]|0,xt[Ft+12>>2]=vt,xt[vt+8>>2]=Ft;while(!1);if(Ct){if(yt=xt[Nt+28>>2]|0,_t=23732+(yt<<2)|0,(xt[_t>>2]|0)==(Nt|0)){if(xt[_t>>2]=vt,!vt){xt[5858]=xt[5858]&~(1<<yt),Ft=Nt,yt=Pt;break}}else if(Ft=Ct+16|0,xt[((xt[Ft>>2]|0)==(Nt|0)?Ft:Ct+20|0)>>2]=vt,!vt){Ft=Nt,yt=Pt;break}xt[vt+24>>2]=Ct,yt=Nt+16|0,_t=xt[yt>>2]|0,_t|0&&(xt[vt+16>>2]=_t,xt[_t+24>>2]=vt),yt=xt[yt+4>>2]|0,yt?(xt[vt+20>>2]=yt,xt[yt+24>>2]=vt,Ft=Nt,yt=Pt):(Ft=Nt,yt=Pt)}else Ft=Nt,yt=Pt}while(!1);if(!(Nt>>>0>=Vt>>>0)&&(vt=Vt+4|0,Mt=xt[vt>>2]|0,!!(Mt&1))){if(Mt&2)xt[vt>>2]=Mt&-2,xt[Ft+4>>2]=yt|1,xt[Nt+yt>>2]=yt,Ct=yt;else{if((xt[5863]|0)==(Vt|0)){if(Vt=(xt[5860]|0)+yt|0,xt[5860]=Vt,xt[5863]=Ft,xt[Ft+4>>2]=Vt|1,(Ft|0)!=(xt[5862]|0))return;xt[5862]=0,xt[5859]=0;return}if((xt[5862]|0)==(Vt|0)){Vt=(xt[5859]|0)+yt|0,xt[5859]=Vt,xt[5862]=Nt,xt[Ft+4>>2]=Vt|1,xt[Nt+Vt>>2]=Vt;return}Ct=(Mt&-8)+yt|0,_t=Mt>>>3;do if(Mt>>>0<256)if(yt=xt[Vt+8>>2]|0,vt=xt[Vt+12>>2]|0,(vt|0)==(yt|0)){xt[5857]=xt[5857]&~(1<<_t);break}else{xt[yt+12>>2]=vt,xt[vt+8>>2]=yt;break}else{Pt=xt[Vt+24>>2]|0,vt=xt[Vt+12>>2]|0;do if((vt|0)==(Vt|0)){if(yt=Vt+16|0,_t=yt+4|0,vt=xt[_t>>2]|0,vt)yt=_t;else if(vt=xt[yt>>2]|0,!vt){_t=0;break}for(;;)if(Mt=vt+20|0,_t=xt[Mt>>2]|0,_t)vt=_t,yt=Mt;else if(Mt=vt+16|0,_t=xt[Mt>>2]|0,_t)vt=_t,yt=Mt;else break;xt[yt>>2]=0,_t=vt}else _t=xt[Vt+8>>2]|0,xt[_t+12>>2]=vt,xt[vt+8>>2]=_t,_t=vt;while(!1);if(Pt|0){if(vt=xt[Vt+28>>2]|0,yt=23732+(vt<<2)|0,(xt[yt>>2]|0)==(Vt|0)){if(xt[yt>>2]=_t,!_t){xt[5858]=xt[5858]&~(1<<vt);break}}else if(Mt=Pt+16|0,xt[((xt[Mt>>2]|0)==(Vt|0)?Mt:Pt+20|0)>>2]=_t,!_t)break;xt[_t+24>>2]=Pt,vt=Vt+16|0,yt=xt[vt>>2]|0,yt|0&&(xt[_t+16>>2]=yt,xt[yt+24>>2]=_t),vt=xt[vt+4>>2]|0,vt|0&&(xt[_t+20>>2]=vt,xt[vt+24>>2]=_t)}}while(!1);if(xt[Ft+4>>2]=Ct|1,xt[Nt+Ct>>2]=Ct,(Ft|0)==(xt[5862]|0)){xt[5859]=Ct;return}}if(vt=Ct>>>3,Ct>>>0<256){_t=23468+(vt<<1<<2)|0,yt=xt[5857]|0,vt=1<<vt,yt&vt?(yt=_t+8|0,vt=xt[yt>>2]|0):(xt[5857]=yt|vt,vt=_t,yt=_t+8|0),xt[yt>>2]=Ft,xt[vt+12>>2]=Ft,xt[Ft+8>>2]=vt,xt[Ft+12>>2]=_t;return}vt=Ct>>>8,vt?Ct>>>0>16777215?Mt=31:(Nt=(vt+1048320|0)>>>16&8,Vt=vt<<Nt,Pt=(Vt+520192|0)>>>16&4,Vt=Vt<<Pt,Mt=(Vt+245760|0)>>>16&2,Mt=14-(Pt|Nt|Mt)+(Vt<<Mt>>>15)|0,Mt=Ct>>>(Mt+7|0)&1|Mt<<1):Mt=0,vt=23732+(Mt<<2)|0,xt[Ft+28>>2]=Mt,xt[Ft+20>>2]=0,xt[Ft+16>>2]=0,yt=xt[5858]|0,_t=1<<Mt;e:do if(!(yt&_t))xt[5858]=yt|_t,xt[vt>>2]=Ft,xt[Ft+24>>2]=vt,xt[Ft+12>>2]=Ft,xt[Ft+8>>2]=Ft;else{vt=xt[vt>>2]|0;t:do if((xt[vt+4>>2]&-8|0)!=(Ct|0)){for(Mt=Ct<<((Mt|0)==31?0:25-(Mt>>>1)|0);_t=vt+16+(Mt>>>31<<2)|0,yt=xt[_t>>2]|0,!!yt;)if((xt[yt+4>>2]&-8|0)==(Ct|0)){vt=yt;break t}else Mt=Mt<<1,vt=yt;xt[_t>>2]=Ft,xt[Ft+24>>2]=vt,xt[Ft+12>>2]=Ft,xt[Ft+8>>2]=Ft;break e}while(!1);Nt=vt+8|0,Vt=xt[Nt>>2]|0,xt[Vt+12>>2]=Ft,xt[Nt>>2]=Ft,xt[Ft+8>>2]=Vt,xt[Ft+12>>2]=vt,xt[Ft+24>>2]=0}while(!1);if(Vt=(xt[5865]|0)+-1|0,xt[5865]=Vt,!(Vt|0)){for(vt=23884;vt=xt[vt>>2]|0,vt;)vt=vt+8|0;xt[5865]=-1}}}}function So(vt,yt){vt=vt|0,yt=yt|0;var _t=0;return vt?(_t=kr(yt,vt)|0,(yt|vt)>>>0>65535&&(_t=((_t>>>0)/(vt>>>0)|0|0)==(yt|0)?_t:-1)):_t=0,vt=Ks(_t)|0,!vt||!(xt[vt+-4>>2]&3)||Ol(vt|0,0,_t|0)|0,vt|0}function ts(vt,yt,_t,Mt){return vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,_t=vt+_t>>>0,wr(yt+Mt+(_t>>>0<vt>>>0|0)>>>0|0),_t|0|0}function Xs(vt,yt,_t,Mt){return vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Mt=yt-Mt-(_t>>>0>vt>>>0|0)>>>0,wr(Mt|0),vt-_t>>>0|0|0}function Nu(vt){return vt=vt|0,(vt?31-(ns(vt^vt-1)|0)|0:32)|0}function ep(vt,yt,_t,Mt,Ct){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0,Ct=Ct|0;var Pt=0,Nt=0,Ft=0,Vt=0,Qt=0,on=0,An=0,Tn=0,Pn=0,bn=0;if(on=vt,Vt=yt,Qt=Vt,Nt=_t,Tn=Mt,Ft=Tn,!Qt)return Pt=(Ct|0)!=0,Ft?Pt?(xt[Ct>>2]=vt|0,xt[Ct+4>>2]=yt&0,Tn=0,Ct=0,wr(Tn|0),Ct|0):(Tn=0,Ct=0,wr(Tn|0),Ct|0):(Pt&&(xt[Ct>>2]=(on>>>0)%(Nt>>>0),xt[Ct+4>>2]=0),Tn=0,Ct=(on>>>0)/(Nt>>>0)>>>0,wr(Tn|0),Ct|0);Pt=(Ft|0)==0;do if(Nt){if(!Pt){if(Pt=(ns(Ft|0)|0)-(ns(Qt|0)|0)|0,Pt>>>0<=31){An=Pt+1|0,Ft=31-Pt|0,yt=Pt-31>>31,Nt=An,vt=on>>>(An>>>0)&yt|Qt<<Ft,yt=Qt>>>(An>>>0)&yt,Pt=0,Ft=on<<Ft;break}return Ct?(xt[Ct>>2]=vt|0,xt[Ct+4>>2]=Vt|yt&0,Tn=0,Ct=0,wr(Tn|0),Ct|0):(Tn=0,Ct=0,wr(Tn|0),Ct|0)}if(Pt=Nt-1|0,Pt&Nt|0){Ft=(ns(Nt|0)|0)+33-(ns(Qt|0)|0)|0,bn=64-Ft|0,An=32-Ft|0,Vt=An>>31,Pn=Ft-32|0,yt=Pn>>31,Nt=Ft,vt=An-1>>31&Qt>>>(Pn>>>0)|(Qt<<An|on>>>(Ft>>>0))&yt,yt=yt&Qt>>>(Ft>>>0),Pt=on<<bn&Vt,Ft=(Qt<<bn|on>>>(Pn>>>0))&Vt|on<<An&Ft-33>>31;break}return Ct|0&&(xt[Ct>>2]=Pt&on,xt[Ct+4>>2]=0),(Nt|0)==1?(Pn=Vt|yt&0,bn=vt|0|0,wr(Pn|0),bn|0):(bn=Nu(Nt|0)|0,Pn=Qt>>>(bn>>>0)|0,bn=Qt<<32-bn|on>>>(bn>>>0)|0,wr(Pn|0),bn|0)}else{if(Pt)return Ct|0&&(xt[Ct>>2]=(Qt>>>0)%(Nt>>>0),xt[Ct+4>>2]=0),Pn=0,bn=(Qt>>>0)/(Nt>>>0)>>>0,wr(Pn|0),bn|0;if(!on)return Ct|0&&(xt[Ct>>2]=0,xt[Ct+4>>2]=(Qt>>>0)%(Ft>>>0)),Pn=0,bn=(Qt>>>0)/(Ft>>>0)>>>0,wr(Pn|0),bn|0;if(Pt=Ft-1|0,!(Pt&Ft))return Ct|0&&(xt[Ct>>2]=vt|0,xt[Ct+4>>2]=Pt&Qt|yt&0),Pn=0,bn=Qt>>>((Nu(Ft|0)|0)>>>0),wr(Pn|0),bn|0;if(Pt=(ns(Ft|0)|0)-(ns(Qt|0)|0)|0,Pt>>>0<=30){yt=Pt+1|0,Ft=31-Pt|0,Nt=yt,vt=Qt<<Ft|on>>>(yt>>>0),yt=Qt>>>(yt>>>0),Pt=0,Ft=on<<Ft;break}return Ct?(xt[Ct>>2]=vt|0,xt[Ct+4>>2]=Vt|yt&0,Pn=0,bn=0,wr(Pn|0),bn|0):(Pn=0,bn=0,wr(Pn|0),bn|0)}while(!1);if(!Nt)Qt=Ft,Vt=0,Ft=0;else{An=_t|0|0,on=Tn|Mt&0,Qt=ts(An|0,on|0,-1,-1)|0,_t=cn()|0,Vt=Ft,Ft=0;do Mt=Vt,Vt=Pt>>>31|Vt<<1,Pt=Ft|Pt<<1,Mt=vt<<1|Mt>>>31|0,Tn=vt>>>31|yt<<1|0,Xs(Qt|0,_t|0,Mt|0,Tn|0)|0,bn=cn()|0,Pn=bn>>31|((bn|0)<0?-1:0)<<1,Ft=Pn&1,vt=Xs(Mt|0,Tn|0,Pn&An|0,(((bn|0)<0?-1:0)>>31|((bn|0)<0?-1:0)<<1)&on|0)|0,yt=cn()|0,Nt=Nt-1|0;while(Nt|0);Qt=Vt,Vt=0}return Nt=0,Ct|0&&(xt[Ct>>2]=vt,xt[Ct+4>>2]=yt),Pn=(Pt|0)>>>31|(Qt|Nt)<<1|(Nt<<1|Pt>>>31)&0|Vt,bn=(Pt<<1|0)&-2|Ft,wr(Pn|0),bn|0}function jo(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;return Qt=yt>>31|((yt|0)<0?-1:0)<<1,Vt=((yt|0)<0?-1:0)>>31|((yt|0)<0?-1:0)<<1,Pt=Mt>>31|((Mt|0)<0?-1:0)<<1,Ct=((Mt|0)<0?-1:0)>>31|((Mt|0)<0?-1:0)<<1,Ft=Xs(Qt^vt|0,Vt^yt|0,Qt|0,Vt|0)|0,Nt=cn()|0,vt=Pt^Qt,yt=Ct^Vt,Xs((ep(Ft,Nt,Xs(Pt^_t|0,Ct^Mt|0,Pt|0,Ct|0)|0,cn()|0,0)|0)^vt|0,(cn()|0)^yt|0,vt|0,yt|0)|0}function ho(vt,yt){vt=vt|0,yt=yt|0;var _t=0,Mt=0,Ct=0,Pt=0;return Pt=vt&65535,Ct=yt&65535,_t=kr(Ct,Pt)|0,Mt=vt>>>16,vt=(_t>>>16)+(kr(Ct,Mt)|0)|0,Ct=yt>>>16,yt=kr(Ct,Pt)|0,wr((vt>>>16)+(kr(Ct,Mt)|0)+(((vt&65535)+yt|0)>>>16)|0),vt+yt<<16|_t&65535|0|0}function fo(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0;return Ct=vt,Pt=_t,_t=ho(Ct,Pt)|0,vt=cn()|0,wr((kr(yt,Pt)|0)+(kr(Mt,Ct)|0)+vt|vt&0|0),_t|0|0|0}function tp(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0,Nt=0,Ft=0,Vt=0,Qt=0;return Ct=fn,fn=fn+16|0,Ft=Ct|0,Nt=yt>>31|((yt|0)<0?-1:0)<<1,Pt=((yt|0)<0?-1:0)>>31|((yt|0)<0?-1:0)<<1,Qt=Mt>>31|((Mt|0)<0?-1:0)<<1,Vt=((Mt|0)<0?-1:0)>>31|((Mt|0)<0?-1:0)<<1,vt=Xs(Nt^vt|0,Pt^yt|0,Nt|0,Pt|0)|0,yt=cn()|0,ep(vt,yt,Xs(Qt^_t|0,Vt^Mt|0,Qt|0,Vt|0)|0,cn()|0,Ft)|0,Mt=Xs(xt[Ft>>2]^Nt|0,xt[Ft+4>>2]^Pt|0,Nt|0,Pt|0)|0,_t=cn()|0,fn=Ct,wr(_t|0),Mt|0}function Qs(vt,yt,_t,Mt){vt=vt|0,yt=yt|0,_t=_t|0,Mt=Mt|0;var Ct=0,Pt=0;return Pt=fn,fn=fn+16|0,Ct=Pt|0,ep(vt,yt,_t,Mt,Ct)|0,fn=Pt,wr(xt[Ct+4>>2]|0),xt[Ct>>2]|0|0}function po(vt,yt,_t){return vt=vt|0,yt=yt|0,_t=_t|0,(_t|0)<32?(wr(yt>>_t|0),vt>>>_t|(yt&(1<<_t)-1)<<32-_t):(wr(((yt|0)<0?-1:0)|0),yt>>_t-32|0)}function _r(vt,yt,_t){return vt=vt|0,yt=yt|0,_t=_t|0,(_t|0)<32?(wr(yt>>>_t|0),vt>>>_t|(yt&(1<<_t)-1)<<32-_t):(wr(0),yt>>>_t-32|0)}function Cr(vt,yt,_t){return vt=vt|0,yt=yt|0,_t=_t|0,(_t|0)<32?(wr(yt<<_t|(vt&(1<<_t)-1<<32-_t)>>>32-_t|0),vt<<_t):(wr(vt<<_t-32|0),0)}function xp(vt,yt){return vt=+vt,yt=+yt,vt!=vt?+yt:yt!=yt?+vt:+ds(+vt,+yt)}function np(vt,yt){return vt=+vt,yt=+yt,vt!=vt?+yt:yt!=yt?+vt:+ls(+vt,+yt)}function Bu(vt){return vt=+vt,vt>=0?+Bs(vt+.5):+zr(vt-.5)}function Au(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0;if((_t|0)>=8192)return Gs(vt|0,yt|0,_t|0)|0,vt|0;if(Pt=vt|0,Ct=vt+_t|0,(vt&3)==(yt&3)){for(;vt&3;){if(!_t)return Pt|0;Or[vt>>0]=Or[yt>>0]|0,vt=vt+1|0,yt=yt+1|0,_t=_t-1|0}for(_t=Ct&-4|0,Mt=_t-64|0;(vt|0)<=(Mt|0);)xt[vt>>2]=xt[yt>>2],xt[vt+4>>2]=xt[yt+4>>2],xt[vt+8>>2]=xt[yt+8>>2],xt[vt+12>>2]=xt[yt+12>>2],xt[vt+16>>2]=xt[yt+16>>2],xt[vt+20>>2]=xt[yt+20>>2],xt[vt+24>>2]=xt[yt+24>>2],xt[vt+28>>2]=xt[yt+28>>2],xt[vt+32>>2]=xt[yt+32>>2],xt[vt+36>>2]=xt[yt+36>>2],xt[vt+40>>2]=xt[yt+40>>2],xt[vt+44>>2]=xt[yt+44>>2],xt[vt+48>>2]=xt[yt+48>>2],xt[vt+52>>2]=xt[yt+52>>2],xt[vt+56>>2]=xt[yt+56>>2],xt[vt+60>>2]=xt[yt+60>>2],vt=vt+64|0,yt=yt+64|0;for(;(vt|0)<(_t|0);)xt[vt>>2]=xt[yt>>2],vt=vt+4|0,yt=yt+4|0}else for(_t=Ct-4|0;(vt|0)<(_t|0);)Or[vt>>0]=Or[yt>>0]|0,Or[vt+1>>0]=Or[yt+1>>0]|0,Or[vt+2>>0]=Or[yt+2>>0]|0,Or[vt+3>>0]=Or[yt+3>>0]|0,vt=vt+4|0,yt=yt+4|0;for(;(vt|0)<(Ct|0);)Or[vt>>0]=Or[yt>>0]|0,vt=vt+1|0,yt=yt+1|0;return Pt|0}function Ol(vt,yt,_t){vt=vt|0,yt=yt|0,_t=_t|0;var Mt=0,Ct=0,Pt=0,Nt=0;if(Pt=vt+_t|0,yt=yt&255,(_t|0)>=67){for(;vt&3;)Or[vt>>0]=yt,vt=vt+1|0;for(Mt=Pt&-4|0,Nt=yt|yt<<8|yt<<16|yt<<24,Ct=Mt-64|0;(vt|0)<=(Ct|0);)xt[vt>>2]=Nt,xt[vt+4>>2]=Nt,xt[vt+8>>2]=Nt,xt[vt+12>>2]=Nt,xt[vt+16>>2]=Nt,xt[vt+20>>2]=Nt,xt[vt+24>>2]=Nt,xt[vt+28>>2]=Nt,xt[vt+32>>2]=Nt,xt[vt+36>>2]=Nt,xt[vt+40>>2]=Nt,xt[vt+44>>2]=Nt,xt[vt+48>>2]=Nt,xt[vt+52>>2]=Nt,xt[vt+56>>2]=Nt,xt[vt+60>>2]=Nt,vt=vt+64|0;for(;(vt|0)<(Mt|0);)xt[vt>>2]=Nt,vt=vt+4|0}for(;(vt|0)<(Pt|0);)Or[vt>>0]=yt,vt=vt+1|0;return Pt-_t|0}function rp(vt){return vt=+vt,vt>=0?+Bs(vt+.5):+zr(vt-.5)}function Rl(vt){vt=vt|0;var yt=0,_t=0,Mt=0;return Mt=Xr()|0,_t=xt[gs>>2]|0,yt=_t+vt|0,(vt|0)>0&(yt|0)<(_t|0)|(yt|0)<0?(ys(yt|0)|0,cs(12),-1):(yt|0)>(Mt|0)&&!(Ws(yt|0)|0)?(cs(12),-1):(xt[gs>>2]=yt,_t|0)}return{___divdi3:jo,___muldi3:fo,___remdi3:tp,___uremdi3:Qs,_areNeighborCells:Sl,_bitshift64Ashr:po,_bitshift64Lshr:_r,_bitshift64Shl:Cr,_calloc:So,_cellAreaKm2:Iu,_cellAreaM2:ym,_cellAreaRads2:Jl,_cellToBoundary:Jo,_cellToCenterChild:Ro,_cellToChildPos:hu,_cellToChildren:cp,_cellToChildrenSize:Cu,_cellToLatLng:cu,_cellToLocalIj:$p,_cellToParent:El,_cellToVertex:Po,_cellToVertexes:Wp,_cellsToDirectedEdge:$l,_cellsToLinkedMultiPolygon:Ll,_childPosToCell:Zo,_compactCells:Ns,_destroyLinkedMultiPolygon:Ho,_directedEdgeToBoundary:iu,_directedEdgeToCells:wp,_edgeLengthKm:dp,_edgeLengthM:fp,_edgeLengthRads:uo,_emscripten_replace_memory:Ts,_free:Qr,_getBaseCellNumber:Qo,_getDirectedEdgeDestination:Mp,_getDirectedEdgeOrigin:qu,_getHexagonAreaAvgKm2:Bo,_getHexagonAreaAvgM2:fu,_getHexagonEdgeLengthAvgKm:zs,_getHexagonEdgeLengthAvgM:co,_getIcosahedronFaces:uu,_getNumCells:js,_getPentagons:Yl,_getRes0Cells:go,_getResolution:Wl,_greatCircleDistanceKm:Fl,_greatCircleDistanceM:up,_greatCircleDistanceRads:Os,_gridDisk:Go,_gridDiskDistances:Su,_gridDistance:Bp,_gridPathCells:Op,_gridPathCellsSize:Fp,_gridRingUnsafe:Vu,_i64Add:ts,_i64Subtract:Xs,_isPentagon:Es,_isResClassIII:Lp,_isValidCell:Vo,_isValidDirectedEdge:Wu,_isValidVertex:xm,_latLngToCell:au,_llvm_maxnum_f64:xp,_llvm_minnum_f64:np,_llvm_round_f64:Bu,_localIjToCell:Np,_malloc:Ks,_maxFaceCount:Dp,_maxGridDiskSize:Pl,_maxPolygonToCellsSize:Tu,_memcpy:Au,_memset:Ol,_originToDirectedEdges:Cp,_pentagonCount:No,_polygonToCells:_c,_readInt64AsDoubleFromPointer:zp,_res0CellCount:zu,_round:rp,_sbrk:Rl,_sizeOfCellBoundary:kp,_sizeOfCoordIJ:yp,_sizeOfGeoLoop:Up,_sizeOfGeoPolygon:Gp,_sizeOfH3Index:gp,_sizeOfLatLng:$u,_sizeOfLinkedGeoPolygon:Vp,_uncompactCells:Ru,_uncompactCellsSize:zo,_vertexToLatLng:_h,establishStackSpace:to,stackAlloc:Ao,stackRestore:ws,stackSave:Io}}(nr,Ir,Ot);_e.___divdi3=Dn.___divdi3,_e.___muldi3=Dn.___muldi3,_e.___remdi3=Dn.___remdi3,_e.___uremdi3=Dn.___uremdi3,_e._areNeighborCells=Dn._areNeighborCells,_e._bitshift64Ashr=Dn._bitshift64Ashr,_e._bitshift64Lshr=Dn._bitshift64Lshr,_e._bitshift64Shl=Dn._bitshift64Shl,_e._calloc=Dn._calloc,_e._cellAreaKm2=Dn._cellAreaKm2,_e._cellAreaM2=Dn._cellAreaM2,_e._cellAreaRads2=Dn._cellAreaRads2,_e._cellToBoundary=Dn._cellToBoundary,_e._cellToCenterChild=Dn._cellToCenterChild,_e._cellToChildPos=Dn._cellToChildPos,_e._cellToChildren=Dn._cellToChildren,_e._cellToChildrenSize=Dn._cellToChildrenSize,_e._cellToLatLng=Dn._cellToLatLng,_e._cellToLocalIj=Dn._cellToLocalIj,_e._cellToParent=Dn._cellToParent,_e._cellToVertex=Dn._cellToVertex,_e._cellToVertexes=Dn._cellToVertexes,_e._cellsToDirectedEdge=Dn._cellsToDirectedEdge,_e._cellsToLinkedMultiPolygon=Dn._cellsToLinkedMultiPolygon,_e._childPosToCell=Dn._childPosToCell,_e._compactCells=Dn._compactCells,_e._destroyLinkedMultiPolygon=Dn._destroyLinkedMultiPolygon,_e._directedEdgeToBoundary=Dn._directedEdgeToBoundary,_e._directedEdgeToCells=Dn._directedEdgeToCells,_e._edgeLengthKm=Dn._edgeLengthKm,_e._edgeLengthM=Dn._edgeLengthM,_e._edgeLengthRads=Dn._edgeLengthRads;var Pr=_e._emscripten_replace_memory=Dn._emscripten_replace_memory;_e._free=Dn._free,_e._getBaseCellNumber=Dn._getBaseCellNumber,_e._getDirectedEdgeDestination=Dn._getDirectedEdgeDestination,_e._getDirectedEdgeOrigin=Dn._getDirectedEdgeOrigin,_e._getHexagonAreaAvgKm2=Dn._getHexagonAreaAvgKm2,_e._getHexagonAreaAvgM2=Dn._getHexagonAreaAvgM2,_e._getHexagonEdgeLengthAvgKm=Dn._getHexagonEdgeLengthAvgKm,_e._getHexagonEdgeLengthAvgM=Dn._getHexagonEdgeLengthAvgM,_e._getIcosahedronFaces=Dn._getIcosahedronFaces,_e._getNumCells=Dn._getNumCells,_e._getPentagons=Dn._getPentagons,_e._getRes0Cells=Dn._getRes0Cells,_e._getResolution=Dn._getResolution,_e._greatCircleDistanceKm=Dn._greatCircleDistanceKm,_e._greatCircleDistanceM=Dn._greatCircleDistanceM,_e._greatCircleDistanceRads=Dn._greatCircleDistanceRads,_e._gridDisk=Dn._gridDisk,_e._gridDiskDistances=Dn._gridDiskDistances,_e._gridDistance=Dn._gridDistance,_e._gridPathCells=Dn._gridPathCells,_e._gridPathCellsSize=Dn._gridPathCellsSize,_e._gridRingUnsafe=Dn._gridRingUnsafe,_e._i64Add=Dn._i64Add,_e._i64Subtract=Dn._i64Subtract,_e._isPentagon=Dn._isPentagon,_e._isResClassIII=Dn._isResClassIII,_e._isValidCell=Dn._isValidCell,_e._isValidDirectedEdge=Dn._isValidDirectedEdge,_e._isValidVertex=Dn._isValidVertex,_e._latLngToCell=Dn._latLngToCell,_e._llvm_maxnum_f64=Dn._llvm_maxnum_f64,_e._llvm_minnum_f64=Dn._llvm_minnum_f64,_e._llvm_round_f64=Dn._llvm_round_f64,_e._localIjToCell=Dn._localIjToCell,_e._malloc=Dn._malloc,_e._maxFaceCount=Dn._maxFaceCount,_e._maxGridDiskSize=Dn._maxGridDiskSize,_e._maxPolygonToCellsSize=Dn._maxPolygonToCellsSize,_e._memcpy=Dn._memcpy,_e._memset=Dn._memset,_e._originToDirectedEdges=Dn._originToDirectedEdges,_e._pentagonCount=Dn._pentagonCount,_e._polygonToCells=Dn._polygonToCells,_e._readInt64AsDoubleFromPointer=Dn._readInt64AsDoubleFromPointer,_e._res0CellCount=Dn._res0CellCount,_e._round=Dn._round,_e._sbrk=Dn._sbrk,_e._sizeOfCellBoundary=Dn._sizeOfCellBoundary,_e._sizeOfCoordIJ=Dn._sizeOfCoordIJ,_e._sizeOfGeoLoop=Dn._sizeOfGeoLoop,_e._sizeOfGeoPolygon=Dn._sizeOfGeoPolygon,_e._sizeOfH3Index=Dn._sizeOfH3Index,_e._sizeOfLatLng=Dn._sizeOfLatLng,_e._sizeOfLinkedGeoPolygon=Dn._sizeOfLinkedGeoPolygon,_e._uncompactCells=Dn._uncompactCells,_e._uncompactCellsSize=Dn._uncompactCellsSize,_e._vertexToLatLng=Dn._vertexToLatLng,_e.establishStackSpace=Dn.establishStackSpace;var jr=_e.stackAlloc=Dn.stackAlloc,Jr=_e.stackRestore=Dn.stackRestore,Lr=_e.stackSave=Dn.stackSave;if(_e.asm=Dn,_e.cwrap=Tt,_e.setValue=ft,_e.getValue=pt,en){gn(en)||(en=st(en));{sr();var Wr=function(zn){zn.byteLength&&(zn=new Uint8Array(zn)),Ht.set(zn,dt),_e.memoryInitializerRequest&&delete _e.memoryInitializerRequest.response,un()},As=function(){ot(en,Wr,function(){throw"could not load memory initializer "+en})},ks=Nn(en);if(ks)Wr(ks.buffer);else if(_e.memoryInitializerRequest){var Ps=function(){var zn=_e.memoryInitializerRequest,lr=zn.response;if(zn.status!==200&&zn.status!==0){var Sr=Nn(_e.memoryInitializerRequestURL);if(Sr)lr=Sr.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+zn.status+", retrying "+en),As();return}}Wr(lr)};_e.memoryInitializerRequest.response?setTimeout(Ps,0):_e.memoryInitializerRequest.addEventListener("load",Ps)}else As()}}var $s;Qn=function zn(){$s||eo(),$s||(Qn=zn)};function eo(zn){if(ir>0||(yn(),ir>0))return;function lr(){$s||($s=!0,!mt&&($n(),Jn(),_e.onRuntimeInitialized&&_e.onRuntimeInitialized(),Xn()))}_e.setStatus?(_e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_e.setStatus("")},1),lr()},1)):lr()}_e.run=eo;function Us(zn){throw _e.onAbort&&_e.onAbort(zn),zn+="",at(zn),lt(zn),mt=!0,"abort("+zn+"). Build with -s ASSERTIONS=1 for more info."}if(_e.abort=Us,_e.preInit)for(typeof _e.preInit=="function"&&(_e.preInit=[_e.preInit]);_e.preInit.length>0;)_e.preInit.pop()();return eo(),nt}(typeof libh3=="object"?libh3:{}),NUMBER="number",H3_ERROR=NUMBER,BOOLEAN=NUMBER,H3_LOWER=NUMBER,H3_UPPER=NUMBER,RESOLUTION=NUMBER,POINTER=NUMBER,BINDINGS=[["sizeOfH3Index",NUMBER],["sizeOfLatLng",NUMBER],["sizeOfCellBoundary",NUMBER],["sizeOfGeoLoop",NUMBER],["sizeOfGeoPolygon",NUMBER],["sizeOfLinkedGeoPolygon",NUMBER],["sizeOfCoordIJ",NUMBER],["readInt64AsDoubleFromPointer",NUMBER],["isValidCell",BOOLEAN,[H3_LOWER,H3_UPPER]],["latLngToCell",H3_ERROR,[NUMBER,NUMBER,RESOLUTION,POINTER]],["cellToLatLng",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["cellToBoundary",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["maxGridDiskSize",H3_ERROR,[NUMBER,POINTER]],["gridDisk",H3_ERROR,[H3_LOWER,H3_UPPER,NUMBER,POINTER]],["gridDiskDistances",H3_ERROR,[H3_LOWER,H3_UPPER,NUMBER,POINTER,POINTER]],["gridRingUnsafe",H3_ERROR,[H3_LOWER,H3_UPPER,NUMBER,POINTER]],["maxPolygonToCellsSize",H3_ERROR,[POINTER,RESOLUTION,NUMBER,POINTER]],["polygonToCells",H3_ERROR,[POINTER,RESOLUTION,NUMBER,POINTER]],["cellsToLinkedMultiPolygon",H3_ERROR,[POINTER,NUMBER,POINTER]],["destroyLinkedMultiPolygon",null,[POINTER]],["compactCells",H3_ERROR,[POINTER,POINTER,NUMBER,NUMBER]],["uncompactCells",H3_ERROR,[POINTER,NUMBER,NUMBER,POINTER,NUMBER,RESOLUTION]],["uncompactCellsSize",H3_ERROR,[POINTER,NUMBER,NUMBER,RESOLUTION,POINTER]],["isPentagon",BOOLEAN,[H3_LOWER,H3_UPPER]],["isResClassIII",BOOLEAN,[H3_LOWER,H3_UPPER]],["getBaseCellNumber",NUMBER,[H3_LOWER,H3_UPPER]],["getResolution",NUMBER,[H3_LOWER,H3_UPPER]],["maxFaceCount",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["getIcosahedronFaces",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["cellToParent",H3_ERROR,[H3_LOWER,H3_UPPER,RESOLUTION,POINTER]],["cellToChildren",H3_ERROR,[H3_LOWER,H3_UPPER,RESOLUTION,POINTER]],["cellToCenterChild",H3_ERROR,[H3_LOWER,H3_UPPER,RESOLUTION,POINTER]],["cellToChildrenSize",H3_ERROR,[H3_LOWER,H3_UPPER,RESOLUTION,POINTER]],["cellToChildPos",H3_ERROR,[H3_LOWER,H3_UPPER,RESOLUTION,POINTER]],["childPosToCell",H3_ERROR,[NUMBER,NUMBER,H3_LOWER,H3_UPPER,RESOLUTION,POINTER]],["areNeighborCells",H3_ERROR,[H3_LOWER,H3_UPPER,H3_LOWER,H3_UPPER,POINTER]],["cellsToDirectedEdge",H3_ERROR,[H3_LOWER,H3_UPPER,H3_LOWER,H3_UPPER,POINTER]],["getDirectedEdgeOrigin",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["getDirectedEdgeDestination",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["isValidDirectedEdge",BOOLEAN,[H3_LOWER,H3_UPPER]],["directedEdgeToCells",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["originToDirectedEdges",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["directedEdgeToBoundary",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["gridDistance",H3_ERROR,[H3_LOWER,H3_UPPER,H3_LOWER,H3_UPPER,POINTER]],["gridPathCells",H3_ERROR,[H3_LOWER,H3_UPPER,H3_LOWER,H3_UPPER,POINTER]],["gridPathCellsSize",H3_ERROR,[H3_LOWER,H3_UPPER,H3_LOWER,H3_UPPER,POINTER]],["cellToLocalIj",H3_ERROR,[H3_LOWER,H3_UPPER,H3_LOWER,H3_UPPER,NUMBER,POINTER]],["localIjToCell",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER,NUMBER,POINTER]],["getHexagonAreaAvgM2",H3_ERROR,[RESOLUTION,POINTER]],["getHexagonAreaAvgKm2",H3_ERROR,[RESOLUTION,POINTER]],["getHexagonEdgeLengthAvgM",H3_ERROR,[RESOLUTION,POINTER]],["getHexagonEdgeLengthAvgKm",H3_ERROR,[RESOLUTION,POINTER]],["greatCircleDistanceM",NUMBER,[POINTER,POINTER]],["greatCircleDistanceKm",NUMBER,[POINTER,POINTER]],["greatCircleDistanceRads",NUMBER,[POINTER,POINTER]],["cellAreaM2",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["cellAreaKm2",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["cellAreaRads2",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["edgeLengthM",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["edgeLengthKm",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["edgeLengthRads",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["getNumCells",H3_ERROR,[RESOLUTION,POINTER]],["getRes0Cells",H3_ERROR,[POINTER]],["res0CellCount",NUMBER],["getPentagons",H3_ERROR,[NUMBER,POINTER]],["pentagonCount",NUMBER],["cellToVertex",H3_ERROR,[H3_LOWER,H3_UPPER,NUMBER,POINTER]],["cellToVertexes",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["vertexToLatLng",H3_ERROR,[H3_LOWER,H3_UPPER,POINTER]],["isValidVertex",BOOLEAN,[H3_LOWER,H3_UPPER]]],E_SUCCESS=0,E_FAILED=1,E_DOMAIN=2,E_LATLNG_DOMAIN=3,E_RES_DOMAIN=4,E_CELL_INVALID=5,E_DIR_EDGE_INVALID=6,E_UNDIR_EDGE_INVALID=7,E_VERTEX_INVALID=8,E_PENTAGON=9,E_DUPLICATE_INPUT=10,E_NOT_NEIGHBORS=11,E_RES_MISMATCH=12,E_MEMORY_ALLOC=13,E_MEMORY_BOUNDS=14,E_OPTION_INVALID=15,H3_ERROR_MSGS={};H3_ERROR_MSGS[E_SUCCESS]="Success";H3_ERROR_MSGS[E_FAILED]="The operation failed but a more specific error is not available";H3_ERROR_MSGS[E_DOMAIN]="Argument was outside of acceptable range";H3_ERROR_MSGS[E_LATLNG_DOMAIN]="Latitude or longitude arguments were outside of acceptable range";H3_ERROR_MSGS[E_RES_DOMAIN]="Resolution argument was outside of acceptable range";H3_ERROR_MSGS[E_CELL_INVALID]="Cell argument was not valid";H3_ERROR_MSGS[E_DIR_EDGE_INVALID]="Directed edge argument was not valid";H3_ERROR_MSGS[E_UNDIR_EDGE_INVALID]="Undirected edge argument was not valid";H3_ERROR_MSGS[E_VERTEX_INVALID]="Vertex argument was not valid";H3_ERROR_MSGS[E_PENTAGON]="Pentagon distortion was encountered";H3_ERROR_MSGS[E_DUPLICATE_INPUT]="Duplicate input";H3_ERROR_MSGS[E_NOT_NEIGHBORS]="Cell arguments were not neighbors";H3_ERROR_MSGS[E_RES_MISMATCH]="Cell arguments had incompatible resolutions";H3_ERROR_MSGS[E_MEMORY_ALLOC]="Memory allocation failed";H3_ERROR_MSGS[E_MEMORY_BOUNDS]="Bounds of provided memory were insufficient";H3_ERROR_MSGS[E_OPTION_INVALID]="Mode or flags argument was not valid";var E_UNKNOWN_UNIT=1e3,E_ARRAY_LENGTH=1001,E_NULL_INDEX=1002,JS_ERROR_MESSAGES={};JS_ERROR_MESSAGES[E_UNKNOWN_UNIT]="Unknown unit";JS_ERROR_MESSAGES[E_ARRAY_LENGTH]="Array length out of bounds";JS_ERROR_MESSAGES[E_NULL_INDEX]="Got unexpected null value for H3 index";var UNKNOWN_ERROR_MSG="Unknown error";function createError(nt,_e,et){var rt=et&&"value"in et,it=new Error((nt[_e]||UNKNOWN_ERROR_MSG)+" (code: "+_e+(rt?", value: "+et.value:"")+")");return it.code=_e,it}function H3LibraryError(nt,_e){var et=arguments.length===2?{value:_e}:{};return createError(H3_ERROR_MSGS,nt,et)}function JSBindingError(nt,_e){var et=arguments.length===2?{value:_e}:{};return createError(JS_ERROR_MESSAGES,nt,et)}function throwIfError(nt){if(nt!==0)throw H3LibraryError(nt)}var H3={};BINDINGS.forEach(function(_e){H3[_e[0]]=libh3.cwrap.apply(libh3,_e)});var BASE_16=16,SZ_INT=4,SZ_DBL=8,SZ_INT64=8,SZ_H3INDEX=H3.sizeOfH3Index(),SZ_LATLNG=H3.sizeOfLatLng(),SZ_CELLBOUNDARY=H3.sizeOfCellBoundary(),SZ_GEOPOLYGON=H3.sizeOfGeoPolygon(),SZ_GEOLOOP=H3.sizeOfGeoLoop();H3.sizeOfLinkedGeoPolygon();H3.sizeOfCoordIJ();function validateRes(nt){if(typeof nt!="number"||nt<0||nt>15||Math.floor(nt)!==nt)throw H3LibraryError(E_RES_DOMAIN,nt);return nt}function validateH3Index(nt){if(!nt)throw JSBindingError(E_NULL_INDEX);return nt}var MAX_JS_ARRAY_LENGTH=Math.pow(2,32)-1;function validateArrayLength(nt){if(nt>MAX_JS_ARRAY_LENGTH)throw JSBindingError(E_ARRAY_LENGTH,nt);return nt}var INVALID_HEXIDECIMAL_CHAR=/[^0-9a-fA-F]/;function h3IndexToSplitLong(nt){if(Array.isArray(nt)&&nt.length===2&&Number.isInteger(nt[0])&&Number.isInteger(nt[1]))return nt;if(typeof nt!="string"||INVALID_HEXIDECIMAL_CHAR.test(nt))return[0,0];var _e=parseInt(nt.substring(0,nt.length-8),BASE_16),et=parseInt(nt.substring(nt.length-8),BASE_16);return[et,_e]}function hexFrom32Bit(nt){if(nt>=0)return nt.toString(BASE_16);nt=nt&2147483647;var _e=zeroPad(8,nt.toString(BASE_16)),et=(parseInt(_e[0],BASE_16)+8).toString(BASE_16);return _e=et+_e.substring(1),_e}function splitLongToH3Index(nt,_e){return hexFrom32Bit(_e)+zeroPad(8,hexFrom32Bit(nt))}function zeroPad(nt,_e){for(var et=nt-_e.length,rt="",it=0;it<et;it++)rt+="0";return rt=rt+_e,rt}function polygonArrayToGeoLoop(nt,_e,et){for(var rt=nt.length,it=libh3._calloc(rt,SZ_LATLNG),st=et?1:0,ot=et?0:1,at=0;at<rt*2;at+=2)libh3.HEAPF64.set([nt[at/2][st],nt[at/2][ot]].map(degsToRads),it/SZ_DBL+at);return libh3.HEAPU32.set([rt,it],_e/SZ_INT),_e}function coordinatesToGeoPolygon(nt,_e){var et=nt.length-1,rt=libh3._calloc(SZ_GEOPOLYGON),it=0,st=it+SZ_GEOLOOP,ot=st+SZ_INT;polygonArrayToGeoLoop(nt[0],rt+it,_e);var at;if(et>0){at=libh3._calloc(et,SZ_GEOLOOP);for(var lt=0;lt<et;lt++)polygonArrayToGeoLoop(nt[lt+1],at+SZ_GEOLOOP*lt,_e)}return libh3.setValue(rt+st,et,"i32"),libh3.setValue(rt+ot,at,"i32"),rt}function destroyGeoPolygon(nt){var _e=0,et=_e+SZ_GEOLOOP,rt=et+SZ_INT,it=SZ_INT;libh3._free(libh3.getValue(nt+_e+it,"i8*"));var st=libh3.getValue(nt+et,"i32");if(st>0){for(var ot=libh3.getValue(nt+rt,"i32"),at=0;at<st;at++)libh3._free(libh3.getValue(ot+SZ_GEOLOOP*at+it,"i8*"));libh3._free(ot)}libh3._free(nt)}function readH3IndexFromPointer(nt,_e){_e===void 0&&(_e=0);var et=libh3.getValue(nt+SZ_H3INDEX*_e,"i32"),rt=libh3.getValue(nt+SZ_H3INDEX*_e+SZ_INT,"i32");return rt?splitLongToH3Index(et,rt):null}function readInt64AsDoubleFromPointer(nt){return H3.readInt64AsDoubleFromPointer(nt)}function readArrayOfH3Indexes(nt,_e){for(var et=[],rt=0;rt<_e;rt++){var it=readH3IndexFromPointer(nt,rt);it!==null&&et.push(it)}return et}function readSingleCoord(nt){return radsToDegs(libh3.getValue(nt,"double"))}function readLatLng(nt){return[readSingleCoord(nt),readSingleCoord(nt+SZ_DBL)]}function readLatLngGeoJson(nt){return[readSingleCoord(nt+SZ_DBL),readSingleCoord(nt)]}function readCellBoundary(nt,_e,et){for(var rt=libh3.getValue(nt,"i32"),it=nt+SZ_DBL,st=[],ot=readLatLngGeoJson,at=0;at<rt*2;at+=2)st.push(ot(it+SZ_DBL*at));return st.push(st[0]),st}function latLngToCell(nt,_e,et){var rt=libh3._malloc(SZ_LATLNG);libh3.HEAPF64.set([nt,_e].map(degsToRads),rt/SZ_DBL);var it=libh3._malloc(SZ_H3INDEX);try{return throwIfError(H3.latLngToCell(rt,et,it)),validateH3Index(readH3IndexFromPointer(it))}finally{libh3._free(it),libh3._free(rt)}}function cellToLatLng(nt){var _e=libh3._malloc(SZ_LATLNG),et=h3IndexToSplitLong(nt),rt=et[0],it=et[1];try{return throwIfError(H3.cellToLatLng(rt,it,_e)),readLatLng(_e)}finally{libh3._free(_e)}}function cellToBoundary(nt,_e){var et=libh3._malloc(SZ_CELLBOUNDARY),rt=h3IndexToSplitLong(nt),it=rt[0],st=rt[1];try{return throwIfError(H3.cellToBoundary(it,st,et)),readCellBoundary(et,_e,_e)}finally{libh3._free(et)}}function polygonToCells(nt,_e,et){if(validateRes(_e),et=!!et,nt.length===0||nt[0].length===0)return[];var rt=typeof nt[0][0]=="number"?[nt]:nt,it=coordinatesToGeoPolygon(rt,et),st=libh3._malloc(SZ_INT64);try{throwIfError(H3.maxPolygonToCellsSize(it,_e,0,st));var ot=validateArrayLength(readInt64AsDoubleFromPointer(st)),at=libh3._calloc(ot,SZ_H3INDEX);try{return throwIfError(H3.polygonToCells(it,_e,0,at)),readArrayOfH3Indexes(at,ot)}finally{libh3._free(at)}}finally{libh3._free(st),destroyGeoPolygon(it)}}function degsToRads(nt){return nt*Math.PI/180}function radsToDegs(nt){return nt*180/Math.PI}function interpolateTurbo(nt){return nt=Math.max(0,Math.min(1,nt)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+nt*(1172.33-nt*(10793.56-nt*(33300.12-nt*(38394.49-nt*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+nt*(557.33+nt*(1225.33-nt*(3574.96-nt*(1073.77+nt*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+nt*(3211.1-nt*(15327.97-nt*(27814-nt*(22569.18-nt*6838.66)))))))+")"}var bounds3=Bounds3$2;function Bounds3$2(nt,_e,et,rt){this.x=typeof nt=="number"?nt:0,this.y=typeof _e=="number"?_e:0,this.z=typeof et=="number"?et:0,this.half=typeof rt=="number"?rt:0}Bounds3$2.prototype.contains=function(_e,et,rt){var it=this.half;return this.x-it<=_e&&_e<this.x+it&&this.y-it<=et&&et<this.y+it&&this.z-it<=rt&&rt<this.z+it};var Bounds3$1=bounds3,MAX_ITEMS=4,treeNode=TreeNode$1;function TreeNode$1(nt){this.bounds=nt,this.q0=null,this.q1=null,this.q2=null,this.q3=null,this.q4=null,this.q5=null,this.q6=null,this.q7=null,this.items=null}TreeNode$1.prototype.subdivide=function(){var _e=this.bounds,et=_e.half/2;this.q0=new TreeNode$1(new Bounds3$1(_e.x-et,_e.y-et,_e.z-et,et)),this.q1=new TreeNode$1(new Bounds3$1(_e.x+et,_e.y-et,_e.z-et,et)),this.q2=new TreeNode$1(new Bounds3$1(_e.x-et,_e.y+et,_e.z-et,et)),this.q3=new TreeNode$1(new Bounds3$1(_e.x+et,_e.y+et,_e.z-et,et)),this.q4=new TreeNode$1(new Bounds3$1(_e.x-et,_e.y-et,_e.z+et,et)),this.q5=new TreeNode$1(new Bounds3$1(_e.x+et,_e.y-et,_e.z+et,et)),this.q6=new TreeNode$1(new Bounds3$1(_e.x-et,_e.y+et,_e.z+et,et)),this.q7=new TreeNode$1(new Bounds3$1(_e.x+et,_e.y+et,_e.z+et,et))};TreeNode$1.prototype.insert=function(_e,et,rt){var it=this.q0===null;if(it){if(this.items===null?this.items=[_e]:this.items.push(_e),this.items.length>=MAX_ITEMS&&rt<16){this.subdivide();for(var st=0;st<this.items.length;++st)this.insert(this.items[st],et,rt+1);this.items=null}}else{var ot=et[_e],at=et[_e+1],lt=et[_e+2],ct=this.bounds,ut=0;ot>ct.x&&(ut+=1),at>ct.y&&(ut+=2),lt>ct.z&&(ut+=4);var ht=getChild(this,ut);ht.insert(_e,et,rt+1)}};TreeNode$1.prototype.query=function(_e,et,rt,it){if(rt(this.bounds)){var st=this.items,ot=typeof it=="function";if(st)for(var at=0;at<st.length;++at){var lt=st[at];ot?it(et[lt],et[lt+1],et[lt+2])&&_e.push(lt):_e.push(lt)}this.q0&&(this.q0.query(_e,et,rt,it),this.q1.query(_e,et,rt,it),this.q2.query(_e,et,rt,it),this.q3.query(_e,et,rt,it),this.q4.query(_e,et,rt,it),this.q5.query(_e,et,rt,it),this.q6.query(_e,et,rt,it),this.q7.query(_e,et,rt,it))}};function getChild(nt,_e){if(_e===0)return nt.q0;if(_e===1)return nt.q1;if(_e===2)return nt.q2;if(_e===3)return nt.q3;if(_e===4)return nt.q4;if(_e===5)return nt.q5;if(_e===6)return nt.q6;if(_e===7)return nt.q7}var rafor=asyncFor$1;function asyncFor$1(nt,_e,et,rt){var it=0,st=0;rt=rt||{};var ot=rt.step||1,at=rt.maxTimeMS||8,lt=rt.probeElements||5e3;setTimeout(ct,0);function ct(){var ut=Math.min(nt.length,it+lt),ht=it,dt=new Date;for(ht=it;ht<ut;ht+=ot)_e(nt[ht],ht,nt);ht<nt.length?(st+=new Date-dt,it=ht,lt=Math.round(it*at/st),setTimeout(ct,0)):et(nt)}}var Bounds3=bounds3,TreeNode=treeNode,EmptyRegion=new Bounds3,asyncFor=rafor,yaot=createTree;function createTree(nt){var _e=[],et,rt,it={initAsync:ut,init:ct,bounds:dt,intersectRay:lt,intersectSphere:ot,getRoot:st};return it;function st(){return et}function ot(pt,mt,At,gt){if(!et)return _e;var bt=[],Tt=gt*gt;return et.query(bt,rt,wt,Rt),bt;function wt(It){var Lt=Tt,$t=It.half;return pt<It.x-$t?Lt-=at(pt-(It.x-$t)):pt>It.x+$t&&(Lt-=at(pt-(It.x+$t))),mt<It.y-$t?Lt-=at(mt-(It.y-$t)):mt>It.y+$t&&(Lt-=at(mt-(It.y+$t))),At<It.z-$t?Lt-=at(At-(It.z-$t)):At>It.z+$t&&(Lt-=at(At-(It.z+$t))),Lt>0}function Rt(It,Lt,$t){return at(It-pt)+at(Lt-mt)+at($t-At)<Tt}}function at(pt){return pt*pt}function lt(pt,mt,At,gt){if(!et)return _e;At===void 0&&(At=0),gt===void 0&&(gt=Number.POSITIVE_INFINITY),At*=At,gt*=gt;var bt=[];return et.query(bt,rt,Tt,wt),bt.sort(Rt);function Tt(It){var Lt=It.half,$t=(It.x-Lt-pt.x)/mt.x,kt=(It.x+Lt-pt.x)/mt.x,Dt=(It.y+Lt-pt.y)/mt.y,Ot=(It.y-Lt-pt.y)/mt.y,zt=(It.z-Lt-pt.z)/mt.z,Ht=(It.z+Lt-pt.z)/mt.z,Yt=Math.min(Math.min(Math.max($t,kt),Math.max(Dt,Ot)),Math.max(zt,Ht)),Xt;return Yt<0?!1:(Xt=Math.max(Math.max(Math.min($t,kt),Math.min(Dt,Ot)),Math.min(zt,Ht)),Xt<=Yt&&Xt<=gt)}function wt(It,Lt,$t){var kt=(It-pt.x)*(It-pt.x)+(Lt-pt.y)*(Lt-pt.y)+($t-pt.z)*($t-pt.z);return At<=kt&&kt<=gt}function Rt(It,Lt){var $t=pt[It],kt=pt[It+1],Dt=pt[It+2],Ot=($t-pt.x)*($t-pt.x)+(kt-pt.y)*(kt-pt.y)+(Dt-pt.z)*(Dt-pt.z),zt=pt[Lt],Ht=pt[Lt+1],Yt=pt[Lt+2],Xt=(zt-pt.x)*(zt-pt.x)+(Ht-pt.y)*(Ht-pt.y)+(Yt-pt.z)*(Yt-pt.z);return Ot-Xt}}function ct(pt){ht(pt),rt=pt,et=ft(pt);for(var mt=0;mt<pt.length;mt+=3)et.insert(mt,rt,0)}function ut(pt,mt){ht(pt);var At=ft(pt);asyncFor(pt,gt,bt,{step:3});function gt(Tt,wt){At.insert(wt,pt,0)}function bt(){rt=pt,et=At,typeof mt=="function"&&mt(it)}}function ht(pt){if(!pt)throw new Error("Points array is required for quadtree to work");if(typeof pt.length!="number")throw new Error("Points should be array-like object");if(pt.length%3!==0)throw new Error("Points array should consist of series of x,y,z coordinates and be multiple of 3")}function dt(){return et?et.bounds:EmptyRegion}function ft(pt){if(pt.length===0){var mt=new Bounds3;return new TreeNode(mt)}for(var At=Number.POSITIVE_INFINITY,gt=Number.POSITIVE_INFINITY,bt=Number.POSITIVE_INFINITY,Tt=Number.NEGATIVE_INFINITY,wt=Number.NEGATIVE_INFINITY,Rt=Number.NEGATIVE_INFINITY,It=0;It<pt.length;It+=3){var Lt=pt[It],$t=pt[It+1],kt=pt[It+2];Lt<At&&(At=Lt),Lt>Tt&&(Tt=Lt),$t<gt&&(gt=$t),$t>wt&&(wt=$t),kt<bt&&(bt=kt),kt>Rt&&(Rt=kt)}var Dt=Math.max(Math.max(Tt-At,wt-gt),Rt-bt);Dt+=2,At-=1,gt-=1,bt-=1;var Ot=Dt/2,zt=new Bounds3(At+Ot,gt+Ot,bt+Ot,Ot);return new TreeNode(zt)}}const yaOctree=getDefaultExportFromCjs$1(yaot),_box$1=new Box3$1,_vector=new Vector3$1;class LineSegmentsGeometry extends InstancedBufferGeometry{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const _e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],et=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],rt=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(rt),this.setAttribute("position",new Float32BufferAttribute$1(_e,3)),this.setAttribute("uv",new Float32BufferAttribute$1(et,2))}applyMatrix4(_e){const et=this.attributes.instanceStart,rt=this.attributes.instanceEnd;return et!==void 0&&(et.applyMatrix4(_e),rt.applyMatrix4(_e),et.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(_e){let et;_e instanceof Float32Array?et=_e:Array.isArray(_e)&&(et=new Float32Array(_e));const rt=new InstancedInterleavedBuffer$1(et,6,1);return this.setAttribute("instanceStart",new InterleavedBufferAttribute$1(rt,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute$1(rt,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(_e){let et;_e instanceof Float32Array?et=_e:Array.isArray(_e)&&(et=new Float32Array(_e));const rt=new InstancedInterleavedBuffer$1(et,6,1);return this.setAttribute("instanceColorStart",new InterleavedBufferAttribute$1(rt,3,0)),this.setAttribute("instanceColorEnd",new InterleavedBufferAttribute$1(rt,3,3)),this}fromWireframeGeometry(_e){return this.setPositions(_e.attributes.position.array),this}fromEdgesGeometry(_e){return this.setPositions(_e.attributes.position.array),this}fromMesh(_e){return this.fromWireframeGeometry(new WireframeGeometry(_e.geometry)),this}fromLineSegments(_e){const et=_e.geometry;return this.setPositions(et.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3$1);const _e=this.attributes.instanceStart,et=this.attributes.instanceEnd;_e!==void 0&&et!==void 0&&(this.boundingBox.setFromBufferAttribute(_e),_box$1.setFromBufferAttribute(et),this.boundingBox.union(_box$1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$1),this.boundingBox===null&&this.computeBoundingBox();const _e=this.attributes.instanceStart,et=this.attributes.instanceEnd;if(_e!==void 0&&et!==void 0){const rt=this.boundingSphere.center;this.boundingBox.getCenter(rt);let it=0;for(let st=0,ot=_e.count;st<ot;st++)_vector.fromBufferAttribute(_e,st),it=Math.max(it,rt.distanceToSquared(_vector)),_vector.fromBufferAttribute(et,st),it=Math.max(it,rt.distanceToSquared(_vector));this.boundingSphere.radius=Math.sqrt(it),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(_e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(_e)}}UniformsLib.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Vector2$1(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};ShaderLib.line={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,UniformsLib.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class LineMaterial extends ShaderMaterial$1{constructor(_e){super({type:"LineMaterial",uniforms:UniformsUtils.clone(ShaderLib.line.uniforms),vertexShader:ShaderLib.line.vertexShader,fragmentShader:ShaderLib.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(_e)}get color(){return this.uniforms.diffuse.value}set color(_e){this.uniforms.diffuse.value=_e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(_e){_e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(_e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=_e)}get dashed(){return"USE_DASH"in this.defines}set dashed(_e){_e===!0!==this.dashed&&(this.needsUpdate=!0),_e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(_e){this.uniforms.dashScale.value=_e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(_e){this.uniforms.dashSize.value=_e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(_e){this.uniforms.dashOffset.value=_e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(_e){this.uniforms.gapSize.value=_e}get opacity(){return this.uniforms.opacity.value}set opacity(_e){this.uniforms&&(this.uniforms.opacity.value=_e)}get resolution(){return this.uniforms.resolution.value}set resolution(_e){this.uniforms.resolution.value.copy(_e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(_e){this.defines&&(_e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),_e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const _viewport=new Vector4$1,_start=new Vector3$1,_end=new Vector3$1,_start4=new Vector4$1,_end4=new Vector4$1,_ssOrigin=new Vector4$1,_ssOrigin3=new Vector3$1,_mvMatrix=new Matrix4$1,_line=new Line3,_closestPoint=new Vector3$1,_box=new Box3$1,_sphere=new Sphere$1,_clipToWorldVector=new Vector4$1;let _ray$1,_lineWidth;function getWorldSpaceHalfWidth(nt,_e,et){return _clipToWorldVector.set(0,0,-_e,1).applyMatrix4(nt.projectionMatrix),_clipToWorldVector.multiplyScalar(1/_clipToWorldVector.w),_clipToWorldVector.x=_lineWidth/et.width,_clipToWorldVector.y=_lineWidth/et.height,_clipToWorldVector.applyMatrix4(nt.projectionMatrixInverse),_clipToWorldVector.multiplyScalar(1/_clipToWorldVector.w),Math.abs(Math.max(_clipToWorldVector.x,_clipToWorldVector.y))}function raycastWorldUnits(nt,_e){const et=nt.matrixWorld,rt=nt.geometry,it=rt.attributes.instanceStart,st=rt.attributes.instanceEnd,ot=Math.min(rt.instanceCount,it.count);for(let at=0,lt=ot;at<lt;at++){_line.start.fromBufferAttribute(it,at),_line.end.fromBufferAttribute(st,at),_line.applyMatrix4(et);const ct=new Vector3$1,ut=new Vector3$1;_ray$1.distanceSqToSegment(_line.start,_line.end,ut,ct),ut.distanceTo(ct)<_lineWidth*.5&&_e.push({point:ut,pointOnLine:ct,distance:_ray$1.origin.distanceTo(ut),object:nt,face:null,faceIndex:at,uv:null,uv1:null})}}function raycastScreenSpace(nt,_e,et){const rt=_e.projectionMatrix,st=nt.material.resolution,ot=nt.matrixWorld,at=nt.geometry,lt=at.attributes.instanceStart,ct=at.attributes.instanceEnd,ut=Math.min(at.instanceCount,lt.count),ht=-_e.near;_ray$1.at(1,_ssOrigin),_ssOrigin.w=1,_ssOrigin.applyMatrix4(_e.matrixWorldInverse),_ssOrigin.applyMatrix4(rt),_ssOrigin.multiplyScalar(1/_ssOrigin.w),_ssOrigin.x*=st.x/2,_ssOrigin.y*=st.y/2,_ssOrigin.z=0,_ssOrigin3.copy(_ssOrigin),_mvMatrix.multiplyMatrices(_e.matrixWorldInverse,ot);for(let dt=0,ft=ut;dt<ft;dt++){if(_start4.fromBufferAttribute(lt,dt),_end4.fromBufferAttribute(ct,dt),_start4.w=1,_end4.w=1,_start4.applyMatrix4(_mvMatrix),_end4.applyMatrix4(_mvMatrix),_start4.z>ht&&_end4.z>ht)continue;if(_start4.z>ht){const Tt=_start4.z-_end4.z,wt=(_start4.z-ht)/Tt;_start4.lerp(_end4,wt)}else if(_end4.z>ht){const Tt=_end4.z-_start4.z,wt=(_end4.z-ht)/Tt;_end4.lerp(_start4,wt)}_start4.applyMatrix4(rt),_end4.applyMatrix4(rt),_start4.multiplyScalar(1/_start4.w),_end4.multiplyScalar(1/_end4.w),_start4.x*=st.x/2,_start4.y*=st.y/2,_end4.x*=st.x/2,_end4.y*=st.y/2,_line.start.copy(_start4),_line.start.z=0,_line.end.copy(_end4),_line.end.z=0;const mt=_line.closestPointToPointParameter(_ssOrigin3,!0);_line.at(mt,_closestPoint);const At=MathUtils$1.lerp(_start4.z,_end4.z,mt),gt=At>=-1&&At<=1,bt=_ssOrigin3.distanceTo(_closestPoint)<_lineWidth*.5;if(gt&&bt){_line.start.fromBufferAttribute(lt,dt),_line.end.fromBufferAttribute(ct,dt),_line.start.applyMatrix4(ot),_line.end.applyMatrix4(ot);const Tt=new Vector3$1,wt=new Vector3$1;_ray$1.distanceSqToSegment(_line.start,_line.end,wt,Tt),et.push({point:wt,pointOnLine:Tt,distance:_ray$1.origin.distanceTo(wt),object:nt,face:null,faceIndex:dt,uv:null,uv1:null})}}}class LineSegments2 extends Mesh$1{constructor(_e=new LineSegmentsGeometry,et=new LineMaterial({color:Math.random()*16777215})){super(_e,et),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const _e=this.geometry,et=_e.attributes.instanceStart,rt=_e.attributes.instanceEnd,it=new Float32Array(2*et.count);for(let ot=0,at=0,lt=et.count;ot<lt;ot++,at+=2)_start.fromBufferAttribute(et,ot),_end.fromBufferAttribute(rt,ot),it[at]=at===0?0:it[at-1],it[at+1]=it[at]+_start.distanceTo(_end);const st=new InstancedInterleavedBuffer$1(it,2,1);return _e.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute$1(st,1,0)),_e.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute$1(st,1,1)),this}raycast(_e,et){const rt=this.material.worldUnits,it=_e.camera;it===null&&!rt&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const st=_e.params.Line2!==void 0&&_e.params.Line2.threshold||0;_ray$1=_e.ray;const ot=this.matrixWorld,at=this.geometry,lt=this.material;_lineWidth=lt.linewidth+st,at.boundingSphere===null&&at.computeBoundingSphere(),_sphere.copy(at.boundingSphere).applyMatrix4(ot);let ct;if(rt)ct=_lineWidth*.5;else{const ht=Math.max(it.near,_sphere.distanceToPoint(_ray$1.origin));ct=getWorldSpaceHalfWidth(it,ht,lt.resolution)}if(_sphere.radius+=ct,_ray$1.intersectsSphere(_sphere)===!1)return;at.boundingBox===null&&at.computeBoundingBox(),_box.copy(at.boundingBox).applyMatrix4(ot);let ut;if(rt)ut=_lineWidth*.5;else{const ht=Math.max(it.near,_box.distanceToPoint(_ray$1.origin));ut=getWorldSpaceHalfWidth(it,ht,lt.resolution)}_box.expandByScalar(ut),_ray$1.intersectsBox(_box)!==!1&&(rt?raycastWorldUnits(this,et):raycastScreenSpace(this,it,et))}onBeforeRender(_e){const et=this.material.uniforms;et&&et.resolution&&(_e.getViewport(_viewport),this.material.uniforms.resolution.value.set(_viewport.z,_viewport.w))}}class LineGeometry extends LineSegmentsGeometry{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(_e){const et=_e.length-3,rt=new Float32Array(2*et);for(let it=0;it<et;it+=3)rt[2*it]=_e[it],rt[2*it+1]=_e[it+1],rt[2*it+2]=_e[it+2],rt[2*it+3]=_e[it+3],rt[2*it+4]=_e[it+4],rt[2*it+5]=_e[it+5];return super.setPositions(rt),this}setColors(_e){const et=_e.length-3,rt=new Float32Array(2*et);for(let it=0;it<et;it+=3)rt[2*it]=_e[it],rt[2*it+1]=_e[it+1],rt[2*it+2]=_e[it+2],rt[2*it+3]=_e[it+3],rt[2*it+4]=_e[it+4],rt[2*it+5]=_e[it+5];return super.setColors(rt),this}fromLine(_e){const et=_e.geometry;return this.setPositions(et.attributes.position.array),this}}class Line2 extends LineSegments2{constructor(_e=new LineGeometry,et=new LineMaterial({color:Math.random()*16777215})){super(_e,et),this.isLine2=!0,this.type="Line2"}}class TextGeometry extends ExtrudeGeometry{constructor(_e,et={}){const rt=et.font;if(rt===void 0)super();else{const it=rt.generateShapes(_e,et.size);et.depth===void 0&&et.height!==void 0&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),et.depth=et.depth!==void 0?et.depth:et.height!==void 0?et.height:50,et.bevelThickness===void 0&&(et.bevelThickness=10),et.bevelSize===void 0&&(et.bevelSize=8),et.bevelEnabled===void 0&&(et.bevelEnabled=!1),super(it,et)}this.type="TextGeometry"}}class Font{constructor(_e){this.isFont=!0,this.type="Font",this.data=_e}generateShapes(_e,et=100){const rt=[],it=createPaths(_e,et,this.data);for(let st=0,ot=it.length;st<ot;st++)rt.push(...it[st].toShapes());return rt}}function createPaths(nt,_e,et){const rt=Array.from(nt),it=_e/et.resolution,st=(et.boundingBox.yMax-et.boundingBox.yMin+et.underlineThickness)*it,ot=[];let at=0,lt=0;for(let ct=0;ct<rt.length;ct++){const ut=rt[ct];if(ut===`
`)at=0,lt-=st;else{const ht=createPath(ut,it,at,lt,et);at+=ht.offsetX,ot.push(ht.path)}}return ot}function createPath(nt,_e,et,rt,it){const st=it.glyphs[nt]||it.glyphs["?"];if(!st){console.error('THREE.Font: character "'+nt+'" does not exists in font family '+it.familyName+".");return}const ot=new ShapePath;let at,lt,ct,ut,ht,dt,ft,pt;if(st.o){const mt=st._cachedOutline||(st._cachedOutline=st.o.split(" "));for(let At=0,gt=mt.length;At<gt;)switch(mt[At++]){case"m":at=mt[At++]*_e+et,lt=mt[At++]*_e+rt,ot.moveTo(at,lt);break;case"l":at=mt[At++]*_e+et,lt=mt[At++]*_e+rt,ot.lineTo(at,lt);break;case"q":ct=mt[At++]*_e+et,ut=mt[At++]*_e+rt,ht=mt[At++]*_e+et,dt=mt[At++]*_e+rt,ot.quadraticCurveTo(ht,dt,ct,ut);break;case"b":ct=mt[At++]*_e+et,ut=mt[At++]*_e+rt,ht=mt[At++]*_e+et,dt=mt[At++]*_e+rt,ft=mt[At++]*_e+et,pt=mt[At++]*_e+rt,ot.bezierCurveTo(ht,dt,ft,pt,ct,ut);break}}return{offsetX:st.ha*_e,path:ot}}function _arrayLikeToArray$2(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles$1(nt){if(Array.isArray(nt))return nt}function _arrayWithoutHoles$2(nt){if(Array.isArray(nt))return _arrayLikeToArray$2(nt)}function _assertClassBrand(nt,_e,et){if(typeof nt=="function"?nt===_e:nt.has(_e))return arguments.length<3?_e:et;throw new TypeError("Private element is not present on this object")}function _assertThisInitialized$1(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _callSuper(nt,_e,et){return _e=_getPrototypeOf$1(_e),_possibleConstructorReturn(nt,_isNativeReflectConstruct$1()?Reflect.construct(_e,et||[],_getPrototypeOf$1(nt).constructor):_e.apply(nt,et))}function _checkPrivateRedeclaration(nt,_e){if(_e.has(nt))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classCallCheck(nt,_e){if(!(nt instanceof _e))throw new TypeError("Cannot call a class as a function")}function _classPrivateFieldGet2(nt,_e){return nt.get(_assertClassBrand(nt,_e))}function _classPrivateFieldInitSpec(nt,_e,et){_checkPrivateRedeclaration(nt,_e),_e.set(nt,et)}function _classPrivateFieldSet2(nt,_e,et){return nt.set(_assertClassBrand(nt,_e),et),et}function _classPrivateMethodInitSpec(nt,_e){_checkPrivateRedeclaration(nt,_e),_e.add(nt)}function _construct$1(nt,_e,et){if(_isNativeReflectConstruct$1())return Reflect.construct.apply(null,arguments);var rt=[null];rt.push.apply(rt,_e);var it=new(nt.bind.apply(nt,rt));return it}function _defineProperties(nt,_e){for(var et=0;et<_e.length;et++){var rt=_e[et];rt.enumerable=rt.enumerable||!1,rt.configurable=!0,"value"in rt&&(rt.writable=!0),Object.defineProperty(nt,_toPropertyKey$2(rt.key),rt)}}function _createClass(nt,_e,et){return _e&&_defineProperties(nt.prototype,_e),Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _defineProperty$2(nt,_e,et){return(_e=_toPropertyKey$2(_e))in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _getPrototypeOf$1(nt){return _getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf$1(nt)}function _inherits(nt,_e){if(typeof _e!="function"&&_e!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(_e&&_e.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),_e&&_setPrototypeOf$1(nt,_e)}function _isNativeReflectConstruct$1(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$1=function(){return!!nt})()}function _iterableToArray$2(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _iterableToArrayLimit$1(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e===0){if(Object(et)!==et)return;lt=!1}else for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread$2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys$1(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread2$1(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$1(Object(et),!0).forEach(function(rt){_defineProperty$2(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys$1(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}function _objectWithoutProperties$1(nt,_e){if(nt==null)return{};var et,rt,it=_objectWithoutPropertiesLoose$1(nt,_e);if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(rt=0;rt<st.length;rt++)et=st[rt],_e.includes(et)||{}.propertyIsEnumerable.call(nt,et)&&(it[et]=nt[et])}return it}function _objectWithoutPropertiesLoose$1(nt,_e){if(nt==null)return{};var et={};for(var rt in nt)if({}.hasOwnProperty.call(nt,rt)){if(_e.includes(rt))continue;et[rt]=nt[rt]}return et}function _possibleConstructorReturn(nt,_e){if(_e&&(typeof _e=="object"||typeof _e=="function"))return _e;if(_e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(nt)}function _setPrototypeOf$1(nt,_e){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(et,rt){return et.__proto__=rt,et},_setPrototypeOf$1(nt,_e)}function _slicedToArray$1(nt,_e){return _arrayWithHoles$1(nt)||_iterableToArrayLimit$1(nt,_e)||_unsupportedIterableToArray$2(nt,_e)||_nonIterableRest$1()}function _toConsumableArray$2(nt){return _arrayWithoutHoles$2(nt)||_iterableToArray$2(nt)||_unsupportedIterableToArray$2(nt)||_nonIterableSpread$2()}function _toPrimitive$2(nt,_e){if(typeof nt!="object"||!nt)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey$2(nt){var _e=_toPrimitive$2(nt,"string");return typeof _e=="symbol"?_e:_e+""}function _unsupportedIterableToArray$2(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$2(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$2(nt,_e):void 0}}var _materialDispose=function(_e){_e instanceof Array?_e.forEach(_materialDispose):(_e.map&&_e.map.dispose(),_e.dispose())},_deallocate=function(_e){_e.geometry&&_e.geometry.dispose(),_e.material&&_materialDispose(_e.material),_e.texture&&_e.texture.dispose(),_e.children&&_e.children.forEach(_deallocate)},emptyObject=function(_e){if(_e&&_e.children)for(;_e.children.length;){var et=_e.children[0];_e.remove(et),_deallocate(et)}};function linkKapsule$1(nt,_e){var et=new _e;return{linkProp:function(it){return{default:et[it](),onChange:function(ot,at){at[nt][it](ot)},triggerUpdate:!1}},linkMethod:function(it){return function(st){for(var ot=st[nt],at=arguments.length,lt=new Array(at>1?at-1:0),ct=1;ct<at;ct++)lt[ct-1]=arguments[ct];var ut=ot[it].apply(ot,lt);return ut===ot?this:ut}}}}var GLOBE_RADIUS=100;function getGlobeRadius(){return GLOBE_RADIUS}function polar2Cartesian(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,rt=(90-nt)*Math.PI/180,it=(90-_e)*Math.PI/180,st=GLOBE_RADIUS*(1+et);return{x:st*Math.sin(rt)*Math.cos(it),y:st*Math.cos(rt),z:st*Math.sin(rt)*Math.sin(it)}}function cartesian2Polar(nt){var _e=nt.x,et=nt.y,rt=nt.z,it=Math.sqrt(_e*_e+et*et+rt*rt),st=Math.acos(et/it),ot=Math.atan2(rt,_e);return{lat:90-st*180/Math.PI,lng:90-ot*180/Math.PI-(ot<-Math.PI/2?360:0),altitude:it/GLOBE_RADIUS-1}}function deg2Rad$1(nt){return nt*Math.PI/180}var THREE$h=window.THREE?window.THREE:{BackSide:BackSide$1,BufferAttribute:BufferAttribute$1,Color:Color$2,Mesh:Mesh$1,ShaderMaterial:ShaderMaterial$1},fragmentShader=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
void main() {
  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`,vertexShader=`
varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
void main() {
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,defaultOptions={backside:!0,coefficient:.5,color:"gold",size:2,power:1};function createGlowMaterial(nt,_e,et){return new THREE$h.ShaderMaterial({depthWrite:!1,fragmentShader,transparent:!0,uniforms:{coefficient:{value:nt},color:{value:new THREE$h.Color(_e)},power:{value:et}},vertexShader})}function createGlowGeometry(nt,_e){for(var et=nt.clone(),rt=new Float32Array(nt.attributes.position.count*3),it=0,st=rt.length;it<st;it++){var ot=nt.attributes.normal.array[it],at=nt.attributes.position.array[it];rt[it]=at+ot*_e}return et.setAttribute("position",new THREE$h.BufferAttribute(rt,3)),et}function createGlowMesh(nt){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:defaultOptions,et=_e.backside,rt=_e.coefficient,it=_e.color,st=_e.size,ot=_e.power,at=createGlowGeometry(nt,st),lt=createGlowMaterial(rt,it,ot);return et&&(lt.side=THREE$h.BackSide),new THREE$h.Mesh(at,lt)}var THREE$g=window.THREE?window.THREE:{Color:Color$2,LineBasicMaterial:LineBasicMaterial$1,LineSegments,Mesh:Mesh$1,MeshPhongMaterial:MeshPhongMaterial$1,SphereGeometry:SphereGeometry$1,SRGBColorSpace:SRGBColorSpace$2,TextureLoader},GlobeLayerKapsule=index$2({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(_e,et){et.globeObj.visible=!!_e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(_e,et){et.graticulesObj.visible=!!_e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(_e,et){et.atmosphereObj&&(et.atmosphereObj.visible=!!_e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(_e,et){return et!==void 0?(_e.globeObj.material=et||_e.defaultGlobeMaterial,this):_e.globeObj.material},_destructor:function(_e){emptyObject(_e.globeObj),emptyObject(_e.graticulesObj)}},stateInit:function(){var _e=new THREE$g.SphereGeometry(GLOBE_RADIUS,75,75),et=new THREE$g.MeshPhongMaterial({color:0}),rt=new THREE$g.Mesh(_e,et);rt.rotation.y=-Math.PI/2,rt.__globeObjType="globe";var it=new THREE$g.LineSegments(new GeoJsonGeometry(graticule10(),GLOBE_RADIUS,2),new THREE$g.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeObj:rt,graticulesObj:it,defaultGlobeMaterial:et}},init:function(_e,et){emptyObject(_e),et.scene=_e,et.scene.add(et.globeObj),et.scene.add(et.graticulesObj),et.ready=!1},update:function(_e,et){var rt=_e.globeObj.material;if(et.hasOwnProperty("globeImageUrl")&&(_e.globeImageUrl?new THREE$g.TextureLoader().load(_e.globeImageUrl,function(st){st.colorSpace=THREE$g.SRGBColorSpace,rt.map=st,rt.color=null,rt.needsUpdate=!0,!_e.ready&&(_e.ready=!0)&&setTimeout(_e.onReady)}):!rt.color&&(rt.color=new THREE$g.Color(0))),et.hasOwnProperty("bumpImageUrl")&&(_e.bumpImageUrl?_e.bumpImageUrl&&new THREE$g.TextureLoader().load(_e.bumpImageUrl,function(st){rt.bumpMap=st,rt.needsUpdate=!0}):(rt.bumpMap=null,rt.needsUpdate=!0)),(et.hasOwnProperty("atmosphereColor")||et.hasOwnProperty("atmosphereAltitude"))&&(_e.atmosphereObj&&(_e.scene.remove(_e.atmosphereObj),emptyObject(_e.atmosphereObj)),_e.atmosphereColor&&_e.atmosphereAltitude)){var it=_e.atmosphereObj=createGlowMesh(_e.globeObj.geometry,{backside:!0,color:_e.atmosphereColor,size:GLOBE_RADIUS*_e.atmosphereAltitude,power:3.5,coefficient:.1});it.visible=!!_e.showAtmosphere,it.__globeObjType="atmosphere",_e.scene.add(it)}!_e.ready&&!_e.globeImageUrl&&(_e.ready=!0,_e.onReady())}}),colorStr2Hex=function(_e){return isNaN(_e)?parseInt(tinycolor(_e).toHex(),16):_e},colorAlpha=function(_e){return _e&&isNaN(_e)?color$3(_e).opacity:1},color2ShaderArr=function(_e){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,it,st=1,ot=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(_e.trim().toLowerCase());if(ot){var at=ot.slice(1),lt=_slicedToArray$1(at,4),ct=lt[0],ut=lt[1],ht=lt[2],dt=lt[3];it=new Color$2("rgb(".concat(+ct,",").concat(+ut,",").concat(+ht,")")),st=Math.min(+dt,1)}else it=new Color$2(_e);rt&&it.convertLinearToSRGB();var ft=it.toArray();return et?[].concat(_toConsumableArray$2(ft),[st]):ft};function setMaterialOpacity(nt,_e,et){return nt.opacity=_e,nt.transparent=_e<1,nt.depthWrite=_e>=1,nt}var THREE$f=window.THREE?window.THREE:{Float32BufferAttribute:Float32BufferAttribute$1};function array2BufferAttr(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:THREE$f.Float32BufferAttribute,rt=new et(nt.length*_e,_e);return _e===1?nt.forEach(function(it,st){return rt.setX(st,it)}):nt.forEach(function(it,st){return rt.set(it,st*_e)}),rt}function bufferAttr2Array(nt){for(var _e=nt.itemSize,et=[],rt=0;rt<nt.count;rt++)et.push(nt.array.slice(rt*_e,(rt+1)*_e));return et}function threeDigest(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},rt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},it=rt.removeDelay,st=it===void 0?0:it;return viewDigest(nt,_e.children,function(ot){return _e.add(ot)},function(ot){var at=function(){_e.remove(ot),emptyObject(ot),ot&&ot.hasOwnProperty("__data")&&delete ot.__data.__currentTargetD};st?setTimeout(at,st):at()},_objectSpread2$1({objBindAttr:"__threeObj"},et))}var THREE$e=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,Color:Color$2,CylinderGeometry,Matrix4:Matrix4$1,Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,Object3D:Object3D$1,Vector3:Vector3$1},bfg$2=Object.assign({},_bfg),BufferGeometryUtils$2=bfg$2.BufferGeometryUtils||bfg$2,PointsLayerKapsule=index$2({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.pointLat),rt=index$1(_e.pointLng),it=index$1(_e.pointAltitude),st=index$1(_e.pointRadius),ot=index$1(_e.pointColor),at=new THREE$e.CylinderGeometry(1,1,1,_e.pointResolution);at.applyMatrix4(new THREE$e.Matrix4().makeRotationX(Math.PI/2)),at.applyMatrix4(new THREE$e.Matrix4().makeTranslation(0,0,-.5));var lt=2*Math.PI*GLOBE_RADIUS/360,ct={},ut=_e.pointsMerge?new THREE$e.Object3D:_e.scene;if(threeDigest(_e.pointsData,ut,{createObj:ft,updateObj:pt}),_e.pointsMerge){var ht=_e.pointsData.length?(BufferGeometryUtils$2.mergeGeometries||BufferGeometryUtils$2.mergeBufferGeometries)(_e.pointsData.map(function(mt){var At=mt.__threeObj;mt.__threeObj=void 0;var gt=At.geometry.clone();At.updateMatrix(),gt.applyMatrix4(At.matrix);var bt=color2ShaderArr(ot(mt));return gt.setAttribute("color",array2BufferAttr(_toConsumableArray$2(new Array(gt.getAttribute("position").count)).map(function(){return bt}),4)),gt})):new THREE$e.BufferGeometry,dt=new THREE$e.Mesh(ht,new THREE$e.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));dt.__globeObjType="points",dt.__data=_e.pointsData,emptyObject(_e.scene),_e.scene.add(dt)}function ft(){var mt=new THREE$e.Mesh(at);return mt.__globeObjType="point",mt}function pt(mt,At){var gt=function($t){var kt=mt.__currentTargetD=$t,Dt=kt.r,Ot=kt.alt,zt=kt.lat,Ht=kt.lng;Object.assign(mt.position,polar2Cartesian(zt,Ht));var Yt=_e.pointsMerge?new THREE$e.Vector3(0,0,0):_e.scene.localToWorld(new THREE$e.Vector3(0,0,0));mt.lookAt(Yt),mt.scale.x=mt.scale.y=Math.min(30,Dt)*lt,mt.scale.z=Math.max(Ot*GLOBE_RADIUS,.1)},bt={alt:+it(At),r:+st(At),lat:+et(At),lng:+rt(At)},Tt=mt.__currentTargetD||Object.assign({},bt,{alt:-.001});if(Object.keys(bt).some(function(Lt){return Tt[Lt]!==bt[Lt]})&&(_e.pointsMerge||!_e.pointsTransitionDuration||_e.pointsTransitionDuration<0?gt(bt):_e.tweenGroup.add(new Tween(Tt).to(bt,_e.pointsTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(gt).start())),!_e.pointsMerge){var wt=ot(At),Rt=wt?colorAlpha(wt):0,It=!!Rt;mt.visible=It,It&&(ct.hasOwnProperty(wt)||(ct[wt]=new THREE$e.MeshLambertMaterial({color:colorStr2Hex(wt),transparent:Rt<1,opacity:Rt})),mt.material=ct[wt])}}}}),_excluded$1=["stroke"],THREE$d=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,CubicBezierCurve3,Curve,Group:Group$1,Line,Mesh:Mesh$1,NormalBlending:NormalBlending$1,QuadraticBezierCurve3,ShaderMaterial:ShaderMaterial$1,TubeGeometry,Vector3:Vector3$1},FrameTicker$2=_FrameTicker.default||_FrameTicker,gradientShaders$1={uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    uniform float dashTranslate; 

    attribute vec4 vertexColor;
    varying vec4 vColor;
    
    attribute float vertexRelDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = vertexColor;
      vRelDistance = vertexRelDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,fragmentShader:`
    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
    }
  `},ArcsLayerKapsule=index$2({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.pause()},resumeAnimation:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.resume()},_destructor:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.dispose()}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it,et.ticker=new FrameTicker$2,et.ticker.onTick.add(function(st,ot){et.arcsData.filter(function(at){return at.__threeObj&&at.__threeObj.children.length&&at.__threeObj.children[0].material&&at.__threeObj.children[0].__dashAnimateStep}).forEach(function(at){var lt=at.__threeObj.children[0],ct=lt.__dashAnimateStep*ot,ut=lt.material.uniforms.dashTranslate.value%1e9;lt.material.uniforms.dashTranslate.value=ut+ct})})},update:function(_e){var et=index$1(_e.arcStartLat),rt=index$1(_e.arcStartLng),it=index$1(_e.arcEndLat),st=index$1(_e.arcEndLng),ot=index$1(_e.arcAltitude),at=index$1(_e.arcAltitudeAutoScale),lt=index$1(_e.arcStroke),ct=index$1(_e.arcColor),ut=index$1(_e.arcDashLength),ht=index$1(_e.arcDashGap),dt=index$1(_e.arcDashInitialGap),ft=index$1(_e.arcDashAnimateTime),pt=new THREE$d.ShaderMaterial(_objectSpread2$1(_objectSpread2$1({},gradientShaders$1),{},{transparent:!0,blending:THREE$d.NormalBlending}));threeDigest(_e.arcsData,_e.scene,{createObj:function(){var Tt=new THREE$d.Group;return Tt.__globeObjType="arc",Tt},updateObj:function(Tt,wt){var Rt=lt(wt),It=Rt!=null;if(!Tt.children.length||It!==(Tt.children[0].type==="Mesh")){emptyObject(Tt);var Lt=It?new THREE$d.Mesh:new THREE$d.Line(new THREE$d.BufferGeometry);Lt.material=pt.clone(),Tt.add(Lt)}var $t=Tt.children[0];Object.assign($t.material.uniforms,{dashSize:{value:ut(wt)},gapSize:{value:ht(wt)},dashOffset:{value:dt(wt)}});var kt=ft(wt);$t.__dashAnimateStep=kt>0?1e3/kt:0;var Dt=At(ct(wt),_e.arcCurveResolution,It?_e.arcCircularResolution+1:1),Ot=gt(_e.arcCurveResolution,It?_e.arcCircularResolution+1:1,!0);$t.geometry.setAttribute("vertexColor",Dt),$t.geometry.setAttribute("vertexRelDistance",Ot);var zt=function(Zt){var rn=wt.__currentTargetD=Zt,Gt=rn.stroke,jt=_objectWithoutProperties$1(rn,_excluded$1),Kt=mt(jt);It?($t.geometry&&$t.geometry.dispose(),$t.geometry=new THREE$d.TubeGeometry(Kt,_e.arcCurveResolution,Gt/2,_e.arcCircularResolution),$t.geometry.setAttribute("vertexColor",Dt),$t.geometry.setAttribute("vertexRelDistance",Ot)):$t.geometry.setFromPoints(Kt.getPoints(_e.arcCurveResolution))},Ht={stroke:Rt,alt:ot(wt),altAutoScale:+at(wt),startLat:+et(wt),startLng:+rt(wt),endLat:+it(wt),endLng:+st(wt)},Yt=wt.__currentTargetD||Object.assign({},Ht,{altAutoScale:-.001});Object.keys(Ht).some(function(Xt){return Yt[Xt]!==Ht[Xt]})&&(!_e.arcsTransitionDuration||_e.arcsTransitionDuration<0?zt(Ht):_e.tweenGroup.add(new Tween(Yt).to(Ht,_e.arcsTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(zt).start()))}});function mt(bt){var Tt=bt.alt,wt=bt.altAutoScale,Rt=bt.startLat,It=bt.startLng,Lt=bt.endLat,$t=bt.endLng,kt=function(sn){var hn=_slicedToArray$1(sn,3),an=hn[0],pn=hn[1],_n=hn[2],yn=polar2Cartesian(pn,an,_n),$n=yn.x,Jn=yn.y,Xn=yn.z;return new THREE$d.Vector3($n,Jn,Xn)},Dt=[It,Rt],Ot=[$t,Lt],zt=Tt;if(zt==null&&(zt=geoDistance$1(Dt,Ot)/2*wt),zt){var Ht=geoInterpolate(Dt,Ot),Yt=[.25,.75].map(function(Jt){return[].concat(_toConsumableArray$2(Ht(Jt)),[zt*1.5])}),Xt=_slicedToArray$1(Yt,2),Zt=Xt[0],rn=Xt[1],Gt=_construct$1(THREE$d.CubicBezierCurve3,_toConsumableArray$2([Dt,Zt,rn,Ot].map(kt)));return Gt}else{var jt=.001;return Kt.apply(void 0,_toConsumableArray$2([[].concat(Dt,[jt]),[].concat(Ot,[jt])].map(kt)))}function Kt(Jt,sn){var hn=Jt.angleTo(sn),an=hn===0?function(){return Jt.clone()}:function(_n){return new THREE$d.Vector3().addVectors(Jt.clone().multiplyScalar(Math.sin((1-_n)*hn)),sn.clone().multiplyScalar(Math.sin(_n*hn))).divideScalar(Math.sin(hn))},pn=new THREE$d.Curve;return pn.getPoint=an,pn}}function At(bt,Tt){var wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Rt=Tt+1,It;if(bt instanceof Array||bt instanceof Function){var Lt=bt instanceof Array?linear().domain(bt.map(function(Yt,Xt){return Xt/(bt.length-1)})).range(bt):bt;It=function(Xt){return color2ShaderArr(Lt(Xt),!0,!0)}}else{var $t=color2ShaderArr(bt,!0,!0);It=function(){return $t}}for(var kt=[],Dt=0,Ot=Rt;Dt<Ot;Dt++)for(var zt=It(Dt/(Ot-1)),Ht=0;Ht<wt;Ht++)kt.push(zt);return array2BufferAttr(kt,4)}function gt(bt){for(var Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Rt=bt+1,It=[],Lt=0,$t=Rt;Lt<$t;Lt++)for(var kt=Lt/($t-1),Dt=0;Dt<Tt;Dt++)It.push(kt);return wt&&It.reverse(),array2BufferAttr(It,1)}}}),THREE$c=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,Color:Color$2,DoubleSide:DoubleSide$1,Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,Object3D:Object3D$1},bfg$1=Object.assign({},_bfg),BufferGeometryUtils$1=bfg$1.BufferGeometryUtils||bfg$1,HexBinLayerKapsule=index$2({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(_e){var et=_e.sumWeight;return et*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.hexBinPointLat),rt=index$1(_e.hexBinPointLng),it=index$1(_e.hexBinPointWeight),st=index$1(_e.hexAltitude),ot=index$1(_e.hexTopColor),at=index$1(_e.hexSideColor),lt=index$1(_e.hexMargin),ct=index(_e.hexBinPointsData.map(function(gt){return _objectSpread2$1(_objectSpread2$1({},gt),{},{h3Idx:latLngToCell(et(gt),rt(gt),_e.hexBinResolution)})}),"h3Idx"),ut=Object.entries(ct).map(function(gt){var bt=_slicedToArray$1(gt,2),Tt=bt[0],wt=bt[1];return{h3Idx:Tt,points:wt,sumWeight:wt.reduce(function(Rt,It){return Rt+ +it(It)},0)}}),ht={},dt=_e.hexBinMerge?new THREE$c.Object3D:_e.scene;if(threeDigest(ut,dt,{createObj:mt,updateObj:At,idAccessor:function(bt){return bt.h3Idx}}),_e.hexBinMerge){var ft=ut.length?(BufferGeometryUtils$1.mergeGeometries||BufferGeometryUtils$1.mergeBufferGeometries)(ut.map(function(gt){var bt=gt.__threeObj;gt.__threeObj=void 0;var Tt=bt.geometry.toNonIndexed();bt.updateMatrix(),Tt.applyMatrix4(bt.matrix);var wt=color2ShaderArr(ot(gt)),Rt=color2ShaderArr(at(gt)),It=Tt.getAttribute("position").count,Lt=Tt.groups[0].count;return Tt.setAttribute("color",array2BufferAttr(_toConsumableArray$2(new Array(It)).map(function($t,kt){return kt>=Lt?wt:Rt}),4)),Tt})):new THREE$c.BufferGeometry,pt=new THREE$c.Mesh(ft,new THREE$c.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:THREE$c.DoubleSide}));pt.__globeObjType="hexBinPoints",pt.__data=ut,emptyObject(_e.scene),_e.scene.add(pt)}function mt(gt){var bt=new THREE$c.Mesh;bt.__hexCenter=cellToLatLng(gt.h3Idx),bt.__hexGeoJson=cellToBoundary(gt.h3Idx,!0).reverse();var Tt=bt.__hexCenter[1];return bt.__hexGeoJson.forEach(function(wt){var Rt=wt[0];Math.abs(Tt-Rt)>170&&(wt[0]+=Tt>Rt?360:-360)}),bt.__globeObjType="hexbin",bt}function At(gt,bt){var Tt=function(Zt,rn,Gt){return Zt-(Zt-rn)*Gt},wt=Math.max(0,Math.min(1,+lt(bt))),Rt=_slicedToArray$1(gt.__hexCenter,2),It=Rt[0],Lt=Rt[1],$t=wt===0?gt.__hexGeoJson:gt.__hexGeoJson.map(function(Xt){var Zt=_slicedToArray$1(Xt,2),rn=Zt[0],Gt=Zt[1];return[[rn,Lt],[Gt,It]].map(function(jt){var Kt=_slicedToArray$1(jt,2),Jt=Kt[0],sn=Kt[1];return Tt(Jt,sn,wt)})}),kt=_e.hexTopCurvatureResolution;gt.geometry&&gt.geometry.dispose(),gt.geometry=new ConicPolygonBufferGeometry([$t],0,GLOBE_RADIUS,!1,!0,!0,kt);var Dt={alt:+st(bt)},Ot=function(Zt){var rn=gt.__currentTargetD=Zt,Gt=rn.alt;gt.scale.x=gt.scale.y=gt.scale.z=1+Gt},zt=gt.__currentTargetD||Object.assign({},Dt,{alt:-.001});if(Object.keys(Dt).some(function(Xt){return zt[Xt]!==Dt[Xt]})&&(_e.hexBinMerge||!_e.hexTransitionDuration||_e.hexTransitionDuration<0?Ot(Dt):_e.tweenGroup.add(new Tween(zt).to(Dt,_e.hexTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(Ot).start())),!_e.hexBinMerge){var Ht=at(bt),Yt=ot(bt);[Ht,Yt].forEach(function(Xt){if(!ht.hasOwnProperty(Xt)){var Zt=colorAlpha(Xt);ht[Xt]=new THREE$c.MeshLambertMaterial({color:colorStr2Hex(Xt),transparent:Zt<1,opacity:Zt,side:THREE$c.DoubleSide})}}),gt.material=[Ht,Yt].map(function(Xt){return ht[Xt]})}}}}),sq=function(_e){return _e*_e};function geoDistance(nt,_e){var et=Math.sqrt,rt=Math.cos,it=function(ht){return ht*Math.PI/180},st=function(ht){return sq(Math.sin(ht/2))},ot=it(nt[1]),at=it(_e[1]),lt=it(nt[0]),ct=it(_e[0]);return 2*Math.asin(et(st(at-ot)+rt(ot)*rt(at)*st(ct-lt)))}var sqrt2PI=Math.sqrt(2*Math.PI);function gaussianKernel(nt,_e){return Math.exp(-sq(nt/_e)/2)/(_e*sqrt2PI)}var getGeoKDE=function(_e){var et=_slicedToArray$1(_e,2),rt=et[0],it=et[1],st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],ot=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},at=ot.lngAccessor,lt=at===void 0?function(At){return At[0]}:at,ct=ot.latAccessor,ut=ct===void 0?function(At){return At[1]}:ct,ht=ot.weightAccessor,dt=ht===void 0?function(){return 1}:ht,ft=ot.bandwidth,pt=[rt,it],mt=ft*Math.PI/180;return sum$1(st.map(function(At){var gt=dt(At);if(!gt)return 0;var bt=geoDistance(pt,[lt(At),ut(At)]);return gaussianKernel(bt,mt)*gt}))},THREE$b=window.THREE?window.THREE:{Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,SphereGeometry:SphereGeometry$1},RES_BW_FACTOR=3.5,MIN_RESOLUTION=.1,BW_RADIUS_INFLUENCE=3.5,_PointsOctree_brand=new WeakSet,_points$1=new WeakMap,_pntOctree=new WeakMap,_distance=new WeakMap,PointsOctree=function(){function nt(_e,et){_classCallCheck(this,nt),_classPrivateMethodInitSpec(this,_PointsOctree_brand),_classPrivateFieldInitSpec(this,_points$1,void 0),_classPrivateFieldInitSpec(this,_pntOctree,void 0),_classPrivateFieldInitSpec(this,_distance,void 0),_classPrivateFieldSet2(_points$1,this,_e),_classPrivateFieldSet2(_pntOctree,this,yaOctree()),_classPrivateFieldGet2(_pntOctree,this).init(_e.map(function(rt){return[rt.x,rt.y,rt.z]}).flat()),_classPrivateFieldSet2(_distance,this,_assertClassBrand(_PointsOctree_brand,this,_getDistance).call(this,polar2Cartesian(0,0),polar2Cartesian(0,Math.min(180,et))))}return _createClass(nt,[{key:"getNearPoints",value:function(et,rt,it){var st=this;return _classPrivateFieldGet2(_pntOctree,this).intersectSphere(et,rt,it,_classPrivateFieldGet2(_distance,this)).map(function(ot){return _classPrivateFieldGet2(_points$1,st)[ot/3]})}}])}();function _getDistance(nt,_e){return Math.sqrt(Math.pow(nt.x-_e.x,2)+Math.pow(nt.y-_e.y,2)+Math.pow(nt.z-_e.z,2))}var defaultColorInterpolator=function(_e){var et=color$3(interpolateTurbo(_e));return et.opacity=Math.cbrt(_e),et.formatRgb()},HeatmapsLayerKapsule=index$2({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(_e){return _e}},heatmapPointLat:{default:function(_e){return _e[0]}},heatmapPointLng:{default:function(_e){return _e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:4},heatmapColorFn:{default:function(){return defaultColorInterpolator}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.heatmapPoints),rt=index$1(_e.heatmapPointLat),it=index$1(_e.heatmapPointLng),st=index$1(_e.heatmapPointWeight),ot=index$1(_e.heatmapBandwidth),at=index$1(_e.heatmapColorFn),lt=index$1(_e.heatmapColorSaturation),ct=index$1(_e.heatmapBaseAltitude),ut=index$1(_e.heatmapTopAltitude);threeDigest(_e.heatmapsData,_e.scene,{createObj:function(dt){var ft=new THREE$b.Mesh(new THREE$b.SphereGeometry(GLOBE_RADIUS),new THREE$b.MeshLambertMaterial({vertexColors:!0,transparent:!0}));return ft.__globeObjType="heatmap",ft},updateObj:function(dt,ft){var pt=ot(ft),mt=at(ft),At=lt(ft),gt=ct(ft),bt=ut(ft),Tt=et(ft).map(function(Ht){var Yt=rt(Ht),Xt=it(Ht),Zt=polar2Cartesian(Yt,Xt),rn=Zt.x,Gt=Zt.y,jt=Zt.z;return{x:rn,y:Gt,z:jt,lat:Yt,lng:Xt,weight:st(Ht)}}),wt=Math.max(MIN_RESOLUTION,pt/RES_BW_FACTOR),Rt=Math.ceil(360/(wt||-1));dt.geometry.parameters.widthSegments!==Rt&&(dt.geometry.dispose(),dt.geometry=new THREE$b.SphereGeometry(GLOBE_RADIUS,Rt,Rt/2));var It=bufferAttr2Array(dt.geometry.getAttribute("position")),Lt=It.map(function(Ht){var Yt=_slicedToArray$1(Ht,3),Xt=Yt[0],Zt=Yt[1],rn=Yt[2],Gt=cartesian2Polar({x:Xt,y:Zt,z:rn}),jt=Gt.lng,Kt=Gt.lat;return[jt,Kt]}),$t=new PointsOctree(Tt,pt*BW_RADIUS_INFLUENCE),kt=Lt.map(function(Ht,Yt){var Xt=_slicedToArray$1(It[Yt],3),Zt=Xt[0],rn=Xt[1],Gt=Xt[2];return getGeoKDE(Ht,$t.getNearPoints(Zt,rn,Gt),{latAccessor:function(Kt){return Kt.lat},lngAccessor:function(Kt){return Kt.lng},weightAccessor:function(Kt){return Kt.weight},bandwidth:pt})}),Dt=function(Yt){var Xt=dt.__currentTargetD=Yt,Zt=Xt.kdeVals,rn=Xt.topAlt,Gt=Xt.saturation,jt=max$2(Zt.map(Math.abs))||1e-15;dt.geometry.setAttribute("color",array2BufferAttr(Zt.map(function(Jt){return color2ShaderArr(mt(Jt/jt*Gt))}),4));var Kt=linear([0,jt],[gt,rn||gt]);dt.geometry.setAttribute("position",array2BufferAttr(Zt.map(function(Jt,sn){var hn=_slicedToArray$1(Lt[sn],2),an=hn[0],pn=hn[1],_n=Kt(Math.abs(Jt)),yn=polar2Cartesian(pn,an,_n);return[yn.x,yn.y,yn.z]}),3))},Ot={kdeVals:kt,topAlt:bt,saturation:At},zt=dt.__currentTargetD||Object.assign({},Ot,{kdeVals:kt.map(function(){return 0}),topAlt:bt&&gt,saturation:.5});zt.kdeVals.length!==kt.length&&(zt.kdeVals=kt.slice()),Object.keys(Ot).some(function(Ht){return zt[Ht]!==Ot[Ht]})&&(!_e.heatmapsTransitionDuration||_e.heatmapsTransitionDuration<0?Dt(Ot):_e.tweenGroup.add(new Tween(zt).to(Ot,_e.heatmapsTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(Dt).start()))}})}}),THREE$a=window.THREE?window.THREE:{DoubleSide:DoubleSide$1,Group:Group$1,LineBasicMaterial:LineBasicMaterial$1,LineSegments,Mesh:Mesh$1,MeshBasicMaterial:MeshBasicMaterial$1},PolygonsLayerKapsule=index$2({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.polygonGeoJsonGeometry),rt=index$1(_e.polygonAltitude),it=index$1(_e.polygonCapCurvatureResolution),st=index$1(_e.polygonCapColor),ot=index$1(_e.polygonCapMaterial),at=index$1(_e.polygonSideColor),lt=index$1(_e.polygonSideMaterial),ct=index$1(_e.polygonStrokeColor),ut=[];_e.polygonsData.forEach(function(ht){var dt={data:ht,capColor:st(ht),capMaterial:ot(ht),sideColor:at(ht),sideMaterial:lt(ht),strokeColor:ct(ht),altitude:+rt(ht),capCurvatureResolution:+it(ht)},ft=et(ht),pt=ht.__id||"".concat(Math.round(Math.random()*1e9));ht.__id=pt,ft.type==="Polygon"?ut.push(_objectSpread2$1({id:"".concat(pt,"_0"),coords:ft.coordinates},dt)):ft.type==="MultiPolygon"?ut.push.apply(ut,_toConsumableArray$2(ft.coordinates.map(function(mt,At){return _objectSpread2$1({id:"".concat(pt,"_").concat(At),coords:mt},dt)}))):console.warn("Unsupported GeoJson geometry type: ".concat(ft.type,". Skipping geometry..."))}),threeDigest(ut,_e.scene,{idAccessor:function(dt){return dt.id},createObj:function(){var dt=new THREE$a.Group;return dt.__defaultSideMaterial=new THREE$a.MeshBasicMaterial({side:THREE$a.DoubleSide,depthWrite:!0}),dt.__defaultCapMaterial=new THREE$a.MeshBasicMaterial({side:THREE$a.DoubleSide,depthWrite:!0}),dt.add(new THREE$a.Mesh(void 0,[dt.__defaultSideMaterial,dt.__defaultCapMaterial])),dt.add(new THREE$a.LineSegments(void 0,new THREE$a.LineBasicMaterial)),dt.__globeObjType="polygon",dt},updateObj:function(dt,ft){var pt=ft.coords,mt=ft.capColor,At=ft.capMaterial,gt=ft.sideColor,bt=ft.sideMaterial,Tt=ft.strokeColor,wt=ft.altitude,Rt=ft.capCurvatureResolution,It=_slicedToArray$1(dt.children,2),Lt=It[0],$t=It[1],kt=!!Tt;if($t.visible=kt,objMatch(Lt.geometry.parameters||{},{polygonGeoJson:pt,curvatureResolution:Rt})||(Lt.geometry&&Lt.geometry.dispose(),Lt.geometry=new ConicPolygonBufferGeometry(pt,0,GLOBE_RADIUS,!1,!0,!0,Rt)),kt&&(!$t.geometry.parameters||$t.geometry.parameters.geoJson.coordinates!==pt||$t.geometry.parameters.resolution!==Rt)&&($t.geometry&&$t.geometry.dispose(),$t.geometry=new GeoJsonGeometry({type:"Polygon",coordinates:pt},GLOBE_RADIUS,Rt)),Lt.material[0]=bt||dt.__defaultSideMaterial,Lt.material[1]=At||dt.__defaultCapMaterial,[!bt&&gt,!At&&mt].forEach(function(Xt,Zt){if(Xt){var rn=Lt.material[Zt],Gt=colorAlpha(Xt);rn.color.set(colorStr2Hex(Xt)),rn.transparent=Gt<1,rn.opacity=Gt}}),kt){var Dt=$t.material,Ot=colorAlpha(Tt);Dt.color.set(colorStr2Hex(Tt)),Dt.transparent=Ot<1,Dt.opacity=Ot}var zt={alt:wt},Ht=function(Zt){var rn=dt.__currentTargetD=Zt,Gt=rn.alt;Lt.scale.x=Lt.scale.y=Lt.scale.z=1+Gt,kt&&($t.scale.x=$t.scale.y=$t.scale.z=1+Gt+1e-4)},Yt=dt.__currentTargetD||Object.assign({},zt,{alt:-.001});Object.keys(zt).some(function(Xt){return Yt[Xt]!==zt[Xt]})&&(!_e.polygonsTransitionDuration||_e.polygonsTransitionDuration<0||Yt.alt===zt.alt?Ht(zt):_e.tweenGroup.add(new Tween(Yt).to(zt,_e.polygonsTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(Ht).start()))}})}});function objMatch(nt,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(rt,it){return rt===it}};return Object.entries(_e).every(function(rt){var it=_slicedToArray$1(rt,2),st=it[0],ot=it[1];return nt.hasOwnProperty(st)&&et(st)(nt[st],ot)})}var THREE$9=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,CircleGeometry,DoubleSide:DoubleSide$1,Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,Vector3:Vector3$1},bfg=Object.assign({},_bfg),BufferGeometryUtils=bfg.BufferGeometryUtils||bfg,HexedPolygonsLayerKapsule=index$2({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.hexPolygonGeoJsonGeometry),rt=index$1(_e.hexPolygonColor),it=index$1(_e.hexPolygonAltitude),st=index$1(_e.hexPolygonResolution),ot=index$1(_e.hexPolygonMargin),at=index$1(_e.hexPolygonUseDots),lt=index$1(_e.hexPolygonCurvatureResolution),ct=index$1(_e.hexPolygonDotResolution);threeDigest(_e.hexPolygonsData,_e.scene,{createObj:function(ht){var dt=new THREE$9.Mesh(void 0,new THREE$9.MeshLambertMaterial({side:THREE$9.DoubleSide}));return dt.__globeObjType="hexPolygon",dt},updateObj:function(ht,dt){var ft=et(dt),pt=st(dt),mt=it(dt),At=Math.max(0,Math.min(1,+ot(dt))),gt=at(dt),bt=lt(dt),Tt=ct(dt),wt=rt(dt),Rt=colorAlpha(wt);ht.material.color.set(colorStr2Hex(wt)),ht.material.transparent=Rt<1,ht.material.opacity=Rt;var It={alt:mt,margin:At,curvatureResolution:bt},Lt={geoJson:ft,h3Res:pt},$t=ht.__currentTargetD||Object.assign({},It,{alt:-.001}),kt=ht.__currentMemD||Lt;if(Object.keys(It).some(function(Ht){return $t[Ht]!==It[Ht]})||Object.keys(Lt).some(function(Ht){return kt[Ht]!==Lt[Ht]})){ht.__currentMemD=Lt;var Dt=[];ft.type==="Polygon"?polygonToCells(ft.coordinates,pt,!0).forEach(function(Ht){return Dt.push(Ht)}):ft.type==="MultiPolygon"?ft.coordinates.forEach(function(Ht){return polygonToCells(Ht,pt,!0).forEach(function(Yt){return Dt.push(Yt)})}):console.warn("Unsupported GeoJson geometry type: ".concat(ft.type,". Skipping geometry..."));var Ot=Dt.map(function(Ht){var Yt=cellToLatLng(Ht),Xt=cellToBoundary(Ht,!0).reverse(),Zt=Yt[1];return Xt.forEach(function(rn){var Gt=rn[0];Math.abs(Zt-Gt)>170&&(rn[0]+=Zt>Gt?360:-360)}),{h3Idx:Ht,hexCenter:Yt,hexGeoJson:Xt}}),zt=function(Yt){var Xt=ht.__currentTargetD=Yt,Zt=Xt.alt,rn=Xt.margin,Gt=Xt.curvatureResolution;ht.geometry&&ht.geometry.dispose(),ht.geometry=Ot.length?(BufferGeometryUtils.mergeGeometries||BufferGeometryUtils.mergeBufferGeometries)(Ot.map(function(jt){var Kt=_slicedToArray$1(jt.hexCenter,2),Jt=Kt[0],sn=Kt[1];if(gt){var hn=polar2Cartesian(Jt,sn,Zt),an=polar2Cartesian(jt.hexGeoJson[0][1],jt.hexGeoJson[0][0],Zt),pn=.85*(1-rn)*new THREE$9.Vector3(hn.x,hn.y,hn.z).distanceTo(new THREE$9.Vector3(an.x,an.y,an.z)),_n=new CircleGeometry(pn,Tt);return _n.rotateX(deg2Rad$1(-Jt)),_n.rotateY(deg2Rad$1(sn)),_n.translate(hn.x,hn.y,hn.z),_n}else{var yn=function(Xn,Vn,En){return Xn-(Xn-Vn)*En},$n=rn===0?jt.hexGeoJson:jt.hexGeoJson.map(function(Jn){var Xn=_slicedToArray$1(Jn,2),Vn=Xn[0],En=Xn[1];return[[Vn,sn],[En,Jt]].map(function(dn){var rr=_slicedToArray$1(dn,2),er=rr[0],Yn=rr[1];return yn(er,Yn,rn)})});return new ConicPolygonBufferGeometry([$n],GLOBE_RADIUS,GLOBE_RADIUS*(1+Zt),!1,!0,!1,Gt)}})):new THREE$9.BufferGeometry};!_e.hexPolygonsTransitionDuration||_e.hexPolygonsTransitionDuration<0?zt(It):_e.tweenGroup.add(new Tween($t).to(It,_e.hexPolygonsTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(zt).start())}}})}}),THREE$8=window.THREE?window.THREE:{Vector3:Vector3$1};function interpolateVectors(nt,_e){var et=function(ot,at){var lt=ot[ot.length-1];return[].concat(_toConsumableArray$2(ot),_toConsumableArray$2(_toConsumableArray$2(new Array(at-ot.length)).map(function(){return lt})))},rt=Math.max(nt.length,_e.length),it=interpolateArray.apply(void 0,_toConsumableArray$2([nt,_e].map(function(st){return st.map(function(ot){var at=ot.x,lt=ot.y,ct=ot.z;return[at,lt,ct]})}).map(function(st){return et(st,rt)})));return function(st){return st===0?nt:st===1?_e:it(st).map(function(ot){var at=_slicedToArray$1(ot,3),lt=at[0],ct=at[1],ut=at[2];return new THREE$8.Vector3(lt,ct,ut)})}}var THREE$7=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1,Color:Color$2,Group:Group$1,Line,NormalBlending:NormalBlending$1,ShaderMaterial:ShaderMaterial$1,Vector3:Vector3$1},FrameTicker$1=_FrameTicker.default||_FrameTicker,gradientShaders={uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    uniform float dashTranslate;

    attribute vec4 vertexColor;
    varying vec4 vColor;

    attribute float vertexRelDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = vertexColor;
      vRelDistance = vertexRelDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,fragmentShader:`
    uniform float dashOffset;
    uniform float dashSize;
    uniform float gapSize;

    varying vec4 vColor;
    varying float vRelDistance;

    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;

      // set px color: [r, g, b, a], interpolated between vertices
      gl_FragColor = vColor;
    }
  `},PathsLayerKapsule=index$2({props:{pathsData:{default:[]},pathPoints:{default:function(_e){return _e}},pathPointLat:{default:function(_e){return _e[0]}},pathPointLng:{default:function(_e){return _e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.pause()},resumeAnimation:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.resume()},_destructor:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.dispose()}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it,et.ticker=new FrameTicker$1,et.ticker.onTick.add(function(st,ot){et.pathsData.filter(function(at){return at.__threeObj&&at.__threeObj.children.length&&at.__threeObj.children[0].material&&at.__threeObj.children[0].__dashAnimateStep}).forEach(function(at){var lt=at.__threeObj.children[0],ct=lt.__dashAnimateStep*ot;if(lt.type==="Line"){var ut=lt.material.uniforms.dashTranslate.value%1e9;lt.material.uniforms.dashTranslate.value=ut+ct}else if(lt.type==="Line2"){for(var ht=lt.material.dashOffset-ct,dt=lt.material.dashSize+lt.material.gapSize;ht<=-dt;)ht+=dt;lt.material.dashOffset=ht}})})},update:function(_e){var et=index$1(_e.pathPoints),rt=index$1(_e.pathPointLat),it=index$1(_e.pathPointLng),st=index$1(_e.pathPointAlt),ot=index$1(_e.pathStroke),at=index$1(_e.pathColor),lt=index$1(_e.pathDashLength),ct=index$1(_e.pathDashGap),ut=index$1(_e.pathDashInitialGap),ht=index$1(_e.pathDashAnimateTime),dt=new THREE$7.ShaderMaterial(_objectSpread2$1(_objectSpread2$1({},gradientShaders),{},{transparent:!0,blending:THREE$7.NormalBlending}));threeDigest(_e.pathsData,_e.scene,{createObj:function(){var bt=new THREE$7.Group;return bt.__globeObjType="path",bt},updateObj:function(bt,Tt){var wt=ot(Tt),Rt=wt!=null;if(!bt.children.length||Rt===(bt.children[0].type==="Line")){emptyObject(bt);var It=Rt?new Line2(new LineGeometry,new LineMaterial):new THREE$7.Line(new THREE$7.BufferGeometry,dt.clone());bt.add(It)}var Lt=bt.children[0],$t=pt(et(Tt),rt,it,st,_e.pathResolution),kt=ht(Tt);if(Lt.__dashAnimateStep=kt>0?1e3/kt:0,Rt){Lt.material.resolution=_e.rendererSize;{var zt=lt(Tt),Ht=ct(Tt),Yt=ut(Tt);Lt.material.dashed=Ht>0,Lt.material.dashed?Lt.material.defines.USE_DASH="":delete Lt.material.defines.USE_DASH,Lt.material.dashed&&(Lt.material.dashScale=1/ft($t),Lt.material.dashSize=zt,Lt.material.gapSize=Ht,Lt.material.dashOffset=-Yt)}{var Xt=at(Tt);if(Xt instanceof Array){var Zt=mt(at(Tt),$t.length-1,1,!1);Lt.geometry.setColors(Zt.array),Lt.material.vertexColors=!0}else{var rn=Xt,Gt=colorAlpha(rn);Lt.material.color=new THREE$7.Color(colorStr2Hex(rn)),Lt.material.transparent=Gt<1,Lt.material.opacity=Gt,Lt.material.vertexColors=!1}}Lt.material.needsUpdate=!0}else{Object.assign(Lt.material.uniforms,{dashSize:{value:lt(Tt)},gapSize:{value:ct(Tt)},dashOffset:{value:ut(Tt)}});var Dt=mt(at(Tt),$t.length),Ot=At($t.length,1,!0);Lt.geometry.setAttribute("vertexColor",Dt),Lt.geometry.setAttribute("vertexRelDistance",Ot)}var jt=interpolateVectors(Tt.__currentTargetD&&Tt.__currentTargetD.points||[$t[0]],$t),Kt=function(an){var pn=Tt.__currentTargetD=an,_n=pn.stroke,yn=pn.interpolK,$n=Tt.__currentTargetD.points=jt(yn);if(Rt){var Jn;Lt.geometry.setPositions((Jn=[]).concat.apply(Jn,_toConsumableArray$2($n.map(function(Xn){var Vn=Xn.x,En=Xn.y,dn=Xn.z;return[Vn,En,dn]})))),Lt.material.linewidth=_n,Lt.material.dashed&&Lt.computeLineDistances()}else Lt.geometry.setFromPoints($n),Lt.geometry.computeBoundingSphere()},Jt={stroke:wt,interpolK:1},sn=Object.assign({},Tt.__currentTargetD||Jt,{interpolK:0});Object.keys(Jt).some(function(hn){return sn[hn]!==Jt[hn]})&&(!_e.pathTransitionDuration||_e.pathTransitionDuration<0?Kt(Jt):_e.tweenGroup.add(new Tween(sn).to(Jt,_e.pathTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(Kt).start()))}});function ft(gt){var bt=0,Tt;return gt.forEach(function(wt){Tt&&(bt+=Tt.distanceTo(wt)),Tt=wt}),bt}function pt(gt,bt,Tt,wt,Rt){var It=function(Dt,Ot,zt){for(var Ht=[],Yt=1;Yt<=zt;Yt++)Ht.push(Dt+(Ot-Dt)*Yt/(zt+1));return Ht},Lt=function(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,zt=[],Ht=null;return Dt.forEach(function(Yt){if(Ht){for(;Math.abs(Ht[1]-Yt[1])>180;)Ht[1]+=360*(Ht[1]<Yt[1]?1:-1);var Xt=Math.sqrt(Math.pow(Yt[0]-Ht[0],2)+Math.pow(Yt[1]-Ht[1],2));if(Xt>Ot)for(var Zt=Math.floor(Xt/Ot),rn=It(Ht[0],Yt[0],Zt),Gt=It(Ht[1],Yt[1],Zt),jt=It(Ht[2],Yt[2],Zt),Kt=0,Jt=rn.length;Kt<Jt;Kt++)zt.push([rn[Kt],Gt[Kt],jt[Kt]])}zt.push(Ht=Yt)}),zt},$t=function(Dt){var Ot=_slicedToArray$1(Dt,3),zt=Ot[0],Ht=Ot[1],Yt=Ot[2],Xt=polar2Cartesian(zt,Ht,Yt),Zt=Xt.x,rn=Xt.y,Gt=Xt.z;return new THREE$7.Vector3(Zt,rn,Gt)};return Lt(gt.map(function(kt){return[bt(kt),Tt(kt),wt(kt)]}),Rt).map($t)}function mt(gt,bt){var Tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,Rt=bt+1,It;if(gt instanceof Array||gt instanceof Function){var Lt=gt instanceof Array?linear().domain(gt.map(function(Yt,Xt){return Xt/(gt.length-1)})).range(gt):gt;It=function(Xt){return color2ShaderArr(Lt(Xt),wt,!0)}}else{var $t=color2ShaderArr(gt,wt,!0);It=function(){return $t}}for(var kt=[],Dt=0,Ot=Rt;Dt<Ot;Dt++)for(var zt=It(Dt/(Ot-1)),Ht=0;Ht<Tt;Ht++)kt.push(zt);return array2BufferAttr(kt,wt?4:3)}function At(gt){for(var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,wt=gt+1,Rt=[],It=0,Lt=wt;It<Lt;It++)for(var $t=It/(Lt-1),kt=0;kt<bt;kt++)Rt.push($t);return Tt&&Rt.reverse(),array2BufferAttr(Rt,1)}}}),THREE$6=window.THREE?window.THREE:{Euler:Euler$1,Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,SphereGeometry:SphereGeometry$1},TilesLayerKapsule=index$2({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new THREE$6.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.tileLat),rt=index$1(_e.tileLng),it=index$1(_e.tileAltitude),st=index$1(_e.tileWidth),ot=index$1(_e.tileHeight),at=index$1(_e.tileUseGlobeProjection),lt=index$1(_e.tileMaterial),ct=index$1(_e.tileCurvatureResolution);threeDigest(_e.tilesData,_e.scene,{createObj:function(){var ht=new THREE$6.Mesh;return ht.__globeObjType="tile",ht},updateObj:function(ht,dt){ht.material=lt(dt);var ft=at(dt),pt=ct(dt),mt=function(Tt){var wt=ht.__currentTargetD=Tt,Rt=wt.lat,It=wt.lng,Lt=wt.alt,$t=wt.width,kt=wt.height,Dt=deg2Rad(It),Ot=deg2Rad(-Rt);ht.geometry&&ht.geometry.dispose(),ht.geometry=new THREE$6.SphereGeometry(GLOBE_RADIUS*(1+Lt),Math.ceil($t/(pt||-1)),Math.ceil(kt/(pt||-1)),deg2Rad(90-$t/2)+(ft?Dt:0),deg2Rad($t),deg2Rad(90-kt/2)+(ft?Ot:0),deg2Rad(kt)),ft||ht.setRotationFromEuler(new THREE$6.Euler(Ot,Dt,0,"YXZ"))},At={lat:+et(dt),lng:+rt(dt),alt:+it(dt),width:+st(dt),height:+ot(dt)},gt=ht.__currentTargetD||Object.assign({},At,{width:0,height:0});Object.keys(At).some(function(bt){return gt[bt]!==At[bt]})&&(!_e.tilesTransitionDuration||_e.tilesTransitionDuration<0?mt(At):_e.tweenGroup.add(new Tween(gt).to(At,_e.tilesTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(mt).start()))}})}}),deg2Rad=function(_e){return _e*Math.PI/180},glyphs={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},cssFontWeight="normal",ascender=1189,underlinePosition=-100,cssFontStyle="normal",boundingBox={yMin:-334,xMin:-111,yMax:1189,xMax:1672},resolution=1e3,original_font_information={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},descender=-334,familyName="Helvetiker",lineHeight=1522,underlineThickness=50,defaultTypeFace={glyphs,cssFontWeight,ascender,underlinePosition,cssFontStyle,boundingBox,resolution,original_font_information,descender,familyName,lineHeight,underlineThickness},THREE$5=_objectSpread2$1(_objectSpread2$1({},window.THREE?window.THREE:{BoxGeometry:BoxGeometry$1,CircleGeometry,DoubleSide:DoubleSide$1,Group:Group$1,Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,TextGeometry,Vector3:Vector3$1}),{},{Font,TextGeometry}),LabelsLayerKapsule=index$2({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:0},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:defaultTypeFace,onChange:function(_e,et){et.font=new THREE$5.Font(_e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e){var et=index$1(_e.labelLat),rt=index$1(_e.labelLng),it=index$1(_e.labelAltitude),st=index$1(_e.labelText),ot=index$1(_e.labelSize),at=index$1(_e.labelRotation),lt=index$1(_e.labelColor),ct=index$1(_e.labelIncludeDot),ut=index$1(_e.labelDotRadius),ht=index$1(_e.labelDotOrientation),dt=new Set(["right","top","bottom"]),ft=2*Math.PI*GLOBE_RADIUS/360,pt=new THREE$5.CircleGeometry(1,16);threeDigest(_e.labelsData,_e.scene,{createObj:function(){var At=new THREE$5.MeshLambertMaterial;At.side=DoubleSide$1;var gt=new THREE$5.Group;gt.add(new THREE$5.Mesh(pt,At));var bt=new THREE$5.Mesh(void 0,At);gt.add(bt);var Tt=new THREE$5.Mesh;return Tt.visible=!1,bt.add(Tt),gt.__globeObjType="label",gt},updateObj:function(At,gt){var bt=_slicedToArray$1(At.children,2),Tt=bt[0],wt=bt[1],Rt=_slicedToArray$1(wt.children,1),It=Rt[0],Lt=lt(gt),$t=colorAlpha(Lt);wt.material.color.set(colorStr2Hex(Lt)),wt.material.transparent=$t<1,wt.material.opacity=$t;var kt=ct(gt),Dt=ht(gt);!kt||!dt.has(Dt)&&(Dt="bottom");var Ot=kt?+ut(gt)*ft:1e-12;Tt.scale.x=Tt.scale.y=Ot;var zt=+ot(gt)*ft;if(wt.geometry&&wt.geometry.dispose(),wt.geometry=new THREE$5.TextGeometry(st(gt),{font:_e.font,size:zt,depth:0,height:0,curveSegments:_e.labelResolution}),It.geometry&&It.geometry.dispose(),wt.geometry.computeBoundingBox(),It.geometry=_construct$1(THREE$5.BoxGeometry,_toConsumableArray$2(new THREE$5.Vector3().subVectors(wt.geometry.boundingBox.max,wt.geometry.boundingBox.min).toArray())),Dt!=="right"&&wt.geometry.center(),kt){var Ht=Ot+zt/2;Dt==="right"&&(wt.position.x=Ht),wt.position.y={right:-zt/2,top:Ht+zt/2,bottom:-Ht-zt/2}[Dt]}var Yt=function(Gt){var jt=At.__currentTargetD=Gt,Kt=jt.lat,Jt=jt.lng,sn=jt.alt,hn=jt.rot,an=jt.scale;Object.assign(At.position,polar2Cartesian(Kt,Jt,sn)),At.lookAt(_e.scene.localToWorld(new THREE$5.Vector3(0,0,0))),At.rotateY(Math.PI),At.rotateZ(-hn*Math.PI/180),At.scale.x=At.scale.y=At.scale.z=an},Xt={lat:+et(gt),lng:+rt(gt),alt:+it(gt),rot:+at(gt),scale:1},Zt=At.__currentTargetD||Object.assign({},Xt,{scale:1e-12});Object.keys(Xt).some(function(rn){return Zt[rn]!==Xt[rn]})&&(!_e.labelsTransitionDuration||_e.labelsTransitionDuration<0?Yt(Xt):_e.tweenGroup.add(new Tween(Zt).to(Xt,_e.labelsTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(Yt).start()))}})}}),THREE$4=window.THREE?window.THREE:{BufferGeometry:BufferGeometry$1},CircleLineGeometry=function(nt){function _e(){var et,rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;_classCallCheck(this,_e),et=_callSuper(this,_e),et.type="CircleLineGeometry",et.parameters={radius:rt,segmentCount:it};for(var st=[],ot=0;ot<=it;ot++){var at=(ot/it-.25)*Math.PI*2;st.push({x:Math.cos(at)*rt,y:Math.sin(at)*rt,z:0})}return et.setFromPoints(st),et}return _inherits(_e,nt),_createClass(_e)}(THREE$4.BufferGeometry),THREE$3=window.THREE?window.THREE:{Color:Color$2,Group:Group$1,Line,LineBasicMaterial:LineBasicMaterial$1,Vector3:Vector3$1},FrameTicker=_FrameTicker.default||_FrameTicker,RingsLayerKapsule=index$2({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.pause()},resumeAnimation:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.resume()},_destructor:function(_e){var et;(et=_e.ticker)===null||et===void 0||et.dispose()}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it,et.ticker=new FrameTicker,et.ticker.onTick.add(function(st){if(et.ringsData.length){var ot=index$1(et.ringColor),at=index$1(et.ringAltitude),lt=index$1(et.ringMaxRadius),ct=index$1(et.ringPropagationSpeed),ut=index$1(et.ringRepeatPeriod);et.ringsData.filter(function(ht){return ht.__threeObj}).forEach(function(ht){var dt=ht.__threeObj;if((dt.__nextRingTime||0)<=st){var ft=ut(ht)/1e3;dt.__nextRingTime=st+(ft<=0?1/0:ft);var pt=new THREE$3.Line(new CircleLineGeometry(1,et.ringResolution),new THREE$3.LineBasicMaterial),mt=ot(ht),At=mt instanceof Array||mt instanceof Function,gt;At?mt instanceof Array?(gt=linear().domain(mt.map(function(kt,Dt){return Dt/(mt.length-1)})).range(mt),pt.material.transparent=mt.some(function(kt){return colorAlpha(kt)<1})):(gt=mt,pt.material.transparent=!0):(pt.material.color=new THREE$3.Color(colorStr2Hex(mt)),setMaterialOpacity(pt.material,colorAlpha(mt)));var bt=GLOBE_RADIUS*(1+at(ht)),Tt=lt(ht),wt=Tt*Math.PI/180,Rt=ct(ht),It=Rt<=0,Lt=function(Dt){var Ot=Dt.t,zt=(It?1-Ot:Ot)*wt;if(pt.scale.x=pt.scale.y=bt*Math.sin(zt),pt.position.z=bt*(1-Math.cos(zt)),At){var Ht=gt(Ot);pt.material.color=new THREE$3.Color(colorStr2Hex(Ht)),pt.material.transparent&&(pt.material.opacity=colorAlpha(Ht))}};if(Rt===0)Lt({t:0}),dt.add(pt);else{var $t=Math.abs(Tt/Rt)*1e3;et.tweenGroup.add(new Tween({t:0}).to({t:1},$t).onUpdate(Lt).onStart(function(){return dt.add(pt)}).onComplete(function(){dt.remove(pt),_deallocate(pt)}).start())}}})}})},update:function(_e){var et=index$1(_e.ringLat),rt=index$1(_e.ringLng),it=index$1(_e.ringAltitude),st=_e.scene.localToWorld(new THREE$3.Vector3(0,0,0));threeDigest(_e.ringsData,_e.scene,{createObj:function(){var at=new THREE$3.Group;return at.__globeObjType="ring",at},updateObj:function(at,lt){var ct=et(lt),ut=rt(lt),ht=it(lt);Object.assign(at.position,polar2Cartesian(ct,ut,ht)),at.lookAt(st)}},{removeDelay:3e4})}}),THREE$2=_objectSpread2$1(_objectSpread2$1({},window.THREE?window.THREE:{}),{},{CSS2DObject}),HtmlElementsLayerKapsule=index$2({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(_e,et){var rt=et?[et]:_e.htmlElementsData.map(function(it){return it.__threeObj}).filter(function(it){return it});rt.forEach(function(it){return it.visible=!_e.isBehindGlobe||!_e.isBehindGlobe(it.position)})}},init:function(_e,et,rt){var it=rt.tweenGroup;emptyObject(_e),et.scene=_e,et.tweenGroup=it},update:function(_e,et){var rt=this,it=index$1(_e.htmlLat),st=index$1(_e.htmlLng),ot=index$1(_e.htmlAltitude),at=index$1(_e.htmlElement);threeDigest(_e.htmlElementsData,_e.scene,{purge:et.hasOwnProperty("htmlElement"),createObj:function(ct){var ut=at(ct),ht=new THREE$2.CSS2DObject(ut);return ht.__globeObjType="html",ht},updateObj:function(ct,ut){var ht=function(pt){var mt=ct.__currentTargetD=pt,At=mt.alt,gt=mt.lat,bt=mt.lng;Object.assign(ct.position,polar2Cartesian(gt,bt,At)),rt.updateObjVisibility(ct)},dt={lat:+it(ut),lng:+st(ut),alt:+ot(ut)};!_e.htmlTransitionDuration||_e.htmlTransitionDuration<0||!ct.__currentTargetD?ht(dt):_e.tweenGroup.add(new Tween(ct.__currentTargetD).to(dt,_e.htmlTransitionDuration).easing(Easing.Quadratic.InOut).onUpdate(ht).start())}})}}),THREE$1=window.THREE?window.THREE:{Euler:Euler$1,Group:Group$1,Mesh:Mesh$1,MeshLambertMaterial:MeshLambertMaterial$1,SphereGeometry:SphereGeometry$1},ObjectsLayerKapsule=index$2({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new THREE$1.Mesh(new THREE$1.SphereGeometry(1,16,8),new THREE$1.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(_e,et){emptyObject(_e),et.scene=_e},update:function(_e,et){var rt=index$1(_e.objectLat),it=index$1(_e.objectLng),st=index$1(_e.objectAltitude),ot=index$1(_e.objectFacesSurface),at=index$1(_e.objectRotation),lt=index$1(_e.objectThreeObject);threeDigest(_e.objectsData,_e.scene,{purge:et.hasOwnProperty("objectThreeObject"),createObj:function(ut){var ht=lt(ut);_e.objectThreeObject===ht&&(ht=ht.clone());var dt=new THREE$1.Group;return dt.add(ht),dt.__globeObjType="object",dt},updateObj:function(ut,ht){var dt=+rt(ht),ft=+it(ht),pt=+st(ht);Object.assign(ut.position,polar2Cartesian(dt,ft,pt)),ot(ht)?ut.setRotationFromEuler(new Euler$1(deg2Rad$1(-dt),deg2Rad$1(ft),0,"YXZ")):ut.rotation.set(0,0,0);var mt=ut.children[0],At=at(ht);At&&mt.setRotationFromEuler(new Euler$1(deg2Rad$1(At.x||0),deg2Rad$1(At.y||0),deg2Rad$1(At.z||0)))}})}}),CustomLayerKapsule=index$2({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(_e,et){emptyObject(_e),et.scene=_e},update:function(_e,et){_e.customThreeObjectUpdate||emptyObject(_e.scene);var rt=index$1(_e.customThreeObject),it=index$1(_e.customThreeObjectUpdate);threeDigest(_e.customLayerData,_e.scene,{purge:et.hasOwnProperty("customThreeObject"),createObj:function(ot){var at=rt(ot,GLOBE_RADIUS);return at&&(_e.customThreeObject===at&&(at=at.clone()),at.__globeObjType="custom"),at},updateObj:function(ot,at){return it(ot,at,GLOBE_RADIUS)}})}}),THREE$i=window.THREE?window.THREE:{Group:Group$1,Vector2:Vector2$1,Vector3:Vector3$1},layers=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","labelsLayer","ringsLayer","htmlElementsLayer","objectsLayer","customLayer"],bindGlobeLayer=linkKapsule$1("globeLayer",GlobeLayerKapsule),linkedGlobeLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["globeImageUrl","bumpImageUrl","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(nt){return _defineProperty$2({},nt,bindGlobeLayer.linkProp(nt))}))),linkedGlobeLayerMethods=Object.assign.apply(Object,_toConsumableArray$2(["globeMaterial"].map(function(nt){return _defineProperty$2({},nt,bindGlobeLayer.linkMethod(nt))}))),bindPointsLayer=linkKapsule$1("pointsLayer",PointsLayerKapsule),linkedPointsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindPointsLayer.linkProp(nt))}))),bindArcsLayer=linkKapsule$1("arcsLayer",ArcsLayerKapsule),linkedArcsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindArcsLayer.linkProp(nt))}))),bindHexBinLayer=linkKapsule$1("hexBinLayer",HexBinLayerKapsule),linkedHexBinLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindHexBinLayer.linkProp(nt))}))),bindHeatmapsLayer=linkKapsule$1("heatmapsLayer",HeatmapsLayerKapsule),linkedHeatmapsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindHeatmapsLayer.linkProp(nt))}))),bindHexedPolygonsLayer=linkKapsule$1("hexedPolygonsLayer",HexedPolygonsLayerKapsule),linkedHexedPolygonsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindHexedPolygonsLayer.linkProp(nt))}))),bindPolygonsLayer=linkKapsule$1("polygonsLayer",PolygonsLayerKapsule),linkedPolygonsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindPolygonsLayer.linkProp(nt))}))),bindPathsLayer=linkKapsule$1("pathsLayer",PathsLayerKapsule),linkedPathsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindPathsLayer.linkProp(nt))}))),bindTilesLayer=linkKapsule$1("tilesLayer",TilesLayerKapsule),linkedTilesLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindTilesLayer.linkProp(nt))}))),bindLabelsLayer=linkKapsule$1("labelsLayer",LabelsLayerKapsule),linkedLabelsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindLabelsLayer.linkProp(nt))}))),bindRingsLayer=linkKapsule$1("ringsLayer",RingsLayerKapsule),linkedRingsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(nt){return _defineProperty$2({},nt,bindRingsLayer.linkProp(nt))}))),bindHtmlElementsLayer=linkKapsule$1("htmlElementsLayer",HtmlElementsLayerKapsule),linkedHtmlElementsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlTransitionDuration"].map(function(nt){return _defineProperty$2({},nt,bindHtmlElementsLayer.linkProp(nt))}))),bindObjectsLayer=linkKapsule$1("objectsLayer",ObjectsLayerKapsule),linkedObjectsLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(nt){return _defineProperty$2({},nt,bindObjectsLayer.linkProp(nt))}))),bindCustomLayer=linkKapsule$1("customLayer",CustomLayerKapsule),linkedCustomLayerProps=Object.assign.apply(Object,_toConsumableArray$2(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(nt){return _defineProperty$2({},nt,bindCustomLayer.linkProp(nt))}))),Globe$1=index$2({props:_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new THREE$i.Vector2(window.innerWidth,window.innerHeight),onChange:function(_e,et){et.pathsLayer.rendererSize(_e)},triggerUpdate:!1}},linkedGlobeLayerProps),linkedPointsLayerProps),linkedArcsLayerProps),linkedHexBinLayerProps),linkedHeatmapsLayerProps),linkedPolygonsLayerProps),linkedHexedPolygonsLayerProps),linkedPathsLayerProps),linkedTilesLayerProps),linkedLabelsLayerProps),linkedRingsLayerProps),linkedHtmlElementsLayerProps),linkedObjectsLayerProps),linkedCustomLayerProps),methods:_objectSpread2$1({getGlobeRadius,getCoords:function(_e){for(var et=arguments.length,rt=new Array(et>1?et-1:0),it=1;it<et;it++)rt[it-1]=arguments[it];return polar2Cartesian.apply(void 0,rt)},toGeoCoords:function(_e){for(var et=arguments.length,rt=new Array(et>1?et-1:0),it=1;it<et;it++)rt[it-1]=arguments[it];return cartesian2Polar.apply(void 0,rt)},setPointOfView:function(_e,et,rt){var it=void 0;if(et){var st=getGlobeRadius(),ot=rt?et.clone().sub(rt):et,at,lt,ct;it=function(ht){at===void 0&&(at=ot.length()),lt===void 0&&(lt=Math.sqrt(Math.pow(at,2)-Math.pow(st,2))),ct===void 0&&(ct=Math.acos(lt/at));var dt=ot.distanceTo(ht);if(dt<lt)return!1;var ft=ht.length(),pt=Math.acos((Math.pow(at,2)+Math.pow(dt,2)-Math.pow(ft,2))/(2*at*dt));return pt<ct}}_e.layersThatNeedBehindGlobeChecker.forEach(function(ut){return ut.isBehindGlobe(it)})},pauseAnimation:function(_e){return _e.animationFrameRequestId!==null&&(cancelAnimationFrame(_e.animationFrameRequestId),_e.animationFrameRequestId=null),_e.pausableLayers.forEach(function(et){var rt;return(rt=et.pauseAnimation)===null||rt===void 0?void 0:rt.call(et)}),this},resumeAnimation:function(_e){return _e.animationFrameRequestId===null&&this._animationCycle(),_e.pausableLayers.forEach(function(et){var rt;return(rt=et.resumeAnimation)===null||rt===void 0?void 0:rt.call(et)}),this},_animationCycle:function(_e){_e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),_e.tweenGroup.update()},_destructor:function(_e){this.pauseAnimation(),_e.destructableLayers.forEach(function(et){return et._destructor()})}},linkedGlobeLayerMethods),stateInit:function(){var _e=new Group,et={tweenGroup:_e},rt={globeLayer:GlobeLayerKapsule(et),pointsLayer:PointsLayerKapsule(et),arcsLayer:ArcsLayerKapsule(et),hexBinLayer:HexBinLayerKapsule(et),heatmapsLayer:HeatmapsLayerKapsule(et),polygonsLayer:PolygonsLayerKapsule(et),hexedPolygonsLayer:HexedPolygonsLayerKapsule(et),pathsLayer:PathsLayerKapsule(et),tilesLayer:TilesLayerKapsule(et),labelsLayer:LabelsLayerKapsule(et),ringsLayer:RingsLayerKapsule(et),htmlElementsLayer:HtmlElementsLayerKapsule(et),objectsLayer:ObjectsLayerKapsule(et),customLayer:CustomLayerKapsule(et)};return _objectSpread2$1(_objectSpread2$1({tweenGroup:_e},rt),{},{layersThatNeedBehindGlobeChecker:Object.values(rt).filter(function(it){return it.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(rt).filter(function(it){return it.hasOwnProperty("_destructor")}),pausableLayers:Object.values(rt).filter(function(it){return it.hasOwnProperty("pauseAnimation")})})},init:function(_e,et,rt){var it=rt.animateIn,st=it===void 0?!0:it,ot=rt.waitForGlobeReady,at=ot===void 0?!0:ot;emptyObject(_e),et.scene=_e,et.scene.visible=!1,layers.forEach(function(ct){var ut=new THREE$i.Group;et.scene.add(ut),et[ct](ut)});var lt=function(){if(st){et.scene.scale.set(1e-6,1e-6,1e-6),et.tweenGroup.add(new Tween({k:1e-6}).to({k:1},600).easing(Easing.Quadratic.Out).onUpdate(function(ht){var dt=ht.k;return et.scene.scale.set(dt,dt,dt)}).start());var ut=new THREE$i.Vector3(0,1,0);et.tweenGroup.add(new Tween({rot:Math.PI*2}).to({rot:0},1200).easing(Easing.Quintic.Out).onUpdate(function(ht){var dt=ht.rot;return et.scene.setRotationFromAxisAngle(ut,dt)}).start())}et.scene.visible=!0,et.onGlobeReady&&et.onGlobeReady()};at?et.globeLayer.onReady(lt):lt(),this._animationCycle()},update:function(_e){}});function fromKapsule(nt){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,rt=function(it){function st(){var ot;_classCallCheck(this,st);for(var at=arguments.length,lt=new Array(at),ct=0;ct<at;ct++)lt[ct]=arguments[ct];return ot=_callSuper(this,st,[].concat(lt)),ot.__kapsuleInstance=nt.apply(void 0,lt).apply(void 0,[].concat(_toConsumableArray$2(et?[ot]:[]),lt)),ot}return _inherits(st,it),_createClass(st)}(_e);return Object.keys(nt()).forEach(function(it){return rt.prototype[it]=function(){var st,ot=(st=this.__kapsuleInstance)[it].apply(st,arguments);return ot===this.__kapsuleInstance?this:ot}}),rt}var three$1=window.THREE?window.THREE:{Group:Group$1},threeGlobe=fromKapsule(Globe$1,three$1.Group,!0);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="169",CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,PCFShadowMap$1=1,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,AgXToneMapping=6,NeutralToneMapping=7,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipmapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipmapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBIntegerFormat=1032,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_e,et){this._listeners===void 0&&(this._listeners={});const rt=this._listeners;rt[_e]===void 0&&(rt[_e]=[]),rt[_e].indexOf(et)===-1&&rt[_e].push(et)}hasEventListener(_e,et){if(this._listeners===void 0)return!1;const rt=this._listeners;return rt[_e]!==void 0&&rt[_e].indexOf(et)!==-1}removeEventListener(_e,et){if(this._listeners===void 0)return;const it=this._listeners[_e];if(it!==void 0){const st=it.indexOf(et);st!==-1&&it.splice(st,1)}}dispatchEvent(_e){if(this._listeners===void 0)return;const rt=this._listeners[_e.type];if(rt!==void 0){_e.target=this;const it=rt.slice(0);for(let st=0,ot=it.length;st<ot;st++)it[st].call(this,_e);_e.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const nt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,et=Math.random()*4294967295|0,rt=Math.random()*4294967295|0;return(_lut[nt&255]+_lut[nt>>8&255]+_lut[nt>>16&255]+_lut[nt>>24&255]+"-"+_lut[_e&255]+_lut[_e>>8&255]+"-"+_lut[_e>>16&15|64]+_lut[_e>>24&255]+"-"+_lut[et&63|128]+_lut[et>>8&255]+"-"+_lut[et>>16&255]+_lut[et>>24&255]+_lut[rt&255]+_lut[rt>>8&255]+_lut[rt>>16&255]+_lut[rt>>24&255]).toLowerCase()}function clamp$1(nt,_e,et){return Math.max(_e,Math.min(et,nt))}function euclideanModulo(nt,_e){return(nt%_e+_e)%_e}function mapLinear(nt,_e,et,rt,it){return rt+(nt-_e)*(it-rt)/(et-_e)}function inverseLerp(nt,_e,et){return nt!==_e?(et-nt)/(_e-nt):0}function lerp(nt,_e,et){return(1-et)*nt+et*_e}function damp(nt,_e,et,rt){return lerp(nt,_e,1-Math.exp(-et*rt))}function pingpong(nt,_e=1){return _e-Math.abs(euclideanModulo(nt,_e*2)-_e)}function smoothstep$1(nt,_e,et){return nt<=_e?0:nt>=et?1:(nt=(nt-_e)/(et-_e),nt*nt*(3-2*nt))}function smootherstep(nt,_e,et){return nt<=_e?0:nt>=et?1:(nt=(nt-_e)/(et-_e),nt*nt*nt*(nt*(nt*6-15)+10))}function randInt(nt,_e){return nt+Math.floor(Math.random()*(_e-nt+1))}function randFloat(nt,_e){return nt+Math.random()*(_e-nt)}function randFloatSpread(nt){return nt*(.5-Math.random())}function seededRandom(nt){nt!==void 0&&(_seed=nt);let _e=_seed+=1831565813;return _e=Math.imul(_e^_e>>>15,_e|1),_e^=_e+Math.imul(_e^_e>>>7,_e|61),((_e^_e>>>14)>>>0)/4294967296}function degToRad(nt){return nt*DEG2RAD}function radToDeg(nt){return nt*RAD2DEG}function isPowerOfTwo(nt){return(nt&nt-1)===0&&nt!==0}function ceilPowerOfTwo(nt){return Math.pow(2,Math.ceil(Math.log(nt)/Math.LN2))}function floorPowerOfTwo(nt){return Math.pow(2,Math.floor(Math.log(nt)/Math.LN2))}function setQuaternionFromProperEuler(nt,_e,et,rt,it){const st=Math.cos,ot=Math.sin,at=st(et/2),lt=ot(et/2),ct=st((_e+rt)/2),ut=ot((_e+rt)/2),ht=st((_e-rt)/2),dt=ot((_e-rt)/2),ft=st((rt-_e)/2),pt=ot((rt-_e)/2);switch(it){case"XYX":nt.set(at*ut,lt*ht,lt*dt,at*ct);break;case"YZY":nt.set(lt*dt,at*ut,lt*ht,at*ct);break;case"ZXZ":nt.set(lt*ht,lt*dt,at*ut,at*ct);break;case"XZX":nt.set(at*ut,lt*pt,lt*ft,at*ct);break;case"YXY":nt.set(lt*ft,at*ut,lt*pt,at*ct);break;case"ZYZ":nt.set(lt*pt,lt*ft,at*ut,at*ct);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+it)}}function denormalize(nt,_e){switch(_e.constructor){case Float32Array:return nt;case Uint32Array:return nt/4294967295;case Uint16Array:return nt/65535;case Uint8Array:return nt/255;case Int32Array:return Math.max(nt/2147483647,-1);case Int16Array:return Math.max(nt/32767,-1);case Int8Array:return Math.max(nt/127,-1);default:throw new Error("Invalid component type.")}}function normalize$1(nt,_e){switch(_e.constructor){case Float32Array:return nt;case Uint32Array:return Math.round(nt*4294967295);case Uint16Array:return Math.round(nt*65535);case Uint8Array:return Math.round(nt*255);case Int32Array:return Math.round(nt*2147483647);case Int16Array:return Math.round(nt*32767);case Int8Array:return Math.round(nt*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp:clamp$1,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep:smoothstep$1,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize:normalize$1,denormalize};class Vector2{constructor(_e=0,et=0){Vector2.prototype.isVector2=!0,this.x=_e,this.y=et}get width(){return this.x}set width(_e){this.x=_e}get height(){return this.y}set height(_e){this.y=_e}set(_e,et){return this.x=_e,this.y=et,this}setScalar(_e){return this.x=_e,this.y=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setComponent(_e,et){switch(_e){case 0:this.x=et;break;case 1:this.y=et;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y)}copy(_e){return this.x=_e.x,this.y=_e.y,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this}addScalar(_e){return this.x+=_e,this.y+=_e,this}addVectors(_e,et){return this.x=_e.x+et.x,this.y=_e.y+et.y,this}addScaledVector(_e,et){return this.x+=_e.x*et,this.y+=_e.y*et,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this}subScalar(_e){return this.x-=_e,this.y-=_e,this}subVectors(_e,et){return this.x=_e.x-et.x,this.y=_e.y-et.y,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this}divide(_e){return this.x/=_e.x,this.y/=_e.y,this}divideScalar(_e){return this.multiplyScalar(1/_e)}applyMatrix3(_e){const et=this.x,rt=this.y,it=_e.elements;return this.x=it[0]*et+it[3]*rt+it[6],this.y=it[1]*et+it[4]*rt+it[7],this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this}clamp(_e,et){return this.x=Math.max(_e.x,Math.min(et.x,this.x)),this.y=Math.max(_e.y,Math.min(et.y,this.y)),this}clampScalar(_e,et){return this.x=Math.max(_e,Math.min(et,this.x)),this.y=Math.max(_e,Math.min(et,this.y)),this}clampLength(_e,et){const rt=this.length();return this.divideScalar(rt||1).multiplyScalar(Math.max(_e,Math.min(et,rt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_e){return this.x*_e.x+this.y*_e.y}cross(_e){return this.x*_e.y-this.y*_e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_e){const et=Math.sqrt(this.lengthSq()*_e.lengthSq());if(et===0)return Math.PI/2;const rt=this.dot(_e)/et;return Math.acos(clamp$1(rt,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const et=this.x-_e.x,rt=this.y-_e.y;return et*et+rt*rt}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,et){return this.x+=(_e.x-this.x)*et,this.y+=(_e.y-this.y)*et,this}lerpVectors(_e,et,rt){return this.x=_e.x+(et.x-_e.x)*rt,this.y=_e.y+(et.y-_e.y)*rt,this}equals(_e){return _e.x===this.x&&_e.y===this.y}fromArray(_e,et=0){return this.x=_e[et],this.y=_e[et+1],this}toArray(_e=[],et=0){return _e[et]=this.x,_e[et+1]=this.y,_e}fromBufferAttribute(_e,et){return this.x=_e.getX(et),this.y=_e.getY(et),this}rotateAround(_e,et){const rt=Math.cos(et),it=Math.sin(et),st=this.x-_e.x,ot=this.y-_e.y;return this.x=st*rt-ot*it+_e.x,this.y=st*it+ot*rt+_e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_e,et,rt,it,st,ot,at,lt,ct){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_e!==void 0&&this.set(_e,et,rt,it,st,ot,at,lt,ct)}set(_e,et,rt,it,st,ot,at,lt,ct){const ut=this.elements;return ut[0]=_e,ut[1]=it,ut[2]=at,ut[3]=et,ut[4]=st,ut[5]=lt,ut[6]=rt,ut[7]=ot,ut[8]=ct,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_e){const et=this.elements,rt=_e.elements;return et[0]=rt[0],et[1]=rt[1],et[2]=rt[2],et[3]=rt[3],et[4]=rt[4],et[5]=rt[5],et[6]=rt[6],et[7]=rt[7],et[8]=rt[8],this}extractBasis(_e,et,rt){return _e.setFromMatrix3Column(this,0),et.setFromMatrix3Column(this,1),rt.setFromMatrix3Column(this,2),this}setFromMatrix4(_e){const et=_e.elements;return this.set(et[0],et[4],et[8],et[1],et[5],et[9],et[2],et[6],et[10]),this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,et){const rt=_e.elements,it=et.elements,st=this.elements,ot=rt[0],at=rt[3],lt=rt[6],ct=rt[1],ut=rt[4],ht=rt[7],dt=rt[2],ft=rt[5],pt=rt[8],mt=it[0],At=it[3],gt=it[6],bt=it[1],Tt=it[4],wt=it[7],Rt=it[2],It=it[5],Lt=it[8];return st[0]=ot*mt+at*bt+lt*Rt,st[3]=ot*At+at*Tt+lt*It,st[6]=ot*gt+at*wt+lt*Lt,st[1]=ct*mt+ut*bt+ht*Rt,st[4]=ct*At+ut*Tt+ht*It,st[7]=ct*gt+ut*wt+ht*Lt,st[2]=dt*mt+ft*bt+pt*Rt,st[5]=dt*At+ft*Tt+pt*It,st[8]=dt*gt+ft*wt+pt*Lt,this}multiplyScalar(_e){const et=this.elements;return et[0]*=_e,et[3]*=_e,et[6]*=_e,et[1]*=_e,et[4]*=_e,et[7]*=_e,et[2]*=_e,et[5]*=_e,et[8]*=_e,this}determinant(){const _e=this.elements,et=_e[0],rt=_e[1],it=_e[2],st=_e[3],ot=_e[4],at=_e[5],lt=_e[6],ct=_e[7],ut=_e[8];return et*ot*ut-et*at*ct-rt*st*ut+rt*at*lt+it*st*ct-it*ot*lt}invert(){const _e=this.elements,et=_e[0],rt=_e[1],it=_e[2],st=_e[3],ot=_e[4],at=_e[5],lt=_e[6],ct=_e[7],ut=_e[8],ht=ut*ot-at*ct,dt=at*lt-ut*st,ft=ct*st-ot*lt,pt=et*ht+rt*dt+it*ft;if(pt===0)return this.set(0,0,0,0,0,0,0,0,0);const mt=1/pt;return _e[0]=ht*mt,_e[1]=(it*ct-ut*rt)*mt,_e[2]=(at*rt-it*ot)*mt,_e[3]=dt*mt,_e[4]=(ut*et-it*lt)*mt,_e[5]=(it*st-at*et)*mt,_e[6]=ft*mt,_e[7]=(rt*lt-ct*et)*mt,_e[8]=(ot*et-rt*st)*mt,this}transpose(){let _e;const et=this.elements;return _e=et[1],et[1]=et[3],et[3]=_e,_e=et[2],et[2]=et[6],et[6]=_e,_e=et[5],et[5]=et[7],et[7]=_e,this}getNormalMatrix(_e){return this.setFromMatrix4(_e).invert().transpose()}transposeIntoArray(_e){const et=this.elements;return _e[0]=et[0],_e[1]=et[3],_e[2]=et[6],_e[3]=et[1],_e[4]=et[4],_e[5]=et[7],_e[6]=et[2],_e[7]=et[5],_e[8]=et[8],this}setUvTransform(_e,et,rt,it,st,ot,at){const lt=Math.cos(st),ct=Math.sin(st);return this.set(rt*lt,rt*ct,-rt*(lt*ot+ct*at)+ot+_e,-it*ct,it*lt,-it*(-ct*ot+lt*at)+at+et,0,0,1),this}scale(_e,et){return this.premultiply(_m3.makeScale(_e,et)),this}rotate(_e){return this.premultiply(_m3.makeRotation(-_e)),this}translate(_e,et){return this.premultiply(_m3.makeTranslation(_e,et)),this}makeTranslation(_e,et){return _e.isVector2?this.set(1,0,_e.x,0,1,_e.y,0,0,1):this.set(1,0,_e,0,1,et,0,0,1),this}makeRotation(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(et,-rt,0,rt,et,0,0,0,1),this}makeScale(_e,et){return this.set(_e,0,0,0,et,0,0,0,1),this}equals(_e){const et=this.elements,rt=_e.elements;for(let it=0;it<9;it++)if(et[it]!==rt[it])return!1;return!0}fromArray(_e,et=0){for(let rt=0;rt<9;rt++)this.elements[rt]=_e[rt+et];return this}toArray(_e=[],et=0){const rt=this.elements;return _e[et]=rt[0],_e[et+1]=rt[1],_e[et+2]=rt[2],_e[et+3]=rt[3],_e[et+4]=rt[4],_e[et+5]=rt[5],_e[et+6]=rt[6],_e[et+7]=rt[7],_e[et+8]=rt[8],_e}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32$1(nt){for(let _e=nt.length-1;_e>=0;--_e)if(nt[_e]>=65535)return!0;return!1}function createElementNS(nt){return document.createElementNS("http://www.w3.org/1999/xhtml",nt)}function createCanvasElement(){const nt=createElementNS("canvas");return nt.style.display="block",nt}const _cache$2={};function warnOnce(nt){nt in _cache$2||(_cache$2[nt]=!0,console.warn(nt))}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,luminanceCoefficients:[.2126,.7152,.0722],toReference:nt=>nt,fromReference:nt=>nt},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,luminanceCoefficients:[.2126,.7152,.0722],toReference:nt=>nt.convertSRGBToLinear(),fromReference:nt=>nt.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,luminanceCoefficients:[.2289,.6917,.0793],toReference:nt=>nt.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:nt=>nt.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,luminanceCoefficients:[.2289,.6917,.0793],toReference:nt=>nt.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:nt=>nt.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(nt){if(!SUPPORTED_WORKING_COLOR_SPACES.has(nt))throw new Error(`Unsupported working color space, "${nt}".`);this._workingColorSpace=nt},convert:function(nt,_e,et){if(this.enabled===!1||_e===et||!_e||!et)return nt;const rt=COLOR_SPACES[_e].toReference,it=COLOR_SPACES[et].fromReference;return it(rt(nt))},fromWorkingColorSpace:function(nt,_e){return this.convert(nt,this._workingColorSpace,_e)},toWorkingColorSpace:function(nt,_e){return this.convert(nt,_e,this._workingColorSpace)},getPrimaries:function(nt){return COLOR_SPACES[nt].primaries},getTransfer:function(nt){return nt===NoColorSpace?LinearTransfer:COLOR_SPACES[nt].transfer},getLuminanceCoefficients:function(nt,_e=this._workingColorSpace){return nt.fromArray(COLOR_SPACES[_e].luminanceCoefficients)}};function SRGBToLinear(nt){return nt<.04045?nt*.0773993808:Math.pow(nt*.9478672986+.0521327014,2.4)}function LinearToSRGB(nt){return nt<.0031308?nt*12.92:1.055*Math.pow(nt,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(_e){if(/^data:/i.test(_e.src)||typeof HTMLCanvasElement>"u")return _e.src;let et;if(_e instanceof HTMLCanvasElement)et=_e;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_e.width,_canvas.height=_e.height;const rt=_canvas.getContext("2d");_e instanceof ImageData?rt.putImageData(_e,0,0):rt.drawImage(_e,0,0,_e.width,_e.height),et=_canvas}return et.width>2048||et.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_e),et.toDataURL("image/jpeg",.6)):et.toDataURL("image/png")}static sRGBToLinear(_e){if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){const et=createElementNS("canvas");et.width=_e.width,et.height=_e.height;const rt=et.getContext("2d");rt.drawImage(_e,0,0,_e.width,_e.height);const it=rt.getImageData(0,0,_e.width,_e.height),st=it.data;for(let ot=0;ot<st.length;ot++)st[ot]=SRGBToLinear(st[ot]/255)*255;return rt.putImageData(it,0,0),et}else if(_e.data){const et=_e.data.slice(0);for(let rt=0;rt<et.length;rt++)et instanceof Uint8Array||et instanceof Uint8ClampedArray?et[rt]=Math.floor(SRGBToLinear(et[rt]/255)*255):et[rt]=SRGBToLinear(et[rt]);return{data:et,width:_e.width,height:_e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_e}}let _sourceId=0;class Source{constructor(_e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=_e,this.dataReady=!0,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}toJSON(_e){const et=_e===void 0||typeof _e=="string";if(!et&&_e.images[this.uuid]!==void 0)return _e.images[this.uuid];const rt={uuid:this.uuid,url:""},it=this.data;if(it!==null){let st;if(Array.isArray(it)){st=[];for(let ot=0,at=it.length;ot<at;ot++)it[ot].isDataTexture?st.push(serializeImage(it[ot].image)):st.push(serializeImage(it[ot]))}else st=serializeImage(it);rt.url=st}return et||(_e.images[this.uuid]=rt),rt}}function serializeImage(nt){return typeof HTMLImageElement<"u"&&nt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&nt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&nt instanceof ImageBitmap?ImageUtils.getDataURL(nt):nt.data?{data:Array.from(nt.data),width:nt.width,height:nt.height,type:nt.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher{constructor(_e=Texture.DEFAULT_IMAGE,et=Texture.DEFAULT_MAPPING,rt=ClampToEdgeWrapping,it=ClampToEdgeWrapping,st=LinearFilter,ot=LinearMipmapLinearFilter,at=RGBAFormat,lt=UnsignedByteType,ct=Texture.DEFAULT_ANISOTROPY,ut=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(_e),this.mipmaps=[],this.mapping=et,this.channel=0,this.wrapS=rt,this.wrapT=it,this.magFilter=st,this.minFilter=ot,this.anisotropy=ct,this.format=at,this.internalFormat=null,this.type=lt,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ut,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_e=null){this.source.data=_e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_e){return this.name=_e.name,this.source=_e.source,this.mipmaps=_e.mipmaps.slice(0),this.mapping=_e.mapping,this.channel=_e.channel,this.wrapS=_e.wrapS,this.wrapT=_e.wrapT,this.magFilter=_e.magFilter,this.minFilter=_e.minFilter,this.anisotropy=_e.anisotropy,this.format=_e.format,this.internalFormat=_e.internalFormat,this.type=_e.type,this.offset.copy(_e.offset),this.repeat.copy(_e.repeat),this.center.copy(_e.center),this.rotation=_e.rotation,this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrix.copy(_e.matrix),this.generateMipmaps=_e.generateMipmaps,this.premultiplyAlpha=_e.premultiplyAlpha,this.flipY=_e.flipY,this.unpackAlignment=_e.unpackAlignment,this.colorSpace=_e.colorSpace,this.userData=JSON.parse(JSON.stringify(_e.userData)),this.needsUpdate=!0,this}toJSON(_e){const et=_e===void 0||typeof _e=="string";if(!et&&_e.textures[this.uuid]!==void 0)return _e.textures[this.uuid];const rt={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(rt.userData=this.userData),et||(_e.textures[this.uuid]=rt),rt}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_e){if(this.mapping!==UVMapping)return _e;if(_e.applyMatrix3(this.matrix),_e.x<0||_e.x>1)switch(this.wrapS){case RepeatWrapping:_e.x=_e.x-Math.floor(_e.x);break;case ClampToEdgeWrapping:_e.x=_e.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_e.x)%2)===1?_e.x=Math.ceil(_e.x)-_e.x:_e.x=_e.x-Math.floor(_e.x);break}if(_e.y<0||_e.y>1)switch(this.wrapT){case RepeatWrapping:_e.y=_e.y-Math.floor(_e.y);break;case ClampToEdgeWrapping:_e.y=_e.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_e.y)%2)===1?_e.y=Math.ceil(_e.y)-_e.y:_e.y=_e.y-Math.floor(_e.y);break}return this.flipY&&(_e.y=1-_e.y),_e}set needsUpdate(_e){_e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_e){_e===!0&&this.pmremVersion++}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_e=0,et=0,rt=0,it=1){Vector4.prototype.isVector4=!0,this.x=_e,this.y=et,this.z=rt,this.w=it}get width(){return this.z}set width(_e){this.z=_e}get height(){return this.w}set height(_e){this.w=_e}set(_e,et,rt,it){return this.x=_e,this.y=et,this.z=rt,this.w=it,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this.w=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setW(_e){return this.w=_e,this}setComponent(_e,et){switch(_e){case 0:this.x=et;break;case 1:this.y=et;break;case 2:this.z=et;break;case 3:this.w=et;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this.w=_e.w!==void 0?_e.w:1,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this.w+=_e.w,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this.w+=_e,this}addVectors(_e,et){return this.x=_e.x+et.x,this.y=_e.y+et.y,this.z=_e.z+et.z,this.w=_e.w+et.w,this}addScaledVector(_e,et){return this.x+=_e.x*et,this.y+=_e.y*et,this.z+=_e.z*et,this.w+=_e.w*et,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this.w-=_e.w,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this.w-=_e,this}subVectors(_e,et){return this.x=_e.x-et.x,this.y=_e.y-et.y,this.z=_e.z-et.z,this.w=_e.w-et.w,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this.w*=_e.w,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this.w*=_e,this}applyMatrix4(_e){const et=this.x,rt=this.y,it=this.z,st=this.w,ot=_e.elements;return this.x=ot[0]*et+ot[4]*rt+ot[8]*it+ot[12]*st,this.y=ot[1]*et+ot[5]*rt+ot[9]*it+ot[13]*st,this.z=ot[2]*et+ot[6]*rt+ot[10]*it+ot[14]*st,this.w=ot[3]*et+ot[7]*rt+ot[11]*it+ot[15]*st,this}divideScalar(_e){return this.multiplyScalar(1/_e)}setAxisAngleFromQuaternion(_e){this.w=2*Math.acos(_e.w);const et=Math.sqrt(1-_e.w*_e.w);return et<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_e.x/et,this.y=_e.y/et,this.z=_e.z/et),this}setAxisAngleFromRotationMatrix(_e){let et,rt,it,st;const lt=_e.elements,ct=lt[0],ut=lt[4],ht=lt[8],dt=lt[1],ft=lt[5],pt=lt[9],mt=lt[2],At=lt[6],gt=lt[10];if(Math.abs(ut-dt)<.01&&Math.abs(ht-mt)<.01&&Math.abs(pt-At)<.01){if(Math.abs(ut+dt)<.1&&Math.abs(ht+mt)<.1&&Math.abs(pt+At)<.1&&Math.abs(ct+ft+gt-3)<.1)return this.set(1,0,0,0),this;et=Math.PI;const Tt=(ct+1)/2,wt=(ft+1)/2,Rt=(gt+1)/2,It=(ut+dt)/4,Lt=(ht+mt)/4,$t=(pt+At)/4;return Tt>wt&&Tt>Rt?Tt<.01?(rt=0,it=.707106781,st=.707106781):(rt=Math.sqrt(Tt),it=It/rt,st=Lt/rt):wt>Rt?wt<.01?(rt=.707106781,it=0,st=.707106781):(it=Math.sqrt(wt),rt=It/it,st=$t/it):Rt<.01?(rt=.707106781,it=.707106781,st=0):(st=Math.sqrt(Rt),rt=Lt/st,it=$t/st),this.set(rt,it,st,et),this}let bt=Math.sqrt((At-pt)*(At-pt)+(ht-mt)*(ht-mt)+(dt-ut)*(dt-ut));return Math.abs(bt)<.001&&(bt=1),this.x=(At-pt)/bt,this.y=(ht-mt)/bt,this.z=(dt-ut)/bt,this.w=Math.acos((ct+ft+gt-1)/2),this}setFromMatrixPosition(_e){const et=_e.elements;return this.x=et[12],this.y=et[13],this.z=et[14],this.w=et[15],this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this.w=Math.min(this.w,_e.w),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this.w=Math.max(this.w,_e.w),this}clamp(_e,et){return this.x=Math.max(_e.x,Math.min(et.x,this.x)),this.y=Math.max(_e.y,Math.min(et.y,this.y)),this.z=Math.max(_e.z,Math.min(et.z,this.z)),this.w=Math.max(_e.w,Math.min(et.w,this.w)),this}clampScalar(_e,et){return this.x=Math.max(_e,Math.min(et,this.x)),this.y=Math.max(_e,Math.min(et,this.y)),this.z=Math.max(_e,Math.min(et,this.z)),this.w=Math.max(_e,Math.min(et,this.w)),this}clampLength(_e,et){const rt=this.length();return this.divideScalar(rt||1).multiplyScalar(Math.max(_e,Math.min(et,rt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z+this.w*_e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,et){return this.x+=(_e.x-this.x)*et,this.y+=(_e.y-this.y)*et,this.z+=(_e.z-this.z)*et,this.w+=(_e.w-this.w)*et,this}lerpVectors(_e,et,rt){return this.x=_e.x+(et.x-_e.x)*rt,this.y=_e.y+(et.y-_e.y)*rt,this.z=_e.z+(et.z-_e.z)*rt,this.w=_e.w+(et.w-_e.w)*rt,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z&&_e.w===this.w}fromArray(_e,et=0){return this.x=_e[et],this.y=_e[et+1],this.z=_e[et+2],this.w=_e[et+3],this}toArray(_e=[],et=0){return _e[et]=this.x,_e[et+1]=this.y,_e[et+2]=this.z,_e[et+3]=this.w,_e}fromBufferAttribute(_e,et){return this.x=_e.getX(et),this.y=_e.getY(et),this.z=_e.getZ(et),this.w=_e.getW(et),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher{constructor(_e=1,et=1,rt={}){super(),this.isRenderTarget=!0,this.width=_e,this.height=et,this.depth=1,this.scissor=new Vector4(0,0,_e,et),this.scissorTest=!1,this.viewport=new Vector4(0,0,_e,et);const it={width:_e,height:et,depth:1};rt=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},rt);const st=new Texture(it,rt.mapping,rt.wrapS,rt.wrapT,rt.magFilter,rt.minFilter,rt.format,rt.type,rt.anisotropy,rt.colorSpace);st.flipY=!1,st.generateMipmaps=rt.generateMipmaps,st.internalFormat=rt.internalFormat,this.textures=[];const ot=rt.count;for(let at=0;at<ot;at++)this.textures[at]=st.clone(),this.textures[at].isRenderTargetTexture=!0;this.depthBuffer=rt.depthBuffer,this.stencilBuffer=rt.stencilBuffer,this.resolveDepthBuffer=rt.resolveDepthBuffer,this.resolveStencilBuffer=rt.resolveStencilBuffer,this.depthTexture=rt.depthTexture,this.samples=rt.samples}get texture(){return this.textures[0]}set texture(_e){this.textures[0]=_e}setSize(_e,et,rt=1){if(this.width!==_e||this.height!==et||this.depth!==rt){this.width=_e,this.height=et,this.depth=rt;for(let it=0,st=this.textures.length;it<st;it++)this.textures[it].image.width=_e,this.textures[it].image.height=et,this.textures[it].image.depth=rt;this.dispose()}this.viewport.set(0,0,_e,et),this.scissor.set(0,0,_e,et)}clone(){return new this.constructor().copy(this)}copy(_e){this.width=_e.width,this.height=_e.height,this.depth=_e.depth,this.scissor.copy(_e.scissor),this.scissorTest=_e.scissorTest,this.viewport.copy(_e.viewport),this.textures.length=0;for(let rt=0,it=_e.textures.length;rt<it;rt++)this.textures[rt]=_e.textures[rt].clone(),this.textures[rt].isRenderTargetTexture=!0;const et=Object.assign({},_e.texture.image);return this.texture.source=new Source(et),this.depthBuffer=_e.depthBuffer,this.stencilBuffer=_e.stencilBuffer,this.resolveDepthBuffer=_e.resolveDepthBuffer,this.resolveStencilBuffer=_e.resolveStencilBuffer,_e.depthTexture!==null&&(this.depthTexture=_e.depthTexture.clone()),this.samples=_e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(_e=1,et=1,rt={}){super(_e,et,rt),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture{constructor(_e=null,et=1,rt=1,it=1){super(null),this.isDataArrayTexture=!0,this.image={data:_e,width:et,height:rt,depth:it},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(_e){this.layerUpdates.add(_e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Quaternion{constructor(_e=0,et=0,rt=0,it=1){this.isQuaternion=!0,this._x=_e,this._y=et,this._z=rt,this._w=it}static slerpFlat(_e,et,rt,it,st,ot,at){let lt=rt[it+0],ct=rt[it+1],ut=rt[it+2],ht=rt[it+3];const dt=st[ot+0],ft=st[ot+1],pt=st[ot+2],mt=st[ot+3];if(at===0){_e[et+0]=lt,_e[et+1]=ct,_e[et+2]=ut,_e[et+3]=ht;return}if(at===1){_e[et+0]=dt,_e[et+1]=ft,_e[et+2]=pt,_e[et+3]=mt;return}if(ht!==mt||lt!==dt||ct!==ft||ut!==pt){let At=1-at;const gt=lt*dt+ct*ft+ut*pt+ht*mt,bt=gt>=0?1:-1,Tt=1-gt*gt;if(Tt>Number.EPSILON){const Rt=Math.sqrt(Tt),It=Math.atan2(Rt,gt*bt);At=Math.sin(At*It)/Rt,at=Math.sin(at*It)/Rt}const wt=at*bt;if(lt=lt*At+dt*wt,ct=ct*At+ft*wt,ut=ut*At+pt*wt,ht=ht*At+mt*wt,At===1-at){const Rt=1/Math.sqrt(lt*lt+ct*ct+ut*ut+ht*ht);lt*=Rt,ct*=Rt,ut*=Rt,ht*=Rt}}_e[et]=lt,_e[et+1]=ct,_e[et+2]=ut,_e[et+3]=ht}static multiplyQuaternionsFlat(_e,et,rt,it,st,ot){const at=rt[it],lt=rt[it+1],ct=rt[it+2],ut=rt[it+3],ht=st[ot],dt=st[ot+1],ft=st[ot+2],pt=st[ot+3];return _e[et]=at*pt+ut*ht+lt*ft-ct*dt,_e[et+1]=lt*pt+ut*dt+ct*ht-at*ft,_e[et+2]=ct*pt+ut*ft+at*dt-lt*ht,_e[et+3]=ut*pt-at*ht-lt*dt-ct*ft,_e}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get w(){return this._w}set w(_e){this._w=_e,this._onChangeCallback()}set(_e,et,rt,it){return this._x=_e,this._y=et,this._z=rt,this._w=it,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_e){return this._x=_e.x,this._y=_e.y,this._z=_e.z,this._w=_e.w,this._onChangeCallback(),this}setFromEuler(_e,et=!0){const rt=_e._x,it=_e._y,st=_e._z,ot=_e._order,at=Math.cos,lt=Math.sin,ct=at(rt/2),ut=at(it/2),ht=at(st/2),dt=lt(rt/2),ft=lt(it/2),pt=lt(st/2);switch(ot){case"XYZ":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"YXZ":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;case"ZXY":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"ZYX":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;case"YZX":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"XZY":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+ot)}return et===!0&&this._onChangeCallback(),this}setFromAxisAngle(_e,et){const rt=et/2,it=Math.sin(rt);return this._x=_e.x*it,this._y=_e.y*it,this._z=_e.z*it,this._w=Math.cos(rt),this._onChangeCallback(),this}setFromRotationMatrix(_e){const et=_e.elements,rt=et[0],it=et[4],st=et[8],ot=et[1],at=et[5],lt=et[9],ct=et[2],ut=et[6],ht=et[10],dt=rt+at+ht;if(dt>0){const ft=.5/Math.sqrt(dt+1);this._w=.25/ft,this._x=(ut-lt)*ft,this._y=(st-ct)*ft,this._z=(ot-it)*ft}else if(rt>at&&rt>ht){const ft=2*Math.sqrt(1+rt-at-ht);this._w=(ut-lt)/ft,this._x=.25*ft,this._y=(it+ot)/ft,this._z=(st+ct)/ft}else if(at>ht){const ft=2*Math.sqrt(1+at-rt-ht);this._w=(st-ct)/ft,this._x=(it+ot)/ft,this._y=.25*ft,this._z=(lt+ut)/ft}else{const ft=2*Math.sqrt(1+ht-rt-at);this._w=(ot-it)/ft,this._x=(st+ct)/ft,this._y=(lt+ut)/ft,this._z=.25*ft}return this._onChangeCallback(),this}setFromUnitVectors(_e,et){let rt=_e.dot(et)+1;return rt<Number.EPSILON?(rt=0,Math.abs(_e.x)>Math.abs(_e.z)?(this._x=-_e.y,this._y=_e.x,this._z=0,this._w=rt):(this._x=0,this._y=-_e.z,this._z=_e.y,this._w=rt)):(this._x=_e.y*et.z-_e.z*et.y,this._y=_e.z*et.x-_e.x*et.z,this._z=_e.x*et.y-_e.y*et.x,this._w=rt),this.normalize()}angleTo(_e){return 2*Math.acos(Math.abs(clamp$1(this.dot(_e),-1,1)))}rotateTowards(_e,et){const rt=this.angleTo(_e);if(rt===0)return this;const it=Math.min(1,et/rt);return this.slerp(_e,it),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_e){return this._x*_e._x+this._y*_e._y+this._z*_e._z+this._w*_e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _e=this.length();return _e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_e=1/_e,this._x=this._x*_e,this._y=this._y*_e,this._z=this._z*_e,this._w=this._w*_e),this._onChangeCallback(),this}multiply(_e){return this.multiplyQuaternions(this,_e)}premultiply(_e){return this.multiplyQuaternions(_e,this)}multiplyQuaternions(_e,et){const rt=_e._x,it=_e._y,st=_e._z,ot=_e._w,at=et._x,lt=et._y,ct=et._z,ut=et._w;return this._x=rt*ut+ot*at+it*ct-st*lt,this._y=it*ut+ot*lt+st*at-rt*ct,this._z=st*ut+ot*ct+rt*lt-it*at,this._w=ot*ut-rt*at-it*lt-st*ct,this._onChangeCallback(),this}slerp(_e,et){if(et===0)return this;if(et===1)return this.copy(_e);const rt=this._x,it=this._y,st=this._z,ot=this._w;let at=ot*_e._w+rt*_e._x+it*_e._y+st*_e._z;if(at<0?(this._w=-_e._w,this._x=-_e._x,this._y=-_e._y,this._z=-_e._z,at=-at):this.copy(_e),at>=1)return this._w=ot,this._x=rt,this._y=it,this._z=st,this;const lt=1-at*at;if(lt<=Number.EPSILON){const ft=1-et;return this._w=ft*ot+et*this._w,this._x=ft*rt+et*this._x,this._y=ft*it+et*this._y,this._z=ft*st+et*this._z,this.normalize(),this}const ct=Math.sqrt(lt),ut=Math.atan2(ct,at),ht=Math.sin((1-et)*ut)/ct,dt=Math.sin(et*ut)/ct;return this._w=ot*ht+this._w*dt,this._x=rt*ht+this._x*dt,this._y=it*ht+this._y*dt,this._z=st*ht+this._z*dt,this._onChangeCallback(),this}slerpQuaternions(_e,et,rt){return this.copy(_e).slerp(et,rt)}random(){const _e=2*Math.PI*Math.random(),et=2*Math.PI*Math.random(),rt=Math.random(),it=Math.sqrt(1-rt),st=Math.sqrt(rt);return this.set(it*Math.sin(_e),it*Math.cos(_e),st*Math.sin(et),st*Math.cos(et))}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._w===this._w}fromArray(_e,et=0){return this._x=_e[et],this._y=_e[et+1],this._z=_e[et+2],this._w=_e[et+3],this._onChangeCallback(),this}toArray(_e=[],et=0){return _e[et]=this._x,_e[et+1]=this._y,_e[et+2]=this._z,_e[et+3]=this._w,_e}fromBufferAttribute(_e,et){return this._x=_e.getX(et),this._y=_e.getY(et),this._z=_e.getZ(et),this._w=_e.getW(et),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_e=0,et=0,rt=0){Vector3.prototype.isVector3=!0,this.x=_e,this.y=et,this.z=rt}set(_e,et,rt){return rt===void 0&&(rt=this.z),this.x=_e,this.y=et,this.z=rt,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setComponent(_e,et){switch(_e){case 0:this.x=et;break;case 1:this.y=et;break;case 2:this.z=et;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this}addVectors(_e,et){return this.x=_e.x+et.x,this.y=_e.y+et.y,this.z=_e.z+et.z,this}addScaledVector(_e,et){return this.x+=_e.x*et,this.y+=_e.y*et,this.z+=_e.z*et,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this}subVectors(_e,et){return this.x=_e.x-et.x,this.y=_e.y-et.y,this.z=_e.z-et.z,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this}multiplyVectors(_e,et){return this.x=_e.x*et.x,this.y=_e.y*et.y,this.z=_e.z*et.z,this}applyEuler(_e){return this.applyQuaternion(_quaternion$4.setFromEuler(_e))}applyAxisAngle(_e,et){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_e,et))}applyMatrix3(_e){const et=this.x,rt=this.y,it=this.z,st=_e.elements;return this.x=st[0]*et+st[3]*rt+st[6]*it,this.y=st[1]*et+st[4]*rt+st[7]*it,this.z=st[2]*et+st[5]*rt+st[8]*it,this}applyNormalMatrix(_e){return this.applyMatrix3(_e).normalize()}applyMatrix4(_e){const et=this.x,rt=this.y,it=this.z,st=_e.elements,ot=1/(st[3]*et+st[7]*rt+st[11]*it+st[15]);return this.x=(st[0]*et+st[4]*rt+st[8]*it+st[12])*ot,this.y=(st[1]*et+st[5]*rt+st[9]*it+st[13])*ot,this.z=(st[2]*et+st[6]*rt+st[10]*it+st[14])*ot,this}applyQuaternion(_e){const et=this.x,rt=this.y,it=this.z,st=_e.x,ot=_e.y,at=_e.z,lt=_e.w,ct=2*(ot*it-at*rt),ut=2*(at*et-st*it),ht=2*(st*rt-ot*et);return this.x=et+lt*ct+ot*ht-at*ut,this.y=rt+lt*ut+at*ct-st*ht,this.z=it+lt*ht+st*ut-ot*ct,this}project(_e){return this.applyMatrix4(_e.matrixWorldInverse).applyMatrix4(_e.projectionMatrix)}unproject(_e){return this.applyMatrix4(_e.projectionMatrixInverse).applyMatrix4(_e.matrixWorld)}transformDirection(_e){const et=this.x,rt=this.y,it=this.z,st=_e.elements;return this.x=st[0]*et+st[4]*rt+st[8]*it,this.y=st[1]*et+st[5]*rt+st[9]*it,this.z=st[2]*et+st[6]*rt+st[10]*it,this.normalize()}divide(_e){return this.x/=_e.x,this.y/=_e.y,this.z/=_e.z,this}divideScalar(_e){return this.multiplyScalar(1/_e)}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this}clamp(_e,et){return this.x=Math.max(_e.x,Math.min(et.x,this.x)),this.y=Math.max(_e.y,Math.min(et.y,this.y)),this.z=Math.max(_e.z,Math.min(et.z,this.z)),this}clampScalar(_e,et){return this.x=Math.max(_e,Math.min(et,this.x)),this.y=Math.max(_e,Math.min(et,this.y)),this.z=Math.max(_e,Math.min(et,this.z)),this}clampLength(_e,et){const rt=this.length();return this.divideScalar(rt||1).multiplyScalar(Math.max(_e,Math.min(et,rt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,et){return this.x+=(_e.x-this.x)*et,this.y+=(_e.y-this.y)*et,this.z+=(_e.z-this.z)*et,this}lerpVectors(_e,et,rt){return this.x=_e.x+(et.x-_e.x)*rt,this.y=_e.y+(et.y-_e.y)*rt,this.z=_e.z+(et.z-_e.z)*rt,this}cross(_e){return this.crossVectors(this,_e)}crossVectors(_e,et){const rt=_e.x,it=_e.y,st=_e.z,ot=et.x,at=et.y,lt=et.z;return this.x=it*lt-st*at,this.y=st*ot-rt*lt,this.z=rt*at-it*ot,this}projectOnVector(_e){const et=_e.lengthSq();if(et===0)return this.set(0,0,0);const rt=_e.dot(this)/et;return this.copy(_e).multiplyScalar(rt)}projectOnPlane(_e){return _vector$c.copy(this).projectOnVector(_e),this.sub(_vector$c)}reflect(_e){return this.sub(_vector$c.copy(_e).multiplyScalar(2*this.dot(_e)))}angleTo(_e){const et=Math.sqrt(this.lengthSq()*_e.lengthSq());if(et===0)return Math.PI/2;const rt=this.dot(_e)/et;return Math.acos(clamp$1(rt,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const et=this.x-_e.x,rt=this.y-_e.y,it=this.z-_e.z;return et*et+rt*rt+it*it}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)+Math.abs(this.z-_e.z)}setFromSpherical(_e){return this.setFromSphericalCoords(_e.radius,_e.phi,_e.theta)}setFromSphericalCoords(_e,et,rt){const it=Math.sin(et)*_e;return this.x=it*Math.sin(rt),this.y=Math.cos(et)*_e,this.z=it*Math.cos(rt),this}setFromCylindrical(_e){return this.setFromCylindricalCoords(_e.radius,_e.theta,_e.y)}setFromCylindricalCoords(_e,et,rt){return this.x=_e*Math.sin(et),this.y=rt,this.z=_e*Math.cos(et),this}setFromMatrixPosition(_e){const et=_e.elements;return this.x=et[12],this.y=et[13],this.z=et[14],this}setFromMatrixScale(_e){const et=this.setFromMatrixColumn(_e,0).length(),rt=this.setFromMatrixColumn(_e,1).length(),it=this.setFromMatrixColumn(_e,2).length();return this.x=et,this.y=rt,this.z=it,this}setFromMatrixColumn(_e,et){return this.fromArray(_e.elements,et*4)}setFromMatrix3Column(_e,et){return this.fromArray(_e.elements,et*3)}setFromEuler(_e){return this.x=_e._x,this.y=_e._y,this.z=_e._z,this}setFromColor(_e){return this.x=_e.r,this.y=_e.g,this.z=_e.b,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z}fromArray(_e,et=0){return this.x=_e[et],this.y=_e[et+1],this.z=_e[et+2],this}toArray(_e=[],et=0){return _e[et]=this.x,_e[et+1]=this.y,_e[et+2]=this.z,_e}fromBufferAttribute(_e,et){return this.x=_e.getX(et),this.y=_e.getY(et),this.z=_e.getZ(et),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _e=Math.random()*Math.PI*2,et=Math.random()*2-1,rt=Math.sqrt(1-et*et);return this.x=rt*Math.cos(_e),this.y=et,this.z=rt*Math.sin(_e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_e=new Vector3(1/0,1/0,1/0),et=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_e,this.max=et}set(_e,et){return this.min.copy(_e),this.max.copy(et),this}setFromArray(_e){this.makeEmpty();for(let et=0,rt=_e.length;et<rt;et+=3)this.expandByPoint(_vector$b.fromArray(_e,et));return this}setFromBufferAttribute(_e){this.makeEmpty();for(let et=0,rt=_e.count;et<rt;et++)this.expandByPoint(_vector$b.fromBufferAttribute(_e,et));return this}setFromPoints(_e){this.makeEmpty();for(let et=0,rt=_e.length;et<rt;et++)this.expandByPoint(_e[et]);return this}setFromCenterAndSize(_e,et){const rt=_vector$b.copy(et).multiplyScalar(.5);return this.min.copy(_e).sub(rt),this.max.copy(_e).add(rt),this}setFromObject(_e,et=!1){return this.makeEmpty(),this.expandByObject(_e,et)}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_e){return this.isEmpty()?_e.set(0,0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}expandByObject(_e,et=!1){_e.updateWorldMatrix(!1,!1);const rt=_e.geometry;if(rt!==void 0){const st=rt.getAttribute("position");if(et===!0&&st!==void 0&&_e.isInstancedMesh!==!0)for(let ot=0,at=st.count;ot<at;ot++)_e.isMesh===!0?_e.getVertexPosition(ot,_vector$b):_vector$b.fromBufferAttribute(st,ot),_vector$b.applyMatrix4(_e.matrixWorld),this.expandByPoint(_vector$b);else _e.boundingBox!==void 0?(_e.boundingBox===null&&_e.computeBoundingBox(),_box$4.copy(_e.boundingBox)):(rt.boundingBox===null&&rt.computeBoundingBox(),_box$4.copy(rt.boundingBox)),_box$4.applyMatrix4(_e.matrixWorld),this.union(_box$4)}const it=_e.children;for(let st=0,ot=it.length;st<ot;st++)this.expandByObject(it[st],et);return this}containsPoint(_e){return _e.x>=this.min.x&&_e.x<=this.max.x&&_e.y>=this.min.y&&_e.y<=this.max.y&&_e.z>=this.min.z&&_e.z<=this.max.z}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y&&this.min.z<=_e.min.z&&_e.max.z<=this.max.z}getParameter(_e,et){return et.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y),(_e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_e){return _e.max.x>=this.min.x&&_e.min.x<=this.max.x&&_e.max.y>=this.min.y&&_e.min.y<=this.max.y&&_e.max.z>=this.min.z&&_e.min.z<=this.max.z}intersectsSphere(_e){return this.clampPoint(_e.center,_vector$b),_vector$b.distanceToSquared(_e.center)<=_e.radius*_e.radius}intersectsPlane(_e){let et,rt;return _e.normal.x>0?(et=_e.normal.x*this.min.x,rt=_e.normal.x*this.max.x):(et=_e.normal.x*this.max.x,rt=_e.normal.x*this.min.x),_e.normal.y>0?(et+=_e.normal.y*this.min.y,rt+=_e.normal.y*this.max.y):(et+=_e.normal.y*this.max.y,rt+=_e.normal.y*this.min.y),_e.normal.z>0?(et+=_e.normal.z*this.min.z,rt+=_e.normal.z*this.max.z):(et+=_e.normal.z*this.max.z,rt+=_e.normal.z*this.min.z),et<=-_e.constant&&rt>=-_e.constant}intersectsTriangle(_e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_e.a,_center),_v1$7.subVectors(_e.b,_center),_v2$4.subVectors(_e.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let et=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(et,_v0$2,_v1$7,_v2$4,_extents)||(et=[1,0,0,0,1,0,0,0,1],!satForAxes(et,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),et=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(et,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_e,et){return et.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$b).distanceTo(_e)}getBoundingSphere(_e){return this.isEmpty()?_e.makeEmpty():(this.getCenter(_e.center),_e.radius=this.getSize(_vector$b).length()*.5),_e}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}applyMatrix4(_e){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_e),this.setFromPoints(_points),this)}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(nt,_e,et,rt,it){for(let st=0,ot=nt.length-3;st<=ot;st+=3){_testAxis.fromArray(nt,st);const at=it.x*Math.abs(_testAxis.x)+it.y*Math.abs(_testAxis.y)+it.z*Math.abs(_testAxis.z),lt=_e.dot(_testAxis),ct=et.dot(_testAxis),ut=rt.dot(_testAxis);if(Math.max(-Math.max(lt,ct,ut),Math.min(lt,ct,ut))>at)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_e=new Vector3,et=-1){this.isSphere=!0,this.center=_e,this.radius=et}set(_e,et){return this.center.copy(_e),this.radius=et,this}setFromPoints(_e,et){const rt=this.center;et!==void 0?rt.copy(et):_box$3.setFromPoints(_e).getCenter(rt);let it=0;for(let st=0,ot=_e.length;st<ot;st++)it=Math.max(it,rt.distanceToSquared(_e[st]));return this.radius=Math.sqrt(it),this}copy(_e){return this.center.copy(_e.center),this.radius=_e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_e){return _e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_e){return _e.distanceTo(this.center)-this.radius}intersectsSphere(_e){const et=this.radius+_e.radius;return _e.center.distanceToSquared(this.center)<=et*et}intersectsBox(_e){return _e.intersectsSphere(this)}intersectsPlane(_e){return Math.abs(_e.distanceToPoint(this.center))<=this.radius}clampPoint(_e,et){const rt=this.center.distanceToSquared(_e);return et.copy(_e),rt>this.radius*this.radius&&(et.sub(this.center).normalize(),et.multiplyScalar(this.radius).add(this.center)),et}getBoundingBox(_e){return this.isEmpty()?(_e.makeEmpty(),_e):(_e.set(this.center,this.center),_e.expandByScalar(this.radius),_e)}applyMatrix4(_e){return this.center.applyMatrix4(_e),this.radius=this.radius*_e.getMaxScaleOnAxis(),this}translate(_e){return this.center.add(_e),this}expandByPoint(_e){if(this.isEmpty())return this.center.copy(_e),this.radius=0,this;_v1$6.subVectors(_e,this.center);const et=_v1$6.lengthSq();if(et>this.radius*this.radius){const rt=Math.sqrt(et),it=(rt-this.radius)*.5;this.center.addScaledVector(_v1$6,it/rt),this.radius+=it}return this}union(_e){return _e.isEmpty()?this:this.isEmpty()?(this.copy(_e),this):(this.center.equals(_e.center)===!0?this.radius=Math.max(this.radius,_e.radius):(_v2$3.subVectors(_e.center,this.center).setLength(_e.radius),this.expandByPoint(_v1$6.copy(_e.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_e.center).sub(_v2$3))),this)}equals(_e){return _e.center.equals(this.center)&&_e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$2=new Vector3;class Ray{constructor(_e=new Vector3,et=new Vector3(0,0,-1)){this.origin=_e,this.direction=et}set(_e,et){return this.origin.copy(_e),this.direction.copy(et),this}copy(_e){return this.origin.copy(_e.origin),this.direction.copy(_e.direction),this}at(_e,et){return et.copy(this.origin).addScaledVector(this.direction,_e)}lookAt(_e){return this.direction.copy(_e).sub(this.origin).normalize(),this}recast(_e){return this.origin.copy(this.at(_e,_vector$a)),this}closestPointToPoint(_e,et){et.subVectors(_e,this.origin);const rt=et.dot(this.direction);return rt<0?et.copy(this.origin):et.copy(this.origin).addScaledVector(this.direction,rt)}distanceToPoint(_e){return Math.sqrt(this.distanceSqToPoint(_e))}distanceSqToPoint(_e){const et=_vector$a.subVectors(_e,this.origin).dot(this.direction);return et<0?this.origin.distanceToSquared(_e):(_vector$a.copy(this.origin).addScaledVector(this.direction,et),_vector$a.distanceToSquared(_e))}distanceSqToSegment(_e,et,rt,it){_segCenter.copy(_e).add(et).multiplyScalar(.5),_segDir.copy(et).sub(_e).normalize(),_diff.copy(this.origin).sub(_segCenter);const st=_e.distanceTo(et)*.5,ot=-this.direction.dot(_segDir),at=_diff.dot(this.direction),lt=-_diff.dot(_segDir),ct=_diff.lengthSq(),ut=Math.abs(1-ot*ot);let ht,dt,ft,pt;if(ut>0)if(ht=ot*lt-at,dt=ot*at-lt,pt=st*ut,ht>=0)if(dt>=-pt)if(dt<=pt){const mt=1/ut;ht*=mt,dt*=mt,ft=ht*(ht+ot*dt+2*at)+dt*(ot*ht+dt+2*lt)+ct}else dt=st,ht=Math.max(0,-(ot*dt+at)),ft=-ht*ht+dt*(dt+2*lt)+ct;else dt=-st,ht=Math.max(0,-(ot*dt+at)),ft=-ht*ht+dt*(dt+2*lt)+ct;else dt<=-pt?(ht=Math.max(0,-(-ot*st+at)),dt=ht>0?-st:Math.min(Math.max(-st,-lt),st),ft=-ht*ht+dt*(dt+2*lt)+ct):dt<=pt?(ht=0,dt=Math.min(Math.max(-st,-lt),st),ft=dt*(dt+2*lt)+ct):(ht=Math.max(0,-(ot*st+at)),dt=ht>0?st:Math.min(Math.max(-st,-lt),st),ft=-ht*ht+dt*(dt+2*lt)+ct);else dt=ot>0?-st:st,ht=Math.max(0,-(ot*dt+at)),ft=-ht*ht+dt*(dt+2*lt)+ct;return rt&&rt.copy(this.origin).addScaledVector(this.direction,ht),it&&it.copy(_segCenter).addScaledVector(_segDir,dt),ft}intersectSphere(_e,et){_vector$a.subVectors(_e.center,this.origin);const rt=_vector$a.dot(this.direction),it=_vector$a.dot(_vector$a)-rt*rt,st=_e.radius*_e.radius;if(it>st)return null;const ot=Math.sqrt(st-it),at=rt-ot,lt=rt+ot;return lt<0?null:at<0?this.at(lt,et):this.at(at,et)}intersectsSphere(_e){return this.distanceSqToPoint(_e.center)<=_e.radius*_e.radius}distanceToPlane(_e){const et=_e.normal.dot(this.direction);if(et===0)return _e.distanceToPoint(this.origin)===0?0:null;const rt=-(this.origin.dot(_e.normal)+_e.constant)/et;return rt>=0?rt:null}intersectPlane(_e,et){const rt=this.distanceToPlane(_e);return rt===null?null:this.at(rt,et)}intersectsPlane(_e){const et=_e.distanceToPoint(this.origin);return et===0||_e.normal.dot(this.direction)*et<0}intersectBox(_e,et){let rt,it,st,ot,at,lt;const ct=1/this.direction.x,ut=1/this.direction.y,ht=1/this.direction.z,dt=this.origin;return ct>=0?(rt=(_e.min.x-dt.x)*ct,it=(_e.max.x-dt.x)*ct):(rt=(_e.max.x-dt.x)*ct,it=(_e.min.x-dt.x)*ct),ut>=0?(st=(_e.min.y-dt.y)*ut,ot=(_e.max.y-dt.y)*ut):(st=(_e.max.y-dt.y)*ut,ot=(_e.min.y-dt.y)*ut),rt>ot||st>it||((st>rt||isNaN(rt))&&(rt=st),(ot<it||isNaN(it))&&(it=ot),ht>=0?(at=(_e.min.z-dt.z)*ht,lt=(_e.max.z-dt.z)*ht):(at=(_e.max.z-dt.z)*ht,lt=(_e.min.z-dt.z)*ht),rt>lt||at>it)||((at>rt||rt!==rt)&&(rt=at),(lt<it||it!==it)&&(it=lt),it<0)?null:this.at(rt>=0?rt:it,et)}intersectsBox(_e){return this.intersectBox(_e,_vector$a)!==null}intersectTriangle(_e,et,rt,it,st){_edge1.subVectors(et,_e),_edge2.subVectors(rt,_e),_normal$2.crossVectors(_edge1,_edge2);let ot=this.direction.dot(_normal$2),at;if(ot>0){if(it)return null;at=1}else if(ot<0)at=-1,ot=-ot;else return null;_diff.subVectors(this.origin,_e);const lt=at*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(lt<0)return null;const ct=at*this.direction.dot(_edge1.cross(_diff));if(ct<0||lt+ct>ot)return null;const ut=-at*_diff.dot(_normal$2);return ut<0?null:this.at(ut/ot,st)}applyMatrix4(_e){return this.origin.applyMatrix4(_e),this.direction.transformDirection(_e),this}equals(_e){return _e.origin.equals(this.origin)&&_e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e!==void 0&&this.set(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At)}set(_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,At){const gt=this.elements;return gt[0]=_e,gt[4]=et,gt[8]=rt,gt[12]=it,gt[1]=st,gt[5]=ot,gt[9]=at,gt[13]=lt,gt[2]=ct,gt[6]=ut,gt[10]=ht,gt[14]=dt,gt[3]=ft,gt[7]=pt,gt[11]=mt,gt[15]=At,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_e){const et=this.elements,rt=_e.elements;return et[0]=rt[0],et[1]=rt[1],et[2]=rt[2],et[3]=rt[3],et[4]=rt[4],et[5]=rt[5],et[6]=rt[6],et[7]=rt[7],et[8]=rt[8],et[9]=rt[9],et[10]=rt[10],et[11]=rt[11],et[12]=rt[12],et[13]=rt[13],et[14]=rt[14],et[15]=rt[15],this}copyPosition(_e){const et=this.elements,rt=_e.elements;return et[12]=rt[12],et[13]=rt[13],et[14]=rt[14],this}setFromMatrix3(_e){const et=_e.elements;return this.set(et[0],et[3],et[6],0,et[1],et[4],et[7],0,et[2],et[5],et[8],0,0,0,0,1),this}extractBasis(_e,et,rt){return _e.setFromMatrixColumn(this,0),et.setFromMatrixColumn(this,1),rt.setFromMatrixColumn(this,2),this}makeBasis(_e,et,rt){return this.set(_e.x,et.x,rt.x,0,_e.y,et.y,rt.y,0,_e.z,et.z,rt.z,0,0,0,0,1),this}extractRotation(_e){const et=this.elements,rt=_e.elements,it=1/_v1$5.setFromMatrixColumn(_e,0).length(),st=1/_v1$5.setFromMatrixColumn(_e,1).length(),ot=1/_v1$5.setFromMatrixColumn(_e,2).length();return et[0]=rt[0]*it,et[1]=rt[1]*it,et[2]=rt[2]*it,et[3]=0,et[4]=rt[4]*st,et[5]=rt[5]*st,et[6]=rt[6]*st,et[7]=0,et[8]=rt[8]*ot,et[9]=rt[9]*ot,et[10]=rt[10]*ot,et[11]=0,et[12]=0,et[13]=0,et[14]=0,et[15]=1,this}makeRotationFromEuler(_e){const et=this.elements,rt=_e.x,it=_e.y,st=_e.z,ot=Math.cos(rt),at=Math.sin(rt),lt=Math.cos(it),ct=Math.sin(it),ut=Math.cos(st),ht=Math.sin(st);if(_e.order==="XYZ"){const dt=ot*ut,ft=ot*ht,pt=at*ut,mt=at*ht;et[0]=lt*ut,et[4]=-lt*ht,et[8]=ct,et[1]=ft+pt*ct,et[5]=dt-mt*ct,et[9]=-at*lt,et[2]=mt-dt*ct,et[6]=pt+ft*ct,et[10]=ot*lt}else if(_e.order==="YXZ"){const dt=lt*ut,ft=lt*ht,pt=ct*ut,mt=ct*ht;et[0]=dt+mt*at,et[4]=pt*at-ft,et[8]=ot*ct,et[1]=ot*ht,et[5]=ot*ut,et[9]=-at,et[2]=ft*at-pt,et[6]=mt+dt*at,et[10]=ot*lt}else if(_e.order==="ZXY"){const dt=lt*ut,ft=lt*ht,pt=ct*ut,mt=ct*ht;et[0]=dt-mt*at,et[4]=-ot*ht,et[8]=pt+ft*at,et[1]=ft+pt*at,et[5]=ot*ut,et[9]=mt-dt*at,et[2]=-ot*ct,et[6]=at,et[10]=ot*lt}else if(_e.order==="ZYX"){const dt=ot*ut,ft=ot*ht,pt=at*ut,mt=at*ht;et[0]=lt*ut,et[4]=pt*ct-ft,et[8]=dt*ct+mt,et[1]=lt*ht,et[5]=mt*ct+dt,et[9]=ft*ct-pt,et[2]=-ct,et[6]=at*lt,et[10]=ot*lt}else if(_e.order==="YZX"){const dt=ot*lt,ft=ot*ct,pt=at*lt,mt=at*ct;et[0]=lt*ut,et[4]=mt-dt*ht,et[8]=pt*ht+ft,et[1]=ht,et[5]=ot*ut,et[9]=-at*ut,et[2]=-ct*ut,et[6]=ft*ht+pt,et[10]=dt-mt*ht}else if(_e.order==="XZY"){const dt=ot*lt,ft=ot*ct,pt=at*lt,mt=at*ct;et[0]=lt*ut,et[4]=-ht,et[8]=ct*ut,et[1]=dt*ht+mt,et[5]=ot*ut,et[9]=ft*ht-pt,et[2]=pt*ht-ft,et[6]=at*ut,et[10]=mt*ht+dt}return et[3]=0,et[7]=0,et[11]=0,et[12]=0,et[13]=0,et[14]=0,et[15]=1,this}makeRotationFromQuaternion(_e){return this.compose(_zero,_e,_one)}lookAt(_e,et,rt){const it=this.elements;return _z.subVectors(_e,et),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(rt,_z),_x.lengthSq()===0&&(Math.abs(rt.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(rt,_z)),_x.normalize(),_y.crossVectors(_z,_x),it[0]=_x.x,it[4]=_y.x,it[8]=_z.x,it[1]=_x.y,it[5]=_y.y,it[9]=_z.y,it[2]=_x.z,it[6]=_y.z,it[10]=_z.z,this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,et){const rt=_e.elements,it=et.elements,st=this.elements,ot=rt[0],at=rt[4],lt=rt[8],ct=rt[12],ut=rt[1],ht=rt[5],dt=rt[9],ft=rt[13],pt=rt[2],mt=rt[6],At=rt[10],gt=rt[14],bt=rt[3],Tt=rt[7],wt=rt[11],Rt=rt[15],It=it[0],Lt=it[4],$t=it[8],kt=it[12],Dt=it[1],Ot=it[5],zt=it[9],Ht=it[13],Yt=it[2],Xt=it[6],Zt=it[10],rn=it[14],Gt=it[3],jt=it[7],Kt=it[11],Jt=it[15];return st[0]=ot*It+at*Dt+lt*Yt+ct*Gt,st[4]=ot*Lt+at*Ot+lt*Xt+ct*jt,st[8]=ot*$t+at*zt+lt*Zt+ct*Kt,st[12]=ot*kt+at*Ht+lt*rn+ct*Jt,st[1]=ut*It+ht*Dt+dt*Yt+ft*Gt,st[5]=ut*Lt+ht*Ot+dt*Xt+ft*jt,st[9]=ut*$t+ht*zt+dt*Zt+ft*Kt,st[13]=ut*kt+ht*Ht+dt*rn+ft*Jt,st[2]=pt*It+mt*Dt+At*Yt+gt*Gt,st[6]=pt*Lt+mt*Ot+At*Xt+gt*jt,st[10]=pt*$t+mt*zt+At*Zt+gt*Kt,st[14]=pt*kt+mt*Ht+At*rn+gt*Jt,st[3]=bt*It+Tt*Dt+wt*Yt+Rt*Gt,st[7]=bt*Lt+Tt*Ot+wt*Xt+Rt*jt,st[11]=bt*$t+Tt*zt+wt*Zt+Rt*Kt,st[15]=bt*kt+Tt*Ht+wt*rn+Rt*Jt,this}multiplyScalar(_e){const et=this.elements;return et[0]*=_e,et[4]*=_e,et[8]*=_e,et[12]*=_e,et[1]*=_e,et[5]*=_e,et[9]*=_e,et[13]*=_e,et[2]*=_e,et[6]*=_e,et[10]*=_e,et[14]*=_e,et[3]*=_e,et[7]*=_e,et[11]*=_e,et[15]*=_e,this}determinant(){const _e=this.elements,et=_e[0],rt=_e[4],it=_e[8],st=_e[12],ot=_e[1],at=_e[5],lt=_e[9],ct=_e[13],ut=_e[2],ht=_e[6],dt=_e[10],ft=_e[14],pt=_e[3],mt=_e[7],At=_e[11],gt=_e[15];return pt*(+st*lt*ht-it*ct*ht-st*at*dt+rt*ct*dt+it*at*ft-rt*lt*ft)+mt*(+et*lt*ft-et*ct*dt+st*ot*dt-it*ot*ft+it*ct*ut-st*lt*ut)+At*(+et*ct*ht-et*at*ft-st*ot*ht+rt*ot*ft+st*at*ut-rt*ct*ut)+gt*(-it*at*ut-et*lt*ht+et*at*dt+it*ot*ht-rt*ot*dt+rt*lt*ut)}transpose(){const _e=this.elements;let et;return et=_e[1],_e[1]=_e[4],_e[4]=et,et=_e[2],_e[2]=_e[8],_e[8]=et,et=_e[6],_e[6]=_e[9],_e[9]=et,et=_e[3],_e[3]=_e[12],_e[12]=et,et=_e[7],_e[7]=_e[13],_e[13]=et,et=_e[11],_e[11]=_e[14],_e[14]=et,this}setPosition(_e,et,rt){const it=this.elements;return _e.isVector3?(it[12]=_e.x,it[13]=_e.y,it[14]=_e.z):(it[12]=_e,it[13]=et,it[14]=rt),this}invert(){const _e=this.elements,et=_e[0],rt=_e[1],it=_e[2],st=_e[3],ot=_e[4],at=_e[5],lt=_e[6],ct=_e[7],ut=_e[8],ht=_e[9],dt=_e[10],ft=_e[11],pt=_e[12],mt=_e[13],At=_e[14],gt=_e[15],bt=ht*At*ct-mt*dt*ct+mt*lt*ft-at*At*ft-ht*lt*gt+at*dt*gt,Tt=pt*dt*ct-ut*At*ct-pt*lt*ft+ot*At*ft+ut*lt*gt-ot*dt*gt,wt=ut*mt*ct-pt*ht*ct+pt*at*ft-ot*mt*ft-ut*at*gt+ot*ht*gt,Rt=pt*ht*lt-ut*mt*lt-pt*at*dt+ot*mt*dt+ut*at*At-ot*ht*At,It=et*bt+rt*Tt+it*wt+st*Rt;if(It===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Lt=1/It;return _e[0]=bt*Lt,_e[1]=(mt*dt*st-ht*At*st-mt*it*ft+rt*At*ft+ht*it*gt-rt*dt*gt)*Lt,_e[2]=(at*At*st-mt*lt*st+mt*it*ct-rt*At*ct-at*it*gt+rt*lt*gt)*Lt,_e[3]=(ht*lt*st-at*dt*st-ht*it*ct+rt*dt*ct+at*it*ft-rt*lt*ft)*Lt,_e[4]=Tt*Lt,_e[5]=(ut*At*st-pt*dt*st+pt*it*ft-et*At*ft-ut*it*gt+et*dt*gt)*Lt,_e[6]=(pt*lt*st-ot*At*st-pt*it*ct+et*At*ct+ot*it*gt-et*lt*gt)*Lt,_e[7]=(ot*dt*st-ut*lt*st+ut*it*ct-et*dt*ct-ot*it*ft+et*lt*ft)*Lt,_e[8]=wt*Lt,_e[9]=(pt*ht*st-ut*mt*st-pt*rt*ft+et*mt*ft+ut*rt*gt-et*ht*gt)*Lt,_e[10]=(ot*mt*st-pt*at*st+pt*rt*ct-et*mt*ct-ot*rt*gt+et*at*gt)*Lt,_e[11]=(ut*at*st-ot*ht*st-ut*rt*ct+et*ht*ct+ot*rt*ft-et*at*ft)*Lt,_e[12]=Rt*Lt,_e[13]=(ut*mt*it-pt*ht*it+pt*rt*dt-et*mt*dt-ut*rt*At+et*ht*At)*Lt,_e[14]=(pt*at*it-ot*mt*it-pt*rt*lt+et*mt*lt+ot*rt*At-et*at*At)*Lt,_e[15]=(ot*ht*it-ut*at*it+ut*rt*lt-et*ht*lt-ot*rt*dt+et*at*dt)*Lt,this}scale(_e){const et=this.elements,rt=_e.x,it=_e.y,st=_e.z;return et[0]*=rt,et[4]*=it,et[8]*=st,et[1]*=rt,et[5]*=it,et[9]*=st,et[2]*=rt,et[6]*=it,et[10]*=st,et[3]*=rt,et[7]*=it,et[11]*=st,this}getMaxScaleOnAxis(){const _e=this.elements,et=_e[0]*_e[0]+_e[1]*_e[1]+_e[2]*_e[2],rt=_e[4]*_e[4]+_e[5]*_e[5]+_e[6]*_e[6],it=_e[8]*_e[8]+_e[9]*_e[9]+_e[10]*_e[10];return Math.sqrt(Math.max(et,rt,it))}makeTranslation(_e,et,rt){return _e.isVector3?this.set(1,0,0,_e.x,0,1,0,_e.y,0,0,1,_e.z,0,0,0,1):this.set(1,0,0,_e,0,1,0,et,0,0,1,rt,0,0,0,1),this}makeRotationX(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(1,0,0,0,0,et,-rt,0,0,rt,et,0,0,0,0,1),this}makeRotationY(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(et,0,rt,0,0,1,0,0,-rt,0,et,0,0,0,0,1),this}makeRotationZ(_e){const et=Math.cos(_e),rt=Math.sin(_e);return this.set(et,-rt,0,0,rt,et,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_e,et){const rt=Math.cos(et),it=Math.sin(et),st=1-rt,ot=_e.x,at=_e.y,lt=_e.z,ct=st*ot,ut=st*at;return this.set(ct*ot+rt,ct*at-it*lt,ct*lt+it*at,0,ct*at+it*lt,ut*at+rt,ut*lt-it*ot,0,ct*lt-it*at,ut*lt+it*ot,st*lt*lt+rt,0,0,0,0,1),this}makeScale(_e,et,rt){return this.set(_e,0,0,0,0,et,0,0,0,0,rt,0,0,0,0,1),this}makeShear(_e,et,rt,it,st,ot){return this.set(1,rt,st,0,_e,1,ot,0,et,it,1,0,0,0,0,1),this}compose(_e,et,rt){const it=this.elements,st=et._x,ot=et._y,at=et._z,lt=et._w,ct=st+st,ut=ot+ot,ht=at+at,dt=st*ct,ft=st*ut,pt=st*ht,mt=ot*ut,At=ot*ht,gt=at*ht,bt=lt*ct,Tt=lt*ut,wt=lt*ht,Rt=rt.x,It=rt.y,Lt=rt.z;return it[0]=(1-(mt+gt))*Rt,it[1]=(ft+wt)*Rt,it[2]=(pt-Tt)*Rt,it[3]=0,it[4]=(ft-wt)*It,it[5]=(1-(dt+gt))*It,it[6]=(At+bt)*It,it[7]=0,it[8]=(pt+Tt)*Lt,it[9]=(At-bt)*Lt,it[10]=(1-(dt+mt))*Lt,it[11]=0,it[12]=_e.x,it[13]=_e.y,it[14]=_e.z,it[15]=1,this}decompose(_e,et,rt){const it=this.elements;let st=_v1$5.set(it[0],it[1],it[2]).length();const ot=_v1$5.set(it[4],it[5],it[6]).length(),at=_v1$5.set(it[8],it[9],it[10]).length();this.determinant()<0&&(st=-st),_e.x=it[12],_e.y=it[13],_e.z=it[14],_m1$2.copy(this);const ct=1/st,ut=1/ot,ht=1/at;return _m1$2.elements[0]*=ct,_m1$2.elements[1]*=ct,_m1$2.elements[2]*=ct,_m1$2.elements[4]*=ut,_m1$2.elements[5]*=ut,_m1$2.elements[6]*=ut,_m1$2.elements[8]*=ht,_m1$2.elements[9]*=ht,_m1$2.elements[10]*=ht,et.setFromRotationMatrix(_m1$2),rt.x=st,rt.y=ot,rt.z=at,this}makePerspective(_e,et,rt,it,st,ot,at=WebGLCoordinateSystem){const lt=this.elements,ct=2*st/(et-_e),ut=2*st/(rt-it),ht=(et+_e)/(et-_e),dt=(rt+it)/(rt-it);let ft,pt;if(at===WebGLCoordinateSystem)ft=-(ot+st)/(ot-st),pt=-2*ot*st/(ot-st);else if(at===WebGPUCoordinateSystem)ft=-ot/(ot-st),pt=-ot*st/(ot-st);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+at);return lt[0]=ct,lt[4]=0,lt[8]=ht,lt[12]=0,lt[1]=0,lt[5]=ut,lt[9]=dt,lt[13]=0,lt[2]=0,lt[6]=0,lt[10]=ft,lt[14]=pt,lt[3]=0,lt[7]=0,lt[11]=-1,lt[15]=0,this}makeOrthographic(_e,et,rt,it,st,ot,at=WebGLCoordinateSystem){const lt=this.elements,ct=1/(et-_e),ut=1/(rt-it),ht=1/(ot-st),dt=(et+_e)*ct,ft=(rt+it)*ut;let pt,mt;if(at===WebGLCoordinateSystem)pt=(ot+st)*ht,mt=-2*ht;else if(at===WebGPUCoordinateSystem)pt=st*ht,mt=-1*ht;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+at);return lt[0]=2*ct,lt[4]=0,lt[8]=0,lt[12]=-dt,lt[1]=0,lt[5]=2*ut,lt[9]=0,lt[13]=-ft,lt[2]=0,lt[6]=0,lt[10]=mt,lt[14]=-pt,lt[3]=0,lt[7]=0,lt[11]=0,lt[15]=1,this}equals(_e){const et=this.elements,rt=_e.elements;for(let it=0;it<16;it++)if(et[it]!==rt[it])return!1;return!0}fromArray(_e,et=0){for(let rt=0;rt<16;rt++)this.elements[rt]=_e[rt+et];return this}toArray(_e=[],et=0){const rt=this.elements;return _e[et]=rt[0],_e[et+1]=rt[1],_e[et+2]=rt[2],_e[et+3]=rt[3],_e[et+4]=rt[4],_e[et+5]=rt[5],_e[et+6]=rt[6],_e[et+7]=rt[7],_e[et+8]=rt[8],_e[et+9]=rt[9],_e[et+10]=rt[10],_e[et+11]=rt[11],_e[et+12]=rt[12],_e[et+13]=rt[13],_e[et+14]=rt[14],_e[et+15]=rt[15],_e}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_e=0,et=0,rt=0,it=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_e,this._y=et,this._z=rt,this._order=it}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get order(){return this._order}set order(_e){this._order=_e,this._onChangeCallback()}set(_e,et,rt,it=this._order){return this._x=_e,this._y=et,this._z=rt,this._order=it,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_e){return this._x=_e._x,this._y=_e._y,this._z=_e._z,this._order=_e._order,this._onChangeCallback(),this}setFromRotationMatrix(_e,et=this._order,rt=!0){const it=_e.elements,st=it[0],ot=it[4],at=it[8],lt=it[1],ct=it[5],ut=it[9],ht=it[2],dt=it[6],ft=it[10];switch(et){case"XYZ":this._y=Math.asin(clamp$1(at,-1,1)),Math.abs(at)<.9999999?(this._x=Math.atan2(-ut,ft),this._z=Math.atan2(-ot,st)):(this._x=Math.atan2(dt,ct),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$1(ut,-1,1)),Math.abs(ut)<.9999999?(this._y=Math.atan2(at,ft),this._z=Math.atan2(lt,ct)):(this._y=Math.atan2(-ht,st),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$1(dt,-1,1)),Math.abs(dt)<.9999999?(this._y=Math.atan2(-ht,ft),this._z=Math.atan2(-ot,ct)):(this._y=0,this._z=Math.atan2(lt,st));break;case"ZYX":this._y=Math.asin(-clamp$1(ht,-1,1)),Math.abs(ht)<.9999999?(this._x=Math.atan2(dt,ft),this._z=Math.atan2(lt,st)):(this._x=0,this._z=Math.atan2(-ot,ct));break;case"YZX":this._z=Math.asin(clamp$1(lt,-1,1)),Math.abs(lt)<.9999999?(this._x=Math.atan2(-ut,ct),this._y=Math.atan2(-ht,st)):(this._x=0,this._y=Math.atan2(at,ft));break;case"XZY":this._z=Math.asin(-clamp$1(ot,-1,1)),Math.abs(ot)<.9999999?(this._x=Math.atan2(dt,ct),this._y=Math.atan2(at,st)):(this._x=Math.atan2(-ut,ft),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+et)}return this._order=et,rt===!0&&this._onChangeCallback(),this}setFromQuaternion(_e,et,rt){return _matrix$2.makeRotationFromQuaternion(_e),this.setFromRotationMatrix(_matrix$2,et,rt)}setFromVector3(_e,et=this._order){return this.set(_e.x,_e.y,_e.z,et)}reorder(_e){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_e)}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._order===this._order}fromArray(_e){return this._x=_e[0],this._y=_e[1],this._z=_e[2],_e[3]!==void 0&&(this._order=_e[3]),this._onChangeCallback(),this}toArray(_e=[],et=0){return _e[et]=this._x,_e[et+1]=this._y,_e[et+2]=this._z,_e[et+3]=this._order,_e}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_e){this.mask=(1<<_e|0)>>>0}enable(_e){this.mask|=1<<_e|0}enableAll(){this.mask=-1}toggle(_e){this.mask^=1<<_e|0}disable(_e){this.mask&=~(1<<_e|0)}disableAll(){this.mask=0}test(_e){return(this.mask&_e.mask)!==0}isEnabled(_e){return(this.mask&(1<<_e|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target$1=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _e=new Vector3,et=new Euler,rt=new Quaternion,it=new Vector3(1,1,1);function st(){rt.setFromEuler(et,!1)}function ot(){et.setFromQuaternion(rt,void 0,!1)}et._onChange(st),rt._onChange(ot),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_e},rotation:{configurable:!0,enumerable:!0,value:et},quaternion:{configurable:!0,enumerable:!0,value:rt},scale:{configurable:!0,enumerable:!0,value:it},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_e){return this.quaternion.premultiply(_e),this}setRotationFromAxisAngle(_e,et){this.quaternion.setFromAxisAngle(_e,et)}setRotationFromEuler(_e){this.quaternion.setFromEuler(_e,!0)}setRotationFromMatrix(_e){this.quaternion.setFromRotationMatrix(_e)}setRotationFromQuaternion(_e){this.quaternion.copy(_e)}rotateOnAxis(_e,et){return _q1.setFromAxisAngle(_e,et),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_e,et){return _q1.setFromAxisAngle(_e,et),this.quaternion.premultiply(_q1),this}rotateX(_e){return this.rotateOnAxis(_xAxis,_e)}rotateY(_e){return this.rotateOnAxis(_yAxis,_e)}rotateZ(_e){return this.rotateOnAxis(_zAxis,_e)}translateOnAxis(_e,et){return _v1$4.copy(_e).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(et)),this}translateX(_e){return this.translateOnAxis(_xAxis,_e)}translateY(_e){return this.translateOnAxis(_yAxis,_e)}translateZ(_e){return this.translateOnAxis(_zAxis,_e)}localToWorld(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(this.matrixWorld)}worldToLocal(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(_e,et,rt){_e.isVector3?_target$1.copy(_e):_target$1.set(_e,et,rt);const it=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target$1,this.up):_m1$1.lookAt(_target$1,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),it&&(_m1$1.extractRotation(it.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(_e){if(arguments.length>1){for(let et=0;et<arguments.length;et++)this.add(arguments[et]);return this}return _e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_e),this):(_e&&_e.isObject3D?(_e.removeFromParent(),_e.parent=this,this.children.push(_e),_e.dispatchEvent(_addedEvent),_childaddedEvent.child=_e,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_e),this)}remove(_e){if(arguments.length>1){for(let rt=0;rt<arguments.length;rt++)this.remove(arguments[rt]);return this}const et=this.children.indexOf(_e);return et!==-1&&(_e.parent=null,this.children.splice(et,1),_e.dispatchEvent(_removedEvent),_childremovedEvent.child=_e,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const _e=this.parent;return _e!==null&&_e.remove(this),this}clear(){return this.remove(...this.children)}attach(_e){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),_e.parent!==null&&(_e.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(_e.parent.matrixWorld)),_e.applyMatrix4(_m1$1),_e.removeFromParent(),_e.parent=this,this.children.push(_e),_e.updateWorldMatrix(!1,!0),_e.dispatchEvent(_addedEvent),_childaddedEvent.child=_e,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(_e){return this.getObjectByProperty("id",_e)}getObjectByName(_e){return this.getObjectByProperty("name",_e)}getObjectByProperty(_e,et){if(this[_e]===et)return this;for(let rt=0,it=this.children.length;rt<it;rt++){const ot=this.children[rt].getObjectByProperty(_e,et);if(ot!==void 0)return ot}}getObjectsByProperty(_e,et,rt=[]){this[_e]===et&&rt.push(this);const it=this.children;for(let st=0,ot=it.length;st<ot;st++)it[st].getObjectsByProperty(_e,et,rt);return rt}getWorldPosition(_e){return this.updateWorldMatrix(!0,!1),_e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_e,_scale$2),_e}getWorldScale(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_e),_e}getWorldDirection(_e){this.updateWorldMatrix(!0,!1);const et=this.matrixWorld.elements;return _e.set(et[8],et[9],et[10]).normalize()}raycast(){}traverse(_e){_e(this);const et=this.children;for(let rt=0,it=et.length;rt<it;rt++)et[rt].traverse(_e)}traverseVisible(_e){if(this.visible===!1)return;_e(this);const et=this.children;for(let rt=0,it=et.length;rt<it;rt++)et[rt].traverseVisible(_e)}traverseAncestors(_e){const et=this.parent;et!==null&&(_e(et),et.traverseAncestors(_e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_e=!0);const et=this.children;for(let rt=0,it=et.length;rt<it;rt++)et[rt].updateMatrixWorld(_e)}updateWorldMatrix(_e,et){const rt=this.parent;if(_e===!0&&rt!==null&&rt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),et===!0){const it=this.children;for(let st=0,ot=it.length;st<ot;st++)it[st].updateWorldMatrix(!1,!0)}}toJSON(_e){const et=_e===void 0||typeof _e=="string",rt={};et&&(_e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},rt.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const it={};it.uuid=this.uuid,it.type=this.type,this.name!==""&&(it.name=this.name),this.castShadow===!0&&(it.castShadow=!0),this.receiveShadow===!0&&(it.receiveShadow=!0),this.visible===!1&&(it.visible=!1),this.frustumCulled===!1&&(it.frustumCulled=!1),this.renderOrder!==0&&(it.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(it.userData=this.userData),it.layers=this.layers.mask,it.matrix=this.matrix.toArray(),it.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(it.matrixAutoUpdate=!1),this.isInstancedMesh&&(it.type="InstancedMesh",it.count=this.count,it.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(it.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(it.type="BatchedMesh",it.perObjectFrustumCulled=this.perObjectFrustumCulled,it.sortObjects=this.sortObjects,it.drawRanges=this._drawRanges,it.reservedRanges=this._reservedRanges,it.visibility=this._visibility,it.active=this._active,it.bounds=this._bounds.map(at=>({boxInitialized:at.boxInitialized,boxMin:at.box.min.toArray(),boxMax:at.box.max.toArray(),sphereInitialized:at.sphereInitialized,sphereRadius:at.sphere.radius,sphereCenter:at.sphere.center.toArray()})),it.maxInstanceCount=this._maxInstanceCount,it.maxVertexCount=this._maxVertexCount,it.maxIndexCount=this._maxIndexCount,it.geometryInitialized=this._geometryInitialized,it.geometryCount=this._geometryCount,it.matricesTexture=this._matricesTexture.toJSON(_e),this._colorsTexture!==null&&(it.colorsTexture=this._colorsTexture.toJSON(_e)),this.boundingSphere!==null&&(it.boundingSphere={center:it.boundingSphere.center.toArray(),radius:it.boundingSphere.radius}),this.boundingBox!==null&&(it.boundingBox={min:it.boundingBox.min.toArray(),max:it.boundingBox.max.toArray()}));function st(at,lt){return at[lt.uuid]===void 0&&(at[lt.uuid]=lt.toJSON(_e)),lt.uuid}if(this.isScene)this.background&&(this.background.isColor?it.background=this.background.toJSON():this.background.isTexture&&(it.background=this.background.toJSON(_e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(it.environment=this.environment.toJSON(_e).uuid);else if(this.isMesh||this.isLine||this.isPoints){it.geometry=st(_e.geometries,this.geometry);const at=this.geometry.parameters;if(at!==void 0&&at.shapes!==void 0){const lt=at.shapes;if(Array.isArray(lt))for(let ct=0,ut=lt.length;ct<ut;ct++){const ht=lt[ct];st(_e.shapes,ht)}else st(_e.shapes,lt)}}if(this.isSkinnedMesh&&(it.bindMode=this.bindMode,it.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(st(_e.skeletons,this.skeleton),it.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const at=[];for(let lt=0,ct=this.material.length;lt<ct;lt++)at.push(st(_e.materials,this.material[lt]));it.material=at}else it.material=st(_e.materials,this.material);if(this.children.length>0){it.children=[];for(let at=0;at<this.children.length;at++)it.children.push(this.children[at].toJSON(_e).object)}if(this.animations.length>0){it.animations=[];for(let at=0;at<this.animations.length;at++){const lt=this.animations[at];it.animations.push(st(_e.animations,lt))}}if(et){const at=ot(_e.geometries),lt=ot(_e.materials),ct=ot(_e.textures),ut=ot(_e.images),ht=ot(_e.shapes),dt=ot(_e.skeletons),ft=ot(_e.animations),pt=ot(_e.nodes);at.length>0&&(rt.geometries=at),lt.length>0&&(rt.materials=lt),ct.length>0&&(rt.textures=ct),ut.length>0&&(rt.images=ut),ht.length>0&&(rt.shapes=ht),dt.length>0&&(rt.skeletons=dt),ft.length>0&&(rt.animations=ft),pt.length>0&&(rt.nodes=pt)}return rt.object=it,rt;function ot(at){const lt=[];for(const ct in at){const ut=at[ct];delete ut.metadata,lt.push(ut)}return lt}}clone(_e){return new this.constructor().copy(this,_e)}copy(_e,et=!0){if(this.name=_e.name,this.up.copy(_e.up),this.position.copy(_e.position),this.rotation.order=_e.rotation.order,this.quaternion.copy(_e.quaternion),this.scale.copy(_e.scale),this.matrix.copy(_e.matrix),this.matrixWorld.copy(_e.matrixWorld),this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrixWorldAutoUpdate=_e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_e.matrixWorldNeedsUpdate,this.layers.mask=_e.layers.mask,this.visible=_e.visible,this.castShadow=_e.castShadow,this.receiveShadow=_e.receiveShadow,this.frustumCulled=_e.frustumCulled,this.renderOrder=_e.renderOrder,this.animations=_e.animations.slice(),this.userData=JSON.parse(JSON.stringify(_e.userData)),et===!0)for(let rt=0;rt<_e.children.length;rt++){const it=_e.children[rt];this.add(it.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3,_v40=new Vector4,_v41=new Vector4,_v42=new Vector4;class Triangle{constructor(_e=new Vector3,et=new Vector3,rt=new Vector3){this.a=_e,this.b=et,this.c=rt}static getNormal(_e,et,rt,it){it.subVectors(rt,et),_v0$1.subVectors(_e,et),it.cross(_v0$1);const st=it.lengthSq();return st>0?it.multiplyScalar(1/Math.sqrt(st)):it.set(0,0,0)}static getBarycoord(_e,et,rt,it,st){_v0$1.subVectors(it,et),_v1$3.subVectors(rt,et),_v2$2.subVectors(_e,et);const ot=_v0$1.dot(_v0$1),at=_v0$1.dot(_v1$3),lt=_v0$1.dot(_v2$2),ct=_v1$3.dot(_v1$3),ut=_v1$3.dot(_v2$2),ht=ot*ct-at*at;if(ht===0)return st.set(0,0,0),null;const dt=1/ht,ft=(ct*lt-at*ut)*dt,pt=(ot*ut-at*lt)*dt;return st.set(1-ft-pt,pt,ft)}static containsPoint(_e,et,rt,it){return this.getBarycoord(_e,et,rt,it,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(_e,et,rt,it,st,ot,at,lt){return this.getBarycoord(_e,et,rt,it,_v3$2)===null?(lt.x=0,lt.y=0,"z"in lt&&(lt.z=0),"w"in lt&&(lt.w=0),null):(lt.setScalar(0),lt.addScaledVector(st,_v3$2.x),lt.addScaledVector(ot,_v3$2.y),lt.addScaledVector(at,_v3$2.z),lt)}static getInterpolatedAttribute(_e,et,rt,it,st,ot){return _v40.setScalar(0),_v41.setScalar(0),_v42.setScalar(0),_v40.fromBufferAttribute(_e,et),_v41.fromBufferAttribute(_e,rt),_v42.fromBufferAttribute(_e,it),ot.setScalar(0),ot.addScaledVector(_v40,st.x),ot.addScaledVector(_v41,st.y),ot.addScaledVector(_v42,st.z),ot}static isFrontFacing(_e,et,rt,it){return _v0$1.subVectors(rt,et),_v1$3.subVectors(_e,et),_v0$1.cross(_v1$3).dot(it)<0}set(_e,et,rt){return this.a.copy(_e),this.b.copy(et),this.c.copy(rt),this}setFromPointsAndIndices(_e,et,rt,it){return this.a.copy(_e[et]),this.b.copy(_e[rt]),this.c.copy(_e[it]),this}setFromAttributeAndIndices(_e,et,rt,it){return this.a.fromBufferAttribute(_e,et),this.b.fromBufferAttribute(_e,rt),this.c.fromBufferAttribute(_e,it),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.a.copy(_e.a),this.b.copy(_e.b),this.c.copy(_e.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_e){return _e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_e){return Triangle.getNormal(this.a,this.b,this.c,_e)}getPlane(_e){return _e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_e,et){return Triangle.getBarycoord(_e,this.a,this.b,this.c,et)}getInterpolation(_e,et,rt,it,st){return Triangle.getInterpolation(_e,this.a,this.b,this.c,et,rt,it,st)}containsPoint(_e){return Triangle.containsPoint(_e,this.a,this.b,this.c)}isFrontFacing(_e){return Triangle.isFrontFacing(this.a,this.b,this.c,_e)}intersectsBox(_e){return _e.intersectsTriangle(this)}closestPointToPoint(_e,et){const rt=this.a,it=this.b,st=this.c;let ot,at;_vab.subVectors(it,rt),_vac.subVectors(st,rt),_vap.subVectors(_e,rt);const lt=_vab.dot(_vap),ct=_vac.dot(_vap);if(lt<=0&&ct<=0)return et.copy(rt);_vbp.subVectors(_e,it);const ut=_vab.dot(_vbp),ht=_vac.dot(_vbp);if(ut>=0&&ht<=ut)return et.copy(it);const dt=lt*ht-ut*ct;if(dt<=0&&lt>=0&&ut<=0)return ot=lt/(lt-ut),et.copy(rt).addScaledVector(_vab,ot);_vcp.subVectors(_e,st);const ft=_vab.dot(_vcp),pt=_vac.dot(_vcp);if(pt>=0&&ft<=pt)return et.copy(st);const mt=ft*ct-lt*pt;if(mt<=0&&ct>=0&&pt<=0)return at=ct/(ct-pt),et.copy(rt).addScaledVector(_vac,at);const At=ut*pt-ft*ht;if(At<=0&&ht-ut>=0&&ft-pt>=0)return _vbc.subVectors(st,it),at=(ht-ut)/(ht-ut+(ft-pt)),et.copy(it).addScaledVector(_vbc,at);const gt=1/(At+mt+dt);return ot=mt*gt,at=dt*gt,et.copy(rt).addScaledVector(_vab,ot).addScaledVector(_vac,at)}equals(_e){return _e.a.equals(this.a)&&_e.b.equals(this.b)&&_e.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(nt,_e,et){return et<0&&(et+=1),et>1&&(et-=1),et<1/6?nt+(_e-nt)*6*et:et<1/2?_e:et<2/3?nt+(_e-nt)*6*(2/3-et):nt}class Color{constructor(_e,et,rt){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_e,et,rt)}set(_e,et,rt){if(et===void 0&&rt===void 0){const it=_e;it&&it.isColor?this.copy(it):typeof it=="number"?this.setHex(it):typeof it=="string"&&this.setStyle(it)}else this.setRGB(_e,et,rt);return this}setScalar(_e){return this.r=_e,this.g=_e,this.b=_e,this}setHex(_e,et=SRGBColorSpace){return _e=Math.floor(_e),this.r=(_e>>16&255)/255,this.g=(_e>>8&255)/255,this.b=(_e&255)/255,ColorManagement.toWorkingColorSpace(this,et),this}setRGB(_e,et,rt,it=ColorManagement.workingColorSpace){return this.r=_e,this.g=et,this.b=rt,ColorManagement.toWorkingColorSpace(this,it),this}setHSL(_e,et,rt,it=ColorManagement.workingColorSpace){if(_e=euclideanModulo(_e,1),et=clamp$1(et,0,1),rt=clamp$1(rt,0,1),et===0)this.r=this.g=this.b=rt;else{const st=rt<=.5?rt*(1+et):rt+et-rt*et,ot=2*rt-st;this.r=hue2rgb(ot,st,_e+1/3),this.g=hue2rgb(ot,st,_e),this.b=hue2rgb(ot,st,_e-1/3)}return ColorManagement.toWorkingColorSpace(this,it),this}setStyle(_e,et=SRGBColorSpace){function rt(st){st!==void 0&&parseFloat(st)<1&&console.warn("THREE.Color: Alpha component of "+_e+" will be ignored.")}let it;if(it=/^(\w+)\(([^\)]*)\)/.exec(_e)){let st;const ot=it[1],at=it[2];switch(ot){case"rgb":case"rgba":if(st=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(at))return rt(st[4]),this.setRGB(Math.min(255,parseInt(st[1],10))/255,Math.min(255,parseInt(st[2],10))/255,Math.min(255,parseInt(st[3],10))/255,et);if(st=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(at))return rt(st[4]),this.setRGB(Math.min(100,parseInt(st[1],10))/100,Math.min(100,parseInt(st[2],10))/100,Math.min(100,parseInt(st[3],10))/100,et);break;case"hsl":case"hsla":if(st=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(at))return rt(st[4]),this.setHSL(parseFloat(st[1])/360,parseFloat(st[2])/100,parseFloat(st[3])/100,et);break;default:console.warn("THREE.Color: Unknown color model "+_e)}}else if(it=/^\#([A-Fa-f\d]+)$/.exec(_e)){const st=it[1],ot=st.length;if(ot===3)return this.setRGB(parseInt(st.charAt(0),16)/15,parseInt(st.charAt(1),16)/15,parseInt(st.charAt(2),16)/15,et);if(ot===6)return this.setHex(parseInt(st,16),et);console.warn("THREE.Color: Invalid hex color "+_e)}else if(_e&&_e.length>0)return this.setColorName(_e,et);return this}setColorName(_e,et=SRGBColorSpace){const rt=_colorKeywords[_e.toLowerCase()];return rt!==void 0?this.setHex(rt,et):console.warn("THREE.Color: Unknown color "+_e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_e){return this.r=_e.r,this.g=_e.g,this.b=_e.b,this}copySRGBToLinear(_e){return this.r=SRGBToLinear(_e.r),this.g=SRGBToLinear(_e.g),this.b=SRGBToLinear(_e.b),this}copyLinearToSRGB(_e){return this.r=LinearToSRGB(_e.r),this.g=LinearToSRGB(_e.g),this.b=LinearToSRGB(_e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_e=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_e),Math.round(clamp$1(_color.r*255,0,255))*65536+Math.round(clamp$1(_color.g*255,0,255))*256+Math.round(clamp$1(_color.b*255,0,255))}getHexString(_e=SRGBColorSpace){return("000000"+this.getHex(_e).toString(16)).slice(-6)}getHSL(_e,et=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),et);const rt=_color.r,it=_color.g,st=_color.b,ot=Math.max(rt,it,st),at=Math.min(rt,it,st);let lt,ct;const ut=(at+ot)/2;if(at===ot)lt=0,ct=0;else{const ht=ot-at;switch(ct=ut<=.5?ht/(ot+at):ht/(2-ot-at),ot){case rt:lt=(it-st)/ht+(it<st?6:0);break;case it:lt=(st-rt)/ht+2;break;case st:lt=(rt-it)/ht+4;break}lt/=6}return _e.h=lt,_e.s=ct,_e.l=ut,_e}getRGB(_e,et=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),et),_e.r=_color.r,_e.g=_color.g,_e.b=_color.b,_e}getStyle(_e=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),_e);const et=_color.r,rt=_color.g,it=_color.b;return _e!==SRGBColorSpace?`color(${_e} ${et.toFixed(3)} ${rt.toFixed(3)} ${it.toFixed(3)})`:`rgb(${Math.round(et*255)},${Math.round(rt*255)},${Math.round(it*255)})`}offsetHSL(_e,et,rt){return this.getHSL(_hslA),this.setHSL(_hslA.h+_e,_hslA.s+et,_hslA.l+rt)}add(_e){return this.r+=_e.r,this.g+=_e.g,this.b+=_e.b,this}addColors(_e,et){return this.r=_e.r+et.r,this.g=_e.g+et.g,this.b=_e.b+et.b,this}addScalar(_e){return this.r+=_e,this.g+=_e,this.b+=_e,this}sub(_e){return this.r=Math.max(0,this.r-_e.r),this.g=Math.max(0,this.g-_e.g),this.b=Math.max(0,this.b-_e.b),this}multiply(_e){return this.r*=_e.r,this.g*=_e.g,this.b*=_e.b,this}multiplyScalar(_e){return this.r*=_e,this.g*=_e,this.b*=_e,this}lerp(_e,et){return this.r+=(_e.r-this.r)*et,this.g+=(_e.g-this.g)*et,this.b+=(_e.b-this.b)*et,this}lerpColors(_e,et,rt){return this.r=_e.r+(et.r-_e.r)*rt,this.g=_e.g+(et.g-_e.g)*rt,this.b=_e.b+(et.b-_e.b)*rt,this}lerpHSL(_e,et){this.getHSL(_hslA),_e.getHSL(_hslB);const rt=lerp(_hslA.h,_hslB.h,et),it=lerp(_hslA.s,_hslB.s,et),st=lerp(_hslA.l,_hslB.l,et);return this.setHSL(rt,it,st),this}setFromVector3(_e){return this.r=_e.x,this.g=_e.y,this.b=_e.z,this}applyMatrix3(_e){const et=this.r,rt=this.g,it=this.b,st=_e.elements;return this.r=st[0]*et+st[3]*rt+st[6]*it,this.g=st[1]*et+st[4]*rt+st[7]*it,this.b=st[2]*et+st[5]*rt+st[8]*it,this}equals(_e){return _e.r===this.r&&_e.g===this.g&&_e.b===this.b}fromArray(_e,et=0){return this.r=_e[et],this.g=_e[et+1],this.b=_e[et+2],this}toArray(_e=[],et=0){return _e[et]=this.r,_e[et+1]=this.g,_e[et+2]=this.b,_e}fromBufferAttribute(_e,et){return this.r=_e.getX(et),this.g=_e.getY(et),this.b=_e.getZ(et),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_e){this._alphaTest>0!=_e>0&&this.version++,this._alphaTest=_e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_e){if(_e!==void 0)for(const et in _e){const rt=_e[et];if(rt===void 0){console.warn(`THREE.Material: parameter '${et}' has value of undefined.`);continue}const it=this[et];if(it===void 0){console.warn(`THREE.Material: '${et}' is not a property of THREE.${this.type}.`);continue}it&&it.isColor?it.set(rt):it&&it.isVector3&&rt&&rt.isVector3?it.copy(rt):this[et]=rt}}toJSON(_e){const et=_e===void 0||typeof _e=="string";et&&(_e={textures:{},images:{}});const rt={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};rt.uuid=this.uuid,rt.type=this.type,this.name!==""&&(rt.name=this.name),this.color&&this.color.isColor&&(rt.color=this.color.getHex()),this.roughness!==void 0&&(rt.roughness=this.roughness),this.metalness!==void 0&&(rt.metalness=this.metalness),this.sheen!==void 0&&(rt.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(rt.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(rt.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(rt.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(rt.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(rt.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(rt.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(rt.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(rt.shininess=this.shininess),this.clearcoat!==void 0&&(rt.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(rt.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(rt.clearcoatMap=this.clearcoatMap.toJSON(_e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(rt.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(rt.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_e).uuid,rt.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(rt.dispersion=this.dispersion),this.iridescence!==void 0&&(rt.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(rt.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(rt.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(rt.iridescenceMap=this.iridescenceMap.toJSON(_e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(rt.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_e).uuid),this.anisotropy!==void 0&&(rt.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(rt.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(rt.anisotropyMap=this.anisotropyMap.toJSON(_e).uuid),this.map&&this.map.isTexture&&(rt.map=this.map.toJSON(_e).uuid),this.matcap&&this.matcap.isTexture&&(rt.matcap=this.matcap.toJSON(_e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(rt.alphaMap=this.alphaMap.toJSON(_e).uuid),this.lightMap&&this.lightMap.isTexture&&(rt.lightMap=this.lightMap.toJSON(_e).uuid,rt.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(rt.aoMap=this.aoMap.toJSON(_e).uuid,rt.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(rt.bumpMap=this.bumpMap.toJSON(_e).uuid,rt.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(rt.normalMap=this.normalMap.toJSON(_e).uuid,rt.normalMapType=this.normalMapType,rt.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(rt.displacementMap=this.displacementMap.toJSON(_e).uuid,rt.displacementScale=this.displacementScale,rt.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(rt.roughnessMap=this.roughnessMap.toJSON(_e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(rt.metalnessMap=this.metalnessMap.toJSON(_e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(rt.emissiveMap=this.emissiveMap.toJSON(_e).uuid),this.specularMap&&this.specularMap.isTexture&&(rt.specularMap=this.specularMap.toJSON(_e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(rt.specularIntensityMap=this.specularIntensityMap.toJSON(_e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(rt.specularColorMap=this.specularColorMap.toJSON(_e).uuid),this.envMap&&this.envMap.isTexture&&(rt.envMap=this.envMap.toJSON(_e).uuid,this.combine!==void 0&&(rt.combine=this.combine)),this.envMapRotation!==void 0&&(rt.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(rt.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(rt.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(rt.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(rt.gradientMap=this.gradientMap.toJSON(_e).uuid),this.transmission!==void 0&&(rt.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(rt.transmissionMap=this.transmissionMap.toJSON(_e).uuid),this.thickness!==void 0&&(rt.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(rt.thicknessMap=this.thicknessMap.toJSON(_e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(rt.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(rt.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(rt.size=this.size),this.shadowSide!==null&&(rt.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(rt.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(rt.blending=this.blending),this.side!==FrontSide&&(rt.side=this.side),this.vertexColors===!0&&(rt.vertexColors=!0),this.opacity<1&&(rt.opacity=this.opacity),this.transparent===!0&&(rt.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(rt.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(rt.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(rt.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(rt.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(rt.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(rt.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(rt.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(rt.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(rt.depthFunc=this.depthFunc),this.depthTest===!1&&(rt.depthTest=this.depthTest),this.depthWrite===!1&&(rt.depthWrite=this.depthWrite),this.colorWrite===!1&&(rt.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(rt.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(rt.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(rt.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(rt.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(rt.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(rt.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(rt.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(rt.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(rt.rotation=this.rotation),this.polygonOffset===!0&&(rt.polygonOffset=!0),this.polygonOffsetFactor!==0&&(rt.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(rt.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(rt.linewidth=this.linewidth),this.dashSize!==void 0&&(rt.dashSize=this.dashSize),this.gapSize!==void 0&&(rt.gapSize=this.gapSize),this.scale!==void 0&&(rt.scale=this.scale),this.dithering===!0&&(rt.dithering=!0),this.alphaTest>0&&(rt.alphaTest=this.alphaTest),this.alphaHash===!0&&(rt.alphaHash=!0),this.alphaToCoverage===!0&&(rt.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(rt.premultipliedAlpha=!0),this.forceSinglePass===!0&&(rt.forceSinglePass=!0),this.wireframe===!0&&(rt.wireframe=!0),this.wireframeLinewidth>1&&(rt.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(rt.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(rt.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(rt.flatShading=!0),this.visible===!1&&(rt.visible=!1),this.toneMapped===!1&&(rt.toneMapped=!1),this.fog===!1&&(rt.fog=!1),Object.keys(this.userData).length>0&&(rt.userData=this.userData);function it(st){const ot=[];for(const at in st){const lt=st[at];delete lt.metadata,ot.push(lt)}return ot}if(et){const st=it(_e.textures),ot=it(_e.images);st.length>0&&(rt.textures=st),ot.length>0&&(rt.images=ot)}return rt}clone(){return new this.constructor().copy(this)}copy(_e){this.name=_e.name,this.blending=_e.blending,this.side=_e.side,this.vertexColors=_e.vertexColors,this.opacity=_e.opacity,this.transparent=_e.transparent,this.blendSrc=_e.blendSrc,this.blendDst=_e.blendDst,this.blendEquation=_e.blendEquation,this.blendSrcAlpha=_e.blendSrcAlpha,this.blendDstAlpha=_e.blendDstAlpha,this.blendEquationAlpha=_e.blendEquationAlpha,this.blendColor.copy(_e.blendColor),this.blendAlpha=_e.blendAlpha,this.depthFunc=_e.depthFunc,this.depthTest=_e.depthTest,this.depthWrite=_e.depthWrite,this.stencilWriteMask=_e.stencilWriteMask,this.stencilFunc=_e.stencilFunc,this.stencilRef=_e.stencilRef,this.stencilFuncMask=_e.stencilFuncMask,this.stencilFail=_e.stencilFail,this.stencilZFail=_e.stencilZFail,this.stencilZPass=_e.stencilZPass,this.stencilWrite=_e.stencilWrite;const et=_e.clippingPlanes;let rt=null;if(et!==null){const it=et.length;rt=new Array(it);for(let st=0;st!==it;++st)rt[st]=et[st].clone()}return this.clippingPlanes=rt,this.clipIntersection=_e.clipIntersection,this.clipShadows=_e.clipShadows,this.shadowSide=_e.shadowSide,this.colorWrite=_e.colorWrite,this.precision=_e.precision,this.polygonOffset=_e.polygonOffset,this.polygonOffsetFactor=_e.polygonOffsetFactor,this.polygonOffsetUnits=_e.polygonOffsetUnits,this.dithering=_e.dithering,this.alphaTest=_e.alphaTest,this.alphaHash=_e.alphaHash,this.alphaToCoverage=_e.alphaToCoverage,this.premultipliedAlpha=_e.premultipliedAlpha,this.forceSinglePass=_e.forceSinglePass,this.visible=_e.visible,this.toneMapped=_e.toneMapped,this.userData=JSON.parse(JSON.stringify(_e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_e){_e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class MeshBasicMaterial extends Material{constructor(_e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}}const _tables=_generateTables();function _generateTables(){const nt=new ArrayBuffer(4),_e=new Float32Array(nt),et=new Uint32Array(nt),rt=new Uint32Array(512),it=new Uint32Array(512);for(let lt=0;lt<256;++lt){const ct=lt-127;ct<-27?(rt[lt]=0,rt[lt|256]=32768,it[lt]=24,it[lt|256]=24):ct<-14?(rt[lt]=1024>>-ct-14,rt[lt|256]=1024>>-ct-14|32768,it[lt]=-ct-1,it[lt|256]=-ct-1):ct<=15?(rt[lt]=ct+15<<10,rt[lt|256]=ct+15<<10|32768,it[lt]=13,it[lt|256]=13):ct<128?(rt[lt]=31744,rt[lt|256]=64512,it[lt]=24,it[lt|256]=24):(rt[lt]=31744,rt[lt|256]=64512,it[lt]=13,it[lt|256]=13)}const st=new Uint32Array(2048),ot=new Uint32Array(64),at=new Uint32Array(64);for(let lt=1;lt<1024;++lt){let ct=lt<<13,ut=0;for(;!(ct&8388608);)ct<<=1,ut-=8388608;ct&=-8388609,ut+=947912704,st[lt]=ct|ut}for(let lt=1024;lt<2048;++lt)st[lt]=939524096+(lt-1024<<13);for(let lt=1;lt<31;++lt)ot[lt]=lt<<23;ot[31]=1199570944,ot[32]=2147483648;for(let lt=33;lt<63;++lt)ot[lt]=2147483648+(lt-32<<23);ot[63]=3347054592;for(let lt=1;lt<64;++lt)lt!==32&&(at[lt]=1024);return{floatView:_e,uint32View:et,baseTable:rt,shiftTable:it,mantissaTable:st,exponentTable:ot,offsetTable:at}}function toHalfFloat(nt){Math.abs(nt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),nt=clamp$1(nt,-65504,65504),_tables.floatView[0]=nt;const _e=_tables.uint32View[0],et=_e>>23&511;return _tables.baseTable[et]+((_e&8388607)>>_tables.shiftTable[et])}function fromHalfFloat(nt){const _e=nt>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_e]+(nt&1023)]+_tables.exponentTable[_e],_tables.floatView[0]}const _vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_e,et,rt=!1){if(Array.isArray(_e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_e,this.itemSize=et,this.count=_e!==void 0?_e.length/et:0,this.normalized=rt,this.usage=StaticDrawUsage,this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}addUpdateRange(_e,et){this.updateRanges.push({start:_e,count:et})}clearUpdateRanges(){this.updateRanges.length=0}copy(_e){return this.name=_e.name,this.array=new _e.array.constructor(_e.array),this.itemSize=_e.itemSize,this.count=_e.count,this.normalized=_e.normalized,this.usage=_e.usage,this.gpuType=_e.gpuType,this}copyAt(_e,et,rt){_e*=this.itemSize,rt*=et.itemSize;for(let it=0,st=this.itemSize;it<st;it++)this.array[_e+it]=et.array[rt+it];return this}copyArray(_e){return this.array.set(_e),this}applyMatrix3(_e){if(this.itemSize===2)for(let et=0,rt=this.count;et<rt;et++)_vector2$1.fromBufferAttribute(this,et),_vector2$1.applyMatrix3(_e),this.setXY(et,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let et=0,rt=this.count;et<rt;et++)_vector$9.fromBufferAttribute(this,et),_vector$9.applyMatrix3(_e),this.setXYZ(et,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$9.fromBufferAttribute(this,et),_vector$9.applyMatrix4(_e),this.setXYZ(et,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$9.fromBufferAttribute(this,et),_vector$9.applyNormalMatrix(_e),this.setXYZ(et,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$9.fromBufferAttribute(this,et),_vector$9.transformDirection(_e),this.setXYZ(et,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_e,et=0){return this.array.set(_e,et),this}getComponent(_e,et){let rt=this.array[_e*this.itemSize+et];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setComponent(_e,et,rt){return this.normalized&&(rt=normalize$1(rt,this.array)),this.array[_e*this.itemSize+et]=rt,this}getX(_e){let et=this.array[_e*this.itemSize];return this.normalized&&(et=denormalize(et,this.array)),et}setX(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize]=et,this}getY(_e){let et=this.array[_e*this.itemSize+1];return this.normalized&&(et=denormalize(et,this.array)),et}setY(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize+1]=et,this}getZ(_e){let et=this.array[_e*this.itemSize+2];return this.normalized&&(et=denormalize(et,this.array)),et}setZ(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize+2]=et,this}getW(_e){let et=this.array[_e*this.itemSize+3];return this.normalized&&(et=denormalize(et,this.array)),et}setW(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize+3]=et,this}setXY(_e,et,rt){return _e*=this.itemSize,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array)),this.array[_e+0]=et,this.array[_e+1]=rt,this}setXYZ(_e,et,rt,it){return _e*=this.itemSize,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array),it=normalize$1(it,this.array)),this.array[_e+0]=et,this.array[_e+1]=rt,this.array[_e+2]=it,this}setXYZW(_e,et,rt,it,st){return _e*=this.itemSize,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array),it=normalize$1(it,this.array),st=normalize$1(st,this.array)),this.array[_e+0]=et,this.array[_e+1]=rt,this.array[_e+2]=it,this.array[_e+3]=st,this}onUpload(_e){return this.onUploadCallback=_e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_e.name=this.name),this.usage!==StaticDrawUsage&&(_e.usage=this.usage),_e}}class Uint16BufferAttribute extends BufferAttribute{constructor(_e,et,rt){super(new Uint16Array(_e),et,rt)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_e,et,rt){super(new Uint32Array(_e),et,rt)}}class Float16BufferAttribute extends BufferAttribute{constructor(_e,et,rt){super(new Uint16Array(_e),et,rt),this.isFloat16BufferAttribute=!0}getX(_e){let et=fromHalfFloat(this.array[_e*this.itemSize]);return this.normalized&&(et=denormalize(et,this.array)),et}setX(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize]=toHalfFloat(et),this}getY(_e){let et=fromHalfFloat(this.array[_e*this.itemSize+1]);return this.normalized&&(et=denormalize(et,this.array)),et}setY(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize+1]=toHalfFloat(et),this}getZ(_e){let et=fromHalfFloat(this.array[_e*this.itemSize+2]);return this.normalized&&(et=denormalize(et,this.array)),et}setZ(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize+2]=toHalfFloat(et),this}getW(_e){let et=fromHalfFloat(this.array[_e*this.itemSize+3]);return this.normalized&&(et=denormalize(et,this.array)),et}setW(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.array[_e*this.itemSize+3]=toHalfFloat(et),this}setXY(_e,et,rt){return _e*=this.itemSize,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array)),this.array[_e+0]=toHalfFloat(et),this.array[_e+1]=toHalfFloat(rt),this}setXYZ(_e,et,rt,it){return _e*=this.itemSize,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array),it=normalize$1(it,this.array)),this.array[_e+0]=toHalfFloat(et),this.array[_e+1]=toHalfFloat(rt),this.array[_e+2]=toHalfFloat(it),this}setXYZW(_e,et,rt,it,st){return _e*=this.itemSize,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array),it=normalize$1(it,this.array),st=normalize$1(st,this.array)),this.array[_e+0]=toHalfFloat(et),this.array[_e+1]=toHalfFloat(rt),this.array[_e+2]=toHalfFloat(it),this.array[_e+3]=toHalfFloat(st),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_e,et,rt){super(new Float32Array(_e),et,rt)}}let _id$9=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$9++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_e){return Array.isArray(_e)?this.index=new(arrayNeedsUint32$1(_e)?Uint32BufferAttribute:Uint16BufferAttribute)(_e,1):this.index=_e,this}getAttribute(_e){return this.attributes[_e]}setAttribute(_e,et){return this.attributes[_e]=et,this}deleteAttribute(_e){return delete this.attributes[_e],this}hasAttribute(_e){return this.attributes[_e]!==void 0}addGroup(_e,et,rt=0){this.groups.push({start:_e,count:et,materialIndex:rt})}clearGroups(){this.groups=[]}setDrawRange(_e,et){this.drawRange.start=_e,this.drawRange.count=et}applyMatrix4(_e){const et=this.attributes.position;et!==void 0&&(et.applyMatrix4(_e),et.needsUpdate=!0);const rt=this.attributes.normal;if(rt!==void 0){const st=new Matrix3().getNormalMatrix(_e);rt.applyNormalMatrix(st),rt.needsUpdate=!0}const it=this.attributes.tangent;return it!==void 0&&(it.transformDirection(_e),it.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_e){return _m1.makeRotationFromQuaternion(_e),this.applyMatrix4(_m1),this}rotateX(_e){return _m1.makeRotationX(_e),this.applyMatrix4(_m1),this}rotateY(_e){return _m1.makeRotationY(_e),this.applyMatrix4(_m1),this}rotateZ(_e){return _m1.makeRotationZ(_e),this.applyMatrix4(_m1),this}translate(_e,et,rt){return _m1.makeTranslation(_e,et,rt),this.applyMatrix4(_m1),this}scale(_e,et,rt){return _m1.makeScale(_e,et,rt),this.applyMatrix4(_m1),this}lookAt(_e){return _obj.lookAt(_e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_e){const et=[];for(let rt=0,it=_e.length;rt<it;rt++){const st=_e[rt];et.push(st.x,st.y,st.z||0)}return this.setAttribute("position",new Float32BufferAttribute(et,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _e=this.attributes.position,et=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_e!==void 0){if(this.boundingBox.setFromBufferAttribute(_e),et)for(let rt=0,it=et.length;rt<it;rt++){const st=et[rt];_box$2.setFromBufferAttribute(st),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _e=this.attributes.position,et=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(_e){const rt=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(_e),et)for(let st=0,ot=et.length;st<ot;st++){const at=et[st];_boxMorphTargets.setFromBufferAttribute(at),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(rt);let it=0;for(let st=0,ot=_e.count;st<ot;st++)_vector$8.fromBufferAttribute(_e,st),it=Math.max(it,rt.distanceToSquared(_vector$8));if(et)for(let st=0,ot=et.length;st<ot;st++){const at=et[st],lt=this.morphTargetsRelative;for(let ct=0,ut=at.count;ct<ut;ct++)_vector$8.fromBufferAttribute(at,ct),lt&&(_offset.fromBufferAttribute(_e,ct),_vector$8.add(_offset)),it=Math.max(it,rt.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(it),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _e=this.index,et=this.attributes;if(_e===null||et.position===void 0||et.normal===void 0||et.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const rt=et.position,it=et.normal,st=et.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*rt.count),4));const ot=this.getAttribute("tangent"),at=[],lt=[];for(let $t=0;$t<rt.count;$t++)at[$t]=new Vector3,lt[$t]=new Vector3;const ct=new Vector3,ut=new Vector3,ht=new Vector3,dt=new Vector2,ft=new Vector2,pt=new Vector2,mt=new Vector3,At=new Vector3;function gt($t,kt,Dt){ct.fromBufferAttribute(rt,$t),ut.fromBufferAttribute(rt,kt),ht.fromBufferAttribute(rt,Dt),dt.fromBufferAttribute(st,$t),ft.fromBufferAttribute(st,kt),pt.fromBufferAttribute(st,Dt),ut.sub(ct),ht.sub(ct),ft.sub(dt),pt.sub(dt);const Ot=1/(ft.x*pt.y-pt.x*ft.y);isFinite(Ot)&&(mt.copy(ut).multiplyScalar(pt.y).addScaledVector(ht,-ft.y).multiplyScalar(Ot),At.copy(ht).multiplyScalar(ft.x).addScaledVector(ut,-pt.x).multiplyScalar(Ot),at[$t].add(mt),at[kt].add(mt),at[Dt].add(mt),lt[$t].add(At),lt[kt].add(At),lt[Dt].add(At))}let bt=this.groups;bt.length===0&&(bt=[{start:0,count:_e.count}]);for(let $t=0,kt=bt.length;$t<kt;++$t){const Dt=bt[$t],Ot=Dt.start,zt=Dt.count;for(let Ht=Ot,Yt=Ot+zt;Ht<Yt;Ht+=3)gt(_e.getX(Ht+0),_e.getX(Ht+1),_e.getX(Ht+2))}const Tt=new Vector3,wt=new Vector3,Rt=new Vector3,It=new Vector3;function Lt($t){Rt.fromBufferAttribute(it,$t),It.copy(Rt);const kt=at[$t];Tt.copy(kt),Tt.sub(Rt.multiplyScalar(Rt.dot(kt))).normalize(),wt.crossVectors(It,kt);const Ot=wt.dot(lt[$t])<0?-1:1;ot.setXYZW($t,Tt.x,Tt.y,Tt.z,Ot)}for(let $t=0,kt=bt.length;$t<kt;++$t){const Dt=bt[$t],Ot=Dt.start,zt=Dt.count;for(let Ht=Ot,Yt=Ot+zt;Ht<Yt;Ht+=3)Lt(_e.getX(Ht+0)),Lt(_e.getX(Ht+1)),Lt(_e.getX(Ht+2))}}computeVertexNormals(){const _e=this.index,et=this.getAttribute("position");if(et!==void 0){let rt=this.getAttribute("normal");if(rt===void 0)rt=new BufferAttribute(new Float32Array(et.count*3),3),this.setAttribute("normal",rt);else for(let dt=0,ft=rt.count;dt<ft;dt++)rt.setXYZ(dt,0,0,0);const it=new Vector3,st=new Vector3,ot=new Vector3,at=new Vector3,lt=new Vector3,ct=new Vector3,ut=new Vector3,ht=new Vector3;if(_e)for(let dt=0,ft=_e.count;dt<ft;dt+=3){const pt=_e.getX(dt+0),mt=_e.getX(dt+1),At=_e.getX(dt+2);it.fromBufferAttribute(et,pt),st.fromBufferAttribute(et,mt),ot.fromBufferAttribute(et,At),ut.subVectors(ot,st),ht.subVectors(it,st),ut.cross(ht),at.fromBufferAttribute(rt,pt),lt.fromBufferAttribute(rt,mt),ct.fromBufferAttribute(rt,At),at.add(ut),lt.add(ut),ct.add(ut),rt.setXYZ(pt,at.x,at.y,at.z),rt.setXYZ(mt,lt.x,lt.y,lt.z),rt.setXYZ(At,ct.x,ct.y,ct.z)}else for(let dt=0,ft=et.count;dt<ft;dt+=3)it.fromBufferAttribute(et,dt+0),st.fromBufferAttribute(et,dt+1),ot.fromBufferAttribute(et,dt+2),ut.subVectors(ot,st),ht.subVectors(it,st),ut.cross(ht),rt.setXYZ(dt+0,ut.x,ut.y,ut.z),rt.setXYZ(dt+1,ut.x,ut.y,ut.z),rt.setXYZ(dt+2,ut.x,ut.y,ut.z);this.normalizeNormals(),rt.needsUpdate=!0}}normalizeNormals(){const _e=this.attributes.normal;for(let et=0,rt=_e.count;et<rt;et++)_vector$8.fromBufferAttribute(_e,et),_vector$8.normalize(),_e.setXYZ(et,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _e(at,lt){const ct=at.array,ut=at.itemSize,ht=at.normalized,dt=new ct.constructor(lt.length*ut);let ft=0,pt=0;for(let mt=0,At=lt.length;mt<At;mt++){at.isInterleavedBufferAttribute?ft=lt[mt]*at.data.stride+at.offset:ft=lt[mt]*ut;for(let gt=0;gt<ut;gt++)dt[pt++]=ct[ft++]}return new BufferAttribute(dt,ut,ht)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const et=new BufferGeometry,rt=this.index.array,it=this.attributes;for(const at in it){const lt=it[at],ct=_e(lt,rt);et.setAttribute(at,ct)}const st=this.morphAttributes;for(const at in st){const lt=[],ct=st[at];for(let ut=0,ht=ct.length;ut<ht;ut++){const dt=ct[ut],ft=_e(dt,rt);lt.push(ft)}et.morphAttributes[at]=lt}et.morphTargetsRelative=this.morphTargetsRelative;const ot=this.groups;for(let at=0,lt=ot.length;at<lt;at++){const ct=ot[at];et.addGroup(ct.start,ct.count,ct.materialIndex)}return et}toJSON(){const _e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_e.uuid=this.uuid,_e.type=this.type,this.name!==""&&(_e.name=this.name),Object.keys(this.userData).length>0&&(_e.userData=this.userData),this.parameters!==void 0){const lt=this.parameters;for(const ct in lt)lt[ct]!==void 0&&(_e[ct]=lt[ct]);return _e}_e.data={attributes:{}};const et=this.index;et!==null&&(_e.data.index={type:et.array.constructor.name,array:Array.prototype.slice.call(et.array)});const rt=this.attributes;for(const lt in rt){const ct=rt[lt];_e.data.attributes[lt]=ct.toJSON(_e.data)}const it={};let st=!1;for(const lt in this.morphAttributes){const ct=this.morphAttributes[lt],ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const ft=ct[ht];ut.push(ft.toJSON(_e.data))}ut.length>0&&(it[lt]=ut,st=!0)}st&&(_e.data.morphAttributes=it,_e.data.morphTargetsRelative=this.morphTargetsRelative);const ot=this.groups;ot.length>0&&(_e.data.groups=JSON.parse(JSON.stringify(ot)));const at=this.boundingSphere;return at!==null&&(_e.data.boundingSphere={center:at.center.toArray(),radius:at.radius}),_e}clone(){return new this.constructor().copy(this)}copy(_e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const et={};this.name=_e.name;const rt=_e.index;rt!==null&&this.setIndex(rt.clone(et));const it=_e.attributes;for(const ct in it){const ut=it[ct];this.setAttribute(ct,ut.clone(et))}const st=_e.morphAttributes;for(const ct in st){const ut=[],ht=st[ct];for(let dt=0,ft=ht.length;dt<ft;dt++)ut.push(ht[dt].clone(et));this.morphAttributes[ct]=ut}this.morphTargetsRelative=_e.morphTargetsRelative;const ot=_e.groups;for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];this.addGroup(ht.start,ht.count,ht.materialIndex)}const at=_e.boundingBox;at!==null&&(this.boundingBox=at.clone());const lt=_e.boundingSphere;return lt!==null&&(this.boundingSphere=lt.clone()),this.drawRange.start=_e.drawRange.start,this.drawRange.count=_e.drawRange.count,this.userData=_e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_e=new BufferGeometry,et=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_e,this.material=et,this.updateMorphTargets()}copy(_e,et){return super.copy(_e,et),_e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_e.morphTargetInfluences.slice()),_e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_e.morphTargetDictionary)),this.material=Array.isArray(_e.material)?_e.material.slice():_e.material,this.geometry=_e.geometry,this}updateMorphTargets(){const et=this.geometry.morphAttributes,rt=Object.keys(et);if(rt.length>0){const it=et[rt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const at=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[at]=st}}}}getVertexPosition(_e,et){const rt=this.geometry,it=rt.attributes.position,st=rt.morphAttributes.position,ot=rt.morphTargetsRelative;et.fromBufferAttribute(it,_e);const at=this.morphTargetInfluences;if(st&&at){_morphA.set(0,0,0);for(let lt=0,ct=st.length;lt<ct;lt++){const ut=at[lt],ht=st[lt];ut!==0&&(_tempA.fromBufferAttribute(ht,_e),ot?_morphA.addScaledVector(_tempA,ut):_morphA.addScaledVector(_tempA.sub(et),ut))}et.add(_morphA)}return et}raycast(_e,et){const rt=this.geometry,it=this.material,st=this.matrixWorld;it!==void 0&&(rt.boundingSphere===null&&rt.computeBoundingSphere(),_sphere$6.copy(rt.boundingSphere),_sphere$6.applyMatrix4(st),_ray$3.copy(_e.ray).recast(_e.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_e.far-_e.near)**2))&&(_inverseMatrix$3.copy(st).invert(),_ray$3.copy(_e.ray).applyMatrix4(_inverseMatrix$3),!(rt.boundingBox!==null&&_ray$3.intersectsBox(rt.boundingBox)===!1)&&this._computeIntersections(_e,et,_ray$3)))}_computeIntersections(_e,et,rt){let it;const st=this.geometry,ot=this.material,at=st.index,lt=st.attributes.position,ct=st.attributes.uv,ut=st.attributes.uv1,ht=st.attributes.normal,dt=st.groups,ft=st.drawRange;if(at!==null)if(Array.isArray(ot))for(let pt=0,mt=dt.length;pt<mt;pt++){const At=dt[pt],gt=ot[At.materialIndex],bt=Math.max(At.start,ft.start),Tt=Math.min(at.count,Math.min(At.start+At.count,ft.start+ft.count));for(let wt=bt,Rt=Tt;wt<Rt;wt+=3){const It=at.getX(wt),Lt=at.getX(wt+1),$t=at.getX(wt+2);it=checkGeometryIntersection(this,gt,_e,rt,ct,ut,ht,It,Lt,$t),it&&(it.faceIndex=Math.floor(wt/3),it.face.materialIndex=At.materialIndex,et.push(it))}}else{const pt=Math.max(0,ft.start),mt=Math.min(at.count,ft.start+ft.count);for(let At=pt,gt=mt;At<gt;At+=3){const bt=at.getX(At),Tt=at.getX(At+1),wt=at.getX(At+2);it=checkGeometryIntersection(this,ot,_e,rt,ct,ut,ht,bt,Tt,wt),it&&(it.faceIndex=Math.floor(At/3),et.push(it))}}else if(lt!==void 0)if(Array.isArray(ot))for(let pt=0,mt=dt.length;pt<mt;pt++){const At=dt[pt],gt=ot[At.materialIndex],bt=Math.max(At.start,ft.start),Tt=Math.min(lt.count,Math.min(At.start+At.count,ft.start+ft.count));for(let wt=bt,Rt=Tt;wt<Rt;wt+=3){const It=wt,Lt=wt+1,$t=wt+2;it=checkGeometryIntersection(this,gt,_e,rt,ct,ut,ht,It,Lt,$t),it&&(it.faceIndex=Math.floor(wt/3),it.face.materialIndex=At.materialIndex,et.push(it))}}else{const pt=Math.max(0,ft.start),mt=Math.min(lt.count,ft.start+ft.count);for(let At=pt,gt=mt;At<gt;At+=3){const bt=At,Tt=At+1,wt=At+2;it=checkGeometryIntersection(this,ot,_e,rt,ct,ut,ht,bt,Tt,wt),it&&(it.faceIndex=Math.floor(At/3),et.push(it))}}}}function checkIntersection$1(nt,_e,et,rt,it,st,ot,at){let lt;if(_e.side===BackSide?lt=rt.intersectTriangle(ot,st,it,!0,at):lt=rt.intersectTriangle(it,st,ot,_e.side===FrontSide,at),lt===null)return null;_intersectionPointWorld.copy(at),_intersectionPointWorld.applyMatrix4(nt.matrixWorld);const ct=et.ray.origin.distanceTo(_intersectionPointWorld);return ct<et.near||ct>et.far?null:{distance:ct,point:_intersectionPointWorld.clone(),object:nt}}function checkGeometryIntersection(nt,_e,et,rt,it,st,ot,at,lt,ct){nt.getVertexPosition(at,_vA$1),nt.getVertexPosition(lt,_vB$1),nt.getVertexPosition(ct,_vC$1);const ut=checkIntersection$1(nt,_e,et,rt,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(ut){const ht=new Vector3;Triangle.getBarycoord(_intersectionPoint,_vA$1,_vB$1,_vC$1,ht),it&&(ut.uv=Triangle.getInterpolatedAttribute(it,at,lt,ct,ht,new Vector2)),st&&(ut.uv1=Triangle.getInterpolatedAttribute(st,at,lt,ct,ht,new Vector2)),ot&&(ut.normal=Triangle.getInterpolatedAttribute(ot,at,lt,ct,ht,new Vector3),ut.normal.dot(rt.direction)>0&&ut.normal.multiplyScalar(-1));const dt={a:at,b:lt,c:ct,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,dt.normal),ut.face=dt,ut.barycoord=ht}return ut}class BoxGeometry extends BufferGeometry{constructor(_e=1,et=1,rt=1,it=1,st=1,ot=1){super(),this.type="BoxGeometry",this.parameters={width:_e,height:et,depth:rt,widthSegments:it,heightSegments:st,depthSegments:ot};const at=this;it=Math.floor(it),st=Math.floor(st),ot=Math.floor(ot);const lt=[],ct=[],ut=[],ht=[];let dt=0,ft=0;pt("z","y","x",-1,-1,rt,et,_e,ot,st,0),pt("z","y","x",1,-1,rt,et,-_e,ot,st,1),pt("x","z","y",1,1,_e,rt,et,it,ot,2),pt("x","z","y",1,-1,_e,rt,-et,it,ot,3),pt("x","y","z",1,-1,_e,et,rt,it,st,4),pt("x","y","z",-1,-1,_e,et,-rt,it,st,5),this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute(ct,3)),this.setAttribute("normal",new Float32BufferAttribute(ut,3)),this.setAttribute("uv",new Float32BufferAttribute(ht,2));function pt(mt,At,gt,bt,Tt,wt,Rt,It,Lt,$t,kt){const Dt=wt/Lt,Ot=Rt/$t,zt=wt/2,Ht=Rt/2,Yt=It/2,Xt=Lt+1,Zt=$t+1;let rn=0,Gt=0;const jt=new Vector3;for(let Kt=0;Kt<Zt;Kt++){const Jt=Kt*Ot-Ht;for(let sn=0;sn<Xt;sn++){const hn=sn*Dt-zt;jt[mt]=hn*bt,jt[At]=Jt*Tt,jt[gt]=Yt,ct.push(jt.x,jt.y,jt.z),jt[mt]=0,jt[At]=0,jt[gt]=It>0?1:-1,ut.push(jt.x,jt.y,jt.z),ht.push(sn/Lt),ht.push(1-Kt/$t),rn+=1}}for(let Kt=0;Kt<$t;Kt++)for(let Jt=0;Jt<Lt;Jt++){const sn=dt+Jt+Xt*Kt,hn=dt+Jt+Xt*(Kt+1),an=dt+(Jt+1)+Xt*(Kt+1),pn=dt+(Jt+1)+Xt*Kt;lt.push(sn,hn,pn),lt.push(hn,an,pn),Gt+=6}at.addGroup(ft,Gt,kt),ft+=Gt,dt+=rn}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new BoxGeometry(_e.width,_e.height,_e.depth,_e.widthSegments,_e.heightSegments,_e.depthSegments)}}function cloneUniforms(nt){const _e={};for(const et in nt){_e[et]={};for(const rt in nt[et]){const it=nt[et][rt];it&&(it.isColor||it.isMatrix3||it.isMatrix4||it.isVector2||it.isVector3||it.isVector4||it.isTexture||it.isQuaternion)?it.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_e[et][rt]=null):_e[et][rt]=it.clone():Array.isArray(it)?_e[et][rt]=it.slice():_e[et][rt]=it}}return _e}function cloneUniformsGroups(nt){const _e=[];for(let et=0;et<nt.length;et++)_e.push(nt[et].clone());return _e}var default_vertex=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,default_fragment=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class ShaderMaterial extends Material{constructor(_e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_e!==void 0&&this.setValues(_e)}copy(_e){return super.copy(_e),this.fragmentShader=_e.fragmentShader,this.vertexShader=_e.vertexShader,this.uniforms=cloneUniforms(_e.uniforms),this.uniformsGroups=cloneUniformsGroups(_e.uniformsGroups),this.defines=Object.assign({},_e.defines),this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.fog=_e.fog,this.lights=_e.lights,this.clipping=_e.clipping,this.extensions=Object.assign({},_e.extensions),this.glslVersion=_e.glslVersion,this}toJSON(_e){const et=super.toJSON(_e);et.glslVersion=this.glslVersion,et.uniforms={};for(const it in this.uniforms){const ot=this.uniforms[it].value;ot&&ot.isTexture?et.uniforms[it]={type:"t",value:ot.toJSON(_e).uuid}:ot&&ot.isColor?et.uniforms[it]={type:"c",value:ot.getHex()}:ot&&ot.isVector2?et.uniforms[it]={type:"v2",value:ot.toArray()}:ot&&ot.isVector3?et.uniforms[it]={type:"v3",value:ot.toArray()}:ot&&ot.isVector4?et.uniforms[it]={type:"v4",value:ot.toArray()}:ot&&ot.isMatrix3?et.uniforms[it]={type:"m3",value:ot.toArray()}:ot&&ot.isMatrix4?et.uniforms[it]={type:"m4",value:ot.toArray()}:et.uniforms[it]={value:ot}}Object.keys(this.defines).length>0&&(et.defines=this.defines),et.vertexShader=this.vertexShader,et.fragmentShader=this.fragmentShader,et.lights=this.lights,et.clipping=this.clipping;const rt={};for(const it in this.extensions)this.extensions[it]===!0&&(rt[it]=!0);return Object.keys(rt).length>0&&(et.extensions=rt),et}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_e,et){return super.copy(_e,et),this.matrixWorldInverse.copy(_e.matrixWorldInverse),this.projectionMatrix.copy(_e.projectionMatrix),this.projectionMatrixInverse.copy(_e.projectionMatrixInverse),this.coordinateSystem=_e.coordinateSystem,this}getWorldDirection(_e){return super.getWorldDirection(_e).negate()}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_e,et){super.updateWorldMatrix(_e,et),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;class PerspectiveCamera extends Camera{constructor(_e=50,et=1,rt=.1,it=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_e,this.zoom=1,this.near=rt,this.far=it,this.focus=10,this.aspect=et,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_e,et){return super.copy(_e,et),this.fov=_e.fov,this.zoom=_e.zoom,this.near=_e.near,this.far=_e.far,this.focus=_e.focus,this.aspect=_e.aspect,this.view=_e.view===null?null:Object.assign({},_e.view),this.filmGauge=_e.filmGauge,this.filmOffset=_e.filmOffset,this}setFocalLength(_e){const et=.5*this.getFilmHeight()/_e;this.fov=RAD2DEG*2*Math.atan(et),this.updateProjectionMatrix()}getFocalLength(){const _e=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_e}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_e,et,rt){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),et.set(_v3$1.x,_v3$1.y).multiplyScalar(-_e/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),rt.set(_v3$1.x,_v3$1.y).multiplyScalar(-_e/_v3$1.z)}getViewSize(_e,et){return this.getViewBounds(_e,_minTarget,_maxTarget),et.subVectors(_maxTarget,_minTarget)}setViewOffset(_e,et,rt,it,st,ot){this.aspect=_e/et,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=et,this.view.offsetX=rt,this.view.offsetY=it,this.view.width=st,this.view.height=ot,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=this.near;let et=_e*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,rt=2*et,it=this.aspect*rt,st=-.5*it;const ot=this.view;if(this.view!==null&&this.view.enabled){const lt=ot.fullWidth,ct=ot.fullHeight;st+=ot.offsetX*it/lt,et-=ot.offsetY*rt/ct,it*=ot.width/lt,rt*=ot.height/ct}const at=this.filmOffset;at!==0&&(st+=_e*at/this.getFilmWidth()),this.projectionMatrix.makePerspective(st,st+it,et,et-rt,_e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const et=super.toJSON(_e);return et.object.fov=this.fov,et.object.zoom=this.zoom,et.object.near=this.near,et.object.far=this.far,et.object.focus=this.focus,et.object.aspect=this.aspect,this.view!==null&&(et.object.view=Object.assign({},this.view)),et.object.filmGauge=this.filmGauge,et.object.filmOffset=this.filmOffset,et}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_e,et,rt){super(),this.type="CubeCamera",this.renderTarget=rt,this.coordinateSystem=null,this.activeMipmapLevel=0;const it=new PerspectiveCamera(fov,aspect,_e,et);it.layers=this.layers,this.add(it);const st=new PerspectiveCamera(fov,aspect,_e,et);st.layers=this.layers,this.add(st);const ot=new PerspectiveCamera(fov,aspect,_e,et);ot.layers=this.layers,this.add(ot);const at=new PerspectiveCamera(fov,aspect,_e,et);at.layers=this.layers,this.add(at);const lt=new PerspectiveCamera(fov,aspect,_e,et);lt.layers=this.layers,this.add(lt);const ct=new PerspectiveCamera(fov,aspect,_e,et);ct.layers=this.layers,this.add(ct)}updateCoordinateSystem(){const _e=this.coordinateSystem,et=this.children.concat(),[rt,it,st,ot,at,lt]=et;for(const ct of et)this.remove(ct);if(_e===WebGLCoordinateSystem)rt.up.set(0,1,0),rt.lookAt(1,0,0),it.up.set(0,1,0),it.lookAt(-1,0,0),st.up.set(0,0,-1),st.lookAt(0,1,0),ot.up.set(0,0,1),ot.lookAt(0,-1,0),at.up.set(0,1,0),at.lookAt(0,0,1),lt.up.set(0,1,0),lt.lookAt(0,0,-1);else if(_e===WebGPUCoordinateSystem)rt.up.set(0,-1,0),rt.lookAt(-1,0,0),it.up.set(0,-1,0),it.lookAt(1,0,0),st.up.set(0,0,1),st.lookAt(0,1,0),ot.up.set(0,0,-1),ot.lookAt(0,-1,0),at.up.set(0,-1,0),at.lookAt(0,0,1),lt.up.set(0,-1,0),lt.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_e);for(const ct of et)this.add(ct),ct.updateMatrixWorld()}update(_e,et){this.parent===null&&this.updateMatrixWorld();const{renderTarget:rt,activeMipmapLevel:it}=this;this.coordinateSystem!==_e.coordinateSystem&&(this.coordinateSystem=_e.coordinateSystem,this.updateCoordinateSystem());const[st,ot,at,lt,ct,ut]=this.children,ht=_e.getRenderTarget(),dt=_e.getActiveCubeFace(),ft=_e.getActiveMipmapLevel(),pt=_e.xr.enabled;_e.xr.enabled=!1;const mt=rt.texture.generateMipmaps;rt.texture.generateMipmaps=!1,_e.setRenderTarget(rt,0,it),_e.render(et,st),_e.setRenderTarget(rt,1,it),_e.render(et,ot),_e.setRenderTarget(rt,2,it),_e.render(et,at),_e.setRenderTarget(rt,3,it),_e.render(et,lt),_e.setRenderTarget(rt,4,it),_e.render(et,ct),rt.texture.generateMipmaps=mt,_e.setRenderTarget(rt,5,it),_e.render(et,ut),_e.setRenderTarget(ht,dt,ft),_e.xr.enabled=pt,rt.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut){_e=_e!==void 0?_e:[],et=et!==void 0?et:CubeReflectionMapping,super(_e,et,rt,it,st,ot,at,lt,ct,ut),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_e){this.image=_e}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_e=1,et={}){super(_e,_e,et),this.isWebGLCubeRenderTarget=!0;const rt={width:_e,height:_e,depth:1},it=[rt,rt,rt,rt,rt,rt];this.texture=new CubeTexture(it,et.mapping,et.wrapS,et.wrapT,et.magFilter,et.minFilter,et.format,et.type,et.anisotropy,et.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=et.generateMipmaps!==void 0?et.generateMipmaps:!1,this.texture.minFilter=et.minFilter!==void 0?et.minFilter:LinearFilter}fromEquirectangularTexture(_e,et){this.texture.type=et.type,this.texture.colorSpace=et.colorSpace,this.texture.generateMipmaps=et.generateMipmaps,this.texture.minFilter=et.minFilter,this.texture.magFilter=et.magFilter;const rt={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},it=new BoxGeometry(5,5,5),st=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(rt.uniforms),vertexShader:rt.vertexShader,fragmentShader:rt.fragmentShader,side:BackSide,blending:NoBlending});st.uniforms.tEquirect.value=et;const ot=new Mesh(it,st),at=et.minFilter;return et.minFilter===LinearMipmapLinearFilter&&(et.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_e,ot),et.minFilter=at,ot.geometry.dispose(),ot.material.dispose(),this}clear(_e,et,rt,it){const st=_e.getRenderTarget();for(let ot=0;ot<6;ot++)_e.setRenderTarget(this,ot),_e.clear(et,rt,it);_e.setRenderTarget(st)}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler,this.environmentIntensity=1,this.environmentRotation=new Euler,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_e,et){return super.copy(_e,et),_e.background!==null&&(this.background=_e.background.clone()),_e.environment!==null&&(this.environment=_e.environment.clone()),_e.fog!==null&&(this.fog=_e.fog.clone()),this.backgroundBlurriness=_e.backgroundBlurriness,this.backgroundIntensity=_e.backgroundIntensity,this.backgroundRotation.copy(_e.backgroundRotation),this.environmentIntensity=_e.environmentIntensity,this.environmentRotation.copy(_e.environmentRotation),_e.overrideMaterial!==null&&(this.overrideMaterial=_e.overrideMaterial.clone()),this.matrixAutoUpdate=_e.matrixAutoUpdate,this}toJSON(_e){const et=super.toJSON(_e);return this.fog!==null&&(et.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(et.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(et.object.backgroundIntensity=this.backgroundIntensity),et.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(et.object.environmentIntensity=this.environmentIntensity),et.object.environmentRotation=this.environmentRotation.toArray(),et}}class InterleavedBuffer{constructor(_e,et){this.isInterleavedBuffer=!0,this.array=_e,this.stride=et,this.count=_e!==void 0?_e.length/et:0,this.usage=StaticDrawUsage,this.updateRanges=[],this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}addUpdateRange(_e,et){this.updateRanges.push({start:_e,count:et})}clearUpdateRanges(){this.updateRanges.length=0}copy(_e){return this.array=new _e.array.constructor(_e.array),this.count=_e.count,this.stride=_e.stride,this.usage=_e.usage,this}copyAt(_e,et,rt){_e*=this.stride,rt*=et.stride;for(let it=0,st=this.stride;it<st;it++)this.array[_e+it]=et.array[rt+it];return this}set(_e,et=0){return this.array.set(_e,et),this}clone(_e){_e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const et=new this.array.constructor(_e.arrayBuffers[this.array.buffer._uuid]),rt=new this.constructor(et,this.stride);return rt.setUsage(this.usage),rt}onUpload(_e){return this.onUploadCallback=_e,this}toJSON(_e){return _e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$7=new Vector3;class InterleavedBufferAttribute{constructor(_e,et,rt,it=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_e,this.itemSize=et,this.offset=rt,this.normalized=it}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_e){this.data.needsUpdate=_e}applyMatrix4(_e){for(let et=0,rt=this.data.count;et<rt;et++)_vector$7.fromBufferAttribute(this,et),_vector$7.applyMatrix4(_e),this.setXYZ(et,_vector$7.x,_vector$7.y,_vector$7.z);return this}applyNormalMatrix(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$7.fromBufferAttribute(this,et),_vector$7.applyNormalMatrix(_e),this.setXYZ(et,_vector$7.x,_vector$7.y,_vector$7.z);return this}transformDirection(_e){for(let et=0,rt=this.count;et<rt;et++)_vector$7.fromBufferAttribute(this,et),_vector$7.transformDirection(_e),this.setXYZ(et,_vector$7.x,_vector$7.y,_vector$7.z);return this}getComponent(_e,et){let rt=this.array[_e*this.data.stride+this.offset+et];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setComponent(_e,et,rt){return this.normalized&&(rt=normalize$1(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+et]=rt,this}setX(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.data.array[_e*this.data.stride+this.offset]=et,this}setY(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.data.array[_e*this.data.stride+this.offset+1]=et,this}setZ(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.data.array[_e*this.data.stride+this.offset+2]=et,this}setW(_e,et){return this.normalized&&(et=normalize$1(et,this.array)),this.data.array[_e*this.data.stride+this.offset+3]=et,this}getX(_e){let et=this.data.array[_e*this.data.stride+this.offset];return this.normalized&&(et=denormalize(et,this.array)),et}getY(_e){let et=this.data.array[_e*this.data.stride+this.offset+1];return this.normalized&&(et=denormalize(et,this.array)),et}getZ(_e){let et=this.data.array[_e*this.data.stride+this.offset+2];return this.normalized&&(et=denormalize(et,this.array)),et}getW(_e){let et=this.data.array[_e*this.data.stride+this.offset+3];return this.normalized&&(et=denormalize(et,this.array)),et}setXY(_e,et,rt){return _e=_e*this.data.stride+this.offset,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array)),this.data.array[_e+0]=et,this.data.array[_e+1]=rt,this}setXYZ(_e,et,rt,it){return _e=_e*this.data.stride+this.offset,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array),it=normalize$1(it,this.array)),this.data.array[_e+0]=et,this.data.array[_e+1]=rt,this.data.array[_e+2]=it,this}setXYZW(_e,et,rt,it,st){return _e=_e*this.data.stride+this.offset,this.normalized&&(et=normalize$1(et,this.array),rt=normalize$1(rt,this.array),it=normalize$1(it,this.array),st=normalize$1(st,this.array)),this.data.array[_e+0]=et,this.data.array[_e+1]=rt,this.data.array[_e+2]=it,this.data.array[_e+3]=st,this}clone(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const et=[];for(let rt=0;rt<this.count;rt++){const it=rt*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)et.push(this.data.array[it+st])}return new BufferAttribute(new this.array.constructor(et),this.itemSize,this.normalized)}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.clone(_e)),new InterleavedBufferAttribute(_e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const et=[];for(let rt=0;rt<this.count;rt++){const it=rt*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)et.push(this.data.array[it+st])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:et,normalized:this.normalized}}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.toJSON(_e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.rotation=_e.rotation,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}}class DataTexture extends Texture{constructor(_e=null,et=1,rt=1,it,st,ot,at,lt,ct=NearestFilter,ut=NearestFilter,ht,dt){super(null,ot,at,lt,ct,ut,it,st,ht,dt),this.isDataTexture=!0,this.image={data:_e,width:et,height:rt},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class InstancedBufferAttribute extends BufferAttribute{constructor(_e,et,rt,it=1){super(_e,et,rt),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=it}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}toJSON(){const _e=super.toJSON();return _e.meshPerAttribute=this.meshPerAttribute,_e.isInstancedBufferAttribute=!0,_e}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_e=new Vector3(1,0,0),et=0){this.isPlane=!0,this.normal=_e,this.constant=et}set(_e,et){return this.normal.copy(_e),this.constant=et,this}setComponents(_e,et,rt,it){return this.normal.set(_e,et,rt),this.constant=it,this}setFromNormalAndCoplanarPoint(_e,et){return this.normal.copy(_e),this.constant=-et.dot(this.normal),this}setFromCoplanarPoints(_e,et,rt){const it=_vector1.subVectors(rt,et).cross(_vector2.subVectors(_e,et)).normalize();return this.setFromNormalAndCoplanarPoint(it,_e),this}copy(_e){return this.normal.copy(_e.normal),this.constant=_e.constant,this}normalize(){const _e=1/this.normal.length();return this.normal.multiplyScalar(_e),this.constant*=_e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_e){return this.normal.dot(_e)+this.constant}distanceToSphere(_e){return this.distanceToPoint(_e.center)-_e.radius}projectPoint(_e,et){return et.copy(_e).addScaledVector(this.normal,-this.distanceToPoint(_e))}intersectLine(_e,et){const rt=_e.delta(_vector1),it=this.normal.dot(rt);if(it===0)return this.distanceToPoint(_e.start)===0?et.copy(_e.start):null;const st=-(_e.start.dot(this.normal)+this.constant)/it;return st<0||st>1?null:et.copy(_e.start).addScaledVector(rt,st)}intersectsLine(_e){const et=this.distanceToPoint(_e.start),rt=this.distanceToPoint(_e.end);return et<0&&rt>0||rt<0&&et>0}intersectsBox(_e){return _e.intersectsPlane(this)}intersectsSphere(_e){return _e.intersectsPlane(this)}coplanarPoint(_e){return _e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_e,et){const rt=et||_normalMatrix.getNormalMatrix(_e),it=this.coplanarPoint(_vector1).applyMatrix4(_e),st=this.normal.applyMatrix3(rt).normalize();return this.constant=-it.dot(st),this}translate(_e){return this.constant-=_e.dot(this.normal),this}equals(_e){return _e.normal.equals(this.normal)&&_e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$3=new Sphere,_vector$6=new Vector3;class Frustum{constructor(_e=new Plane,et=new Plane,rt=new Plane,it=new Plane,st=new Plane,ot=new Plane){this.planes=[_e,et,rt,it,st,ot]}set(_e,et,rt,it,st,ot){const at=this.planes;return at[0].copy(_e),at[1].copy(et),at[2].copy(rt),at[3].copy(it),at[4].copy(st),at[5].copy(ot),this}copy(_e){const et=this.planes;for(let rt=0;rt<6;rt++)et[rt].copy(_e.planes[rt]);return this}setFromProjectionMatrix(_e,et=WebGLCoordinateSystem){const rt=this.planes,it=_e.elements,st=it[0],ot=it[1],at=it[2],lt=it[3],ct=it[4],ut=it[5],ht=it[6],dt=it[7],ft=it[8],pt=it[9],mt=it[10],At=it[11],gt=it[12],bt=it[13],Tt=it[14],wt=it[15];if(rt[0].setComponents(lt-st,dt-ct,At-ft,wt-gt).normalize(),rt[1].setComponents(lt+st,dt+ct,At+ft,wt+gt).normalize(),rt[2].setComponents(lt+ot,dt+ut,At+pt,wt+bt).normalize(),rt[3].setComponents(lt-ot,dt-ut,At-pt,wt-bt).normalize(),rt[4].setComponents(lt-at,dt-ht,At-mt,wt-Tt).normalize(),et===WebGLCoordinateSystem)rt[5].setComponents(lt+at,dt+ht,At+mt,wt+Tt).normalize();else if(et===WebGPUCoordinateSystem)rt[5].setComponents(at,ht,mt,Tt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+et);return this}intersectsObject(_e){if(_e.boundingSphere!==void 0)_e.boundingSphere===null&&_e.computeBoundingSphere(),_sphere$3.copy(_e.boundingSphere).applyMatrix4(_e.matrixWorld);else{const et=_e.geometry;et.boundingSphere===null&&et.computeBoundingSphere(),_sphere$3.copy(et.boundingSphere).applyMatrix4(_e.matrixWorld)}return this.intersectsSphere(_sphere$3)}intersectsSprite(_e){return _sphere$3.center.set(0,0,0),_sphere$3.radius=.7071067811865476,_sphere$3.applyMatrix4(_e.matrixWorld),this.intersectsSphere(_sphere$3)}intersectsSphere(_e){const et=this.planes,rt=_e.center,it=-_e.radius;for(let st=0;st<6;st++)if(et[st].distanceToPoint(rt)<it)return!1;return!0}intersectsBox(_e){const et=this.planes;for(let rt=0;rt<6;rt++){const it=et[rt];if(_vector$6.x=it.normal.x>0?_e.max.x:_e.min.x,_vector$6.y=it.normal.y>0?_e.max.y:_e.min.y,_vector$6.z=it.normal.z>0?_e.max.z:_e.min.z,it.distanceToPoint(_vector$6)<0)return!1}return!0}containsPoint(_e){const et=this.planes;for(let rt=0;rt<6;rt++)if(et[rt].distanceToPoint(_e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class LineBasicMaterial extends Material{constructor(_e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.linewidth=_e.linewidth,this.linecap=_e.linecap,this.linejoin=_e.linejoin,this.fog=_e.fog,this}}class PointsMaterial extends Material{constructor(_e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.size=_e.size,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}}class FramebufferTexture extends Texture{constructor(_e,et){super({width:_e,height:et}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class DepthTexture extends Texture{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut=DepthFormat){if(ut!==DepthFormat&&ut!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");rt===void 0&&ut===DepthFormat&&(rt=UnsignedIntType),rt===void 0&&ut===DepthStencilFormat&&(rt=UnsignedInt248Type),super(null,it,st,ot,at,lt,ut,rt,ct),this.isDepthTexture=!0,this.image={width:_e,height:et},this.magFilter=at!==void 0?at:NearestFilter,this.minFilter=lt!==void 0?lt:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_e){return super.copy(_e),this.compareFunction=_e.compareFunction,this}toJSON(_e){const et=super.toJSON(_e);return this.compareFunction!==null&&(et.compareFunction=this.compareFunction),et}}class SphereGeometry extends BufferGeometry{constructor(_e=1,et=32,rt=16,it=0,st=Math.PI*2,ot=0,at=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_e,widthSegments:et,heightSegments:rt,phiStart:it,phiLength:st,thetaStart:ot,thetaLength:at},et=Math.max(3,Math.floor(et)),rt=Math.max(2,Math.floor(rt));const lt=Math.min(ot+at,Math.PI);let ct=0;const ut=[],ht=new Vector3,dt=new Vector3,ft=[],pt=[],mt=[],At=[];for(let gt=0;gt<=rt;gt++){const bt=[],Tt=gt/rt;let wt=0;gt===0&&ot===0?wt=.5/et:gt===rt&&lt===Math.PI&&(wt=-.5/et);for(let Rt=0;Rt<=et;Rt++){const It=Rt/et;ht.x=-_e*Math.cos(it+It*st)*Math.sin(ot+Tt*at),ht.y=_e*Math.cos(ot+Tt*at),ht.z=_e*Math.sin(it+It*st)*Math.sin(ot+Tt*at),pt.push(ht.x,ht.y,ht.z),dt.copy(ht).normalize(),mt.push(dt.x,dt.y,dt.z),At.push(It+wt,1-Tt),bt.push(ct++)}ut.push(bt)}for(let gt=0;gt<rt;gt++)for(let bt=0;bt<et;bt++){const Tt=ut[gt][bt+1],wt=ut[gt][bt],Rt=ut[gt+1][bt],It=ut[gt+1][bt+1];(gt!==0||ot>0)&&ft.push(Tt,wt,It),(gt!==rt-1||lt<Math.PI)&&ft.push(wt,Rt,It)}this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute(pt,3)),this.setAttribute("normal",new Float32BufferAttribute(mt,3)),this.setAttribute("uv",new Float32BufferAttribute(At,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new SphereGeometry(_e.radius,_e.widthSegments,_e.heightSegments,_e.phiStart,_e.phiLength,_e.thetaStart,_e.thetaLength)}}class ShadowMaterial extends Material{constructor(_e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.fog=_e.fog,this}}class MeshStandardMaterial extends Material{constructor(_e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={STANDARD:""},this.color.copy(_e.color),this.roughness=_e.roughness,this.metalness=_e.metalness,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.roughnessMap=_e.roughnessMap,this.metalnessMap=_e.metalnessMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.envMapIntensity=_e.envMapIntensity,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$1(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(et){this.ior=(1+.4*et)/(1-.4*et)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_e)}get anisotropy(){return this._anisotropy}set anisotropy(_e){this._anisotropy>0!=_e>0&&this.version++,this._anisotropy=_e}get clearcoat(){return this._clearcoat}set clearcoat(_e){this._clearcoat>0!=_e>0&&this.version++,this._clearcoat=_e}get iridescence(){return this._iridescence}set iridescence(_e){this._iridescence>0!=_e>0&&this.version++,this._iridescence=_e}get dispersion(){return this._dispersion}set dispersion(_e){this._dispersion>0!=_e>0&&this.version++,this._dispersion=_e}get sheen(){return this._sheen}set sheen(_e){this._sheen>0!=_e>0&&this.version++,this._sheen=_e}get transmission(){return this._transmission}set transmission(_e){this._transmission>0!=_e>0&&this.version++,this._transmission=_e}copy(_e){return super.copy(_e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_e.anisotropy,this.anisotropyRotation=_e.anisotropyRotation,this.anisotropyMap=_e.anisotropyMap,this.clearcoat=_e.clearcoat,this.clearcoatMap=_e.clearcoatMap,this.clearcoatRoughness=_e.clearcoatRoughness,this.clearcoatRoughnessMap=_e.clearcoatRoughnessMap,this.clearcoatNormalMap=_e.clearcoatNormalMap,this.clearcoatNormalScale.copy(_e.clearcoatNormalScale),this.dispersion=_e.dispersion,this.ior=_e.ior,this.iridescence=_e.iridescence,this.iridescenceMap=_e.iridescenceMap,this.iridescenceIOR=_e.iridescenceIOR,this.iridescenceThicknessRange=[..._e.iridescenceThicknessRange],this.iridescenceThicknessMap=_e.iridescenceThicknessMap,this.sheen=_e.sheen,this.sheenColor.copy(_e.sheenColor),this.sheenColorMap=_e.sheenColorMap,this.sheenRoughness=_e.sheenRoughness,this.sheenRoughnessMap=_e.sheenRoughnessMap,this.transmission=_e.transmission,this.transmissionMap=_e.transmissionMap,this.thickness=_e.thickness,this.thicknessMap=_e.thicknessMap,this.attenuationDistance=_e.attenuationDistance,this.attenuationColor.copy(_e.attenuationColor),this.specularIntensity=_e.specularIntensity,this.specularIntensityMap=_e.specularIntensityMap,this.specularColor.copy(_e.specularColor),this.specularColorMap=_e.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.specular.copy(_e.specular),this.shininess=_e.shininess,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshToonMaterial extends Material{constructor(_e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.gradientMap=_e.gradientMap,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}}class MeshNormalMaterial extends Material{constructor(_e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_e)}copy(_e){return super.copy(_e),this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.flatShading=_e.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapRotation.copy(_e.envMapRotation),this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshMatcapMaterial extends Material{constructor(_e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={MATCAP:""},this.color.copy(_e.color),this.matcap=_e.matcap,this.map=_e.map,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.scale=_e.scale,this.dashSize=_e.dashSize,this.gapSize=_e.gapSize,this}}class Light extends Object3D{constructor(_e,et=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(_e),this.intensity=et}dispose(){}copy(_e,et){return super.copy(_e,et),this.color.copy(_e.color),this.intensity=_e.intensity,this}toJSON(_e){const et=super.toJSON(_e);return et.object.color=this.color.getHex(),et.object.intensity=this.intensity,this.groundColor!==void 0&&(et.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(et.object.distance=this.distance),this.angle!==void 0&&(et.object.angle=this.angle),this.decay!==void 0&&(et.object.decay=this.decay),this.penumbra!==void 0&&(et.object.penumbra=this.penumbra),this.shadow!==void 0&&(et.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(et.object.target=this.target.uuid),et}}class HemisphereLight extends Light{constructor(_e,et,rt){super(_e,rt),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color(et)}copy(_e,et){return super.copy(_e,et),this.groundColor.copy(_e.groundColor),this}}const _projScreenMatrix$2=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_e){this.camera=_e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_e){const et=this.camera,rt=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_e.matrixWorld),et.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_e.target.matrixWorld),et.lookAt(_lookTarget$1),et.updateMatrixWorld(),_projScreenMatrix$2.multiplyMatrices(et.projectionMatrix,et.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$2),rt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),rt.multiply(_projScreenMatrix$2)}getViewport(_e){return this._viewports[_e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_e){return this.camera=_e.camera.clone(),this.intensity=_e.intensity,this.bias=_e.bias,this.radius=_e.radius,this.mapSize.copy(_e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _e={};return this.intensity!==1&&(_e.intensity=this.intensity),this.bias!==0&&(_e.bias=this.bias),this.normalBias!==0&&(_e.normalBias=this.normalBias),this.radius!==1&&(_e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_e.mapSize=this.mapSize.toArray()),_e.camera=this.camera.toJSON(!1).object,delete _e.camera.matrix,_e}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_e){const et=this.camera,rt=RAD2DEG*2*_e.angle*this.focus,it=this.mapSize.width/this.mapSize.height,st=_e.distance||et.far;(rt!==et.fov||it!==et.aspect||st!==et.far)&&(et.fov=rt,et.aspect=it,et.far=st,et.updateProjectionMatrix()),super.updateMatrices(_e)}copy(_e){return super.copy(_e),this.focus=_e.focus,this}}class SpotLight extends Light{constructor(_e,et,rt=0,it=Math.PI/3,st=0,ot=2){super(_e,et),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=rt,this.angle=it,this.penumbra=st,this.decay=ot,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_e){this.intensity=_e/Math.PI}dispose(){this.shadow.dispose()}copy(_e,et){return super.copy(_e,et),this.distance=_e.distance,this.angle=_e.angle,this.penumbra=_e.penumbra,this.decay=_e.decay,this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_e,et=0){const rt=this.camera,it=this.matrix,st=_e.distance||rt.far;st!==rt.far&&(rt.far=st,rt.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_e.matrixWorld),rt.position.copy(_lightPositionWorld),_lookTarget.copy(rt.position),_lookTarget.add(this._cubeDirections[et]),rt.up.copy(this._cubeUps[et]),rt.lookAt(_lookTarget),rt.updateMatrixWorld(),it.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix$1.multiplyMatrices(rt.projectionMatrix,rt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1)}}class PointLight extends Light{constructor(_e,et,rt=0,it=2){super(_e,et),this.isPointLight=!0,this.type="PointLight",this.distance=rt,this.decay=it,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_e){this.intensity=_e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_e,et){return super.copy(_e,et),this.distance=_e.distance,this.decay=_e.decay,this.shadow=_e.shadow.clone(),this}}class OrthographicCamera extends Camera{constructor(_e=-1,et=1,rt=1,it=-1,st=.1,ot=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_e,this.right=et,this.top=rt,this.bottom=it,this.near=st,this.far=ot,this.updateProjectionMatrix()}copy(_e,et){return super.copy(_e,et),this.left=_e.left,this.right=_e.right,this.top=_e.top,this.bottom=_e.bottom,this.near=_e.near,this.far=_e.far,this.zoom=_e.zoom,this.view=_e.view===null?null:Object.assign({},_e.view),this}setViewOffset(_e,et,rt,it,st,ot){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=et,this.view.offsetX=rt,this.view.offsetY=it,this.view.width=st,this.view.height=ot,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=(this.right-this.left)/(2*this.zoom),et=(this.top-this.bottom)/(2*this.zoom),rt=(this.right+this.left)/2,it=(this.top+this.bottom)/2;let st=rt-_e,ot=rt+_e,at=it+et,lt=it-et;if(this.view!==null&&this.view.enabled){const ct=(this.right-this.left)/this.view.fullWidth/this.zoom,ut=(this.top-this.bottom)/this.view.fullHeight/this.zoom;st+=ct*this.view.offsetX,ot=st+ct*this.view.width,at-=ut*this.view.offsetY,lt=at-ut*this.view.height}this.projectionMatrix.makeOrthographic(st,ot,at,lt,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const et=super.toJSON(_e);return et.object.zoom=this.zoom,et.object.left=this.left,et.object.right=this.right,et.object.top=this.top,et.object.bottom=this.bottom,et.object.near=this.near,et.object.far=this.far,this.view!==null&&(et.object.view=Object.assign({},this.view)),et}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_e,et){super(_e,et),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_e){return super.copy(_e),this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}}class AmbientLight extends Light{constructor(_e,et){super(_e,et),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_e,et,rt=10,it=10){super(_e,et),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=rt,this.height=it}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_e){this.intensity=_e/(this.width*this.height*Math.PI)}copy(_e){return super.copy(_e),this.width=_e.width,this.height=_e.height,this}toJSON(_e){const et=super.toJSON(_e);return et.object.width=this.width,et.object.height=this.height,et}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _e=0;_e<9;_e++)this.coefficients.push(new Vector3)}set(_e){for(let et=0;et<9;et++)this.coefficients[et].copy(_e[et]);return this}zero(){for(let _e=0;_e<9;_e++)this.coefficients[_e].set(0,0,0);return this}getAt(_e,et){const rt=_e.x,it=_e.y,st=_e.z,ot=this.coefficients;return et.copy(ot[0]).multiplyScalar(.282095),et.addScaledVector(ot[1],.488603*it),et.addScaledVector(ot[2],.488603*st),et.addScaledVector(ot[3],.488603*rt),et.addScaledVector(ot[4],1.092548*(rt*it)),et.addScaledVector(ot[5],1.092548*(it*st)),et.addScaledVector(ot[6],.315392*(3*st*st-1)),et.addScaledVector(ot[7],1.092548*(rt*st)),et.addScaledVector(ot[8],.546274*(rt*rt-it*it)),et}getIrradianceAt(_e,et){const rt=_e.x,it=_e.y,st=_e.z,ot=this.coefficients;return et.copy(ot[0]).multiplyScalar(.886227),et.addScaledVector(ot[1],2*.511664*it),et.addScaledVector(ot[2],2*.511664*st),et.addScaledVector(ot[3],2*.511664*rt),et.addScaledVector(ot[4],2*.429043*rt*it),et.addScaledVector(ot[5],2*.429043*it*st),et.addScaledVector(ot[6],.743125*st*st-.247708),et.addScaledVector(ot[7],2*.429043*rt*st),et.addScaledVector(ot[8],.429043*(rt*rt-it*it)),et}add(_e){for(let et=0;et<9;et++)this.coefficients[et].add(_e.coefficients[et]);return this}addScaledSH(_e,et){for(let rt=0;rt<9;rt++)this.coefficients[rt].addScaledVector(_e.coefficients[rt],et);return this}scale(_e){for(let et=0;et<9;et++)this.coefficients[et].multiplyScalar(_e);return this}lerp(_e,et){for(let rt=0;rt<9;rt++)this.coefficients[rt].lerp(_e.coefficients[rt],et);return this}equals(_e){for(let et=0;et<9;et++)if(!this.coefficients[et].equals(_e.coefficients[et]))return!1;return!0}copy(_e){return this.set(_e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_e,et=0){const rt=this.coefficients;for(let it=0;it<9;it++)rt[it].fromArray(_e,et+it*3);return this}toArray(_e=[],et=0){const rt=this.coefficients;for(let it=0;it<9;it++)rt[it].toArray(_e,et+it*3);return _e}static getBasisAt(_e,et){const rt=_e.x,it=_e.y,st=_e.z;et[0]=.282095,et[1]=.488603*it,et[2]=.488603*st,et[3]=.488603*rt,et[4]=1.092548*rt*it,et[5]=1.092548*it*st,et[6]=.315392*(3*st*st-1),et[7]=1.092548*rt*st,et[8]=.546274*(rt*rt-it*it)}}class LightProbe extends Light{constructor(_e=new SphericalHarmonics3,et=1){super(void 0,et),this.isLightProbe=!0,this.sh=_e}copy(_e){return super.copy(_e),this.sh.copy(_e.sh),this}fromJSON(_e){return this.intensity=_e.intensity,this.sh.fromArray(_e.sh),this}toJSON(_e){const et=super.toJSON(_e);return et.object.sh=this.sh.toArray(),et}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_e,et,rt=1){super(_e,et),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=rt}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}clone(_e){const et=super.clone(_e);return et.meshPerAttribute=this.meshPerAttribute,et}toJSON(_e){const et=super.toJSON(_e);return et.isInstancedInterleavedBuffer=!0,et.meshPerAttribute=this.meshPerAttribute,et}}const refreshUniforms=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class NodeMaterialObserver{constructor(_e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(_e),this.hasAnimation=_e.object.isSkinnedMesh===!0,this.refreshUniforms=refreshUniforms,this.renderId=0}firstInitialization(_e){return this.renderObjects.has(_e)===!1?(this.getRenderObjectData(_e),!0):!1}getRenderObjectData(_e){let et=this.renderObjects.get(_e);return et===void 0&&(et={material:this.getMaterialData(_e.material),worldMatrix:_e.object.matrixWorld.clone()},_e.object.center&&(et.center=_e.object.center.clone()),_e.object.morphTargetInfluences&&(et.morphTargetInfluences=_e.object.morphTargetInfluences.slice()),_e.bundle!==null&&(et.version=_e.bundle.version),this.renderObjects.set(_e,et)),et}containsNode(_e){const et=_e.material;for(const rt in et)if(et[rt]&&et[rt].isNode)return!0;return _e.renderer.nodes.modelViewMatrix!==null||_e.renderer.nodes.modelNormalViewMatrix!==null}getMaterialData(_e){const et={};for(const rt of this.refreshUniforms){const it=_e[rt];it!=null&&(typeof it=="object"&&it.clone!==void 0?it.isTexture===!0?et[rt]={id:it.id,version:it.version}:et[rt]=it.clone():et[rt]=it)}return et}equals(_e){const{object:et,material:rt}=_e,it=this.getRenderObjectData(_e);if(it.worldMatrix.equals(et.matrixWorld)!==!0)return it.worldMatrix.copy(et.matrixWorld),!1;const st=it.material;for(const ot in st){const at=st[ot],lt=rt[ot];if(at.equals!==void 0){if(at.equals(lt)===!1)return at.copy(lt),!1}else if(lt.isTexture===!0){if(at.id!==lt.id||at.version!==lt.version)return at.id=lt.id,at.version=lt.version,!1}else if(at!==lt)return st[ot]=lt,!1}if(it.morphTargetInfluences){let ot=!1;for(let at=0;at<it.morphTargetInfluences.length;at++)it.morphTargetInfluences[at]!==et.morphTargetInfluences[at]&&(ot=!0);if(ot)return!0}return it.center&&it.center.equals(et.center)===!1?(it.center.copy(et.center),!0):(_e.bundle!==null&&(it.version=_e.bundle.version),!0)}needsRefresh(_e,et){if(this.hasNode||this.hasAnimation||this.firstInitialization(_e))return!0;const{renderId:rt}=et;if(this.renderId!==rt)return this.renderId=rt,!0;const it=_e.object.static===!0,st=_e.bundle!==null&&_e.bundle.static===!0&&this.getRenderObjectData(_e).version===_e.bundle.version;return it||st?!1:this.equals(_e)!==!0}}function cyrb53(nt,_e=0){let et=3735928559^_e,rt=1103547991^_e;if(nt instanceof Array)for(let it=0,st;it<nt.length;it++)st=nt[it],et=Math.imul(et^st,2654435761),rt=Math.imul(rt^st,1597334677);else for(let it=0,st;it<nt.length;it++)st=nt.charCodeAt(it),et=Math.imul(et^st,2654435761),rt=Math.imul(rt^st,1597334677);return et=Math.imul(et^et>>>16,2246822507),et^=Math.imul(rt^rt>>>13,3266489909),rt=Math.imul(rt^rt>>>16,2246822507),rt^=Math.imul(et^et>>>13,3266489909),4294967296*(2097151&rt)+(et>>>0)}const hashString=nt=>cyrb53(nt),hashArray=nt=>cyrb53(nt),hash$1=(...nt)=>cyrb53(nt);function getCacheKey$1(nt,_e=!1){const et=[];nt.isNode===!0&&(et.push(nt.id),nt=nt.getSelf());for(const{property:rt,childNode:it}of getNodeChildren(nt))et.push(et,cyrb53(rt.slice(0,-4)),it.getCacheKey(_e));return cyrb53(et)}function*getNodeChildren(nt,_e=!1){for(const et in nt){if(et.startsWith("_")===!0)continue;const rt=nt[et];if(Array.isArray(rt)===!0)for(let it=0;it<rt.length;it++){const st=rt[it];st&&(st.isNode===!0||_e&&typeof st.toJSON=="function")&&(yield{property:et,index:it,childNode:st})}else if(rt&&rt.isNode===!0)yield{property:et,childNode:rt};else if(typeof rt=="object")for(const it in rt){const st=rt[it];st&&(st.isNode===!0||_e&&typeof st.toJSON=="function")&&(yield{property:et,index:it,childNode:st})}}}function getValueType(nt){if(nt==null)return null;const _e=typeof nt;return nt.isNode===!0?"node":_e==="number"?"float":_e==="boolean"?"bool":_e==="string"?"string":_e==="function"?"shader":nt.isVector2===!0?"vec2":nt.isVector3===!0?"vec3":nt.isVector4===!0?"vec4":nt.isMatrix3===!0?"mat3":nt.isMatrix4===!0?"mat4":nt.isColor===!0?"color":nt instanceof ArrayBuffer?"ArrayBuffer":null}function getValueFromType(nt,..._e){const et=nt?nt.slice(-4):void 0;return _e.length===1&&(et==="vec2"?_e=[_e[0],_e[0]]:et==="vec3"?_e=[_e[0],_e[0],_e[0]]:et==="vec4"&&(_e=[_e[0],_e[0],_e[0],_e[0]])),nt==="color"?new Color(..._e):et==="vec2"?new Vector2(..._e):et==="vec3"?new Vector3(..._e):et==="vec4"?new Vector4(..._e):et==="mat3"?new Matrix3(..._e):et==="mat4"?new Matrix4(..._e):nt==="bool"?_e[0]||!1:nt==="float"||nt==="int"||nt==="uint"?_e[0]||0:nt==="string"?_e[0]||"":nt==="ArrayBuffer"?base64ToArrayBuffer(_e[0]):null}function arrayBufferToBase64(nt){let _e="";const et=new Uint8Array(nt);for(let rt=0;rt<et.length;rt++)_e+=String.fromCharCode(et[rt]);return btoa(_e)}function base64ToArrayBuffer(nt){return Uint8Array.from(atob(nt),_e=>_e.charCodeAt(0)).buffer}const NodeShaderStage={VERTEX:"vertex",FRAGMENT:"fragment"},NodeUpdateType={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},defaultShaderStages=["fragment","vertex"],defaultBuildStages=["setup","analyze","generate"],shaderStages=[...defaultShaderStages,"compute"],vectorComponents=["x","y","z","w"];let _nodeId=0,Node$1=class extends EventDispatcher{static get type(){return"Node"}constructor(_e=null){super(),this.nodeType=_e,this.updateType=NodeUpdateType.NONE,this.updateBeforeType=NodeUpdateType.NONE,this.updateAfterType=NodeUpdateType.NONE,this.uuid=MathUtils.generateUUID(),this.version=0,this._cacheKey=null,this._cacheKeyVersion=0,this.global=!1,this.isNode=!0,Object.defineProperty(this,"id",{value:_nodeId++})}set needsUpdate(_e){_e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(_e,et){return this.updateType=et,this.update=_e.bind(this.getSelf()),this}onFrameUpdate(_e){return this.onUpdate(_e,NodeUpdateType.FRAME)}onRenderUpdate(_e){return this.onUpdate(_e,NodeUpdateType.RENDER)}onObjectUpdate(_e){return this.onUpdate(_e,NodeUpdateType.OBJECT)}onReference(_e){return this.updateReference=_e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:_e}of getNodeChildren(this))yield _e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(_e){_e(this);for(const et of this.getChildren())et.traverse(_e)}getCacheKey(_e=!1){return _e=_e||this.version!==this._cacheKeyVersion,(_e===!0||this._cacheKey===null)&&(this._cacheKey=getCacheKey$1(this,_e),this._cacheKeyVersion=this.version),this._cacheKey}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(_e){const et=this.getNodeType(_e);return _e.getElementType(et)}getNodeType(_e){const et=_e.getNodeProperties(this);return et.outputNode?et.outputNode.getNodeType(_e):this.nodeType}getShared(_e){const et=this.getHash(_e);return _e.getNodeFromHash(et)||this}setup(_e){const et=_e.getNodeProperties(this);let rt=0;for(const it of this.getChildren())et["node"+rt++]=it;return null}analyze(_e){if(_e.increaseUsage(this)===1){const rt=_e.getNodeProperties(this);for(const it of Object.values(rt))it&&it.isNode===!0&&it.build(_e)}}generate(_e,et){const{outputNode:rt}=_e.getNodeProperties(this);if(rt&&rt.isNode===!0)return rt.build(_e,et)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(_e,et=null){const rt=this.getShared(_e);if(this!==rt)return rt.build(_e,et);_e.addNode(this),_e.addChain(this);let it=null;const st=_e.getBuildStage();if(st==="setup"){this.updateReference(_e);const ot=_e.getNodeProperties(this);if(ot.initialized!==!0){const at=_e.stack.nodes.length;ot.initialized=!0,ot.outputNode=this.setup(_e),ot.outputNode!==null&&_e.stack.nodes.length;for(const lt of Object.values(ot))lt&&lt.isNode===!0&&lt.build(_e)}}else if(st==="analyze")this.analyze(_e);else if(st==="generate")if(this.generate.length===1){const at=this.getNodeType(_e),lt=_e.getDataFromNode(this);it=lt.snippet,it===void 0?(it=this.generate(_e)||"",lt.snippet=it):lt.flowCodes!==void 0&&_e.context.nodeBlock!==void 0&&_e.addFlowCodeHierarchy(this,_e.context.nodeBlock),it=_e.format(it,at,et)}else it=this.generate(_e,et)||"";return _e.removeChain(this),it}getSerializeChildren(){return getNodeChildren(this)}serialize(_e){const et=this.getSerializeChildren(),rt={};for(const{property:it,index:st,childNode:ot}of et)st!==void 0?(rt[it]===void 0&&(rt[it]=Number.isInteger(st)?[]:{}),rt[it][st]=ot.toJSON(_e.meta).uuid):rt[it]=ot.toJSON(_e.meta).uuid;Object.keys(rt).length>0&&(_e.inputNodes=rt)}deserialize(_e){if(_e.inputNodes!==void 0){const et=_e.meta.nodes;for(const rt in _e.inputNodes)if(Array.isArray(_e.inputNodes[rt])){const it=[];for(const st of _e.inputNodes[rt])it.push(et[st]);this[rt]=it}else if(typeof _e.inputNodes[rt]=="object"){const it={};for(const st in _e.inputNodes[rt]){const ot=_e.inputNodes[rt][st];it[st]=et[ot]}this[rt]=it}else{const it=_e.inputNodes[rt];this[rt]=et[it]}}}toJSON(_e){const{uuid:et,type:rt}=this,it=_e===void 0||typeof _e=="string";it&&(_e={textures:{},images:{},nodes:{}});let st=_e.nodes[et];st===void 0&&(st={uuid:et,type:rt,meta:_e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},it!==!0&&(_e.nodes[st.uuid]=st),this.serialize(st),delete st.meta);function ot(at){const lt=[];for(const ct in at){const ut=at[ct];delete ut.metadata,lt.push(ut)}return lt}if(it){const at=ot(_e.textures),lt=ot(_e.images),ct=ot(_e.nodes);at.length>0&&(st.textures=at),lt.length>0&&(st.images=lt),ct.length>0&&(st.nodes=ct)}return st}};class ArrayElementNode extends Node$1{static get type(){return"ArrayElementNode"}constructor(_e,et){super(),this.node=_e,this.indexNode=et,this.isArrayElementNode=!0}getNodeType(_e){return this.node.getElementType(_e)}generate(_e){const et=this.node.build(_e),rt=this.indexNode.build(_e,"uint");return`${et}[ ${rt} ]`}}class ConvertNode extends Node$1{static get type(){return"ConvertNode"}constructor(_e,et){super(),this.node=_e,this.convertTo=et}getNodeType(_e){const et=this.node.getNodeType(_e);let rt=null;for(const it of this.convertTo.split("|"))(rt===null||_e.getTypeLength(et)===_e.getTypeLength(it))&&(rt=it);return rt}serialize(_e){super.serialize(_e),_e.convertTo=this.convertTo}deserialize(_e){super.deserialize(_e),this.convertTo=_e.convertTo}generate(_e,et){const rt=this.node,it=this.getNodeType(_e),st=rt.build(_e,it);return _e.format(st,it,et)}}class TempNode extends Node$1{static get type(){return"TempNode"}constructor(_e){super(_e),this.isTempNode=!0}hasDependencies(_e){return _e.getDataFromNode(this).usageCount>1}build(_e,et){if(_e.getBuildStage()==="generate"){const it=_e.getVectorType(this.getNodeType(_e,et)),st=_e.getDataFromNode(this);if(st.propertyName!==void 0)return _e.format(st.propertyName,it,et);if(it!=="void"&&et!=="void"&&this.hasDependencies(_e)){const ot=super.build(_e,it),at=_e.getVarFromNode(this,null,it),lt=_e.getPropertyName(at);return _e.addLineFlowCode(`${lt} = ${ot}`,this),st.snippet=ot,st.propertyName=lt,_e.format(st.propertyName,it,et)}}return super.build(_e,et)}}class JoinNode extends TempNode{static get type(){return"JoinNode"}constructor(_e=[],et=null){super(et),this.nodes=_e}getNodeType(_e){return this.nodeType!==null?_e.getVectorType(this.nodeType):_e.getTypeFromLength(this.nodes.reduce((et,rt)=>et+_e.getTypeLength(rt.getNodeType(_e)),0))}generate(_e,et){const rt=this.getNodeType(_e),it=this.nodes,st=_e.getComponentType(rt),ot=[];for(const lt of it){let ct=lt.build(_e);const ut=_e.getComponentType(lt.getNodeType(_e));ut!==st&&(ct=_e.format(ct,ut,st)),ot.push(ct)}const at=`${_e.getType(rt)}( ${ot.join(", ")} )`;return _e.format(at,rt,et)}}const stringVectorComponents=vectorComponents.join("");class SplitNode extends Node$1{static get type(){return"SplitNode"}constructor(_e,et="x"){super(),this.node=_e,this.components=et,this.isSplitNode=!0}getVectorLength(){let _e=this.components.length;for(const et of this.components)_e=Math.max(vectorComponents.indexOf(et)+1,_e);return _e}getComponentType(_e){return _e.getComponentType(this.node.getNodeType(_e))}getNodeType(_e){return _e.getTypeFromLength(this.components.length,this.getComponentType(_e))}generate(_e,et){const rt=this.node,it=_e.getTypeLength(rt.getNodeType(_e));let st=null;if(it>1){let ot=null;this.getVectorLength()>=it&&(ot=_e.getTypeFromLength(this.getVectorLength(),this.getComponentType(_e)));const lt=rt.build(_e,ot);this.components.length===it&&this.components===stringVectorComponents.slice(0,this.components.length)?st=_e.format(lt,ot,et):st=_e.format(`${lt}.${this.components}`,this.getNodeType(_e),et)}else st=rt.build(_e,et);return st}serialize(_e){super.serialize(_e),_e.components=this.components}deserialize(_e){super.deserialize(_e),this.components=_e.components}}class SetNode extends TempNode{static get type(){return"SetNode"}constructor(_e,et,rt){super(),this.sourceNode=_e,this.components=et,this.targetNode=rt}getNodeType(_e){return this.sourceNode.getNodeType(_e)}generate(_e){const{sourceNode:et,components:rt,targetNode:it}=this,st=this.getNodeType(_e),ot=_e.getTypeFromLength(rt.length,it.getNodeType(_e)),at=it.build(_e,ot),lt=et.build(_e,st),ct=_e.getTypeLength(st),ut=[];for(let ht=0;ht<ct;ht++){const dt=vectorComponents[ht];dt===rt[0]?(ut.push(at),ht+=rt.length-1):ut.push(lt+"."+dt)}return`${_e.getType(st)}( ${ut.join(", ")} )`}}class FlipNode extends TempNode{static get type(){return"FlipNode"}constructor(_e,et){super(),this.sourceNode=_e,this.components=et}getNodeType(_e){return this.sourceNode.getNodeType(_e)}generate(_e){const{components:et,sourceNode:rt}=this,it=this.getNodeType(_e),st=rt.build(_e),ot=_e.getVarFromNode(this),at=_e.getPropertyName(ot);_e.addLineFlowCode(at+" = "+st,this);const lt=_e.getTypeLength(it),ct=[];let ut=0;for(let ht=0;ht<lt;ht++){const dt=vectorComponents[ht];dt===et[ut]?(ct.push("1.0 - "+(at+"."+dt)),ut++):ct.push(at+"."+dt)}return`${_e.getType(it)}( ${ct.join(", ")} )`}}class InputNode extends Node$1{static get type(){return"InputNode"}constructor(_e,et=null){super(et),this.isInputNode=!0,this.value=_e,this.precision=null}getNodeType(){return this.nodeType===null?getValueType(this.value):this.nodeType}getInputType(_e){return this.getNodeType(_e)}setPrecision(_e){return this.precision=_e,this}serialize(_e){super.serialize(_e),_e.value=this.value,this.value&&this.value.toArray&&(_e.value=this.value.toArray()),_e.valueType=getValueType(this.value),_e.nodeType=this.nodeType,_e.valueType==="ArrayBuffer"&&(_e.value=arrayBufferToBase64(_e.value)),_e.precision=this.precision}deserialize(_e){super.deserialize(_e),this.nodeType=_e.nodeType,this.value=Array.isArray(_e.value)?getValueFromType(_e.valueType,..._e.value):_e.value,this.precision=_e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(_e.value))}generate(){console.warn("Abstract function.")}}class ConstNode extends InputNode{static get type(){return"ConstNode"}constructor(_e,et=null){super(_e,et),this.isConstNode=!0}generateConst(_e){return _e.generateConst(this.getNodeType(_e),this.value)}generate(_e,et){const rt=this.getNodeType(_e);return _e.format(this.generateConst(_e),rt,et)}}let currentStack=null;const NodeElements=new Map;function addMethodChaining(nt,_e){if(NodeElements.has(nt)){console.warn(`Redefinition of method chaining ${nt}`);return}if(typeof _e!="function")throw new Error(`Node element ${nt} is not a function`);NodeElements.set(nt,_e)}const parseSwizzle=nt=>nt.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),parseSwizzleAndSort=nt=>parseSwizzle(nt).split("").sort().join(""),shaderNodeHandler={setup(nt,_e){const et=_e.shift();return nt(nodeObjects(et),..._e)},get(nt,_e,et){if(typeof _e=="string"&&nt[_e]===void 0){if(nt.isStackNode!==!0&&_e==="assign")return(...rt)=>(currentStack.assign(et,...rt),et);if(NodeElements.has(_e)){const rt=NodeElements.get(_e);return nt.isStackNode?(...it)=>et.add(rt(...it)):(...it)=>rt(et,...it)}else{if(_e==="self")return nt;if(_e.endsWith("Assign")&&NodeElements.has(_e.slice(0,_e.length-6))){const rt=NodeElements.get(_e.slice(0,_e.length-6));return nt.isStackNode?(...it)=>et.assign(it[0],rt(...it)):(...it)=>et.assign(rt(et,...it))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(_e)===!0)return _e=parseSwizzle(_e),nodeObject(new SplitNode(et,_e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(_e)===!0)return _e=parseSwizzleAndSort(_e.slice(3).toLowerCase()),rt=>nodeObject(new SetNode(nt,_e,rt));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(_e)===!0)return _e=parseSwizzleAndSort(_e.slice(4).toLowerCase()),()=>nodeObject(new FlipNode(nodeObject(nt),_e));if(_e==="width"||_e==="height"||_e==="depth")return _e==="width"?_e="x":_e==="height"?_e="y":_e==="depth"&&(_e="z"),nodeObject(new SplitNode(nt,_e));if(/^\d+$/.test(_e)===!0)return nodeObject(new ArrayElementNode(et,new ConstNode(Number(_e),"uint")))}}}return Reflect.get(nt,_e,et)},set(nt,_e,et,rt){return typeof _e=="string"&&nt[_e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(_e)===!0||_e==="width"||_e==="height"||_e==="depth"||/^\d+$/.test(_e)===!0)?(rt[_e].assign(et),!0):Reflect.set(nt,_e,et,rt)}},nodeObjectsCacheMap=new WeakMap,nodeBuilderFunctionsCacheMap=new WeakMap,ShaderNodeObject=function(nt,_e=null){const et=getValueType(nt);if(et==="node"){let rt=nodeObjectsCacheMap.get(nt);return rt===void 0&&(rt=new Proxy(nt,shaderNodeHandler),nodeObjectsCacheMap.set(nt,rt),nodeObjectsCacheMap.set(rt,rt)),rt}else{if(_e===null&&(et==="float"||et==="boolean")||et&&et!=="shader"&&et!=="string")return nodeObject(getConstNode(nt,_e));if(et==="shader")return Fn(nt)}return nt},ShaderNodeObjects=function(nt,_e=null){for(const et in nt)nt[et]=nodeObject(nt[et],_e);return nt},ShaderNodeArray=function(nt,_e=null){const et=nt.length;for(let rt=0;rt<et;rt++)nt[rt]=nodeObject(nt[rt],_e);return nt},ShaderNodeProxy=function(nt,_e=null,et=null,rt=null){const it=st=>nodeObject(rt!==null?Object.assign(st,rt):st);return _e===null?(...st)=>it(new nt(...nodeArray(st))):et!==null?(et=nodeObject(et),(...st)=>it(new nt(_e,...nodeArray(st),et))):(...st)=>it(new nt(_e,...nodeArray(st)))},ShaderNodeImmutable=function(nt,..._e){return nodeObject(new nt(...nodeArray(_e)))};class ShaderCallNodeInternal extends Node$1{constructor(_e,et){super(),this.shaderNode=_e,this.inputNodes=et}getNodeType(_e){return this.shaderNode.nodeType||this.getOutputNode(_e).getNodeType(_e)}call(_e){const{shaderNode:et,inputNodes:rt}=this,it=_e.getNodeProperties(et);if(it.onceOutput)return it.onceOutput;let st=null;if(et.layout){let ot=nodeBuilderFunctionsCacheMap.get(_e.constructor);ot===void 0&&(ot=new WeakMap,nodeBuilderFunctionsCacheMap.set(_e.constructor,ot));let at=ot.get(et);at===void 0&&(at=nodeObject(_e.buildFunctionNode(et)),ot.set(et,at)),_e.currentFunctionNode!==null&&_e.currentFunctionNode.includes.push(at),st=nodeObject(at.call(rt))}else{const ot=et.jsFunc,at=rt!==null?ot(rt,_e):ot(_e);st=nodeObject(at)}return et.once&&(it.onceOutput=st),st}getOutputNode(_e){const et=_e.getNodeProperties(this);return et.outputNode===null&&(et.outputNode=this.setupOutput(_e)),et.outputNode}setup(_e){return this.getOutputNode(_e)}setupOutput(_e){return _e.addStack(),_e.stack.outputNode=this.call(_e),_e.removeStack()}generate(_e,et){return this.getOutputNode(_e).build(_e,et)}}class ShaderNodeInternal extends Node$1{constructor(_e,et){super(et),this.jsFunc=_e,this.layout=null,this.global=!0,this.once=!1}setLayout(_e){return this.layout=_e,this}call(_e=null){return nodeObjects(_e),nodeObject(new ShaderCallNodeInternal(this,_e))}setup(){return this.call()}}const bools=[!1,!0],uints=[0,1,2,3],ints=[-1,-2],floats=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],boolsCacheMap=new Map;for(const nt of bools)boolsCacheMap.set(nt,new ConstNode(nt));const uintsCacheMap=new Map;for(const nt of uints)uintsCacheMap.set(nt,new ConstNode(nt,"uint"));const intsCacheMap=new Map([...uintsCacheMap].map(nt=>new ConstNode(nt.value,"int")));for(const nt of ints)intsCacheMap.set(nt,new ConstNode(nt,"int"));const floatsCacheMap=new Map([...intsCacheMap].map(nt=>new ConstNode(nt.value)));for(const nt of floats)floatsCacheMap.set(nt,new ConstNode(nt));for(const nt of floats)floatsCacheMap.set(-nt,new ConstNode(-nt));const cacheMaps={bool:boolsCacheMap,uint:uintsCacheMap,ints:intsCacheMap,float:floatsCacheMap},constNodesCacheMap=new Map([...boolsCacheMap,...floatsCacheMap]),getConstNode=(nt,_e)=>constNodesCacheMap.has(nt)?constNodesCacheMap.get(nt):nt.isNode===!0?nt:new ConstNode(nt,_e),safeGetNodeType=nt=>{try{return nt.getNodeType()}catch{return}},ConvertType=function(nt,_e=null){return(...et)=>{if((et.length===0||!["bool","float","int","uint"].includes(nt)&&et.every(it=>typeof it!="object"))&&(et=[getValueFromType(nt,...et)]),et.length===1&&_e!==null&&_e.has(et[0]))return nodeObject(_e.get(et[0]));if(et.length===1){const it=getConstNode(et[0],nt);return safeGetNodeType(it)===nt?nodeObject(it):nodeObject(new ConvertNode(it,nt))}const rt=et.map(it=>getConstNode(it));return nodeObject(new JoinNode(rt,nt))}},defined=nt=>typeof nt=="object"&&nt!==null?nt.value:nt,getConstNodeType=nt=>nt!=null?nt.nodeType||nt.convertTo||(typeof nt=="string"?nt:null):null;function ShaderNode(nt,_e){return new Proxy(new ShaderNodeInternal(nt,_e),shaderNodeHandler)}const nodeObject=(nt,_e=null)=>ShaderNodeObject(nt,_e),nodeObjects=(nt,_e=null)=>new ShaderNodeObjects(nt,_e),nodeArray=(nt,_e=null)=>new ShaderNodeArray(nt,_e),nodeProxy=(...nt)=>new ShaderNodeProxy(...nt),nodeImmutable=(...nt)=>new ShaderNodeImmutable(...nt),Fn=(nt,_e)=>{const et=new ShaderNode(nt,_e),rt=(...it)=>{let st;return nodeObjects(it),it[0]&&it[0].isNode?st=[...it]:st=it[0],et.call(st)};return rt.shaderNode=et,rt.setLayout=it=>(et.setLayout(it),rt),rt.once=()=>(et.once=!0,rt),rt};addMethodChaining("toGlobal",nt=>(nt.global=!0,nt));const setCurrentStack=nt=>{currentStack=nt},getCurrentStack=()=>currentStack,If=(...nt)=>currentStack.If(...nt);function append(nt){return currentStack&&currentStack.add(nt),nt}addMethodChaining("append",append);const color$2=new ConvertType("color"),float=new ConvertType("float",cacheMaps.float),int$1=new ConvertType("int",cacheMaps.ints),uint=new ConvertType("uint",cacheMaps.uint),bool=new ConvertType("bool",cacheMaps.bool),vec2=new ConvertType("vec2"),ivec2=new ConvertType("ivec2"),uvec2=new ConvertType("uvec2"),bvec2=new ConvertType("bvec2"),vec3=new ConvertType("vec3"),ivec3=new ConvertType("ivec3"),uvec3=new ConvertType("uvec3"),bvec3=new ConvertType("bvec3"),vec4=new ConvertType("vec4"),ivec4=new ConvertType("ivec4"),uvec4=new ConvertType("uvec4"),bvec4=new ConvertType("bvec4"),mat2=new ConvertType("mat2"),mat3=new ConvertType("mat3"),mat4=new ConvertType("mat4");addMethodChaining("toColor",color$2);addMethodChaining("toFloat",float);addMethodChaining("toInt",int$1);addMethodChaining("toUint",uint);addMethodChaining("toBool",bool);addMethodChaining("toVec2",vec2);addMethodChaining("toIVec2",ivec2);addMethodChaining("toUVec2",uvec2);addMethodChaining("toBVec2",bvec2);addMethodChaining("toVec3",vec3);addMethodChaining("toIVec3",ivec3);addMethodChaining("toUVec3",uvec3);addMethodChaining("toBVec3",bvec3);addMethodChaining("toVec4",vec4);addMethodChaining("toIVec4",ivec4);addMethodChaining("toUVec4",uvec4);addMethodChaining("toBVec4",bvec4);addMethodChaining("toMat2",mat2);addMethodChaining("toMat3",mat3);addMethodChaining("toMat4",mat4);const element=nodeProxy(ArrayElementNode),convert=(nt,_e)=>nodeObject(new ConvertNode(nodeObject(nt),_e));addMethodChaining("element",element);addMethodChaining("convert",convert);class UniformGroupNode extends Node$1{static get type(){return"UniformGroupNode"}constructor(_e,et=!1,rt=1){super("string"),this.name=_e,this.version=0,this.shared=et,this.order=rt,this.isUniformGroup=!0}set needsUpdate(_e){_e===!0&&this.version++}serialize(_e){super.serialize(_e),_e.name=this.name,_e.version=this.version,_e.shared=this.shared}deserialize(_e){super.deserialize(_e),this.name=_e.name,this.version=_e.version,this.shared=_e.shared}}const uniformGroup=nt=>new UniformGroupNode(nt),sharedUniformGroup=(nt,_e=0)=>new UniformGroupNode(nt,!0,_e),frameGroup=sharedUniformGroup("frame"),renderGroup=sharedUniformGroup("render"),objectGroup=uniformGroup("object");class UniformNode extends InputNode{static get type(){return"UniformNode"}constructor(_e,et=null){super(_e,et),this.isUniformNode=!0,this.name="",this.groupNode=objectGroup}label(_e){return this.name=_e,this}setGroup(_e){return this.groupNode=_e,this}getGroup(){return this.groupNode}getUniformHash(_e){return this.getHash(_e)}onUpdate(_e,et){const rt=this.getSelf();return _e=_e.bind(rt),super.onUpdate(it=>{const st=_e(it,rt);st!==void 0&&(this.value=st)},et)}generate(_e,et){const rt=this.getNodeType(_e),it=this.getUniformHash(_e);let st=_e.getNodeFromHash(it);st===void 0&&(_e.setHashNode(this,it),st=this);const ot=st.getInputType(_e),at=_e.getUniformFromNode(st,ot,_e.shaderStage,this.name||_e.context.label),lt=_e.getPropertyName(at);return _e.context.label!==void 0&&delete _e.context.label,_e.format(lt,rt,et)}}const uniform=(nt,_e)=>{const et=getConstNodeType(_e||nt),rt=nt&&nt.isNode===!0?nt.node&&nt.node.value||nt.value:nt;return nodeObject(new UniformNode(rt,et))};class PropertyNode extends Node$1{static get type(){return"PropertyNode"}constructor(_e,et=null,rt=!1){super(_e),this.name=et,this.varying=rt,this.isPropertyNode=!0}getHash(_e){return this.name||super.getHash(_e)}isGlobal(){return!0}generate(_e){let et;return this.varying===!0?(et=_e.getVaryingFromNode(this,this.name),et.needsInterpolation=!0):et=_e.getVarFromNode(this,this.name),_e.getPropertyName(et)}}const property=(nt,_e)=>nodeObject(new PropertyNode(nt,_e)),varyingProperty=(nt,_e)=>nodeObject(new PropertyNode(nt,_e,!0)),diffuseColor=nodeImmutable(PropertyNode,"vec4","DiffuseColor"),emissive=nodeImmutable(PropertyNode,"vec3","EmissiveColor"),roughness=nodeImmutable(PropertyNode,"float","Roughness"),metalness=nodeImmutable(PropertyNode,"float","Metalness"),clearcoat=nodeImmutable(PropertyNode,"float","Clearcoat"),clearcoatRoughness=nodeImmutable(PropertyNode,"float","ClearcoatRoughness"),sheen=nodeImmutable(PropertyNode,"vec3","Sheen"),sheenRoughness=nodeImmutable(PropertyNode,"float","SheenRoughness"),iridescence=nodeImmutable(PropertyNode,"float","Iridescence"),iridescenceIOR=nodeImmutable(PropertyNode,"float","IridescenceIOR"),iridescenceThickness=nodeImmutable(PropertyNode,"float","IridescenceThickness"),alphaT=nodeImmutable(PropertyNode,"float","AlphaT"),anisotropy=nodeImmutable(PropertyNode,"float","Anisotropy"),anisotropyT=nodeImmutable(PropertyNode,"vec3","AnisotropyT"),anisotropyB=nodeImmutable(PropertyNode,"vec3","AnisotropyB"),specularColor=nodeImmutable(PropertyNode,"color","SpecularColor"),specularF90=nodeImmutable(PropertyNode,"float","SpecularF90"),shininess=nodeImmutable(PropertyNode,"float","Shininess"),output=nodeImmutable(PropertyNode,"vec4","Output"),dashSize=nodeImmutable(PropertyNode,"float","dashSize"),gapSize=nodeImmutable(PropertyNode,"float","gapSize"),ior=nodeImmutable(PropertyNode,"float","IOR"),transmission=nodeImmutable(PropertyNode,"float","Transmission"),thickness=nodeImmutable(PropertyNode,"float","Thickness"),attenuationDistance=nodeImmutable(PropertyNode,"float","AttenuationDistance"),attenuationColor=nodeImmutable(PropertyNode,"color","AttenuationColor"),dispersion=nodeImmutable(PropertyNode,"float","Dispersion");class AssignNode extends TempNode{static get type(){return"AssignNode"}constructor(_e,et){super(),this.targetNode=_e,this.sourceNode=et}hasDependencies(){return!1}getNodeType(_e,et){return et!=="void"?this.targetNode.getNodeType(_e):"void"}needsSplitAssign(_e){const{targetNode:et}=this;if(_e.isAvailable("swizzleAssign")===!1&&et.isSplitNode&&et.components.length>1){const rt=_e.getTypeLength(et.node.getNodeType(_e));return vectorComponents.join("").slice(0,rt)!==et.components}return!1}generate(_e,et){const{targetNode:rt,sourceNode:it}=this,st=this.needsSplitAssign(_e),ot=rt.getNodeType(_e),at=rt.context({assign:!0}).build(_e),lt=it.build(_e,ot),ct=it.getNodeType(_e),ut=_e.getDataFromNode(this);let ht;if(ut.initialized===!0)et!=="void"&&(ht=at);else if(st){const dt=_e.getVarFromNode(this,null,ot),ft=_e.getPropertyName(dt);_e.addLineFlowCode(`${ft} = ${lt}`,this);const pt=rt.node.context({assign:!0}).build(_e);for(let mt=0;mt<rt.components.length;mt++){const At=rt.components[mt];_e.addLineFlowCode(`${pt}.${At} = ${ft}[ ${mt} ]`,this)}et!=="void"&&(ht=at)}else ht=`${at} = ${lt}`,(et==="void"||ct==="void")&&(_e.addLineFlowCode(ht,this),et!=="void"&&(ht=at));return ut.initialized=!0,_e.format(ht,ot,et)}}const assign=nodeProxy(AssignNode);addMethodChaining("assign",assign);class FunctionCallNode extends TempNode{static get type(){return"FunctionCallNode"}constructor(_e=null,et={}){super(),this.functionNode=_e,this.parameters=et}setParameters(_e){return this.parameters=_e,this}getParameters(){return this.parameters}getNodeType(_e){return this.functionNode.getNodeType(_e)}generate(_e){const et=[],rt=this.functionNode,it=rt.getInputs(_e),st=this.parameters;if(Array.isArray(st))for(let at=0;at<st.length;at++){const lt=it[at],ct=st[at];et.push(ct.build(_e,lt.type))}else for(const at of it){const lt=st[at.name];if(lt!==void 0)et.push(lt.build(_e,at.type));else throw new Error(`FunctionCallNode: Input '${at.name}' not found in FunctionNode.`)}return`${rt.build(_e,"property")}( ${et.join(", ")} )`}}const call=(nt,..._e)=>(_e=_e.length>1||_e[0]&&_e[0].isNode===!0?nodeArray(_e):nodeObjects(_e[0]),nodeObject(new FunctionCallNode(nodeObject(nt),_e)));addMethodChaining("call",call);class OperatorNode extends TempNode{static get type(){return"OperatorNode"}constructor(_e,et,rt,...it){if(super(),it.length>0){let st=new OperatorNode(_e,et,rt);for(let ot=0;ot<it.length-1;ot++)st=new OperatorNode(_e,st,it[ot]);et=st,rt=it[it.length-1]}this.op=_e,this.aNode=et,this.bNode=rt}getNodeType(_e,et){const rt=this.op,it=this.aNode,st=this.bNode,ot=it.getNodeType(_e),at=typeof st<"u"?st.getNodeType(_e):null;if(ot==="void"||at==="void")return"void";if(rt==="%")return ot;if(rt==="~"||rt==="&"||rt==="|"||rt==="^"||rt===">>"||rt==="<<")return _e.getIntegerType(ot);if(rt==="!"||rt==="=="||rt==="&&"||rt==="||"||rt==="^^")return"bool";if(rt==="<"||rt===">"||rt==="<="||rt===">="){const lt=et?_e.getTypeLength(et):Math.max(_e.getTypeLength(ot),_e.getTypeLength(at));return lt>1?`bvec${lt}`:"bool"}else return ot==="float"&&_e.isMatrix(at)?at:_e.isMatrix(ot)&&_e.isVector(at)?_e.getVectorFromMatrix(ot):_e.isVector(ot)&&_e.isMatrix(at)?_e.getVectorFromMatrix(at):_e.getTypeLength(at)>_e.getTypeLength(ot)?at:ot}generate(_e,et){const rt=this.op,it=this.aNode,st=this.bNode,ot=this.getNodeType(_e,et);let at=null,lt=null;ot!=="void"?(at=it.getNodeType(_e),lt=typeof st<"u"?st.getNodeType(_e):null,rt==="<"||rt===">"||rt==="<="||rt===">="||rt==="=="?_e.isVector(at)?lt=at:at!==lt&&(at=lt="float"):rt===">>"||rt==="<<"?(at=ot,lt=_e.changeComponentType(lt,"uint")):_e.isMatrix(at)&&_e.isVector(lt)?lt=_e.getVectorFromMatrix(at):_e.isVector(at)&&_e.isMatrix(lt)?at=_e.getVectorFromMatrix(lt):at=lt=ot):at=lt=ot;const ct=it.build(_e,at),ut=typeof st<"u"?st.build(_e,lt):null,ht=_e.getTypeLength(et),dt=_e.getFunctionOperator(rt);if(et!=="void")return rt==="<"&&ht>1?_e.useComparisonMethod?_e.format(`${_e.getMethod("lessThan",et)}( ${ct}, ${ut} )`,ot,et):_e.format(`( ${ct} < ${ut} )`,ot,et):rt==="<="&&ht>1?_e.useComparisonMethod?_e.format(`${_e.getMethod("lessThanEqual",et)}( ${ct}, ${ut} )`,ot,et):_e.format(`( ${ct} <= ${ut} )`,ot,et):rt===">"&&ht>1?_e.useComparisonMethod?_e.format(`${_e.getMethod("greaterThan",et)}( ${ct}, ${ut} )`,ot,et):_e.format(`( ${ct} > ${ut} )`,ot,et):rt===">="&&ht>1?_e.useComparisonMethod?_e.format(`${_e.getMethod("greaterThanEqual",et)}( ${ct}, ${ut} )`,ot,et):_e.format(`( ${ct} >= ${ut} )`,ot,et):rt==="!"||rt==="~"?_e.format(`(${rt}${ct})`,at,et):dt?_e.format(`${dt}( ${ct}, ${ut} )`,ot,et):_e.format(`( ${ct} ${rt} ${ut} )`,ot,et);if(at!=="void")return dt?_e.format(`${dt}( ${ct}, ${ut} )`,ot,et):_e.format(`${ct} ${rt} ${ut}`,ot,et)}serialize(_e){super.serialize(_e),_e.op=this.op}deserialize(_e){super.deserialize(_e),this.op=_e.op}}const add=nodeProxy(OperatorNode,"+"),sub=nodeProxy(OperatorNode,"-"),mul=nodeProxy(OperatorNode,"*"),div=nodeProxy(OperatorNode,"/"),modInt=nodeProxy(OperatorNode,"%"),equal=nodeProxy(OperatorNode,"=="),notEqual=nodeProxy(OperatorNode,"!="),lessThan=nodeProxy(OperatorNode,"<"),greaterThan=nodeProxy(OperatorNode,">"),lessThanEqual=nodeProxy(OperatorNode,"<="),greaterThanEqual=nodeProxy(OperatorNode,">="),and=nodeProxy(OperatorNode,"&&"),or=nodeProxy(OperatorNode,"||"),not=nodeProxy(OperatorNode,"!"),xor=nodeProxy(OperatorNode,"^^"),bitAnd=nodeProxy(OperatorNode,"&"),bitNot=nodeProxy(OperatorNode,"~"),bitOr=nodeProxy(OperatorNode,"|"),bitXor=nodeProxy(OperatorNode,"^"),shiftLeft=nodeProxy(OperatorNode,"<<"),shiftRight=nodeProxy(OperatorNode,">>");addMethodChaining("add",add);addMethodChaining("sub",sub);addMethodChaining("mul",mul);addMethodChaining("div",div);addMethodChaining("modInt",modInt);addMethodChaining("equal",equal);addMethodChaining("notEqual",notEqual);addMethodChaining("lessThan",lessThan);addMethodChaining("greaterThan",greaterThan);addMethodChaining("lessThanEqual",lessThanEqual);addMethodChaining("greaterThanEqual",greaterThanEqual);addMethodChaining("and",and);addMethodChaining("or",or);addMethodChaining("not",not);addMethodChaining("xor",xor);addMethodChaining("bitAnd",bitAnd);addMethodChaining("bitNot",bitNot);addMethodChaining("bitOr",bitOr);addMethodChaining("bitXor",bitXor);addMethodChaining("shiftLeft",shiftLeft);addMethodChaining("shiftRight",shiftRight);const remainder=(...nt)=>(console.warn("TSL.OperatorNode: .remainder() has been renamed to .modInt()."),modInt(...nt));addMethodChaining("remainder",remainder);class MathNode extends TempNode{static get type(){return"MathNode"}constructor(_e,et,rt=null,it=null){super(),this.method=_e,this.aNode=et,this.bNode=rt,this.cNode=it}getInputType(_e){const et=this.aNode.getNodeType(_e),rt=this.bNode?this.bNode.getNodeType(_e):null,it=this.cNode?this.cNode.getNodeType(_e):null,st=_e.isMatrix(et)?0:_e.getTypeLength(et),ot=_e.isMatrix(rt)?0:_e.getTypeLength(rt),at=_e.isMatrix(it)?0:_e.getTypeLength(it);return st>ot&&st>at?et:ot>at?rt:at>st?it:et}getNodeType(_e){const et=this.method;return et===MathNode.LENGTH||et===MathNode.DISTANCE||et===MathNode.DOT?"float":et===MathNode.CROSS?"vec3":et===MathNode.ALL?"bool":et===MathNode.EQUALS?_e.changeComponentType(this.aNode.getNodeType(_e),"bool"):et===MathNode.MOD?this.aNode.getNodeType(_e):this.getInputType(_e)}generate(_e,et){const rt=this.method,it=this.getNodeType(_e),st=this.getInputType(_e),ot=this.aNode,at=this.bNode,lt=this.cNode,ct=_e.renderer.isWebGLRenderer===!0;if(rt===MathNode.TRANSFORM_DIRECTION){let ut=ot,ht=at;_e.isMatrix(ut.getNodeType(_e))?ht=vec4(vec3(ht),0):ut=vec4(vec3(ut),0);const dt=mul(ut,ht).xyz;return normalize(dt).build(_e,et)}else{if(rt===MathNode.NEGATE)return _e.format("( - "+ot.build(_e,st)+" )",it,et);if(rt===MathNode.ONE_MINUS)return sub(1,ot).build(_e,et);if(rt===MathNode.RECIPROCAL)return div(1,ot).build(_e,et);if(rt===MathNode.DIFFERENCE)return abs(sub(ot,at)).build(_e,et);{const ut=[];return rt===MathNode.CROSS||rt===MathNode.MOD?ut.push(ot.build(_e,it),at.build(_e,it)):ct&&rt===MathNode.STEP?ut.push(ot.build(_e,_e.getTypeLength(ot.getNodeType(_e))===1?"float":st),at.build(_e,st)):ct&&(rt===MathNode.MIN||rt===MathNode.MAX)||rt===MathNode.MOD?ut.push(ot.build(_e,st),at.build(_e,_e.getTypeLength(at.getNodeType(_e))===1?"float":st)):rt===MathNode.REFRACT?ut.push(ot.build(_e,st),at.build(_e,st),lt.build(_e,"float")):rt===MathNode.MIX?ut.push(ot.build(_e,st),at.build(_e,st),lt.build(_e,_e.getTypeLength(lt.getNodeType(_e))===1?"float":st)):(ut.push(ot.build(_e,st)),at!==null&&ut.push(at.build(_e,st)),lt!==null&&ut.push(lt.build(_e,st))),_e.format(`${_e.getMethod(rt,it)}( ${ut.join(", ")} )`,it,et)}}}serialize(_e){super.serialize(_e),_e.method=this.method}deserialize(_e){super.deserialize(_e),this.method=_e.method}}MathNode.ALL="all";MathNode.ANY="any";MathNode.EQUALS="equals";MathNode.RADIANS="radians";MathNode.DEGREES="degrees";MathNode.EXP="exp";MathNode.EXP2="exp2";MathNode.LOG="log";MathNode.LOG2="log2";MathNode.SQRT="sqrt";MathNode.INVERSE_SQRT="inversesqrt";MathNode.FLOOR="floor";MathNode.CEIL="ceil";MathNode.NORMALIZE="normalize";MathNode.FRACT="fract";MathNode.SIN="sin";MathNode.COS="cos";MathNode.TAN="tan";MathNode.ASIN="asin";MathNode.ACOS="acos";MathNode.ATAN="atan";MathNode.ABS="abs";MathNode.SIGN="sign";MathNode.LENGTH="length";MathNode.NEGATE="negate";MathNode.ONE_MINUS="oneMinus";MathNode.DFDX="dFdx";MathNode.DFDY="dFdy";MathNode.ROUND="round";MathNode.RECIPROCAL="reciprocal";MathNode.TRUNC="trunc";MathNode.FWIDTH="fwidth";MathNode.BITCAST="bitcast";MathNode.TRANSPOSE="transpose";MathNode.ATAN2="atan2";MathNode.MIN="min";MathNode.MAX="max";MathNode.MOD="mod";MathNode.STEP="step";MathNode.REFLECT="reflect";MathNode.DISTANCE="distance";MathNode.DIFFERENCE="difference";MathNode.DOT="dot";MathNode.CROSS="cross";MathNode.POW="pow";MathNode.TRANSFORM_DIRECTION="transformDirection";MathNode.MIX="mix";MathNode.CLAMP="clamp";MathNode.REFRACT="refract";MathNode.SMOOTHSTEP="smoothstep";MathNode.FACEFORWARD="faceforward";const EPSILON=float(1e-6),PI=float(Math.PI),all=nodeProxy(MathNode,MathNode.ALL),any=nodeProxy(MathNode,MathNode.ANY),equals=nodeProxy(MathNode,MathNode.EQUALS),radians=nodeProxy(MathNode,MathNode.RADIANS),degrees$1=nodeProxy(MathNode,MathNode.DEGREES),exp=nodeProxy(MathNode,MathNode.EXP),exp2=nodeProxy(MathNode,MathNode.EXP2),log=nodeProxy(MathNode,MathNode.LOG),log2=nodeProxy(MathNode,MathNode.LOG2),sqrt=nodeProxy(MathNode,MathNode.SQRT),inverseSqrt=nodeProxy(MathNode,MathNode.INVERSE_SQRT),floor=nodeProxy(MathNode,MathNode.FLOOR),ceil=nodeProxy(MathNode,MathNode.CEIL),normalize=nodeProxy(MathNode,MathNode.NORMALIZE),fract=nodeProxy(MathNode,MathNode.FRACT),sin=nodeProxy(MathNode,MathNode.SIN),cos=nodeProxy(MathNode,MathNode.COS),tan=nodeProxy(MathNode,MathNode.TAN),asin=nodeProxy(MathNode,MathNode.ASIN),acos=nodeProxy(MathNode,MathNode.ACOS),atan=nodeProxy(MathNode,MathNode.ATAN),abs=nodeProxy(MathNode,MathNode.ABS),sign=nodeProxy(MathNode,MathNode.SIGN),length=nodeProxy(MathNode,MathNode.LENGTH),negate=nodeProxy(MathNode,MathNode.NEGATE),oneMinus=nodeProxy(MathNode,MathNode.ONE_MINUS),dFdx=nodeProxy(MathNode,MathNode.DFDX),dFdy=nodeProxy(MathNode,MathNode.DFDY),round=nodeProxy(MathNode,MathNode.ROUND),reciprocal=nodeProxy(MathNode,MathNode.RECIPROCAL),trunc=nodeProxy(MathNode,MathNode.TRUNC),fwidth=nodeProxy(MathNode,MathNode.FWIDTH);MathNode.BITCAST;const transpose=nodeProxy(MathNode,MathNode.TRANSPOSE),atan2=nodeProxy(MathNode,MathNode.ATAN2),min$1=nodeProxy(MathNode,MathNode.MIN),max$1=nodeProxy(MathNode,MathNode.MAX),mod=nodeProxy(MathNode,MathNode.MOD),step=nodeProxy(MathNode,MathNode.STEP),reflect=nodeProxy(MathNode,MathNode.REFLECT),distance$1=nodeProxy(MathNode,MathNode.DISTANCE),difference=nodeProxy(MathNode,MathNode.DIFFERENCE),dot=nodeProxy(MathNode,MathNode.DOT),cross=nodeProxy(MathNode,MathNode.CROSS),pow=nodeProxy(MathNode,MathNode.POW),pow2=nodeProxy(MathNode,MathNode.POW,2),pow3=nodeProxy(MathNode,MathNode.POW,3),pow4=nodeProxy(MathNode,MathNode.POW,4),transformDirection=nodeProxy(MathNode,MathNode.TRANSFORM_DIRECTION),cbrt=nt=>mul(sign(nt),pow(abs(nt),1/3)),lengthSq=nt=>dot(nt,nt),mix$2=nodeProxy(MathNode,MathNode.MIX),clamp$2=(nt,_e=0,et=1)=>nodeObject(new MathNode(MathNode.CLAMP,nodeObject(nt),nodeObject(_e),nodeObject(et))),saturate$1=nt=>clamp$2(nt),refract=nodeProxy(MathNode,MathNode.REFRACT),smoothstep=nodeProxy(MathNode,MathNode.SMOOTHSTEP),faceForward=nodeProxy(MathNode,MathNode.FACEFORWARD),rand=Fn(([nt])=>{const rt=43758.5453,it=dot(nt.xy,vec2(12.9898,78.233)),st=mod(it,PI);return fract(sin(st).mul(rt))}),mixElement=(nt,_e,et)=>mix$2(_e,et,nt),smoothstepElement=(nt,_e,et)=>smoothstep(_e,et,nt);addMethodChaining("all",all);addMethodChaining("any",any);addMethodChaining("equals",equals);addMethodChaining("radians",radians);addMethodChaining("degrees",degrees$1);addMethodChaining("exp",exp);addMethodChaining("exp2",exp2);addMethodChaining("log",log);addMethodChaining("log2",log2);addMethodChaining("sqrt",sqrt);addMethodChaining("inverseSqrt",inverseSqrt);addMethodChaining("floor",floor);addMethodChaining("ceil",ceil);addMethodChaining("normalize",normalize);addMethodChaining("fract",fract);addMethodChaining("sin",sin);addMethodChaining("cos",cos);addMethodChaining("tan",tan);addMethodChaining("asin",asin);addMethodChaining("acos",acos);addMethodChaining("atan",atan);addMethodChaining("abs",abs);addMethodChaining("sign",sign);addMethodChaining("length",length);addMethodChaining("lengthSq",lengthSq);addMethodChaining("negate",negate);addMethodChaining("oneMinus",oneMinus);addMethodChaining("dFdx",dFdx);addMethodChaining("dFdy",dFdy);addMethodChaining("round",round);addMethodChaining("reciprocal",reciprocal);addMethodChaining("trunc",trunc);addMethodChaining("fwidth",fwidth);addMethodChaining("atan2",atan2);addMethodChaining("min",min$1);addMethodChaining("max",max$1);addMethodChaining("mod",mod);addMethodChaining("step",step);addMethodChaining("reflect",reflect);addMethodChaining("distance",distance$1);addMethodChaining("dot",dot);addMethodChaining("cross",cross);addMethodChaining("pow",pow);addMethodChaining("pow2",pow2);addMethodChaining("pow3",pow3);addMethodChaining("pow4",pow4);addMethodChaining("transformDirection",transformDirection);addMethodChaining("mix",mixElement);addMethodChaining("clamp",clamp$2);addMethodChaining("refract",refract);addMethodChaining("smoothstep",smoothstepElement);addMethodChaining("faceForward",faceForward);addMethodChaining("difference",difference);addMethodChaining("saturate",saturate$1);addMethodChaining("cbrt",cbrt);addMethodChaining("transpose",transpose);addMethodChaining("rand",rand);class ConditionalNode extends Node$1{static get type(){return"ConditionalNode"}constructor(_e,et,rt=null){super(),this.condNode=_e,this.ifNode=et,this.elseNode=rt}getNodeType(_e){const et=this.ifNode.getNodeType(_e);if(this.elseNode!==null){const rt=this.elseNode.getNodeType(_e);if(_e.getTypeLength(rt)>_e.getTypeLength(et))return rt}return et}setup(_e){const et=this.condNode.cache(),rt=this.ifNode.cache(),it=this.elseNode?this.elseNode.cache():null,st=_e.context.nodeBlock;_e.getDataFromNode(rt).parentNodeBlock=st,it!==null&&(_e.getDataFromNode(it).parentNodeBlock=st);const ot=_e.getNodeProperties(this);ot.condNode=et,ot.ifNode=rt.context({nodeBlock:rt}),ot.elseNode=it?it.context({nodeBlock:it}):null}generate(_e,et){const rt=this.getNodeType(_e),it=_e.getDataFromNode(this);if(it.nodeProperty!==void 0)return it.nodeProperty;const{condNode:st,ifNode:ot,elseNode:at}=_e.getNodeProperties(this),lt=et!=="void",ct=lt?property(rt).build(_e):"";it.nodeProperty=ct;const ut=st.build(_e,"bool");_e.addFlowCode(`
${_e.tab}if ( ${ut} ) {

`).addFlowTab();let ht=ot.build(_e,rt);if(ht&&(lt?ht=ct+" = "+ht+";":ht="return "+ht+";"),_e.removeFlowTab().addFlowCode(_e.tab+"	"+ht+`

`+_e.tab+"}"),at!==null){_e.addFlowCode(` else {

`).addFlowTab();let dt=at.build(_e,rt);dt&&(lt?dt=ct+" = "+dt+";":dt="return "+dt+";"),_e.removeFlowTab().addFlowCode(_e.tab+"	"+dt+`

`+_e.tab+`}

`)}else _e.addFlowCode(`

`);return _e.format(ct,rt,et)}}const select=nodeProxy(ConditionalNode);addMethodChaining("select",select);const cond=(...nt)=>(console.warn("TSL.ConditionalNode: cond() has been renamed to select()."),select(...nt));addMethodChaining("cond",cond);class ContextNode extends Node$1{static get type(){return"ContextNode"}constructor(_e,et={}){super(),this.isContextNode=!0,this.node=_e,this.value=et}getScope(){return this.node.getScope()}getNodeType(_e){return this.node.getNodeType(_e)}analyze(_e){this.node.build(_e)}setup(_e){const et=_e.getContext();_e.setContext({..._e.context,...this.value});const rt=this.node.build(_e);return _e.setContext(et),rt}generate(_e,et){const rt=_e.getContext();_e.setContext({..._e.context,...this.value});const it=this.node.build(_e,et);return _e.setContext(rt),it}}const context$1=nodeProxy(ContextNode),label=(nt,_e)=>context$1(nt,{label:_e});addMethodChaining("context",context$1);addMethodChaining("label",label);class VarNode extends Node$1{static get type(){return"VarNode"}constructor(_e,et=null){super(),this.node=_e,this.name=et,this.global=!0,this.isVarNode=!0}getHash(_e){return this.name||super.getHash(_e)}getNodeType(_e){return this.node.getNodeType(_e)}generate(_e){const{node:et,name:rt}=this,it=_e.getVarFromNode(this,rt,_e.getVectorType(this.getNodeType(_e))),st=_e.getPropertyName(it),ot=et.build(_e,it.type);return _e.addLineFlowCode(`${st} = ${ot}`,this),st}}const temp=nodeProxy(VarNode);addMethodChaining("temp",temp);addMethodChaining("toVar",(...nt)=>temp(...nt).append());class VaryingNode extends Node$1{static get type(){return"VaryingNode"}constructor(_e,et=null){super(),this.node=_e,this.name=et,this.isVaryingNode=!0}isGlobal(){return!0}getHash(_e){return this.name||super.getHash(_e)}getNodeType(_e){return this.node.getNodeType(_e)}setupVarying(_e){const et=_e.getNodeProperties(this);let rt=et.varying;if(rt===void 0){const it=this.name,st=this.getNodeType(_e);et.varying=rt=_e.getVaryingFromNode(this,it,st),et.node=this.node}return rt.needsInterpolation||(rt.needsInterpolation=_e.shaderStage==="fragment"),rt}setup(_e){this.setupVarying(_e)}analyze(_e){return this.setupVarying(_e),this.node.analyze(_e)}generate(_e){const et=_e.getNodeProperties(this),rt=this.setupVarying(_e);if(et.propertyName===void 0){const it=this.getNodeType(_e),st=_e.getPropertyName(rt,NodeShaderStage.VERTEX);_e.flowNodeFromShaderStage(NodeShaderStage.VERTEX,this.node,it,st),et.propertyName=st}return _e.getPropertyName(rt)}}const varying=nodeProxy(VaryingNode);addMethodChaining("varying",varying);const WORKING_COLOR_SPACE="WorkingColorSpace",OUTPUT_COLOR_SPACE="OutputColorSpace";function getColorSpaceName(nt){let _e=null;return nt===LinearSRGBColorSpace?_e="Linear":nt===SRGBColorSpace&&(_e="sRGB"),_e}function getColorSpaceMethod(nt,_e){return getColorSpaceName(nt)+"To"+getColorSpaceName(_e)}class ColorSpaceNode extends TempNode{static get type(){return"ColorSpaceNode"}constructor(_e,et,rt){super("vec4"),this.colorNode=_e,this.source=et,this.target=rt}getColorSpace(_e,et){return et===WORKING_COLOR_SPACE?ColorManagement.workingColorSpace:et===OUTPUT_COLOR_SPACE?_e.context.outputColorSpace||_e.renderer.outputColorSpace:et}setup(_e){const{renderer:et}=_e,{colorNode:rt}=this,it=this.getColorSpace(_e,this.source),st=this.getColorSpace(_e,this.target);if(it===st)return rt;const ot=getColorSpaceMethod(it,st);let at=null;const lt=et.nodes.library.getColorSpaceFunction(ot);return lt!==null?at=vec4(lt(rt.rgb),rt.a):(console.error("ColorSpaceNode: Unsupported Color Space configuration.",ot),at=rt),at}}const toOutputColorSpace=nt=>nodeObject(new ColorSpaceNode(nodeObject(nt),WORKING_COLOR_SPACE,OUTPUT_COLOR_SPACE)),toWorkingColorSpace=nt=>nodeObject(new ColorSpaceNode(nodeObject(nt),OUTPUT_COLOR_SPACE,WORKING_COLOR_SPACE)),workingToColorSpace=(nt,_e)=>nodeObject(new ColorSpaceNode(nodeObject(nt),WORKING_COLOR_SPACE,_e)),colorSpaceToWorking=(nt,_e)=>nodeObject(new ColorSpaceNode(nodeObject(nt),_e,WORKING_COLOR_SPACE));addMethodChaining("toOutputColorSpace",toOutputColorSpace);addMethodChaining("toWorkingColorSpace",toWorkingColorSpace);addMethodChaining("workingToColorSpace",workingToColorSpace);addMethodChaining("colorSpaceToWorking",colorSpaceToWorking);let ReferenceElementNode$1=class extends ArrayElementNode{static get type(){return"ReferenceElementNode"}constructor(_e,et){super(_e,et),this.referenceNode=_e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(_e){const et=super.generate(_e),rt=this.referenceNode.getNodeType(),it=this.getNodeType();return _e.format(et,rt,it)}};class ReferenceBaseNode extends Node$1{static get type(){return"ReferenceBaseNode"}constructor(_e,et,rt=null,it=null){super(),this.property=_e,this.uniformType=et,this.object=rt,this.count=it,this.properties=_e.split("."),this.reference=rt,this.node=null,this.group=null,this.updateType=NodeUpdateType.OBJECT}setGroup(_e){return this.group=_e,this}element(_e){return nodeObject(new ReferenceElementNode$1(this,nodeObject(_e)))}setNodeType(_e){const et=uniform(null,_e).getSelf();this.group!==null&&et.setGroup(this.group),this.node=et}getNodeType(_e){return this.node===null&&(this.updateReference(_e),this.updateValue()),this.node.getNodeType(_e)}getValueFromReference(_e=this.reference){const{properties:et}=this;let rt=_e[et[0]];for(let it=1;it<et.length;it++)rt=rt[et[it]];return rt}updateReference(_e){return this.reference=this.object!==null?this.object:_e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const _e=this.getValueFromReference();Array.isArray(_e)?this.node.array=_e:this.node.value=_e}}const reference$1=(nt,_e,et)=>nodeObject(new ReferenceBaseNode(nt,_e,et));class RendererReferenceNode extends ReferenceBaseNode{static get type(){return"RendererReferenceNode"}constructor(_e,et,rt=null){super(_e,et,rt),this.renderer=rt,this.setGroup(renderGroup)}updateReference(_e){return this.reference=this.renderer!==null?this.renderer:_e.renderer,this.reference}}const rendererReference=(nt,_e,et)=>nodeObject(new RendererReferenceNode(nt,_e,et));class ToneMappingNode extends TempNode{static get type(){return"ToneMappingNode"}constructor(_e,et=toneMappingExposure,rt=null){super("vec3"),this.toneMapping=_e,this.exposureNode=et,this.colorNode=rt}getCacheKey(){return hash$1(super.getCacheKey(),this.toneMapping)}setup(_e){const et=this.colorNode||_e.context.color,rt=this.toneMapping;if(rt===NoToneMapping)return et;let it=null;const st=_e.renderer.nodes.library.getToneMappingFunction(rt);return st!==null?it=vec4(st(et.rgb,this.exposureNode),et.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",rt),it=et),it}}const toneMapping=(nt,_e,et)=>nodeObject(new ToneMappingNode(nt,nodeObject(_e),nodeObject(et))),toneMappingExposure=rendererReference("toneMappingExposure","float");addMethodChaining("toneMapping",(nt,_e,et)=>toneMapping(_e,et,nt));class BufferAttributeNode extends InputNode{static get type(){return"BufferAttributeNode"}constructor(_e,et=null,rt=0,it=0){super(_e,et),this.isBufferNode=!0,this.bufferType=et,this.bufferStride=rt,this.bufferOffset=it,this.usage=StaticDrawUsage,this.instanced=!1,this.attribute=null,this.global=!0,_e&&_e.isBufferAttribute===!0&&(this.attribute=_e,this.usage=_e.usage,this.instanced=_e.isInstancedBufferAttribute)}getHash(_e){if(this.bufferStride===0&&this.bufferOffset===0){let et=_e.globalCache.getData(this.value);return et===void 0&&(et={node:this},_e.globalCache.setData(this.value,et)),et.node.uuid}return this.uuid}getNodeType(_e){return this.bufferType===null&&(this.bufferType=_e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(_e){if(this.attribute!==null)return;const et=this.getNodeType(_e),rt=this.value,it=_e.getTypeLength(et),st=this.bufferStride||it,ot=this.bufferOffset,at=rt.isInterleavedBuffer===!0?rt:new InterleavedBuffer(rt,st),lt=new InterleavedBufferAttribute(at,it,ot);at.setUsage(this.usage),this.attribute=lt,this.attribute.isInstancedBufferAttribute=this.instanced}generate(_e){const et=this.getNodeType(_e),rt=_e.getBufferAttributeFromNode(this,et),it=_e.getPropertyName(rt);let st=null;return _e.shaderStage==="vertex"||_e.shaderStage==="compute"?(this.name=it,st=it):st=varying(this).build(_e,et),st}getInputType(){return"bufferAttribute"}setUsage(_e){return this.usage=_e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=_e),this}setInstanced(_e){return this.instanced=_e,this}}const bufferAttribute=(nt,_e,et,rt)=>nodeObject(new BufferAttributeNode(nt,_e,et,rt)),dynamicBufferAttribute=(nt,_e,et,rt)=>bufferAttribute(nt,_e,et,rt).setUsage(DynamicDrawUsage),instancedBufferAttribute=(nt,_e,et,rt)=>bufferAttribute(nt,_e,et,rt).setInstanced(!0),instancedDynamicBufferAttribute=(nt,_e,et,rt)=>dynamicBufferAttribute(nt,_e,et,rt).setInstanced(!0);addMethodChaining("toAttribute",nt=>bufferAttribute(nt.value));class ComputeNode extends Node$1{static get type(){return"ComputeNode"}constructor(_e,et,rt=[64]){super("void"),this.isComputeNode=!0,this.computeNode=_e,this.count=et,this.workgroupSize=rt,this.dispatchCount=0,this.version=1,this.updateBeforeType=NodeUpdateType.OBJECT,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_e){_e===!0&&this.version++}updateDispatchCount(){const{count:_e,workgroupSize:et}=this;let rt=et[0];for(let it=1;it<et.length;it++)rt*=et[it];this.dispatchCount=Math.ceil(_e/rt)}onInit(){}updateBefore({renderer:_e}){_e.compute(this)}generate(_e){const{shaderStage:et}=_e;if(et==="compute"){const rt=this.computeNode.build(_e,"void");rt!==""&&_e.addLineFlowCode(rt,this)}}}const compute=(nt,_e,et)=>nodeObject(new ComputeNode(nodeObject(nt),_e,et));addMethodChaining("compute",compute);class CacheNode extends Node$1{static get type(){return"CacheNode"}constructor(_e,et=!0){super(),this.node=_e,this.parent=et,this.isCacheNode=!0}getNodeType(_e){return this.node.getNodeType(_e)}build(_e,...et){const rt=_e.getCache(),it=_e.getCacheFromNode(this,this.parent);_e.setCache(it);const st=this.node.build(_e,...et);return _e.setCache(rt),st}}const cache$2=(nt,..._e)=>nodeObject(new CacheNode(nodeObject(nt),..._e));addMethodChaining("cache",cache$2);class BypassNode extends Node$1{static get type(){return"BypassNode"}constructor(_e,et){super(),this.isBypassNode=!0,this.outputNode=_e,this.callNode=et}getNodeType(_e){return this.outputNode.getNodeType(_e)}generate(_e){const et=this.callNode.build(_e,"void");return et!==""&&_e.addLineFlowCode(et,this),this.outputNode.build(_e)}}const bypass=nodeProxy(BypassNode);addMethodChaining("bypass",bypass);class RemapNode extends Node$1{static get type(){return"RemapNode"}constructor(_e,et,rt,it=float(0),st=float(1)){super(),this.node=_e,this.inLowNode=et,this.inHighNode=rt,this.outLowNode=it,this.outHighNode=st,this.doClamp=!0}setup(){const{node:_e,inLowNode:et,inHighNode:rt,outLowNode:it,outHighNode:st,doClamp:ot}=this;let at=_e.sub(et).div(rt.sub(et));return ot===!0&&(at=at.clamp()),at.mul(st.sub(it)).add(it)}}const remap=nodeProxy(RemapNode,null,null,{doClamp:!1}),remapClamp=nodeProxy(RemapNode);addMethodChaining("remap",remap);addMethodChaining("remapClamp",remapClamp);class ExpressionNode extends Node$1{static get type(){return"ExpressionNode"}constructor(_e="",et="void"){super(et),this.snippet=_e}generate(_e,et){const rt=this.getNodeType(_e),it=this.snippet;if(rt==="void")_e.addLineFlowCode(it,this);else return _e.format(`( ${it} )`,rt,et)}}const expression=nodeProxy(ExpressionNode),Discard=nt=>(nt?select(nt,expression("discard")):expression("discard")).append();addMethodChaining("discard",Discard);class RenderOutputNode extends TempNode{static get type(){return"RenderOutputNode"}constructor(_e,et,rt){super("vec4"),this.colorNode=_e,this.toneMapping=et,this.outputColorSpace=rt,this.isRenderOutput=!0}setup({context:_e}){let et=this.colorNode||_e.color;const rt=(this.toneMapping!==null?this.toneMapping:_e.toneMapping)||NoToneMapping,it=(this.outputColorSpace!==null?this.outputColorSpace:_e.outputColorSpace)||NoColorSpace;return rt!==NoToneMapping&&(et=et.toneMapping(rt)),it!==NoColorSpace&&it!==ColorManagement.workingColorSpace&&(et=et.workingToColorSpace(it)),et}}const renderOutput=(nt,_e=null,et=null)=>nodeObject(new RenderOutputNode(nodeObject(nt),_e,et));addMethodChaining("renderOutput",renderOutput);class AttributeNode extends Node$1{static get type(){return"AttributeNode"}constructor(_e,et=null){super(et),this.global=!0,this._attributeName=_e}getHash(_e){return this.getAttributeName(_e)}getNodeType(_e){let et=this.nodeType;if(et===null){const rt=this.getAttributeName(_e);if(_e.hasGeometryAttribute(rt)){const it=_e.geometry.getAttribute(rt);et=_e.getTypeFromAttribute(it)}else et="float"}return et}setAttributeName(_e){return this._attributeName=_e,this}getAttributeName(){return this._attributeName}generate(_e){const et=this.getAttributeName(_e),rt=this.getNodeType(_e);if(_e.hasGeometryAttribute(et)===!0){const st=_e.geometry.getAttribute(et),ot=_e.getTypeFromAttribute(st),at=_e.getAttribute(et,ot);return _e.shaderStage==="vertex"?_e.format(at.name,ot,rt):varying(this).build(_e,rt)}else return console.warn(`AttributeNode: Vertex attribute "${et}" not found on geometry.`),_e.generateConst(rt)}serialize(_e){super.serialize(_e),_e.global=this.global,_e._attributeName=this._attributeName}deserialize(_e){super.deserialize(_e),this.global=_e.global,this._attributeName=_e._attributeName}}const attribute=(nt,_e)=>nodeObject(new AttributeNode(nt,_e)),uv=nt=>attribute("uv"+(nt>0?nt:""),"vec2");class TextureSizeNode extends Node$1{static get type(){return"TextureSizeNode"}constructor(_e,et=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=_e,this.levelNode=et}generate(_e,et){const rt=this.textureNode.build(_e,"property"),it=this.levelNode===null?"0":this.levelNode.build(_e,"int");return _e.format(`${_e.getMethod("textureDimensions")}( ${rt}, ${it} )`,this.getNodeType(_e),et)}}const textureSize=nodeProxy(TextureSizeNode);class MaxMipLevelNode extends UniformNode{static get type(){return"MaxMipLevelNode"}constructor(_e){super(0),this._textureNode=_e,this.updateType=NodeUpdateType.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const _e=this.texture,et=_e.images,rt=et&&et.length>0?et[0]&&et[0].image||et[0]:_e.image;if(rt&&rt.width!==void 0){const{width:it,height:st}=rt;this.value=Math.log2(Math.max(it,st))}}}const maxMipLevel=nodeProxy(MaxMipLevelNode);class TextureNode extends UniformNode{static get type(){return"TextureNode"}constructor(_e,et=null,rt=null,it=null){super(_e),this.isTextureNode=!0,this.uvNode=et,this.levelNode=rt,this.biasNode=it,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=NodeUpdateType.NONE,this.referenceNode=null,this._value=_e,this._matrixUniform=null,this.setUpdateMatrix(et===null)}set value(_e){this.referenceNode?this.referenceNode.value=_e:this._value=_e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===UnsignedIntType?"uvec4":this.value.type===IntType?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return uv(this.value.channel)}updateReference(){return this.value}getTransformedUV(_e){return this._matrixUniform===null&&(this._matrixUniform=uniform(this.value.matrix)),this._matrixUniform.mul(vec3(_e,1)).xy}setUpdateMatrix(_e){return this.updateMatrix=_e,this.updateType=_e?NodeUpdateType.FRAME:NodeUpdateType.NONE,this}setupUV(_e,et){const rt=this.value;return _e.isFlipY()&&(rt.isRenderTargetTexture===!0||rt.isFramebufferTexture===!0||rt.isDepthTexture===!0)&&(this.sampler?et=et.flipY():et=et.setY(int$1(textureSize(this,this.levelNode).y).sub(et.y).sub(1))),et}setup(_e){const et=_e.getNodeProperties(this);et.referenceNode=this.referenceNode;let rt=this.uvNode;(rt===null||_e.context.forceUVContext===!0)&&_e.context.getUV&&(rt=_e.context.getUV(this)),rt||(rt=this.getDefaultUV()),this.updateMatrix===!0&&(rt=this.getTransformedUV(rt)),rt=this.setupUV(_e,rt);let it=this.levelNode;it===null&&_e.context.getTextureLevel&&(it=_e.context.getTextureLevel(this)),et.uvNode=rt,et.levelNode=it,et.biasNode=this.biasNode,et.compareNode=this.compareNode,et.gradNode=this.gradNode,et.depthNode=this.depthNode}generateUV(_e,et){return et.build(_e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(_e,et,rt,it,st,ot,at,lt){const ct=this.value;let ut;return it?ut=_e.generateTextureLevel(ct,et,rt,it,ot):st?ut=_e.generateTextureBias(ct,et,rt,st,ot):lt?ut=_e.generateTextureGrad(ct,et,rt,lt,ot):at?ut=_e.generateTextureCompare(ct,et,rt,at,ot):this.sampler===!1?ut=_e.generateTextureLoad(ct,et,rt,ot):ut=_e.generateTexture(ct,et,rt,ot),ut}generate(_e,et){const rt=_e.getNodeProperties(this),it=this.value;if(!it||it.isTexture!==!0)throw new Error("TextureNode: Need a three.js texture.");const st=super.generate(_e,"property");if(et==="sampler")return st+"_sampler";if(_e.isReference(et))return st;{const ot=_e.getDataFromNode(this);let at=ot.propertyName;if(at===void 0){const{uvNode:ut,levelNode:ht,biasNode:dt,compareNode:ft,depthNode:pt,gradNode:mt}=rt,At=this.generateUV(_e,ut),gt=ht?ht.build(_e,"float"):null,bt=dt?dt.build(_e,"float"):null,Tt=pt?pt.build(_e,"int"):null,wt=ft?ft.build(_e,"float"):null,Rt=mt?[mt[0].build(_e,"vec2"),mt[1].build(_e,"vec2")]:null,It=_e.getVarFromNode(this);at=_e.getPropertyName(It);const Lt=this.generateSnippet(_e,st,At,gt,bt,Tt,wt,Rt);_e.addLineFlowCode(`${at} = ${Lt}`,this),ot.snippet=Lt,ot.propertyName=at}let lt=at;const ct=this.getNodeType(_e);return _e.needsToWorkingColorSpace(it)&&(lt=colorSpaceToWorking(expression(lt,ct),it.colorSpace).setup(_e).build(_e,ct)),_e.format(lt,ct,et)}}setSampler(_e){return this.sampler=_e,this}getSampler(){return this.sampler}uv(_e){const et=this.clone();return et.uvNode=nodeObject(_e),et.referenceNode=this.getSelf(),nodeObject(et)}blur(_e){const et=this.clone();return et.biasNode=nodeObject(_e).mul(maxMipLevel(et)),et.referenceNode=this.getSelf(),nodeObject(et)}level(_e){const et=this.clone();return et.levelNode=nodeObject(_e),et.referenceNode=this.getSelf(),nodeObject(et)}size(_e){return textureSize(this,_e)}bias(_e){const et=this.clone();return et.biasNode=nodeObject(_e),et.referenceNode=this.getSelf(),nodeObject(et)}compare(_e){const et=this.clone();return et.compareNode=nodeObject(_e),et.referenceNode=this.getSelf(),nodeObject(et)}grad(_e,et){const rt=this.clone();return rt.gradNode=[nodeObject(_e),nodeObject(et)],rt.referenceNode=this.getSelf(),nodeObject(rt)}depth(_e){const et=this.clone();return et.depthNode=nodeObject(_e),et.referenceNode=this.getSelf(),nodeObject(et)}serialize(_e){super.serialize(_e),_e.value=this.value.toJSON(_e.meta).uuid,_e.sampler=this.sampler,_e.updateMatrix=this.updateMatrix,_e.updateType=this.updateType}deserialize(_e){super.deserialize(_e),this.value=_e.meta.textures[_e.value],this.sampler=_e.sampler,this.updateMatrix=_e.updateMatrix,this.updateType=_e.updateType}update(){const _e=this.value,et=this._matrixUniform;et!==null&&(et.value=_e.matrix),_e.matrixAutoUpdate===!0&&_e.updateMatrix()}clone(){const _e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return _e.sampler=this.sampler,_e}}const texture=nodeProxy(TextureNode),textureLoad=(...nt)=>texture(...nt).setSampler(!1),cameraNear=uniform("float").label("cameraNear").setGroup(renderGroup).onRenderUpdate(({camera:nt})=>nt.near),cameraFar=uniform("float").label("cameraFar").setGroup(renderGroup).onRenderUpdate(({camera:nt})=>nt.far),cameraLogDepth=uniform("float").label("cameraLogDepth").setGroup(renderGroup).onRenderUpdate(({camera:nt})=>2/(Math.log(nt.far+1)/Math.LN2)),cameraProjectionMatrix=uniform("mat4").label("cameraProjectionMatrix").setGroup(renderGroup).onRenderUpdate(({camera:nt})=>nt.projectionMatrix),cameraViewMatrix=uniform("mat4").label("cameraViewMatrix").setGroup(renderGroup).onRenderUpdate(({camera:nt})=>nt.matrixWorldInverse),cameraPosition=uniform(new Vector3).label("cameraPosition").setGroup(renderGroup).onRenderUpdate(({camera:nt},_e)=>_e.value.setFromMatrixPosition(nt.matrixWorld));class Object3DNode extends Node$1{static get type(){return"Object3DNode"}constructor(_e,et=null){super(),this.scope=_e,this.object3d=et,this.updateType=NodeUpdateType.OBJECT,this._uniformNode=new UniformNode(null)}getNodeType(){const _e=this.scope;if(_e===Object3DNode.WORLD_MATRIX)return"mat4";if(_e===Object3DNode.POSITION||_e===Object3DNode.VIEW_POSITION||_e===Object3DNode.DIRECTION||_e===Object3DNode.SCALE)return"vec3"}update(_e){const et=this.object3d,rt=this._uniformNode,it=this.scope;if(it===Object3DNode.WORLD_MATRIX)rt.value=et.matrixWorld;else if(it===Object3DNode.POSITION)rt.value=rt.value||new Vector3,rt.value.setFromMatrixPosition(et.matrixWorld);else if(it===Object3DNode.SCALE)rt.value=rt.value||new Vector3,rt.value.setFromMatrixScale(et.matrixWorld);else if(it===Object3DNode.DIRECTION)rt.value=rt.value||new Vector3,et.getWorldDirection(rt.value);else if(it===Object3DNode.VIEW_POSITION){const st=_e.camera;rt.value=rt.value||new Vector3,rt.value.setFromMatrixPosition(et.matrixWorld),rt.value.applyMatrix4(st.matrixWorldInverse)}}generate(_e){const et=this.scope;return et===Object3DNode.WORLD_MATRIX?this._uniformNode.nodeType="mat4":(et===Object3DNode.POSITION||et===Object3DNode.VIEW_POSITION||et===Object3DNode.DIRECTION||et===Object3DNode.SCALE)&&(this._uniformNode.nodeType="vec3"),this._uniformNode.build(_e)}serialize(_e){super.serialize(_e),_e.scope=this.scope}deserialize(_e){super.deserialize(_e),this.scope=_e.scope}}Object3DNode.WORLD_MATRIX="worldMatrix";Object3DNode.POSITION="position";Object3DNode.SCALE="scale";Object3DNode.VIEW_POSITION="viewPosition";Object3DNode.DIRECTION="direction";Object3DNode.DIRECTION;Object3DNode.WORLD_MATRIX;Object3DNode.POSITION;Object3DNode.SCALE;Object3DNode.VIEW_POSITION;class ModelNode extends Object3DNode{static get type(){return"ModelNode"}constructor(_e){super(_e)}update(_e){this.object3d=_e.object,super.update(_e)}}ModelNode.DIRECTION;const modelWorldMatrix=nodeImmutable(ModelNode,ModelNode.WORLD_MATRIX);ModelNode.POSITION;ModelNode.SCALE;ModelNode.VIEW_POSITION;const modelNormalMatrix=uniform(new Matrix3).onObjectUpdate(({object:nt},_e)=>_e.value.getNormalMatrix(nt.matrixWorld)),modelViewMatrix=cameraViewMatrix.mul(modelWorldMatrix).toVar("modelViewMatrix"),positionGeometry=attribute("position","vec3"),positionLocal=positionGeometry.varying("positionLocal"),positionPrevious=positionGeometry.varying("positionPrevious"),positionWorld=modelWorldMatrix.mul(positionLocal).xyz.varying("v_positionWorld"),positionWorldDirection=positionLocal.transformDirection(modelWorldMatrix).varying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),positionView=modelViewMatrix.mul(positionLocal).xyz.varying("v_positionView"),positionViewDirection=positionView.negate().varying("v_positionViewDirection").normalize().toVar("positionViewDirection");class FrontFacingNode extends Node$1{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(_e){const{renderer:et,material:rt}=_e;return et.coordinateSystem===WebGLCoordinateSystem&&rt.side===BackSide?"false":_e.getFrontFacing()}}const frontFacing=nodeImmutable(FrontFacingNode),faceDirection=float(frontFacing).mul(2).sub(1),normalGeometry=attribute("normal","vec3"),normalLocal=Fn(nt=>nt.geometry.hasAttribute("normal")===!1?(console.warn('TSL.NormalNode: Vertex attribute "normal" not found on geometry.'),vec3(0,1,0)):normalGeometry,"vec3").once()().toVar("normalLocal"),normalFlat=positionView.dFdx().cross(positionView.dFdy()).normalize().toVar("normalFlat"),normalView=Fn(nt=>{let _e;return nt.material.flatShading===!0?_e=normalFlat:_e=varying(transformNormalToView(normalLocal),"v_normalView").normalize(),_e},"vec3").once()().toVar("normalView"),normalWorld=varying(normalView.transformDirection(cameraViewMatrix),"v_normalWorld").normalize().toVar("normalWorld"),transformedNormalView=Fn(nt=>nt.context.setupNormal(),"vec3").once()().mul(faceDirection).toVar("transformedNormalView"),transformedNormalWorld=transformedNormalView.transformDirection(cameraViewMatrix).toVar("transformedNormalWorld"),transformedClearcoatNormalView=Fn(nt=>nt.context.setupClearcoatNormal(),"vec3").once()().mul(faceDirection).toVar("transformedClearcoatNormalView"),transformNormal=Fn(([nt,_e=modelWorldMatrix])=>{const et=mat3(_e),rt=nt.div(vec3(et[0].dot(et[0]),et[1].dot(et[1]),et[2].dot(et[2])));return et.mul(rt).xyz}),transformNormalToView=Fn(([nt],_e)=>{const et=_e.renderer.nodes.modelNormalViewMatrix;if(et!==null)return et.transformDirection(nt);const rt=modelNormalMatrix.mul(nt);return cameraViewMatrix.transformDirection(rt)}),materialRefractionRatio=uniform(0).onReference(({material:nt})=>nt).onRenderUpdate(({material:nt})=>nt.refractionRatio),reflectView=positionViewDirection.negate().reflect(transformedNormalView),refractView=positionViewDirection.negate().refract(transformedNormalView,materialRefractionRatio),reflectVector=reflectView.transformDirection(cameraViewMatrix).toVar("reflectVector"),refractVector=refractView.transformDirection(cameraViewMatrix).toVar("reflectVector");class CubeTextureNode extends TextureNode{static get type(){return"CubeTextureNode"}constructor(_e,et=null,rt=null,it=null){super(_e,et,rt,it),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const _e=this.value;return _e.mapping===CubeReflectionMapping?reflectVector:_e.mapping===CubeRefractionMapping?refractVector:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',_e.mapping),vec3(0,0,0))}setUpdateMatrix(){}setupUV(_e,et){const rt=this.value;return _e.renderer.coordinateSystem===WebGPUCoordinateSystem||!rt.isRenderTargetTexture?vec3(et.x.negate(),et.yz):et}generateUV(_e,et){return et.build(_e,"vec3")}}const cubeTexture=nodeProxy(CubeTextureNode);class BufferNode extends UniformNode{static get type(){return"BufferNode"}constructor(_e,et,rt=0){super(_e,et),this.isBufferNode=!0,this.bufferType=et,this.bufferCount=rt}getElementType(_e){return this.getNodeType(_e)}getInputType(){return"buffer"}}const buffer=(nt,_e,et)=>nodeObject(new BufferNode(nt,_e,et));class UniformArrayElementNode extends ArrayElementNode{static get type(){return"UniformArrayElementNode"}constructor(_e,et){super(_e,et),this.isArrayBufferElementNode=!0}generate(_e){const et=super.generate(_e),rt=this.getNodeType();return _e.format(et,"vec4",rt)}}class UniformArrayNode extends BufferNode{static get type(){return"UniformArrayNode"}constructor(_e,et=null){super(null,"vec4"),this.array=_e,this.elementType=et,this._elementType=null,this._elementLength=0,this.updateType=NodeUpdateType.RENDER,this.isArrayBufferNode=!0}getElementType(){return this.elementType||this._elementType}getElementLength(){return this._elementLength}update(){const{array:_e,value:et}=this,rt=this.getElementLength(),it=this.getElementType();if(rt===1)for(let st=0;st<_e.length;st++){const ot=st*4;et[ot]=_e[st]}else if(it==="color")for(let st=0;st<_e.length;st++){const ot=st*4,at=_e[st];et[ot]=at.r,et[ot+1]=at.g,et[ot+2]=at.b||0}else for(let st=0;st<_e.length;st++){const ot=st*4,at=_e[st];et[ot]=at.x,et[ot+1]=at.y,et[ot+2]=at.z||0,et[ot+3]=at.w||0}}setup(_e){const et=this.array.length;this._elementType=this.elementType===null?getValueType(this.array[0]):this.elementType,this._elementLength=_e.getTypeLength(this._elementType);let rt=Float32Array;return this._elementType.charAt(0)==="i"?rt=Int32Array:this._elementType.charAt(0)==="u"&&(rt=Uint32Array),this.value=new rt(et*4),this.bufferCount=et,this.bufferType=_e.changeComponentType("vec4",_e.getComponentType(this._elementType)),super.setup(_e)}element(_e){return nodeObject(new UniformArrayElementNode(this,nodeObject(_e)))}}const uniformArray=(nt,_e)=>nodeObject(new UniformArrayNode(nt,_e));class ReferenceElementNode extends ArrayElementNode{static get type(){return"ReferenceElementNode"}constructor(_e,et){super(_e,et),this.referenceNode=_e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(_e){const et=super.generate(_e),rt=this.referenceNode.getNodeType(),it=this.getNodeType();return _e.format(et,rt,it)}}class ReferenceNode extends Node$1{static get type(){return"ReferenceNode"}constructor(_e,et,rt=null,it=null){super(),this.property=_e,this.uniformType=et,this.object=rt,this.count=it,this.properties=_e.split("."),this.reference=rt,this.node=null,this.group=null,this.name=null,this.updateType=NodeUpdateType.OBJECT}element(_e){return nodeObject(new ReferenceElementNode(this,nodeObject(_e)))}setGroup(_e){return this.group=_e,this}label(_e){return this.name=_e,this}setNodeType(_e){let et=null;this.count!==null?et=buffer(null,_e,this.count):Array.isArray(this.getValueFromReference())?et=uniformArray(null,_e):_e==="texture"?et=texture(null):_e==="cubeTexture"?et=cubeTexture(null):et=uniform(null,_e),this.group!==null&&et.setGroup(this.group),this.name!==null&&et.label(this.name),this.node=et.getSelf()}getNodeType(_e){return this.node===null&&(this.updateReference(_e),this.updateValue()),this.node.getNodeType(_e)}getValueFromReference(_e=this.reference){const{properties:et}=this;let rt=_e[et[0]];for(let it=1;it<et.length;it++)rt=rt[et[it]];return rt}updateReference(_e){return this.reference=this.object!==null?this.object:_e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const _e=this.getValueFromReference();Array.isArray(_e)?this.node.array=_e:this.node.value=_e}}const reference=(nt,_e,et)=>nodeObject(new ReferenceNode(nt,_e,et)),referenceBuffer=(nt,_e,et,rt)=>nodeObject(new ReferenceNode(nt,_e,rt,et));class MaterialReferenceNode extends ReferenceNode{static get type(){return"MaterialReferenceNode"}constructor(_e,et,rt=null){super(_e,et,rt),this.material=rt,this.isMaterialReferenceNode=!0}updateReference(_e){return this.reference=this.material!==null?this.material:_e.material,this.reference}}const materialReference=(nt,_e,et)=>nodeObject(new MaterialReferenceNode(nt,_e,et)),tangentGeometry=Fn(nt=>(nt.geometry.hasAttribute("tangent")===!1&&nt.geometry.computeTangents(),attribute("tangent","vec4")))(),tangentLocal=tangentGeometry.xyz.toVar("tangentLocal"),tangentView=modelViewMatrix.mul(vec4(tangentLocal,0)).xyz.varying("v_tangentView").normalize().toVar("tangentView"),getBitangent=nt=>nt.mul(tangentGeometry.w).xyz,bitangentView=varying(getBitangent(normalView.cross(tangentView)),"v_bitangentView").normalize().toVar("bitangentView"),TBNViewMatrix=mat3(tangentView,bitangentView,normalView),transformedBentNormalView=(()=>{let nt=anisotropyB.cross(positionViewDirection);return nt=nt.cross(anisotropyB).normalize(),nt=mix$2(nt,transformedNormalView,anisotropy.mul(roughness.oneMinus()).oneMinus().pow2().pow2()).normalize(),nt})(),perturbNormal2Arb=Fn(nt=>{const{eye_pos:_e,surf_norm:et,mapN:rt,uv:it}=nt,st=_e.dFdx(),ot=_e.dFdy(),at=it.dFdx(),lt=it.dFdy(),ct=et,ut=ot.cross(ct),ht=ct.cross(st),dt=ut.mul(at.x).add(ht.mul(lt.x)),ft=ut.mul(at.y).add(ht.mul(lt.y)),pt=dt.dot(dt).max(ft.dot(ft)),mt=faceDirection.mul(pt.inverseSqrt());return add(dt.mul(rt.x,mt),ft.mul(rt.y,mt),ct.mul(rt.z)).normalize()});class NormalMapNode extends TempNode{static get type(){return"NormalMapNode"}constructor(_e,et=null){super("vec3"),this.node=_e,this.scaleNode=et,this.normalMapType=TangentSpaceNormalMap}setup(_e){const{normalMapType:et,scaleNode:rt}=this;let it=this.node.mul(2).sub(1);rt!==null&&(it=vec3(it.xy.mul(rt),it.z));let st=null;return et===ObjectSpaceNormalMap?st=transformNormalToView(it):et===TangentSpaceNormalMap&&(_e.hasGeometryAttribute("tangent")===!0?st=TBNViewMatrix.mul(it).normalize():st=perturbNormal2Arb({eye_pos:positionView,surf_norm:normalView,mapN:it,uv:uv()})),st}}const normalMap=nodeProxy(NormalMapNode),dHdxy_fwd=Fn(({textureNode:nt,bumpScale:_e})=>{const et=it=>nt.cache().context({getUV:st=>it(st.uvNode||uv()),forceUVContext:!0}),rt=float(et(it=>it));return vec2(float(et(it=>it.add(it.dFdx()))).sub(rt),float(et(it=>it.add(it.dFdy()))).sub(rt)).mul(_e)}),perturbNormalArb=Fn(nt=>{const{surf_pos:_e,surf_norm:et,dHdxy:rt}=nt,it=_e.dFdx().normalize(),st=_e.dFdy().normalize(),ot=et,at=st.cross(ot),lt=ot.cross(it),ct=it.dot(at).mul(faceDirection),ut=ct.sign().mul(rt.x.mul(at).add(rt.y.mul(lt)));return ct.abs().mul(et).sub(ut).normalize()});class BumpMapNode extends TempNode{static get type(){return"BumpMapNode"}constructor(_e,et=null){super("vec3"),this.textureNode=_e,this.scaleNode=et}setup(){const _e=this.scaleNode!==null?this.scaleNode:1,et=dHdxy_fwd({textureNode:this.textureNode,bumpScale:_e});return perturbNormalArb({surf_pos:positionView,surf_norm:normalView,dHdxy:et})}}const bumpMap=nodeProxy(BumpMapNode),_propertyCache=new Map;class MaterialNode extends Node$1{static get type(){return"MaterialNode"}constructor(_e){super(),this.scope=_e}getCache(_e,et){let rt=_propertyCache.get(_e);return rt===void 0&&(rt=materialReference(_e,et),_propertyCache.set(_e,rt)),rt}getFloat(_e){return this.getCache(_e,"float")}getColor(_e){return this.getCache(_e,"color")}getTexture(_e){return this.getCache(_e==="map"?"map":_e+"Map","texture")}setup(_e){const et=_e.context.material,rt=this.scope;let it=null;if(rt===MaterialNode.COLOR){const st=et.color!==void 0?this.getColor(rt):vec3();et.map&&et.map.isTexture===!0?it=st.mul(this.getTexture("map")):it=st}else if(rt===MaterialNode.OPACITY){const st=this.getFloat(rt);et.alphaMap&&et.alphaMap.isTexture===!0?it=st.mul(this.getTexture("alpha")):it=st}else if(rt===MaterialNode.SPECULAR_STRENGTH)et.specularMap&&et.specularMap.isTexture===!0?it=this.getTexture("specular").r:it=float(1);else if(rt===MaterialNode.SPECULAR_INTENSITY){const st=this.getFloat(rt);et.specularMap?it=st.mul(this.getTexture(rt).a):it=st}else if(rt===MaterialNode.SPECULAR_COLOR){const st=this.getColor(rt);et.specularColorMap&&et.specularColorMap.isTexture===!0?it=st.mul(this.getTexture(rt).rgb):it=st}else if(rt===MaterialNode.ROUGHNESS){const st=this.getFloat(rt);et.roughnessMap&&et.roughnessMap.isTexture===!0?it=st.mul(this.getTexture(rt).g):it=st}else if(rt===MaterialNode.METALNESS){const st=this.getFloat(rt);et.metalnessMap&&et.metalnessMap.isTexture===!0?it=st.mul(this.getTexture(rt).b):it=st}else if(rt===MaterialNode.EMISSIVE){const st=this.getFloat("emissiveIntensity"),ot=this.getColor(rt).mul(st);et.emissiveMap&&et.emissiveMap.isTexture===!0?it=ot.mul(this.getTexture(rt)):it=ot}else if(rt===MaterialNode.NORMAL)et.normalMap?(it=normalMap(this.getTexture("normal"),this.getCache("normalScale","vec2")),it.normalMapType=et.normalMapType):et.bumpMap?it=bumpMap(this.getTexture("bump").r,this.getFloat("bumpScale")):it=normalView;else if(rt===MaterialNode.CLEARCOAT){const st=this.getFloat(rt);et.clearcoatMap&&et.clearcoatMap.isTexture===!0?it=st.mul(this.getTexture(rt).r):it=st}else if(rt===MaterialNode.CLEARCOAT_ROUGHNESS){const st=this.getFloat(rt);et.clearcoatRoughnessMap&&et.clearcoatRoughnessMap.isTexture===!0?it=st.mul(this.getTexture(rt).r):it=st}else if(rt===MaterialNode.CLEARCOAT_NORMAL)et.clearcoatNormalMap?it=normalMap(this.getTexture(rt),this.getCache(rt+"Scale","vec2")):it=normalView;else if(rt===MaterialNode.SHEEN){const st=this.getColor("sheenColor").mul(this.getFloat("sheen"));et.sheenColorMap&&et.sheenColorMap.isTexture===!0?it=st.mul(this.getTexture("sheenColor").rgb):it=st}else if(rt===MaterialNode.SHEEN_ROUGHNESS){const st=this.getFloat(rt);et.sheenRoughnessMap&&et.sheenRoughnessMap.isTexture===!0?it=st.mul(this.getTexture(rt).a):it=st,it=it.clamp(.07,1)}else if(rt===MaterialNode.ANISOTROPY)if(et.anisotropyMap&&et.anisotropyMap.isTexture===!0){const st=this.getTexture(rt);it=mat2(materialAnisotropyVector.x,materialAnisotropyVector.y,materialAnisotropyVector.y.negate(),materialAnisotropyVector.x).mul(st.rg.mul(2).sub(vec2(1)).normalize().mul(st.b))}else it=materialAnisotropyVector;else if(rt===MaterialNode.IRIDESCENCE_THICKNESS){const st=reference("1","float",et.iridescenceThicknessRange);if(et.iridescenceThicknessMap){const ot=reference("0","float",et.iridescenceThicknessRange);it=st.sub(ot).mul(this.getTexture(rt).g).add(ot)}else it=st}else if(rt===MaterialNode.TRANSMISSION){const st=this.getFloat(rt);et.transmissionMap?it=st.mul(this.getTexture(rt).r):it=st}else if(rt===MaterialNode.THICKNESS){const st=this.getFloat(rt);et.thicknessMap?it=st.mul(this.getTexture(rt).g):it=st}else if(rt===MaterialNode.IOR)it=this.getFloat(rt);else if(rt===MaterialNode.LIGHT_MAP)it=this.getTexture(rt).rgb.mul(this.getFloat("lightMapIntensity"));else if(rt===MaterialNode.AO_MAP)it=this.getTexture(rt).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const st=this.getNodeType(_e);it=this.getCache(rt,st)}return it}}MaterialNode.ALPHA_TEST="alphaTest";MaterialNode.COLOR="color";MaterialNode.OPACITY="opacity";MaterialNode.SHININESS="shininess";MaterialNode.SPECULAR="specular";MaterialNode.SPECULAR_STRENGTH="specularStrength";MaterialNode.SPECULAR_INTENSITY="specularIntensity";MaterialNode.SPECULAR_COLOR="specularColor";MaterialNode.REFLECTIVITY="reflectivity";MaterialNode.ROUGHNESS="roughness";MaterialNode.METALNESS="metalness";MaterialNode.NORMAL="normal";MaterialNode.CLEARCOAT="clearcoat";MaterialNode.CLEARCOAT_ROUGHNESS="clearcoatRoughness";MaterialNode.CLEARCOAT_NORMAL="clearcoatNormal";MaterialNode.EMISSIVE="emissive";MaterialNode.ROTATION="rotation";MaterialNode.SHEEN="sheen";MaterialNode.SHEEN_ROUGHNESS="sheenRoughness";MaterialNode.ANISOTROPY="anisotropy";MaterialNode.IRIDESCENCE="iridescence";MaterialNode.IRIDESCENCE_IOR="iridescenceIOR";MaterialNode.IRIDESCENCE_THICKNESS="iridescenceThickness";MaterialNode.IOR="ior";MaterialNode.TRANSMISSION="transmission";MaterialNode.THICKNESS="thickness";MaterialNode.ATTENUATION_DISTANCE="attenuationDistance";MaterialNode.ATTENUATION_COLOR="attenuationColor";MaterialNode.LINE_SCALE="scale";MaterialNode.LINE_DASH_SIZE="dashSize";MaterialNode.LINE_GAP_SIZE="gapSize";MaterialNode.LINE_WIDTH="linewidth";MaterialNode.LINE_DASH_OFFSET="dashOffset";MaterialNode.POINT_WIDTH="pointWidth";MaterialNode.DISPERSION="dispersion";MaterialNode.LIGHT_MAP="light";MaterialNode.AO_MAP="ao";const materialAlphaTest=nodeImmutable(MaterialNode,MaterialNode.ALPHA_TEST),materialColor=nodeImmutable(MaterialNode,MaterialNode.COLOR),materialShininess=nodeImmutable(MaterialNode,MaterialNode.SHININESS),materialEmissive=nodeImmutable(MaterialNode,MaterialNode.EMISSIVE),materialOpacity=nodeImmutable(MaterialNode,MaterialNode.OPACITY),materialSpecular=nodeImmutable(MaterialNode,MaterialNode.SPECULAR),materialSpecularIntensity=nodeImmutable(MaterialNode,MaterialNode.SPECULAR_INTENSITY),materialSpecularColor=nodeImmutable(MaterialNode,MaterialNode.SPECULAR_COLOR),materialSpecularStrength=nodeImmutable(MaterialNode,MaterialNode.SPECULAR_STRENGTH),materialReflectivity=nodeImmutable(MaterialNode,MaterialNode.REFLECTIVITY),materialRoughness=nodeImmutable(MaterialNode,MaterialNode.ROUGHNESS),materialMetalness=nodeImmutable(MaterialNode,MaterialNode.METALNESS),materialNormal=nodeImmutable(MaterialNode,MaterialNode.NORMAL).context({getUV:null}),materialClearcoat=nodeImmutable(MaterialNode,MaterialNode.CLEARCOAT),materialClearcoatRoughness=nodeImmutable(MaterialNode,MaterialNode.CLEARCOAT_ROUGHNESS),materialClearcoatNormal=nodeImmutable(MaterialNode,MaterialNode.CLEARCOAT_NORMAL).context({getUV:null}),materialRotation=nodeImmutable(MaterialNode,MaterialNode.ROTATION),materialSheen=nodeImmutable(MaterialNode,MaterialNode.SHEEN),materialSheenRoughness=nodeImmutable(MaterialNode,MaterialNode.SHEEN_ROUGHNESS),materialAnisotropy=nodeImmutable(MaterialNode,MaterialNode.ANISOTROPY),materialIridescence=nodeImmutable(MaterialNode,MaterialNode.IRIDESCENCE),materialIridescenceIOR=nodeImmutable(MaterialNode,MaterialNode.IRIDESCENCE_IOR),materialIridescenceThickness=nodeImmutable(MaterialNode,MaterialNode.IRIDESCENCE_THICKNESS),materialTransmission=nodeImmutable(MaterialNode,MaterialNode.TRANSMISSION),materialThickness=nodeImmutable(MaterialNode,MaterialNode.THICKNESS),materialIOR=nodeImmutable(MaterialNode,MaterialNode.IOR),materialAttenuationDistance=nodeImmutable(MaterialNode,MaterialNode.ATTENUATION_DISTANCE),materialAttenuationColor=nodeImmutable(MaterialNode,MaterialNode.ATTENUATION_COLOR),materialLineScale=nodeImmutable(MaterialNode,MaterialNode.LINE_SCALE),materialLineDashSize=nodeImmutable(MaterialNode,MaterialNode.LINE_DASH_SIZE),materialLineGapSize=nodeImmutable(MaterialNode,MaterialNode.LINE_GAP_SIZE);MaterialNode.LINE_WIDTH;MaterialNode.LINE_DASH_OFFSET;MaterialNode.POINT_WIDTH;const materialDispersion=nodeImmutable(MaterialNode,MaterialNode.DISPERSION),materialLightMap=nodeImmutable(MaterialNode,MaterialNode.LIGHT_MAP),materialAOMap=nodeImmutable(MaterialNode,MaterialNode.AO_MAP),materialAnisotropyVector=uniform(new Vector2).onReference(function(nt){return nt.material}).onRenderUpdate(function({material:nt}){this.value.set(nt.anisotropy*Math.cos(nt.anisotropyRotation),nt.anisotropy*Math.sin(nt.anisotropyRotation))});class ModelViewProjectionNode extends TempNode{static get type(){return"ModelViewProjectionNode"}constructor(_e=null){super("vec4"),this.positionNode=_e}setup(_e){if(_e.shaderStage==="fragment")return varying(_e.context.mvp);const et=this.positionNode||positionLocal,rt=_e.renderer.nodes.modelViewMatrix||modelViewMatrix;return cameraProjectionMatrix.mul(rt).mul(et)}}const modelViewProjection=nodeProxy(ModelViewProjectionNode);class IndexNode extends Node$1{static get type(){return"IndexNode"}constructor(_e){super("uint"),this.scope=_e,this.isInstanceIndexNode=!0}generate(_e){const et=this.getNodeType(_e),rt=this.scope;let it;if(rt===IndexNode.VERTEX)it=_e.getVertexIndex();else if(rt===IndexNode.INSTANCE)it=_e.getInstanceIndex();else if(rt===IndexNode.DRAW)it=_e.getDrawIndex();else if(rt===IndexNode.INVOCATION_LOCAL)it=_e.getInvocationLocalIndex();else if(rt===IndexNode.INVOCATION_SUBGROUP)it=_e.getInvocationSubgroupIndex();else if(rt===IndexNode.SUBGROUP)it=_e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+rt);let st;return _e.shaderStage==="vertex"||_e.shaderStage==="compute"?st=it:st=varying(this).build(_e,et),st}}IndexNode.VERTEX="vertex";IndexNode.INSTANCE="instance";IndexNode.SUBGROUP="subgroup";IndexNode.INVOCATION_LOCAL="invocationLocal";IndexNode.INVOCATION_SUBGROUP="invocationSubgroup";IndexNode.DRAW="draw";const vertexIndex=nodeImmutable(IndexNode,IndexNode.VERTEX),instanceIndex=nodeImmutable(IndexNode,IndexNode.INSTANCE);IndexNode.SUBGROUP;IndexNode.INVOCATION_SUBGROUP;IndexNode.INVOCATION_LOCAL;const drawIndex=nodeImmutable(IndexNode,IndexNode.DRAW);class InstanceNode extends Node$1{static get type(){return"InstanceNode"}constructor(_e){super("void"),this.instanceMesh=_e,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=NodeUpdateType.FRAME,this.buffer=null,this.bufferColor=null}setup(_e){let et=this.instanceMatrixNode,rt=this.instanceColorNode;const it=this.instanceMesh;if(et===null){const at=it.instanceMatrix;if(it.count<=1e3)et=buffer(at.array,"mat4",Math.max(it.count,1)).element(instanceIndex);else{const lt=new InstancedInterleavedBuffer(at.array,16,1);this.buffer=lt;const ct=at.usage===DynamicDrawUsage?instancedDynamicBufferAttribute:instancedBufferAttribute,ut=[ct(lt,"vec4",16,0),ct(lt,"vec4",16,4),ct(lt,"vec4",16,8),ct(lt,"vec4",16,12)];et=mat4(...ut)}this.instanceMatrixNode=et}const st=it.instanceColor;if(st&&rt===null){const at=new InstancedBufferAttribute(st.array,3),lt=st.usage===DynamicDrawUsage?instancedDynamicBufferAttribute:instancedBufferAttribute;this.bufferColor=at,rt=vec3(lt(at,"vec3",3,0)),this.instanceColorNode=rt}const ot=et.mul(positionLocal).xyz;if(positionLocal.assign(ot),_e.hasGeometryAttribute("normal")){const at=transformNormal(normalLocal,et);normalLocal.assign(at)}this.instanceColorNode!==null&&varyingProperty("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMesh.instanceMatrix.usage!==DynamicDrawUsage&&this.buffer!=null&&this.instanceMesh.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMesh.instanceMatrix.version),this.instanceMesh.instanceColor&&this.instanceMesh.instanceColor.usage!==DynamicDrawUsage&&this.bufferColor!=null&&this.instanceMesh.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceMesh.instanceColor.version)}}const instance=nodeProxy(InstanceNode);class BatchNode extends Node$1{static get type(){return"BatchNode"}constructor(_e){super("void"),this.batchMesh=_e,this.batchingIdNode=null}setup(_e){this.batchingIdNode===null&&(_e.getDrawIndex()===null?this.batchingIdNode=instanceIndex:this.batchingIdNode=drawIndex);const rt=Fn(([pt])=>{const mt=textureSize(textureLoad(this.batchMesh._indirectTexture),0),At=int$1(pt).modInt(int$1(mt)),gt=int$1(pt).div(int$1(mt));return textureLoad(this.batchMesh._indirectTexture,ivec2(At,gt)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(int$1(this.batchingIdNode)),it=this.batchMesh._matricesTexture,st=textureSize(textureLoad(it),0),ot=float(rt).mul(4).toInt().toVar(),at=ot.modInt(st),lt=ot.div(int$1(st)),ct=mat4(textureLoad(it,ivec2(at,lt)),textureLoad(it,ivec2(at.add(1),lt)),textureLoad(it,ivec2(at.add(2),lt)),textureLoad(it,ivec2(at.add(3),lt))),ut=this.batchMesh._colorsTexture;if(ut!==null){const mt=Fn(([At])=>{const gt=textureSize(textureLoad(ut),0).x,bt=At,Tt=bt.modInt(gt),wt=bt.div(gt);return textureLoad(ut,ivec2(Tt,wt)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(rt);varyingProperty("vec3","vBatchColor").assign(mt)}const ht=mat3(ct);positionLocal.assign(ct.mul(positionLocal));const dt=normalLocal.div(vec3(ht[0].dot(ht[0]),ht[1].dot(ht[1]),ht[2].dot(ht[2]))),ft=ht.mul(dt).xyz;normalLocal.assign(ft),_e.hasGeometryAttribute("tangent")&&tangentLocal.mulAssign(ht)}}const batch=nodeProxy(BatchNode),_frameId=new WeakMap;class SkinningNode extends Node$1{static get type(){return"SkinningNode"}constructor(_e,et=!1){super("void"),this.skinnedMesh=_e,this.useReference=et,this.updateType=NodeUpdateType.OBJECT,this.skinIndexNode=attribute("skinIndex","uvec4"),this.skinWeightNode=attribute("skinWeight","vec4");let rt,it,st;et?(rt=reference("bindMatrix","mat4"),it=reference("bindMatrixInverse","mat4"),st=referenceBuffer("skeleton.boneMatrices","mat4",_e.skeleton.bones.length)):(rt=uniform(_e.bindMatrix,"mat4"),it=uniform(_e.bindMatrixInverse,"mat4"),st=buffer(_e.skeleton.boneMatrices,"mat4",_e.skeleton.bones.length)),this.bindMatrixNode=rt,this.bindMatrixInverseNode=it,this.boneMatricesNode=st,this.previousBoneMatricesNode=null}getSkinnedPosition(_e=this.boneMatricesNode,et=positionLocal){const{skinIndexNode:rt,skinWeightNode:it,bindMatrixNode:st,bindMatrixInverseNode:ot}=this,at=_e.element(rt.x),lt=_e.element(rt.y),ct=_e.element(rt.z),ut=_e.element(rt.w),ht=st.mul(et),dt=add(at.mul(it.x).mul(ht),lt.mul(it.y).mul(ht),ct.mul(it.z).mul(ht),ut.mul(it.w).mul(ht));return ot.mul(dt).xyz}getSkinnedNormal(_e=this.boneMatricesNode,et=normalLocal){const{skinIndexNode:rt,skinWeightNode:it,bindMatrixNode:st,bindMatrixInverseNode:ot}=this,at=_e.element(rt.x),lt=_e.element(rt.y),ct=_e.element(rt.z),ut=_e.element(rt.w);let ht=add(it.x.mul(at),it.y.mul(lt),it.z.mul(ct),it.w.mul(ut));return ht=ot.mul(ht).mul(st),ht.transformDirection(et).xyz}getPreviousSkinnedPosition(_e){const et=_e.object;return this.previousBoneMatricesNode===null&&(et.skeleton.previousBoneMatrices=new Float32Array(et.skeleton.boneMatrices),this.previousBoneMatricesNode=referenceBuffer("skeleton.previousBoneMatrices","mat4",et.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,positionPrevious)}needsPreviousBoneMatrices(_e){const et=_e.renderer.getMRT();return et&&et.has("velocity")}setup(_e){this.needsPreviousBoneMatrices(_e)&&positionPrevious.assign(this.getPreviousSkinnedPosition(_e));const et=this.getSkinnedPosition();if(positionLocal.assign(et),_e.hasGeometryAttribute("normal")){const rt=this.getSkinnedNormal();normalLocal.assign(rt),_e.hasGeometryAttribute("tangent")&&tangentLocal.assign(rt)}}generate(_e,et){if(et!=="void")return positionLocal.build(_e,et)}update(_e){const rt=(this.useReference?_e.object:this.skinnedMesh).skeleton;_frameId.get(rt)!==_e.frameId&&(_frameId.set(rt,_e.frameId),this.previousBoneMatricesNode!==null&&rt.previousBoneMatrices.set(rt.boneMatrices),rt.update())}}const skinningReference=nt=>nodeObject(new SkinningNode(nt,!0));class LoopNode extends Node$1{static get type(){return"LoopNode"}constructor(_e=[]){super(),this.params=_e}getVarName(_e){return String.fromCharCode(105+_e)}getProperties(_e){const et=_e.getNodeProperties(this);if(et.stackNode!==void 0)return et;const rt={};for(let st=0,ot=this.params.length-1;st<ot;st++){const at=this.params[st],lt=at.isNode!==!0&&at.name||this.getVarName(st),ct=at.isNode!==!0&&at.type||"int";rt[lt]=expression(lt,ct)}const it=_e.addStack();return et.returnsNode=this.params[this.params.length-1](rt,it,_e),et.stackNode=it,_e.removeStack(),et}getNodeType(_e){const{returnsNode:et}=this.getProperties(_e);return et?et.getNodeType(_e):"void"}setup(_e){this.getProperties(_e)}generate(_e){const et=this.getProperties(_e),rt=this.params,it=et.stackNode;for(let at=0,lt=rt.length-1;at<lt;at++){const ct=rt[at];let ut=null,ht=null,dt=null,ft=null,pt=null,mt=null;ct.isNode?(ft="int",dt=this.getVarName(at),ut="0",ht=ct.build(_e,ft),pt="<"):(ft=ct.type||"int",dt=ct.name||this.getVarName(at),ut=ct.start,ht=ct.end,pt=ct.condition,mt=ct.update,typeof ut=="number"?ut=ut.toString():ut&&ut.isNode&&(ut=ut.build(_e,ft)),typeof ht=="number"?ht=ht.toString():ht&&ht.isNode&&(ht=ht.build(_e,ft)),ut!==void 0&&ht===void 0?(ut=ut+" - 1",ht="0",pt=">="):ht!==void 0&&ut===void 0&&(ut="0",pt="<"),pt===void 0&&(Number(ut)>Number(ht)?pt=">=":pt="<"));const At={start:ut,end:ht,condition:pt},gt=At.start,bt=At.end;let Tt="",wt="",Rt="";mt||(ft==="int"||ft==="uint"?pt.includes("<")?mt="++":mt="--":pt.includes("<")?mt="+= 1.":mt="-= 1."),Tt+=_e.getVar(ft,dt)+" = "+gt,wt+=dt+" "+pt+" "+bt,Rt+=dt+" "+mt;const It=`for ( ${Tt}; ${wt}; ${Rt} )`;_e.addFlowCode((at===0?`
`:"")+_e.tab+It+` {

`).addFlowTab()}const st=it.build(_e,"void"),ot=et.returnsNode?et.returnsNode.build(_e):"";_e.removeFlowTab().addFlowCode(`
`+_e.tab+st);for(let at=0,lt=this.params.length-1;at<lt;at++)_e.addFlowCode((at===0?"":_e.tab)+`}

`).removeFlowTab();return _e.addFlowTab(),ot}}const Loop=(...nt)=>nodeObject(new LoopNode(nodeArray(nt,"int"))).append(),Break=()=>expression("break").append(),_morphTextures=new WeakMap,_morphVec4=new Vector4,getMorph=Fn(({bufferMap:nt,influence:_e,stride:et,width:rt,depth:it,offset:st})=>{const ot=int$1(vertexIndex).mul(et).add(st),at=ot.div(rt),lt=ot.sub(at.mul(rt));return textureLoad(nt,ivec2(lt,at)).depth(it).mul(_e)});function getEntry(nt){const _e=nt.morphAttributes.position!==void 0,et=nt.morphAttributes.normal!==void 0,rt=nt.morphAttributes.color!==void 0,it=nt.morphAttributes.position||nt.morphAttributes.normal||nt.morphAttributes.color,st=it!==void 0?it.length:0;let ot=_morphTextures.get(nt);if(ot===void 0||ot.count!==st){let bt=function(){At.dispose(),_morphTextures.delete(nt),nt.removeEventListener("dispose",bt)};var at=bt;ot!==void 0&&ot.texture.dispose();const lt=nt.morphAttributes.position||[],ct=nt.morphAttributes.normal||[],ut=nt.morphAttributes.color||[];let ht=0;_e===!0&&(ht=1),et===!0&&(ht=2),rt===!0&&(ht=3);let dt=nt.attributes.position.count*ht,ft=1;const pt=4096;dt>pt&&(ft=Math.ceil(dt/pt),dt=pt);const mt=new Float32Array(dt*ft*4*st),At=new DataArrayTexture(mt,dt,ft,st);At.type=FloatType,At.needsUpdate=!0;const gt=ht*4;for(let Tt=0;Tt<st;Tt++){const wt=lt[Tt],Rt=ct[Tt],It=ut[Tt],Lt=dt*ft*4*Tt;for(let $t=0;$t<wt.count;$t++){const kt=$t*gt;_e===!0&&(_morphVec4.fromBufferAttribute(wt,$t),mt[Lt+kt+0]=_morphVec4.x,mt[Lt+kt+1]=_morphVec4.y,mt[Lt+kt+2]=_morphVec4.z,mt[Lt+kt+3]=0),et===!0&&(_morphVec4.fromBufferAttribute(Rt,$t),mt[Lt+kt+4]=_morphVec4.x,mt[Lt+kt+5]=_morphVec4.y,mt[Lt+kt+6]=_morphVec4.z,mt[Lt+kt+7]=0),rt===!0&&(_morphVec4.fromBufferAttribute(It,$t),mt[Lt+kt+8]=_morphVec4.x,mt[Lt+kt+9]=_morphVec4.y,mt[Lt+kt+10]=_morphVec4.z,mt[Lt+kt+11]=It.itemSize===4?_morphVec4.w:1)}}ot={count:st,texture:At,stride:ht,size:new Vector2(dt,ft)},_morphTextures.set(nt,ot),nt.addEventListener("dispose",bt)}return ot}class MorphNode extends Node$1{static get type(){return"MorphNode"}constructor(_e){super("void"),this.mesh=_e,this.morphBaseInfluence=uniform(1),this.updateType=NodeUpdateType.OBJECT}setup(_e){const{geometry:et}=_e,rt=et.morphAttributes.position!==void 0,it=et.hasAttribute("normal")&&et.morphAttributes.normal!==void 0,st=et.morphAttributes.position||et.morphAttributes.normal||et.morphAttributes.color,ot=st!==void 0?st.length:0,{texture:at,stride:lt,size:ct}=getEntry(et);rt===!0&&positionLocal.mulAssign(this.morphBaseInfluence),it===!0&&normalLocal.mulAssign(this.morphBaseInfluence);const ut=int$1(ct.width);Loop(ot,({i:ht})=>{const dt=float(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?dt.assign(textureLoad(this.mesh.morphTexture,ivec2(int$1(ht).add(1),int$1(instanceIndex))).r):dt.assign(reference("morphTargetInfluences","float").element(ht).toVar()),rt===!0&&positionLocal.addAssign(getMorph({bufferMap:at,influence:dt,stride:lt,width:ut,depth:ht,offset:int$1(0)})),it===!0&&normalLocal.addAssign(getMorph({bufferMap:at,influence:dt,stride:lt,width:ut,depth:ht,offset:int$1(1)}))})}update(){const _e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?_e.value=1:_e.value=1-this.mesh.morphTargetInfluences.reduce((et,rt)=>et+rt,0)}}const morphReference=nodeProxy(MorphNode),sortLights=nt=>nt.sort((_e,et)=>_e.id-et.id),getLightNodeById=(nt,_e)=>{for(const et of _e)if(et.isAnalyticLightNode&&et.light.id===nt)return et;return null},_lightsNodeRef=new WeakMap;class LightsNode extends Node$1{static get type(){return"LightsNode"}constructor(_e=[]){super("vec3"),this.totalDiffuseNode=vec3().toVar("totalDiffuse"),this.totalSpecularNode=vec3().toVar("totalSpecular"),this.outgoingLightNode=vec3().toVar("outgoingLight"),this._lights=_e,this._lightNodes=null,this._lightNodesHash=null,this.global=!0}getHash(_e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(_e);const et=[];for(const rt of this._lightNodes)et.push(rt.getHash());this._lightNodesHash="lights-"+et.join(",")}return this._lightNodesHash}analyze(_e){const et=_e.getDataFromNode(this);for(const rt of et.nodes)rt.build(_e)}setupLightsNode(_e){const et=[],rt=this._lightNodes,it=sortLights(this._lights),st=_e.renderer.nodes.library;for(const ot of it)if(ot.isNode)et.push(nodeObject(ot));else{let at=null;if(rt!==null&&(at=getLightNodeById(ot.id,rt)),at===null){const lt=st.getLightNodeClass(ot.constructor);if(lt===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${ot.constructor.name}`);continue}let ct=null;_lightsNodeRef.has(ot)?ct=_lightsNodeRef.get(ot):(ct=new lt(ot),_lightsNodeRef.set(ot,ct)),et.push(ct)}}this._lightNodes=et}setup(_e){this._lightNodes===null&&this.setupLightsNode(_e);const et=_e.context,rt=et.lightingModel;let it=this.outgoingLightNode;if(rt){const{_lightNodes:st,totalDiffuseNode:ot,totalSpecularNode:at}=this;et.outgoingLight=it;const lt=_e.addStack(),ct=_e.getDataFromNode(this);ct.nodes=lt.nodes,rt.start(et,lt,_e);for(const gt of st)gt.build(_e);rt.indirect(et,lt,_e);const{backdrop:ut,backdropAlpha:ht}=et,{directDiffuse:dt,directSpecular:ft,indirectDiffuse:pt,indirectSpecular:mt}=et.reflectedLight;let At=dt.add(pt);ut!==null&&(ht!==null?At=vec3(ht.mix(At,ut)):At=vec3(ut),et.material.transparent=!0),ot.assign(At),at.assign(ft.add(mt)),it.assign(ot.add(at)),rt.finish(et,lt,_e),it=it.bypass(_e.removeStack())}return it}setLights(_e){return this._lights=_e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}}const lights=nodeProxy(LightsNode);class LightingNode extends Node$1{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}generate(){console.warn("Abstract function.")}}class AONode extends LightingNode{static get type(){return"AONode"}constructor(_e=null){super(),this.aoNode=_e}setup(_e){_e.context.ambientOcclusion.mulAssign(this.aoNode)}}class LightingContextNode extends ContextNode{static get type(){return"LightingContextNode"}constructor(_e,et=null,rt=null,it=null){super(_e),this.lightingModel=et,this.backdropNode=rt,this.backdropAlphaNode=it,this._value=null}getContext(){const{backdropNode:_e,backdropAlphaNode:et}=this,rt=vec3().toVar("directDiffuse"),it=vec3().toVar("directSpecular"),st=vec3().toVar("indirectDiffuse"),ot=vec3().toVar("indirectSpecular"),at={directDiffuse:rt,directSpecular:it,indirectDiffuse:st,indirectSpecular:ot};return{radiance:vec3().toVar("radiance"),irradiance:vec3().toVar("irradiance"),iblIrradiance:vec3().toVar("iblIrradiance"),ambientOcclusion:float(1).toVar("ambientOcclusion"),reflectedLight:at,backdrop:_e,backdropAlpha:et}}setup(_e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||_e.context.lightingModel,super.setup(_e)}}const lightingContext=nodeProxy(LightingContextNode);class IrradianceNode extends LightingNode{static get type(){return"IrradianceNode"}constructor(_e){super(),this.node=_e}setup(_e){_e.context.irradiance.addAssign(this.node)}}let screenSizeVec,viewportVec;class ScreenNode extends Node$1{static get type(){return"ScreenNode"}constructor(_e){super(),this.scope=_e,this.isViewportNode=!0}getNodeType(){return this.scope===ScreenNode.VIEWPORT?"vec4":"vec2"}getUpdateType(){let _e=NodeUpdateType.NONE;return(this.scope===ScreenNode.SIZE||this.scope===ScreenNode.VIEWPORT)&&(_e=NodeUpdateType.RENDER),this.updateType=_e,_e}update({renderer:_e}){const et=_e.getRenderTarget();this.scope===ScreenNode.VIEWPORT?et!==null?viewportVec.copy(et.viewport):(_e.getViewport(viewportVec),viewportVec.multiplyScalar(_e.getPixelRatio())):et!==null?(screenSizeVec.width=et.width,screenSizeVec.height=et.height):_e.getDrawingBufferSize(screenSizeVec)}setup(){const _e=this.scope;let et=null;return _e===ScreenNode.SIZE?et=uniform(screenSizeVec||(screenSizeVec=new Vector2)):_e===ScreenNode.VIEWPORT?et=uniform(viewportVec||(viewportVec=new Vector4)):et=vec2(screenCoordinate.div(screenSize)),et}generate(_e){if(this.scope===ScreenNode.COORDINATE){let et=_e.getFragCoord();if(_e.isFlipY()){const rt=_e.getNodeProperties(screenSize).outputNode.build(_e);et=`${_e.getType("vec2")}( ${et}.x, ${rt}.y - ${et}.y )`}return et}return super.generate(_e)}}ScreenNode.COORDINATE="coordinate";ScreenNode.VIEWPORT="viewport";ScreenNode.SIZE="size";ScreenNode.UV="uv";const screenUV=nodeImmutable(ScreenNode,ScreenNode.UV),screenSize=nodeImmutable(ScreenNode,ScreenNode.SIZE),screenCoordinate=nodeImmutable(ScreenNode,ScreenNode.COORDINATE),viewport=nodeImmutable(ScreenNode,ScreenNode.VIEWPORT);viewport.zw;viewport.xy;const _size$a=new Vector2;class ViewportTextureNode extends TextureNode{static get type(){return"ViewportTextureNode"}constructor(_e=screenUV,et=null,rt=null){rt===null&&(rt=new FramebufferTexture,rt.minFilter=LinearMipmapLinearFilter),super(rt,_e,et),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=NodeUpdateType.FRAME}updateBefore(_e){const et=_e.renderer;et.getDrawingBufferSize(_size$a);const rt=this.value;(rt.image.width!==_size$a.width||rt.image.height!==_size$a.height)&&(rt.image.width=_size$a.width,rt.image.height=_size$a.height,rt.needsUpdate=!0);const it=rt.generateMipmaps;rt.generateMipmaps=this.generateMipmaps,et.copyFramebufferToTexture(rt),rt.generateMipmaps=it}clone(){const _e=new this.constructor(this.uvNode,this.levelNode,this.value);return _e.generateMipmaps=this.generateMipmaps,_e}}const viewportMipTexture=nodeProxy(ViewportTextureNode,null,null,{generateMipmaps:!0});let sharedDepthbuffer=null;class ViewportDepthTextureNode extends ViewportTextureNode{static get type(){return"ViewportDepthTextureNode"}constructor(_e=screenUV,et=null){sharedDepthbuffer===null&&(sharedDepthbuffer=new DepthTexture),super(_e,et,sharedDepthbuffer)}}const viewportDepthTexture=nodeProxy(ViewportDepthTextureNode);class ViewportDepthNode extends Node$1{static get type(){return"ViewportDepthNode"}constructor(_e,et=null){super("float"),this.scope=_e,this.valueNode=et,this.isViewportDepthNode=!0}generate(_e){const{scope:et}=this;return et===ViewportDepthNode.DEPTH_BASE?_e.getFragDepth():super.generate(_e)}setup({camera:_e}){const{scope:et}=this,rt=this.valueNode;let it=null;if(et===ViewportDepthNode.DEPTH_BASE)rt!==null&&(it=depthBase().assign(rt));else if(et===ViewportDepthNode.DEPTH)_e.isPerspectiveCamera?it=viewZToPerspectiveDepth(positionView.z,cameraNear,cameraFar):it=viewZToOrthographicDepth$1(positionView.z,cameraNear,cameraFar);else if(et===ViewportDepthNode.LINEAR_DEPTH)if(rt!==null)if(_e.isPerspectiveCamera){const st=perspectiveDepthToViewZ(rt,cameraNear,cameraFar);it=viewZToOrthographicDepth$1(st,cameraNear,cameraFar)}else it=rt;else it=viewZToOrthographicDepth$1(positionView.z,cameraNear,cameraFar);return it}}ViewportDepthNode.DEPTH_BASE="depthBase";ViewportDepthNode.DEPTH="depth";ViewportDepthNode.LINEAR_DEPTH="linearDepth";const viewZToOrthographicDepth$1=(nt,_e,et)=>nt.add(_e).div(_e.sub(et)),viewZToPerspectiveDepth=(nt,_e,et)=>_e.add(nt).mul(et).div(et.sub(_e).mul(nt)),perspectiveDepthToViewZ=(nt,_e,et)=>_e.mul(et).div(et.sub(_e).mul(nt).sub(et)),depthBase=nodeProxy(ViewportDepthNode,ViewportDepthNode.DEPTH_BASE),depth=nodeImmutable(ViewportDepthNode,ViewportDepthNode.DEPTH),linearDepth=nodeProxy(ViewportDepthNode,ViewportDepthNode.LINEAR_DEPTH);viewportDepthTexture();depth.assign=nt=>depthBase(nt);class ClippingNode extends Node$1{static get type(){return"ClippingNode"}constructor(_e=ClippingNode.DEFAULT){super(),this.scope=_e}setup(_e){super.setup(_e);const et=_e.clippingContext,{localClipIntersection:rt,localClippingCount:it,globalClippingCount:st}=et,ot=st+it,at=rt?ot-it:ot;return this.scope===ClippingNode.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(et.planes,ot,at):this.setupDefault(et.planes,ot,at)}setupAlphaToCoverage(_e,et,rt){return Fn(()=>{const it=uniformArray(_e),st=property("float","distanceToPlane"),ot=property("float","distanceToGradient"),at=property("float","clipOpacity");at.assign(1);let lt;if(Loop(rt,({i:ct})=>{lt=it.element(ct),st.assign(positionView.dot(lt.xyz).negate().add(lt.w)),ot.assign(st.fwidth().div(2)),at.mulAssign(smoothstep(ot.negate(),ot,st)),at.equal(0).discard()}),rt<et){const ct=property("float","unionclipOpacity");ct.assign(1),Loop({start:rt,end:et},({i:ut})=>{lt=it.element(ut),st.assign(positionView.dot(lt.xyz).negate().add(lt.w)),ot.assign(st.fwidth().div(2)),ct.mulAssign(smoothstep(ot.negate(),ot,st).oneMinus())}),at.mulAssign(ct.oneMinus())}diffuseColor.a.mulAssign(at),diffuseColor.a.equal(0).discard()})()}setupDefault(_e,et,rt){return Fn(()=>{const it=uniformArray(_e);let st;if(Loop(rt,({i:ot})=>{st=it.element(ot),positionView.dot(st.xyz).greaterThan(st.w).discard()}),rt<et){const ot=property("bool","clipped");ot.assign(!0),Loop({start:rt,end:et},({i:at})=>{st=it.element(at),ot.assign(positionView.dot(st.xyz).greaterThan(st.w).and(ot))}),ot.discard()}})()}}ClippingNode.ALPHA_TO_COVERAGE="alphaToCoverage";ClippingNode.DEFAULT="default";const clipping=()=>nodeObject(new ClippingNode),clippingAlpha=()=>nodeObject(new ClippingNode(ClippingNode.ALPHA_TO_COVERAGE));class NodeMaterial extends Material{static get type(){return"NodeMaterial"}constructor(){super(),this.isNodeMaterial=!0,this.type=this.constructor.type,this.forceSinglePass=!1,this.fog=!0,this.lights=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.depthNode=null,this.shadowNode=null,this.shadowPositionNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null}customProgramCacheKey(){return this.type+getCacheKey$1(this)}build(_e){this.setup(_e)}setupObserver(_e){return new NodeMaterialObserver(_e)}setup(_e){_e.context.setupNormal=()=>this.setupNormal(_e),_e.addStack(),_e.stack.outputNode=this.vertexNode||this.setupPosition(_e),_e.addFlow("vertex",_e.removeStack()),_e.addStack();let et;const rt=this.setupClipping(_e);if(this.depthWrite===!0&&this.setupDepth(_e),this.fragmentNode===null){this.setupDiffuseColor(_e),this.setupVariants(_e);const it=this.setupLighting(_e);rt!==null&&_e.stack.add(rt);const st=vec4(it,diffuseColor.a).max(0);if(et=this.setupOutput(_e,st),output.assign(et),this.outputNode!==null&&(et=this.outputNode),_e.renderer.getRenderTarget()!==null){const at=_e.renderer.getMRT(),lt=this.mrtNode;at!==null?(et=at,lt!==null&&(et=at.merge(lt))):lt!==null&&(et=lt)}}else{let it=this.fragmentNode;it.isOutputStructNode!==!0&&(it=vec4(it)),et=this.setupOutput(_e,it)}_e.stack.outputNode=et,_e.addFlow("fragment",_e.removeStack()),_e.monitor=this.setupObserver(_e)}setupClipping(_e){if(_e.clippingContext===null)return null;const{globalClippingCount:et,localClippingCount:rt}=_e.clippingContext;let it=null;if(et||rt){const st=_e.renderer.samples;this.alphaToCoverage&&st>1?it=clippingAlpha():_e.stack.add(clipping())}return it}setupDepth(_e){const{renderer:et}=_e;let rt=this.depthNode;if(rt===null){const it=et.getMRT();it&&it.has("depth")?rt=it.get("depth"):et.logarithmicDepthBuffer===!0&&(rt=modelViewProjection().w.add(1).log2().mul(cameraLogDepth).mul(.5))}rt!==null&&depth.assign(rt).append()}setupPosition(_e){const{object:et}=_e,rt=et.geometry;if(_e.addStack(),(rt.morphAttributes.position||rt.morphAttributes.normal||rt.morphAttributes.color)&&morphReference(et).append(),et.isSkinnedMesh===!0&&skinningReference(et).append(),this.displacementMap){const st=materialReference("displacementMap","texture"),ot=materialReference("displacementScale","float"),at=materialReference("displacementBias","float");positionLocal.addAssign(normalLocal.normalize().mul(st.x.mul(ot).add(at)))}et.isBatchedMesh&&batch(et).append(),et.instanceMatrix&&et.instanceMatrix.isInstancedBufferAttribute===!0&&instance(et).append(),this.positionNode!==null&&positionLocal.assign(this.positionNode);const it=modelViewProjection();return _e.context.vertex=_e.removeStack(),_e.context.mvp=it,it}setupDiffuseColor({object:_e,geometry:et}){let rt=this.colorNode?vec4(this.colorNode):materialColor;this.vertexColors===!0&&et.hasAttribute("color")&&(rt=vec4(rt.xyz.mul(attribute("color","vec3")),rt.a)),_e.instanceColor&&(rt=varyingProperty("vec3","vInstanceColor").mul(rt)),_e.isBatchedMesh&&_e._colorsTexture&&(rt=varyingProperty("vec3","vBatchColor").mul(rt)),diffuseColor.assign(rt);const it=this.opacityNode?float(this.opacityNode):materialOpacity;if(diffuseColor.a.assign(diffuseColor.a.mul(it)),this.alphaTestNode!==null||this.alphaTest>0){const st=this.alphaTestNode!==null?float(this.alphaTestNode):materialAlphaTest;diffuseColor.a.lessThanEqual(st).discard()}this.transparent===!1&&this.blending===NormalBlending&&this.alphaToCoverage===!1&&diffuseColor.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?vec3(0):diffuseColor.rgb}setupNormal(){return this.normalNode?vec3(this.normalNode):materialNormal}setupEnvironment(){let _e=null;return this.envNode?_e=this.envNode:this.envMap&&(_e=this.envMap.isCubeTexture?materialReference("envMap","cubeTexture"):materialReference("envMap","texture")),_e}setupLightMap(_e){let et=null;return _e.material.lightMap&&(et=new IrradianceNode(materialLightMap)),et}setupLights(_e){const et=[],rt=this.setupEnvironment(_e);rt&&rt.isLightingNode&&et.push(rt);const it=this.setupLightMap(_e);if(it&&it.isLightingNode&&et.push(it),this.aoNode!==null||_e.material.aoMap){const ot=this.aoNode!==null?this.aoNode:materialAOMap;et.push(new AONode(ot))}let st=this.lightsNode||_e.lightsNode;return et.length>0&&(st=lights([...st.getLights(),...et])),st}setupLightingModel(){}setupLighting(_e){const{material:et}=_e,{backdropNode:rt,backdropAlphaNode:it,emissiveNode:st}=this,at=this.lights===!0||this.lightsNode!==null?this.setupLights(_e):null;let lt=this.setupOutgoingLight(_e);if(at&&at.getScope().getLights().length>0){const ct=this.setupLightingModel(_e);lt=lightingContext(at,ct,rt,it)}else rt!==null&&(lt=vec3(it!==null?mix$2(lt,rt,it):rt));return(st&&st.isNode===!0||et.emissive&&et.emissive.isColor===!0)&&(emissive.assign(vec3(st||materialEmissive)),lt=lt.add(emissive)),lt}setupOutput(_e,et){if(this.fog===!0){const rt=_e.fogNode;rt&&(et=vec4(rt.mix(et.rgb,rt.colorNode),et.a))}return et}setDefaultValues(_e){for(const rt in _e){const it=_e[rt];this[rt]===void 0&&(this[rt]=it,it&&it.clone&&(this[rt]=it.clone()))}const et=Object.getOwnPropertyDescriptors(_e.constructor.prototype);for(const rt in et)Object.getOwnPropertyDescriptor(this.constructor.prototype,rt)===void 0&&et[rt].get!==void 0&&Object.defineProperty(this.constructor.prototype,rt,et[rt])}toJSON(_e){const et=_e===void 0||typeof _e=="string";et&&(_e={textures:{},images:{},nodes:{}});const rt=Material.prototype.toJSON.call(this,_e),it=getNodeChildren(this);rt.inputNodes={};for(const{property:ot,childNode:at}of it)rt.inputNodes[ot]=at.toJSON(_e).uuid;function st(ot){const at=[];for(const lt in ot){const ct=ot[lt];delete ct.metadata,at.push(ct)}return at}if(et){const ot=st(_e.textures),at=st(_e.images),lt=st(_e.nodes);ot.length>0&&(rt.textures=ot),at.length>0&&(rt.images=at),lt.length>0&&(rt.nodes=lt)}return rt}copy(_e){return this.lightsNode=_e.lightsNode,this.envNode=_e.envNode,this.colorNode=_e.colorNode,this.normalNode=_e.normalNode,this.opacityNode=_e.opacityNode,this.backdropNode=_e.backdropNode,this.backdropAlphaNode=_e.backdropAlphaNode,this.alphaTestNode=_e.alphaTestNode,this.positionNode=_e.positionNode,this.depthNode=_e.depthNode,this.shadowNode=_e.shadowNode,this.shadowPositionNode=_e.shadowPositionNode,this.outputNode=_e.outputNode,this.mrtNode=_e.mrtNode,this.fragmentNode=_e.fragmentNode,this.vertexNode=_e.vertexNode,super.copy(_e)}}const _defaultValues$d=new LineBasicMaterial;class LineBasicNodeMaterial extends NodeMaterial{static get type(){return"LineBasicNodeMaterial"}constructor(_e){super(),this.isLineBasicNodeMaterial=!0,this.lights=!1,this.setDefaultValues(_defaultValues$d),this.setValues(_e)}}const _defaultValues$c=new LineDashedMaterial;class LineDashedNodeMaterial extends NodeMaterial{static get type(){return"LineDashedNodeMaterial"}constructor(_e){super(),this.isLineDashedNodeMaterial=!0,this.lights=!1,this.setDefaultValues(_defaultValues$c),this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(_e)}setupVariants(){const _e=this.offsetNode,et=this.dashScaleNode?float(this.dashScaleNode):materialLineScale,rt=this.dashSizeNode?float(this.dashSizeNode):materialLineDashSize,it=this.dashSizeNode?float(this.dashGapNode):materialLineGapSize;dashSize.assign(rt),gapSize.assign(it);const st=varying(attribute("lineDistance").mul(et));(_e?st.add(_e):st).mod(dashSize.add(gapSize)).greaterThan(dashSize).discard()}}const directionToColor=nt=>nodeObject(nt).mul(.5).add(.5),_defaultValues$a=new MeshNormalMaterial;class MeshNormalNodeMaterial extends NodeMaterial{static get type(){return"MeshNormalNodeMaterial"}constructor(_e){super(),this.lights=!1,this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(_defaultValues$a),this.setValues(_e)}setupDiffuseColor(){const _e=this.opacityNode?float(this.opacityNode):materialOpacity;diffuseColor.assign(vec4(directionToColor(transformedNormalView),_e))}}class EquirectUVNode extends TempNode{static get type(){return"EquirectUVNode"}constructor(_e=positionWorldDirection){super("vec2"),this.dirNode=_e}setup(){const _e=this.dirNode,et=_e.z.atan2(_e.x).mul(1/(Math.PI*2)).add(.5),rt=_e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return vec2(et,rt)}}const equirectUV=nodeProxy(EquirectUVNode);class CubeRenderTarget extends WebGLCubeRenderTarget{constructor(_e=1,et={}){super(_e,et),this.isCubeRenderTarget=!0}fromEquirectangularTexture(_e,et){const rt=et.minFilter,it=et.generateMipmaps;et.generateMipmaps=!0,this.texture.type=et.type,this.texture.colorSpace=et.colorSpace,this.texture.generateMipmaps=et.generateMipmaps,this.texture.minFilter=et.minFilter,this.texture.magFilter=et.magFilter;const st=new BoxGeometry(5,5,5),ot=equirectUV(positionWorldDirection),at=new NodeMaterial;at.colorNode=texture(et,ot,0),at.side=BackSide,at.blending=NoBlending;const lt=new Mesh(st,at),ct=new Scene;ct.add(lt),et.minFilter===LinearMipmapLinearFilter&&(et.minFilter=LinearFilter);const ut=new CubeCamera(1,10,this),ht=_e.getMRT();return _e.setMRT(null),ut.update(_e,ct),_e.setMRT(ht),et.minFilter=rt,et.currentGenerateMipmaps=it,lt.geometry.dispose(),lt.material.dispose(),this}}const _cache$1=new WeakMap;class CubeMapNode extends TempNode{static get type(){return"CubeMapNode"}constructor(_e){super("vec3"),this.envNode=_e,this._cubeTexture=null,this._cubeTextureNode=cubeTexture();const et=new CubeTexture;et.isRenderTargetTexture=!0,this._defaultTexture=et,this.updateBeforeType=NodeUpdateType.RENDER}updateBefore(_e){const{renderer:et,material:rt}=_e,it=this.envNode;if(it.isTextureNode||it.isMaterialReferenceNode){const st=it.isTextureNode?it.value:rt[it.property];if(st&&st.isTexture){const ot=st.mapping;if(ot===EquirectangularReflectionMapping||ot===EquirectangularRefractionMapping){if(_cache$1.has(st)){const at=_cache$1.get(st);mapTextureMapping(at,st.mapping),this._cubeTexture=at}else{const at=st.image;if(isEquirectangularMapReady$1(at)){const lt=new CubeRenderTarget(at.height);lt.fromEquirectangularTexture(et,st),mapTextureMapping(lt.texture,st.mapping),this._cubeTexture=lt.texture,_cache$1.set(st,lt.texture),st.addEventListener("dispose",onTextureDispose)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(_e){return this.updateBefore(_e),this._cubeTextureNode}}function isEquirectangularMapReady$1(nt){return nt==null?!1:nt.height>0}function onTextureDispose(nt){const _e=nt.target;_e.removeEventListener("dispose",onTextureDispose);const et=_cache$1.get(_e);et!==void 0&&(_cache$1.delete(_e),et.dispose())}function mapTextureMapping(nt,_e){_e===EquirectangularReflectionMapping?nt.mapping=CubeReflectionMapping:_e===EquirectangularRefractionMapping&&(nt.mapping=CubeRefractionMapping)}const cubeMapNode=nodeProxy(CubeMapNode);class BasicEnvironmentNode extends LightingNode{static get type(){return"BasicEnvironmentNode"}constructor(_e=null){super(),this.envNode=_e}setup(_e){_e.context.environment=cubeMapNode(this.envNode)}}class BasicLightMapNode extends LightingNode{static get type(){return"BasicLightMapNode"}constructor(_e=null){super(),this.lightMapNode=_e}setup(_e){const et=float(1/Math.PI);_e.context.irradianceLightMap=this.lightMapNode.mul(et)}}class LightingModel{start(){}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class BasicLightingModel extends LightingModel{constructor(){super()}indirect(_e,et,rt){const it=_e.ambientOcclusion,st=_e.reflectedLight,ot=rt.context.irradianceLightMap;st.indirectDiffuse.assign(vec4(0)),ot?st.indirectDiffuse.addAssign(ot):st.indirectDiffuse.addAssign(vec4(1,1,1,0)),st.indirectDiffuse.mulAssign(it),st.indirectDiffuse.mulAssign(diffuseColor.rgb)}finish(_e,et,rt){const it=rt.material,st=_e.outgoingLight,ot=rt.context.environment;if(ot)switch(it.combine){case MultiplyOperation:st.rgb.assign(mix$2(st.rgb,st.rgb.mul(ot.rgb),materialSpecularStrength.mul(materialReflectivity)));break;case MixOperation:st.rgb.assign(mix$2(st.rgb,ot.rgb,materialSpecularStrength.mul(materialReflectivity)));break;case AddOperation:st.rgb.addAssign(ot.rgb.mul(materialSpecularStrength.mul(materialReflectivity)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",it.combine);break}}}const _defaultValues$9=new MeshBasicMaterial;class MeshBasicNodeMaterial extends NodeMaterial{static get type(){return"MeshBasicNodeMaterial"}constructor(_e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_defaultValues$9),this.setValues(_e)}setupNormal(){return normalView}setupEnvironment(_e){const et=super.setupEnvironment(_e);return et?new BasicEnvironmentNode(et):null}setupLightMap(_e){let et=null;return _e.material.lightMap&&(et=new BasicLightMapNode(materialLightMap)),et}setupOutgoingLight(){return diffuseColor.rgb}setupLightingModel(){return new BasicLightingModel}}const F_Schlick=Fn(({f0:nt,f90:_e,dotVH:et})=>{const rt=et.mul(-5.55473).sub(6.98316).mul(et).exp2();return nt.mul(rt.oneMinus()).add(_e.mul(rt))}),BRDF_Lambert=Fn(nt=>nt.diffuseColor.mul(1/Math.PI)),G_BlinnPhong_Implicit=()=>float(.25),D_BlinnPhong=Fn(({dotNH:nt})=>shininess.mul(float(.5)).add(1).mul(float(1/Math.PI)).mul(nt.pow(shininess))),BRDF_BlinnPhong=Fn(({lightDirection:nt})=>{const _e=nt.add(positionViewDirection).normalize(),et=transformedNormalView.dot(_e).clamp(),rt=positionViewDirection.dot(_e).clamp(),it=F_Schlick({f0:specularColor,f90:1,dotVH:rt}),st=G_BlinnPhong_Implicit(),ot=D_BlinnPhong({dotNH:et});return it.mul(st).mul(ot)});class PhongLightingModel extends BasicLightingModel{constructor(_e=!0){super(),this.specular=_e}direct({lightDirection:_e,lightColor:et,reflectedLight:rt}){const st=transformedNormalView.dot(_e).clamp().mul(et);rt.directDiffuse.addAssign(st.mul(BRDF_Lambert({diffuseColor:diffuseColor.rgb}))),this.specular===!0&&rt.directSpecular.addAssign(st.mul(BRDF_BlinnPhong({lightDirection:_e})).mul(materialSpecularStrength))}indirect({ambientOcclusion:_e,irradiance:et,reflectedLight:rt}){rt.indirectDiffuse.addAssign(et.mul(BRDF_Lambert({diffuseColor}))),rt.indirectDiffuse.mulAssign(_e)}}const _defaultValues$8=new MeshLambertMaterial;class MeshLambertNodeMaterial extends NodeMaterial{static get type(){return"MeshLambertNodeMaterial"}constructor(_e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_defaultValues$8),this.setValues(_e)}setupEnvironment(_e){const et=super.setupEnvironment(_e);return et?new BasicEnvironmentNode(et):null}setupLightingModel(){return new PhongLightingModel(!1)}}const _defaultValues$7=new MeshPhongMaterial;class MeshPhongNodeMaterial extends NodeMaterial{static get type(){return"MeshPhongNodeMaterial"}constructor(_e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(_defaultValues$7),this.setValues(_e)}setupEnvironment(_e){const et=super.setupEnvironment(_e);return et?new BasicEnvironmentNode(et):null}setupLightingModel(){return new PhongLightingModel}setupVariants(){const _e=(this.shininessNode?float(this.shininessNode):materialShininess).max(1e-4);shininess.assign(_e);const et=this.specularNode||materialSpecular;specularColor.assign(et)}copy(_e){return this.shininessNode=_e.shininessNode,this.specularNode=_e.specularNode,super.copy(_e)}}const getGeometryRoughness=Fn(()=>{const nt=normalView.dFdx().abs().max(normalView.dFdy().abs());return nt.x.max(nt.y).max(nt.z)}),getRoughness=Fn(nt=>{const{roughness:_e}=nt,et=getGeometryRoughness();let rt=_e.max(.0525);return rt=rt.add(et),rt=rt.min(1),rt}),V_GGX_SmithCorrelated=Fn(({alpha:nt,dotNL:_e,dotNV:et})=>{const rt=nt.pow2(),it=_e.mul(rt.add(rt.oneMinus().mul(et.pow2())).sqrt()),st=et.mul(rt.add(rt.oneMinus().mul(_e.pow2())).sqrt());return div(.5,it.add(st).max(EPSILON))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),V_GGX_SmithCorrelated_Anisotropic=Fn(({alphaT:nt,alphaB:_e,dotTV:et,dotBV:rt,dotTL:it,dotBL:st,dotNV:ot,dotNL:at})=>{const lt=at.mul(vec3(nt.mul(et),_e.mul(rt),ot).length()),ct=ot.mul(vec3(nt.mul(it),_e.mul(st),at).length());return div(.5,lt.add(ct)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),D_GGX=Fn(({alpha:nt,dotNH:_e})=>{const et=nt.pow2(),rt=_e.pow2().mul(et.oneMinus()).oneMinus();return et.div(rt.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),RECIPROCAL_PI=float(1/Math.PI),D_GGX_Anisotropic=Fn(({alphaT:nt,alphaB:_e,dotNH:et,dotTH:rt,dotBH:it})=>{const st=nt.mul(_e),ot=vec3(_e.mul(rt),nt.mul(it),st.mul(et)),at=ot.dot(ot),lt=st.div(at);return RECIPROCAL_PI.mul(st.mul(lt.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),BRDF_GGX=Fn(nt=>{const{lightDirection:_e,f0:et,f90:rt,roughness:it,f:st,USE_IRIDESCENCE:ot,USE_ANISOTROPY:at}=nt,lt=nt.normalView||transformedNormalView,ct=it.pow2(),ut=_e.add(positionViewDirection).normalize(),ht=lt.dot(_e).clamp(),dt=lt.dot(positionViewDirection).clamp(),ft=lt.dot(ut).clamp(),pt=positionViewDirection.dot(ut).clamp();let mt=F_Schlick({f0:et,f90:rt,dotVH:pt}),At,gt;if(defined(ot)&&(mt=iridescence.mix(mt,st)),defined(at)){const bt=anisotropyT.dot(_e),Tt=anisotropyT.dot(positionViewDirection),wt=anisotropyT.dot(ut),Rt=anisotropyB.dot(_e),It=anisotropyB.dot(positionViewDirection),Lt=anisotropyB.dot(ut);At=V_GGX_SmithCorrelated_Anisotropic({alphaT,alphaB:ct,dotTV:Tt,dotBV:It,dotTL:bt,dotBL:Rt,dotNV:dt,dotNL:ht}),gt=D_GGX_Anisotropic({alphaT,alphaB:ct,dotNH:ft,dotTH:wt,dotBH:Lt})}else At=V_GGX_SmithCorrelated({alpha:ct,dotNL:ht,dotNV:dt}),gt=D_GGX({alpha:ct,dotNH:ft});return mt.mul(At).mul(gt)}),DFGApprox=Fn(({roughness:nt,dotNV:_e})=>{const et=vec4(-1,-.0275,-.572,.022),rt=vec4(1,.0425,1.04,-.04),it=nt.mul(et).add(rt),st=it.x.mul(it.x).min(_e.mul(-9.28).exp2()).mul(it.x).add(it.y);return vec2(-1.04,1.04).mul(st).add(it.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),EnvironmentBRDF=Fn(nt=>{const{dotNV:_e,specularColor:et,specularF90:rt,roughness:it}=nt,st=DFGApprox({dotNV:_e,roughness:it});return et.mul(st.x).add(rt.mul(st.y))}),Schlick_to_F0=Fn(({f:nt,f90:_e,dotVH:et})=>{const rt=et.oneMinus().saturate(),it=rt.mul(rt),st=rt.mul(it,it).clamp(0,.9999);return nt.sub(vec3(_e).mul(st)).div(st.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),D_Charlie=Fn(({roughness:nt,dotNH:_e})=>{const et=nt.pow2(),rt=float(1).div(et),st=_e.pow2().oneMinus().max(.0078125);return float(2).add(rt).mul(st.pow(rt.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),V_Neubelt=Fn(({dotNV:nt,dotNL:_e})=>float(1).div(float(4).mul(_e.add(nt).sub(_e.mul(nt))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),BRDF_Sheen=Fn(({lightDirection:nt})=>{const _e=nt.add(positionViewDirection).normalize(),et=transformedNormalView.dot(nt).clamp(),rt=transformedNormalView.dot(positionViewDirection).clamp(),it=transformedNormalView.dot(_e).clamp(),st=D_Charlie({roughness:sheenRoughness,dotNH:it}),ot=V_Neubelt({dotNV:rt,dotNL:et});return sheen.mul(st).mul(ot)}),LTC_Uv=Fn(({N:nt,V:_e,roughness:et})=>{const st=.0078125,ot=nt.dot(_e).saturate(),at=vec2(et,ot.oneMinus().sqrt());return at.assign(at.mul(.984375).add(st)),at}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),LTC_ClippedSphereFormFactor=Fn(({f:nt})=>{const _e=nt.length();return max$1(_e.mul(_e).add(nt.z).div(_e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),LTC_EdgeVectorFormFactor=Fn(({v1:nt,v2:_e})=>{const et=nt.dot(_e),rt=et.abs().toVar(),it=rt.mul(.0145206).add(.4965155).mul(rt).add(.8543985).toVar(),st=rt.add(4.1616724).mul(rt).add(3.417594).toVar(),ot=it.div(st),at=et.greaterThan(0).select(ot,max$1(et.mul(et).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(ot));return nt.cross(_e).mul(at)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),LTC_Evaluate=Fn(({N:nt,V:_e,P:et,mInv:rt,p0:it,p1:st,p2:ot,p3:at})=>{const lt=st.sub(it).toVar(),ct=at.sub(it).toVar(),ut=lt.cross(ct),ht=vec3().toVar();return If(ut.dot(et.sub(it)).greaterThanEqual(0),()=>{const dt=_e.sub(nt.mul(_e.dot(nt))).normalize(),ft=nt.cross(dt).negate(),pt=rt.mul(mat3(dt,ft,nt).transpose()).toVar(),mt=pt.mul(it.sub(et)).normalize().toVar(),At=pt.mul(st.sub(et)).normalize().toVar(),gt=pt.mul(ot.sub(et)).normalize().toVar(),bt=pt.mul(at.sub(et)).normalize().toVar(),Tt=vec3(0).toVar();Tt.addAssign(LTC_EdgeVectorFormFactor({v1:mt,v2:At})),Tt.addAssign(LTC_EdgeVectorFormFactor({v1:At,v2:gt})),Tt.addAssign(LTC_EdgeVectorFormFactor({v1:gt,v2:bt})),Tt.addAssign(LTC_EdgeVectorFormFactor({v1:bt,v2:mt})),ht.assign(vec3(LTC_ClippedSphereFormFactor({f:Tt})))}),ht}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),bC=1/6,w0=nt=>mul(bC,mul(nt,mul(nt,nt.negate().add(3)).sub(3)).add(1)),w1=nt=>mul(bC,mul(nt,mul(nt,mul(3,nt).sub(6))).add(4)),w2=nt=>mul(bC,mul(nt,mul(nt,mul(-3,nt).add(3)).add(3)).add(1)),w3=nt=>mul(bC,pow(nt,3)),g0=nt=>w0(nt).add(w1(nt)),g1=nt=>w2(nt).add(w3(nt)),h0=nt=>add(-1,w1(nt).div(w0(nt).add(w1(nt)))),h1=nt=>add(1,w3(nt).div(w2(nt).add(w3(nt)))),bicubic=(nt,_e,et)=>{const rt=nt.uvNode,it=mul(rt,_e.zw).add(.5),st=floor(it),ot=fract(it),at=g0(ot.x),lt=g1(ot.x),ct=h0(ot.x),ut=h1(ot.x),ht=h0(ot.y),dt=h1(ot.y),ft=vec2(st.x.add(ct),st.y.add(ht)).sub(.5).mul(_e.xy),pt=vec2(st.x.add(ut),st.y.add(ht)).sub(.5).mul(_e.xy),mt=vec2(st.x.add(ct),st.y.add(dt)).sub(.5).mul(_e.xy),At=vec2(st.x.add(ut),st.y.add(dt)).sub(.5).mul(_e.xy),gt=g0(ot.y).mul(add(at.mul(nt.uv(ft).level(et)),lt.mul(nt.uv(pt).level(et)))),bt=g1(ot.y).mul(add(at.mul(nt.uv(mt).level(et)),lt.mul(nt.uv(At).level(et))));return gt.add(bt)},textureBicubic=Fn(([nt,_e=float(3)])=>{const et=vec2(nt.size(int$1(_e))),rt=vec2(nt.size(int$1(_e.add(1)))),it=div(1,et),st=div(1,rt),ot=bicubic(nt,vec4(it,et),floor(_e)),at=bicubic(nt,vec4(st,rt),ceil(_e));return fract(_e).mix(ot,at)}),getVolumeTransmissionRay=Fn(([nt,_e,et,rt,it])=>{const st=vec3(refract(_e.negate(),normalize(nt),div(1,rt))),ot=vec3(length(it[0].xyz),length(it[1].xyz),length(it[2].xyz));return normalize(st).mul(et.mul(ot))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),applyIorToRoughness=Fn(([nt,_e])=>nt.mul(clamp$2(_e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),singleViewportMipTexture=viewportMipTexture(),getTransmissionSample=Fn(([nt,_e,et])=>{const rt=singleViewportMipTexture.uv(nt),it=log2(float(screenSize.x)).mul(applyIorToRoughness(_e,et));return textureBicubic(rt,it)}),volumeAttenuation=Fn(([nt,_e,et])=>(If(et.notEqual(0),()=>{const rt=log(_e).negate().div(et);return exp(rt.negate().mul(nt))}),vec3(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),getIBLVolumeRefraction=Fn(([nt,_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt])=>{let mt,At;if(pt){mt=vec4().toVar(),At=vec3().toVar();const Rt=ut.sub(1).mul(pt.mul(.025)),It=vec3(ut.sub(Rt),ut,ut.add(Rt));Loop({start:0,end:3},({i:Lt})=>{const $t=It.element(Lt),kt=getVolumeTransmissionRay(nt,_e,ht,$t,at),Dt=ot.add(kt),Ot=ct.mul(lt.mul(vec4(Dt,1))),zt=vec2(Ot.xy.div(Ot.w)).toVar();zt.addAssign(1),zt.divAssign(2),zt.assign(vec2(zt.x,zt.y.oneMinus()));const Ht=getTransmissionSample(zt,et,$t);mt.element(Lt).assign(Ht.element(Lt)),mt.a.addAssign(Ht.a),At.element(Lt).assign(rt.element(Lt).mul(volumeAttenuation(length(kt),dt,ft).element(Lt)))}),mt.a.divAssign(3)}else{const Rt=getVolumeTransmissionRay(nt,_e,ht,ut,at),It=ot.add(Rt),Lt=ct.mul(lt.mul(vec4(It,1))),$t=vec2(Lt.xy.div(Lt.w)).toVar();$t.addAssign(1),$t.divAssign(2),$t.assign(vec2($t.x,$t.y.oneMinus())),mt=getTransmissionSample($t,et,ut),At=rt.mul(volumeAttenuation(length(Rt),dt,ft))}const gt=At.rgb.mul(mt.rgb),bt=nt.dot(_e).clamp(),Tt=vec3(EnvironmentBRDF({dotNV:bt,specularColor:it,specularF90:st,roughness:et})),wt=At.r.add(At.g,At.b).div(3);return vec4(Tt.oneMinus().mul(gt),mt.a.oneMinus().mul(wt).oneMinus())}),XYZ_TO_REC709=mat3(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),Fresnel0ToIor=nt=>{const _e=nt.sqrt();return vec3(1).add(_e).div(vec3(1).sub(_e))},IorToFresnel0=(nt,_e)=>nt.sub(_e).div(nt.add(_e)).pow2(),evalSensitivity=(nt,_e)=>{const et=nt.mul(2*Math.PI*1e-9),rt=vec3(54856e-17,44201e-17,52481e-17),it=vec3(1681e3,1795300,2208400),st=vec3(43278e5,93046e5,66121e5),ot=float(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(et.mul(2239900).add(_e.x).cos()).mul(et.pow2().mul(-45282e5).exp());let at=rt.mul(st.mul(2*Math.PI).sqrt()).mul(it.mul(et).add(_e).cos()).mul(et.pow2().negate().mul(st).exp());return at=vec3(at.x.add(ot),at.y,at.z).div(10685e-11),XYZ_TO_REC709.mul(at)},evalIridescence=Fn(({outsideIOR:nt,eta2:_e,cosTheta1:et,thinFilmThickness:rt,baseF0:it})=>{const st=mix$2(nt,_e,smoothstep(0,.03,rt)),ot=nt.div(st).pow2().mul(float(1).sub(et.pow2())),lt=float(1).sub(ot).sqrt(),ct=IorToFresnel0(st,nt),ut=F_Schlick({f0:ct,f90:1,dotVH:et}),ht=ut.oneMinus(),dt=st.lessThan(nt).select(Math.PI,0),ft=float(Math.PI).sub(dt),pt=Fresnel0ToIor(it.clamp(0,.9999)),mt=IorToFresnel0(pt,st.toVec3()),At=F_Schlick({f0:mt,f90:1,dotVH:lt}),gt=vec3(pt.x.lessThan(st).select(Math.PI,0),pt.y.lessThan(st).select(Math.PI,0),pt.z.lessThan(st).select(Math.PI,0)),bt=st.mul(rt,lt,2),Tt=vec3(ft).add(gt),wt=ut.mul(At).clamp(1e-5,.9999),Rt=wt.sqrt(),It=ht.pow2().mul(At).div(vec3(1).sub(wt));let $t=ut.add(It),kt=It.sub(ht);for(let Dt=1;Dt<=2;++Dt){kt=kt.mul(Rt);const Ot=evalSensitivity(float(Dt).mul(bt),float(Dt).mul(Tt)).mul(2);$t=$t.add(kt.mul(Ot))}return $t.max(vec3(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),IBLSheenBRDF=Fn(({normal:nt,viewDir:_e,roughness:et})=>{const rt=nt.dot(_e).saturate(),it=et.pow2(),st=select(et.lessThan(.25),float(-339.2).mul(it).add(float(161.4).mul(et)).sub(25.9),float(-8.48).mul(it).add(float(14.3).mul(et)).sub(9.95)),ot=select(et.lessThan(.25),float(44).mul(it).sub(float(23.7).mul(et)).add(3.26),float(1.97).mul(it).sub(float(3.27).mul(et)).add(.72));return select(et.lessThan(.25),0,float(.1).mul(et).sub(.025)).add(st.mul(rt).add(ot).exp()).mul(1/Math.PI).saturate()}),clearcoatF0=vec3(.04),clearcoatF90=float(1);class PhysicalLightingModel extends LightingModel{constructor(_e=!1,et=!1,rt=!1,it=!1,st=!1,ot=!1){super(),this.clearcoat=_e,this.sheen=et,this.iridescence=rt,this.anisotropy=it,this.transmission=st,this.dispersion=ot,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(_e){if(this.clearcoat===!0&&(this.clearcoatRadiance=vec3().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=vec3().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=vec3().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=vec3().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=vec3().toVar("sheenSpecularIndirect")),this.iridescence===!0){const et=transformedNormalView.dot(positionViewDirection).clamp();this.iridescenceFresnel=evalIridescence({outsideIOR:float(1),eta2:iridescenceIOR,cosTheta1:et,thinFilmThickness:iridescenceThickness,baseF0:specularColor}),this.iridescenceF0=Schlick_to_F0({f:this.iridescenceFresnel,f90:1,dotVH:et})}if(this.transmission===!0){const et=positionWorld,rt=cameraPosition.sub(positionWorld).normalize(),it=transformedNormalWorld;_e.backdrop=getIBLVolumeRefraction(it,rt,roughness,diffuseColor,specularColor,specularF90,et,modelWorldMatrix,cameraViewMatrix,cameraProjectionMatrix,ior,thickness,attenuationColor,attenuationDistance,this.dispersion?dispersion:null),_e.backdropAlpha=transmission,diffuseColor.a.mulAssign(mix$2(1,_e.backdrop.a,transmission))}}computeMultiscattering(_e,et,rt){const it=transformedNormalView.dot(positionViewDirection).clamp(),st=DFGApprox({roughness,dotNV:it}),at=(this.iridescenceF0?iridescence.mix(specularColor,this.iridescenceF0):specularColor).mul(st.x).add(rt.mul(st.y)),ct=st.x.add(st.y).oneMinus(),ut=specularColor.add(specularColor.oneMinus().mul(.047619)),ht=at.mul(ut).div(ct.mul(ut).oneMinus());_e.addAssign(at),et.addAssign(ht.mul(ct))}direct({lightDirection:_e,lightColor:et,reflectedLight:rt}){const st=transformedNormalView.dot(_e).clamp().mul(et);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(st.mul(BRDF_Sheen({lightDirection:_e}))),this.clearcoat===!0){const at=transformedClearcoatNormalView.dot(_e).clamp().mul(et);this.clearcoatSpecularDirect.addAssign(at.mul(BRDF_GGX({lightDirection:_e,f0:clearcoatF0,f90:clearcoatF90,roughness:clearcoatRoughness,normalView:transformedClearcoatNormalView})))}rt.directDiffuse.addAssign(st.mul(BRDF_Lambert({diffuseColor:diffuseColor.rgb}))),rt.directSpecular.addAssign(st.mul(BRDF_GGX({lightDirection:_e,f0:specularColor,f90:1,roughness,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:_e,lightPosition:et,halfWidth:rt,halfHeight:it,reflectedLight:st,ltc_1:ot,ltc_2:at}){const lt=et.add(rt).sub(it),ct=et.sub(rt).sub(it),ut=et.sub(rt).add(it),ht=et.add(rt).add(it),dt=transformedNormalView,ft=positionViewDirection,pt=positionView.toVar(),mt=LTC_Uv({N:dt,V:ft,roughness}),At=ot.uv(mt).toVar(),gt=at.uv(mt).toVar(),bt=mat3(vec3(At.x,0,At.y),vec3(0,1,0),vec3(At.z,0,At.w)).toVar(),Tt=specularColor.mul(gt.x).add(specularColor.oneMinus().mul(gt.y)).toVar();st.directSpecular.addAssign(_e.mul(Tt).mul(LTC_Evaluate({N:dt,V:ft,P:pt,mInv:bt,p0:lt,p1:ct,p2:ut,p3:ht}))),st.directDiffuse.addAssign(_e.mul(diffuseColor).mul(LTC_Evaluate({N:dt,V:ft,P:pt,mInv:mat3(1,0,0,0,1,0,0,0,1),p0:lt,p1:ct,p2:ut,p3:ht})))}indirect(_e,et,rt){this.indirectDiffuse(_e,et,rt),this.indirectSpecular(_e,et,rt),this.ambientOcclusion(_e,et,rt)}indirectDiffuse({irradiance:_e,reflectedLight:et}){et.indirectDiffuse.addAssign(_e.mul(BRDF_Lambert({diffuseColor})))}indirectSpecular({radiance:_e,iblIrradiance:et,reflectedLight:rt}){if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(et.mul(sheen,IBLSheenBRDF({normal:transformedNormalView,viewDir:positionViewDirection,roughness:sheenRoughness}))),this.clearcoat===!0){const ct=transformedClearcoatNormalView.dot(positionViewDirection).clamp(),ut=EnvironmentBRDF({dotNV:ct,specularColor:clearcoatF0,specularF90:clearcoatF90,roughness:clearcoatRoughness});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(ut))}const it=vec3().toVar("singleScattering"),st=vec3().toVar("multiScattering"),ot=et.mul(1/Math.PI);this.computeMultiscattering(it,st,specularF90);const at=it.add(st),lt=diffuseColor.mul(at.r.max(at.g).max(at.b).oneMinus());rt.indirectSpecular.addAssign(_e.mul(it)),rt.indirectSpecular.addAssign(st.mul(ot)),rt.indirectDiffuse.addAssign(lt.mul(ot))}ambientOcclusion({ambientOcclusion:_e,reflectedLight:et}){const it=transformedNormalView.dot(positionViewDirection).clamp().add(_e),st=roughness.mul(-16).oneMinus().negate().exp2(),ot=_e.sub(it.pow(st).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(_e),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(_e),et.indirectDiffuse.mulAssign(_e),et.indirectSpecular.mulAssign(ot)}finish(_e){const{outgoingLight:et}=_e;if(this.clearcoat===!0){const rt=transformedClearcoatNormalView.dot(positionViewDirection).clamp(),it=F_Schlick({dotVH:rt,f0:clearcoatF0,f90:clearcoatF90}),st=et.mul(clearcoat.mul(it).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(clearcoat));et.assign(st)}if(this.sheen===!0){const rt=sheen.r.max(sheen.g).max(sheen.b).mul(.157).oneMinus(),it=et.mul(rt).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);et.assign(it)}}}const cubeUV_r0=float(1),cubeUV_m0=float(-2),cubeUV_r1=float(.8),cubeUV_m1=float(-1),cubeUV_r4=float(.4),cubeUV_m4=float(2),cubeUV_r5=float(.305),cubeUV_m5=float(3),cubeUV_r6=float(.21),cubeUV_m6=float(4),cubeUV_minMipLevel=float(4),cubeUV_minTileSize=float(16),getFace=Fn(([nt])=>{const _e=vec3(abs(nt)).toVar(),et=float(-1).toVar();return If(_e.x.greaterThan(_e.z),()=>{If(_e.x.greaterThan(_e.y),()=>{et.assign(select(nt.x.greaterThan(0),0,3))}).Else(()=>{et.assign(select(nt.y.greaterThan(0),1,4))})}).Else(()=>{If(_e.z.greaterThan(_e.y),()=>{et.assign(select(nt.z.greaterThan(0),2,5))}).Else(()=>{et.assign(select(nt.y.greaterThan(0),1,4))})}),et}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),getUV=Fn(([nt,_e])=>{const et=vec2().toVar();return If(_e.equal(0),()=>{et.assign(vec2(nt.z,nt.y).div(abs(nt.x)))}).ElseIf(_e.equal(1),()=>{et.assign(vec2(nt.x.negate(),nt.z.negate()).div(abs(nt.y)))}).ElseIf(_e.equal(2),()=>{et.assign(vec2(nt.x.negate(),nt.y).div(abs(nt.z)))}).ElseIf(_e.equal(3),()=>{et.assign(vec2(nt.z.negate(),nt.y).div(abs(nt.x)))}).ElseIf(_e.equal(4),()=>{et.assign(vec2(nt.x.negate(),nt.z).div(abs(nt.y)))}).Else(()=>{et.assign(vec2(nt.x,nt.y).div(abs(nt.z)))}),mul(.5,et.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),roughnessToMip=Fn(([nt])=>{const _e=float(0).toVar();return If(nt.greaterThanEqual(cubeUV_r1),()=>{_e.assign(cubeUV_r0.sub(nt).mul(cubeUV_m1.sub(cubeUV_m0)).div(cubeUV_r0.sub(cubeUV_r1)).add(cubeUV_m0))}).ElseIf(nt.greaterThanEqual(cubeUV_r4),()=>{_e.assign(cubeUV_r1.sub(nt).mul(cubeUV_m4.sub(cubeUV_m1)).div(cubeUV_r1.sub(cubeUV_r4)).add(cubeUV_m1))}).ElseIf(nt.greaterThanEqual(cubeUV_r5),()=>{_e.assign(cubeUV_r4.sub(nt).mul(cubeUV_m5.sub(cubeUV_m4)).div(cubeUV_r4.sub(cubeUV_r5)).add(cubeUV_m4))}).ElseIf(nt.greaterThanEqual(cubeUV_r6),()=>{_e.assign(cubeUV_r5.sub(nt).mul(cubeUV_m6.sub(cubeUV_m5)).div(cubeUV_r5.sub(cubeUV_r6)).add(cubeUV_m5))}).Else(()=>{_e.assign(float(-2).mul(log2(mul(1.16,nt))))}),_e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),getDirection=Fn(([nt,_e])=>{const et=nt.toVar();et.assign(mul(2,et).sub(1));const rt=vec3(et,1).toVar();return If(_e.equal(0),()=>{rt.assign(rt.zyx)}).ElseIf(_e.equal(1),()=>{rt.assign(rt.xzy),rt.xz.mulAssign(-1)}).ElseIf(_e.equal(2),()=>{rt.x.mulAssign(-1)}).ElseIf(_e.equal(3),()=>{rt.assign(rt.zyx),rt.xz.mulAssign(-1)}).ElseIf(_e.equal(4),()=>{rt.assign(rt.xzy),rt.xy.mulAssign(-1)}).ElseIf(_e.equal(5),()=>{rt.z.mulAssign(-1)}),rt}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),textureCubeUV=Fn(([nt,_e,et,rt,it,st])=>{const ot=float(et),at=vec3(_e),lt=clamp$2(roughnessToMip(ot),cubeUV_m0,st),ct=fract(lt),ut=floor(lt),ht=vec3(bilinearCubeUV(nt,at,ut,rt,it,st)).toVar();return If(ct.notEqual(0),()=>{const dt=vec3(bilinearCubeUV(nt,at,ut.add(1),rt,it,st)).toVar();ht.assign(mix$2(ht,dt,ct))}),ht}),bilinearCubeUV=Fn(([nt,_e,et,rt,it,st])=>{const ot=float(et).toVar(),at=vec3(_e),lt=float(getFace(at)).toVar(),ct=float(max$1(cubeUV_minMipLevel.sub(ot),0)).toVar();ot.assign(max$1(ot,cubeUV_minMipLevel));const ut=float(exp2(ot)).toVar(),ht=vec2(getUV(at,lt).mul(ut.sub(2)).add(1)).toVar();return If(lt.greaterThan(2),()=>{ht.y.addAssign(ut),lt.subAssign(3)}),ht.x.addAssign(lt.mul(ut)),ht.x.addAssign(ct.mul(mul(3,cubeUV_minTileSize))),ht.y.addAssign(mul(4,exp2(st).sub(ut))),ht.x.mulAssign(rt),ht.y.mulAssign(it),nt.uv(ht).grad(vec2(),vec2())}),getSample=Fn(({envMap:nt,mipInt:_e,outputDirection:et,theta:rt,axis:it,CUBEUV_TEXEL_WIDTH:st,CUBEUV_TEXEL_HEIGHT:ot,CUBEUV_MAX_MIP:at})=>{const lt=cos(rt),ct=et.mul(lt).add(it.cross(et).mul(sin(rt))).add(it.mul(it.dot(et).mul(lt.oneMinus())));return bilinearCubeUV(nt,ct,_e,st,ot,at)}),blur=Fn(({n:nt,latitudinal:_e,poleAxis:et,outputDirection:rt,weights:it,samples:st,dTheta:ot,mipInt:at,envMap:lt,CUBEUV_TEXEL_WIDTH:ct,CUBEUV_TEXEL_HEIGHT:ut,CUBEUV_MAX_MIP:ht})=>{const dt=vec3(select(_e,et,cross(et,rt))).toVar();If(all(dt.equals(vec3(0))),()=>{dt.assign(vec3(rt.z,0,rt.x.negate()))}),dt.assign(normalize(dt));const ft=vec3().toVar();return ft.addAssign(it.element(int$1(0)).mul(getSample({theta:0,axis:dt,outputDirection:rt,mipInt:at,envMap:lt,CUBEUV_TEXEL_WIDTH:ct,CUBEUV_TEXEL_HEIGHT:ut,CUBEUV_MAX_MIP:ht}))),Loop({start:int$1(1),end:nt},({i:pt})=>{If(pt.greaterThanEqual(st),()=>{Break()});const mt=float(ot.mul(float(pt))).toVar();ft.addAssign(it.element(pt).mul(getSample({theta:mt.mul(-1),axis:dt,outputDirection:rt,mipInt:at,envMap:lt,CUBEUV_TEXEL_WIDTH:ct,CUBEUV_TEXEL_HEIGHT:ut,CUBEUV_MAX_MIP:ht}))),ft.addAssign(it.element(pt).mul(getSample({theta:mt,axis:dt,outputDirection:rt,mipInt:at,envMap:lt,CUBEUV_TEXEL_WIDTH:ct,CUBEUV_TEXEL_HEIGHT:ut,CUBEUV_MAX_MIP:ht})))}),vec4(ft,1)});let _generator=null;const _cache=new WeakMap;function _generateCubeUVSize(nt){const _e=Math.log2(nt)-2,et=1/nt;return{texelWidth:1/(3*Math.max(Math.pow(2,_e),7*16)),texelHeight:et,maxMip:_e}}function _getPMREMFromTexture(nt){let _e=_cache.get(nt);if((_e!==void 0?_e.pmremVersion:-1)!==nt.pmremVersion){const rt=nt.image;if(nt.isCubeTexture)if(isCubeMapReady(rt))_e=_generator.fromCubemap(nt,_e);else return null;else if(isEquirectangularMapReady(rt))_e=_generator.fromEquirectangular(nt,_e);else return null;_e.pmremVersion=nt.pmremVersion,_cache.set(nt,_e)}return _e.texture}class PMREMNode extends TempNode{static get type(){return"PMREMNode"}constructor(_e,et=null,rt=null){super("vec3"),this._value=_e,this._pmrem=null,this.uvNode=et,this.levelNode=rt,this._generator=null;const it=new Texture;it.isRenderTargetTexture=!0,this._texture=texture(it),this._width=uniform(0),this._height=uniform(0),this._maxMip=uniform(0),this.updateBeforeType=NodeUpdateType.RENDER}set value(_e){this._value=_e,this._pmrem=null}get value(){return this._value}updateFromTexture(_e){const et=_generateCubeUVSize(_e.image.height);this._texture.value=_e,this._width.value=et.texelWidth,this._height.value=et.texelHeight,this._maxMip.value=et.maxMip}updateBefore(){let _e=this._pmrem;const et=_e?_e.pmremVersion:-1,rt=this._value;et!==rt.pmremVersion&&(rt.isPMREMTexture===!0?_e=rt:_e=_getPMREMFromTexture(rt),_e!==null&&(this._pmrem=_e,this.updateFromTexture(_e)))}setup(_e){_generator===null&&(_generator=_e.createPMREMGenerator()),this.updateBefore(_e);let et=this.uvNode;et===null&&_e.context.getUV&&(et=_e.context.getUV(this));const rt=this.value;_e.renderer.coordinateSystem===WebGLCoordinateSystem&&rt.isPMREMTexture!==!0&&rt.isRenderTargetTexture===!0&&(et=vec3(et.x.negate(),et.yz));let it=this.levelNode;return it===null&&_e.context.getTextureLevel&&(it=_e.context.getTextureLevel(this)),textureCubeUV(this._texture,et,it,this._width,this._height,this._maxMip)}}function isCubeMapReady(nt){if(nt==null)return!1;let _e=0;const et=6;for(let rt=0;rt<et;rt++)nt[rt]!==void 0&&_e++;return _e===et}function isEquirectangularMapReady(nt){return nt==null?!1:nt.height>0}const pmremTexture=nodeProxy(PMREMNode),_envNodeCache=new WeakMap;class EnvironmentNode extends LightingNode{static get type(){return"EnvironmentNode"}constructor(_e=null){super(),this.envNode=_e}setup(_e){const{material:et}=_e;let rt=this.envNode;if(rt.isTextureNode||rt.isMaterialReferenceNode){const ft=rt.isTextureNode?rt.value:et[rt.property];let pt=_envNodeCache.get(ft);pt===void 0&&(pt=pmremTexture(ft),_envNodeCache.set(ft,pt)),rt=pt}const st=et.envMap?reference("envMapIntensity","float",_e.material):reference("environmentIntensity","float",_e.scene),at=et.useAnisotropy===!0||et.anisotropy>0?transformedBentNormalView:transformedNormalView,lt=rt.context(createRadianceContext(roughness,at)).mul(st),ct=rt.context(createIrradianceContext(transformedNormalWorld)).mul(Math.PI).mul(st),ut=cache$2(lt),ht=cache$2(ct);_e.context.radiance.addAssign(ut),_e.context.iblIrradiance.addAssign(ht);const dt=_e.context.lightingModel.clearcoatRadiance;if(dt){const ft=rt.context(createRadianceContext(clearcoatRoughness,transformedClearcoatNormalView)).mul(st),pt=cache$2(ft);dt.addAssign(pt)}}}const createRadianceContext=(nt,_e)=>{let et=null;return{getUV:()=>(et===null&&(et=positionViewDirection.negate().reflect(_e),et=nt.mul(nt).mix(et,_e).normalize(),et=et.transformDirection(cameraViewMatrix)),et),getTextureLevel:()=>nt}},createIrradianceContext=nt=>({getUV:()=>nt,getTextureLevel:()=>float(1)}),_defaultValues$6=new MeshStandardMaterial;class MeshStandardNodeMaterial extends NodeMaterial{static get type(){return"MeshStandardNodeMaterial"}constructor(_e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(_defaultValues$6),this.setValues(_e)}setupEnvironment(_e){let et=super.setupEnvironment(_e);return et===null&&_e.environmentNode&&(et=_e.environmentNode),et?new EnvironmentNode(et):null}setupLightingModel(){return new PhysicalLightingModel}setupSpecular(){const _e=mix$2(vec3(.04),diffuseColor.rgb,metalness);specularColor.assign(_e),specularF90.assign(1)}setupVariants(){const _e=this.metalnessNode?float(this.metalnessNode):materialMetalness;metalness.assign(_e);let et=this.roughnessNode?float(this.roughnessNode):materialRoughness;et=getRoughness({roughness:et}),roughness.assign(et),this.setupSpecular(),diffuseColor.assign(vec4(diffuseColor.rgb.mul(_e.oneMinus()),diffuseColor.a))}copy(_e){return this.emissiveNode=_e.emissiveNode,this.metalnessNode=_e.metalnessNode,this.roughnessNode=_e.roughnessNode,super.copy(_e)}}const _defaultValues$5=new MeshPhysicalMaterial;class MeshPhysicalNodeMaterial extends MeshStandardNodeMaterial{static get type(){return"MeshPhysicalNodeMaterial"}constructor(_e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(_defaultValues$5),this.setValues(_e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const _e=this.iorNode?float(this.iorNode):materialIOR;ior.assign(_e),specularColor.assign(mix$2(min$1(pow2(ior.sub(1).div(ior.add(1))).mul(materialSpecularColor),vec3(1)).mul(materialSpecularIntensity),diffuseColor.rgb,metalness)),specularF90.assign(mix$2(materialSpecularIntensity,1,metalness))}setupLightingModel(){return new PhysicalLightingModel(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(_e){if(super.setupVariants(_e),this.useClearcoat){const et=this.clearcoatNode?float(this.clearcoatNode):materialClearcoat,rt=this.clearcoatRoughnessNode?float(this.clearcoatRoughnessNode):materialClearcoatRoughness;clearcoat.assign(et),clearcoatRoughness.assign(getRoughness({roughness:rt}))}if(this.useSheen){const et=this.sheenNode?vec3(this.sheenNode):materialSheen,rt=this.sheenRoughnessNode?float(this.sheenRoughnessNode):materialSheenRoughness;sheen.assign(et),sheenRoughness.assign(rt)}if(this.useIridescence){const et=this.iridescenceNode?float(this.iridescenceNode):materialIridescence,rt=this.iridescenceIORNode?float(this.iridescenceIORNode):materialIridescenceIOR,it=this.iridescenceThicknessNode?float(this.iridescenceThicknessNode):materialIridescenceThickness;iridescence.assign(et),iridescenceIOR.assign(rt),iridescenceThickness.assign(it)}if(this.useAnisotropy){const et=(this.anisotropyNode?vec2(this.anisotropyNode):materialAnisotropy).toVar();anisotropy.assign(et.length()),If(anisotropy.equal(0),()=>{et.assign(vec2(1,0))}).Else(()=>{et.divAssign(vec2(anisotropy)),anisotropy.assign(anisotropy.saturate())}),alphaT.assign(anisotropy.pow2().mix(roughness.pow2(),1)),anisotropyT.assign(TBNViewMatrix[0].mul(et.x).add(TBNViewMatrix[1].mul(et.y))),anisotropyB.assign(TBNViewMatrix[1].mul(et.x).sub(TBNViewMatrix[0].mul(et.y)))}if(this.useTransmission){const et=this.transmissionNode?float(this.transmissionNode):materialTransmission,rt=this.thicknessNode?float(this.thicknessNode):materialThickness,it=this.attenuationDistanceNode?float(this.attenuationDistanceNode):materialAttenuationDistance,st=this.attenuationColorNode?vec3(this.attenuationColorNode):materialAttenuationColor;if(transmission.assign(et),thickness.assign(rt),attenuationDistance.assign(it),attenuationColor.assign(st),this.useDispersion){const ot=this.dispersionNode?float(this.dispersionNode):materialDispersion;dispersion.assign(ot)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?vec3(this.clearcoatNormalNode):materialClearcoatNormal}setup(_e){_e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(_e),super.setup(_e)}copy(_e){return this.clearcoatNode=_e.clearcoatNode,this.clearcoatRoughnessNode=_e.clearcoatRoughnessNode,this.clearcoatNormalNode=_e.clearcoatNormalNode,this.sheenNode=_e.sheenNode,this.sheenRoughnessNode=_e.sheenRoughnessNode,this.iridescenceNode=_e.iridescenceNode,this.iridescenceIORNode=_e.iridescenceIORNode,this.iridescenceThicknessNode=_e.iridescenceThicknessNode,this.specularIntensityNode=_e.specularIntensityNode,this.specularColorNode=_e.specularColorNode,this.transmissionNode=_e.transmissionNode,this.thicknessNode=_e.thicknessNode,this.attenuationDistanceNode=_e.attenuationDistanceNode,this.attenuationColorNode=_e.attenuationColorNode,this.dispersionNode=_e.dispersionNode,this.anisotropyNode=_e.anisotropyNode,super.copy(_e)}}const getGradientIrradiance=Fn(({normal:nt,lightDirection:_e,builder:et})=>{const rt=nt.dot(_e),it=vec2(rt.mul(.5).add(.5),0);if(et.material.gradientMap){const st=materialReference("gradientMap","texture").context({getUV:()=>it});return vec3(st.r)}else{const st=it.fwidth().mul(.5);return mix$2(vec3(.7),vec3(1),smoothstep(float(.7).sub(st.x),float(.7).add(st.x),it.x))}});class ToonLightingModel extends LightingModel{direct({lightDirection:_e,lightColor:et,reflectedLight:rt},it,st){const ot=getGradientIrradiance({normal:normalGeometry,lightDirection:_e,builder:st}).mul(et);rt.directDiffuse.addAssign(ot.mul(BRDF_Lambert({diffuseColor:diffuseColor.rgb})))}indirect({ambientOcclusion:_e,irradiance:et,reflectedLight:rt}){rt.indirectDiffuse.addAssign(et.mul(BRDF_Lambert({diffuseColor}))),rt.indirectDiffuse.mulAssign(_e)}}const _defaultValues$4=new MeshToonMaterial;class MeshToonNodeMaterial extends NodeMaterial{static get type(){return"MeshToonNodeMaterial"}constructor(_e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_defaultValues$4),this.setValues(_e)}setupLightingModel(){return new ToonLightingModel}}class MatcapUVNode extends TempNode{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const _e=vec3(positionViewDirection.z,0,positionViewDirection.x.negate()).normalize(),et=positionViewDirection.cross(_e);return vec2(_e.dot(transformedNormalView),et.dot(transformedNormalView)).mul(.495).add(.5)}}const matcapUV=nodeImmutable(MatcapUVNode),_defaultValues$3=new MeshMatcapMaterial;class MeshMatcapNodeMaterial extends NodeMaterial{static get type(){return"MeshMatcapNodeMaterial"}constructor(_e){super(),this.lights=!1,this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(_defaultValues$3),this.setValues(_e)}setupVariants(_e){const et=matcapUV;let rt;_e.material.matcap?rt=materialReference("matcap","texture").context({getUV:()=>et}):rt=vec3(mix$2(.2,.8,et.y)),diffuseColor.rgb.mulAssign(rt.rgb)}}const _defaultValues$2=new PointsMaterial;class PointsNodeMaterial extends NodeMaterial{static get type(){return"PointsNodeMaterial"}constructor(_e){super(),this.isPointsNodeMaterial=!0,this.lights=!1,this.transparent=!0,this.sizeNode=null,this.setDefaultValues(_defaultValues$2),this.setValues(_e)}copy(_e){return this.sizeNode=_e.sizeNode,super.copy(_e)}}class RotateNode extends TempNode{static get type(){return"RotateNode"}constructor(_e,et){super(),this.positionNode=_e,this.rotationNode=et}getNodeType(_e){return this.positionNode.getNodeType(_e)}setup(_e){const{rotationNode:et,positionNode:rt}=this;if(this.getNodeType(_e)==="vec2"){const st=et.cos(),ot=et.sin();return mat2(st,ot,ot.negate(),st).mul(rt)}else{const st=et,ot=mat4(vec4(1,0,0,0),vec4(0,cos(st.x),sin(st.x).negate(),0),vec4(0,sin(st.x),cos(st.x),0),vec4(0,0,0,1)),at=mat4(vec4(cos(st.y),0,sin(st.y),0),vec4(0,1,0,0),vec4(sin(st.y).negate(),0,cos(st.y),0),vec4(0,0,0,1)),lt=mat4(vec4(cos(st.z),sin(st.z).negate(),0,0),vec4(sin(st.z),cos(st.z),0,0),vec4(0,0,1,0),vec4(0,0,0,1));return ot.mul(at).mul(lt).mul(vec4(rt,1)).xyz}}}const rotate=nodeProxy(RotateNode),_defaultValues$1=new SpriteMaterial;class SpriteNodeMaterial extends NodeMaterial{static get type(){return"SpriteNodeMaterial"}constructor(_e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(_defaultValues$1),this.setValues(_e)}setupPosition({object:_e,camera:et,context:rt}){const it=this.sizeAttenuation,{positionNode:st,rotationNode:ot,scaleNode:at}=this,lt=positionLocal;let ct=modelViewMatrix.mul(vec3(st||0)),ut=vec2(modelWorldMatrix[0].xyz.length(),modelWorldMatrix[1].xyz.length());at!==null&&(ut=ut.mul(at)),!it&&et.isPerspectiveCamera&&(ut=ut.mul(ct.z.negate()));let ht=lt.xy;if(_e.center&&_e.center.isVector2===!0){const mt=reference$1("center","vec2");ht=ht.sub(mt.sub(.5))}ht=ht.mul(ut);const dt=float(ot||materialRotation),ft=rotate(ht,dt);ct=vec4(ct.xy.add(ft),ct.zw);const pt=cameraProjectionMatrix.mul(ct);return rt.vertex=lt,pt}copy(_e){return this.positionNode=_e.positionNode,this.rotationNode=_e.rotationNode,this.scaleNode=_e.scaleNode,super.copy(_e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(_e){this._useSizeAttenuation!==_e&&(this._useSizeAttenuation=_e,this.needsUpdate=!0)}}class ShadowMaskModel extends LightingModel{constructor(){super(),this.shadowNode=float(1).toVar("shadowMask")}direct({shadowMask:_e}){this.shadowNode.mulAssign(_e)}finish(_e){diffuseColor.a.mulAssign(this.shadowNode.oneMinus()),_e.outgoingLight.rgb.assign(diffuseColor.rgb)}}const _defaultValues=new ShadowMaterial;class ShadowNodeMaterial extends NodeMaterial{static get type(){return"ShadowNodeMaterial"}constructor(_e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_defaultValues),this.setValues(_e)}setupLightingModel(){return new ShadowMaskModel}}Fn(({texture:nt,uv:_e})=>{const rt=vec3().toVar();return If(_e.x.lessThan(1e-4),()=>{rt.assign(vec3(1,0,0))}).ElseIf(_e.y.lessThan(1e-4),()=>{rt.assign(vec3(0,1,0))}).ElseIf(_e.z.lessThan(1e-4),()=>{rt.assign(vec3(0,0,1))}).ElseIf(_e.x.greaterThan(1-1e-4),()=>{rt.assign(vec3(-1,0,0))}).ElseIf(_e.y.greaterThan(1-1e-4),()=>{rt.assign(vec3(0,-1,0))}).ElseIf(_e.z.greaterThan(1-1e-4),()=>{rt.assign(vec3(0,0,-1))}).Else(()=>{const st=nt.uv(_e.add(vec3(-.01,0,0))).r.sub(nt.uv(_e.add(vec3(.01,0,0))).r),ot=nt.uv(_e.add(vec3(0,-.01,0))).r.sub(nt.uv(_e.add(vec3(0,.01,0))).r),at=nt.uv(_e.add(vec3(0,0,-.01))).r.sub(nt.uv(_e.add(vec3(0,0,.01))).r);rt.assign(vec3(st,ot,at))}),rt.normalize()});class Animation{constructor(_e,et){this.nodes=_e,this.info=et,this.animationLoop=null,this.requestId=null,this._init()}_init(){const _e=(et,rt)=>{this.requestId=self.requestAnimationFrame(_e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.animationLoop!==null&&this.animationLoop(et,rt)};_e()}dispose(){self.cancelAnimationFrame(this.requestId),this.requestId=null}setAnimationLoop(_e){this.animationLoop=_e}}class ChainMap{constructor(){this.weakMap=new WeakMap}get(_e){let et=this.weakMap;for(let rt=0;rt<_e.length;rt++)if(et=et.get(_e[rt]),et===void 0)return;return et.get(_e[_e.length-1])}set(_e,et){let rt=this.weakMap;for(let it=0;it<_e.length;it++){const st=_e[it];rt.has(st)===!1&&rt.set(st,new WeakMap),rt=rt.get(st)}return rt.set(_e[_e.length-1],et)}delete(_e){let et=this.weakMap;for(let rt=0;rt<_e.length;rt++)if(et=et.get(_e[rt]),et===void 0)return!1;return et.delete(_e[_e.length-1])}}const _plane$1=new Plane;class ClippingContext{constructor(){this.version=0,this.globalClippingCount=0,this.localClippingCount=0,this.localClippingEnabled=!1,this.localClipIntersection=!1,this.planes=[],this.parentVersion=0,this.viewNormalMatrix=new Matrix3,this.cacheKey=0}projectPlanes(_e,et){const rt=_e.length,it=this.planes;for(let st=0;st<rt;st++){_plane$1.copy(_e[st]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const ot=it[et+st],at=_plane$1.normal;ot.x=-at.x,ot.y=-at.y,ot.z=-at.z,ot.w=_plane$1.constant}}updateGlobal(_e,et){const rt=_e.clippingPlanes;this.viewMatrix=et.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix);let it=!1;if(Array.isArray(rt)&&rt.length!==0){const st=rt.length;if(st!==this.globalClippingCount){const ot=[];for(let at=0;at<st;at++)ot.push(new Vector4);this.globalClippingCount=st,this.planes=ot,it=!0}this.projectPlanes(rt,0)}else this.globalClippingCount!==0&&(this.globalClippingCount=0,this.planes=[],it=!0);_e.localClippingEnabled!==this.localClippingEnabled&&(this.localClippingEnabled=_e.localClippingEnabled,it=!0),it&&(this.version++,this.cacheKey=hash$1(this.globalClippingCount,this.localClippingEnabled===!0?1:0))}update(_e,et){let rt=!1;if(this!==_e&&_e.version!==this.parentVersion&&(this.globalClippingCount=et.isShadowNodeMaterial?0:_e.globalClippingCount,this.localClippingEnabled=_e.localClippingEnabled,this.planes=Array.from(_e.planes),this.parentVersion=_e.version,this.viewMatrix=_e.viewMatrix,this.viewNormalMatrix=_e.viewNormalMatrix,rt=!0),this.localClippingEnabled){const it=et.clippingPlanes;if(Array.isArray(it)&&it.length!==0){const st=it.length,ot=this.planes,at=this.globalClippingCount;if(rt||st!==this.localClippingCount){ot.length=at+st;for(let lt=0;lt<st;lt++)ot[at+lt]=new Vector4;this.localClippingCount=st,rt=!0}this.projectPlanes(it,at)}else this.localClippingCount!==0&&(this.localClippingCount=0,rt=!0);this.localClipIntersection!==et.clipIntersection&&(this.localClipIntersection=et.clipIntersection,rt=!0)}rt&&(this.version+=_e.version,this.cacheKey=hash$1(_e.cacheKey,this.localClippingCount,this.localClipIntersection===!0?1:0))}}let _id$7=0;function getKeys(nt){const _e=Object.keys(nt);let et=Object.getPrototypeOf(nt);for(;et;){const rt=Object.getOwnPropertyDescriptors(et);for(const it in rt)if(rt[it]!==void 0){const st=rt[it];st&&typeof st.get=="function"&&_e.push(it)}et=Object.getPrototypeOf(et)}return _e}class RenderObject{constructor(_e,et,rt,it,st,ot,at,lt,ct){this._nodes=_e,this._geometries=et,this.id=_id$7++,this.renderer=rt,this.object=it,this.material=st,this.scene=ot,this.camera=at,this.lightsNode=lt,this.context=ct,this.geometry=it.geometry,this.version=st.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.updateClipping(ct.clippingContext),this.clippingContextVersion=this.clippingContext.version,this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(_e){const et=this.material;let rt=this.clippingContext;Array.isArray(et.clippingPlanes)?((rt===_e||!rt)&&(rt=new ClippingContext,this.clippingContext=rt),rt.update(_e,et)):this.clippingContext!==_e&&(this.clippingContext=_e)}get clippingNeedsUpdate(){return this.clippingContext.version===this.clippingContextVersion?!1:(this.clippingContextVersion=this.clippingContext.version,!0)}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().monitor)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getIndex(){return this._geometries.getIndex(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}getAttributes(){if(this.attributes!==null)return this.attributes;const _e=this.getNodeBuilderState().nodeAttributes,et=this.geometry,rt=[],it=new Set;for(const st of _e){const ot=st.node&&st.node.attribute?st.node.attribute:et.getAttribute(st.name);if(ot===void 0)continue;rt.push(ot);const at=ot.isInterleavedBufferAttribute?ot.data:ot;it.add(at)}return this.attributes=rt,this.vertexBuffers=Array.from(it.values()),rt}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:_e,material:et,geometry:rt,group:it,drawRange:st}=this,ot=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),at=this.getIndex(),lt=at!==null,ct=rt.isInstancedBufferGeometry?rt.instanceCount:_e.count>1?_e.count:1;if(ct===0)return null;if(ot.instanceCount=ct,_e.isBatchedMesh===!0)return ot;let ut=1;et.wireframe===!0&&!_e.isPoints&&!_e.isLineSegments&&!_e.isLine&&!_e.isLineLoop&&(ut=2);let ht=st.start*ut,dt=(st.start+st.count)*ut;it!==null&&(ht=Math.max(ht,it.start*ut),dt=Math.min(dt,(it.start+it.count)*ut));const ft=lt===!0?at.count:rt.attributes.position.count;ht=Math.max(ht,0),dt=Math.min(dt,ft);const pt=dt-ht;return pt<0||pt===1/0?null:(ot.vertexCount=pt,ot.firstVertex=ht,ot)}getGeometryCacheKey(){const{geometry:_e}=this;let et="";for(const rt of Object.keys(_e.attributes).sort()){const it=_e.attributes[rt];et+=rt+",",it.data&&(et+=it.data.stride+","),it.offset&&(et+=it.offset+","),it.itemSize&&(et+=it.itemSize+","),it.normalized&&(et+="n,")}return _e.index&&(et+="index,"),et}getMaterialCacheKey(){const{object:_e,material:et}=this;let rt=et.customProgramCacheKey();for(const it of getKeys(et)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(it))continue;const st=et[it];let ot;if(st!==null){const at=typeof st;at==="number"?ot=st!==0?"1":"0":at==="object"?(ot="{",st.isTexture&&(ot+=st.mapping),ot+="}"):ot=String(st)}else ot=String(st);rt+=ot+","}return rt+=this.clippingContext.cacheKey+",",_e.geometry&&(rt+=this.getGeometryCacheKey()),_e.skeleton&&(rt+=_e.skeleton.bones.length+","),_e.morphTargetInfluences&&(rt+=_e.morphTargetInfluences.length+","),_e.isBatchedMesh&&(rt+=_e._matricesTexture.uuid+",",_e._colorsTexture!==null&&(rt+=_e._colorsTexture.uuid+",")),_e.count>1&&(rt+=_e.uuid+","),hashString(rt)}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let _e=this._nodes.getCacheKey(this.scene,this.lightsNode);return this.object.receiveShadow&&(_e+=1),_e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const chainArray=[];class RenderObjects{constructor(_e,et,rt,it,st,ot){this.renderer=_e,this.nodes=et,this.geometries=rt,this.pipelines=it,this.bindings=st,this.info=ot,this.chainMaps={}}get(_e,et,rt,it,st,ot,at){const lt=this.getChainMap(at);chainArray[0]=_e,chainArray[1]=et,chainArray[2]=ot,chainArray[3]=st;let ct=lt.get(chainArray);return ct===void 0?(ct=this.createRenderObject(this.nodes,this.geometries,this.renderer,_e,et,rt,it,st,ot,at),lt.set(chainArray,ct)):(ct.updateClipping(ot.clippingContext),(ct.version!==et.version||ct.needsUpdate)&&(ct.initialCacheKey!==ct.getCacheKey()?(ct.dispose(),ct=this.get(_e,et,rt,it,st,ot,at)):ct.version=et.version)),ct}getChainMap(_e="default"){return this.chainMaps[_e]||(this.chainMaps[_e]=new ChainMap)}dispose(){this.chainMaps={}}createRenderObject(_e,et,rt,it,st,ot,at,lt,ct,ut){const ht=this.getChainMap(ut),dt=new RenderObject(_e,et,rt,it,st,ot,at,lt,ct);return dt.onDispose=()=>{this.pipelines.delete(dt),this.bindings.delete(dt),this.nodes.delete(dt),ht.delete(dt.getChainArray())},dt}}class DataMap{constructor(){this.data=new WeakMap}get(_e){let et=this.data.get(_e);return et===void 0&&(et={},this.data.set(_e,et)),et}delete(_e){let et;return this.data.has(_e)&&(et=this.data.get(_e),this.data.delete(_e)),et}has(_e){return this.data.has(_e)}dispose(){this.data=new WeakMap}}const AttributeType={VERTEX:1,INDEX:2,STORAGE:4},GPU_CHUNK_BYTES=16,BlendColorFactor=211,OneMinusBlendColorFactor=212;class Attributes extends DataMap{constructor(_e){super(),this.backend=_e}delete(_e){const et=super.delete(_e);return et!==void 0&&this.backend.destroyAttribute(_e),et}update(_e,et){const rt=this.get(_e);if(rt.version===void 0)et===AttributeType.VERTEX?this.backend.createAttribute(_e):et===AttributeType.INDEX?this.backend.createIndexAttribute(_e):et===AttributeType.STORAGE&&this.backend.createStorageAttribute(_e),rt.version=this._getBufferAttribute(_e).version;else{const it=this._getBufferAttribute(_e);(rt.version<it.version||it.usage===DynamicDrawUsage)&&(this.backend.updateAttribute(_e),rt.version=it.version)}}_getBufferAttribute(_e){return _e.isInterleavedBufferAttribute&&(_e=_e.data),_e}}function arrayNeedsUint32(nt){for(let _e=nt.length-1;_e>=0;--_e)if(nt[_e]>=65535)return!0;return!1}function getWireframeVersion(nt){return nt.index!==null?nt.index.version:nt.attributes.position.version}function getWireframeIndex(nt){const _e=[],et=nt.index,rt=nt.attributes.position;if(et!==null){const st=et.array;for(let ot=0,at=st.length;ot<at;ot+=3){const lt=st[ot+0],ct=st[ot+1],ut=st[ot+2];_e.push(lt,ct,ct,ut,ut,lt)}}else{const st=rt.array;for(let ot=0,at=st.length/3-1;ot<at;ot+=3){const lt=ot+0,ct=ot+1,ut=ot+2;_e.push(lt,ct,ct,ut,ut,lt)}}const it=new(arrayNeedsUint32(_e)?Uint32BufferAttribute:Uint16BufferAttribute)(_e,1);return it.version=getWireframeVersion(nt),it}class Geometries extends DataMap{constructor(_e,et){super(),this.attributes=_e,this.info=et,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(_e){const et=_e.geometry;return super.has(et)&&this.get(et).initialized===!0}updateForRender(_e){this.has(_e)===!1&&this.initGeometry(_e),this.updateAttributes(_e)}initGeometry(_e){const et=_e.geometry,rt=this.get(et);rt.initialized=!0,this.info.memory.geometries++;const it=()=>{this.info.memory.geometries--;const st=et.index,ot=_e.getAttributes();st!==null&&this.attributes.delete(st);for(const lt of ot)this.attributes.delete(lt);const at=this.wireframes.get(et);at!==void 0&&this.attributes.delete(at),et.removeEventListener("dispose",it)};et.addEventListener("dispose",it)}updateAttributes(_e){const et=_e.getAttributes();for(const it of et)it.isStorageBufferAttribute||it.isStorageInstancedBufferAttribute?this.updateAttribute(it,AttributeType.STORAGE):this.updateAttribute(it,AttributeType.VERTEX);const rt=this.getIndex(_e);rt!==null&&this.updateAttribute(rt,AttributeType.INDEX)}updateAttribute(_e,et){const rt=this.info.render.calls;_e.isInterleavedBufferAttribute?this.attributeCall.get(_e)===void 0?(this.attributes.update(_e,et),this.attributeCall.set(_e,rt)):this.attributeCall.get(_e.data)!==rt&&(this.attributes.update(_e,et),this.attributeCall.set(_e.data,rt),this.attributeCall.set(_e,rt)):this.attributeCall.get(_e)!==rt&&(this.attributes.update(_e,et),this.attributeCall.set(_e,rt))}getIndex(_e){const{geometry:et,material:rt}=_e;let it=et.index;if(rt.wireframe===!0){const st=this.wireframes;let ot=st.get(et);ot===void 0?(ot=getWireframeIndex(et),st.set(et,ot)):ot.version!==getWireframeVersion(et)&&(this.attributes.delete(ot),ot=getWireframeIndex(et),st.set(et,ot)),it=ot}return it}}class Info{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.compute={calls:0,frameCalls:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.memory={geometries:0,textures:0}}update(_e,et,rt){this.render.drawCalls++,_e.isMesh||_e.isSprite?this.render.triangles+=rt*(et/3):_e.isPoints?this.render.points+=rt*et:_e.isLineSegments?this.render.lines+=rt*(et/2):_e.isLine?this.render.lines+=rt*(et-1):console.error("THREE.WebGPUInfo: Unknown object type.")}updateTimestamp(_e,et){this[_e].timestampCalls===0&&(this[_e].timestamp=0),this[_e].timestamp+=et,this[_e].timestampCalls++,this[_e].timestampCalls>=this[_e].previousFrameCalls&&(this[_e].timestampCalls=0)}reset(){const _e=this.render.frameCalls;this.render.previousFrameCalls=_e;const et=this.compute.frameCalls;this.compute.previousFrameCalls=et,this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class Pipeline{constructor(_e){this.cacheKey=_e,this.usedTimes=0}}class RenderPipeline extends Pipeline{constructor(_e,et,rt){super(_e),this.vertexProgram=et,this.fragmentProgram=rt}}class ComputePipeline extends Pipeline{constructor(_e,et){super(_e),this.computeProgram=et,this.isComputePipeline=!0}}let _id$6=0;class ProgrammableStage{constructor(_e,et,rt=null,it=null){this.id=_id$6++,this.code=_e,this.stage=et,this.transforms=rt,this.attributes=it,this.usedTimes=0}}class Pipelines extends DataMap{constructor(_e,et){super(),this.backend=_e,this.nodes=et,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(_e,et){const{backend:rt}=this,it=this.get(_e);if(this._needsComputeUpdate(_e)){const st=it.pipeline;st&&(st.usedTimes--,st.computeProgram.usedTimes--);const ot=this.nodes.getForCompute(_e);let at=this.programs.compute.get(ot.computeShader);at===void 0&&(st&&st.computeProgram.usedTimes===0&&this._releaseProgram(st.computeProgram),at=new ProgrammableStage(ot.computeShader,"compute",ot.transforms,ot.nodeAttributes),this.programs.compute.set(ot.computeShader,at),rt.createProgram(at));const lt=this._getComputeCacheKey(_e,at);let ct=this.caches.get(lt);ct===void 0&&(st&&st.usedTimes===0&&this._releasePipeline(st),ct=this._getComputePipeline(_e,at,lt,et)),ct.usedTimes++,at.usedTimes++,it.version=_e.version,it.pipeline=ct}return it.pipeline}getForRender(_e,et=null){const{backend:rt}=this,it=this.get(_e);if(this._needsRenderUpdate(_e)){const st=it.pipeline;st&&(st.usedTimes--,st.vertexProgram.usedTimes--,st.fragmentProgram.usedTimes--);const ot=_e.getNodeBuilderState();let at=this.programs.vertex.get(ot.vertexShader);at===void 0&&(st&&st.vertexProgram.usedTimes===0&&this._releaseProgram(st.vertexProgram),at=new ProgrammableStage(ot.vertexShader,"vertex"),this.programs.vertex.set(ot.vertexShader,at),rt.createProgram(at));let lt=this.programs.fragment.get(ot.fragmentShader);lt===void 0&&(st&&st.fragmentProgram.usedTimes===0&&this._releaseProgram(st.fragmentProgram),lt=new ProgrammableStage(ot.fragmentShader,"fragment"),this.programs.fragment.set(ot.fragmentShader,lt),rt.createProgram(lt));const ct=this._getRenderCacheKey(_e,at,lt);let ut=this.caches.get(ct);ut===void 0?(st&&st.usedTimes===0&&this._releasePipeline(st),ut=this._getRenderPipeline(_e,at,lt,ct,et)):_e.pipeline=ut,ut.usedTimes++,at.usedTimes++,lt.usedTimes++,it.pipeline=ut}return it.pipeline}delete(_e){const et=this.get(_e).pipeline;return et&&(et.usedTimes--,et.usedTimes===0&&this._releasePipeline(et),et.isComputePipeline?(et.computeProgram.usedTimes--,et.computeProgram.usedTimes===0&&this._releaseProgram(et.computeProgram)):(et.fragmentProgram.usedTimes--,et.vertexProgram.usedTimes--,et.vertexProgram.usedTimes===0&&this._releaseProgram(et.vertexProgram),et.fragmentProgram.usedTimes===0&&this._releaseProgram(et.fragmentProgram))),super.delete(_e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(_e){this.getForRender(_e)}_getComputePipeline(_e,et,rt,it){rt=rt||this._getComputeCacheKey(_e,et);let st=this.caches.get(rt);return st===void 0&&(st=new ComputePipeline(rt,et),this.caches.set(rt,st),this.backend.createComputePipeline(st,it)),st}_getRenderPipeline(_e,et,rt,it,st){it=it||this._getRenderCacheKey(_e,et,rt);let ot=this.caches.get(it);return ot===void 0&&(ot=new RenderPipeline(it,et,rt),this.caches.set(it,ot),_e.pipeline=ot,this.backend.createRenderPipeline(_e,st)),ot}_getComputeCacheKey(_e,et){return _e.id+","+et.id}_getRenderCacheKey(_e,et,rt){return et.id+","+rt.id+","+this.backend.getRenderCacheKey(_e)}_releasePipeline(_e){this.caches.delete(_e.cacheKey)}_releaseProgram(_e){const et=_e.code,rt=_e.stage;this.programs[rt].delete(et)}_needsComputeUpdate(_e){const et=this.get(_e);return et.pipeline===void 0||et.version!==_e.version}_needsRenderUpdate(_e){return this.get(_e).pipeline===void 0||this.backend.needsRenderUpdate(_e)}}class Bindings extends DataMap{constructor(_e,et,rt,it,st,ot){super(),this.backend=_e,this.textures=rt,this.pipelines=st,this.attributes=it,this.nodes=et,this.info=ot,this.pipelines.bindings=this}getForRender(_e){const et=_e.getBindings();for(const rt of et){const it=this.get(rt);it.bindGroup===void 0&&(this._init(rt),this.backend.createBindings(rt,et),it.bindGroup=rt)}return et}getForCompute(_e){const et=this.nodes.getForCompute(_e).bindings;for(const rt of et){const it=this.get(rt);it.bindGroup===void 0&&(this._init(rt),this.backend.createBindings(rt,et),it.bindGroup=rt)}return et}updateForCompute(_e){this._updateBindings(this.getForCompute(_e))}updateForRender(_e){this._updateBindings(this.getForRender(_e))}_updateBindings(_e){for(const et of _e)this._update(et,_e)}_init(_e){for(const et of _e.bindings)if(et.isSampledTexture)this.textures.updateTexture(et.texture);else if(et.isStorageBuffer){const rt=et.attribute;this.attributes.update(rt,AttributeType.STORAGE)}}_update(_e,et){const{backend:rt}=this;let it=!1;for(const st of _e.bindings)if(!(st.isNodeUniformsGroup&&!this.nodes.updateGroup(st))){if(st.isUniformBuffer)st.update()&&rt.updateBinding(st);else if(st.isSampler)st.update();else if(st.isSampledTexture){st.needsBindingsUpdate(this.textures.get(st.texture).generation)&&(it=!0);const ot=st.update(),at=st.texture;ot&&this.textures.updateTexture(at);const lt=rt.get(at);if(rt.isWebGPUBackend===!0&&lt.texture===void 0&&lt.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",st,ot,at,st.textureNode.value,it),this.textures.updateTexture(at),it=!0),at.isStorageTexture===!0){const ct=this.get(at);st.store===!0?ct.needsMipmap=!0:at.generateMipmaps===!0&&this.textures.needsMipmaps(at)&&ct.needsMipmap===!0&&(this.backend.generateMipmaps(at),ct.needsMipmap=!1)}}}it===!0&&this.backend.updateBindings(_e,et)}}class NodeAttribute{constructor(_e,et,rt=null){this.isNodeAttribute=!0,this.name=_e,this.type=et,this.node=rt}}class NodeUniform{constructor(_e,et,rt){this.isNodeUniform=!0,this.name=_e,this.type=et,this.node=rt.getSelf()}get value(){return this.node.value}set value(_e){this.node.value=_e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class NodeVar{constructor(_e,et){this.isNodeVar=!0,this.name=_e,this.type=et}}class NodeVarying extends NodeVar{constructor(_e,et){super(_e,et),this.needsInterpolation=!1,this.isNodeVarying=!0}}class NodeCode{constructor(_e,et,rt=""){this.name=_e,this.type=et,this.code=rt,Object.defineProperty(this,"isNodeCode",{value:!0})}}let id$1$1=0;class NodeCache{constructor(_e=null){this.id=id$1$1++,this.nodesData=new WeakMap,this.parent=_e}getData(_e){let et=this.nodesData.get(_e);return et===void 0&&this.parent!==null&&(et=this.parent.getData(_e)),et}setData(_e,et){this.nodesData.set(_e,et)}}class ParameterNode extends PropertyNode{static get type(){return"ParameterNode"}constructor(_e,et=null){super(_e,et),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class CodeNode extends Node$1{static get type(){return"CodeNode"}constructor(_e="",et=[],rt=""){super("code"),this.isCodeNode=!0,this.code=_e,this.language=rt,this.includes=et}isGlobal(){return!0}setIncludes(_e){return this.includes=_e,this}getIncludes(){return this.includes}generate(_e){const et=this.getIncludes(_e);for(const it of et)it.build(_e);const rt=_e.getCodeFromNode(this,this.getNodeType(_e));return rt.code=this.code,rt.code}serialize(_e){super.serialize(_e),_e.code=this.code,_e.language=this.language}deserialize(_e){super.deserialize(_e),this.code=_e.code,this.language=_e.language}}class FunctionNode extends CodeNode{static get type(){return"FunctionNode"}constructor(_e="",et=[],rt=""){super(_e,et,rt)}getNodeType(_e){return this.getNodeFunction(_e).type}getInputs(_e){return this.getNodeFunction(_e).inputs}getNodeFunction(_e){const et=_e.getDataFromNode(this);let rt=et.nodeFunction;return rt===void 0&&(rt=_e.parser.parseFunction(this.code),et.nodeFunction=rt),rt}generate(_e,et){super.generate(_e);const rt=this.getNodeFunction(_e),it=rt.name,st=rt.type,ot=_e.getCodeFromNode(this,st);it!==""&&(ot.name=it);const at=_e.getPropertyName(ot),lt=this.getNodeFunction(_e).getCode(at);return ot.code=lt+`
`,et==="property"?at:_e.format(`${at}()`,st,et)}}class Uniform{constructor(_e,et){this.name=_e,this.value=et,this.boundary=0,this.itemSize=0,this.offset=0}setValue(_e){this.value=_e}getValue(){return this.value}}class NumberUniform extends Uniform{constructor(_e,et=0){super(_e,et),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class Vector2Uniform extends Uniform{constructor(_e,et=new Vector2){super(_e,et),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Vector3Uniform extends Uniform{constructor(_e,et=new Vector3){super(_e,et),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class Vector4Uniform extends Uniform{constructor(_e,et=new Vector4){super(_e,et),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class ColorUniform extends Uniform{constructor(_e,et=new Color){super(_e,et),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Matrix3Uniform extends Uniform{constructor(_e,et=new Matrix3){super(_e,et),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class Matrix4Uniform extends Uniform{constructor(_e,et=new Matrix4){super(_e,et),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class NumberNodeUniform extends NumberUniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class Vector2NodeUniform extends Vector2Uniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class Vector3NodeUniform extends Vector3Uniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class Vector4NodeUniform extends Vector4Uniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class ColorNodeUniform extends ColorUniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class Matrix3NodeUniform extends Matrix3Uniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class Matrix4NodeUniform extends Matrix4Uniform{constructor(_e){super(_e.name,_e.value),this.nodeUniform=_e}getValue(){return this.nodeUniform.value}}class StackNode extends Node$1{static get type(){return"StackNode"}constructor(_e=null){super(),this.nodes=[],this.outputNode=null,this.parent=_e,this._currentCond=null,this.isStackNode=!0}getNodeType(_e){return this.outputNode?this.outputNode.getNodeType(_e):"void"}add(_e){return this.nodes.push(_e),this}If(_e,et){const rt=new ShaderNode(et);return this._currentCond=select(_e,rt),this.add(this._currentCond)}ElseIf(_e,et){const rt=new ShaderNode(et),it=select(_e,rt);return this._currentCond.elseNode=it,this._currentCond=it,this}Else(_e){return this._currentCond.elseNode=new ShaderNode(_e),this}build(_e,...et){const rt=getCurrentStack();setCurrentStack(this);for(const it of this.nodes)it.build(_e,"void");return setCurrentStack(rt),this.outputNode?this.outputNode.build(_e,...et):super.build(_e,...et)}else(..._e){return console.warn("TSL.StackNode: .else() has been renamed to .Else()."),this.Else(..._e)}elseif(..._e){return console.warn("TSL.StackNode: .elseif() has been renamed to .ElseIf()."),this.ElseIf(..._e)}}const stack=nodeProxy(StackNode),LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera(-1,1,1,-1,0,1),_cubeCamera=new PerspectiveCamera(90,1),_clearColor$2=new Color;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(-PHI,INV_PHI,0),new Vector3(PHI,INV_PHI,0),new Vector3(-INV_PHI,0,PHI),new Vector3(INV_PHI,0,PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(0,PHI,INV_PHI),new Vector3(-1,1,-1),new Vector3(1,1,-1),new Vector3(-1,1,1),new Vector3(1,1,1)],_faceLib=[3,1,5,0,4,2],direction=getDirection(uv(),attribute("faceIndex")).normalize(),outputDirection=vec3(direction.x,direction.y.negate(),direction.z);class PMREMGenerator{constructor(_e){this._renderer=_e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}fromScene(_e,et=0,rt=.1,it=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),this._setSize(256);const st=this._allocateTargets();return st.depthBuffer=!0,this._sceneToCubeUV(_e,rt,it,st),et>0&&this._blur(st,0,0,et),this._applyPMREM(st),this._cleanup(st),st}fromEquirectangular(_e,et=null){return this._fromTexture(_e,et)}fromCubemap(_e,et=null){return this._fromTexture(_e,et)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(_e){this._lodMax=Math.floor(Math.log2(_e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _e=0;_e<this._lodPlanes.length;_e++)this._lodPlanes[_e].dispose()}_cleanup(_e){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),_e.scissorTest=!1,_setViewport(_e,0,0,_e.width,_e.height)}_fromTexture(_e,et){_e.mapping===CubeReflectionMapping||_e.mapping===CubeRefractionMapping?this._setSize(_e.image.length===0?16:_e.image[0].width||_e.image[0].image.width):this._setSize(_e.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel();const rt=et||this._allocateTargets();return this._textureToCubeUV(_e,rt),this._applyPMREM(rt),this._cleanup(rt),rt}_allocateTargets(){const _e=3*Math.max(this._cubeSize,112),et=4*this._cubeSize,rt={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace},it=_createRenderTarget(_e,et,rt);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_e||this._pingPongRenderTarget.height!==et){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_e,et,rt);const{_lodMax:st}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=_createPlanes(st)),this._blurMaterial=_getBlurShader(st,_e,et)}return it}async _compileMaterial(_e){const et=new Mesh(this._lodPlanes[0],_e);await this._renderer.compile(et,_flatCamera)}_sceneToCubeUV(_e,et,rt,it){const st=_cubeCamera;st.near=et,st.far=rt;const ot=[-1,1,-1,-1,-1,-1],at=[1,1,1,-1,-1,-1],lt=this._renderer,ct=lt.autoClear;lt.getClearColor(_clearColor$2),lt.autoClear=!1;let ut=this._backgroundBox;if(ut===null){const ft=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1});ut=new Mesh(new BoxGeometry,ft)}let ht=!1;const dt=_e.background;dt?dt.isColor&&(ut.material.color.copy(dt),_e.background=null,ht=!0):(ut.material.color.copy(_clearColor$2),ht=!0),lt.setRenderTarget(it),lt.clear(),ht&&lt.render(ut,st);for(let ft=0;ft<6;ft++){const pt=ft%3;pt===0?(st.up.set(0,ot[ft],0),st.lookAt(at[ft],0,0)):pt===1?(st.up.set(0,0,ot[ft]),st.lookAt(0,at[ft],0)):(st.up.set(0,ot[ft],0),st.lookAt(0,0,at[ft]));const mt=this._cubeSize;_setViewport(it,pt*mt,ft>2?mt:0,mt,mt),lt.render(_e,st)}lt.autoClear=ct,_e.background=dt}_textureToCubeUV(_e,et){const rt=this._renderer,it=_e.mapping===CubeReflectionMapping||_e.mapping===CubeRefractionMapping;it?this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(_e)):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(_e));const st=it?this._cubemapMaterial:this._equirectMaterial;st.fragmentNode.value=_e;const ot=this._lodMeshes[0];ot.material=st;const at=this._cubeSize;_setViewport(et,0,0,3*at,2*at),rt.setRenderTarget(et),rt.render(ot,_flatCamera)}_applyPMREM(_e){const et=this._renderer,rt=et.autoClear;et.autoClear=!1;const it=this._lodPlanes.length;for(let st=1;st<it;st++){const ot=Math.sqrt(this._sigmas[st]*this._sigmas[st]-this._sigmas[st-1]*this._sigmas[st-1]),at=_axisDirections[(it-st-1)%_axisDirections.length];this._blur(_e,st-1,st,ot,at)}et.autoClear=rt}_blur(_e,et,rt,it,st){const ot=this._pingPongRenderTarget;this._halfBlur(_e,ot,et,rt,it,"latitudinal",st),this._halfBlur(ot,_e,rt,rt,it,"longitudinal",st)}_halfBlur(_e,et,rt,it,st,ot,at){const lt=this._renderer,ct=this._blurMaterial;ot!=="latitudinal"&&ot!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ut=3,ht=this._lodMeshes[it];ht.material=ct;const dt=ct.uniforms,ft=this._sizeLods[rt]-1,pt=isFinite(st)?Math.PI/(2*ft):2*Math.PI/(2*MAX_SAMPLES-1),mt=st/pt,At=isFinite(st)?1+Math.floor(ut*mt):MAX_SAMPLES;At>MAX_SAMPLES&&console.warn(`sigmaRadians, ${st}, is too large and will clip, as it requested ${At} samples when the maximum is set to ${MAX_SAMPLES}`);const gt=[];let bt=0;for(let Lt=0;Lt<MAX_SAMPLES;++Lt){const $t=Lt/mt,kt=Math.exp(-$t*$t/2);gt.push(kt),Lt===0?bt+=kt:Lt<At&&(bt+=2*kt)}for(let Lt=0;Lt<gt.length;Lt++)gt[Lt]=gt[Lt]/bt;_e.texture.frame=(_e.texture.frame||0)+1,dt.envMap.value=_e.texture,dt.samples.value=At,dt.weights.array=gt,dt.latitudinal.value=ot==="latitudinal"?1:0,at&&(dt.poleAxis.value=at);const{_lodMax:Tt}=this;dt.dTheta.value=pt,dt.mipInt.value=Tt-rt;const wt=this._sizeLods[it],Rt=3*wt*(it>Tt-LOD_MIN?it-Tt+LOD_MIN:0),It=4*(this._cubeSize-wt);_setViewport(et,Rt,It,3*wt,2*wt),lt.setRenderTarget(et),lt.render(ht,_flatCamera)}}function _createPlanes(nt){const _e=[],et=[],rt=[],it=[];let st=nt;const ot=nt-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let at=0;at<ot;at++){const lt=Math.pow(2,st);et.push(lt);let ct=1/lt;at>nt-LOD_MIN?ct=EXTRA_LOD_SIGMA[at-nt+LOD_MIN-1]:at===0&&(ct=0),rt.push(ct);const ut=1/(lt-2),ht=-ut,dt=1+ut,ft=[ht,ht,dt,ht,dt,dt,ht,ht,dt,dt,ht,dt],pt=6,mt=6,At=3,gt=2,bt=1,Tt=new Float32Array(At*mt*pt),wt=new Float32Array(gt*mt*pt),Rt=new Float32Array(bt*mt*pt);for(let Lt=0;Lt<pt;Lt++){const $t=Lt%3*2/3-1,kt=Lt>2?0:-1,Dt=[$t,kt,0,$t+2/3,kt,0,$t+2/3,kt+1,0,$t,kt,0,$t+2/3,kt+1,0,$t,kt+1,0],Ot=_faceLib[Lt];Tt.set(Dt,At*mt*Ot),wt.set(ft,gt*mt*Ot);const zt=[Ot,Ot,Ot,Ot,Ot,Ot];Rt.set(zt,bt*mt*Ot)}const It=new BufferGeometry;It.setAttribute("position",new BufferAttribute(Tt,At)),It.setAttribute("uv",new BufferAttribute(wt,gt)),It.setAttribute("faceIndex",new BufferAttribute(Rt,bt)),_e.push(It),it.push(new Mesh(It,null)),st>LOD_MIN&&st--}return{lodPlanes:_e,sizeLods:et,sigmas:rt,lodMeshes:it}}function _createRenderTarget(nt,_e,et){const rt=new RenderTarget(nt,_e,et);return rt.texture.mapping=CubeUVReflectionMapping,rt.texture.name="PMREM.cubeUv",rt.texture.isPMREMTexture=!0,rt.scissorTest=!0,rt}function _setViewport(nt,_e,et,rt,it){nt.viewport.set(_e,et,rt,it),nt.scissor.set(_e,et,rt,it)}function _getMaterial(nt){const _e=new NodeMaterial;return _e.depthTest=!1,_e.depthWrite=!1,_e.blending=NoBlending,_e.name=`PMREM_${nt}`,_e}function _getBlurShader(nt,_e,et){const rt=uniformArray(new Array(MAX_SAMPLES).fill(0)),it=uniform(new Vector3(0,1,0)),st=uniform(0),ot=float(MAX_SAMPLES),at=uniform(0),lt=uniform(1),ct=texture(null),ut=uniform(0),ht=float(1/_e),dt=float(1/et),ft=float(nt),pt={n:ot,latitudinal:at,weights:rt,poleAxis:it,outputDirection,dTheta:st,samples:lt,envMap:ct,mipInt:ut,CUBEUV_TEXEL_WIDTH:ht,CUBEUV_TEXEL_HEIGHT:dt,CUBEUV_MAX_MIP:ft},mt=_getMaterial("blur");return mt.uniforms=pt,mt.fragmentNode=blur({...pt,latitudinal:at.equal(1)}),mt}function _getCubemapMaterial(nt){const _e=_getMaterial("cubemap");return _e.fragmentNode=cubeTexture(nt,outputDirection),_e}function _getEquirectMaterial(nt){const _e=_getMaterial("equirect");return _e.fragmentNode=texture(nt,equirectUV(outputDirection),0),_e}let _id$5=0;class BindGroup{constructor(_e="",et=[],rt=0,it=[]){this.name=_e,this.bindings=et,this.index=rt,this.bindingsReference=it,this.id=_id$5++}}const rendererCache=new WeakMap,typeFromLength=new Map([[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),typeFromArray=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),toFloat=nt=>(nt=Number(nt),nt+(nt%1?"":".0"));class NodeBuilder{constructor(_e,et,rt){this.object=_e,this.material=_e&&_e.material||null,this.geometry=_e&&_e.geometry||null,this.renderer=et,this.parser=rt,this.scene=null,this.camera=null,this.nodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.monitor=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.flow={code:""},this.chaining=[],this.stack=stack(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new NodeCache,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.useComparisonMethod=!1}getBindGroupsCache(){let _e=rendererCache.get(this.renderer);return _e===void 0&&(_e=new ChainMap,rendererCache.set(this.renderer,_e)),_e}createRenderTarget(_e,et,rt){return new RenderTarget(_e,et,rt)}createCubeRenderTarget(_e,et){return new CubeRenderTarget(_e,et)}createPMREMGenerator(){return new PMREMGenerator(this.renderer)}includes(_e){return this.nodes.includes(_e)}_getBindGroup(_e,et){const rt=this.getBindGroupsCache(),it=[];let st=!0;for(const at of et)it.push(at),st=st&&at.groupNode.shared!==!0;let ot;return st?(ot=rt.get(it),ot===void 0&&(ot=new BindGroup(_e,it,this.bindingsIndexes[_e].group,it),rt.set(it,ot))):ot=new BindGroup(_e,it,this.bindingsIndexes[_e].group,it),ot}getBindGroupArray(_e,et){const rt=this.bindings[et];let it=rt[_e];return it===void 0&&(this.bindingsIndexes[_e]===void 0&&(this.bindingsIndexes[_e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),rt[_e]=it=[]),it}getBindings(){let _e=this.bindGroups;if(_e===null){const et={},rt=this.bindings;for(const it of shaderStages)for(const st in rt[it]){const ot=rt[it][st];(et[st]||(et[st]=[])).push(...ot)}_e=[];for(const it in et){const st=et[it],ot=this._getBindGroup(it,st);_e.push(ot)}this.bindGroups=_e}return _e}sortBindingGroups(){const _e=this.getBindings();_e.sort((et,rt)=>et.bindings[0].groupNode.order-rt.bindings[0].groupNode.order);for(let et=0;et<_e.length;et++){const rt=_e[et];this.bindingsIndexes[rt.name].group=et,rt.index=et}}setHashNode(_e,et){this.hashNodes[et]=_e}addNode(_e){this.nodes.includes(_e)===!1&&(this.nodes.push(_e),this.setHashNode(_e,_e.getHash(this)))}buildUpdateNodes(){for(const _e of this.nodes){const et=_e.getUpdateType(),rt=_e.getUpdateBeforeType(),it=_e.getUpdateAfterType();et!==NodeUpdateType.NONE&&this.updateNodes.push(_e.getSelf()),rt!==NodeUpdateType.NONE&&this.updateBeforeNodes.push(_e.getSelf()),it!==NodeUpdateType.NONE&&this.updateAfterNodes.push(_e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(_e){return _e.magFilter===LinearFilter||_e.magFilter===LinearMipmapNearestFilter||_e.magFilter===NearestMipmapLinearFilter||_e.magFilter===LinearMipmapLinearFilter||_e.minFilter===LinearFilter||_e.minFilter===LinearMipmapNearestFilter||_e.minFilter===NearestMipmapLinearFilter||_e.minFilter===LinearMipmapLinearFilter}addChain(_e){this.chaining.push(_e)}removeChain(_e){if(this.chaining.pop()!==_e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(_e){return _e}getNodeFromHash(_e){return this.hashNodes[_e]}addFlow(_e,et){return this.flowNodes[_e].push(et),et}setContext(_e){this.context=_e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(_e){this.cache=_e}getCache(){return this.cache}getCacheFromNode(_e,et=!0){const rt=this.getDataFromNode(_e);return rt.cache===void 0&&(rt.cache=new NodeCache(et?this.getCache():null)),rt.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(_e){const et=this.getDataFromNode(_e);return et.usageCount=et.usageCount===void 0?1:et.usageCount+1,et.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateConst(_e,et=null){if(et===null&&(_e==="float"||_e==="int"||_e==="uint"?et=0:_e==="bool"?et=!1:_e==="color"?et=new Color:_e==="vec2"?et=new Vector2:_e==="vec3"?et=new Vector3:_e==="vec4"&&(et=new Vector4)),_e==="float")return toFloat(et);if(_e==="int")return`${Math.round(et)}`;if(_e==="uint")return et>=0?`${Math.round(et)}u`:"0u";if(_e==="bool")return et?"true":"false";if(_e==="color")return`${this.getType("vec3")}( ${toFloat(et.r)}, ${toFloat(et.g)}, ${toFloat(et.b)} )`;const rt=this.getTypeLength(_e),it=this.getComponentType(_e),st=ot=>this.generateConst(it,ot);if(rt===2)return`${this.getType(_e)}( ${st(et.x)}, ${st(et.y)} )`;if(rt===3)return`${this.getType(_e)}( ${st(et.x)}, ${st(et.y)}, ${st(et.z)} )`;if(rt===4)return`${this.getType(_e)}( ${st(et.x)}, ${st(et.y)}, ${st(et.z)}, ${st(et.w)} )`;if(rt>4&&et&&(et.isMatrix3||et.isMatrix4))return`${this.getType(_e)}( ${et.elements.map(st).join(", ")} )`;if(rt>4)return`${this.getType(_e)}()`;throw new Error(`NodeBuilder: Type '${_e}' not found in generate constant attempt.`)}getType(_e){return _e==="color"?"vec3":_e}hasGeometryAttribute(_e){return this.geometry&&this.geometry.getAttribute(_e)!==void 0}getAttribute(_e,et){const rt=this.attributes;for(const st of rt)if(st.name===_e)return st;const it=new NodeAttribute(_e,et);return rt.push(it),it}getPropertyName(_e){return _e.name}isVector(_e){return/vec\d/.test(_e)}isMatrix(_e){return/mat\d/.test(_e)}isReference(_e){return _e==="void"||_e==="property"||_e==="sampler"||_e==="texture"||_e==="cubeTexture"||_e==="storageTexture"||_e==="depthTexture"||_e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(_e){const et=_e.type;if(_e.isDataTexture){if(et===IntType)return"int";if(et===UnsignedIntType)return"uint"}return"float"}getElementType(_e){return _e==="mat2"?"vec2":_e==="mat3"?"vec3":_e==="mat4"?"vec4":this.getComponentType(_e)}getComponentType(_e){if(_e=this.getVectorType(_e),_e==="float"||_e==="bool"||_e==="int"||_e==="uint")return _e;const et=/(b|i|u|)(vec|mat)([2-4])/.exec(_e);return et===null?null:et[1]==="b"?"bool":et[1]==="i"?"int":et[1]==="u"?"uint":"float"}getVectorType(_e){return _e==="color"?"vec3":_e==="texture"||_e==="cubeTexture"||_e==="storageTexture"||_e==="texture3D"?"vec4":_e}getTypeFromLength(_e,et="float"){if(_e===1)return et;const rt=typeFromLength.get(_e);return(et==="float"?"":et[0])+rt}getTypeFromArray(_e){return typeFromArray.get(_e.constructor)}getTypeFromAttribute(_e){let et=_e;_e.isInterleavedBufferAttribute&&(et=_e.data);const rt=et.array,it=_e.itemSize,st=_e.normalized;let ot;return!(_e instanceof Float16BufferAttribute)&&st!==!0&&(ot=this.getTypeFromArray(rt)),this.getTypeFromLength(it,ot)}getTypeLength(_e){const et=this.getVectorType(_e),rt=/vec([2-4])/.exec(et);return rt!==null?Number(rt[1]):et==="float"||et==="bool"||et==="int"||et==="uint"?1:/mat2/.test(_e)===!0?4:/mat3/.test(_e)===!0?9:/mat4/.test(_e)===!0?16:0}getVectorFromMatrix(_e){return _e.replace("mat","vec")}changeComponentType(_e,et){return this.getTypeFromLength(this.getTypeLength(_e),et)}getIntegerType(_e){const et=this.getComponentType(_e);return et==="int"||et==="uint"?_e:this.changeComponentType(_e,"int")}addStack(){return this.stack=stack(this.stack),this.stacks.push(getCurrentStack()||this.stack),setCurrentStack(this.stack),this.stack}removeStack(){const _e=this.stack;return this.stack=_e.parent,setCurrentStack(this.stacks.pop()),_e}getDataFromNode(_e,et=this.shaderStage,rt=null){rt=rt===null?_e.isGlobal(this)?this.globalCache:this.cache:rt;let it=rt.getData(_e);return it===void 0&&(it={},rt.setData(_e,it)),it[et]===void 0&&(it[et]={}),it[et]}getNodeProperties(_e,et="any"){const rt=this.getDataFromNode(_e,et);return rt.properties||(rt.properties={outputNode:null})}getBufferAttributeFromNode(_e,et){const rt=this.getDataFromNode(_e);let it=rt.bufferAttribute;if(it===void 0){const st=this.uniforms.index++;it=new NodeAttribute("nodeAttribute"+st,et,_e),this.bufferAttributes.push(it),rt.bufferAttribute=it}return it}getStructTypeFromNode(_e,et=this.shaderStage){const rt=this.getDataFromNode(_e,et);if(rt.structType===void 0){const it=this.structs.index++;_e.name=`StructType${it}`,this.structs[et].push(_e),rt.structType=_e}return _e}getUniformFromNode(_e,et,rt=this.shaderStage,it=null){const st=this.getDataFromNode(_e,rt,this.globalCache);let ot=st.uniform;if(ot===void 0){const at=this.uniforms.index++;ot=new NodeUniform(it||"nodeUniform"+at,et,_e),this.uniforms[rt].push(ot),st.uniform=ot}return ot}getVarFromNode(_e,et=null,rt=_e.getNodeType(this),it=this.shaderStage){const st=this.getDataFromNode(_e,it);let ot=st.variable;if(ot===void 0){const at=this.vars[it]||(this.vars[it]=[]);et===null&&(et="nodeVar"+at.length),ot=new NodeVar(et,rt),at.push(ot),st.variable=ot}return ot}getVaryingFromNode(_e,et=null,rt=_e.getNodeType(this)){const it=this.getDataFromNode(_e,"any");let st=it.varying;if(st===void 0){const ot=this.varyings,at=ot.length;et===null&&(et="nodeVarying"+at),st=new NodeVarying(et,rt),ot.push(st),it.varying=st}return st}getCodeFromNode(_e,et,rt=this.shaderStage){const it=this.getDataFromNode(_e);let st=it.code;if(st===void 0){const ot=this.codes[rt]||(this.codes[rt]=[]),at=ot.length;st=new NodeCode("nodeCode"+at,et),ot.push(st),it.code=st}return st}addFlowCodeHierarchy(_e,et){const{flowCodes:rt,flowCodeBlock:it}=this.getDataFromNode(_e);let st=!0,ot=et;for(;ot;){if(it.get(ot)===!0){st=!1;break}ot=this.getDataFromNode(ot).parentNodeBlock}if(st)for(const at of rt)this.addLineFlowCode(at)}addLineFlowCodeBlock(_e,et,rt){const it=this.getDataFromNode(_e),st=it.flowCodes||(it.flowCodes=[]),ot=it.flowCodeBlock||(it.flowCodeBlock=new WeakMap);st.push(et),ot.set(rt,!0)}addLineFlowCode(_e,et=null){return _e===""?this:(et!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(et,_e,this.context.nodeBlock),_e=this.tab+_e,/;\s*$/.test(_e)||(_e=_e+`;
`),this.flow.code+=_e,this)}addFlowCode(_e){return this.flow.code+=_e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(_e){return this.flowsData.get(_e)}flowNode(_e){const et=_e.getNodeType(this),rt=this.flowChildNode(_e,et);return this.flowsData.set(_e,rt),rt}buildFunctionNode(_e){const et=new FunctionNode,rt=this.currentFunctionNode;return this.currentFunctionNode=et,et.code=this.buildFunctionCode(_e),this.currentFunctionNode=rt,et}flowShaderNode(_e){const et=_e.layout,rt={[Symbol.iterator](){let ot=0;const at=Object.values(this);return{next:()=>({value:at[ot],done:ot++>=at.length})}}};for(const ot of et.inputs)rt[ot.name]=new ParameterNode(ot.type,ot.name);_e.layout=null;const it=_e.call(rt),st=this.flowStagesNode(it,et.type);return _e.layout=et,st}flowStagesNode(_e,et=null){const rt=this.flow,it=this.vars,st=this.cache,ot=this.buildStage,at=this.stack,lt={code:""};this.flow=lt,this.vars={},this.cache=new NodeCache,this.stack=stack();for(const ct of defaultBuildStages)this.setBuildStage(ct),lt.result=_e.build(this,et);return lt.vars=this.getVars(this.shaderStage),this.flow=rt,this.vars=it,this.cache=st,this.stack=at,this.setBuildStage(ot),lt}getFunctionOperator(){return null}flowChildNode(_e,et=null){const rt=this.flow,it={code:""};return this.flow=it,it.result=_e.build(this,et),this.flow=rt,it}flowNodeFromShaderStage(_e,et,rt=null,it=null){const st=this.shaderStage;this.setShaderStage(_e);const ot=this.flowChildNode(et,rt);return it!==null&&(ot.code+=`${this.tab+it} = ${ot.result};
`),this.flowCode[_e]=this.flowCode[_e]+ot.code,this.setShaderStage(st),ot}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(_e,et){return`${this.getType(_e)} ${et}`}getVars(_e){let et="";const rt=this.vars[_e];if(rt!==void 0)for(const it of rt)et+=`${this.getVar(it.type,it.name)}; `;return et}getUniforms(){console.warn("Abstract function.")}getCodes(_e){const et=this.codes[_e];let rt="";if(et!==void 0)for(const it of et)rt+=it.code+`
`;return rt}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(_e){this.shaderStage=_e}getShaderStage(){return this.shaderStage}setBuildStage(_e){this.buildStage=_e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:_e,material:et,renderer:rt}=this;if(et!==null){let it=rt.nodes.library.fromMaterial(et);it===null&&(console.error(`NodeMaterial: Material "${et.type}" is not compatible.`),it=new NodeMaterial),it.build(this)}else this.addFlow("compute",_e);for(const it of defaultBuildStages){this.setBuildStage(it),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const st of shaderStages){this.setShaderStage(st);const ot=this.flowNodes[st];for(const at of ot)it==="generate"?this.flowNode(at):at.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(_e,et){if(et==="float"||et==="int"||et==="uint")return new NumberNodeUniform(_e);if(et==="vec2"||et==="ivec2"||et==="uvec2")return new Vector2NodeUniform(_e);if(et==="vec3"||et==="ivec3"||et==="uvec3")return new Vector3NodeUniform(_e);if(et==="vec4"||et==="ivec4"||et==="uvec4")return new Vector4NodeUniform(_e);if(et==="color")return new ColorNodeUniform(_e);if(et==="mat3")return new Matrix3NodeUniform(_e);if(et==="mat4")return new Matrix4NodeUniform(_e);throw new Error(`Uniform "${et}" not declared.`)}createNodeMaterial(_e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${_e}() instead.`)}format(_e,et,rt){if(et=this.getVectorType(et),rt=this.getVectorType(rt),et===rt||rt===null||this.isReference(rt))return _e;const it=this.getTypeLength(et),st=this.getTypeLength(rt);return it===16&&st===9?`${this.getType(rt)}(${_e}[0].xyz, ${_e}[1].xyz, ${_e}[2].xyz)`:it===9&&st===4?`${this.getType(rt)}(${_e}[0].xy, ${_e}[1].xy)`:it>4||st>4||st===0?_e:it===st?`${this.getType(rt)}( ${_e} )`:it>st?this.format(`${_e}.${"xyz".slice(0,st)}`,this.getTypeFromLength(st,this.getComponentType(et)),rt):st===4&&it>1?`${this.getType(rt)}( ${this.format(_e,et,"vec3")}, 1.0 )`:it===2?`${this.getType(rt)}( ${this.format(_e,et,"vec2")}, 0.0 )`:(it===1&&st>1&&et!==this.getComponentType(rt)&&(_e=`${this.getType(this.getComponentType(rt))}( ${_e} )`),`${this.getType(rt)}( ${_e} )`)}getSignature(){return`// Three.js r${REVISION} - Node System
`}}class NodeFrame{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.startTime=null,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(_e,et){let rt=_e.get(et);return rt===void 0&&(rt={renderMap:new WeakMap,frameMap:new WeakMap},_e.set(et,rt)),rt}updateBeforeNode(_e){const et=_e.getUpdateBeforeType(),rt=_e.updateReference(this);if(et===NodeUpdateType.FRAME){const{frameMap:it}=this._getMaps(this.updateBeforeMap,rt);it.get(rt)!==this.frameId&&_e.updateBefore(this)!==!1&&it.set(rt,this.frameId)}else if(et===NodeUpdateType.RENDER){const{renderMap:it}=this._getMaps(this.updateBeforeMap,rt);it.get(rt)!==this.renderId&&_e.updateBefore(this)!==!1&&it.set(rt,this.renderId)}else et===NodeUpdateType.OBJECT&&_e.updateBefore(this)}updateAfterNode(_e){const et=_e.getUpdateAfterType(),rt=_e.updateReference(this);if(et===NodeUpdateType.FRAME){const{frameMap:it}=this._getMaps(this.updateAfterMap,rt);it.get(rt)!==this.frameId&&_e.updateAfter(this)!==!1&&it.set(rt,this.frameId)}else if(et===NodeUpdateType.RENDER){const{renderMap:it}=this._getMaps(this.updateAfterMap,rt);it.get(rt)!==this.renderId&&_e.updateAfter(this)!==!1&&it.set(rt,this.renderId)}else et===NodeUpdateType.OBJECT&&_e.updateAfter(this)}updateNode(_e){const et=_e.getUpdateType(),rt=_e.updateReference(this);if(et===NodeUpdateType.FRAME){const{frameMap:it}=this._getMaps(this.updateMap,rt);it.get(rt)!==this.frameId&&_e.update(this)!==!1&&it.set(rt,this.frameId)}else if(et===NodeUpdateType.RENDER){const{renderMap:it}=this._getMaps(this.updateMap,rt);it.get(rt)!==this.renderId&&_e.update(this)!==!1&&it.set(rt,this.renderId)}else et===NodeUpdateType.OBJECT&&_e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class NodeFunctionInput{constructor(_e,et,rt=null,it="",st=!1){this.type=_e,this.name=et,this.count=rt,this.qualifier=it,this.isConst=st}}NodeFunctionInput.isNodeFunctionInput=!0;class TimerNode extends UniformNode{static get type(){return"TimerNode"}constructor(_e=TimerNode.LOCAL,et=1,rt=0){super(rt),this.scope=_e,this.scale=et,this.updateType=NodeUpdateType.FRAME}update(_e){const et=this.scope,rt=this.scale;et===TimerNode.LOCAL?this.value+=_e.deltaTime*rt:et===TimerNode.DELTA?this.value=_e.deltaTime*rt:et===TimerNode.FRAME?this.value=_e.frameId:this.value=_e.time*rt}serialize(_e){super.serialize(_e),_e.scope=this.scope,_e.scale=this.scale}deserialize(_e){super.deserialize(_e),this.scope=_e.scope,this.scale=_e.scale}}TimerNode.LOCAL="local";TimerNode.GLOBAL="global";TimerNode.DELTA="delta";TimerNode.FRAME="frame";const timerLocal=(nt,_e=0)=>nodeObject(new TimerNode(TimerNode.LOCAL,nt,_e));class OscNode extends Node$1{static get type(){return"OscNode"}constructor(_e=OscNode.SINE,et=timerLocal()){super(),this.method=_e,this.timeNode=et}getNodeType(_e){return this.timeNode.getNodeType(_e)}setup(){const _e=this.method,et=nodeObject(this.timeNode);let rt=null;return _e===OscNode.SINE?rt=et.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5):_e===OscNode.SQUARE?rt=et.fract().round():_e===OscNode.TRIANGLE?rt=et.add(.5).fract().mul(2).sub(1).abs():_e===OscNode.SAWTOOTH&&(rt=et.fract()),rt}serialize(_e){super.serialize(_e),_e.method=this.method}deserialize(_e){super.deserialize(_e),this.method=_e.method}}OscNode.SINE="sine";OscNode.SQUARE="square";OscNode.TRIANGLE="triangle";OscNode.SAWTOOTH="sawtooth";OscNode.SINE;OscNode.SQUARE;OscNode.TRIANGLE;OscNode.SAWTOOTH;new Plane;new Vector3;new Vector3;new Vector3;new Matrix4;new Vector3(0,0,-1);new Vector4;new Vector3;new Vector3;new Vector4;new Vector2;new RenderTarget;screenUV.flipX();const _camera$1=new OrthographicCamera(-1,1,1,-1,0,1);class QuadGeometry extends BufferGeometry{constructor(_e=!1){super();const et=_e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Float32BufferAttribute(et,2))}}const _geometry$1=new QuadGeometry;class QuadMesh extends Mesh{constructor(_e=null){super(_geometry$1,_e),this.camera=_camera$1,this.isQuadMesh=!0}renderAsync(_e){return _e.renderAsync(this,_camera$1)}render(_e){_e.render(this,_camera$1)}}class SceneNode extends Node$1{static get type(){return"SceneNode"}constructor(_e=SceneNode.BACKGROUND_BLURRINESS,et=null){super(),this.scope=_e,this.scene=et}setup(_e){const et=this.scope,rt=this.scene!==null?this.scene:_e.scene;let it;return et===SceneNode.BACKGROUND_BLURRINESS?it=reference("backgroundBlurriness","float",rt):et===SceneNode.BACKGROUND_INTENSITY?it=reference("backgroundIntensity","float",rt):console.error("THREE.SceneNode: Unknown scope:",et),it}}SceneNode.BACKGROUND_BLURRINESS="backgroundBlurriness";SceneNode.BACKGROUND_INTENSITY="backgroundIntensity";const backgroundBlurriness=nodeImmutable(SceneNode,SceneNode.BACKGROUND_BLURRINESS),backgroundIntensity=nodeImmutable(SceneNode,SceneNode.BACKGROUND_INTENSITY),GPUPrimitiveTopology={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},GPUCompareFunction={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},GPUStoreOp={Store:"store",Discard:"discard"},GPULoadOp={Load:"load",Clear:"clear"},GPUFrontFace={CCW:"ccw",CW:"cw"},GPUCullMode={None:"none",Front:"front",Back:"back"},GPUIndexFormat={Uint16:"uint16",Uint32:"uint32"},GPUTextureFormat={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10uFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Stencil8:"stencil8",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},GPUAddressMode={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},GPUFilterMode={Linear:"linear",Nearest:"nearest"},GPUBlendFactor={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},GPUBlendOperation={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},GPUColorWriteFlags={None:0,Red:1,Green:2,Blue:4,Alpha:8,All:15},GPUStencilOperation={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},GPUBufferBindingType={Uniform:"uniform",Storage:"storage",ReadOnlyStorage:"read-only-storage"},GPUStorageTextureAccess={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},GPUTextureSampleType={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},GPUTextureDimension={OneD:"1d",TwoD:"2d",ThreeD:"3d"},GPUTextureViewDimension={OneD:"1d",TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",CubeArray:"cube-array",ThreeD:"3d"},GPUTextureAspect={All:"all",StencilOnly:"stencil-only",DepthOnly:"depth-only"},GPUInputStepMode={Vertex:"vertex",Instance:"instance"},GPUFeatureName={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"},_size$7=new Vector2;class PassTextureNode extends TextureNode{static get type(){return"PassTextureNode"}constructor(_e,et){super(et),this.passNode=_e,this.setUpdateMatrix(!1)}setup(_e){return _e.object.isQuadMesh&&this.passNode.build(_e),super.setup(_e)}clone(){return new this.constructor(this.passNode,this.value)}}class PassMultipleTextureNode extends PassTextureNode{static get type(){return"PassMultipleTextureNode"}constructor(_e,et,rt=!1){super(_e,null),this.textureName=et,this.previousTexture=rt}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(_e){return this.updateTexture(),super.setup(_e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class PassNode extends TempNode{static get type(){return"PassNode"}constructor(_e,et,rt,it={}){super("vec4"),this.scope=_e,this.scene=et,this.camera=rt,this.options=it,this._pixelRatio=1,this._width=1,this._height=1;const st=new DepthTexture;st.isRenderTargetTexture=!0,st.name="depth";const ot=new RenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:HalfFloatType,...it});ot.texture.name="output",ot.depthTexture=st,this.renderTarget=ot,this.updateBeforeType=NodeUpdateType.FRAME,this._textures={output:ot.texture,depth:st},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=uniform(0),this._cameraFar=uniform(0),this._mrt=null,this.isPassNode=!0}setMRT(_e){return this._mrt=_e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(_e){let et=this._textures[_e];return et===void 0&&(et=this.renderTarget.texture.clone(),et.isRenderTargetTexture=!0,et.name=_e,this._textures[_e]=et,this.renderTarget.textures.push(et)),et}getPreviousTexture(_e){let et=this._previousTextures[_e];return et===void 0&&(et=this.getTexture(_e).clone(),et.isRenderTargetTexture=!0,this._previousTextures[_e]=et),et}toggleTexture(_e){const et=this._previousTextures[_e];if(et!==void 0){const rt=this._textures[_e],it=this.renderTarget.textures.indexOf(rt);this.renderTarget.textures[it]=et,this._textures[_e]=et,this._previousTextures[_e]=rt,this._textureNodes[_e].updateTexture(),this._previousTextureNodes[_e].updateTexture()}}getTextureNode(_e="output"){let et=this._textureNodes[_e];return et===void 0&&(this._textureNodes[_e]=et=nodeObject(new PassMultipleTextureNode(this,_e)),this._textureNodes[_e].updateTexture()),et}getPreviousTextureNode(_e="output"){let et=this._previousTextureNodes[_e];return et===void 0&&(this._textureNodes[_e]===void 0&&this.getTextureNode(_e),this._previousTextureNodes[_e]=et=nodeObject(new PassMultipleTextureNode(this,_e,!0)),this._previousTextureNodes[_e].updateTexture()),et}getViewZNode(_e="depth"){let et=this._viewZNodes[_e];if(et===void 0){const rt=this._cameraNear,it=this._cameraFar;this._viewZNodes[_e]=et=perspectiveDepthToViewZ(this.getTextureNode(_e),rt,it)}return et}getLinearDepthNode(_e="depth"){let et=this._linearDepthNodes[_e];if(et===void 0){const rt=this._cameraNear,it=this._cameraFar,st=this.getViewZNode(_e);this._linearDepthNodes[_e]=et=viewZToOrthographicDepth$1(st,rt,it)}return et}setup({renderer:_e}){return this.renderTarget.samples=this.options.samples===void 0?_e.samples:this.options.samples,_e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.depthTexture.isMultisampleRenderTargetTexture=this.renderTarget.samples>1,this.scope===PassNode.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(_e){const{renderer:et}=_e,{scene:rt,camera:it}=this;this._pixelRatio=et.getPixelRatio();const st=et.getSize(_size$7);this.setSize(st.width,st.height);const ot=et.getRenderTarget(),at=et.getMRT();this._cameraNear.value=it.near,this._cameraFar.value=it.far;for(const lt in this._previousTextures)this.toggleTexture(lt);et.setRenderTarget(this.renderTarget),et.setMRT(this._mrt),et.render(rt,it),et.setRenderTarget(ot),et.setMRT(at)}setSize(_e,et){this._width=_e,this._height=et;const rt=this._width*this._pixelRatio,it=this._height*this._pixelRatio;this.renderTarget.setSize(rt,it)}setPixelRatio(_e){this._pixelRatio=_e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}PassNode.COLOR="color";PassNode.DEPTH="depth";class FogNode extends Node$1{static get type(){return"FogNode"}constructor(_e,et){super("float"),this.isFogNode=!0,this.colorNode=_e,this.factorNode=et}getViewZNode(_e){let et;const rt=_e.context.getViewZ;return rt!==void 0&&(et=rt(this)),(et||positionView.z).negate()}setup(){return this.factorNode}}class FogRangeNode extends FogNode{static get type(){return"FogRangeNode"}constructor(_e,et,rt){super(_e),this.isFogRangeNode=!0,this.nearNode=et,this.farNode=rt}setup(_e){const et=this.getViewZNode(_e);return smoothstep(this.nearNode,this.farNode,et)}}const rangeFog=nodeProxy(FogRangeNode);class FogExp2Node extends FogNode{static get type(){return"FogExp2Node"}constructor(_e,et){super(_e),this.isFogExp2Node=!0,this.densityNode=et}setup(_e){const et=this.getViewZNode(_e),rt=this.densityNode;return rt.mul(rt,et,et).negate().exp().oneMinus()}}const densityFog=nodeProxy(FogExp2Node),BasicShadowMap=Fn(({depthTexture:nt,shadowCoord:_e})=>texture(nt,_e.xy).compare(_e.z)),PCFShadowMap=Fn(({depthTexture:nt,shadowCoord:_e,shadow:et})=>{const rt=(mt,At)=>texture(nt,mt).compare(At),it=reference("mapSize","vec2",et).setGroup(renderGroup),st=reference("radius","float",et).setGroup(renderGroup),ot=vec2(1).div(it),at=ot.x.negate().mul(st),lt=ot.y.negate().mul(st),ct=ot.x.mul(st),ut=ot.y.mul(st),ht=at.div(2),dt=lt.div(2),ft=ct.div(2),pt=ut.div(2);return add(rt(_e.xy.add(vec2(at,lt)),_e.z),rt(_e.xy.add(vec2(0,lt)),_e.z),rt(_e.xy.add(vec2(ct,lt)),_e.z),rt(_e.xy.add(vec2(ht,dt)),_e.z),rt(_e.xy.add(vec2(0,dt)),_e.z),rt(_e.xy.add(vec2(ft,dt)),_e.z),rt(_e.xy.add(vec2(at,0)),_e.z),rt(_e.xy.add(vec2(ht,0)),_e.z),rt(_e.xy,_e.z),rt(_e.xy.add(vec2(ft,0)),_e.z),rt(_e.xy.add(vec2(ct,0)),_e.z),rt(_e.xy.add(vec2(ht,pt)),_e.z),rt(_e.xy.add(vec2(0,pt)),_e.z),rt(_e.xy.add(vec2(ft,pt)),_e.z),rt(_e.xy.add(vec2(at,ut)),_e.z),rt(_e.xy.add(vec2(0,ut)),_e.z),rt(_e.xy.add(vec2(ct,ut)),_e.z)).mul(1/17)}),PCFSoftShadowMap=Fn(({depthTexture:nt,shadowCoord:_e,shadow:et})=>{const rt=(ut,ht)=>texture(nt,ut).compare(ht),it=reference("mapSize","vec2",et).setGroup(renderGroup),st=vec2(1).div(it),ot=st.x,at=st.y,lt=_e.xy,ct=fract(lt.mul(it).add(.5));return lt.subAssign(ct.mul(st)),add(rt(lt,_e.z),rt(lt.add(vec2(ot,0)),_e.z),rt(lt.add(vec2(0,at)),_e.z),rt(lt.add(st),_e.z),mix$2(rt(lt.add(vec2(ot.negate(),0)),_e.z),rt(lt.add(vec2(ot.mul(2),0)),_e.z),ct.x),mix$2(rt(lt.add(vec2(ot.negate(),at)),_e.z),rt(lt.add(vec2(ot.mul(2),at)),_e.z),ct.x),mix$2(rt(lt.add(vec2(0,at.negate())),_e.z),rt(lt.add(vec2(0,at.mul(2))),_e.z),ct.y),mix$2(rt(lt.add(vec2(ot,at.negate())),_e.z),rt(lt.add(vec2(ot,at.mul(2))),_e.z),ct.y),mix$2(mix$2(rt(lt.add(vec2(ot.negate(),at.negate())),_e.z),rt(lt.add(vec2(ot.mul(2),at.negate())),_e.z),ct.x),mix$2(rt(lt.add(vec2(ot.negate(),at.mul(2))),_e.z),rt(lt.add(vec2(ot.mul(2),at.mul(2))),_e.z),ct.x),ct.y)).mul(1/9)}),VSMShadowMapNode=Fn(({depthTexture:nt,shadowCoord:_e})=>{const et=float(1).toVar(),rt=texture(nt).uv(_e.xy).rg,it=step(_e.z,rt.x);return If(it.notEqual(float(1)),()=>{const st=_e.z.sub(rt.x),ot=max$1(0,rt.y.mul(rt.y));let at=ot.div(ot.add(st.mul(st)));at=clamp$2(sub(at,.3).div(.95-.3)),et.assign(clamp$2(max$1(it,at)))}),et}),VSMPassVertical=Fn(({samples:nt,radius:_e,size:et,shadowPass:rt})=>{const it=float(0).toVar(),st=float(0).toVar(),ot=nt.lessThanEqual(float(1)).select(float(0),float(2).div(nt.sub(1))),at=nt.lessThanEqual(float(1)).select(float(0),float(-1));Loop({start:int$1(0),end:int$1(nt),type:"int",condition:"<"},({i:ct})=>{const ut=at.add(float(ct).mul(ot)),ht=rt.uv(add(screenCoordinate.xy,vec2(0,ut).mul(_e)).div(et)).x;it.addAssign(ht),st.addAssign(ht.mul(ht))}),it.divAssign(nt),st.divAssign(nt);const lt=sqrt(st.sub(it.mul(it)));return vec2(it,lt)}),VSMPassHorizontal=Fn(({samples:nt,radius:_e,size:et,shadowPass:rt})=>{const it=float(0).toVar(),st=float(0).toVar(),ot=nt.lessThanEqual(float(1)).select(float(0),float(2).div(nt.sub(1))),at=nt.lessThanEqual(float(1)).select(float(0),float(-1));Loop({start:int$1(0),end:int$1(nt),type:"int",condition:"<"},({i:ct})=>{const ut=at.add(float(ct).mul(ot)),ht=rt.uv(add(screenCoordinate.xy,vec2(ut,0).mul(_e)).div(et));it.addAssign(ht.x),st.addAssign(add(ht.y.mul(ht.y),ht.x.mul(ht.x)))}),it.divAssign(nt),st.divAssign(nt);const lt=sqrt(st.sub(it.mul(it)));return vec2(it,lt)}),_shadowFilterLib=[BasicShadowMap,PCFShadowMap,PCFSoftShadowMap,VSMShadowMapNode];let _overrideMaterial=null;const _quadMesh$1=new QuadMesh;class AnalyticLightNode extends LightingNode{static get type(){return"AnalyticLightNode"}constructor(_e=null){super(),this.updateType=NodeUpdateType.FRAME,this.light=_e,this.color=new Color,this.colorNode=uniform(this.color).setGroup(renderGroup),this.baseColorNode=null,this.shadowMap=null,this.shadowNode=null,this.shadowColorNode=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this.isAnalyticLightNode=!0}getCacheKey(){return hash$1(super.getCacheKey(),this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}setupShadow(_e){const{object:et,renderer:rt}=_e;if(rt.shadowMap.enabled===!1)return;let it=this.shadowColorNode;if(it===null){_overrideMaterial===null&&(_overrideMaterial=new NodeMaterial,_overrideMaterial.fragmentNode=vec4(0,0,0,1),_overrideMaterial.isShadowNodeMaterial=!0,_overrideMaterial.name="ShadowMaterial");const st=rt.shadowMap.type,ot=this.light.shadow,at=new DepthTexture;at.compareFunction=LessCompare;const lt=_e.createRenderTarget(ot.mapSize.width,ot.mapSize.height);if(lt.depthTexture=at,ot.camera.updateProjectionMatrix(),st===VSMShadowMap){at.compareFunction=null,this.vsmShadowMapVertical=_e.createRenderTarget(ot.mapSize.width,ot.mapSize.height,{format:RGFormat,type:HalfFloatType}),this.vsmShadowMapHorizontal=_e.createRenderTarget(ot.mapSize.width,ot.mapSize.height,{format:RGFormat,type:HalfFloatType});const Tt=texture(at),wt=texture(this.vsmShadowMapVertical.texture),Rt=reference("blurSamples","float",ot).setGroup(renderGroup),It=reference("radius","float",ot).setGroup(renderGroup),Lt=reference("mapSize","vec2",ot).setGroup(renderGroup);let $t=this.vsmMaterialVertical||(this.vsmMaterialVertical=new NodeMaterial);$t.fragmentNode=VSMPassVertical({samples:Rt,radius:It,size:Lt,shadowPass:Tt}).context(_e.getSharedContext()),$t.name="VSMVertical",$t=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new NodeMaterial),$t.fragmentNode=VSMPassHorizontal({samples:Rt,radius:It,size:Lt,shadowPass:wt}).context(_e.getSharedContext()),$t.name="VSMHorizontal"}const ct=reference("intensity","float",ot).setGroup(renderGroup),ut=reference("bias","float",ot).setGroup(renderGroup),ht=reference("normalBias","float",ot).setGroup(renderGroup),dt=et.material.shadowPositionNode||positionWorld;let ft=uniform(ot.matrix).setGroup(renderGroup).mul(dt.add(normalWorld.mul(ht)));ft=ft.xyz.div(ft.w);let pt=ft.z.add(ut);rt.coordinateSystem===WebGPUCoordinateSystem&&(pt=pt.mul(2).sub(1)),ft=vec3(ft.x,ft.y.oneMinus(),pt);const mt=ft.x.greaterThanEqual(0).and(ft.x.lessThanEqual(1)).and(ft.y.greaterThanEqual(0)).and(ft.y.lessThanEqual(1)).and(ft.z.lessThanEqual(1)),At=ot.filterNode||_shadowFilterLib[rt.shadowMap.type]||null;if(At===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const gt=texture(lt.texture,ft),bt=mt.select(At({depthTexture:st===VSMShadowMap?this.vsmShadowMapHorizontal.texture:at,shadowCoord:ft,shadow:ot}),float(1));this.shadowMap=lt,this.light.shadow.map=lt,this.shadowNode=bt,this.shadowColorNode=it=this.colorNode.mul(mix$2(1,bt.rgb.mix(gt,1),ct.mul(gt.a))),this.baseColorNode=this.colorNode}this.colorNode=it,this.updateBeforeType=NodeUpdateType.RENDER}setup(_e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?_e.object.receiveShadow&&this.setupShadow(_e):this.shadowNode!==null&&this.disposeShadow()}updateShadow(_e){const{shadowMap:et,light:rt}=this,{renderer:it,scene:st,camera:ot}=_e,at=it.shadowMap.type,lt=et.depthTexture.version;this._depthVersionCached=lt;const ct=st.overrideMaterial;st.overrideMaterial=_overrideMaterial,et.setSize(rt.shadow.mapSize.width,rt.shadow.mapSize.height),rt.shadow.updateMatrices(rt),rt.shadow.camera.layers.mask=ot.layers.mask;const ut=it.getRenderTarget(),ht=it.getRenderObjectFunction();it.setRenderObjectFunction((dt,...ft)=>{(dt.castShadow===!0||dt.receiveShadow&&at===VSMShadowMap)&&it.renderObject(dt,...ft)}),it.setRenderTarget(et),it.render(st,rt.shadow.camera),it.setRenderObjectFunction(ht),rt.isPointLight!==!0&&at===VSMShadowMap&&this.vsmPass(_e,rt),it.setRenderTarget(ut),st.overrideMaterial=ct}vsmPass(_e,et){const{renderer:rt}=_e;this.vsmShadowMapVertical.setSize(et.shadow.mapSize.width,et.shadow.mapSize.height),this.vsmShadowMapHorizontal.setSize(et.shadow.mapSize.width,et.shadow.mapSize.height),rt.setRenderTarget(this.vsmShadowMapVertical),_quadMesh$1.material=this.vsmMaterialVertical,_quadMesh$1.render(rt),rt.setRenderTarget(this.vsmShadowMapHorizontal),_quadMesh$1.material=this.vsmMaterialHorizontal,_quadMesh$1.render(rt)}disposeShadow(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),this.shadowNode=null,this.shadowColorNode=null,this.baseColorNode=null,this.updateBeforeType=NodeUpdateType.NONE}updateBefore(_e){const et=this.light.shadow;(et.needsUpdate||et.autoUpdate)&&(this.updateShadow(_e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(et.needsUpdate=!1))}update(){const{light:_e}=this;this.color.copy(_e.color).multiplyScalar(_e.intensity)}}const getDistanceAttenuation=Fn(nt=>{const{lightDistance:_e,cutoffDistance:et,decayExponent:rt}=nt,it=_e.pow(rt).max(.01).reciprocal();return et.greaterThan(0).select(it.mul(_e.div(et).pow4().oneMinus().clamp().pow2()),it)});let uniformsLib;function getLightData(nt){uniformsLib=uniformsLib||new WeakMap;let _e=uniformsLib.get(nt);return _e===void 0&&uniformsLib.set(nt,_e={}),_e}function lightPosition(nt){const _e=getLightData(nt);return _e.position||(_e.position=uniform(new Vector3).setGroup(renderGroup).onRenderUpdate((et,rt)=>rt.value.setFromMatrixPosition(nt.matrixWorld)))}function lightTargetPosition(nt){const _e=getLightData(nt);return _e.targetPosition||(_e.targetPosition=uniform(new Vector3).setGroup(renderGroup).onRenderUpdate((et,rt)=>rt.value.setFromMatrixPosition(nt.target.matrixWorld)))}function lightViewPosition(nt){const _e=getLightData(nt);return _e.viewPosition||(_e.viewPosition=uniform(new Vector3).setGroup(renderGroup).onRenderUpdate(({camera:et},rt)=>{rt.value=rt.value||new Vector3,rt.value.setFromMatrixPosition(nt.matrixWorld),rt.value.applyMatrix4(et.matrixWorldInverse)}))}const lightTargetDirection=nt=>cameraViewMatrix.transformDirection(lightPosition(nt).sub(lightTargetPosition(nt))),sRGBToLinearSRGB=Fn(([nt])=>{const _e=nt.mul(.9478672986).add(.0521327014).pow(2.4),et=nt.mul(.0773993808),rt=nt.lessThanEqual(.04045);return mix$2(_e,et,rt)}).setLayout({name:"sRGBToLinearSRGB",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),linearSRGBTosRGB=Fn(([nt])=>{const _e=nt.pow(.41666).mul(1.055).sub(.055),et=nt.mul(12.92),rt=nt.lessThanEqual(.0031308);return mix$2(_e,et,rt)}).setLayout({name:"linearSRGBTosRGB",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),linearToneMapping=Fn(([nt,_e])=>nt.mul(_e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),reinhardToneMapping=Fn(([nt,_e])=>(nt=nt.mul(_e),nt.div(nt.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),cineonToneMapping=Fn(([nt,_e])=>{nt=nt.mul(_e),nt=nt.sub(.004).max(0);const et=nt.mul(nt.mul(6.2).add(.5)),rt=nt.mul(nt.mul(6.2).add(1.7)).add(.06);return et.div(rt).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),RRTAndODTFit=Fn(([nt])=>{const _e=nt.mul(nt.add(.0245786)).sub(90537e-9),et=nt.mul(nt.add(.432951).mul(.983729)).add(.238081);return _e.div(et)}),acesFilmicToneMapping=Fn(([nt,_e])=>{const et=mat3(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),rt=mat3(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return nt=nt.mul(_e).div(.6),nt=et.mul(nt),nt=RRTAndODTFit(nt),nt=rt.mul(nt),nt.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),LINEAR_REC2020_TO_LINEAR_SRGB=mat3(vec3(1.6605,-.1246,-.0182),vec3(-.5876,1.1329,-.1006),vec3(-.0728,-.0083,1.1187)),LINEAR_SRGB_TO_LINEAR_REC2020=mat3(vec3(.6274,.0691,.0164),vec3(.3293,.9195,.088),vec3(.0433,.0113,.8956)),agxDefaultContrastApprox=Fn(([nt])=>{const _e=vec3(nt).toVar(),et=vec3(_e.mul(_e)).toVar(),rt=vec3(et.mul(et)).toVar();return float(15.5).mul(rt.mul(et)).sub(mul(40.14,rt.mul(_e))).add(mul(31.96,rt).sub(mul(6.868,et.mul(_e))).add(mul(.4298,et).add(mul(.1191,_e).sub(.00232))))}),agxToneMapping=Fn(([nt,_e])=>{const et=vec3(nt).toVar(),rt=mat3(vec3(.856627153315983,.137318972929847,.11189821299995),vec3(.0951212405381588,.761241990602591,.0767994186031903),vec3(.0482516061458583,.101439036467562,.811302368396859)),it=mat3(vec3(1.1271005818144368,-.1413297634984383,-.14132976349843826),vec3(-.11060664309660323,1.157823702216272,-.11060664309660294),vec3(-.016493938717834573,-.016493938717834257,1.2519364065950405)),st=float(-12.47393),ot=float(4.026069);return et.mulAssign(_e),et.assign(LINEAR_SRGB_TO_LINEAR_REC2020.mul(et)),et.assign(rt.mul(et)),et.assign(max$1(et,1e-10)),et.assign(log2(et)),et.assign(et.sub(st).div(ot.sub(st))),et.assign(clamp$2(et,0,1)),et.assign(agxDefaultContrastApprox(et)),et.assign(it.mul(et)),et.assign(pow(max$1(vec3(0),et),vec3(2.2))),et.assign(LINEAR_REC2020_TO_LINEAR_SRGB.mul(et)),et.assign(clamp$2(et,0,1)),et}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),neutralToneMapping=Fn(([nt,_e])=>{const et=float(.76),rt=float(.15);nt=nt.mul(_e);const it=min$1(nt.r,min$1(nt.g,nt.b)),st=select(it.lessThan(.08),it.sub(mul(6.25,it.mul(it))),.04);nt.subAssign(st);const ot=max$1(nt.r,max$1(nt.g,nt.b));If(ot.lessThan(et),()=>nt);const at=sub(1,et),lt=sub(1,at.mul(at).div(ot.add(at.sub(et))));nt.mulAssign(lt.div(ot));const ct=sub(1,div(1,rt.mul(ot.sub(lt)).add(1)));return mix$2(nt,vec3(lt),ct)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class BarrierNode extends Node$1{constructor(_e){super(),this.scope=_e}generate(_e){const{scope:et}=this,{renderer:rt}=_e;rt.backend.isWebGLBackend===!0?_e.addFlowCode(`	// ${et}Barrier 
`):_e.addLineFlowCode(`${et}Barrier()`,this)}}nodeProxy(BarrierNode);class AtomicFunctionNode extends TempNode{static get type(){return"AtomicFunctionNode"}constructor(_e,et,rt,it=null){super("uint"),this.method=_e,this.pointerNode=et,this.valueNode=rt,this.storeNode=it}getInputType(_e){return this.pointerNode.getNodeType(_e)}getNodeType(_e){return this.getInputType(_e)}generate(_e){const et=this.method,rt=this.getNodeType(_e),it=this.getInputType(_e),st=this.pointerNode,ot=this.valueNode,at=[];at.push(`&${st.build(_e,it)}`),at.push(ot.build(_e,it));const lt=`${_e.getMethod(et,rt)}( ${at.join(", ")} )`;if(this.storeNode!==null){const ct=this.storeNode.build(_e,it);_e.addLineFlowCode(`${ct} = ${lt}`,this)}else _e.addLineFlowCode(lt,this)}}AtomicFunctionNode.ATOMIC_LOAD="atomicLoad";AtomicFunctionNode.ATOMIC_STORE="atomicStore";AtomicFunctionNode.ATOMIC_ADD="atomicAdd";AtomicFunctionNode.ATOMIC_SUB="atomicSub";AtomicFunctionNode.ATOMIC_MAX="atomicMax";AtomicFunctionNode.ATOMIC_MIN="atomicMin";AtomicFunctionNode.ATOMIC_AND="atomicAnd";AtomicFunctionNode.ATOMIC_OR="atomicOr";AtomicFunctionNode.ATOMIC_XOR="atomicXor";nodeProxy(AtomicFunctionNode);const getShIrradianceAt=Fn(([nt,_e])=>{const et=nt.x,rt=nt.y,it=nt.z;let st=_e.element(0).mul(.886227);return st=st.add(_e.element(1).mul(2*.511664).mul(rt)),st=st.add(_e.element(2).mul(2*.511664).mul(it)),st=st.add(_e.element(3).mul(2*.511664).mul(et)),st=st.add(_e.element(4).mul(2*.429043).mul(et).mul(rt)),st=st.add(_e.element(5).mul(2*.429043).mul(rt).mul(it)),st=st.add(_e.element(6).mul(it.mul(it).mul(.743125).sub(.247708))),st=st.add(_e.element(7).mul(2*.429043).mul(et).mul(it)),st=st.add(_e.element(8).mul(.429043).mul(mul(et,et).sub(mul(rt,rt)))),st});class PointLightNode extends AnalyticLightNode{static get type(){return"PointLightNode"}constructor(_e=null){super(_e),this.cutoffDistanceNode=uniform(0).setGroup(renderGroup),this.decayExponentNode=uniform(0).setGroup(renderGroup)}update(_e){const{light:et}=this;super.update(_e),this.cutoffDistanceNode.value=et.distance,this.decayExponentNode.value=et.decay}setup(_e){const{colorNode:et,cutoffDistanceNode:rt,decayExponentNode:it,light:st}=this,ot=_e.context.lightingModel,at=lightViewPosition(st).sub(positionView),lt=at.normalize(),ct=at.length(),ut=getDistanceAttenuation({lightDistance:ct,cutoffDistance:rt,decayExponent:it}),ht=et.mul(ut),dt=_e.context.reflectedLight;ot.direct({lightDirection:lt,lightColor:ht,reflectedLight:dt},_e.stack,_e)}}class DirectionalLightNode extends AnalyticLightNode{static get type(){return"DirectionalLightNode"}constructor(_e=null){super(_e)}setup(_e){super.setup(_e);const et=_e.context.lightingModel,rt=this.colorNode,it=lightTargetDirection(this.light),st=_e.context.reflectedLight;et.direct({lightDirection:it,lightColor:rt,reflectedLight:st},_e.stack,_e)}}const _matrix41=new Matrix4,_matrix42=new Matrix4;let ltcLib=null;class RectAreaLightNode extends AnalyticLightNode{static get type(){return"RectAreaLightNode"}constructor(_e=null){super(_e),this.halfHeight=uniform(new Vector3).setGroup(renderGroup),this.halfWidth=uniform(new Vector3).setGroup(renderGroup)}update(_e){super.update(_e);const{light:et}=this,rt=_e.camera.matrixWorldInverse;_matrix42.identity(),_matrix41.copy(et.matrixWorld),_matrix41.premultiply(rt),_matrix42.extractRotation(_matrix41),this.halfWidth.value.set(et.width*.5,0,0),this.halfHeight.value.set(0,et.height*.5,0),this.halfWidth.value.applyMatrix4(_matrix42),this.halfHeight.value.applyMatrix4(_matrix42)}setup(_e){super.setup(_e);let et,rt;_e.isAvailable("float32Filterable")?(et=texture(ltcLib.LTC_FLOAT_1),rt=texture(ltcLib.LTC_FLOAT_2)):(et=texture(ltcLib.LTC_HALF_1),rt=texture(ltcLib.LTC_HALF_2));const{colorNode:it,light:st}=this,ot=_e.context.lightingModel,at=lightViewPosition(st),lt=_e.context.reflectedLight;ot.directRectArea({lightColor:it,lightPosition:at,halfWidth:this.halfWidth,halfHeight:this.halfHeight,reflectedLight:lt,ltc_1:et,ltc_2:rt},_e.stack,_e)}static setLTC(_e){ltcLib=_e}}class SpotLightNode extends AnalyticLightNode{static get type(){return"SpotLightNode"}constructor(_e=null){super(_e),this.coneCosNode=uniform(0).setGroup(renderGroup),this.penumbraCosNode=uniform(0).setGroup(renderGroup),this.cutoffDistanceNode=uniform(0).setGroup(renderGroup),this.decayExponentNode=uniform(0).setGroup(renderGroup)}update(_e){super.update(_e);const{light:et}=this;this.coneCosNode.value=Math.cos(et.angle),this.penumbraCosNode.value=Math.cos(et.angle*(1-et.penumbra)),this.cutoffDistanceNode.value=et.distance,this.decayExponentNode.value=et.decay}getSpotAttenuation(_e){const{coneCosNode:et,penumbraCosNode:rt}=this;return smoothstep(et,rt,_e)}setup(_e){super.setup(_e);const et=_e.context.lightingModel,{colorNode:rt,cutoffDistanceNode:it,decayExponentNode:st,light:ot}=this,at=lightViewPosition(ot).sub(positionView),lt=at.normalize(),ct=lt.dot(lightTargetDirection(ot)),ut=this.getSpotAttenuation(ct),ht=at.length(),dt=getDistanceAttenuation({lightDistance:ht,cutoffDistance:it,decayExponent:st}),ft=rt.mul(ut).mul(dt),pt=_e.context.reflectedLight;et.direct({lightDirection:lt,lightColor:ft,reflectedLight:pt},_e.stack,_e)}}class IESSpotLightNode extends SpotLightNode{static get type(){return"IESSpotLightNode"}getSpotAttenuation(_e){const et=this.light.iesMap;let rt=null;if(et&&et.isTexture===!0){const it=_e.acos().mul(1/Math.PI);rt=texture(et,vec2(it,0),0).r}else rt=super.getSpotAttenuation(_e);return rt}}class AmbientLightNode extends AnalyticLightNode{static get type(){return"AmbientLightNode"}constructor(_e=null){super(_e)}setup({context:_e}){_e.irradiance.addAssign(this.colorNode)}}class HemisphereLightNode extends AnalyticLightNode{static get type(){return"HemisphereLightNode"}constructor(_e=null){super(_e),this.lightPositionNode=lightPosition(_e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=uniform(new Color).setGroup(renderGroup)}update(_e){const{light:et}=this;super.update(_e),this.lightPositionNode.object3d=et,this.groundColorNode.value.copy(et.groundColor).multiplyScalar(et.intensity)}setup(_e){const{colorNode:et,groundColorNode:rt,lightDirectionNode:it}=this,ot=normalView.dot(it).mul(.5).add(.5),at=mix$2(rt,et,ot);_e.context.irradiance.addAssign(at)}}class LightProbeNode extends AnalyticLightNode{static get type(){return"LightProbeNode"}constructor(_e=null){super(_e);const et=[];for(let rt=0;rt<9;rt++)et.push(new Vector3);this.lightProbe=uniformArray(et)}update(_e){const{light:et}=this;super.update(_e);for(let rt=0;rt<9;rt++)this.lightProbe.array[rt].copy(et.sh.coefficients[rt]).multiplyScalar(et.intensity)}setup(_e){const et=getShIrradianceAt(normalWorld,this.lightProbe);_e.context.irradiance.addAssign(et)}}class NodeParser{parseFunction(){console.warn("Abstract function.")}}class NodeFunction{constructor(_e,et,rt="",it=""){this.type=_e,this.inputs=et,this.name=rt,this.precision=it}getCode(){console.warn("Abstract function.")}}NodeFunction.isNodeFunction=!0;const declarationRegexp$1=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,propertiesRegexp$1=/[a-z_0-9]+/ig,pragmaMain="#pragma main",parse$1=nt=>{nt=nt.trim();const _e=nt.indexOf(pragmaMain),et=_e!==-1?nt.slice(_e+pragmaMain.length):nt,rt=et.match(declarationRegexp$1);if(rt!==null&&rt.length===5){const it=rt[4],st=[];let ot=null;for(;(ot=propertiesRegexp$1.exec(it))!==null;)st.push(ot);const at=[];let lt=0;for(;lt<st.length;){const pt=st[lt][0]==="const";pt===!0&&lt++;let mt=st[lt][0];mt==="in"||mt==="out"||mt==="inout"?lt++:mt="";const At=st[lt++][0];let gt=Number.parseInt(st[lt][0]);Number.isNaN(gt)===!1?lt++:gt=null;const bt=st[lt++][0];at.push(new NodeFunctionInput(At,bt,gt,mt,pt))}const ct=et.substring(rt[0].length),ut=rt[3]!==void 0?rt[3]:"",ht=rt[2],dt=rt[1]!==void 0?rt[1]:"",ft=_e!==-1?nt.slice(0,_e):"";return{type:ht,inputs:at,name:ut,precision:dt,inputsCode:it,blockCode:ct,headerCode:ft}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class GLSLNodeFunction extends NodeFunction{constructor(_e){const{type:et,inputs:rt,name:it,precision:st,inputsCode:ot,blockCode:at,headerCode:lt}=parse$1(_e);super(et,rt,it,st),this.inputsCode=ot,this.blockCode=at,this.headerCode=lt}getCode(_e=this.name){let et;const rt=this.blockCode;if(rt!==""){const{type:it,inputsCode:st,headerCode:ot,precision:at}=this;let lt=`${it} ${_e} ( ${st.trim()} )`;at!==""&&(lt=`${at} ${lt}`),et=ot+lt+rt}else et="";return et}}class GLSLNodeParser extends NodeParser{parseFunction(_e){return new GLSLNodeFunction(_e)}}function painterSortStable(nt,_e){return nt.groupOrder!==_e.groupOrder?nt.groupOrder-_e.groupOrder:nt.renderOrder!==_e.renderOrder?nt.renderOrder-_e.renderOrder:nt.material.id!==_e.material.id?nt.material.id-_e.material.id:nt.z!==_e.z?nt.z-_e.z:nt.id-_e.id}function reversePainterSortStable(nt,_e){return nt.groupOrder!==_e.groupOrder?nt.groupOrder-_e.groupOrder:nt.renderOrder!==_e.renderOrder?nt.renderOrder-_e.renderOrder:nt.z!==_e.z?_e.z-nt.z:nt.id-_e.id}class RenderList{constructor(){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparent=[],this.bundles=[],this.lightsNode=new LightsNode([]),this.lightsArray=[],this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(_e,et,rt,it,st,ot){let at=this.renderItems[this.renderItemsIndex];return at===void 0?(at={id:_e.id,object:_e,geometry:et,material:rt,groupOrder:it,renderOrder:_e.renderOrder,z:st,group:ot},this.renderItems[this.renderItemsIndex]=at):(at.id=_e.id,at.object=_e,at.geometry=et,at.material=rt,at.groupOrder=it,at.renderOrder=_e.renderOrder,at.z=st,at.group=ot),this.renderItemsIndex++,at}push(_e,et,rt,it,st,ot){const at=this.getNextRenderItem(_e,et,rt,it,st,ot);_e.occlusionTest===!0&&this.occlusionQueryCount++,(rt.transparent===!0||rt.transmission>0?this.transparent:this.opaque).push(at)}unshift(_e,et,rt,it,st,ot){const at=this.getNextRenderItem(_e,et,rt,it,st,ot);(rt.transparent===!0?this.transparent:this.opaque).unshift(at)}pushBundle(_e){this.bundles.push(_e)}pushLight(_e){this.lightsArray.push(_e)}getLightsNode(){return this.lightsNode.fromLights(this.lightsArray)}sort(_e,et){this.opaque.length>1&&this.opaque.sort(_e||painterSortStable),this.transparent.length>1&&this.transparent.sort(et||reversePainterSortStable)}finish(){this.lightsNode.setLights(this.lightsArray);for(let _e=this.renderItemsIndex,et=this.renderItems.length;_e<et;_e++){const rt=this.renderItems[_e];if(rt.id===null)break;rt.id=null,rt.object=null,rt.geometry=null,rt.material=null,rt.groupOrder=null,rt.renderOrder=null,rt.z=null,rt.group=null}}}class RenderLists{constructor(){this.lists=new ChainMap}get(_e,et){const rt=this.lists,it=[_e,et];let st=rt.get(it);return st===void 0&&(st=new RenderList,rt.set(it,st)),st}dispose(){this.lists=new ChainMap}}let id$2=0;class RenderContext{constructor(){this.id=id$2++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Vector4,this.scissor=!1,this.scissorValue=new Vector4,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.sampleCount=1,this.width=0,this.height=0,this.isRenderContext=!0}getCacheKey(){return getCacheKey(this)}}function getCacheKey(nt){const{textures:_e,activeCubeFace:et}=nt,rt=[et];for(const it of _e)rt.push(it.id);return hashArray(rt)}class RenderContexts{constructor(){this.chainMaps={}}get(_e,et,rt=null){const it=[_e,et];let st;if(rt===null)st="default";else{const lt=rt.texture.format;st=`${rt.textures.length}:${lt}:${rt.samples}:${rt.depthBuffer}:${rt.stencilBuffer}`}const ot=this.getChainMap(st);let at=ot.get(it);return at===void 0&&(at=new RenderContext,ot.set(it,at)),rt!==null&&(at.sampleCount=rt.samples===0?1:rt.samples),at}getChainMap(_e){return this.chainMaps[_e]||(this.chainMaps[_e]=new ChainMap)}dispose(){this.chainMaps={}}}const _size=new Vector3;class Textures extends DataMap{constructor(_e,et,rt){super(),this.renderer=_e,this.backend=et,this.info=rt}updateRenderTarget(_e,et=0){const rt=this.get(_e),it=_e.samples===0?1:_e.samples,st=rt.depthTextureMips||(rt.depthTextureMips={}),ot=_e.textures,at=this.getSize(ot[0]),lt=at.width>>et,ct=at.height>>et;let ut=_e.depthTexture||st[et],ht=!1;ut===void 0&&(ut=new DepthTexture,ut.format=_e.stencilBuffer?DepthStencilFormat:DepthFormat,ut.type=_e.stencilBuffer?UnsignedInt248Type:UnsignedIntType,ut.image.width=lt,ut.image.height=ct,st[et]=ut),(rt.width!==at.width||at.height!==rt.height)&&(ht=!0,ut.needsUpdate=!0,ut.image.width=lt,ut.image.height=ct),rt.width=at.width,rt.height=at.height,rt.textures=ot,rt.depthTexture=ut,rt.depth=_e.depthBuffer,rt.stencil=_e.stencilBuffer,rt.renderTarget=_e,rt.sampleCount!==it&&(ht=!0,ut.needsUpdate=!0,rt.sampleCount=it);const dt={sampleCount:it};for(let ft=0;ft<ot.length;ft++){const pt=ot[ft];ht&&(pt.needsUpdate=!0),this.updateTexture(pt,dt)}if(this.updateTexture(ut,dt),rt.initialized!==!0){rt.initialized=!0;const ft=()=>{_e.removeEventListener("dispose",ft);for(let pt=0;pt<ot.length;pt++)this._destroyTexture(ot[pt]);this._destroyTexture(ut),this.delete(_e)};_e.addEventListener("dispose",ft)}}updateTexture(_e,et={}){const rt=this.get(_e);if(rt.initialized===!0&&rt.version===_e.version)return;const it=_e.isRenderTargetTexture||_e.isDepthTexture||_e.isFramebufferTexture,st=this.backend;if(it&&rt.initialized===!0&&(st.destroySampler(_e),st.destroyTexture(_e)),_e.isFramebufferTexture){const ut=this.renderer.getRenderTarget();ut?_e.type=ut.texture.type:_e.type=UnsignedByteType}const{width:ot,height:at,depth:lt}=this.getSize(_e);if(et.width=ot,et.height=at,et.depth=lt,et.needsMipmaps=this.needsMipmaps(_e),et.levels=et.needsMipmaps?this.getMipLevels(_e,ot,at):1,it||_e.isStorageTexture===!0)st.createSampler(_e),st.createTexture(_e,et),rt.generation=_e.version;else if(rt.initialized!==!0&&st.createSampler(_e),_e.version>0){const ut=_e.image;if(ut===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(ut.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(_e.images){const ht=[];for(const dt of _e.images)ht.push(dt);et.images=ht}else et.image=ut;(rt.isDefaultTexture===void 0||rt.isDefaultTexture===!0)&&(st.createTexture(_e,et),rt.isDefaultTexture=!1,rt.generation=_e.version),_e.source.dataReady===!0&&st.updateTexture(_e,et),et.needsMipmaps&&_e.mipmaps.length===0&&st.generateMipmaps(_e)}}else st.createDefaultTexture(_e),rt.isDefaultTexture=!0,rt.generation=_e.version;if(rt.initialized!==!0){rt.initialized=!0,rt.generation=_e.version,this.info.memory.textures++;const ct=()=>{_e.removeEventListener("dispose",ct),this._destroyTexture(_e),this.info.memory.textures--};_e.addEventListener("dispose",ct)}rt.version=_e.version}getSize(_e,et=_size){let rt=_e.images?_e.images[0]:_e.image;return rt?(rt.image!==void 0&&(rt=rt.image),et.width=rt.width,et.height=rt.height,et.depth=_e.isCubeTexture?6:rt.depth||1):et.width=et.height=et.depth=1,et}getMipLevels(_e,et,rt){let it;return _e.isCompressedTexture?it=_e.mipmaps.length:it=Math.floor(Math.log2(Math.max(et,rt)))+1,it}needsMipmaps(_e){return this.isEnvironmentTexture(_e)?!0:_e.isCompressedTexture===!0||_e.minFilter!==NearestFilter&&_e.minFilter!==LinearFilter}isEnvironmentTexture(_e){const et=_e.mapping;return et===EquirectangularReflectionMapping||et===EquirectangularRefractionMapping||et===CubeReflectionMapping||et===CubeRefractionMapping}_destroyTexture(_e){this.backend.destroySampler(_e),this.backend.destroyTexture(_e),this.delete(_e)}}class Color4 extends Color{constructor(_e,et,rt,it=1){super(_e,et,rt),this.a=it}set(_e,et,rt,it=1){return this.a=it,super.set(_e,et,rt)}copy(_e){return _e.a!==void 0&&(this.a=_e.a),super.copy(_e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}const _clearColor=new Color4;class Background extends DataMap{constructor(_e,et){super(),this.renderer=_e,this.nodes=et}update(_e,et,rt){const it=this.renderer,st=this.nodes.getBackgroundNode(_e)||_e.background;let ot=!1;if(st===null)it._clearColor.getRGB(_clearColor,LinearSRGBColorSpace),_clearColor.a=it._clearColor.a;else if(st.isColor===!0)st.getRGB(_clearColor,LinearSRGBColorSpace),_clearColor.a=1,ot=!0;else if(st.isNode===!0){const at=this.get(_e),lt=st;_clearColor.copy(it._clearColor);let ct=at.backgroundMesh;if(ct===void 0){const ht=context$1(vec4(lt).mul(backgroundIntensity),{getUV:()=>normalWorld,getTextureLevel:()=>backgroundBlurriness});let dt=modelViewProjection();dt=dt.setZ(dt.w);const ft=new NodeMaterial;ft.name="Background.material",ft.side=BackSide,ft.depthTest=!1,ft.depthWrite=!1,ft.fog=!1,ft.lights=!1,ft.vertexNode=dt,ft.colorNode=ht,at.backgroundMeshNode=ht,at.backgroundMesh=ct=new Mesh(new SphereGeometry(1,32,32),ft),ct.frustumCulled=!1,ct.name="Background.mesh",ct.onBeforeRender=function(pt,mt,At){this.matrixWorld.copyPosition(At.matrixWorld)}}const ut=lt.getCacheKey();at.backgroundCacheKey!==ut&&(at.backgroundMeshNode.node=vec4(lt).mul(backgroundIntensity),at.backgroundMeshNode.needsUpdate=!0,ct.material.needsUpdate=!0,at.backgroundCacheKey=ut),et.unshift(ct,ct.geometry,ct.material,0,0,null)}else console.error("THREE.Renderer: Unsupported background configuration.",st);if(it.autoClear===!0||ot===!0){_clearColor.multiplyScalar(_clearColor.a);const at=rt.clearColorValue;at.r=_clearColor.r,at.g=_clearColor.g,at.b=_clearColor.b,at.a=_clearColor.a,rt.depthClearValue=it._clearDepth,rt.stencilClearValue=it._clearStencil,rt.clearColor=it.autoClearColor===!0,rt.clearDepth=it.autoClearDepth===!0,rt.clearStencil=it.autoClearStencil===!0}else rt.clearColor=!1,rt.clearDepth=!1,rt.clearStencil=!1}}class NodeBuilderState{constructor(_e,et,rt,it,st,ot,at,lt,ct,ut=[]){this.vertexShader=_e,this.fragmentShader=et,this.computeShader=rt,this.transforms=ut,this.nodeAttributes=it,this.bindings=st,this.updateNodes=ot,this.updateBeforeNodes=at,this.updateAfterNodes=lt,this.monitor=ct,this.usedTimes=0}createBindings(){const _e=[];for(const et of this.bindings)if(et.bindings[0].groupNode.shared!==!0){const it=new BindGroup(et.name,[],et.index,et);_e.push(it);for(const st of et.bindings)it.bindings.push(st.clone())}else _e.push(et);return _e}}const outputNodeMap=new WeakMap;class Nodes extends DataMap{constructor(_e,et){super(),this.renderer=_e,this.backend=et,this.nodeFrame=new NodeFrame,this.nodeBuilderCache=new Map,this.callHashCache=new ChainMap,this.groupsData=new ChainMap}updateGroup(_e){const et=_e.groupNode,rt=et.name;if(rt===objectGroup.name)return!0;if(rt===renderGroup.name){const ot=this.get(_e),at=this.nodeFrame.renderId;return ot.renderId!==at?(ot.renderId=at,!0):!1}if(rt===frameGroup.name){const ot=this.get(_e),at=this.nodeFrame.frameId;return ot.frameId!==at?(ot.frameId=at,!0):!1}const it=[et,_e];let st=this.groupsData.get(it);return st===void 0&&this.groupsData.set(it,st={}),st.version!==et.version?(st.version=et.version,!0):!1}getForRenderCacheKey(_e){return _e.initialCacheKey}getForRender(_e){const et=this.get(_e);let rt=et.nodeBuilderState;if(rt===void 0){const{nodeBuilderCache:it}=this,st=this.getForRenderCacheKey(_e);if(rt=it.get(st),rt===void 0){const ot=this.backend.createNodeBuilder(_e.object,this.renderer);ot.scene=_e.scene,ot.material=_e.material,ot.camera=_e.camera,ot.context.material=_e.material,ot.lightsNode=_e.lightsNode,ot.environmentNode=this.getEnvironmentNode(_e.scene),ot.fogNode=this.getFogNode(_e.scene),ot.clippingContext=_e.clippingContext,ot.build(),rt=this._createNodeBuilderState(ot),it.set(st,rt)}rt.usedTimes++,et.nodeBuilderState=rt}return rt}delete(_e){if(_e.isRenderObject){const et=this.get(_e).nodeBuilderState;et.usedTimes--,et.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(_e))}return super.delete(_e)}getForCompute(_e){const et=this.get(_e);let rt=et.nodeBuilderState;if(rt===void 0){const it=this.backend.createNodeBuilder(_e,this.renderer);it.build(),rt=this._createNodeBuilderState(it),et.nodeBuilderState=rt}return rt}_createNodeBuilderState(_e){return new NodeBuilderState(_e.vertexShader,_e.fragmentShader,_e.computeShader,_e.getAttributesArray(),_e.getBindings(),_e.updateNodes,_e.updateBeforeNodes,_e.updateAfterNodes,_e.monitor,_e.transforms)}getEnvironmentNode(_e){return _e.environmentNode||this.get(_e).environmentNode||null}getBackgroundNode(_e){return _e.backgroundNode||this.get(_e).backgroundNode||null}getFogNode(_e){return _e.fogNode||this.get(_e).fogNode||null}getCacheKey(_e,et){const rt=[_e,et],it=this.renderer.info.calls;let st=this.callHashCache.get(rt);if(st===void 0||st.callId!==it){const ot=this.getEnvironmentNode(_e),at=this.getFogNode(_e),lt=[];et&&lt.push(et.getCacheKey(!0)),ot&&lt.push(ot.getCacheKey()),at&&lt.push(at.getCacheKey()),lt.push(this.renderer.shadowMap.enabled?1:0),st={callId:it,cacheKey:hashArray(lt)},this.callHashCache.set(rt,st)}return st.cacheKey}updateScene(_e){this.updateEnvironment(_e),this.updateFog(_e),this.updateBackground(_e)}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(_e){const et=this.get(_e),rt=_e.background;if(rt){const it=_e.backgroundBlurriness===0&&et.backgroundBlurriness>0||_e.backgroundBlurriness>0&&et.backgroundBlurriness===0;if(et.background!==rt||it){let st=null;if(rt.isCubeTexture===!0||rt.mapping===EquirectangularReflectionMapping||rt.mapping===EquirectangularRefractionMapping||rt.mapping===CubeUVReflectionMapping)if(_e.backgroundBlurriness>0||rt.mapping===CubeUVReflectionMapping)st=pmremTexture(rt,normalWorld);else{let ot;rt.isCubeTexture===!0?ot=cubeTexture(rt):ot=texture(rt),st=cubeMapNode(ot)}else rt.isTexture===!0?st=texture(rt,screenUV.flipY()).setUpdateMatrix(!0):rt.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",rt);et.backgroundNode=st,et.background=rt,et.backgroundBlurriness=_e.backgroundBlurriness}}else et.backgroundNode&&(delete et.backgroundNode,delete et.background)}updateFog(_e){const et=this.get(_e),rt=_e.fog;if(rt){if(et.fog!==rt){let it=null;if(rt.isFogExp2){const st=reference("color","color",rt).setGroup(renderGroup),ot=reference("density","float",rt).setGroup(renderGroup);it=densityFog(st,ot)}else if(rt.isFog){const st=reference("color","color",rt).setGroup(renderGroup),ot=reference("near","float",rt).setGroup(renderGroup),at=reference("far","float",rt).setGroup(renderGroup);it=rangeFog(st,ot,at)}else console.error("WebGPUNodes: Unsupported fog configuration.",rt);et.fogNode=it,et.fog=rt}}else delete et.fogNode,delete et.fog}updateEnvironment(_e){const et=this.get(_e),rt=_e.environment;if(rt){if(et.environment!==rt){let it=null;rt.isCubeTexture===!0?it=cubeTexture(rt):rt.isTexture===!0?it=texture(rt):console.error("Nodes: Unsupported environment configuration.",rt),et.environmentNode=it,et.environment=rt}}else et.environmentNode&&(delete et.environmentNode,delete et.environment)}getNodeFrame(_e=this.renderer,et=null,rt=null,it=null,st=null){const ot=this.nodeFrame;return ot.renderer=_e,ot.scene=et,ot.object=rt,ot.camera=it,ot.material=st,ot}getNodeFrameForRender(_e){return this.getNodeFrame(_e.renderer,_e.scene,_e.object,_e.camera,_e.material)}getOutputCacheKey(){const _e=this.renderer;return _e.toneMapping+","+_e.currentColorSpace}hasOutputChange(_e){return outputNodeMap.get(_e)!==this.getOutputCacheKey()}getOutputNode(_e){const et=this.renderer,rt=this.getOutputCacheKey(),it=texture(_e,screenUV).renderOutput(et.toneMapping,et.currentColorSpace);return outputNodeMap.set(_e,rt),it}updateBefore(_e){const et=_e.getNodeBuilderState();for(const rt of et.updateBeforeNodes)this.getNodeFrameForRender(_e).updateBeforeNode(rt)}updateAfter(_e){const et=_e.getNodeBuilderState();for(const rt of et.updateAfterNodes)this.getNodeFrameForRender(_e).updateAfterNode(rt)}updateForCompute(_e){const et=this.getNodeFrame(),rt=this.getForCompute(_e);for(const it of rt.updateNodes)et.updateNode(it)}updateForRender(_e){const et=this.getNodeFrameForRender(_e),rt=_e.getNodeBuilderState();for(const it of rt.updateNodes)et.updateNode(it)}needsRefresh(_e){const et=this.getNodeFrameForRender(_e);return _e.getMonitor().needsRefresh(_e,et)}dispose(){super.dispose(),this.nodeFrame=new NodeFrame,this.nodeBuilderCache=new Map}}class RenderBundle{constructor(_e,et){this.scene=_e,this.camera=et}clone(){return Object.assign(new this.constructor,this)}}class RenderBundles{constructor(){this.lists=new ChainMap}get(_e,et){const rt=this.lists,it=[_e,et];let st=rt.get(it);return st===void 0&&(st=new RenderBundle(_e,et),rt.set(it,st)),st}dispose(){this.lists=new ChainMap}}class NodeLibrary{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map,this.colorSpaceNodes=new Map}fromMaterial(_e){if(_e.isNodeMaterial)return _e;let et=null;const rt=this.getMaterialNodeClass(_e.type);if(rt!==null){et=new rt;for(const it in _e)et[it]=_e[it]}return et}addColorSpace(_e,et){this.addType(_e,et,this.colorSpaceNodes)}getColorSpaceFunction(_e){return this.colorSpaceNodes.get(_e)||null}addToneMapping(_e,et){this.addType(_e,et,this.toneMappingNodes)}getToneMappingFunction(_e){return this.toneMappingNodes.get(_e)||null}getMaterialNodeClass(_e){return this.materialNodes.get(_e)||null}addMaterial(_e,et){this.addType(_e,et.name,this.materialNodes)}getLightNodeClass(_e){return this.lightNodes.get(_e)||null}addLight(_e,et){this.addClass(_e,et,this.lightNodes)}addType(_e,et,rt){if(rt.has(et)){console.warn(`Redefinition of node ${et}`);return}if(typeof _e!="function")throw new Error(`Node class ${_e.name} is not a class.`);if(typeof et=="function"||typeof et=="object")throw new Error(`Base class ${et} is not a class.`);rt.set(et,_e)}addClass(_e,et,rt){if(rt.has(et)){console.warn(`Redefinition of node ${et.name}`);return}if(typeof _e!="function")throw new Error(`Node class ${_e.name} is not a class.`);if(typeof et!="function")throw new Error(`Base class ${et.name} is not a class.`);rt.set(et,_e)}}const _scene=new Scene,_drawingBufferSize=new Vector2,_screen=new Vector4,_frustum=new Frustum,_projScreenMatrix=new Matrix4,_vector4=new Vector4;class Renderer{constructor(_e,et={}){this.isRenderer=!0;const{logarithmicDepthBuffer:rt=!1,alpha:it=!0,depth:st=!0,stencil:ot=!1,antialias:at=!1,samples:lt=0,getFallback:ct=null}=et;this.domElement=_e.getDomElement(),this.backend=_e,this.samples=lt||at===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=it,this.logarithmicDepthBuffer=rt,this.outputColorSpace=SRGBColorSpace,this.toneMapping=NoToneMapping,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=st,this.stencil=ot,this.clippingPlanes=[],this.info=new Info,this.nodes={library:new NodeLibrary,modelViewMatrix:null,modelNormalViewMatrix:null},this._getFallback=ct,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Vector4(0,0,this._width,this._height),this._scissor=new Vector4(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new QuadMesh(new NodeMaterial),this._quad.material.type="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const ut=this.alpha===!0?0:1;this._clearColor=new Color4(0,0,0,ut),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:PCFShadowMap$1},this.xr={enabled:!1},this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(ht,dt,ft)=>{await this.compileAsync(ht,dt);const pt=this._renderLists.get(ht,dt),mt=this._renderContexts.get(ht,dt,this._renderTarget),At=ht.overrideMaterial||ft.material,gt=this._objects.get(ft,At,ht,dt,pt.lightsNode,mt),{fragmentShader:bt,vertexShader:Tt}=gt.getNodeBuilderState();return{fragmentShader:bt,vertexShader:Tt}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(_e,et)=>{let rt=this.backend;try{await rt.init(this)}catch(it){if(this._getFallback!==null)try{this.backend=rt=this._getFallback(it),await rt.init(this)}catch(st){et(st);return}else{et(it);return}}this._nodes=new Nodes(this,rt),this._animation=new Animation(this._nodes,this.info),this._attributes=new Attributes(rt),this._background=new Background(this,this._nodes),this._geometries=new Geometries(this._attributes,this.info),this._textures=new Textures(this,rt,this.info),this._pipelines=new Pipelines(rt,this._nodes),this._bindings=new Bindings(rt,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new RenderObjects(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new RenderLists,this._bundles=new RenderBundles,this._renderContexts=new RenderContexts,this._initialized=!0,_e()}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(_e,et,rt=null){this._initialized===!1&&await this.init();const it=this._nodes.nodeFrame,st=it.renderId,ot=this._currentRenderContext,at=this._currentRenderObjectFunction,lt=this._compilationPromises,ct=_e.isScene===!0?_e:_scene;rt===null&&(rt=_e);const ut=this._renderTarget,ht=this._renderContexts.get(rt,et,ut),dt=this._activeMipmapLevel,ft=[];this._currentRenderContext=ht,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=ft,it.renderId++,it.update(),ht.depth=this.depth,ht.stencil=this.stencil,ht.clippingContext||(ht.clippingContext=new ClippingContext),ht.clippingContext.updateGlobal(this,et),ct.onBeforeRender(this,_e,et,ut);const pt=this._renderLists.get(_e,et);if(pt.begin(),this._projectObject(_e,et,0,pt),rt!==_e&&rt.traverseVisible(function(bt){bt.isLight&&bt.layers.test(et.layers)&&pt.pushLight(bt)}),pt.finish(),ut!==null){this._textures.updateRenderTarget(ut,dt);const bt=this._textures.get(ut);ht.textures=bt.textures,ht.depthTexture=bt.depthTexture}else ht.textures=null,ht.depthTexture=null;this._nodes.updateScene(ct),this._background.update(ct,pt,ht);const mt=pt.opaque,At=pt.transparent,gt=pt.lightsNode;this.opaque===!0&&mt.length>0&&this._renderObjects(mt,et,ct,gt),this.transparent===!0&&At.length>0&&this._renderObjects(At,et,ct,gt),it.renderId=st,this._currentRenderContext=ot,this._currentRenderObjectFunction=at,this._compilationPromises=lt,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(ft)}async renderAsync(_e,et){this._initialized===!1&&await this.init();const rt=this._renderScene(_e,et);await this.backend.resolveTimestampAsync(rt,"render")}setMRT(_e){return this._mrt=_e,this}getMRT(){return this._mrt}_renderBundle(_e,et,rt){const{bundleGroup:it,camera:st,renderList:ot}=_e,at=this._currentRenderContext,lt=this._bundles.get(it,st),ct=this.backend.get(lt);ct.renderContexts===void 0&&(ct.renderContexts=new Set);const ut=it.version!==ct.version,ht=ct.renderContexts.has(at)===!1||ut;if(ct.renderContexts.add(at),ht){this.backend.beginBundle(at),(ct.renderObjects===void 0||ut)&&(ct.renderObjects=[]),this._currentRenderBundle=lt;const dt=ot.opaque;dt.length>0&&this._renderObjects(dt,st,et,rt),this._currentRenderBundle=null,this.backend.finishBundle(at,lt),ct.version=it.version}else{const{renderObjects:dt}=ct;for(let ft=0,pt=dt.length;ft<pt;ft++){const mt=dt[ft];this._nodes.needsRefresh(mt)&&(this._nodes.updateBefore(mt),this._nodes.updateForRender(mt),this._bindings.updateForRender(mt),this._nodes.updateAfter(mt))}}this.backend.addBundle(at,lt)}render(_e,et){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(_e,et);this._renderScene(_e,et)}_getFrameBufferTarget(){const{currentToneMapping:_e,currentColorSpace:et}=this;if(_e!==NoToneMapping===!1&&et!==LinearSRGBColorSpace===!1)return null;const{width:st,height:ot}=this.getDrawingBufferSize(_drawingBufferSize),{depth:at,stencil:lt}=this;let ct=this._frameBufferTarget;return ct===null&&(ct=new RenderTarget(st,ot,{depthBuffer:at,stencilBuffer:lt,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,generateMipmaps:!1,minFilter:LinearFilter,magFilter:LinearFilter,samples:this.samples}),ct.isPostProcessingRenderTarget=!0,this._frameBufferTarget=ct),ct.depthBuffer=at,ct.stencilBuffer=lt,ct.setSize(st,ot),ct.viewport.copy(this._viewport),ct.scissor.copy(this._scissor),ct.viewport.multiplyScalar(this._pixelRatio),ct.scissor.multiplyScalar(this._pixelRatio),ct.scissorTest=this._scissorTest,ct}_renderScene(_e,et,rt=!0){const it=rt?this._getFrameBufferTarget():null,st=this._nodes.nodeFrame,ot=st.renderId,at=this._currentRenderContext,lt=this._currentRenderObjectFunction,ct=_e.isScene===!0?_e:_scene,ut=this._renderTarget,ht=this._activeCubeFace,dt=this._activeMipmapLevel;let ft;it!==null?(ft=it,this.setRenderTarget(ft)):ft=ut;const pt=this._renderContexts.get(_e,et,ft);this._currentRenderContext=pt,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,st.renderId=this.info.calls;const mt=this.coordinateSystem;et.coordinateSystem!==mt&&(et.coordinateSystem=mt,et.updateProjectionMatrix()),_e.matrixWorldAutoUpdate===!0&&_e.updateMatrixWorld(),et.parent===null&&et.matrixWorldAutoUpdate===!0&&et.updateMatrixWorld();let At=this._viewport,gt=this._scissor,bt=this._pixelRatio;ft!==null&&(At=ft.viewport,gt=ft.scissor,bt=1),this.getDrawingBufferSize(_drawingBufferSize),_screen.set(0,0,_drawingBufferSize.width,_drawingBufferSize.height);const Tt=At.minDepth===void 0?0:At.minDepth,wt=At.maxDepth===void 0?1:At.maxDepth;pt.viewportValue.copy(At).multiplyScalar(bt).floor(),pt.viewportValue.width>>=dt,pt.viewportValue.height>>=dt,pt.viewportValue.minDepth=Tt,pt.viewportValue.maxDepth=wt,pt.viewport=pt.viewportValue.equals(_screen)===!1,pt.scissorValue.copy(gt).multiplyScalar(bt).floor(),pt.scissor=this._scissorTest&&pt.scissorValue.equals(_screen)===!1,pt.scissorValue.width>>=dt,pt.scissorValue.height>>=dt,pt.clippingContext||(pt.clippingContext=new ClippingContext),pt.clippingContext.updateGlobal(this,et),ct.onBeforeRender(this,_e,et,ft),_projScreenMatrix.multiplyMatrices(et.projectionMatrix,et.matrixWorldInverse),_frustum.setFromProjectionMatrix(_projScreenMatrix,mt);const Rt=this._renderLists.get(_e,et);if(Rt.begin(),this._projectObject(_e,et,0,Rt),Rt.finish(),this.sortObjects===!0&&Rt.sort(this._opaqueSort,this._transparentSort),ft!==null){this._textures.updateRenderTarget(ft,dt);const Dt=this._textures.get(ft);pt.textures=Dt.textures,pt.depthTexture=Dt.depthTexture,pt.width=Dt.width,pt.height=Dt.height,pt.renderTarget=ft,pt.depth=ft.depthBuffer,pt.stencil=ft.stencilBuffer}else pt.textures=null,pt.depthTexture=null,pt.width=this.domElement.width,pt.height=this.domElement.height,pt.depth=this.depth,pt.stencil=this.stencil;pt.width>>=dt,pt.height>>=dt,pt.activeCubeFace=ht,pt.activeMipmapLevel=dt,pt.occlusionQueryCount=Rt.occlusionQueryCount,this._nodes.updateScene(ct),this._background.update(ct,Rt,pt),this.backend.beginRender(pt);const{bundles:It,lightsNode:Lt,transparent:$t,opaque:kt}=Rt;if(It.length>0&&this._renderBundles(It,ct,Lt),this.opaque===!0&&kt.length>0&&this._renderObjects(kt,et,ct,Lt),this.transparent===!0&&$t.length>0&&this._renderObjects($t,et,ct,Lt),this.backend.finishRender(pt),st.renderId=ot,this._currentRenderContext=at,this._currentRenderObjectFunction=lt,it!==null){this.setRenderTarget(ut,ht,dt);const Dt=this._quad;this._nodes.hasOutputChange(ft.texture)&&(Dt.material.fragmentNode=this._nodes.getOutputNode(ft.texture),Dt.material.needsUpdate=!0),this._renderScene(Dt,Dt.camera,!1)}return ct.onAfterRender(this,_e,et,ft),pt}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(_e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(_e)}async getArrayBufferAsync(_e){return await this.backend.getArrayBufferAsync(_e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(_e){return _e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(_e){return _e.set(this._width,this._height)}setPixelRatio(_e=1){this._pixelRatio=_e,this.setSize(this._width,this._height,!1)}setDrawingBufferSize(_e,et,rt){this._width=_e,this._height=et,this._pixelRatio=rt,this.domElement.width=Math.floor(_e*rt),this.domElement.height=Math.floor(et*rt),this.setViewport(0,0,_e,et),this._initialized&&this.backend.updateSize()}setSize(_e,et,rt=!0){this._width=_e,this._height=et,this.domElement.width=Math.floor(_e*this._pixelRatio),this.domElement.height=Math.floor(et*this._pixelRatio),rt===!0&&(this.domElement.style.width=_e+"px",this.domElement.style.height=et+"px"),this.setViewport(0,0,_e,et),this._initialized&&this.backend.updateSize()}setOpaqueSort(_e){this._opaqueSort=_e}setTransparentSort(_e){this._transparentSort=_e}getScissor(_e){const et=this._scissor;return _e.x=et.x,_e.y=et.y,_e.width=et.width,_e.height=et.height,_e}setScissor(_e,et,rt,it){const st=this._scissor;_e.isVector4?st.copy(_e):st.set(_e,et,rt,it)}getScissorTest(){return this._scissorTest}setScissorTest(_e){this._scissorTest=_e,this.backend.setScissorTest(_e)}getViewport(_e){return _e.copy(this._viewport)}setViewport(_e,et,rt,it,st=0,ot=1){const at=this._viewport;_e.isVector4?at.copy(_e):at.set(_e,et,rt,it),at.minDepth=st,at.maxDepth=ot}getClearColor(_e){return _e.copy(this._clearColor)}setClearColor(_e,et=1){this._clearColor.set(_e),this._clearColor.a=et}getClearAlpha(){return this._clearColor.a}setClearAlpha(_e){this._clearColor.a=_e}getClearDepth(){return this._clearDepth}setClearDepth(_e){this._clearDepth=_e}getClearStencil(){return this._clearStencil}setClearStencil(_e){this._clearStencil=_e}isOccluded(_e){const et=this._currentRenderContext;return et&&this.backend.isOccluded(et,_e)}clear(_e=!0,et=!0,rt=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(_e,et,rt);const it=this._renderTarget||this._getFrameBufferTarget();let st=null;if(it!==null&&(this._textures.updateRenderTarget(it),st=this._textures.get(it)),this.backend.clear(_e,et,rt,st),it!==null&&this._renderTarget===null){const ot=this._quad;this._nodes.hasOutputChange(it.texture)&&(ot.material.fragmentNode=this._nodes.getOutputNode(it.texture),ot.material.needsUpdate=!0),this._renderScene(ot,ot.camera,!1)}}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(_e=!0,et=!0,rt=!0){this._initialized===!1&&await this.init(),this.clear(_e,et,rt)}clearColorAsync(){return this.clearAsync(!0,!1,!1)}clearDepthAsync(){return this.clearAsync(!1,!0,!1)}clearStencilAsync(){return this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this._renderTarget!==null?NoToneMapping:this.toneMapping}get currentColorSpace(){return this._renderTarget!==null?LinearSRGBColorSpace:this.outputColorSpace}dispose(){this.info.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(_e,et=0,rt=0){this._renderTarget=_e,this._activeCubeFace=et,this._activeMipmapLevel=rt}getRenderTarget(){return this._renderTarget}setRenderObjectFunction(_e){this._renderObjectFunction=_e}getRenderObjectFunction(){return this._renderObjectFunction}async computeAsync(_e){this._initialized===!1&&await this.init();const et=this._nodes.nodeFrame,rt=et.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,et.renderId=this.info.calls;const it=this.backend,st=this._pipelines,ot=this._bindings,at=this._nodes,lt=Array.isArray(_e)?_e:[_e];if(lt[0]===void 0||lt[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");it.beginCompute(_e);for(const ct of lt){if(st.has(ct)===!1){const dt=()=>{ct.removeEventListener("dispose",dt),st.delete(ct),ot.delete(ct),at.delete(ct)};ct.addEventListener("dispose",dt),ct.onInit({renderer:this})}at.updateForCompute(ct),ot.updateForCompute(ct);const ut=ot.getForCompute(ct),ht=st.getForCompute(ct,ut);it.compute(_e,ct,ut,ht)}it.finishCompute(_e),await this.backend.resolveTimestampAsync(_e,"compute"),et.renderId=rt}async hasFeatureAsync(_e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(_e)}hasFeature(_e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(_e)}copyFramebufferToTexture(_e,et=null){const rt=this._currentRenderContext;this._textures.updateTexture(_e),et=et===null?_vector4.set(0,0,_e.image.width,_e.image.height):et,this.backend.copyFramebufferToTexture(_e,rt,et)}copyTextureToTexture(_e,et,rt=null,it=null,st=0){this._textures.updateTexture(_e),this._textures.updateTexture(et),this.backend.copyTextureToTexture(_e,et,rt,it,st)}readRenderTargetPixelsAsync(_e,et,rt,it,st,ot=0,at=0){return this.backend.copyTextureToBuffer(_e.textures[ot],et,rt,it,st,at)}_projectObject(_e,et,rt,it){if(_e.visible===!1)return;if(_e.layers.test(et.layers)){if(_e.isGroup)rt=_e.renderOrder;else if(_e.isLOD)_e.autoUpdate===!0&&_e.update(et);else if(_e.isLight)it.pushLight(_e);else if(_e.isSprite){if(!_e.frustumCulled||_frustum.intersectsSprite(_e)){this.sortObjects===!0&&_vector4.setFromMatrixPosition(_e.matrixWorld).applyMatrix4(_projScreenMatrix);const{geometry:at,material:lt}=_e;lt.visible&&it.push(_e,at,lt,rt,_vector4.z,null)}}else if(_e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if((_e.isMesh||_e.isLine||_e.isPoints)&&(!_e.frustumCulled||_frustum.intersectsObject(_e))){const{geometry:at,material:lt}=_e;if(this.sortObjects===!0&&(at.boundingSphere===null&&at.computeBoundingSphere(),_vector4.copy(at.boundingSphere.center).applyMatrix4(_e.matrixWorld).applyMatrix4(_projScreenMatrix)),Array.isArray(lt)){const ct=at.groups;for(let ut=0,ht=ct.length;ut<ht;ut++){const dt=ct[ut],ft=lt[dt.materialIndex];ft&&ft.visible&&it.push(_e,at,ft,rt,_vector4.z,dt)}}else lt.visible&&it.push(_e,at,lt,rt,_vector4.z,null)}}if(_e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const at=it;it=this._renderLists.get(_e,et),it.begin(),at.pushBundle({bundleGroup:_e,camera:et,renderList:it}),it.finish()}const ot=_e.children;for(let at=0,lt=ot.length;at<lt;at++)this._projectObject(ot[at],et,rt,it)}_renderBundles(_e,et,rt){for(const it of _e)this._renderBundle(it,et,rt)}_renderObjects(_e,et,rt,it){for(let st=0,ot=_e.length;st<ot;st++){const at=_e[st],{object:lt,geometry:ct,material:ut,group:ht}=at;if(et.isArrayCamera){const dt=et.cameras;for(let ft=0,pt=dt.length;ft<pt;ft++){const mt=dt[ft];if(lt.layers.test(mt.layers)){const At=mt.viewport,gt=At.minDepth===void 0?0:At.minDepth,bt=At.maxDepth===void 0?1:At.maxDepth,Tt=this._currentRenderContext.viewportValue;Tt.copy(At).multiplyScalar(this._pixelRatio).floor(),Tt.minDepth=gt,Tt.maxDepth=bt,this.backend.updateViewport(this._currentRenderContext),this._currentRenderObjectFunction(lt,rt,mt,ct,ut,ht,it)}}}else this._currentRenderObjectFunction(lt,rt,et,ct,ut,ht,it)}}renderObject(_e,et,rt,it,st,ot,at){let lt,ct,ut;if(_e.onBeforeRender(this,et,rt,it,st,ot),et.overrideMaterial!==null){const ht=et.overrideMaterial;st.positionNode&&st.positionNode.isNode&&(lt=ht.positionNode,ht.positionNode=st.positionNode),ht.isShadowNodeMaterial&&(ht.side=st.shadowSide===null?st.side:st.shadowSide,st.depthNode&&st.depthNode.isNode&&(ut=ht.depthNode,ht.depthNode=st.depthNode),st.shadowNode&&st.shadowNode.isNode&&(ct=ht.fragmentNode,ht.fragmentNode=st.shadowNode),this.localClippingEnabled&&(st.clipShadows?(ht.clippingPlanes!==st.clippingPlanes&&(ht.clippingPlanes=st.clippingPlanes,ht.needsUpdate=!0),ht.clipIntersection!==st.clipIntersection&&(ht.clipIntersection=st.clipIntersection)):Array.isArray(ht.clippingPlanes)&&(ht.clippingPlanes=null,ht.needsUpdate=!0))),st=ht}st.transparent===!0&&st.side===DoubleSide&&st.forceSinglePass===!1?(st.side=BackSide,this._handleObjectFunction(_e,st,et,rt,at,ot,"backSide"),st.side=FrontSide,this._handleObjectFunction(_e,st,et,rt,at,ot),st.side=DoubleSide):this._handleObjectFunction(_e,st,et,rt,at,ot),lt!==void 0&&(et.overrideMaterial.positionNode=lt),ut!==void 0&&(et.overrideMaterial.depthNode=ut),ct!==void 0&&(et.overrideMaterial.fragmentNode=ct),_e.onAfterRender(this,et,rt,it,st,ot)}_renderObjectDirect(_e,et,rt,it,st,ot,at){const lt=this._objects.get(_e,et,rt,it,st,this._currentRenderContext,at);lt.drawRange=_e.geometry.drawRange,lt.group=ot;const ct=this._nodes.needsRefresh(lt);ct&&(this._nodes.updateBefore(lt),this._geometries.updateForRender(lt),this._nodes.updateForRender(lt),this._bindings.updateForRender(lt)),this._pipelines.updateForRender(lt),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(lt),lt.bundle=this._currentRenderBundle.scene),this.backend.draw(lt,this.info),ct&&this._nodes.updateAfter(lt)}_createObjectPipeline(_e,et,rt,it,st,ot){const at=this._objects.get(_e,et,rt,it,st,this._currentRenderContext,ot);this._nodes.updateBefore(at),this._geometries.updateForRender(at),this._nodes.updateForRender(at),this._bindings.updateForRender(at),this._pipelines.getForRender(at,this._compilationPromises),this._nodes.updateAfter(at)}get compute(){return this.computeAsync}get compile(){return this.compileAsync}}class Binding{constructor(_e=""){this.name=_e,this.visibility=0}setVisibility(_e){this.visibility|=_e}clone(){return Object.assign(new this.constructor,this)}}function getFloatLength(nt){return nt+(GPU_CHUNK_BYTES-nt%GPU_CHUNK_BYTES)%GPU_CHUNK_BYTES}class Buffer extends Binding{constructor(_e,et=null){super(_e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=et}get byteLength(){return getFloatLength(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class UniformBuffer extends Buffer{constructor(_e,et=null){super(_e,et),this.isUniformBuffer=!0}}let _id$4=0;class NodeUniformBuffer extends UniformBuffer{constructor(_e,et){super("UniformBuffer_"+_id$4++,_e?_e.value:null),this.nodeUniform=_e,this.groupNode=et}get buffer(){return this.nodeUniform.value}}class UniformsGroup extends UniformBuffer{constructor(_e){super(_e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(_e){return this.uniforms.push(_e),this}removeUniform(_e){const et=this.uniforms.indexOf(_e);return et!==-1&&this.uniforms.splice(et,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let _e=this._buffer;if(_e===null){const et=this.byteLength;_e=new Float32Array(new ArrayBuffer(et)),this._buffer=_e}return _e}get byteLength(){let _e=0;for(let et=0,rt=this.uniforms.length;et<rt;et++){const it=this.uniforms[et],{boundary:st,itemSize:ot}=it,at=_e%GPU_CHUNK_BYTES,lt=GPU_CHUNK_BYTES-at;at!==0&&lt-st<0?_e+=GPU_CHUNK_BYTES-at:at%st!==0&&(_e+=at%st),it.offset=_e/this.bytesPerElement,_e+=ot*this.bytesPerElement}return Math.ceil(_e/GPU_CHUNK_BYTES)*GPU_CHUNK_BYTES}update(){let _e=!1;for(const et of this.uniforms)this.updateByType(et)===!0&&(_e=!0);return _e}updateByType(_e){if(_e.isNumberUniform)return this.updateNumber(_e);if(_e.isVector2Uniform)return this.updateVector2(_e);if(_e.isVector3Uniform)return this.updateVector3(_e);if(_e.isVector4Uniform)return this.updateVector4(_e);if(_e.isColorUniform)return this.updateColor(_e);if(_e.isMatrix3Uniform)return this.updateMatrix3(_e);if(_e.isMatrix4Uniform)return this.updateMatrix4(_e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",_e)}updateNumber(_e){let et=!1;const rt=this.values,it=_e.getValue(),st=_e.offset;if(rt[st]!==it){const ot=this.buffer;ot[st]=rt[st]=it,et=!0}return et}updateVector2(_e){let et=!1;const rt=this.values,it=_e.getValue(),st=_e.offset;if(rt[st+0]!==it.x||rt[st+1]!==it.y){const ot=this.buffer;ot[st+0]=rt[st+0]=it.x,ot[st+1]=rt[st+1]=it.y,et=!0}return et}updateVector3(_e){let et=!1;const rt=this.values,it=_e.getValue(),st=_e.offset;if(rt[st+0]!==it.x||rt[st+1]!==it.y||rt[st+2]!==it.z){const ot=this.buffer;ot[st+0]=rt[st+0]=it.x,ot[st+1]=rt[st+1]=it.y,ot[st+2]=rt[st+2]=it.z,et=!0}return et}updateVector4(_e){let et=!1;const rt=this.values,it=_e.getValue(),st=_e.offset;if(rt[st+0]!==it.x||rt[st+1]!==it.y||rt[st+2]!==it.z||rt[st+4]!==it.w){const ot=this.buffer;ot[st+0]=rt[st+0]=it.x,ot[st+1]=rt[st+1]=it.y,ot[st+2]=rt[st+2]=it.z,ot[st+3]=rt[st+3]=it.w,et=!0}return et}updateColor(_e){let et=!1;const rt=this.values,it=_e.getValue(),st=_e.offset;if(rt[st+0]!==it.r||rt[st+1]!==it.g||rt[st+2]!==it.b){const ot=this.buffer;ot[st+0]=rt[st+0]=it.r,ot[st+1]=rt[st+1]=it.g,ot[st+2]=rt[st+2]=it.b,et=!0}return et}updateMatrix3(_e){let et=!1;const rt=this.values,it=_e.getValue().elements,st=_e.offset;if(rt[st+0]!==it[0]||rt[st+1]!==it[1]||rt[st+2]!==it[2]||rt[st+4]!==it[3]||rt[st+5]!==it[4]||rt[st+6]!==it[5]||rt[st+8]!==it[6]||rt[st+9]!==it[7]||rt[st+10]!==it[8]){const ot=this.buffer;ot[st+0]=rt[st+0]=it[0],ot[st+1]=rt[st+1]=it[1],ot[st+2]=rt[st+2]=it[2],ot[st+4]=rt[st+4]=it[3],ot[st+5]=rt[st+5]=it[4],ot[st+6]=rt[st+6]=it[5],ot[st+8]=rt[st+8]=it[6],ot[st+9]=rt[st+9]=it[7],ot[st+10]=rt[st+10]=it[8],et=!0}return et}updateMatrix4(_e){let et=!1;const rt=this.values,it=_e.getValue().elements,st=_e.offset;return arraysEqual(rt,it,st)===!1&&(this.buffer.set(it,st),setArray(rt,it,st),et=!0),et}}function setArray(nt,_e,et){for(let rt=0,it=_e.length;rt<it;rt++)nt[et+rt]=_e[rt]}function arraysEqual(nt,_e,et){for(let rt=0,it=_e.length;rt<it;rt++)if(nt[et+rt]!==_e[rt])return!1;return!0}let _id$3=0;class NodeUniformsGroup extends UniformsGroup{constructor(_e,et){super(_e),this.id=_id$3++,this.groupNode=et,this.isNodeUniformsGroup=!0}getNodes(){const _e=[];for(const et of this.uniforms){const rt=et.nodeUniform.node;if(!rt)throw new Error("NodeUniformsGroup: Uniform has no node.");_e.push(rt)}return _e}}let _id$2=0;class SampledTexture extends Binding{constructor(_e,et){super(_e),this.id=_id$2++,this.texture=et,this.version=et?et.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(_e){const{texture:et}=this;return _e!==this.generation?(this.generation=_e,!0):et.isVideoTexture}update(){const{texture:_e,version:et}=this;return et!==_e.version?(this.version=_e.version,!0):!1}}class NodeSampledTexture extends SampledTexture{constructor(_e,et,rt,it=null){super(_e,et?et.value:null),this.textureNode=et,this.groupNode=rt,this.access=it}needsBindingsUpdate(_e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(_e)}update(){const{textureNode:_e}=this;return this.texture!==_e.value?(this.texture=_e.value,!0):super.update()}}class NodeSampledCubeTexture extends NodeSampledTexture{constructor(_e,et,rt,it){super(_e,et,rt,it),this.isSampledCubeTexture=!0}}class NodeSampledTexture3D extends NodeSampledTexture{constructor(_e,et,rt,it){super(_e,et,rt,it),this.isSampledTexture3D=!0}}const glslMethods={atan2:"atan",textureDimensions:"textureSize",equals:"equal"},precisionLib={low:"lowp",medium:"mediump",high:"highp"},supports$1={swizzleAssign:!0,storageBuffer:!1},defaultPrecisions=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
`;class GLSLNodeBuilder extends NodeBuilder{constructor(_e,et){super(_e,et,new GLSLNodeParser),this.uniformGroups={},this.transforms=[],this.extensions={},this.useComparisonMethod=!0}needsColorSpaceToLinearSRGB(_e){return _e.isVideoTexture===!0&&_e.colorSpace!==NoColorSpace}getMethod(_e){return glslMethods[_e]||_e}getOutputStructName(){return""}buildFunctionCode(_e){const et=_e.layout,rt=this.flowShaderNode(_e),it=[];for(const ot of et.inputs)it.push(this.getType(ot.type)+" "+ot.name);return`${this.getType(et.type)} ${et.name}( ${it.join(", ")} ) {

	${rt.vars}

${rt.code}
	return ${rt.result};

}`}setupPBO(_e){const et=_e.value;if(et.pbo===void 0){const rt=et.array,it=et.count*et.itemSize,{itemSize:st}=et,ot=et.array.constructor.name.toLowerCase().includes("int");let at=ot?RedIntegerFormat:RedFormat;st===2?at=ot?RGIntegerFormat:RGFormat:st===3?at=ot?RGBIntegerFormat:RGBFormat:st===4&&(at=ot?RGBAIntegerFormat:RGBAFormat);const lt={Float32Array:FloatType,Uint8Array:UnsignedByteType,Uint16Array:UnsignedShortType,Uint32Array:UnsignedIntType,Int8Array:ByteType,Int16Array:ShortType,Int32Array:IntType,Uint8ClampedArray:UnsignedByteType},ct=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(it/st))));let ut=Math.ceil(it/st/ct);ct*ut*st<it&&ut++;const ht=ct*ut*st,dt=new rt.constructor(ht);dt.set(rt,0),et.array=dt;const ft=new DataTexture(et.array,ct,ut,at,lt[et.array.constructor.name]||FloatType);ft.needsUpdate=!0,ft.isPBOTexture=!0;const pt=new TextureNode(ft,null,null);pt.setPrecision("high"),et.pboNode=pt,et.pbo=pt.value,this.getUniformFromNode(et.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(_e,et=this.shaderStage){return _e.isNodeUniform&&_e.node.isTextureNode!==!0&&_e.node.isBufferNode!==!0?et.charAt(0)+"_"+_e.name:super.getPropertyName(_e,et)}generatePBO(_e){const{node:et,indexNode:rt}=_e,it=et.value;if(this.renderer.backend.has(it)){const ut=this.renderer.backend.get(it);ut.pbo=it.pbo}const st=this.getUniformFromNode(it.pboNode,"texture",this.shaderStage,this.context.label),ot=this.getPropertyName(st);this.increaseUsage(rt);const at=rt.build(this,"uint"),lt=this.getDataFromNode(_e);let ct=lt.propertyName;if(ct===void 0){const ut=this.getVarFromNode(_e);ct=this.getPropertyName(ut);const ht=this.getDataFromNode(et);let dt=ht.propertySizeName;dt===void 0&&(dt=ct+"Size",this.getVarFromNode(et,dt,"uint"),this.addLineFlowCode(`${dt} = uint( textureSize( ${ot}, 0 ).x )`,_e),ht.propertySizeName=dt);const{itemSize:ft}=it,pt="."+vectorComponents.join("").slice(0,ft),mt=`ivec2(${at} % ${dt}, ${at} / ${dt})`,At=this.generateTextureLoad(null,ot,mt,null,"0");let gt="vec4";it.pbo.type===UnsignedIntType?gt="uvec4":it.pbo.type===IntType&&(gt="ivec4"),this.addLineFlowCode(`${ct} = ${gt}(${At})${pt}`,_e),lt.propertyName=ct}return ct}generateTextureLoad(_e,et,rt,it,st="0"){return it?`texelFetch( ${et}, ivec3( ${rt}, ${it} ), ${st} )`:`texelFetch( ${et}, ${rt}, ${st} )`}generateTexture(_e,et,rt,it){return _e.isDepthTexture?`texture( ${et}, ${rt} ).x`:(it&&(rt=`vec3( ${rt}, ${it} )`),`texture( ${et}, ${rt} )`)}generateTextureLevel(_e,et,rt,it){return`textureLod( ${et}, ${rt}, ${it} )`}generateTextureBias(_e,et,rt,it){return`texture( ${et}, ${rt}, ${it} )`}generateTextureGrad(_e,et,rt,it){return`textureGrad( ${et}, ${rt}, ${it[0]}, ${it[1]} )`}generateTextureCompare(_e,et,rt,it,st,ot=this.shaderStage){if(ot==="fragment")return`texture( ${et}, vec3( ${rt}, ${it} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${ot} shader.`)}getVars(_e){const et=[],rt=this.vars[_e];if(rt!==void 0)for(const it of rt)et.push(`${this.getVar(it.type,it.name)};`);return et.join(`
	`)}getUniforms(_e){const et=this.uniforms[_e],rt=[],it={};for(const ot of et){let at=null,lt=!1;if(ot.type==="texture"){const ut=ot.node.value;let ht="";ut.isDataTexture===!0&&(ut.type===UnsignedIntType?ht="u":ut.type===IntType&&(ht="i")),ut.compareFunction?at=`sampler2DShadow ${ot.name};`:ut.isDataArrayTexture===!0||ut.isCompressedArrayTexture===!0?at=`${ht}sampler2DArray ${ot.name};`:at=`${ht}sampler2D ${ot.name};`}else if(ot.type==="cubeTexture")at=`samplerCube ${ot.name};`;else if(ot.type==="texture3D")at=`sampler3D ${ot.name};`;else if(ot.type==="buffer"){const ut=ot.node,ht=this.getType(ut.bufferType),dt=ut.bufferCount,ft=dt>0?dt:"";at=`${ut.name} {
	${ht} ${ot.name}[${ft}];
};
`}else at=`${this.getVectorType(ot.type)} ${this.getPropertyName(ot,_e)};`,lt=!0;const ct=ot.node.precision;if(ct!==null&&(at=precisionLib[ct]+" "+at),lt){at="	"+at;const ut=ot.groupNode.name;(it[ut]||(it[ut]=[])).push(at)}else at="uniform "+at,rt.push(at)}let st="";for(const ot in it){const at=it[ot];st+=this._getGLSLUniformStruct(_e+"_"+ot,at.join(`
`))+`
`}return st+=rt.join(`
`),st}getTypeFromAttribute(_e){let et=super.getTypeFromAttribute(_e);if(/^[iu]/.test(et)&&_e.gpuType!==IntType){let rt=_e;_e.isInterleavedBufferAttribute&&(rt=_e.data);const it=rt.array;it instanceof Uint32Array||it instanceof Int32Array||(et=et.slice(1))}return et}getAttributes(_e){let et="";if(_e==="vertex"||_e==="compute"){const rt=this.getAttributesArray();let it=0;for(const st of rt)et+=`layout( location = ${it++} ) in ${st.type} ${st.name};
`}return et}getStructMembers(_e){const et=[],rt=_e.getMemberTypes();for(let it=0;it<rt.length;it++){const st=rt[it];et.push(`layout( location = ${it} ) out ${st} m${it};`)}return et.join(`
`)}getStructs(_e){const et=[],rt=this.structs[_e];if(rt.length===0)return`layout( location = 0 ) out vec4 fragColor;
`;for(let it=0,st=rt.length;it<st;it++){const ot=rt[it];let at=`
`;at+=this.getStructMembers(ot),at+=`
`,et.push(at)}return et.join(`

`)}getVaryings(_e){let et="";const rt=this.varyings;if(_e==="vertex"||_e==="compute")for(const it of rt){_e==="compute"&&(it.needsInterpolation=!0);const st=it.type,ot=st.includes("int")||st.includes("uv")||st.includes("iv")?"flat ":"";et+=`${ot}${it.needsInterpolation?"out":"/*out*/"} ${st} ${it.name};
`}else if(_e==="fragment"){for(const it of rt)if(it.needsInterpolation){const st=it.type,ot=st.includes("int")||st.includes("uv")||st.includes("iv")?"flat ":"";et+=`${ot}in ${st} ${it.name};
`}}return et}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((rt,it)=>rt*it,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(_e,et,rt=this.shaderStage){const it=this.extensions[rt]||(this.extensions[rt]=new Map);it.has(_e)===!1&&it.set(_e,{name:_e,behavior:et})}getExtensions(_e){const et=[];if(_e==="vertex"){const it=this.renderer.backend.extensions;this.object.isBatchedMesh&&it.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",_e)}const rt=this.extensions[_e];if(rt!==void 0)for(const{name:it,behavior:st}of rt.values())et.push(`#extension ${it} : ${st}`);return et.join(`
`)}isAvailable(_e){let et=supports$1[_e];if(et===void 0){if(_e==="float32Filterable"){const rt=this.renderer.backend.extensions;rt.has("OES_texture_float_linear")?(rt.get("OES_texture_float_linear"),et=!0):et=!1}supports$1[_e]=et}return et}isFlipY(){return!0}registerTransform(_e,et){this.transforms.push({varyingName:_e,attributeNode:et})}getTransforms(){const _e=this.transforms;let et="";for(let rt=0;rt<_e.length;rt++){const it=_e[rt],st=this.getPropertyName(it.attributeNode);et+=`${it.varyingName} = ${st};
	`}return et}_getGLSLUniformStruct(_e,et){return`
layout( std140 ) uniform ${_e} {
${et}
};`}_getGLSLVertexCode(_e){return`#version 300 es

${this.getSignature()}

// extensions 
${_e.extensions}

// precision
${defaultPrecisions}

// uniforms
${_e.uniforms}

// varyings
${_e.varyings}

// attributes
${_e.attributes}

// codes
${_e.codes}

void main() {

	// vars
	${_e.vars}

	// transforms
	${_e.transforms}

	// flow
	${_e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(_e){return`#version 300 es

${this.getSignature()}

// precision
${defaultPrecisions}

// uniforms
${_e.uniforms}

// varyings
${_e.varyings}

// codes
${_e.codes}

${_e.structs}

void main() {

	// vars
	${_e.vars}

	// flow
	${_e.flow}

}
`}buildCode(){const _e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const et in _e){let rt=`// code

`;rt+=this.flowCode[et];const it=this.flowNodes[et],st=it[it.length-1];for(const at of it){const lt=this.getFlowData(at),ct=at.name;ct&&(rt.length>0&&(rt+=`
`),rt+=`	// flow -> ${ct}
	`),rt+=`${lt.code}
	`,at===st&&et!=="compute"&&(rt+=`// result
	`,et==="vertex"?(rt+="gl_Position = ",rt+=`${lt.result};`):et==="fragment"&&(at.outputNode.isOutputStructNode||(rt+="fragColor = ",rt+=`${lt.result};`)))}const ot=_e[et];ot.extensions=this.getExtensions(et),ot.uniforms=this.getUniforms(et),ot.attributes=this.getAttributes(et),ot.varyings=this.getVaryings(et),ot.vars=this.getVars(et),ot.structs=this.getStructs(et),ot.codes=this.getCodes(et),ot.transforms=this.getTransforms(et),ot.flow=rt}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(_e.vertex),this.fragmentShader=this._getGLSLFragmentCode(_e.fragment)):this.computeShader=this._getGLSLVertexCode(_e.compute)}getUniformFromNode(_e,et,rt,it=null){const st=super.getUniformFromNode(_e,et,rt,it),ot=this.getDataFromNode(_e,rt,this.globalCache);let at=ot.uniformGPU;if(at===void 0){const lt=_e.groupNode,ct=lt.name,ut=this.getBindGroupArray(ct,rt);if(et==="texture")at=new NodeSampledTexture(st.name,st.node,lt),ut.push(at);else if(et==="cubeTexture")at=new NodeSampledCubeTexture(st.name,st.node,lt),ut.push(at);else if(et==="texture3D")at=new NodeSampledTexture3D(st.name,st.node,lt),ut.push(at);else if(et==="buffer"){_e.name=`NodeBuffer_${_e.id}`,st.name=`buffer${_e.id}`;const ht=new NodeUniformBuffer(_e,lt);ht.name=_e.name,ut.push(ht),at=ht}else{const ht=this.uniformGroups[rt]||(this.uniformGroups[rt]={});let dt=ht[ct];dt===void 0&&(dt=new NodeUniformsGroup(rt+"_"+ct,lt),ht[ct]=dt,ut.push(dt)),at=this.getNodeUniform(st,et),dt.addUniform(at)}ot.uniformGPU=at}return st}}let vector2=null,vector4=null,color4=null;class Backend{constructor(_e={}){this.parameters=Object.assign({},_e),this.data=new WeakMap,this.renderer=null,this.domElement=null}async init(_e){this.renderer=_e}begin(){}finish(){}draw(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}createRenderPipeline(){}createComputePipeline(){}destroyPipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}createDefaultTexture(){}createTexture(){}copyTextureToBuffer(){}createAttribute(){}createIndexAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}resolveTimestampAsync(){}hasFeatureAsync(){}hasFeature(){}getInstanceCount(_e){const{object:et,geometry:rt}=_e;return rt.isInstancedBufferGeometry?rt.instanceCount:et.count>1?et.count:1}getDrawingBufferSize(){return vector2=vector2||new Vector2,this.renderer.getDrawingBufferSize(vector2)}getScissor(){return vector4=vector4||new Vector4,this.renderer.getScissor(vector4)}setScissorTest(){}getClearColor(){const _e=this.renderer;return color4=color4||new Color4,_e.getClearColor(color4),color4.getRGB(color4,this.renderer.currentColorSpace),color4}getDomElement(){let _e=this.domElement;return _e===null&&(_e=this.parameters.canvas!==void 0?this.parameters.canvas:createCanvasElement(),"setAttribute"in _e&&_e.setAttribute("data-engine",`three.js r${REVISION} webgpu`),this.domElement=_e),_e}set(_e,et){this.data.set(_e,et)}get(_e){let et=this.data.get(_e);return et===void 0&&(et={},this.data.set(_e,et)),et}has(_e){return this.data.has(_e)}delete(_e){this.data.delete(_e)}}let _id$1=0;class DualAttributeData{constructor(_e,et){this.buffers=[_e.bufferGPU,et],this.type=_e.type,this.bufferType=_e.bufferType,this.pbo=_e.pbo,this.byteLength=_e.byteLength,this.bytesPerElement=_e.BYTES_PER_ELEMENT,this.version=_e.version,this.isInteger=_e.isInteger,this.activeBufferIndex=0,this.baseId=_e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class WebGLAttributeUtils{constructor(_e){this.backend=_e}createAttribute(_e,et){const rt=this.backend,{gl:it}=rt,st=_e.array,ot=_e.usage||it.STATIC_DRAW,at=_e.isInterleavedBufferAttribute?_e.data:_e,lt=rt.get(at);let ct=lt.bufferGPU;ct===void 0&&(ct=this._createBuffer(it,et,st,ot),lt.bufferGPU=ct,lt.bufferType=et,lt.version=at.version);let ut;if(st instanceof Float32Array)ut=it.FLOAT;else if(st instanceof Uint16Array)_e.isFloat16BufferAttribute?ut=it.HALF_FLOAT:ut=it.UNSIGNED_SHORT;else if(st instanceof Int16Array)ut=it.SHORT;else if(st instanceof Uint32Array)ut=it.UNSIGNED_INT;else if(st instanceof Int32Array)ut=it.INT;else if(st instanceof Int8Array)ut=it.BYTE;else if(st instanceof Uint8Array)ut=it.UNSIGNED_BYTE;else if(st instanceof Uint8ClampedArray)ut=it.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+st);let ht={bufferGPU:ct,bufferType:et,type:ut,byteLength:st.byteLength,bytesPerElement:st.BYTES_PER_ELEMENT,version:_e.version,pbo:_e.pbo,isInteger:ut===it.INT||ut===it.UNSIGNED_INT||_e.gpuType===IntType,id:_id$1++};if(_e.isStorageBufferAttribute||_e.isStorageInstancedBufferAttribute){const dt=this._createBuffer(it,et,st,ot);ht=new DualAttributeData(ht,dt)}rt.set(_e,ht)}updateAttribute(_e){const et=this.backend,{gl:rt}=et,it=_e.array,st=_e.isInterleavedBufferAttribute?_e.data:_e,ot=et.get(st),at=ot.bufferType,lt=_e.isInterleavedBufferAttribute?_e.data.updateRanges:_e.updateRanges;if(rt.bindBuffer(at,ot.bufferGPU),lt.length===0)rt.bufferSubData(at,0,it);else{for(let ct=0,ut=lt.length;ct<ut;ct++){const ht=lt[ct];rt.bufferSubData(at,ht.start*it.BYTES_PER_ELEMENT,it,ht.start,ht.count)}st.clearUpdateRanges()}rt.bindBuffer(at,null),ot.version=st.version}destroyAttribute(_e){const et=this.backend,{gl:rt}=et;_e.isInterleavedBufferAttribute&&et.delete(_e.data);const it=et.get(_e);rt.deleteBuffer(it.bufferGPU),et.delete(_e)}async getArrayBufferAsync(_e){const et=this.backend,{gl:rt}=et,it=_e.isInterleavedBufferAttribute?_e.data:_e,{bufferGPU:st}=et.get(it),ot=_e.array,at=ot.byteLength;rt.bindBuffer(rt.COPY_READ_BUFFER,st);const lt=rt.createBuffer();rt.bindBuffer(rt.COPY_WRITE_BUFFER,lt),rt.bufferData(rt.COPY_WRITE_BUFFER,at,rt.STREAM_READ),rt.copyBufferSubData(rt.COPY_READ_BUFFER,rt.COPY_WRITE_BUFFER,0,0,at),await et.utils._clientWaitAsync();const ct=new _e.array.constructor(ot.length);return rt.bindBuffer(rt.COPY_WRITE_BUFFER,lt),rt.getBufferSubData(rt.COPY_WRITE_BUFFER,0,ct),rt.deleteBuffer(lt),rt.bindBuffer(rt.COPY_READ_BUFFER,null),rt.bindBuffer(rt.COPY_WRITE_BUFFER,null),ct.buffer}_createBuffer(_e,et,rt,it){const st=_e.createBuffer();return _e.bindBuffer(et,st),_e.bufferData(et,rt,it),_e.bindBuffer(et,null),st}}let initialized$1=!1,equationToGL,factorToGL;class WebGLState{constructor(_e){this.backend=_e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},initialized$1===!1&&(this._init(this.gl),initialized$1=!0)}_init(_e){equationToGL={[AddEquation]:_e.FUNC_ADD,[SubtractEquation]:_e.FUNC_SUBTRACT,[ReverseSubtractEquation]:_e.FUNC_REVERSE_SUBTRACT},factorToGL={[ZeroFactor]:_e.ZERO,[OneFactor]:_e.ONE,[SrcColorFactor]:_e.SRC_COLOR,[SrcAlphaFactor]:_e.SRC_ALPHA,[SrcAlphaSaturateFactor]:_e.SRC_ALPHA_SATURATE,[DstColorFactor]:_e.DST_COLOR,[DstAlphaFactor]:_e.DST_ALPHA,[OneMinusSrcColorFactor]:_e.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:_e.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:_e.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:_e.ONE_MINUS_DST_ALPHA}}enable(_e){const{enabled:et}=this;et[_e]!==!0&&(this.gl.enable(_e),et[_e]=!0)}disable(_e){const{enabled:et}=this;et[_e]!==!1&&(this.gl.disable(_e),et[_e]=!1)}setFlipSided(_e){if(this.currentFlipSided!==_e){const{gl:et}=this;_e?et.frontFace(et.CW):et.frontFace(et.CCW),this.currentFlipSided=_e}}setCullFace(_e){const{gl:et}=this;_e!==CullFaceNone?(this.enable(et.CULL_FACE),_e!==this.currentCullFace&&(_e===CullFaceBack?et.cullFace(et.BACK):_e===CullFaceFront?et.cullFace(et.FRONT):et.cullFace(et.FRONT_AND_BACK))):this.disable(et.CULL_FACE),this.currentCullFace=_e}setLineWidth(_e){const{currentLineWidth:et,gl:rt}=this;_e!==et&&(rt.lineWidth(_e),this.currentLineWidth=_e)}setBlending(_e,et,rt,it,st,ot,at,lt){const{gl:ct}=this;if(_e===NoBlending){this.currentBlendingEnabled===!0&&(this.disable(ct.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(ct.BLEND),this.currentBlendingEnabled=!0),_e!==CustomBlending){if(_e!==this.currentBlending||lt!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==AddEquation||this.currentBlendEquationAlpha!==AddEquation)&&(ct.blendEquation(ct.FUNC_ADD),this.currentBlendEquation=AddEquation,this.currentBlendEquationAlpha=AddEquation),lt)switch(_e){case NormalBlending:ct.blendFuncSeparate(ct.ONE,ct.ONE_MINUS_SRC_ALPHA,ct.ONE,ct.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:ct.blendFunc(ct.ONE,ct.ONE);break;case SubtractiveBlending:ct.blendFuncSeparate(ct.ZERO,ct.ONE_MINUS_SRC_COLOR,ct.ZERO,ct.ONE);break;case MultiplyBlending:ct.blendFuncSeparate(ct.ZERO,ct.SRC_COLOR,ct.ZERO,ct.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}else switch(_e){case NormalBlending:ct.blendFuncSeparate(ct.SRC_ALPHA,ct.ONE_MINUS_SRC_ALPHA,ct.ONE,ct.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:ct.blendFunc(ct.SRC_ALPHA,ct.ONE);break;case SubtractiveBlending:ct.blendFuncSeparate(ct.ZERO,ct.ONE_MINUS_SRC_COLOR,ct.ZERO,ct.ONE);break;case MultiplyBlending:ct.blendFunc(ct.ZERO,ct.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=_e,this.currentPremultipledAlpha=lt}return}st=st||et,ot=ot||rt,at=at||it,(et!==this.currentBlendEquation||st!==this.currentBlendEquationAlpha)&&(ct.blendEquationSeparate(equationToGL[et],equationToGL[st]),this.currentBlendEquation=et,this.currentBlendEquationAlpha=st),(rt!==this.currentBlendSrc||it!==this.currentBlendDst||ot!==this.currentBlendSrcAlpha||at!==this.currentBlendDstAlpha)&&(ct.blendFuncSeparate(factorToGL[rt],factorToGL[it],factorToGL[ot],factorToGL[at]),this.currentBlendSrc=rt,this.currentBlendDst=it,this.currentBlendSrcAlpha=ot,this.currentBlendDstAlpha=at),this.currentBlending=_e,this.currentPremultipledAlpha=!1}setColorMask(_e){this.currentColorMask!==_e&&(this.gl.colorMask(_e,_e,_e,_e),this.currentColorMask=_e)}setDepthTest(_e){const{gl:et}=this;_e?this.enable(et.DEPTH_TEST):this.disable(et.DEPTH_TEST)}setDepthMask(_e){this.currentDepthMask!==_e&&(this.gl.depthMask(_e),this.currentDepthMask=_e)}setDepthFunc(_e){if(this.currentDepthFunc!==_e){const{gl:et}=this;switch(_e){case NeverDepth:et.depthFunc(et.NEVER);break;case AlwaysDepth:et.depthFunc(et.ALWAYS);break;case LessDepth:et.depthFunc(et.LESS);break;case LessEqualDepth:et.depthFunc(et.LEQUAL);break;case EqualDepth:et.depthFunc(et.EQUAL);break;case GreaterEqualDepth:et.depthFunc(et.GEQUAL);break;case GreaterDepth:et.depthFunc(et.GREATER);break;case NotEqualDepth:et.depthFunc(et.NOTEQUAL);break;default:et.depthFunc(et.LEQUAL)}this.currentDepthFunc=_e}}setStencilTest(_e){const{gl:et}=this;_e?this.enable(et.STENCIL_TEST):this.disable(et.STENCIL_TEST)}setStencilMask(_e){this.currentStencilMask!==_e&&(this.gl.stencilMask(_e),this.currentStencilMask=_e)}setStencilFunc(_e,et,rt){(this.currentStencilFunc!==_e||this.currentStencilRef!==et||this.currentStencilFuncMask!==rt)&&(this.gl.stencilFunc(_e,et,rt),this.currentStencilFunc=_e,this.currentStencilRef=et,this.currentStencilFuncMask=rt)}setStencilOp(_e,et,rt){(this.currentStencilFail!==_e||this.currentStencilZFail!==et||this.currentStencilZPass!==rt)&&(this.gl.stencilOp(_e,et,rt),this.currentStencilFail=_e,this.currentStencilZFail=et,this.currentStencilZPass=rt)}setMaterial(_e,et){const{gl:rt}=this;_e.side===DoubleSide?this.disable(rt.CULL_FACE):this.enable(rt.CULL_FACE);let it=_e.side===BackSide;et&&(it=!it),this.setFlipSided(it),_e.blending===NormalBlending&&_e.transparent===!1?this.setBlending(NoBlending):this.setBlending(_e.blending,_e.blendEquation,_e.blendSrc,_e.blendDst,_e.blendEquationAlpha,_e.blendSrcAlpha,_e.blendDstAlpha,_e.premultipliedAlpha),this.setDepthFunc(_e.depthFunc),this.setDepthTest(_e.depthTest),this.setDepthMask(_e.depthWrite),this.setColorMask(_e.colorWrite);const st=_e.stencilWrite;this.setStencilTest(st),st&&(this.setStencilMask(_e.stencilWriteMask),this.setStencilFunc(_e.stencilFunc,_e.stencilRef,_e.stencilFuncMask),this.setStencilOp(_e.stencilFail,_e.stencilZFail,_e.stencilZPass)),this.setPolygonOffset(_e.polygonOffset,_e.polygonOffsetFactor,_e.polygonOffsetUnits),_e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(rt.SAMPLE_ALPHA_TO_COVERAGE):this.disable(rt.SAMPLE_ALPHA_TO_COVERAGE)}setPolygonOffset(_e,et,rt){const{gl:it}=this;_e?(this.enable(it.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==et||this.currentPolygonOffsetUnits!==rt)&&(it.polygonOffset(et,rt),this.currentPolygonOffsetFactor=et,this.currentPolygonOffsetUnits=rt)):this.disable(it.POLYGON_OFFSET_FILL)}useProgram(_e){return this.currentProgram!==_e?(this.gl.useProgram(_e),this.currentProgram=_e,!0):!1}bindFramebuffer(_e,et){const{gl:rt,currentBoundFramebuffers:it}=this;return it[_e]!==et?(rt.bindFramebuffer(_e,et),it[_e]=et,_e===rt.DRAW_FRAMEBUFFER&&(it[rt.FRAMEBUFFER]=et),_e===rt.FRAMEBUFFER&&(it[rt.DRAW_FRAMEBUFFER]=et),!0):!1}drawBuffers(_e,et){const{gl:rt}=this;let it=[],st=!1;if(_e.textures!==null){it=this.currentDrawbuffers.get(et),it===void 0&&(it=[],this.currentDrawbuffers.set(et,it));const ot=_e.textures;if(it.length!==ot.length||it[0]!==rt.COLOR_ATTACHMENT0){for(let at=0,lt=ot.length;at<lt;at++)it[at]=rt.COLOR_ATTACHMENT0+at;it.length=ot.length,st=!0}}else it[0]!==rt.BACK&&(it[0]=rt.BACK,st=!0);st&&rt.drawBuffers(it)}activeTexture(_e){const{gl:et,currentTextureSlot:rt,maxTextures:it}=this;_e===void 0&&(_e=et.TEXTURE0+it-1),rt!==_e&&(et.activeTexture(_e),this.currentTextureSlot=_e)}bindTexture(_e,et,rt){const{gl:it,currentTextureSlot:st,currentBoundTextures:ot,maxTextures:at}=this;rt===void 0&&(st===null?rt=it.TEXTURE0+at-1:rt=st);let lt=ot[rt];lt===void 0&&(lt={type:void 0,texture:void 0},ot[rt]=lt),(lt.type!==_e||lt.texture!==et)&&(st!==rt&&(it.activeTexture(rt),this.currentTextureSlot=rt),it.bindTexture(_e,et),lt.type=_e,lt.texture=et)}bindBufferBase(_e,et,rt){const{gl:it}=this,st=`${_e}-${et}`;return this.currentBoundBufferBases[st]!==rt?(it.bindBufferBase(_e,et,rt),this.currentBoundBufferBases[st]=rt,!0):!1}unbindTexture(){const{gl:_e,currentTextureSlot:et,currentBoundTextures:rt}=this,it=rt[et];it!==void 0&&it.type!==void 0&&(_e.bindTexture(it.type,null),it.type=void 0,it.texture=void 0)}}class WebGLUtils{constructor(_e){this.backend=_e,this.gl=this.backend.gl,this.extensions=_e.extensions}convert(_e,et=NoColorSpace){const{gl:rt,extensions:it}=this;let st;if(_e===UnsignedByteType)return rt.UNSIGNED_BYTE;if(_e===UnsignedShort4444Type)return rt.UNSIGNED_SHORT_4_4_4_4;if(_e===UnsignedShort5551Type)return rt.UNSIGNED_SHORT_5_5_5_1;if(_e===UnsignedInt5999Type)return rt.UNSIGNED_INT_5_9_9_9_REV;if(_e===ByteType)return rt.BYTE;if(_e===ShortType)return rt.SHORT;if(_e===UnsignedShortType)return rt.UNSIGNED_SHORT;if(_e===IntType)return rt.INT;if(_e===UnsignedIntType)return rt.UNSIGNED_INT;if(_e===FloatType)return rt.FLOAT;if(_e===HalfFloatType)return rt.HALF_FLOAT;if(_e===AlphaFormat)return rt.ALPHA;if(_e===RGBFormat)return rt.RGB;if(_e===RGBAFormat)return rt.RGBA;if(_e===LuminanceFormat)return rt.LUMINANCE;if(_e===LuminanceAlphaFormat)return rt.LUMINANCE_ALPHA;if(_e===DepthFormat)return rt.DEPTH_COMPONENT;if(_e===DepthStencilFormat)return rt.DEPTH_STENCIL;if(_e===RedFormat)return rt.RED;if(_e===RedIntegerFormat)return rt.RED_INTEGER;if(_e===RGFormat)return rt.RG;if(_e===RGIntegerFormat)return rt.RG_INTEGER;if(_e===RGBAIntegerFormat)return rt.RGBA_INTEGER;if(_e===RGB_S3TC_DXT1_Format||_e===RGBA_S3TC_DXT1_Format||_e===RGBA_S3TC_DXT3_Format||_e===RGBA_S3TC_DXT5_Format)if(et===SRGBColorSpace)if(st=it.get("WEBGL_compressed_texture_s3tc_srgb"),st!==null){if(_e===RGB_S3TC_DXT1_Format)return st.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT1_Format)return st.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT3_Format)return st.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(_e===RGBA_S3TC_DXT5_Format)return st.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(st=it.get("WEBGL_compressed_texture_s3tc"),st!==null){if(_e===RGB_S3TC_DXT1_Format)return st.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT1_Format)return st.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT3_Format)return st.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_e===RGBA_S3TC_DXT5_Format)return st.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(_e===RGB_PVRTC_4BPPV1_Format||_e===RGB_PVRTC_2BPPV1_Format||_e===RGBA_PVRTC_4BPPV1_Format||_e===RGBA_PVRTC_2BPPV1_Format)if(st=it.get("WEBGL_compressed_texture_pvrtc"),st!==null){if(_e===RGB_PVRTC_4BPPV1_Format)return st.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_e===RGB_PVRTC_2BPPV1_Format)return st.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_e===RGBA_PVRTC_4BPPV1_Format)return st.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_e===RGBA_PVRTC_2BPPV1_Format)return st.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(_e===RGB_ETC1_Format||_e===RGB_ETC2_Format||_e===RGBA_ETC2_EAC_Format)if(st=it.get("WEBGL_compressed_texture_etc"),st!==null){if(_e===RGB_ETC1_Format||_e===RGB_ETC2_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ETC2:st.COMPRESSED_RGB8_ETC2;if(_e===RGBA_ETC2_EAC_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:st.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(_e===RGBA_ASTC_4x4_Format||_e===RGBA_ASTC_5x4_Format||_e===RGBA_ASTC_5x5_Format||_e===RGBA_ASTC_6x5_Format||_e===RGBA_ASTC_6x6_Format||_e===RGBA_ASTC_8x5_Format||_e===RGBA_ASTC_8x6_Format||_e===RGBA_ASTC_8x8_Format||_e===RGBA_ASTC_10x5_Format||_e===RGBA_ASTC_10x6_Format||_e===RGBA_ASTC_10x8_Format||_e===RGBA_ASTC_10x10_Format||_e===RGBA_ASTC_12x10_Format||_e===RGBA_ASTC_12x12_Format)if(st=it.get("WEBGL_compressed_texture_astc"),st!==null){if(_e===RGBA_ASTC_4x4_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:st.COMPRESSED_RGBA_ASTC_4x4_KHR;if(_e===RGBA_ASTC_5x4_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:st.COMPRESSED_RGBA_ASTC_5x4_KHR;if(_e===RGBA_ASTC_5x5_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:st.COMPRESSED_RGBA_ASTC_5x5_KHR;if(_e===RGBA_ASTC_6x5_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:st.COMPRESSED_RGBA_ASTC_6x5_KHR;if(_e===RGBA_ASTC_6x6_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:st.COMPRESSED_RGBA_ASTC_6x6_KHR;if(_e===RGBA_ASTC_8x5_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:st.COMPRESSED_RGBA_ASTC_8x5_KHR;if(_e===RGBA_ASTC_8x6_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:st.COMPRESSED_RGBA_ASTC_8x6_KHR;if(_e===RGBA_ASTC_8x8_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:st.COMPRESSED_RGBA_ASTC_8x8_KHR;if(_e===RGBA_ASTC_10x5_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:st.COMPRESSED_RGBA_ASTC_10x5_KHR;if(_e===RGBA_ASTC_10x6_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:st.COMPRESSED_RGBA_ASTC_10x6_KHR;if(_e===RGBA_ASTC_10x8_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:st.COMPRESSED_RGBA_ASTC_10x8_KHR;if(_e===RGBA_ASTC_10x10_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:st.COMPRESSED_RGBA_ASTC_10x10_KHR;if(_e===RGBA_ASTC_12x10_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:st.COMPRESSED_RGBA_ASTC_12x10_KHR;if(_e===RGBA_ASTC_12x12_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:st.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(_e===RGBA_BPTC_Format)if(st=it.get("EXT_texture_compression_bptc"),st!==null){if(_e===RGBA_BPTC_Format)return et===SRGBColorSpace?st.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:st.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(_e===RED_RGTC1_Format||_e===SIGNED_RED_RGTC1_Format||_e===RED_GREEN_RGTC2_Format||_e===SIGNED_RED_GREEN_RGTC2_Format)if(st=it.get("EXT_texture_compression_rgtc"),st!==null){if(_e===RGBA_BPTC_Format)return st.COMPRESSED_RED_RGTC1_EXT;if(_e===SIGNED_RED_RGTC1_Format)return st.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(_e===RED_GREEN_RGTC2_Format)return st.COMPRESSED_RED_GREEN_RGTC2_EXT;if(_e===SIGNED_RED_GREEN_RGTC2_Format)return st.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return _e===UnsignedInt248Type?rt.UNSIGNED_INT_24_8:rt[_e]!==void 0?rt[_e]:null}_clientWaitAsync(){const{gl:_e}=this,et=_e.fenceSync(_e.SYNC_GPU_COMMANDS_COMPLETE,0);return _e.flush(),new Promise((rt,it)=>{function st(){const ot=_e.clientWaitSync(et,_e.SYNC_FLUSH_COMMANDS_BIT,0);if(ot===_e.WAIT_FAILED){_e.deleteSync(et),it();return}if(ot===_e.TIMEOUT_EXPIRED){requestAnimationFrame(st);return}_e.deleteSync(et),rt()}st()})}}let initialized=!1,wrappingToGL,filterToGL,compareToGL;class WebGLTextureUtils{constructor(_e){this.backend=_e,this.gl=_e.gl,this.extensions=_e.extensions,this.defaultTextures={},initialized===!1&&(this._init(this.gl),initialized=!0)}_init(_e){wrappingToGL={[RepeatWrapping]:_e.REPEAT,[ClampToEdgeWrapping]:_e.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:_e.MIRRORED_REPEAT},filterToGL={[NearestFilter]:_e.NEAREST,[NearestMipmapNearestFilter]:_e.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:_e.NEAREST_MIPMAP_LINEAR,[LinearFilter]:_e.LINEAR,[LinearMipmapNearestFilter]:_e.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:_e.LINEAR_MIPMAP_LINEAR},compareToGL={[NeverCompare]:_e.NEVER,[AlwaysCompare]:_e.ALWAYS,[LessCompare]:_e.LESS,[LessEqualCompare]:_e.LEQUAL,[EqualCompare]:_e.EQUAL,[GreaterEqualCompare]:_e.GEQUAL,[GreaterCompare]:_e.GREATER,[NotEqualCompare]:_e.NOTEQUAL}}filterFallback(_e){const{gl:et}=this;return _e===NearestFilter||_e===NearestMipmapNearestFilter||_e===NearestMipmapLinearFilter?et.NEAREST:et.LINEAR}getGLTextureType(_e){const{gl:et}=this;let rt;return _e.isCubeTexture===!0?rt=et.TEXTURE_CUBE_MAP:_e.isDataArrayTexture===!0||_e.isCompressedArrayTexture===!0?rt=et.TEXTURE_2D_ARRAY:_e.isData3DTexture===!0?rt=et.TEXTURE_3D:rt=et.TEXTURE_2D,rt}getInternalFormat(_e,et,rt,it,st=!1){const{gl:ot,extensions:at}=this;if(_e!==null){if(ot[_e]!==void 0)return ot[_e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+_e+"'")}let lt=et;return et===ot.RED&&(rt===ot.FLOAT&&(lt=ot.R32F),rt===ot.HALF_FLOAT&&(lt=ot.R16F),rt===ot.UNSIGNED_BYTE&&(lt=ot.R8),rt===ot.UNSIGNED_SHORT&&(lt=ot.R16),rt===ot.UNSIGNED_INT&&(lt=ot.R32UI),rt===ot.BYTE&&(lt=ot.R8I),rt===ot.SHORT&&(lt=ot.R16I),rt===ot.INT&&(lt=ot.R32I)),et===ot.RED_INTEGER&&(rt===ot.UNSIGNED_BYTE&&(lt=ot.R8UI),rt===ot.UNSIGNED_SHORT&&(lt=ot.R16UI),rt===ot.UNSIGNED_INT&&(lt=ot.R32UI),rt===ot.BYTE&&(lt=ot.R8I),rt===ot.SHORT&&(lt=ot.R16I),rt===ot.INT&&(lt=ot.R32I)),et===ot.RG&&(rt===ot.FLOAT&&(lt=ot.RG32F),rt===ot.HALF_FLOAT&&(lt=ot.RG16F),rt===ot.UNSIGNED_BYTE&&(lt=ot.RG8),rt===ot.UNSIGNED_SHORT&&(lt=ot.RG16),rt===ot.UNSIGNED_INT&&(lt=ot.RG32UI),rt===ot.BYTE&&(lt=ot.RG8I),rt===ot.SHORT&&(lt=ot.RG16I),rt===ot.INT&&(lt=ot.RG32I)),et===ot.RG_INTEGER&&(rt===ot.UNSIGNED_BYTE&&(lt=ot.RG8UI),rt===ot.UNSIGNED_SHORT&&(lt=ot.RG16UI),rt===ot.UNSIGNED_INT&&(lt=ot.RG32UI),rt===ot.BYTE&&(lt=ot.RG8I),rt===ot.SHORT&&(lt=ot.RG16I),rt===ot.INT&&(lt=ot.RG32I)),et===ot.RGB&&(rt===ot.FLOAT&&(lt=ot.RGB32F),rt===ot.HALF_FLOAT&&(lt=ot.RGB16F),rt===ot.UNSIGNED_BYTE&&(lt=ot.RGB8),rt===ot.UNSIGNED_SHORT&&(lt=ot.RGB16),rt===ot.UNSIGNED_INT&&(lt=ot.RGB32UI),rt===ot.BYTE&&(lt=ot.RGB8I),rt===ot.SHORT&&(lt=ot.RGB16I),rt===ot.INT&&(lt=ot.RGB32I),rt===ot.UNSIGNED_BYTE&&(lt=it===SRGBColorSpace&&st===!1?ot.SRGB8:ot.RGB8),rt===ot.UNSIGNED_SHORT_5_6_5&&(lt=ot.RGB565),rt===ot.UNSIGNED_SHORT_5_5_5_1&&(lt=ot.RGB5_A1),rt===ot.UNSIGNED_SHORT_4_4_4_4&&(lt=ot.RGB4),rt===ot.UNSIGNED_INT_5_9_9_9_REV&&(lt=ot.RGB9_E5)),et===ot.RGB_INTEGER&&(rt===ot.UNSIGNED_BYTE&&(lt=ot.RGB8UI),rt===ot.UNSIGNED_SHORT&&(lt=ot.RGB16UI),rt===ot.UNSIGNED_INT&&(lt=ot.RGB32UI),rt===ot.BYTE&&(lt=ot.RGB8I),rt===ot.SHORT&&(lt=ot.RGB16I),rt===ot.INT&&(lt=ot.RGB32I)),et===ot.RGBA&&(rt===ot.FLOAT&&(lt=ot.RGBA32F),rt===ot.HALF_FLOAT&&(lt=ot.RGBA16F),rt===ot.UNSIGNED_BYTE&&(lt=ot.RGBA8),rt===ot.UNSIGNED_SHORT&&(lt=ot.RGBA16),rt===ot.UNSIGNED_INT&&(lt=ot.RGBA32UI),rt===ot.BYTE&&(lt=ot.RGBA8I),rt===ot.SHORT&&(lt=ot.RGBA16I),rt===ot.INT&&(lt=ot.RGBA32I),rt===ot.UNSIGNED_BYTE&&(lt=it===SRGBColorSpace&&st===!1?ot.SRGB8_ALPHA8:ot.RGBA8),rt===ot.UNSIGNED_SHORT_4_4_4_4&&(lt=ot.RGBA4),rt===ot.UNSIGNED_SHORT_5_5_5_1&&(lt=ot.RGB5_A1)),et===ot.RGBA_INTEGER&&(rt===ot.UNSIGNED_BYTE&&(lt=ot.RGBA8UI),rt===ot.UNSIGNED_SHORT&&(lt=ot.RGBA16UI),rt===ot.UNSIGNED_INT&&(lt=ot.RGBA32UI),rt===ot.BYTE&&(lt=ot.RGBA8I),rt===ot.SHORT&&(lt=ot.RGBA16I),rt===ot.INT&&(lt=ot.RGBA32I)),et===ot.DEPTH_COMPONENT&&(rt===ot.UNSIGNED_INT&&(lt=ot.DEPTH24_STENCIL8),rt===ot.FLOAT&&(lt=ot.DEPTH_COMPONENT32F)),et===ot.DEPTH_STENCIL&&rt===ot.UNSIGNED_INT_24_8&&(lt=ot.DEPTH24_STENCIL8),(lt===ot.R16F||lt===ot.R32F||lt===ot.RG16F||lt===ot.RG32F||lt===ot.RGBA16F||lt===ot.RGBA32F)&&at.get("EXT_color_buffer_float"),lt}setTextureParameters(_e,et){const{gl:rt,extensions:it,backend:st}=this;rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,et.flipY),rt.pixelStorei(rt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,et.premultiplyAlpha),rt.pixelStorei(rt.UNPACK_ALIGNMENT,et.unpackAlignment),rt.pixelStorei(rt.UNPACK_COLORSPACE_CONVERSION_WEBGL,rt.NONE),rt.texParameteri(_e,rt.TEXTURE_WRAP_S,wrappingToGL[et.wrapS]),rt.texParameteri(_e,rt.TEXTURE_WRAP_T,wrappingToGL[et.wrapT]),(_e===rt.TEXTURE_3D||_e===rt.TEXTURE_2D_ARRAY)&&rt.texParameteri(_e,rt.TEXTURE_WRAP_R,wrappingToGL[et.wrapR]),rt.texParameteri(_e,rt.TEXTURE_MAG_FILTER,filterToGL[et.magFilter]);const ot=et.mipmaps!==void 0&&et.mipmaps.length>0,at=et.minFilter===LinearFilter&&ot?LinearMipmapLinearFilter:et.minFilter;if(rt.texParameteri(_e,rt.TEXTURE_MIN_FILTER,filterToGL[at]),et.compareFunction&&(rt.texParameteri(_e,rt.TEXTURE_COMPARE_MODE,rt.COMPARE_REF_TO_TEXTURE),rt.texParameteri(_e,rt.TEXTURE_COMPARE_FUNC,compareToGL[et.compareFunction])),it.has("EXT_texture_filter_anisotropic")===!0){if(et.magFilter===NearestFilter||et.minFilter!==NearestMipmapLinearFilter&&et.minFilter!==LinearMipmapLinearFilter||et.type===FloatType&&it.has("OES_texture_float_linear")===!1)return;if(et.anisotropy>1){const lt=it.get("EXT_texture_filter_anisotropic");rt.texParameterf(_e,lt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(et.anisotropy,st.getMaxAnisotropy()))}}}createDefaultTexture(_e){const{gl:et,backend:rt,defaultTextures:it}=this,st=this.getGLTextureType(_e);let ot=it[st];ot===void 0&&(ot=et.createTexture(),rt.state.bindTexture(st,ot),et.texParameteri(st,et.TEXTURE_MIN_FILTER,et.NEAREST),et.texParameteri(st,et.TEXTURE_MAG_FILTER,et.NEAREST),it[st]=ot),rt.set(_e,{textureGPU:ot,glTextureType:st,isDefault:!0})}createTexture(_e,et){const{gl:rt,backend:it}=this,{levels:st,width:ot,height:at,depth:lt}=et,ct=it.utils.convert(_e.format,_e.colorSpace),ut=it.utils.convert(_e.type),ht=this.getInternalFormat(_e.internalFormat,ct,ut,_e.colorSpace,_e.isVideoTexture),dt=rt.createTexture(),ft=this.getGLTextureType(_e);it.state.bindTexture(ft,dt),this.setTextureParameters(ft,_e),_e.isDataArrayTexture||_e.isCompressedArrayTexture?rt.texStorage3D(rt.TEXTURE_2D_ARRAY,st,ht,ot,at,lt):_e.isData3DTexture?rt.texStorage3D(rt.TEXTURE_3D,st,ht,ot,at,lt):_e.isVideoTexture||rt.texStorage2D(ft,st,ht,ot,at),it.set(_e,{textureGPU:dt,glTextureType:ft,glFormat:ct,glType:ut,glInternalFormat:ht})}copyBufferToTexture(_e,et){const{gl:rt,backend:it}=this,{textureGPU:st,glTextureType:ot,glFormat:at,glType:lt}=it.get(et),{width:ct,height:ut}=et.source.data;rt.bindBuffer(rt.PIXEL_UNPACK_BUFFER,_e),it.state.bindTexture(ot,st),rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,!1),rt.pixelStorei(rt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),rt.texSubImage2D(ot,0,0,0,ct,ut,at,lt,0),rt.bindBuffer(rt.PIXEL_UNPACK_BUFFER,null),it.state.unbindTexture()}updateTexture(_e,et){const{gl:rt}=this,{width:it,height:st}=et,{textureGPU:ot,glTextureType:at,glFormat:lt,glType:ct,glInternalFormat:ut}=this.backend.get(_e);if(_e.isRenderTargetTexture||ot===void 0)return;const ht=dt=>dt.isDataTexture?dt.image.data:dt instanceof ImageBitmap||dt instanceof OffscreenCanvas||dt instanceof HTMLImageElement||dt instanceof HTMLCanvasElement?dt:dt.data;if(this.backend.state.bindTexture(at,ot),this.setTextureParameters(at,_e),_e.isCompressedTexture){const dt=_e.mipmaps,ft=et.image;for(let pt=0;pt<dt.length;pt++){const mt=dt[pt];_e.isCompressedArrayTexture?_e.format!==rt.RGBA?lt!==null?rt.compressedTexSubImage3D(rt.TEXTURE_2D_ARRAY,pt,0,0,0,mt.width,mt.height,ft.depth,lt,mt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):rt.texSubImage3D(rt.TEXTURE_2D_ARRAY,pt,0,0,0,mt.width,mt.height,ft.depth,lt,ct,mt.data):lt!==null?rt.compressedTexSubImage2D(rt.TEXTURE_2D,pt,0,0,mt.width,mt.height,lt,mt.data):console.warn("Unsupported compressed texture format")}}else if(_e.isCubeTexture){const dt=et.images;for(let ft=0;ft<6;ft++){const pt=ht(dt[ft]);rt.texSubImage2D(rt.TEXTURE_CUBE_MAP_POSITIVE_X+ft,0,0,0,it,st,lt,ct,pt)}}else if(_e.isDataArrayTexture){const dt=et.image;rt.texSubImage3D(rt.TEXTURE_2D_ARRAY,0,0,0,0,dt.width,dt.height,dt.depth,lt,ct,dt.data)}else if(_e.isData3DTexture){const dt=et.image;rt.texSubImage3D(rt.TEXTURE_3D,0,0,0,0,dt.width,dt.height,dt.depth,lt,ct,dt.data)}else if(_e.isVideoTexture)_e.update(),rt.texImage2D(at,0,ut,lt,ct,et.image);else{const dt=ht(et.image);rt.texSubImage2D(at,0,0,0,it,st,lt,ct,dt)}}generateMipmaps(_e){const{gl:et,backend:rt}=this,{textureGPU:it,glTextureType:st}=rt.get(_e);rt.state.bindTexture(st,it),et.generateMipmap(st)}deallocateRenderBuffers(_e){const{gl:et,backend:rt}=this;if(_e){const it=rt.get(_e);if(it.renderBufferStorageSetup=void 0,it.framebuffers){for(const st in it.framebuffers)et.deleteFramebuffer(it.framebuffers[st]);delete it.framebuffers}if(it.depthRenderbuffer&&(et.deleteRenderbuffer(it.depthRenderbuffer),delete it.depthRenderbuffer),it.stencilRenderbuffer&&(et.deleteRenderbuffer(it.stencilRenderbuffer),delete it.stencilRenderbuffer),it.msaaFrameBuffer&&(et.deleteFramebuffer(it.msaaFrameBuffer),delete it.msaaFrameBuffer),it.msaaRenderbuffers){for(let st=0;st<it.msaaRenderbuffers.length;st++)et.deleteRenderbuffer(it.msaaRenderbuffers[st]);delete it.msaaRenderbuffers}}}destroyTexture(_e){const{gl:et,backend:rt}=this,{textureGPU:it,renderTarget:st}=rt.get(_e);this.deallocateRenderBuffers(st),et.deleteTexture(it),rt.delete(_e)}copyTextureToTexture(_e,et,rt=null,it=null,st=0){const{gl:ot,backend:at}=this,{state:lt}=this.backend,{textureGPU:ct,glTextureType:ut,glType:ht,glFormat:dt}=at.get(et);let ft,pt,mt,At,gt,bt;rt!==null?(ft=rt.max.x-rt.min.x,pt=rt.max.y-rt.min.y,mt=rt.min.x,At=rt.min.y):(ft=_e.image.width,pt=_e.image.height,mt=0,At=0),it!==null?(gt=it.x,bt=it.y):(gt=0,bt=0),lt.bindTexture(ut,ct),ot.pixelStorei(ot.UNPACK_ALIGNMENT,et.unpackAlignment),ot.pixelStorei(ot.UNPACK_FLIP_Y_WEBGL,et.flipY),ot.pixelStorei(ot.UNPACK_PREMULTIPLY_ALPHA_WEBGL,et.premultiplyAlpha),ot.pixelStorei(ot.UNPACK_ALIGNMENT,et.unpackAlignment);const Tt=ot.getParameter(ot.UNPACK_ROW_LENGTH),wt=ot.getParameter(ot.UNPACK_IMAGE_HEIGHT),Rt=ot.getParameter(ot.UNPACK_SKIP_PIXELS),It=ot.getParameter(ot.UNPACK_SKIP_ROWS),Lt=ot.getParameter(ot.UNPACK_SKIP_IMAGES),$t=_e.isCompressedTexture?_e.mipmaps[st]:_e.image;ot.pixelStorei(ot.UNPACK_ROW_LENGTH,$t.width),ot.pixelStorei(ot.UNPACK_IMAGE_HEIGHT,$t.height),ot.pixelStorei(ot.UNPACK_SKIP_PIXELS,mt),ot.pixelStorei(ot.UNPACK_SKIP_ROWS,At),_e.isDataTexture?ot.texSubImage2D(ot.TEXTURE_2D,st,gt,bt,ft,pt,dt,ht,$t.data):_e.isCompressedTexture?ot.compressedTexSubImage2D(ot.TEXTURE_2D,st,gt,bt,$t.width,$t.height,dt,$t.data):ot.texSubImage2D(ot.TEXTURE_2D,st,gt,bt,ft,pt,dt,ht,$t),ot.pixelStorei(ot.UNPACK_ROW_LENGTH,Tt),ot.pixelStorei(ot.UNPACK_IMAGE_HEIGHT,wt),ot.pixelStorei(ot.UNPACK_SKIP_PIXELS,Rt),ot.pixelStorei(ot.UNPACK_SKIP_ROWS,It),ot.pixelStorei(ot.UNPACK_SKIP_IMAGES,Lt),st===0&&et.generateMipmaps&&ot.generateMipmap(ot.TEXTURE_2D),lt.unbindTexture()}copyFramebufferToTexture(_e,et,rt){const{gl:it}=this,{state:st}=this.backend,{textureGPU:ot}=this.backend.get(_e),{x:at,y:lt,z:ct,w:ut}=rt,ht=_e.isDepthTexture===!0||et.renderTarget&&et.renderTarget.samples>0,dt=et.renderTarget?et.renderTarget.height:this.backend.gerDrawingBufferSize().y;if(ht){const ft=at!==0||lt!==0;let pt,mt;if(_e.isDepthTexture===!0?(pt=it.DEPTH_BUFFER_BIT,mt=it.DEPTH_ATTACHMENT,et.stencil&&(pt|=it.STENCIL_BUFFER_BIT)):(pt=it.COLOR_BUFFER_BIT,mt=it.COLOR_ATTACHMENT0),ft){const At=this.backend.get(et.renderTarget),gt=At.framebuffers[et.getCacheKey()],bt=At.msaaFrameBuffer;st.bindFramebuffer(it.DRAW_FRAMEBUFFER,gt),st.bindFramebuffer(it.READ_FRAMEBUFFER,bt);const Tt=dt-lt-ut;it.blitFramebuffer(at,Tt,at+ct,Tt+ut,at,Tt,at+ct,Tt+ut,pt,it.NEAREST),st.bindFramebuffer(it.READ_FRAMEBUFFER,gt),st.bindTexture(it.TEXTURE_2D,ot),it.copyTexSubImage2D(it.TEXTURE_2D,0,0,0,at,Tt,ct,ut),st.unbindTexture()}else{const At=it.createFramebuffer();st.bindFramebuffer(it.DRAW_FRAMEBUFFER,At),it.framebufferTexture2D(it.DRAW_FRAMEBUFFER,mt,it.TEXTURE_2D,ot,0),it.blitFramebuffer(0,0,ct,ut,0,0,ct,ut,pt,it.NEAREST),it.deleteFramebuffer(At)}}else st.bindTexture(it.TEXTURE_2D,ot),it.copyTexSubImage2D(it.TEXTURE_2D,0,0,0,at,dt-ut-lt,ct,ut),st.unbindTexture();_e.generateMipmaps&&this.generateMipmaps(_e),this.backend._setFramebuffer(et)}setupRenderBufferStorage(_e,et){const{gl:rt}=this,it=et.renderTarget,{samples:st,depthTexture:ot,depthBuffer:at,stencilBuffer:lt,width:ct,height:ut}=it;if(rt.bindRenderbuffer(rt.RENDERBUFFER,_e),at&&!lt){let ht=rt.DEPTH_COMPONENT24;st>0?(ot&&ot.isDepthTexture&&ot.type===rt.FLOAT&&(ht=rt.DEPTH_COMPONENT32F),rt.renderbufferStorageMultisample(rt.RENDERBUFFER,st,ht,ct,ut)):rt.renderbufferStorage(rt.RENDERBUFFER,ht,ct,ut),rt.framebufferRenderbuffer(rt.FRAMEBUFFER,rt.DEPTH_ATTACHMENT,rt.RENDERBUFFER,_e)}else at&&lt&&(st>0?rt.renderbufferStorageMultisample(rt.RENDERBUFFER,st,rt.DEPTH24_STENCIL8,ct,ut):rt.renderbufferStorage(rt.RENDERBUFFER,rt.DEPTH_STENCIL,ct,ut),rt.framebufferRenderbuffer(rt.FRAMEBUFFER,rt.DEPTH_STENCIL_ATTACHMENT,rt.RENDERBUFFER,_e))}async copyTextureToBuffer(_e,et,rt,it,st,ot){const{backend:at,gl:lt}=this,{textureGPU:ct,glFormat:ut,glType:ht}=this.backend.get(_e),dt=lt.createFramebuffer();lt.bindFramebuffer(lt.READ_FRAMEBUFFER,dt);const ft=_e.isCubeTexture?lt.TEXTURE_CUBE_MAP_POSITIVE_X+ot:lt.TEXTURE_2D;lt.framebufferTexture2D(lt.READ_FRAMEBUFFER,lt.COLOR_ATTACHMENT0,ft,ct,0);const pt=this._getTypedArrayType(ht),mt=this._getBytesPerTexel(ht,ut),gt=it*st*mt,bt=lt.createBuffer();lt.bindBuffer(lt.PIXEL_PACK_BUFFER,bt),lt.bufferData(lt.PIXEL_PACK_BUFFER,gt,lt.STREAM_READ),lt.readPixels(et,rt,it,st,ut,ht,0),lt.bindBuffer(lt.PIXEL_PACK_BUFFER,null),await at.utils._clientWaitAsync();const Tt=new pt(gt/pt.BYTES_PER_ELEMENT);return lt.bindBuffer(lt.PIXEL_PACK_BUFFER,bt),lt.getBufferSubData(lt.PIXEL_PACK_BUFFER,0,Tt),lt.bindBuffer(lt.PIXEL_PACK_BUFFER,null),lt.deleteFramebuffer(dt),Tt}_getTypedArrayType(_e){const{gl:et}=this;if(_e===et.UNSIGNED_BYTE)return Uint8Array;if(_e===et.UNSIGNED_SHORT_4_4_4_4||_e===et.UNSIGNED_SHORT_5_5_5_1||_e===et.UNSIGNED_SHORT_5_6_5||_e===et.UNSIGNED_SHORT)return Uint16Array;if(_e===et.UNSIGNED_INT)return Uint32Array;if(_e===et.HALF_FLOAT)return Uint16Array;if(_e===et.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${_e}`)}_getBytesPerTexel(_e,et){const{gl:rt}=this;let it=0;if(_e===rt.UNSIGNED_BYTE&&(it=1),(_e===rt.UNSIGNED_SHORT_4_4_4_4||_e===rt.UNSIGNED_SHORT_5_5_5_1||_e===rt.UNSIGNED_SHORT_5_6_5||_e===rt.UNSIGNED_SHORT||_e===rt.HALF_FLOAT)&&(it=2),(_e===rt.UNSIGNED_INT||_e===rt.FLOAT)&&(it=4),et===rt.RGBA)return it*4;if(et===rt.RGB)return it*3;if(et===rt.ALPHA)return it}}class WebGLExtensions{constructor(_e){this.backend=_e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(_e){let et=this.extensions[_e];return et===void 0&&(et=this.gl.getExtension(_e),this.extensions[_e]=et),et}has(_e){return this.availableExtensions.includes(_e)}}class WebGLCapabilities{constructor(_e){this.backend=_e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const _e=this.backend.gl,et=this.backend.extensions;if(et.has("EXT_texture_filter_anisotropic")===!0){const rt=et.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=_e.getParameter(rt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const GLFeatureName={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query"};class WebGLBufferRenderer{constructor(_e){this.gl=_e.gl,this.extensions=_e.extensions,this.info=_e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(_e,et){const{gl:rt,mode:it,object:st,type:ot,info:at,index:lt}=this;lt!==0?rt.drawElements(it,et,ot,_e):rt.drawArrays(it,_e,et),at.update(st,et,it,1)}renderInstances(_e,et,rt){const{gl:it,mode:st,type:ot,index:at,object:lt,info:ct}=this;rt!==0&&(at!==0?it.drawElementsInstanced(st,et,ot,_e,rt):it.drawArraysInstanced(st,_e,et,rt),ct.update(lt,et,st,rt))}renderMultiDraw(_e,et,rt){const{extensions:it,mode:st,object:ot,info:at}=this;if(rt===0)return;const lt=it.get("WEBGL_multi_draw");if(lt===null)for(let ct=0;ct<rt;ct++)this.render(_e[ct],et[ct]);else{this.index!==0?lt.multiDrawElementsWEBGL(st,et,0,this.type,_e,0,rt):lt.multiDrawArraysWEBGL(st,_e,0,et,0,rt);let ct=0;for(let ut=0;ut<rt;ut++)ct+=et[ut];at.update(ot,ct,st,1)}}renderMultiDrawInstances(_e,et,rt,it){const{extensions:st,mode:ot,object:at,info:lt}=this;if(rt===0)return;const ct=st.get("WEBGL_multi_draw");if(ct===null)for(let ut=0;ut<rt;ut++)this.renderInstances(_e[ut],et[ut],it[ut]);else{this.index!==0?ct.multiDrawElementsInstancedWEBGL(ot,et,0,this.type,_e,0,it,0,rt):ct.multiDrawArraysInstancedWEBGL(ot,_e,0,et,0,it,0,rt);let ut=0;for(let ht=0;ht<rt;ht++)ut+=et[ht];for(let ht=0;ht<it.length;ht++)lt.update(at,ut,ot,it[ht])}}}class WebGLBackend extends Backend{constructor(_e={}){super(_e),this.isWebGLBackend=!0}init(_e){super.init(_e);const et=this.parameters,rt=et.context!==void 0?et.context:_e.domElement.getContext("webgl2");this.gl=rt,this.extensions=new WebGLExtensions(this),this.capabilities=new WebGLCapabilities(this),this.attributeUtils=new WebGLAttributeUtils(this),this.textureUtils=new WebGLTextureUtils(this),this.bufferRenderer=new WebGLBufferRenderer(this),this.state=new WebGLState(this),this.utils=new WebGLUtils(this),this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.trackTimestamp=et.trackTimestamp===!0,this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this._currentContext=null}get coordinateSystem(){return WebGLCoordinateSystem}async getArrayBufferAsync(_e){return await this.attributeUtils.getArrayBufferAsync(_e)}initTimestampQuery(_e){if(!this.disjoint||!this.trackTimestamp)return;const et=this.get(_e);if(this.queryRunning){et.queryQueue||(et.queryQueue=[]),et.queryQueue.push(_e);return}et.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),et.activeQuery=null),et.activeQuery=this.gl.createQuery(),et.activeQuery!==null&&(this.gl.beginQuery(this.disjoint.TIME_ELAPSED_EXT,et.activeQuery),this.queryRunning=!0)}prepareTimestampBuffer(_e){if(!this.disjoint||!this.trackTimestamp)return;const et=this.get(_e);if(et.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),et.gpuQueries||(et.gpuQueries=[]),et.gpuQueries.push({query:et.activeQuery}),et.activeQuery=null,this.queryRunning=!1,et.queryQueue&&et.queryQueue.length>0)){const rt=et.queryQueue.shift();this.initTimestampQuery(rt)}}async resolveTimestampAsync(_e,et="render"){if(!this.disjoint||!this.trackTimestamp)return;const rt=this.get(_e);rt.gpuQueries||(rt.gpuQueries=[]);for(let it=0;it<rt.gpuQueries.length;it++){const st=rt.gpuQueries[it],ot=this.gl.getQueryParameter(st.query,this.gl.QUERY_RESULT_AVAILABLE),at=this.gl.getParameter(this.disjoint.GPU_DISJOINT_EXT);if(ot&&!at){const lt=this.gl.getQueryParameter(st.query,this.gl.QUERY_RESULT),ct=Number(lt)/1e6;this.gl.deleteQuery(st.query),rt.gpuQueries.splice(it,1),it--,this.renderer.info.updateTimestamp(et,ct)}}}getContext(){return this.gl}beginRender(_e){const{gl:et}=this,rt=this.get(_e);if(this.initTimestampQuery(_e),rt.previousContext=this._currentContext,this._currentContext=_e,this._setFramebuffer(_e),this.clear(_e.clearColor,_e.clearDepth,_e.clearStencil,_e,!1),_e.viewport?this.updateViewport(_e):et.viewport(0,0,et.drawingBufferWidth,et.drawingBufferHeight),_e.scissor){const{x:st,y:ot,width:at,height:lt}=_e.scissorValue;et.scissor(st,_e.height-lt-ot,at,lt)}const it=_e.occlusionQueryCount;it>0&&(rt.currentOcclusionQueries=rt.occlusionQueries,rt.currentOcclusionQueryObjects=rt.occlusionQueryObjects,rt.lastOcclusionObject=null,rt.occlusionQueries=new Array(it),rt.occlusionQueryObjects=new Array(it),rt.occlusionQueryIndex=0)}finishRender(_e){const{gl:et,state:rt}=this,it=this.get(_e),st=it.previousContext,ot=_e.occlusionQueryCount;ot>0&&(ot>it.occlusionQueryIndex&&et.endQuery(et.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(_e));const at=_e.textures;if(at!==null)for(let lt=0;lt<at.length;lt++){const ct=at[lt];ct.generateMipmaps&&this.generateMipmaps(ct)}if(this._currentContext=st,_e.textures!==null&&_e.renderTarget){const lt=this.get(_e.renderTarget),{samples:ct}=_e.renderTarget;if(ct>0){const ut=lt.framebuffers[_e.getCacheKey()],ht=et.COLOR_BUFFER_BIT,dt=lt.msaaFrameBuffer,ft=_e.textures;rt.bindFramebuffer(et.READ_FRAMEBUFFER,dt),rt.bindFramebuffer(et.DRAW_FRAMEBUFFER,ut);for(let pt=0;pt<ft.length;pt++)if(_e.scissor){const{x:mt,y:At,width:gt,height:bt}=_e.scissorValue,Tt=_e.height-bt-At;et.blitFramebuffer(mt,Tt,mt+gt,Tt+bt,mt,Tt,mt+gt,Tt+bt,ht,et.NEAREST),et.invalidateSubFramebuffer(et.READ_FRAMEBUFFER,lt.invalidationArray,mt,Tt,gt,bt)}else et.blitFramebuffer(0,0,_e.width,_e.height,0,0,_e.width,_e.height,ht,et.NEAREST),et.invalidateFramebuffer(et.READ_FRAMEBUFFER,lt.invalidationArray)}}st!==null&&(this._setFramebuffer(st),st.viewport?this.updateViewport(st):et.viewport(0,0,et.drawingBufferWidth,et.drawingBufferHeight)),this.prepareTimestampBuffer(_e)}resolveOccludedAsync(_e){const et=this.get(_e),{currentOcclusionQueries:rt,currentOcclusionQueryObjects:it}=et;if(rt&&it){const st=new WeakSet,{gl:ot}=this;et.currentOcclusionQueryObjects=null,et.currentOcclusionQueries=null;const at=()=>{let lt=0;for(let ct=0;ct<rt.length;ct++){const ut=rt[ct];ut!==null&&ot.getQueryParameter(ut,ot.QUERY_RESULT_AVAILABLE)&&(ot.getQueryParameter(ut,ot.QUERY_RESULT)>0&&st.add(it[ct]),rt[ct]=null,ot.deleteQuery(ut),lt++)}lt<rt.length?requestAnimationFrame(at):et.occluded=st};at()}}isOccluded(_e,et){const rt=this.get(_e);return rt.occluded&&rt.occluded.has(et)}updateViewport(_e){const et=this.gl,{x:rt,y:it,width:st,height:ot}=_e.viewportValue;et.viewport(rt,_e.height-ot-it,st,ot)}setScissorTest(_e){const et=this.gl;_e?et.enable(et.SCISSOR_TEST):et.disable(et.SCISSOR_TEST)}clear(_e,et,rt,it=null,st=!0){const{gl:ot}=this;it===null&&(it={textures:null,clearColorValue:this.getClearColor()});let at=0;if(_e&&(at|=ot.COLOR_BUFFER_BIT),et&&(at|=ot.DEPTH_BUFFER_BIT),rt&&(at|=ot.STENCIL_BUFFER_BIT),at!==0){const lt=it.clearColorValue||this.getClearColor();if(lt.r*=lt.a,lt.g*=lt.a,lt.b*=lt.a,et&&this.state.setDepthMask(!0),it.textures===null)ot.clearColor(lt.r,lt.g,lt.b,lt.a),ot.clear(at);else{if(st&&this._setFramebuffer(it),_e)for(let ct=0;ct<it.textures.length;ct++)ot.clearBufferfv(ot.COLOR,ct,[lt.r,lt.g,lt.b,lt.a]);et&&rt?ot.clearBufferfi(ot.DEPTH_STENCIL,0,1,0):et?ot.clearBufferfv(ot.DEPTH,0,[1]):rt&&ot.clearBufferiv(ot.STENCIL,0,[0])}}}beginCompute(_e){const{state:et,gl:rt}=this;et.bindFramebuffer(rt.FRAMEBUFFER,null),this.initTimestampQuery(_e)}compute(_e,et,rt,it){const{state:st,gl:ot}=this;this.discard||(ot.enable(ot.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:at,transformBuffers:lt,attributes:ct}=this.get(it),ut=this._getVaoKey(null,ct),ht=this.vaoCache[ut];ht===void 0?this._createVao(null,ct):ot.bindVertexArray(ht),st.useProgram(at),this._bindUniforms(rt);const dt=this._getTransformFeedback(lt);ot.bindTransformFeedback(ot.TRANSFORM_FEEDBACK,dt),ot.beginTransformFeedback(ot.POINTS),ct[0].isStorageInstancedBufferAttribute?ot.drawArraysInstanced(ot.POINTS,0,1,et.count):ot.drawArrays(ot.POINTS,0,et.count),ot.endTransformFeedback(),ot.bindTransformFeedback(ot.TRANSFORM_FEEDBACK,null);for(let ft=0;ft<lt.length;ft++){const pt=lt[ft];pt.pbo&&this.textureUtils.copyBufferToTexture(pt.transformBuffer,pt.pbo),pt.switchBuffers()}}finishCompute(_e){const et=this.gl;this.discard=!1,et.disable(et.RASTERIZER_DISCARD),this.prepareTimestampBuffer(_e)}draw(_e){const{object:et,pipeline:rt,material:it,context:st}=_e,{programGPU:ot}=this.get(rt),{gl:at,state:lt}=this,ct=this.get(st),ut=_e.getDrawParameters();if(ut===null)return;this._bindUniforms(_e.getBindings());const ht=et.isMesh&&et.matrixWorld.determinant()<0;lt.setMaterial(it,ht),lt.useProgram(ot);let dt=_e.staticVao;if(dt===void 0){const Tt=this._getVaoKey(_e.getIndex(),_e.getAttributes());if(dt=this.vaoCache[Tt],dt===void 0){let wt;({vaoGPU:dt,staticVao:wt}=this._createVao(_e.getIndex(),_e.getAttributes())),wt&&(_e.staticVao=dt)}}at.bindVertexArray(dt);const ft=_e.getIndex(),pt=ct.lastOcclusionObject;if(pt!==et&&pt!==void 0){if(pt!==null&&pt.occlusionTest===!0&&(at.endQuery(at.ANY_SAMPLES_PASSED),ct.occlusionQueryIndex++),et.occlusionTest===!0){const Tt=at.createQuery();at.beginQuery(at.ANY_SAMPLES_PASSED,Tt),ct.occlusionQueries[ct.occlusionQueryIndex]=Tt,ct.occlusionQueryObjects[ct.occlusionQueryIndex]=et}ct.lastOcclusionObject=et}const mt=this.bufferRenderer;et.isPoints?mt.mode=at.POINTS:et.isLineSegments?mt.mode=at.LINES:et.isLine?mt.mode=at.LINE_STRIP:et.isLineLoop?mt.mode=at.LINE_LOOP:it.wireframe===!0?(lt.setLineWidth(it.wireframeLinewidth*this.renderer.getPixelRatio()),mt.mode=at.LINES):mt.mode=at.TRIANGLES;const{vertexCount:At,instanceCount:gt}=ut;let{firstVertex:bt}=ut;if(mt.object=et,ft!==null){bt*=ft.array.BYTES_PER_ELEMENT;const Tt=this.get(ft);mt.index=ft.count,mt.type=Tt.type}else mt.index=0;et.isBatchedMesh?et._multiDrawInstances!==null?mt.renderMultiDrawInstances(et._multiDrawStarts,et._multiDrawCounts,et._multiDrawCount,et._multiDrawInstances):this.hasFeature("WEBGL_multi_draw")?mt.renderMultiDraw(et._multiDrawStarts,et._multiDrawCounts,et._multiDrawCount):warnOnce("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):gt>1?mt.renderInstances(bt,At,gt):mt.render(bt,At),at.bindVertexArray(null)}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(_e){this.textureUtils.createDefaultTexture(_e)}createTexture(_e,et){this.textureUtils.createTexture(_e,et)}updateTexture(_e,et){this.textureUtils.updateTexture(_e,et)}generateMipmaps(_e){this.textureUtils.generateMipmaps(_e)}destroyTexture(_e){this.textureUtils.destroyTexture(_e)}copyTextureToBuffer(_e,et,rt,it,st,ot){return this.textureUtils.copyTextureToBuffer(_e,et,rt,it,st,ot)}createSampler(){}destroySampler(){}createNodeBuilder(_e,et){return new GLSLNodeBuilder(_e,et)}createProgram(_e){const et=this.gl,{stage:rt,code:it}=_e,st=rt==="fragment"?et.createShader(et.FRAGMENT_SHADER):et.createShader(et.VERTEX_SHADER);et.shaderSource(st,it),et.compileShader(st),this.set(_e,{shaderGPU:st})}destroyProgram(){console.warn("Abstract class.")}createRenderPipeline(_e,et){const rt=this.gl,it=_e.pipeline,{fragmentProgram:st,vertexProgram:ot}=it,at=rt.createProgram(),lt=this.get(st).shaderGPU,ct=this.get(ot).shaderGPU;if(rt.attachShader(at,lt),rt.attachShader(at,ct),rt.linkProgram(at),this.set(it,{programGPU:at,fragmentShader:lt,vertexShader:ct}),et!==null&&this.parallel){const ut=new Promise(ht=>{const dt=this.parallel,ft=()=>{rt.getProgramParameter(at,dt.COMPLETION_STATUS_KHR)?(this._completeCompile(_e,it),ht()):requestAnimationFrame(ft)};ft()});et.push(ut);return}this._completeCompile(_e,it)}_handleSource(_e,et){const rt=_e.split(`
`),it=[],st=Math.max(et-6,0),ot=Math.min(et+6,rt.length);for(let at=st;at<ot;at++){const lt=at+1;it.push(`${lt===et?">":" "} ${lt}: ${rt[at]}`)}return it.join(`
`)}_getShaderErrors(_e,et,rt){const it=_e.getShaderParameter(et,_e.COMPILE_STATUS),st=_e.getShaderInfoLog(et).trim();if(it&&st==="")return"";const ot=/ERROR: 0:(\d+)/.exec(st);if(ot){const at=parseInt(ot[1]);return rt.toUpperCase()+`

`+st+`

`+this._handleSource(_e.getShaderSource(et),at)}else return st}_logProgramError(_e,et,rt){if(this.renderer.debug.checkShaderErrors){const it=this.gl,st=it.getProgramInfoLog(_e).trim();if(it.getProgramParameter(_e,it.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(it,_e,rt,et);else{const ot=this._getShaderErrors(it,rt,"vertex"),at=this._getShaderErrors(it,et,"fragment");console.error("THREE.WebGLProgram: Shader Error "+it.getError()+" - VALIDATE_STATUS "+it.getProgramParameter(_e,it.VALIDATE_STATUS)+`

Program Info Log: `+st+`
`+ot+`
`+at)}else st!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",st)}}_completeCompile(_e,et){const{state:rt,gl:it}=this,st=this.get(et),{programGPU:ot,fragmentShader:at,vertexShader:lt}=st;it.getProgramParameter(ot,it.LINK_STATUS)===!1&&this._logProgramError(ot,at,lt),rt.useProgram(ot);const ct=_e.getBindings();this._setupBindings(ct,ot),this.set(et,{programGPU:ot})}createComputePipeline(_e,et){const{state:rt,gl:it}=this,st={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(st);const{computeProgram:ot}=_e,at=it.createProgram(),lt=this.get(st).shaderGPU,ct=this.get(ot).shaderGPU,ut=ot.transforms,ht=[],dt=[];for(let At=0;At<ut.length;At++){const gt=ut[At];ht.push(gt.varyingName),dt.push(gt.attributeNode)}it.attachShader(at,lt),it.attachShader(at,ct),it.transformFeedbackVaryings(at,ht,it.SEPARATE_ATTRIBS),it.linkProgram(at),it.getProgramParameter(at,it.LINK_STATUS)===!1&&this._logProgramError(at,lt,ct),rt.useProgram(at),this.createBindings(null,et),this._setupBindings(et,at);const ft=ot.attributes,pt=[],mt=[];for(let At=0;At<ft.length;At++){const gt=ft[At].node.attribute;pt.push(gt),this.has(gt)||this.attributeUtils.createAttribute(gt,it.ARRAY_BUFFER)}for(let At=0;At<dt.length;At++){const gt=dt[At].attribute;this.has(gt)||this.attributeUtils.createAttribute(gt,it.ARRAY_BUFFER);const bt=this.get(gt);mt.push(bt)}this.set(_e,{programGPU:at,transformBuffers:mt,attributes:pt})}createBindings(_e,et){this.updateBindings(_e,et)}updateBindings(_e,et){if(!_e)return;const{gl:rt}=this,it=this.get(et),st=this.get(_e);it.textureIndex===void 0&&(it.textureIndex=0),st.textureIndex===void 0?st.textureIndex=it.textureIndex:it.textureIndex=st.textureIndex;let ot=0;for(const at of _e.bindings)if(at.isUniformsGroup||at.isUniformBuffer){const lt=at.buffer,ct=rt.createBuffer();rt.bindBuffer(rt.UNIFORM_BUFFER,ct),rt.bufferData(rt.UNIFORM_BUFFER,lt,rt.DYNAMIC_DRAW),this.set(at,{index:_e.index*2+ot++,bufferGPU:ct})}else if(at.isSampledTexture){const{textureGPU:lt,glTextureType:ct}=this.get(at.texture);this.set(at,{index:it.textureIndex++,textureGPU:lt,glTextureType:ct})}}updateBinding(_e){const et=this.gl;if(_e.isUniformsGroup||_e.isUniformBuffer){const it=this.get(_e).bufferGPU,st=_e.buffer;et.bindBuffer(et.UNIFORM_BUFFER,it),et.bufferData(et.UNIFORM_BUFFER,st,et.DYNAMIC_DRAW)}}createIndexAttribute(_e){const et=this.gl;this.attributeUtils.createAttribute(_e,et.ELEMENT_ARRAY_BUFFER)}createAttribute(_e){if(this.has(_e))return;const et=this.gl;this.attributeUtils.createAttribute(_e,et.ARRAY_BUFFER)}createStorageAttribute(_e){if(this.has(_e))return;const et=this.gl;this.attributeUtils.createAttribute(_e,et.ARRAY_BUFFER)}updateAttribute(_e){this.attributeUtils.updateAttribute(_e)}destroyAttribute(_e){this.attributeUtils.destroyAttribute(_e)}updateSize(){}hasFeature(_e){const et=Object.keys(GLFeatureName).filter(it=>GLFeatureName[it]===_e),rt=this.extensions;for(let it=0;it<et.length;it++)if(rt.has(et[it]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(_e,et,rt,it){this.textureUtils.copyTextureToTexture(_e,et,rt,it)}copyFramebufferToTexture(_e,et,rt){this.textureUtils.copyFramebufferToTexture(_e,et,rt)}_setFramebuffer(_e){const{gl:et,state:rt}=this;let it=null;if(_e.textures!==null){const st=_e.renderTarget,ot=this.get(st),{samples:at,depthBuffer:lt,stencilBuffer:ct}=st,ut=st.isWebGLCubeRenderTarget===!0;let ht=ot.msaaFrameBuffer,dt=ot.depthRenderbuffer;const ft=getCacheKey(_e);let pt;if(ut?(ot.cubeFramebuffers||(ot.cubeFramebuffers={}),pt=ot.cubeFramebuffers[ft]):(ot.framebuffers||(ot.framebuffers={}),pt=ot.framebuffers[ft]),pt===void 0){pt=et.createFramebuffer(),rt.bindFramebuffer(et.FRAMEBUFFER,pt);const mt=_e.textures;if(ut){ot.cubeFramebuffers[ft]=pt;const{textureGPU:At}=this.get(mt[0]),gt=this.renderer._activeCubeFace;et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_CUBE_MAP_POSITIVE_X+gt,At,0)}else{ot.framebuffers[ft]=pt;for(let At=0;At<mt.length;At++){const gt=mt[At],bt=this.get(gt);bt.renderTarget=_e.renderTarget;const Tt=et.COLOR_ATTACHMENT0+At;et.framebufferTexture2D(et.FRAMEBUFFER,Tt,et.TEXTURE_2D,bt.textureGPU,0)}rt.drawBuffers(_e,pt)}if(_e.depthTexture!==null){const At=this.get(_e.depthTexture),gt=ct?et.DEPTH_STENCIL_ATTACHMENT:et.DEPTH_ATTACHMENT;et.framebufferTexture2D(et.FRAMEBUFFER,gt,et.TEXTURE_2D,At.textureGPU,0)}}if(at>0){if(ht===void 0){const mt=[];ht=et.createFramebuffer(),rt.bindFramebuffer(et.FRAMEBUFFER,ht);const At=[],gt=_e.textures;for(let bt=0;bt<gt.length;bt++){if(At[bt]=et.createRenderbuffer(),et.bindRenderbuffer(et.RENDERBUFFER,At[bt]),mt.push(et.COLOR_ATTACHMENT0+bt),lt){const Rt=ct?et.DEPTH_STENCIL_ATTACHMENT:et.DEPTH_ATTACHMENT;mt.push(Rt)}const Tt=_e.textures[bt],wt=this.get(Tt);et.renderbufferStorageMultisample(et.RENDERBUFFER,at,wt.glInternalFormat,_e.width,_e.height),et.framebufferRenderbuffer(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0+bt,et.RENDERBUFFER,At[bt])}if(ot.msaaFrameBuffer=ht,ot.msaaRenderbuffers=At,dt===void 0){dt=et.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(dt,_e),ot.depthRenderbuffer=dt;const bt=ct?et.DEPTH_STENCIL_ATTACHMENT:et.DEPTH_ATTACHMENT;mt.push(bt)}ot.invalidationArray=mt}it=ot.msaaFrameBuffer}else it=pt}rt.bindFramebuffer(et.FRAMEBUFFER,it)}_getVaoKey(_e,et){let rt=[];if(_e!==null){const it=this.get(_e);rt+=":"+it.id}for(let it=0;it<et.length;it++){const st=this.get(et[it]);rt+=":"+st.id}return rt}_createVao(_e,et){const{gl:rt}=this,it=rt.createVertexArray();let st="",ot=!0;if(rt.bindVertexArray(it),_e!==null){const at=this.get(_e);rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,at.bufferGPU),st+=":"+at.id}for(let at=0;at<et.length;at++){const lt=et[at],ct=this.get(lt);st+=":"+ct.id,rt.bindBuffer(rt.ARRAY_BUFFER,ct.bufferGPU),rt.enableVertexAttribArray(at),(lt.isStorageBufferAttribute||lt.isStorageInstancedBufferAttribute)&&(ot=!1);let ut,ht;lt.isInterleavedBufferAttribute===!0?(ut=lt.data.stride*ct.bytesPerElement,ht=lt.offset*ct.bytesPerElement):(ut=0,ht=0),ct.isInteger?rt.vertexAttribIPointer(at,lt.itemSize,ct.type,ut,ht):rt.vertexAttribPointer(at,lt.itemSize,ct.type,lt.normalized,ut,ht),lt.isInstancedBufferAttribute&&!lt.isInterleavedBufferAttribute?rt.vertexAttribDivisor(at,lt.meshPerAttribute):lt.isInterleavedBufferAttribute&&lt.data.isInstancedInterleavedBuffer&&rt.vertexAttribDivisor(at,lt.data.meshPerAttribute)}return rt.bindBuffer(rt.ARRAY_BUFFER,null),this.vaoCache[st]=it,{vaoGPU:it,staticVao:ot}}_getTransformFeedback(_e){let et="";for(let st=0;st<_e.length;st++)et+=":"+_e[st].id;let rt=this.transformFeedbackCache[et];if(rt!==void 0)return rt;const{gl:it}=this;rt=it.createTransformFeedback(),it.bindTransformFeedback(it.TRANSFORM_FEEDBACK,rt);for(let st=0;st<_e.length;st++){const ot=_e[st];it.bindBufferBase(it.TRANSFORM_FEEDBACK_BUFFER,st,ot.transformBuffer)}return it.bindTransformFeedback(it.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[et]=rt,rt}_setupBindings(_e,et){const rt=this.gl;for(const it of _e)for(const st of it.bindings){const at=this.get(st).index;if(st.isUniformsGroup||st.isUniformBuffer){const lt=rt.getUniformBlockIndex(et,st.name);rt.uniformBlockBinding(et,lt,at)}else if(st.isSampledTexture){const lt=rt.getUniformLocation(et,st.name);rt.uniform1i(lt,at)}}}_bindUniforms(_e){const{gl:et,state:rt}=this;for(const it of _e)for(const st of it.bindings){const ot=this.get(st),at=ot.index;st.isUniformsGroup||st.isUniformBuffer?rt.bindBufferBase(et.UNIFORM_BUFFER,at,ot.bufferGPU):st.isSampledTexture&&rt.bindTexture(ot.glTextureType,ot.textureGPU,et.TEXTURE0+at)}}}class Sampler extends Binding{constructor(_e,et){super(_e),this.texture=et,this.version=et?et.version:0,this.isSampler=!0}}class NodeSampler extends Sampler{constructor(_e,et,rt){super(_e,et?et.value:null),this.textureNode=et,this.groupNode=rt}update(){this.texture=this.textureNode.value}}class StorageBuffer extends Buffer{constructor(_e,et){super(_e,et?et.array:null),this.attribute=et,this.isStorageBuffer=!0}}let _id=0;class NodeStorageBuffer extends StorageBuffer{constructor(_e,et){super("StorageBuffer_"+_id++,_e?_e.value:null),this.nodeUniform=_e,this.access=_e?_e.access:GPUBufferBindingType.Storage,this.groupNode=et}get buffer(){return this.nodeUniform.value}}class WebGPUTexturePassUtils extends DataMap{constructor(_e){super(),this.device=_e;const et=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,rt=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,it=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=_e.createSampler({minFilter:GPUFilterMode.Linear}),this.flipYSampler=_e.createSampler({minFilter:GPUFilterMode.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=_e.createShaderModule({label:"mipmapVertex",code:et}),this.mipmapFragmentShaderModule=_e.createShaderModule({label:"mipmapFragment",code:rt}),this.flipYFragmentShaderModule=_e.createShaderModule({label:"flipYFragment",code:it})}getTransferPipeline(_e){let et=this.transferPipelines[_e];return et===void 0&&(et=this.device.createRenderPipeline({label:`mipmap-${_e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:_e}]},primitive:{topology:GPUPrimitiveTopology.TriangleStrip,stripIndexFormat:GPUIndexFormat.Uint32},layout:"auto"}),this.transferPipelines[_e]=et),et}getFlipYPipeline(_e){let et=this.flipYPipelines[_e];return et===void 0&&(et=this.device.createRenderPipeline({label:`flipY-${_e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:_e}]},primitive:{topology:GPUPrimitiveTopology.TriangleStrip,stripIndexFormat:GPUIndexFormat.Uint32},layout:"auto"}),this.flipYPipelines[_e]=et),et}flipY(_e,et,rt=0){const it=et.format,{width:st,height:ot}=et.size,at=this.getTransferPipeline(it),lt=this.getFlipYPipeline(it),ct=this.device.createTexture({size:{width:st,height:ot,depthOrArrayLayers:1},format:it,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),ut=_e.createView({baseMipLevel:0,mipLevelCount:1,dimension:GPUTextureViewDimension.TwoD,baseArrayLayer:rt}),ht=ct.createView({baseMipLevel:0,mipLevelCount:1,dimension:GPUTextureViewDimension.TwoD,baseArrayLayer:0}),dt=this.device.createCommandEncoder({}),ft=(pt,mt,At)=>{const gt=pt.getBindGroupLayout(0),bt=this.device.createBindGroup({layout:gt,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:mt}]}),Tt=dt.beginRenderPass({colorAttachments:[{view:At,loadOp:GPULoadOp.Clear,storeOp:GPUStoreOp.Store,clearValue:[0,0,0,0]}]});Tt.setPipeline(pt),Tt.setBindGroup(0,bt),Tt.draw(4,1,0,0),Tt.end()};ft(at,ut,ht),ft(lt,ht,ut),this.device.queue.submit([dt.finish()]),ct.destroy()}generateMipmaps(_e,et,rt=0){const it=this.get(_e);it.useCount===void 0&&(it.useCount=0,it.layers=[]);const st=it.layers[rt]||this._mipmapCreateBundles(_e,et,rt),ot=this.device.createCommandEncoder({});this._mipmapRunBundles(ot,st),this.device.queue.submit([ot.finish()]),it.useCount!==0&&(it.layers[rt]=st),it.useCount++}_mipmapCreateBundles(_e,et,rt){const it=this.getTransferPipeline(et.format),st=it.getBindGroupLayout(0);let ot=_e.createView({baseMipLevel:0,mipLevelCount:1,dimension:GPUTextureViewDimension.TwoD,baseArrayLayer:rt});const at=[];for(let lt=1;lt<et.mipLevelCount;lt++){const ct=this.device.createBindGroup({layout:st,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:ot}]}),ut=_e.createView({baseMipLevel:lt,mipLevelCount:1,dimension:GPUTextureViewDimension.TwoD,baseArrayLayer:rt}),ht={colorAttachments:[{view:ut,loadOp:GPULoadOp.Clear,storeOp:GPUStoreOp.Store,clearValue:[0,0,0,0]}]},dt=this.device.createRenderBundleEncoder({colorFormats:[et.format]});dt.setPipeline(it),dt.setBindGroup(0,ct),dt.draw(4,1,0,0),at.push({renderBundles:[dt.finish()],passDescriptor:ht}),ot=ut}return at}_mipmapRunBundles(_e,et){const rt=et.length;for(let it=0;it<rt;it++){const st=et[it],ot=_e.beginRenderPass(st.passDescriptor);ot.executeBundles(st.renderBundles),ot.end()}}}const _compareToWebGPU={[NeverCompare]:"never",[LessCompare]:"less",[EqualCompare]:"equal",[LessEqualCompare]:"less-equal",[GreaterCompare]:"greater",[GreaterEqualCompare]:"greater-equal",[AlwaysCompare]:"always",[NotEqualCompare]:"not-equal"},_flipMap=[0,1,3,2,4,5];class WebGPUTextureUtils{constructor(_e){this.backend=_e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new DepthTexture,this.depthTexture.name="depthBuffer"}createSampler(_e){const et=this.backend,rt=et.device,it=et.get(_e),st={addressModeU:this._convertAddressMode(_e.wrapS),addressModeV:this._convertAddressMode(_e.wrapT),addressModeW:this._convertAddressMode(_e.wrapR),magFilter:this._convertFilterMode(_e.magFilter),minFilter:this._convertFilterMode(_e.minFilter),mipmapFilter:this._convertFilterMode(_e.minFilter),maxAnisotropy:_e.anisotropy};_e.isDepthTexture&&_e.compareFunction!==null&&(st.compare=_compareToWebGPU[_e.compareFunction]),it.sampler=rt.createSampler(st)}createDefaultTexture(_e){let et;const rt=getFormat(_e);_e.isCubeTexture?et=this._getDefaultCubeTextureGPU(rt):_e.isVideoTexture?this.backend.get(_e).externalTexture=this._getDefaultVideoFrame():et=this._getDefaultTextureGPU(rt),this.backend.get(_e).texture=et}createTexture(_e,et={}){const rt=this.backend,it=rt.get(_e);if(it.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");et.needsMipmaps===void 0&&(et.needsMipmaps=!1),et.levels===void 0&&(et.levels=1),et.depth===void 0&&(et.depth=1);const{width:st,height:ot,depth:at,levels:lt}=et,ct=this._getDimension(_e),ut=_e.internalFormat||et.format||getFormat(_e,rt.device);it.format=ut;let ht=et.sampleCount!==void 0?et.sampleCount:1;ht=rt.utils.getSampleCount(ht);const dt=_e.isRenderTargetTexture&&!_e.isMultisampleRenderTargetTexture?1:ht;let ft=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;_e.isStorageTexture===!0&&(ft|=GPUTextureUsage.STORAGE_BINDING),_e.isCompressedTexture!==!0&&_e.isCompressedArrayTexture!==!0&&(ft|=GPUTextureUsage.RENDER_ATTACHMENT);const pt={label:_e.name,size:{width:st,height:ot,depthOrArrayLayers:at},mipLevelCount:lt,sampleCount:dt,dimension:ct,format:ut,usage:ft};if(_e.isVideoTexture){const mt=_e.source.data,At=new VideoFrame(mt);pt.size.width=At.displayWidth,pt.size.height=At.displayHeight,At.close(),it.externalTexture=mt}else{if(ut===void 0)return console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(_e);it.texture=rt.device.createTexture(pt)}if(_e.isRenderTargetTexture&&ht>1&&!_e.isMultisampleRenderTargetTexture){const mt=Object.assign({},pt);mt.label=mt.label+"-msaa",mt.sampleCount=ht,it.msaaTexture=rt.device.createTexture(mt)}it.initialized=!0,it.textureDescriptorGPU=pt}destroyTexture(_e){const et=this.backend,rt=et.get(_e);rt.texture.destroy(),rt.msaaTexture!==void 0&&rt.msaaTexture.destroy(),et.delete(_e)}destroySampler(_e){const rt=this.backend.get(_e);delete rt.sampler}generateMipmaps(_e){const et=this.backend.get(_e);if(_e.isCubeTexture)for(let rt=0;rt<6;rt++)this._generateMipmaps(et.texture,et.textureDescriptorGPU,rt);else{const rt=_e.image.depth||1;for(let it=0;it<rt;it++)this._generateMipmaps(et.texture,et.textureDescriptorGPU,it)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const _e=this.backend,{width:et,height:rt}=_e.getDrawingBufferSize();return this.colorBuffer=_e.device.createTexture({label:"colorBuffer",size:{width:et,height:rt,depthOrArrayLayers:1},sampleCount:_e.utils.getSampleCount(_e.renderer.samples),format:_e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(_e=!0,et=!1){const rt=this.backend,{width:it,height:st}=rt.getDrawingBufferSize(),ot=this.depthTexture,at=rt.get(ot).texture;let lt,ct;if(et?(lt=DepthStencilFormat,ct=UnsignedInt248Type):_e&&(lt=DepthFormat,ct=UnsignedIntType),at!==void 0){if(ot.image.width===it&&ot.image.height===st&&ot.format===lt&&ot.type===ct)return at;this.destroyTexture(ot)}return ot.name="depthBuffer",ot.format=lt,ot.type=ct,ot.image.width=it,ot.image.height=st,this.createTexture(ot,{sampleCount:rt.utils.getSampleCount(rt.renderer.samples),width:it,height:st}),rt.get(ot).texture}updateTexture(_e,et){const rt=this.backend.get(_e),{textureDescriptorGPU:it}=rt;if(!(_e.isRenderTargetTexture||it===void 0)){if(_e.isDataTexture)this._copyBufferToTexture(et.image,rt.texture,it,0,_e.flipY);else if(_e.isDataArrayTexture||_e.isData3DTexture)for(let st=0;st<et.image.depth;st++)this._copyBufferToTexture(et.image,rt.texture,it,st,_e.flipY,st);else if(_e.isCompressedTexture||_e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(_e.mipmaps,rt.texture,it);else if(_e.isCubeTexture)this._copyCubeMapToTexture(et.images,rt.texture,it,_e.flipY);else if(_e.isVideoTexture){const st=_e.source.data;rt.externalTexture=st}else this._copyImageToTexture(et.image,rt.texture,it,0,_e.flipY);rt.version=_e.version,_e.onUpdate&&_e.onUpdate(_e)}}async copyTextureToBuffer(_e,et,rt,it,st,ot){const at=this.backend.device,lt=this.backend.get(_e),ct=lt.texture,ut=lt.textureDescriptorGPU.format,ht=this._getBytesPerTexel(ut);let dt=it*ht;dt=Math.ceil(dt/256)*256;const ft=at.createBuffer({size:it*st*ht,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),pt=at.createCommandEncoder();pt.copyTextureToBuffer({texture:ct,origin:{x:et,y:rt,z:ot}},{buffer:ft,bytesPerRow:dt},{width:it,height:st});const mt=this._getTypedArrayType(ut);at.queue.submit([pt.finish()]),await ft.mapAsync(GPUMapMode.READ);const At=ft.getMappedRange();return new mt(At)}_isEnvironmentTexture(_e){const et=_e.mapping;return et===EquirectangularReflectionMapping||et===EquirectangularRefractionMapping||et===CubeReflectionMapping||et===CubeRefractionMapping}_getDefaultTextureGPU(_e){let et=this.defaultTexture[_e];if(et===void 0){const rt=new Texture;rt.minFilter=NearestFilter,rt.magFilter=NearestFilter,this.createTexture(rt,{width:1,height:1,format:_e}),this.defaultTexture[_e]=et=rt}return this.backend.get(et).texture}_getDefaultCubeTextureGPU(_e){let et=this.defaultTexture[_e];if(et===void 0){const rt=new CubeTexture;rt.minFilter=NearestFilter,rt.magFilter=NearestFilter,this.createTexture(rt,{width:1,height:1,depth:6}),this.defaultCubeTexture[_e]=et=rt}return this.backend.get(et).texture}_getDefaultVideoFrame(){let _e=this.defaultVideoFrame;if(_e===null){const et={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=_e=new VideoFrame(new Uint8Array([0,0,0,255]),et)}return _e}_copyCubeMapToTexture(_e,et,rt,it){for(let st=0;st<6;st++){const ot=_e[st],at=it===!0?_flipMap[st]:st;ot.isDataTexture?this._copyBufferToTexture(ot.image,et,rt,at,it):this._copyImageToTexture(ot,et,rt,at,it)}}_copyImageToTexture(_e,et,rt,it,st){this.backend.device.queue.copyExternalImageToTexture({source:_e},{texture:et,mipLevel:0,origin:{x:0,y:0,z:it}},{width:_e.width,height:_e.height,depthOrArrayLayers:1}),st===!0&&this._flipY(et,rt,it)}_getPassUtils(){let _e=this._passUtils;return _e===null&&(this._passUtils=_e=new WebGPUTexturePassUtils(this.backend.device)),_e}_generateMipmaps(_e,et,rt=0){this._getPassUtils().generateMipmaps(_e,et,rt)}_flipY(_e,et,rt=0){this._getPassUtils().flipY(_e,et,rt)}_copyBufferToTexture(_e,et,rt,it,st,ot=0){const at=this.backend.device,lt=_e.data,ct=this._getBytesPerTexel(rt.format),ut=_e.width*ct;at.queue.writeTexture({texture:et,mipLevel:0,origin:{x:0,y:0,z:it}},lt,{offset:_e.width*_e.height*ct*ot,bytesPerRow:ut},{width:_e.width,height:_e.height,depthOrArrayLayers:1}),st===!0&&this._flipY(et,rt,it)}_copyCompressedBufferToTexture(_e,et,rt){const it=this.backend.device,st=this._getBlockData(rt.format),ot=rt.size.depthOrArrayLayers>1;for(let at=0;at<_e.length;at++){const lt=_e[at],ct=lt.width,ut=lt.height,ht=ot?rt.size.depthOrArrayLayers:1,dt=Math.ceil(ct/st.width)*st.byteLength,ft=dt*Math.ceil(ut/st.height);for(let pt=0;pt<ht;pt++)it.queue.writeTexture({texture:et,mipLevel:at,origin:{x:0,y:0,z:pt}},lt.data,{offset:pt*ft,bytesPerRow:dt,rowsPerImage:Math.ceil(ut/st.height)},{width:Math.ceil(ct/st.width)*st.width,height:Math.ceil(ut/st.height)*st.height,depthOrArrayLayers:1})}}_getBlockData(_e){if(_e===GPUTextureFormat.BC1RGBAUnorm||_e===GPUTextureFormat.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(_e===GPUTextureFormat.BC2RGBAUnorm||_e===GPUTextureFormat.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.BC3RGBAUnorm||_e===GPUTextureFormat.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.BC4RUnorm||_e===GPUTextureFormat.BC4RSNorm)return{byteLength:8,width:4,height:4};if(_e===GPUTextureFormat.BC5RGUnorm||_e===GPUTextureFormat.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.BC6HRGBUFloat||_e===GPUTextureFormat.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.BC7RGBAUnorm||_e===GPUTextureFormat.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.ETC2RGB8Unorm||_e===GPUTextureFormat.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(_e===GPUTextureFormat.ETC2RGB8A1Unorm||_e===GPUTextureFormat.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(_e===GPUTextureFormat.ETC2RGBA8Unorm||_e===GPUTextureFormat.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.EACR11Unorm)return{byteLength:8,width:4,height:4};if(_e===GPUTextureFormat.EACR11Snorm)return{byteLength:8,width:4,height:4};if(_e===GPUTextureFormat.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.ASTC4x4Unorm||_e===GPUTextureFormat.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(_e===GPUTextureFormat.ASTC5x4Unorm||_e===GPUTextureFormat.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(_e===GPUTextureFormat.ASTC5x5Unorm||_e===GPUTextureFormat.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(_e===GPUTextureFormat.ASTC6x5Unorm||_e===GPUTextureFormat.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(_e===GPUTextureFormat.ASTC6x6Unorm||_e===GPUTextureFormat.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(_e===GPUTextureFormat.ASTC8x5Unorm||_e===GPUTextureFormat.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(_e===GPUTextureFormat.ASTC8x6Unorm||_e===GPUTextureFormat.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(_e===GPUTextureFormat.ASTC8x8Unorm||_e===GPUTextureFormat.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(_e===GPUTextureFormat.ASTC10x5Unorm||_e===GPUTextureFormat.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(_e===GPUTextureFormat.ASTC10x6Unorm||_e===GPUTextureFormat.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(_e===GPUTextureFormat.ASTC10x8Unorm||_e===GPUTextureFormat.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(_e===GPUTextureFormat.ASTC10x10Unorm||_e===GPUTextureFormat.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(_e===GPUTextureFormat.ASTC12x10Unorm||_e===GPUTextureFormat.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(_e===GPUTextureFormat.ASTC12x12Unorm||_e===GPUTextureFormat.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(_e){let et=GPUAddressMode.ClampToEdge;return _e===RepeatWrapping?et=GPUAddressMode.Repeat:_e===MirroredRepeatWrapping&&(et=GPUAddressMode.MirrorRepeat),et}_convertFilterMode(_e){let et=GPUFilterMode.Linear;return(_e===NearestFilter||_e===NearestMipmapNearestFilter||_e===NearestMipmapLinearFilter)&&(et=GPUFilterMode.Nearest),et}_getBytesPerTexel(_e){if(_e===GPUTextureFormat.R8Unorm||_e===GPUTextureFormat.R8Snorm||_e===GPUTextureFormat.R8Uint||_e===GPUTextureFormat.R8Sint)return 1;if(_e===GPUTextureFormat.R16Uint||_e===GPUTextureFormat.R16Sint||_e===GPUTextureFormat.R16Float||_e===GPUTextureFormat.RG8Unorm||_e===GPUTextureFormat.RG8Snorm||_e===GPUTextureFormat.RG8Uint||_e===GPUTextureFormat.RG8Sint)return 2;if(_e===GPUTextureFormat.R32Uint||_e===GPUTextureFormat.R32Sint||_e===GPUTextureFormat.R32Float||_e===GPUTextureFormat.RG16Uint||_e===GPUTextureFormat.RG16Sint||_e===GPUTextureFormat.RG16Float||_e===GPUTextureFormat.RGBA8Unorm||_e===GPUTextureFormat.RGBA8UnormSRGB||_e===GPUTextureFormat.RGBA8Snorm||_e===GPUTextureFormat.RGBA8Uint||_e===GPUTextureFormat.RGBA8Sint||_e===GPUTextureFormat.BGRA8Unorm||_e===GPUTextureFormat.BGRA8UnormSRGB||_e===GPUTextureFormat.RGB9E5UFloat||_e===GPUTextureFormat.RGB10A2Unorm||_e===GPUTextureFormat.RG11B10UFloat||_e===GPUTextureFormat.Depth32Float||_e===GPUTextureFormat.Depth24Plus||_e===GPUTextureFormat.Depth24PlusStencil8||_e===GPUTextureFormat.Depth32FloatStencil8)return 4;if(_e===GPUTextureFormat.RG32Uint||_e===GPUTextureFormat.RG32Sint||_e===GPUTextureFormat.RG32Float||_e===GPUTextureFormat.RGBA16Uint||_e===GPUTextureFormat.RGBA16Sint||_e===GPUTextureFormat.RGBA16Float)return 8;if(_e===GPUTextureFormat.RGBA32Uint||_e===GPUTextureFormat.RGBA32Sint||_e===GPUTextureFormat.RGBA32Float)return 16}_getTypedArrayType(_e){if(_e===GPUTextureFormat.R8Uint)return Uint8Array;if(_e===GPUTextureFormat.R8Sint)return Int8Array;if(_e===GPUTextureFormat.R8Unorm)return Uint8Array;if(_e===GPUTextureFormat.R8Snorm)return Int8Array;if(_e===GPUTextureFormat.RG8Uint)return Uint8Array;if(_e===GPUTextureFormat.RG8Sint)return Int8Array;if(_e===GPUTextureFormat.RG8Unorm)return Uint8Array;if(_e===GPUTextureFormat.RG8Snorm)return Int8Array;if(_e===GPUTextureFormat.RGBA8Uint)return Uint8Array;if(_e===GPUTextureFormat.RGBA8Sint)return Int8Array;if(_e===GPUTextureFormat.RGBA8Unorm)return Uint8Array;if(_e===GPUTextureFormat.RGBA8Snorm)return Int8Array;if(_e===GPUTextureFormat.R16Uint)return Uint16Array;if(_e===GPUTextureFormat.R16Sint)return Int16Array;if(_e===GPUTextureFormat.RG16Uint)return Uint16Array;if(_e===GPUTextureFormat.RG16Sint)return Int16Array;if(_e===GPUTextureFormat.RGBA16Uint)return Uint16Array;if(_e===GPUTextureFormat.RGBA16Sint)return Int16Array;if(_e===GPUTextureFormat.R16Float||_e===GPUTextureFormat.RG16Float||_e===GPUTextureFormat.RGBA16Float)return Uint16Array;if(_e===GPUTextureFormat.R32Uint)return Uint32Array;if(_e===GPUTextureFormat.R32Sint)return Int32Array;if(_e===GPUTextureFormat.R32Float)return Float32Array;if(_e===GPUTextureFormat.RG32Uint)return Uint32Array;if(_e===GPUTextureFormat.RG32Sint)return Int32Array;if(_e===GPUTextureFormat.RG32Float)return Float32Array;if(_e===GPUTextureFormat.RGBA32Uint)return Uint32Array;if(_e===GPUTextureFormat.RGBA32Sint)return Int32Array;if(_e===GPUTextureFormat.RGBA32Float)return Float32Array;if(_e===GPUTextureFormat.BGRA8Unorm||_e===GPUTextureFormat.BGRA8UnormSRGB)return Uint8Array;if(_e===GPUTextureFormat.RGB10A2Unorm||_e===GPUTextureFormat.RGB9E5UFloat||_e===GPUTextureFormat.RG11B10UFloat)return Uint32Array;if(_e===GPUTextureFormat.Depth32Float)return Float32Array;if(_e===GPUTextureFormat.Depth24Plus||_e===GPUTextureFormat.Depth24PlusStencil8)return Uint32Array;if(_e===GPUTextureFormat.Depth32FloatStencil8)return Float32Array}_getDimension(_e){let et;return _e.isData3DTexture?et=GPUTextureDimension.ThreeD:et=GPUTextureDimension.TwoD,et}}function getFormat(nt,_e=null){const et=nt.format,rt=nt.type,it=nt.colorSpace;let st;if(nt.isFramebufferTexture===!0&&nt.type===UnsignedByteType)st=GPUTextureFormat.BGRA8Unorm;else if(nt.isCompressedTexture===!0||nt.isCompressedArrayTexture===!0)switch(et){case RGBA_S3TC_DXT1_Format:st=it===SRGBColorSpace?GPUTextureFormat.BC1RGBAUnormSRGB:GPUTextureFormat.BC1RGBAUnorm;break;case RGBA_S3TC_DXT3_Format:st=it===SRGBColorSpace?GPUTextureFormat.BC2RGBAUnormSRGB:GPUTextureFormat.BC2RGBAUnorm;break;case RGBA_S3TC_DXT5_Format:st=it===SRGBColorSpace?GPUTextureFormat.BC3RGBAUnormSRGB:GPUTextureFormat.BC3RGBAUnorm;break;case RGB_ETC2_Format:st=it===SRGBColorSpace?GPUTextureFormat.ETC2RGB8UnormSRGB:GPUTextureFormat.ETC2RGB8Unorm;break;case RGBA_ETC2_EAC_Format:st=it===SRGBColorSpace?GPUTextureFormat.ETC2RGBA8UnormSRGB:GPUTextureFormat.ETC2RGBA8Unorm;break;case RGBA_ASTC_4x4_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC4x4UnormSRGB:GPUTextureFormat.ASTC4x4Unorm;break;case RGBA_ASTC_5x4_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC5x4UnormSRGB:GPUTextureFormat.ASTC5x4Unorm;break;case RGBA_ASTC_5x5_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC5x5UnormSRGB:GPUTextureFormat.ASTC5x5Unorm;break;case RGBA_ASTC_6x5_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC6x5UnormSRGB:GPUTextureFormat.ASTC6x5Unorm;break;case RGBA_ASTC_6x6_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC6x6UnormSRGB:GPUTextureFormat.ASTC6x6Unorm;break;case RGBA_ASTC_8x5_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC8x5UnormSRGB:GPUTextureFormat.ASTC8x5Unorm;break;case RGBA_ASTC_8x6_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC8x6UnormSRGB:GPUTextureFormat.ASTC8x6Unorm;break;case RGBA_ASTC_8x8_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC8x8UnormSRGB:GPUTextureFormat.ASTC8x8Unorm;break;case RGBA_ASTC_10x5_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC10x5UnormSRGB:GPUTextureFormat.ASTC10x5Unorm;break;case RGBA_ASTC_10x6_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC10x6UnormSRGB:GPUTextureFormat.ASTC10x6Unorm;break;case RGBA_ASTC_10x8_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC10x8UnormSRGB:GPUTextureFormat.ASTC10x8Unorm;break;case RGBA_ASTC_10x10_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC10x10UnormSRGB:GPUTextureFormat.ASTC10x10Unorm;break;case RGBA_ASTC_12x10_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC12x10UnormSRGB:GPUTextureFormat.ASTC12x10Unorm;break;case RGBA_ASTC_12x12_Format:st=it===SRGBColorSpace?GPUTextureFormat.ASTC12x12UnormSRGB:GPUTextureFormat.ASTC12x12Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",et)}else switch(et){case RGBAFormat:switch(rt){case ByteType:st=GPUTextureFormat.RGBA8Snorm;break;case ShortType:st=GPUTextureFormat.RGBA16Sint;break;case UnsignedShortType:st=GPUTextureFormat.RGBA16Uint;break;case UnsignedIntType:st=GPUTextureFormat.RGBA32Uint;break;case IntType:st=GPUTextureFormat.RGBA32Sint;break;case UnsignedByteType:st=it===SRGBColorSpace?GPUTextureFormat.RGBA8UnormSRGB:GPUTextureFormat.RGBA8Unorm;break;case HalfFloatType:st=GPUTextureFormat.RGBA16Float;break;case FloatType:st=GPUTextureFormat.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",rt)}break;case RGBFormat:switch(rt){case UnsignedInt5999Type:st=GPUTextureFormat.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",rt)}break;case RedFormat:switch(rt){case ByteType:st=GPUTextureFormat.R8Snorm;break;case ShortType:st=GPUTextureFormat.R16Sint;break;case UnsignedShortType:st=GPUTextureFormat.R16Uint;break;case UnsignedIntType:st=GPUTextureFormat.R32Uint;break;case IntType:st=GPUTextureFormat.R32Sint;break;case UnsignedByteType:st=GPUTextureFormat.R8Unorm;break;case HalfFloatType:st=GPUTextureFormat.R16Float;break;case FloatType:st=GPUTextureFormat.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",rt)}break;case RGFormat:switch(rt){case ByteType:st=GPUTextureFormat.RG8Snorm;break;case ShortType:st=GPUTextureFormat.RG16Sint;break;case UnsignedShortType:st=GPUTextureFormat.RG16Uint;break;case UnsignedIntType:st=GPUTextureFormat.RG32Uint;break;case IntType:st=GPUTextureFormat.RG32Sint;break;case UnsignedByteType:st=GPUTextureFormat.RG8Unorm;break;case HalfFloatType:st=GPUTextureFormat.RG16Float;break;case FloatType:st=GPUTextureFormat.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",rt)}break;case DepthFormat:switch(rt){case UnsignedShortType:st=GPUTextureFormat.Depth16Unorm;break;case UnsignedIntType:st=GPUTextureFormat.Depth24Plus;break;case FloatType:st=GPUTextureFormat.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",rt)}break;case DepthStencilFormat:switch(rt){case UnsignedInt248Type:st=GPUTextureFormat.Depth24PlusStencil8;break;case FloatType:_e&&_e.features.has(GPUFeatureName.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),st=GPUTextureFormat.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",rt)}break;case RedIntegerFormat:switch(rt){case IntType:st=GPUTextureFormat.R32Sint;break;case UnsignedIntType:st=GPUTextureFormat.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",rt)}break;case RGIntegerFormat:switch(rt){case IntType:st=GPUTextureFormat.RG32Sint;break;case UnsignedIntType:st=GPUTextureFormat.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",rt)}break;case RGBAIntegerFormat:switch(rt){case IntType:st=GPUTextureFormat.RGBA32Sint;break;case UnsignedIntType:st=GPUTextureFormat.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",rt)}break;default:console.error("WebGPURenderer: Unsupported texture format.",et)}return st}const declarationRegexp=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,propertiesRegexp=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,wgslTypeLib$1={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},parse=nt=>{nt=nt.trim();const _e=nt.match(declarationRegexp);if(_e!==null&&_e.length===4){const et=_e[2],rt=[];let it=null;for(;(it=propertiesRegexp.exec(et))!==null;)rt.push({name:it[1],type:it[2]});const st=[];for(let ut=0;ut<rt.length;ut++){const{name:ht,type:dt}=rt[ut];let ft=dt;ft.startsWith("texture")&&(ft=dt.split("<")[0]),ft=wgslTypeLib$1[ft]||ft,st.push(new NodeFunctionInput(ft,ht))}const ot=nt.substring(_e[0].length),at=_e[3]||"void",lt=_e[1]!==void 0?_e[1]:"";return{type:wgslTypeLib$1[at]||at,inputs:st,name:lt,inputsCode:et,blockCode:ot,outputType:at}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class WGSLNodeFunction extends NodeFunction{constructor(_e){const{type:et,inputs:rt,name:it,inputsCode:st,blockCode:ot,outputType:at}=parse(_e);super(et,rt,it),this.inputsCode=st,this.blockCode=ot,this.outputType=at}getCode(_e=this.name){const et=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${_e} ( ${this.inputsCode.trim()} ) ${et}`+this.blockCode}}class WGSLNodeParser extends NodeParser{parseFunction(_e){return new WGSLNodeFunction(_e)}}const GPUShaderStage=self.GPUShaderStage,gpuShaderStageLib={vertex:GPUShaderStage?GPUShaderStage.VERTEX:1,fragment:GPUShaderStage?GPUShaderStage.FRAGMENT:2,compute:GPUShaderStage?GPUShaderStage.COMPUTE:4},supports={instance:!0,swizzleAssign:!1,storageBuffer:!0},wgslFnOpLib={"^^":"tsl_xor"},wgslTypeLib={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",imat2:"mat2x2<i32>",umat2:"mat2x2<u32>",bmat2:"mat2x2<bool>",mat3:"mat3x3<f32>",imat3:"mat3x3<i32>",umat3:"mat3x3<u32>",bmat3:"mat3x3<bool>",mat4:"mat4x4<f32>",imat4:"mat4x4<i32>",umat4:"mat4x4<u32>",bmat4:"mat4x4<bool>"},wgslPolyfill={tsl_xor:new CodeNode("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new CodeNode("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new CodeNode("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new CodeNode("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new CodeNode("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new CodeNode("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new CodeNode("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new CodeNode("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new CodeNode("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping:new CodeNode(`
fn tsl_repeatWrapping( uv : vec2<f32>, dimension : vec2<u32> ) -> vec2<u32> {

	let uvScaled = vec2<u32>( uv * vec2<f32>( dimension ) );

	return ( ( uvScaled % dimension ) + dimension ) % dimension;

}
`),biquadraticTexture:new CodeNode(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, level : i32 ) -> vec4f {

	let iRes = vec2i( textureDimensions( map, level ) );
	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2i( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2i( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2i( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2i( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},wgslMethods={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};/Windows/g.test(navigator.userAgent)&&(wgslPolyfill.pow_float=new CodeNode("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),wgslPolyfill.pow_vec2=new CodeNode("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[wgslPolyfill.pow_float]),wgslPolyfill.pow_vec3=new CodeNode("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[wgslPolyfill.pow_float]),wgslPolyfill.pow_vec4=new CodeNode("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[wgslPolyfill.pow_float]),wgslMethods.pow_float="tsl_pow_float",wgslMethods.pow_vec2="tsl_pow_vec2",wgslMethods.pow_vec3="tsl_pow_vec3",wgslMethods.pow_vec4="tsl_pow_vec4");let diagnostics="";/Firefox/g.test(navigator.userAgent)!==!0&&(diagnostics+=`diagnostic( off, derivative_uniformity );
`);class WGSLNodeBuilder extends NodeBuilder{constructor(_e,et){super(_e,et,new WGSLNodeParser),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(_e){return _e.isVideoTexture===!0&&_e.colorSpace!==NoColorSpace}_generateTextureSample(_e,et,rt,it,st=this.shaderStage){return st==="fragment"?it?`textureSample( ${et}, ${et}_sampler, ${rt}, ${it} )`:`textureSample( ${et}, ${et}_sampler, ${rt} )`:this.isFilteredTexture(_e)?this.generateFilteredTexture(_e,et,rt):this.generateTextureLod(_e,et,rt,"0")}_generateVideoSample(_e,et,rt=this.shaderStage){if(rt==="fragment")return`textureSampleBaseClampToEdge( ${_e}, ${_e}_sampler, vec2<f32>( ${et}.x, 1.0 - ${et}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${rt} shader.`)}_generateTextureSampleLevel(_e,et,rt,it,st,ot=this.shaderStage){return ot==="fragment"&&this.isUnfilterable(_e)===!1?`textureSampleLevel( ${et}, ${et}_sampler, ${rt}, ${it} )`:this.isFilteredTexture(_e)?this.generateFilteredTexture(_e,et,rt,it):this.generateTextureLod(_e,et,rt,it)}generateFilteredTexture(_e,et,rt,it="0"){return this._include("biquadraticTexture"),`tsl_biquadraticTexture( ${et}, ${rt}, i32( ${it} ) )`}generateTextureLod(_e,et,rt,it="0"){this._include("repeatWrapping");const st=_e.isMultisampleRenderTargetTexture===!0?`textureDimensions( ${et} )`:`textureDimensions( ${et}, 0 )`;return`textureLoad( ${et}, tsl_repeatWrapping( ${rt}, ${st} ), i32( ${it} ) )`}generateTextureLoad(_e,et,rt,it,st="0u"){return it?`textureLoad( ${et}, ${rt}, ${it}, ${st} )`:`textureLoad( ${et}, ${rt}, ${st} )`}generateTextureStore(_e,et,rt,it){return`textureStore( ${et}, ${rt}, ${it} )`}isUnfilterable(_e){return this.getComponentTypeFromTexture(_e)!=="float"||!this.isAvailable("float32Filterable")&&_e.isDataTexture===!0&&_e.type===FloatType||_e.isMultisampleRenderTargetTexture===!0}generateTexture(_e,et,rt,it,st=this.shaderStage){let ot=null;return _e.isVideoTexture===!0?ot=this._generateVideoSample(et,rt,st):this.isUnfilterable(_e)?ot=this.generateTextureLod(_e,et,rt,"0",it,st):ot=this._generateTextureSample(_e,et,rt,it,st),ot}generateTextureGrad(_e,et,rt,it,st,ot=this.shaderStage){if(ot==="fragment")return`textureSampleGrad( ${et}, ${et}_sampler, ${rt},  ${it[0]}, ${it[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${ot} shader.`)}generateTextureCompare(_e,et,rt,it,st,ot=this.shaderStage){if(ot==="fragment")return`textureSampleCompare( ${et}, ${et}_sampler, ${rt}, ${it} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${ot} shader.`)}generateTextureLevel(_e,et,rt,it,st,ot=this.shaderStage){let at=null;return _e.isVideoTexture===!0?at=this._generateVideoSample(et,rt,ot):at=this._generateTextureSampleLevel(_e,et,rt,it,st,ot),at}generateTextureBias(_e,et,rt,it,st,ot=this.shaderStage){if(ot==="fragment")return`textureSampleBias( ${et}, ${et}_sampler, ${rt}, ${it} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${ot} shader.`)}getPropertyName(_e,et=this.shaderStage){if(_e.isNodeVarying===!0&&_e.needsInterpolation===!0){if(et==="vertex")return`varyings.${_e.name}`}else if(_e.isNodeUniform===!0){const rt=_e.name,it=_e.type;return it==="texture"||it==="cubeTexture"||it==="storageTexture"||it==="texture3D"?rt:it==="buffer"||it==="storageBuffer"?`NodeBuffer_${_e.id}.${rt}`:_e.groupNode.name+"."+rt}return super.getPropertyName(_e)}getOutputStructName(){return"output"}_getUniformGroupCount(_e){return Object.keys(this.uniforms[_e]).length}getFunctionOperator(_e){const et=wgslFnOpLib[_e];return et!==void 0?(this._include(et),et):null}getStorageAccess(_e){if(_e.isStorageTextureNode)switch(_e.access){case GPUStorageTextureAccess.ReadOnly:return"read";case GPUStorageTextureAccess.WriteOnly:return"write";default:return"read_write"}else switch(_e.access){case GPUBufferBindingType.Storage:return"read_write";case GPUBufferBindingType.ReadOnlyStorage:return"read";default:return"write"}}getUniformFromNode(_e,et,rt,it=null){const st=super.getUniformFromNode(_e,et,rt,it),ot=this.getDataFromNode(_e,rt,this.globalCache);if(ot.uniformGPU===void 0){let at;const lt=_e.groupNode,ct=lt.name,ut=this.getBindGroupArray(ct,rt);if(et==="texture"||et==="cubeTexture"||et==="storageTexture"||et==="texture3D"){let ht=null;if(et==="texture"||et==="storageTexture"?ht=new NodeSampledTexture(st.name,st.node,lt,_e.access?_e.access:null):et==="cubeTexture"?ht=new NodeSampledCubeTexture(st.name,st.node,lt,_e.access?_e.access:null):et==="texture3D"&&(ht=new NodeSampledTexture3D(st.name,st.node,lt,_e.access?_e.access:null)),ht.store=_e.isStorageTextureNode===!0,ht.setVisibility(gpuShaderStageLib[rt]),rt==="fragment"&&this.isUnfilterable(_e.value)===!1&&ht.store===!1){const dt=new NodeSampler(`${st.name}_sampler`,st.node,lt);dt.setVisibility(gpuShaderStageLib[rt]),ut.push(dt,ht),at=[dt,ht]}else ut.push(ht),at=[ht]}else if(et==="buffer"||et==="storageBuffer"){const ht=et==="storageBuffer"?NodeStorageBuffer:NodeUniformBuffer,dt=new ht(_e,lt);dt.setVisibility(gpuShaderStageLib[rt]),ut.push(dt),at=dt}else{const ht=this.uniformGroups[rt]||(this.uniformGroups[rt]={});let dt=ht[ct];dt===void 0&&(dt=new NodeUniformsGroup(ct,lt),dt.setVisibility(gpuShaderStageLib[rt]),ht[ct]=dt,ut.push(dt)),at=this.getNodeUniform(st,et),dt.addUniform(at)}ot.uniformGPU=at}return st}getBuiltin(_e,et,rt,it=this.shaderStage){const st=this.builtins[it]||(this.builtins[it]=new Map);return st.has(_e)===!1&&st.set(_e,{name:_e,property:et,type:rt}),et}hasBuiltin(_e,et=this.shaderStage){return this.builtins[et]!==void 0&&this.builtins[et].has(_e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(_e){const et=_e.layout,rt=this.flowShaderNode(_e),it=[];for(const ot of et.inputs)it.push(ot.name+" : "+this.getType(ot.type));let st=`fn ${et.name}( ${it.join(", ")} ) -> ${this.getType(et.type)} {
${rt.vars}
${rt.code}
`;return rt.result&&(st+=`	return ${rt.result};
`),st+=`
}
`,st}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}isFlipY(){return!1}enableDirective(_e,et=this.shaderStage){(this.directives[et]||(this.directives[et]=new Set)).add(_e)}getDirectives(_e){const et=[],rt=this.directives[_e];if(rt!==void 0)for(const it of rt)et.push(`enable ${it};`);return et.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}getBuiltins(_e){const et=[],rt=this.builtins[_e];if(rt!==void 0)for(const{name:it,property:st,type:ot}of rt.values())et.push(`@builtin( ${it} ) ${st} : ${ot}`);return et.join(`,
	`)}getScopedArray(_e,et,rt,it){return this.scopedArrays.has(_e)===!1&&this.scopedArrays.set(_e,{name:_e,scope:et,bufferType:rt,bufferCount:it}),_e}getScopedArrays(_e){if(_e!=="compute")return;const et=[];for(const{name:rt,scope:it,bufferType:st,bufferCount:ot}of this.scopedArrays.values()){const at=this.getType(st);et.push(`var<${it}> ${rt}: array< ${at}, ${ot} >;`)}return et.join(`
`)}getAttributes(_e){const et=[];if(_e==="compute"&&(this.getBuiltin("global_invocation_id","id","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",_e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),_e==="vertex"||_e==="compute"){const rt=this.getBuiltins("attribute");rt&&et.push(rt);const it=this.getAttributesArray();for(let st=0,ot=it.length;st<ot;st++){const at=it[st],lt=at.name,ct=this.getType(at.type);et.push(`@location( ${st} ) ${lt} : ${ct}`)}}return et.join(`,
	`)}getStructMembers(_e){const et=[],rt=_e.getMemberTypes();for(let st=0;st<rt.length;st++){const ot=rt[st];et.push(`	@location( ${st} ) m${st} : ${ot}<f32>`)}const it=this.getBuiltins("output");return it&&et.push("	"+it),et.join(`,
`)}getStructs(_e){const et=[],rt=this.structs[_e];for(let it=0,st=rt.length;it<st;it++){const ot=rt[it],at=ot.name;let lt=`struct ${at} {
`;lt+=this.getStructMembers(ot),lt+=`
}`,et.push(lt),et.push(`
var<private> output : ${at};

`)}return et.join(`

`)}getVar(_e,et){return`var ${et} : ${this.getType(_e)}`}getVars(_e){const et=[],rt=this.vars[_e];if(rt!==void 0)for(const it of rt)et.push(`	${this.getVar(it.type,it.name)};`);return`
${et.join(`
`)}
`}getVaryings(_e){const et=[];if(_e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),_e==="vertex"||_e==="fragment"){const st=this.varyings,ot=this.vars[_e];for(let at=0;at<st.length;at++){const lt=st[at];if(lt.needsInterpolation){let ct=`@location( ${at} )`;/^(int|uint|ivec|uvec)/.test(lt.type)&&(ct+=" @interpolate( flat )"),et.push(`${ct} ${lt.name} : ${this.getType(lt.type)}`)}else _e==="vertex"&&ot.includes(lt)===!1&&ot.push(lt)}}const rt=this.getBuiltins(_e);rt&&et.push(rt);const it=et.join(`,
	`);return _e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+it):it}getUniforms(_e){const et=this.uniforms[_e],rt=[],it=[],st=[],ot={};for(const lt of et){const ct=lt.groupNode.name,ut=this.bindingsIndexes[ct];if(lt.type==="texture"||lt.type==="cubeTexture"||lt.type==="storageTexture"||lt.type==="texture3D"){const ht=lt.node.value;_e==="fragment"&&this.isUnfilterable(ht)===!1&&lt.node.isStorageTextureNode!==!0&&(ht.isDepthTexture===!0&&ht.compareFunction!==null?rt.push(`@binding( ${ut.binding++} ) @group( ${ut.group} ) var ${lt.name}_sampler : sampler_comparison;`):rt.push(`@binding( ${ut.binding++} ) @group( ${ut.group} ) var ${lt.name}_sampler : sampler;`));let dt,ft="";if(ht.isMultisampleRenderTargetTexture===!0&&(ft="_multisampled"),ht.isCubeTexture===!0)dt="texture_cube<f32>";else if(ht.isDataArrayTexture===!0||ht.isCompressedArrayTexture===!0)dt="texture_2d_array<f32>";else if(ht.isDepthTexture===!0)dt=`texture_depth${ft}_2d`;else if(ht.isVideoTexture===!0)dt="texture_external";else if(ht.isData3DTexture===!0)dt="texture_3d<f32>";else if(lt.node.isStorageTextureNode===!0){const pt=getFormat(ht),mt=this.getStorageAccess(lt.node);dt=`texture_storage_2d<${pt}, ${mt}>`}else{const pt=this.getComponentTypeFromTexture(ht).charAt(0);dt=`texture${ft}_2d<${pt}32>`}rt.push(`@binding( ${ut.binding++} ) @group( ${ut.group} ) var ${lt.name} : ${dt};`)}else if(lt.type==="buffer"||lt.type==="storageBuffer"){const ht=lt.node,dt=this.getType(ht.bufferType),ft=ht.bufferCount,pt=ft>0?", "+ft:"",mt=ht.isAtomic?`atomic<${dt}>`:`${dt}`,At=`	${lt.name} : array< ${mt}${pt} >
`,gt=ht.isStorageBufferNode?`storage, ${this.getStorageAccess(ht)}`:"uniform";it.push(this._getWGSLStructBinding("NodeBuffer_"+ht.id,At,gt,ut.binding++,ut.group))}else{const ht=this.getType(this.getVectorType(lt.type)),dt=lt.groupNode.name;(ot[dt]||(ot[dt]={index:ut.binding++,id:ut.group,snippets:[]})).snippets.push(`	${lt.name} : ${ht}`)}}for(const lt in ot){const ct=ot[lt];st.push(this._getWGSLStructBinding(lt,ct.snippets.join(`,
`),"uniform",ct.index,ct.id))}let at=rt.join(`
`);return at+=it.join(`
`),at+=st.join(`
`),at}buildCode(){const _e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const et in _e){const rt=_e[et];rt.uniforms=this.getUniforms(et),rt.attributes=this.getAttributes(et),rt.varyings=this.getVaryings(et),rt.structs=this.getStructs(et),rt.vars=this.getVars(et),rt.codes=this.getCodes(et),rt.directives=this.getDirectives(et),rt.scopedArrays=this.getScopedArrays(et);let it=`// code

`;it+=this.flowCode[et];const st=this.flowNodes[et],ot=st[st.length-1],at=ot.outputNode,lt=at!==void 0&&at.isOutputStructNode===!0;for(const ct of st){const ut=this.getFlowData(ct),ht=ct.name;if(ht&&(it.length>0&&(it+=`
`),it+=`	// flow -> ${ht}
	`),it+=`${ut.code}
	`,ct===ot&&et!=="compute"){if(it+=`// result

	`,et==="vertex")it+=`varyings.Vertex = ${ut.result};`;else if(et==="fragment")if(lt)rt.returnType=at.nodeType,it+=`return ${ut.result};`;else{let dt="	@location(0) color: vec4<f32>";const ft=this.getBuiltins("output");ft&&(dt+=`,
	`+ft),rt.returnType="OutputStruct",rt.structs+=this._getWGSLStruct("OutputStruct",dt),rt.structs+=`
var<private> output : OutputStruct;

`,it+=`output.color = ${ut.result};

	return output;`}}}rt.flow=it}this.material!==null?(this.vertexShader=this._getWGSLVertexCode(_e.vertex),this.fragmentShader=this._getWGSLFragmentCode(_e.fragment)):this.computeShader=this._getWGSLComputeCode(_e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(_e,et=null){let rt;return et!==null&&(rt=this._getWGSLMethod(_e+"_"+et)),rt===void 0&&(rt=this._getWGSLMethod(_e)),rt||_e}getType(_e){return wgslTypeLib[_e]||_e}isAvailable(_e){let et=supports[_e];return et===void 0&&(_e==="float32Filterable"&&(et=this.renderer.hasFeature("float32-filterable")),supports[_e]=et),et}_getWGSLMethod(_e){return wgslPolyfill[_e]!==void 0&&this._include(_e),wgslMethods[_e]}_include(_e){const et=wgslPolyfill[_e];return et.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(et),et}_getWGSLVertexCode(_e){return`${this.getSignature()}
// directives
${_e.directives}

// uniforms
${_e.uniforms}

// varyings
${_e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${_e.codes}

@vertex
fn main( ${_e.attributes} ) -> VaryingsStruct {

	// vars
	${_e.vars}

	// flow
	${_e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(_e){return`${this.getSignature()}
// global
${diagnostics}

// uniforms
${_e.uniforms}

// structs
${_e.structs}

// codes
${_e.codes}

@fragment
fn main( ${_e.varyings} ) -> ${_e.returnType} {

	// vars
	${_e.vars}

	// flow
	${_e.flow}

}
`}_getWGSLComputeCode(_e,et){return`${this.getSignature()}
// directives
${_e.directives}

// system
var<private> instanceIndex : u32;

// locals
${_e.scopedArrays}

// uniforms
${_e.uniforms}

// codes
${_e.codes}

@compute @workgroup_size( ${et} )
fn main( ${_e.attributes} ) {

	// system
	instanceIndex = id.x + id.y * numWorkgroups.x * u32(${et}) + id.z * numWorkgroups.x * numWorkgroups.y * u32(${et});

	// vars
	${_e.vars}

	// flow
	${_e.flow}

}
`}_getWGSLStruct(_e,et){return`
struct ${_e} {
${et}
};`}_getWGSLStructBinding(_e,et,rt,it=0,st=0){const ot=_e+"Struct";return`${this._getWGSLStruct(ot,et)}
@binding( ${it} ) @group( ${st} )
var<${rt}> ${_e} : ${ot};`}}class WebGPUUtils{constructor(_e){this.backend=_e}getCurrentDepthStencilFormat(_e){let et;return _e.depthTexture!==null?et=this.getTextureFormatGPU(_e.depthTexture):_e.depth&&_e.stencil?et=GPUTextureFormat.Depth24PlusStencil8:_e.depth&&(et=GPUTextureFormat.Depth24Plus),et}getTextureFormatGPU(_e){return this.backend.get(_e).format}getCurrentColorFormat(_e){let et;return _e.textures!==null?et=this.getTextureFormatGPU(_e.textures[0]):et=this.getPreferredCanvasFormat(),et}getCurrentColorSpace(_e){return _e.textures!==null?_e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(_e,et){if(_e.isPoints)return GPUPrimitiveTopology.PointList;if(_e.isLineSegments||_e.isMesh&&et.wireframe===!0)return GPUPrimitiveTopology.LineList;if(_e.isLine)return GPUPrimitiveTopology.LineStrip;if(_e.isMesh)return GPUPrimitiveTopology.TriangleList}getSampleCount(_e){let et=1;return _e>1&&(et=Math.pow(2,Math.floor(Math.log2(_e))),et===2&&(et=4)),et}getSampleCountRenderContext(_e){return _e.textures!==null?this.getSampleCount(_e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){return navigator.userAgent.includes("Quest")?GPUTextureFormat.BGRA8Unorm:navigator.gpu.getPreferredCanvasFormat()}}const typedArraysToVertexFormatPrefix=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),typedAttributeToVertexFormatPrefix=new Map([[Float16BufferAttribute,["float16"]]]),typeArraysToVertexFormatPrefixForItemSize1=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class WebGPUAttributeUtils{constructor(_e){this.backend=_e}createAttribute(_e,et){const rt=this._getBufferAttribute(_e),it=this.backend,st=it.get(rt);let ot=st.buffer;if(ot===void 0){const at=it.device;let lt=rt.array;if(_e.normalized===!1&&(lt.constructor===Int16Array||lt.constructor===Uint16Array)){const ut=new Uint32Array(lt.length);for(let ht=0;ht<lt.length;ht++)ut[ht]=lt[ht];lt=ut}if(rt.array=lt,(rt.isStorageBufferAttribute||rt.isStorageInstancedBufferAttribute)&&rt.itemSize===3){lt=new lt.constructor(rt.count*4);for(let ut=0;ut<rt.count;ut++)lt.set(rt.array.subarray(ut*3,ut*3+3),ut*4);rt.itemSize=4,rt.array=lt}const ct=lt.byteLength+(4-lt.byteLength%4)%4;ot=at.createBuffer({label:rt.name,size:ct,usage:et,mappedAtCreation:!0}),new lt.constructor(ot.getMappedRange()).set(lt),ot.unmap(),st.buffer=ot}}updateAttribute(_e){const et=this._getBufferAttribute(_e),rt=this.backend,it=rt.device,st=rt.get(et).buffer,ot=et.array,at=et.updateRanges;if(at.length===0)it.queue.writeBuffer(st,0,ot,0);else{for(let lt=0,ct=at.length;lt<ct;lt++){const ut=at[lt];it.queue.writeBuffer(st,0,ot,ut.start*ot.BYTES_PER_ELEMENT,ut.count*ot.BYTES_PER_ELEMENT)}et.clearUpdateRanges()}}createShaderVertexBuffers(_e){const et=_e.getAttributes(),rt=new Map;for(let it=0;it<et.length;it++){const st=et[it],ot=st.array.BYTES_PER_ELEMENT,at=this._getBufferAttribute(st);let lt=rt.get(at);if(lt===void 0){let ht,dt;st.isInterleavedBufferAttribute===!0?(ht=st.data.stride*ot,dt=st.data.isInstancedInterleavedBuffer?GPUInputStepMode.Instance:GPUInputStepMode.Vertex):(ht=st.itemSize*ot,dt=st.isInstancedBufferAttribute?GPUInputStepMode.Instance:GPUInputStepMode.Vertex),st.normalized===!1&&(st.array.constructor===Int16Array||st.array.constructor===Uint16Array)&&(ht=4),lt={arrayStride:ht,attributes:[],stepMode:dt},rt.set(at,lt)}const ct=this._getVertexFormat(st),ut=st.isInterleavedBufferAttribute===!0?st.offset*ot:0;lt.attributes.push({shaderLocation:it,offset:ut,format:ct})}return Array.from(rt.values())}destroyAttribute(_e){const et=this.backend;et.get(this._getBufferAttribute(_e)).buffer.destroy(),et.delete(_e)}async getArrayBufferAsync(_e){const et=this.backend,rt=et.device,st=et.get(this._getBufferAttribute(_e)).buffer,ot=st.size,at=rt.createBuffer({label:_e.name,size:ot,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),lt=rt.createCommandEncoder({});lt.copyBufferToBuffer(st,0,at,0,ot),at.unmap();const ct=lt.finish();return rt.queue.submit([ct]),await at.mapAsync(GPUMapMode.READ),at.getMappedRange()}_getVertexFormat(_e){const{itemSize:et,normalized:rt}=_e,it=_e.array.constructor,st=_e.constructor;let ot;if(et==1)ot=typeArraysToVertexFormatPrefixForItemSize1.get(it);else{const lt=(typedAttributeToVertexFormatPrefix.get(st)||typedArraysToVertexFormatPrefix.get(it))[rt?1:0];if(lt){const ct=it.BYTES_PER_ELEMENT*et,ht=Math.floor((ct+3)/4)*4/it.BYTES_PER_ELEMENT;if(ht%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");ot=`${lt}x${ht}`}}return ot||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),ot}_getBufferAttribute(_e){return _e.isInterleavedBufferAttribute&&(_e=_e.data),_e}}class WebGPUBindingUtils{constructor(_e){this.backend=_e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(_e){const rt=this.backend.device,it=[];let st=0;for(const ot of _e.bindings){const at={binding:st++,visibility:ot.visibility};if(ot.isUniformBuffer||ot.isStorageBuffer){const lt={};ot.isStorageBuffer&&(lt.type=ot.access),at.buffer=lt}else if(ot.isSampler){const lt={};ot.texture.isDepthTexture&&ot.texture.compareFunction!==null&&(lt.type="comparison"),at.sampler=lt}else if(ot.isSampledTexture&&ot.texture.isVideoTexture)at.externalTexture={};else if(ot.isSampledTexture&&ot.store){const lt=this.backend.get(ot.texture).texture.format,ct=ot.access;at.storageTexture={format:lt,access:ct}}else if(ot.isSampledTexture){const lt={};if(ot.texture.isMultisampleRenderTargetTexture===!0&&(lt.multisampled=!0),ot.texture.isDepthTexture)lt.sampleType=GPUTextureSampleType.Depth;else if(ot.texture.isDataTexture||ot.texture.isDataArrayTexture||ot.texture.isData3DTexture){const ct=ot.texture.type;ct===IntType?lt.sampleType=GPUTextureSampleType.SInt:ct===UnsignedIntType?lt.sampleType=GPUTextureSampleType.UInt:ct===FloatType&&(this.backend.hasFeature("float32-filterable")?lt.sampleType=GPUTextureSampleType.Float:lt.sampleType=GPUTextureSampleType.UnfilterableFloat)}ot.isSampledCubeTexture?lt.viewDimension=GPUTextureViewDimension.Cube:ot.texture.isDataArrayTexture||ot.texture.isCompressedArrayTexture?lt.viewDimension=GPUTextureViewDimension.TwoDArray:ot.isSampledTexture3D&&(lt.viewDimension=GPUTextureViewDimension.ThreeD),at.texture=lt}else console.error(`WebGPUBindingUtils: Unsupported binding "${ot}".`);it.push(at)}return rt.createBindGroupLayout({entries:it})}createBindings(_e){const{backend:et,bindGroupLayoutCache:rt}=this,it=et.get(_e);let st=rt.get(_e.bindingsReference);st===void 0&&(st=this.createBindingsLayout(_e),rt.set(_e.bindingsReference,st));const ot=this.createBindGroup(_e,st);it.layout=st,it.group=ot}updateBinding(_e){const et=this.backend,rt=et.device,it=_e.buffer,st=et.get(_e).buffer;rt.queue.writeBuffer(st,0,it,0)}createBindGroup(_e,et){const rt=this.backend,it=rt.device;let st=0;const ot=[];for(const at of _e.bindings){if(at.isUniformBuffer){const lt=rt.get(at);if(lt.buffer===void 0){const ct=at.byteLength,ut=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,ht=it.createBuffer({label:"bindingBuffer_"+at.name,size:ct,usage:ut});lt.buffer=ht}ot.push({binding:st,resource:{buffer:lt.buffer}})}else if(at.isStorageBuffer){const lt=rt.get(at);if(lt.buffer===void 0){const ct=at.attribute;lt.buffer=rt.get(ct).buffer}ot.push({binding:st,resource:{buffer:lt.buffer}})}else if(at.isSampler){const lt=rt.get(at.texture);ot.push({binding:st,resource:lt.sampler})}else if(at.isSampledTexture){const lt=rt.get(at.texture);let ct;if(lt.externalTexture!==void 0)ct=it.importExternalTexture({source:lt.externalTexture});else{const ut=at.store?1:lt.texture.mipLevelCount,ht=`view-${lt.texture.width}-${lt.texture.height}-${ut}`;if(ct=lt[ht],ct===void 0){const dt=GPUTextureAspect.All;let ft;at.isSampledCubeTexture?ft=GPUTextureViewDimension.Cube:at.isSampledTexture3D?ft=GPUTextureViewDimension.ThreeD:at.texture.isDataArrayTexture||at.texture.isCompressedArrayTexture?ft=GPUTextureViewDimension.TwoDArray:ft=GPUTextureViewDimension.TwoD,ct=lt[ht]=lt.texture.createView({aspect:dt,dimension:ft,mipLevelCount:ut})}}ot.push({binding:st,resource:ct})}st++}return it.createBindGroup({label:"bindGroup_"+_e.name,layout:et,entries:ot})}}class WebGPUPipelineUtils{constructor(_e){this.backend=_e}_getSampleCount(_e){return this.backend.utils.getSampleCountRenderContext(_e)}createRenderPipeline(_e,et){const{object:rt,material:it,geometry:st,pipeline:ot}=_e,{vertexProgram:at,fragmentProgram:lt}=ot,ct=this.backend,ut=ct.device,ht=ct.utils,dt=ct.get(ot),ft=[];for(const Dt of _e.getBindings()){const Ot=ct.get(Dt);ft.push(Ot.layout)}const pt=ct.attributeUtils.createShaderVertexBuffers(_e);let mt;it.transparent===!0&&it.blending!==NoBlending&&(mt=this._getBlending(it));let At={};it.stencilWrite===!0&&(At={compare:this._getStencilCompare(it),failOp:this._getStencilOperation(it.stencilFail),depthFailOp:this._getStencilOperation(it.stencilZFail),passOp:this._getStencilOperation(it.stencilZPass)});const gt=this._getColorWriteMask(it),bt=[];if(_e.context.textures!==null){const Dt=_e.context.textures;for(let Ot=0;Ot<Dt.length;Ot++){const zt=ht.getTextureFormatGPU(Dt[Ot]);bt.push({format:zt,blend:mt,writeMask:gt})}}else{const Dt=ht.getCurrentColorFormat(_e.context);bt.push({format:Dt,blend:mt,writeMask:gt})}const Tt=ct.get(at).module,wt=ct.get(lt).module,Rt=this._getPrimitiveState(rt,st,it),It=this._getDepthCompare(it),Lt=ht.getCurrentDepthStencilFormat(_e.context),$t=this._getSampleCount(_e.context),kt={label:`renderPipeline_${it.name||it.type}_${it.id}`,vertex:Object.assign({},Tt,{buffers:pt}),fragment:Object.assign({},wt,{targets:bt}),primitive:Rt,depthStencil:{format:Lt,depthWriteEnabled:it.depthWrite,depthCompare:It,stencilFront:At,stencilBack:{},stencilReadMask:it.stencilFuncMask,stencilWriteMask:it.stencilWriteMask},multisample:{count:$t,alphaToCoverageEnabled:it.alphaToCoverage&&$t>1},layout:ut.createPipelineLayout({bindGroupLayouts:ft})};if(et===null)dt.pipeline=ut.createRenderPipeline(kt);else{const Dt=new Promise(Ot=>{ut.createRenderPipelineAsync(kt).then(zt=>{dt.pipeline=zt,Ot()})});et.push(Dt)}}createBundleEncoder(_e){const et=this.backend,{utils:rt,device:it}=et,st=rt.getCurrentDepthStencilFormat(_e),ot=rt.getCurrentColorFormat(_e),at=this._getSampleCount(_e),lt={label:"renderBundleEncoder",colorFormats:[ot],depthStencilFormat:st,sampleCount:at};return it.createRenderBundleEncoder(lt)}createComputePipeline(_e,et){const rt=this.backend,it=rt.device,st=rt.get(_e.computeProgram).module,ot=rt.get(_e),at=[];for(const lt of et){const ct=rt.get(lt);at.push(ct.layout)}ot.pipeline=it.createComputePipeline({compute:st,layout:it.createPipelineLayout({bindGroupLayouts:at})})}_getBlending(_e){let et,rt;const it=_e.blending,st=_e.blendSrc,ot=_e.blendDst,at=_e.blendEquation;if(it===CustomBlending){const lt=_e.blendSrcAlpha!==null?_e.blendSrcAlpha:st,ct=_e.blendDstAlpha!==null?_e.blendDstAlpha:ot,ut=_e.blendEquationAlpha!==null?_e.blendEquationAlpha:at;et={srcFactor:this._getBlendFactor(st),dstFactor:this._getBlendFactor(ot),operation:this._getBlendOperation(at)},rt={srcFactor:this._getBlendFactor(lt),dstFactor:this._getBlendFactor(ct),operation:this._getBlendOperation(ut)}}else{const lt=_e.premultipliedAlpha,ct=(ut,ht,dt,ft)=>{et={srcFactor:ut,dstFactor:ht,operation:GPUBlendOperation.Add},rt={srcFactor:dt,dstFactor:ft,operation:GPUBlendOperation.Add}};if(lt)switch(it){case NormalBlending:ct(GPUBlendFactor.One,GPUBlendFactor.OneMinusSrcAlpha,GPUBlendFactor.One,GPUBlendFactor.OneMinusSrcAlpha);break;case AdditiveBlending:ct(GPUBlendFactor.One,GPUBlendFactor.One,GPUBlendFactor.One,GPUBlendFactor.One);break;case SubtractiveBlending:ct(GPUBlendFactor.Zero,GPUBlendFactor.OneMinusSrc,GPUBlendFactor.Zero,GPUBlendFactor.One);break;case MultiplyBlending:ct(GPUBlendFactor.Zero,GPUBlendFactor.Src,GPUBlendFactor.Zero,GPUBlendFactor.SrcAlpha);break}else switch(it){case NormalBlending:ct(GPUBlendFactor.SrcAlpha,GPUBlendFactor.OneMinusSrcAlpha,GPUBlendFactor.One,GPUBlendFactor.OneMinusSrcAlpha);break;case AdditiveBlending:ct(GPUBlendFactor.SrcAlpha,GPUBlendFactor.One,GPUBlendFactor.SrcAlpha,GPUBlendFactor.One);break;case SubtractiveBlending:ct(GPUBlendFactor.Zero,GPUBlendFactor.OneMinusSrc,GPUBlendFactor.Zero,GPUBlendFactor.One);break;case MultiplyBlending:ct(GPUBlendFactor.Zero,GPUBlendFactor.Src,GPUBlendFactor.Zero,GPUBlendFactor.Src);break}}if(et!==void 0&&rt!==void 0)return{color:et,alpha:rt};console.error("THREE.WebGPURenderer: Invalid blending: ",it)}_getBlendFactor(_e){let et;switch(_e){case ZeroFactor:et=GPUBlendFactor.Zero;break;case OneFactor:et=GPUBlendFactor.One;break;case SrcColorFactor:et=GPUBlendFactor.Src;break;case OneMinusSrcColorFactor:et=GPUBlendFactor.OneMinusSrc;break;case SrcAlphaFactor:et=GPUBlendFactor.SrcAlpha;break;case OneMinusSrcAlphaFactor:et=GPUBlendFactor.OneMinusSrcAlpha;break;case DstColorFactor:et=GPUBlendFactor.Dst;break;case OneMinusDstColorFactor:et=GPUBlendFactor.OneMinusDstColor;break;case DstAlphaFactor:et=GPUBlendFactor.DstAlpha;break;case OneMinusDstAlphaFactor:et=GPUBlendFactor.OneMinusDstAlpha;break;case SrcAlphaSaturateFactor:et=GPUBlendFactor.SrcAlphaSaturated;break;case BlendColorFactor:et=GPUBlendFactor.Constant;break;case OneMinusBlendColorFactor:et=GPUBlendFactor.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",_e)}return et}_getStencilCompare(_e){let et;const rt=_e.stencilFunc;switch(rt){case NeverStencilFunc:et=GPUCompareFunction.Never;break;case AlwaysStencilFunc:et=GPUCompareFunction.Always;break;case LessStencilFunc:et=GPUCompareFunction.Less;break;case LessEqualStencilFunc:et=GPUCompareFunction.LessEqual;break;case EqualStencilFunc:et=GPUCompareFunction.Equal;break;case GreaterEqualStencilFunc:et=GPUCompareFunction.GreaterEqual;break;case GreaterStencilFunc:et=GPUCompareFunction.Greater;break;case NotEqualStencilFunc:et=GPUCompareFunction.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",rt)}return et}_getStencilOperation(_e){let et;switch(_e){case KeepStencilOp:et=GPUStencilOperation.Keep;break;case ZeroStencilOp:et=GPUStencilOperation.Zero;break;case ReplaceStencilOp:et=GPUStencilOperation.Replace;break;case InvertStencilOp:et=GPUStencilOperation.Invert;break;case IncrementStencilOp:et=GPUStencilOperation.IncrementClamp;break;case DecrementStencilOp:et=GPUStencilOperation.DecrementClamp;break;case IncrementWrapStencilOp:et=GPUStencilOperation.IncrementWrap;break;case DecrementWrapStencilOp:et=GPUStencilOperation.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",et)}return et}_getBlendOperation(_e){let et;switch(_e){case AddEquation:et=GPUBlendOperation.Add;break;case SubtractEquation:et=GPUBlendOperation.Subtract;break;case ReverseSubtractEquation:et=GPUBlendOperation.ReverseSubtract;break;case MinEquation:et=GPUBlendOperation.Min;break;case MaxEquation:et=GPUBlendOperation.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",_e)}return et}_getPrimitiveState(_e,et,rt){const it={},st=this.backend.utils;switch(it.topology=st.getPrimitiveTopology(_e,rt),et.index!==null&&_e.isLine===!0&&_e.isLineSegments!==!0&&(it.stripIndexFormat=et.index.array instanceof Uint16Array?GPUIndexFormat.Uint16:GPUIndexFormat.Uint32),rt.side){case FrontSide:it.frontFace=GPUFrontFace.CCW,it.cullMode=GPUCullMode.Back;break;case BackSide:it.frontFace=GPUFrontFace.CCW,it.cullMode=GPUCullMode.Front;break;case DoubleSide:it.frontFace=GPUFrontFace.CCW,it.cullMode=GPUCullMode.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",rt.side);break}return it}_getColorWriteMask(_e){return _e.colorWrite===!0?GPUColorWriteFlags.All:GPUColorWriteFlags.None}_getDepthCompare(_e){let et;if(_e.depthTest===!1)et=GPUCompareFunction.Always;else{const rt=_e.depthFunc;switch(rt){case NeverDepth:et=GPUCompareFunction.Never;break;case AlwaysDepth:et=GPUCompareFunction.Always;break;case LessDepth:et=GPUCompareFunction.Less;break;case LessEqualDepth:et=GPUCompareFunction.LessEqual;break;case EqualDepth:et=GPUCompareFunction.Equal;break;case GreaterEqualDepth:et=GPUCompareFunction.GreaterEqual;break;case GreaterDepth:et=GPUCompareFunction.Greater;break;case NotEqualDepth:et=GPUCompareFunction.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",rt)}}return et}}class WebGPUBackend extends Backend{constructor(_e={}){super(_e),this.isWebGPUBackend=!0,this.parameters.alpha=_e.alpha===void 0?!0:_e.alpha,this.parameters.requiredLimits=_e.requiredLimits===void 0?{}:_e.requiredLimits,this.trackTimestamp=_e.trackTimestamp===!0,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new WebGPUUtils(this),this.attributeUtils=new WebGPUAttributeUtils(this),this.bindingUtils=new WebGPUBindingUtils(this),this.pipelineUtils=new WebGPUPipelineUtils(this),this.textureUtils=new WebGPUTextureUtils(this),this.occludedResolveCache=new Map}async init(_e){await super.init(_e);const et=this.parameters;let rt;if(et.device===void 0){const ot={powerPreference:et.powerPreference},at=await navigator.gpu.requestAdapter(ot);if(at===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const lt=Object.values(GPUFeatureName),ct=[];for(const ht of lt)at.features.has(ht)&&ct.push(ht);const ut={requiredFeatures:ct,requiredLimits:et.requiredLimits};rt=await at.requestDevice(ut)}else rt=et.device;const it=et.context!==void 0?et.context:_e.domElement.getContext("webgpu");this.device=rt,this.context=it;const st=et.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(GPUFeatureName.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:st}),this.updateSize()}get coordinateSystem(){return WebGPUCoordinateSystem}async getArrayBufferAsync(_e){return await this.attributeUtils.getArrayBufferAsync(_e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let _e=this.defaultRenderPassdescriptor;if(_e===null){const rt=this.renderer;_e={colorAttachments:[{view:null}],depthStencilAttachment:{view:this.textureUtils.getDepthBuffer(rt.depth,rt.stencil).createView()}};const it=_e.colorAttachments[0];this.renderer.samples>0?it.view=this.colorBuffer.createView():it.resolveTarget=void 0,this.defaultRenderPassdescriptor=_e}const et=_e.colorAttachments[0];return this.renderer.samples>0?et.resolveTarget=this.context.getCurrentTexture().createView():et.view=this.context.getCurrentTexture().createView(),_e}_getRenderPassDescriptor(_e){const et=_e.renderTarget,rt=this.get(et);let it=rt.descriptors;if(it===void 0||rt.width!==et.width||rt.height!==et.height||rt.activeMipmapLevel!==et.activeMipmapLevel||rt.samples!==et.samples){it={},rt.descriptors=it;const at=()=>{et.removeEventListener("dispose",at),this.delete(et)};et.addEventListener("dispose",at)}const st=_e.getCacheKey();let ot=it[st];if(ot===void 0){const at=_e.textures,lt=[];for(let ht=0;ht<at.length;ht++){const dt=this.get(at[ht]),ft=dt.texture.createView({baseMipLevel:_e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:_e.activeCubeFace,dimension:GPUTextureViewDimension.TwoD});let pt,mt;dt.msaaTexture!==void 0?(pt=dt.msaaTexture.createView(),mt=ft):(pt=ft,mt=void 0),lt.push({view:pt,resolveTarget:mt,loadOp:GPULoadOp.Load,storeOp:GPUStoreOp.Store})}const ut={view:this.get(_e.depthTexture).texture.createView()};ot={colorAttachments:lt,depthStencilAttachment:ut},it[st]=ot,rt.width=et.width,rt.height=et.height,rt.samples=et.samples,rt.activeMipmapLevel=et.activeMipmapLevel}return ot}beginRender(_e){const et=this.get(_e),rt=this.device,it=_e.occlusionQueryCount;let st;it>0&&(et.currentOcclusionQuerySet&&et.currentOcclusionQuerySet.destroy(),et.currentOcclusionQueryBuffer&&et.currentOcclusionQueryBuffer.destroy(),et.currentOcclusionQuerySet=et.occlusionQuerySet,et.currentOcclusionQueryBuffer=et.occlusionQueryBuffer,et.currentOcclusionQueryObjects=et.occlusionQueryObjects,st=rt.createQuerySet({type:"occlusion",count:it}),et.occlusionQuerySet=st,et.occlusionQueryIndex=0,et.occlusionQueryObjects=new Array(it),et.lastOcclusionObject=null);let ot;_e.textures===null?ot=this._getDefaultRenderPassDescriptor():ot=this._getRenderPassDescriptor(_e),this.initTimestampQuery(_e,ot),ot.occlusionQuerySet=st;const at=ot.depthStencilAttachment;if(_e.textures!==null){const ut=ot.colorAttachments;for(let ht=0;ht<ut.length;ht++){const dt=ut[ht];_e.clearColor?(dt.clearValue=ht===0?_e.clearColorValue:{r:0,g:0,b:0,a:1},dt.loadOp=GPULoadOp.Clear,dt.storeOp=GPUStoreOp.Store):(dt.loadOp=GPULoadOp.Load,dt.storeOp=GPUStoreOp.Store)}}else{const ut=ot.colorAttachments[0];_e.clearColor?(ut.clearValue=_e.clearColorValue,ut.loadOp=GPULoadOp.Clear,ut.storeOp=GPUStoreOp.Store):(ut.loadOp=GPULoadOp.Load,ut.storeOp=GPUStoreOp.Store)}_e.depth&&(_e.clearDepth?(at.depthClearValue=_e.clearDepthValue,at.depthLoadOp=GPULoadOp.Clear,at.depthStoreOp=GPUStoreOp.Store):(at.depthLoadOp=GPULoadOp.Load,at.depthStoreOp=GPUStoreOp.Store)),_e.stencil&&(_e.clearStencil?(at.stencilClearValue=_e.clearStencilValue,at.stencilLoadOp=GPULoadOp.Clear,at.stencilStoreOp=GPUStoreOp.Store):(at.stencilLoadOp=GPULoadOp.Load,at.stencilStoreOp=GPUStoreOp.Store));const lt=rt.createCommandEncoder({label:"renderContext_"+_e.id}),ct=lt.beginRenderPass(ot);if(et.descriptor=ot,et.encoder=lt,et.currentPass=ct,et.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},et.renderBundles=[],_e.viewport&&this.updateViewport(_e),_e.scissor){const{x:ut,y:ht,width:dt,height:ft}=_e.scissorValue;ct.setScissorRect(ut,ht,dt,ft)}}finishRender(_e){const et=this.get(_e),rt=_e.occlusionQueryCount;if(et.renderBundles.length>0&&et.currentPass.executeBundles(et.renderBundles),rt>et.occlusionQueryIndex&&et.currentPass.endOcclusionQuery(),et.currentPass.end(),rt>0){const it=rt*8;let st=this.occludedResolveCache.get(it);st===void 0&&(st=this.device.createBuffer({size:it,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(it,st));const ot=this.device.createBuffer({size:it,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});et.encoder.resolveQuerySet(et.occlusionQuerySet,0,rt,st,0),et.encoder.copyBufferToBuffer(st,0,ot,0,it),et.occlusionQueryBuffer=ot,this.resolveOccludedAsync(_e)}if(this.prepareTimestampBuffer(_e,et.encoder),this.device.queue.submit([et.encoder.finish()]),_e.textures!==null){const it=_e.textures;for(let st=0;st<it.length;st++){const ot=it[st];ot.generateMipmaps===!0&&this.textureUtils.generateMipmaps(ot)}}}isOccluded(_e,et){const rt=this.get(_e);return rt.occluded&&rt.occluded.has(et)}async resolveOccludedAsync(_e){const et=this.get(_e),{currentOcclusionQueryBuffer:rt,currentOcclusionQueryObjects:it}=et;if(rt&&it){const st=new WeakSet;et.currentOcclusionQueryObjects=null,et.currentOcclusionQueryBuffer=null,await rt.mapAsync(GPUMapMode.READ);const ot=rt.getMappedRange(),at=new BigUint64Array(ot);for(let lt=0;lt<it.length;lt++)at[lt]!==BigInt(0)&&st.add(it[lt]);rt.destroy(),et.occluded=st}}updateViewport(_e){const{currentPass:et}=this.get(_e),{x:rt,y:it,width:st,height:ot,minDepth:at,maxDepth:lt}=_e.viewportValue;et.setViewport(rt,it,st,ot,at,lt)}clear(_e,et,rt,it=null){const st=this.device,ot=this.renderer;let at=[],lt,ct,ut,ht;if(_e){const pt=this.getClearColor();if(this.renderer.alpha===!0){const mt=pt.a;ct={r:pt.r*mt,g:pt.g*mt,b:pt.b*mt,a:mt}}else ct={r:pt.r,g:pt.g,b:pt.b,a:pt.a}}if(it===null){ut=ot.depth,ht=ot.stencil;const pt=this._getDefaultRenderPassDescriptor();if(_e){at=pt.colorAttachments;const mt=at[0];mt.clearValue=ct,mt.loadOp=GPULoadOp.Clear,mt.storeOp=GPUStoreOp.Store}(ut||ht)&&(lt=pt.depthStencilAttachment)}else{if(ut=it.depth,ht=it.stencil,_e)for(const pt of it.textures){const mt=this.get(pt),At=mt.texture.createView();let gt,bt;mt.msaaTexture!==void 0?(gt=mt.msaaTexture.createView(),bt=At):(gt=At,bt=void 0),at.push({view:gt,resolveTarget:bt,clearValue:ct,loadOp:GPULoadOp.Clear,storeOp:GPUStoreOp.Store})}(ut||ht)&&(lt={view:this.get(it.depthTexture).texture.createView()})}ut&&(et?(lt.depthLoadOp=GPULoadOp.Clear,lt.depthClearValue=ot.getClearDepth(),lt.depthStoreOp=GPUStoreOp.Store):(lt.depthLoadOp=GPULoadOp.Load,lt.depthStoreOp=GPUStoreOp.Store)),ht&&(rt?(lt.stencilLoadOp=GPULoadOp.Clear,lt.stencilClearValue=ot.getClearStencil(),lt.stencilStoreOp=GPUStoreOp.Store):(lt.stencilLoadOp=GPULoadOp.Load,lt.stencilStoreOp=GPUStoreOp.Store));const dt=st.createCommandEncoder({});dt.beginRenderPass({colorAttachments:at,depthStencilAttachment:lt}).end(),st.queue.submit([dt.finish()])}beginCompute(_e){const et=this.get(_e),rt={};this.initTimestampQuery(_e,rt),et.cmdEncoderGPU=this.device.createCommandEncoder(),et.passEncoderGPU=et.cmdEncoderGPU.beginComputePass(rt)}compute(_e,et,rt,it){const{passEncoderGPU:st}=this.get(_e),ot=this.get(it).pipeline;st.setPipeline(ot);for(let ut=0,ht=rt.length;ut<ht;ut++){const dt=rt[ut],ft=this.get(dt);st.setBindGroup(ut,ft.group)}const at=this.device.limits.maxComputeWorkgroupsPerDimension,lt=this.get(et);lt.dispatchSize===void 0&&(lt.dispatchSize={x:0,y:1,z:1});const{dispatchSize:ct}=lt;et.dispatchCount>at?(ct.x=Math.min(et.dispatchCount,at),ct.y=Math.ceil(et.dispatchCount/at)):ct.x=et.dispatchCount,st.dispatchWorkgroups(ct.x,ct.y,ct.z)}finishCompute(_e){const et=this.get(_e);et.passEncoderGPU.end(),this.prepareTimestampBuffer(_e,et.cmdEncoderGPU),this.device.queue.submit([et.cmdEncoderGPU.finish()])}draw(_e,et){const{object:rt,context:it,pipeline:st}=_e,ot=_e.getBindings(),at=this.get(it),lt=this.get(st).pipeline,ct=at.currentSets,ut=at.currentPass,ht=_e.getDrawParameters();if(ht===null)return;ct.pipeline!==lt&&(ut.setPipeline(lt),ct.pipeline=lt);const dt=ct.bindingGroups;for(let At=0,gt=ot.length;At<gt;At++){const bt=ot[At],Tt=this.get(bt);dt[bt.index]!==bt.id&&(ut.setBindGroup(bt.index,Tt.group),dt[bt.index]=bt.id)}const ft=_e.getIndex(),pt=ft!==null;if(pt===!0&&ct.index!==ft){const At=this.get(ft).buffer,gt=ft.array instanceof Uint16Array?GPUIndexFormat.Uint16:GPUIndexFormat.Uint32;ut.setIndexBuffer(At,gt),ct.index=ft}const mt=_e.getVertexBuffers();for(let At=0,gt=mt.length;At<gt;At++){const bt=mt[At];if(ct.attributes[At]!==bt){const Tt=this.get(bt).buffer;ut.setVertexBuffer(At,Tt),ct.attributes[At]=bt}}if(at.occlusionQuerySet!==void 0){const At=at.lastOcclusionObject;At!==rt&&(At!==null&&At.occlusionTest===!0&&(ut.endOcclusionQuery(),at.occlusionQueryIndex++),rt.occlusionTest===!0&&(ut.beginOcclusionQuery(at.occlusionQueryIndex),at.occlusionQueryObjects[at.occlusionQueryIndex]=rt),at.lastOcclusionObject=rt)}if(rt.isBatchedMesh===!0){const At=rt._multiDrawStarts,gt=rt._multiDrawCounts,bt=rt._multiDrawCount,Tt=rt._multiDrawInstances,wt=pt?ft.array.BYTES_PER_ELEMENT:1;for(let Rt=0;Rt<bt;Rt++){const It=Tt?Tt[Rt]:1,Lt=It>1?0:Rt;ut.drawIndexed(gt[Rt],It,At[Rt]/wt,0,Lt)}}else if(pt===!0){const{vertexCount:At,instanceCount:gt,firstVertex:bt}=ht;ut.drawIndexed(At,gt,bt,0,0),et.update(rt,At,gt)}else{const{vertexCount:At,instanceCount:gt,firstVertex:bt}=ht;ut.draw(At,gt,bt,0),et.update(rt,At,gt)}}needsRenderUpdate(_e){const et=this.get(_e),{object:rt,material:it}=_e,st=this.utils,ot=st.getSampleCountRenderContext(_e.context),at=st.getCurrentColorSpace(_e.context),lt=st.getCurrentColorFormat(_e.context),ct=st.getCurrentDepthStencilFormat(_e.context),ut=st.getPrimitiveTopology(rt,it);let ht=!1;return(et.material!==it||et.materialVersion!==it.version||et.transparent!==it.transparent||et.blending!==it.blending||et.premultipliedAlpha!==it.premultipliedAlpha||et.blendSrc!==it.blendSrc||et.blendDst!==it.blendDst||et.blendEquation!==it.blendEquation||et.blendSrcAlpha!==it.blendSrcAlpha||et.blendDstAlpha!==it.blendDstAlpha||et.blendEquationAlpha!==it.blendEquationAlpha||et.colorWrite!==it.colorWrite||et.depthWrite!==it.depthWrite||et.depthTest!==it.depthTest||et.depthFunc!==it.depthFunc||et.stencilWrite!==it.stencilWrite||et.stencilFunc!==it.stencilFunc||et.stencilFail!==it.stencilFail||et.stencilZFail!==it.stencilZFail||et.stencilZPass!==it.stencilZPass||et.stencilFuncMask!==it.stencilFuncMask||et.stencilWriteMask!==it.stencilWriteMask||et.side!==it.side||et.alphaToCoverage!==it.alphaToCoverage||et.sampleCount!==ot||et.colorSpace!==at||et.colorFormat!==lt||et.depthStencilFormat!==ct||et.primitiveTopology!==ut||et.clippingContextCacheKey!==_e.clippingContext.cacheKey)&&(et.material=it,et.materialVersion=it.version,et.transparent=it.transparent,et.blending=it.blending,et.premultipliedAlpha=it.premultipliedAlpha,et.blendSrc=it.blendSrc,et.blendDst=it.blendDst,et.blendEquation=it.blendEquation,et.blendSrcAlpha=it.blendSrcAlpha,et.blendDstAlpha=it.blendDstAlpha,et.blendEquationAlpha=it.blendEquationAlpha,et.colorWrite=it.colorWrite,et.depthWrite=it.depthWrite,et.depthTest=it.depthTest,et.depthFunc=it.depthFunc,et.stencilWrite=it.stencilWrite,et.stencilFunc=it.stencilFunc,et.stencilFail=it.stencilFail,et.stencilZFail=it.stencilZFail,et.stencilZPass=it.stencilZPass,et.stencilFuncMask=it.stencilFuncMask,et.stencilWriteMask=it.stencilWriteMask,et.side=it.side,et.alphaToCoverage=it.alphaToCoverage,et.sampleCount=ot,et.colorSpace=at,et.colorFormat=lt,et.depthStencilFormat=ct,et.primitiveTopology=ut,et.clippingContextCacheKey=_e.clippingContext.cacheKey,ht=!0),ht}getRenderCacheKey(_e){const{object:et,material:rt}=_e,it=this.utils,st=_e.context;return[rt.transparent,rt.blending,rt.premultipliedAlpha,rt.blendSrc,rt.blendDst,rt.blendEquation,rt.blendSrcAlpha,rt.blendDstAlpha,rt.blendEquationAlpha,rt.colorWrite,rt.depthWrite,rt.depthTest,rt.depthFunc,rt.stencilWrite,rt.stencilFunc,rt.stencilFail,rt.stencilZFail,rt.stencilZPass,rt.stencilFuncMask,rt.stencilWriteMask,rt.side,it.getSampleCountRenderContext(st),it.getCurrentColorSpace(st),it.getCurrentColorFormat(st),it.getCurrentDepthStencilFormat(st),it.getPrimitiveTopology(et,rt),_e.clippingContext.cacheKey].join()}createSampler(_e){this.textureUtils.createSampler(_e)}destroySampler(_e){this.textureUtils.destroySampler(_e)}createDefaultTexture(_e){this.textureUtils.createDefaultTexture(_e)}createTexture(_e,et){this.textureUtils.createTexture(_e,et)}updateTexture(_e,et){this.textureUtils.updateTexture(_e,et)}generateMipmaps(_e){this.textureUtils.generateMipmaps(_e)}destroyTexture(_e){this.textureUtils.destroyTexture(_e)}copyTextureToBuffer(_e,et,rt,it,st,ot){return this.textureUtils.copyTextureToBuffer(_e,et,rt,it,st,ot)}initTimestampQuery(_e,et){if(!this.trackTimestamp)return;const rt=this.get(_e);if(!rt.timeStampQuerySet){const it=this.device.createQuerySet({type:"timestamp",count:2});Object.assign(et,{timestampWrites:{querySet:it,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1}}),rt.timeStampQuerySet=it}}prepareTimestampBuffer(_e,et){if(!this.trackTimestamp)return;const rt=this.get(_e),it=2*BigInt64Array.BYTES_PER_ELEMENT;rt.currentTimestampQueryBuffers===void 0&&(rt.currentTimestampQueryBuffers={resolveBuffer:this.device.createBuffer({label:"timestamp resolve buffer",size:it,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),resultBuffer:this.device.createBuffer({label:"timestamp result buffer",size:it,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),isMappingPending:!1});const{resolveBuffer:st,resultBuffer:ot,isMappingPending:at}=rt.currentTimestampQueryBuffers;at!==!0&&(et.resolveQuerySet(rt.timeStampQuerySet,0,2,st,0),et.copyBufferToBuffer(st,0,ot,0,it))}async resolveTimestampAsync(_e,et="render"){if(!this.trackTimestamp)return;const rt=this.get(_e);if(rt.currentTimestampQueryBuffers===void 0)return;const{resultBuffer:it,isMappingPending:st}=rt.currentTimestampQueryBuffers;st!==!0&&(rt.currentTimestampQueryBuffers.isMappingPending=!0,it.mapAsync(GPUMapMode.READ).then(()=>{const ot=new BigUint64Array(it.getMappedRange()),at=Number(ot[1]-ot[0])/1e6;this.renderer.info.updateTimestamp(et,at),it.unmap(),rt.currentTimestampQueryBuffers.isMappingPending=!1}))}createNodeBuilder(_e,et){return new WGSLNodeBuilder(_e,et)}createProgram(_e){const et=this.get(_e);et.module={module:this.device.createShaderModule({code:_e.code,label:_e.stage}),entryPoint:"main"}}destroyProgram(_e){this.delete(_e)}createRenderPipeline(_e,et){this.pipelineUtils.createRenderPipeline(_e,et)}createComputePipeline(_e,et){this.pipelineUtils.createComputePipeline(_e,et)}beginBundle(_e){const et=this.get(_e);et._currentPass=et.currentPass,et._currentSets=et.currentSets,et.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},et.currentPass=this.pipelineUtils.createBundleEncoder(_e)}finishBundle(_e,et){const rt=this.get(_e),st=rt.currentPass.finish();this.get(et).bundleGPU=st,rt.currentSets=rt._currentSets,rt.currentPass=rt._currentPass}addBundle(_e,et){this.get(_e).renderBundles.push(this.get(et).bundleGPU)}createBindings(_e){this.bindingUtils.createBindings(_e)}updateBindings(_e){this.bindingUtils.createBindings(_e)}updateBinding(_e){this.bindingUtils.updateBinding(_e)}createIndexAttribute(_e){this.attributeUtils.createAttribute(_e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(_e){this.attributeUtils.createAttribute(_e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(_e){this.attributeUtils.createAttribute(_e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(_e){this.attributeUtils.updateAttribute(_e)}destroyAttribute(_e){this.attributeUtils.destroyAttribute(_e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(_e){return this.device.features.has(_e)}copyTextureToTexture(_e,et,rt=null,it=null,st=0){let ot=0,at=0,lt=0,ct=0,ut=0,ht=0,dt=_e.image.width,ft=_e.image.height;rt!==null&&(ct=rt.x,ut=rt.y,ht=rt.z||0,dt=rt.width,ft=rt.height),it!==null&&(ot=it.x,at=it.y,lt=it.z||0);const pt=this.device.createCommandEncoder({label:"copyTextureToTexture_"+_e.id+"_"+et.id}),mt=this.get(_e).texture,At=this.get(et).texture;pt.copyTextureToTexture({texture:mt,mipLevel:st,origin:{x:ct,y:ut,z:ht}},{texture:At,mipLevel:st,origin:{x:ot,y:at,z:lt}},[dt,ft,1]),this.device.queue.submit([pt.finish()])}copyFramebufferToTexture(_e,et,rt){const it=this.get(et),{encoder:st,descriptor:ot}=it;let at=null;et.renderTarget?_e.isDepthTexture?at=this.get(et.depthTexture).texture:at=this.get(et.textures[0]).texture:_e.isDepthTexture?at=this.textureUtils.getDepthBuffer(et.depth,et.stencil):at=this.context.getCurrentTexture();const lt=this.get(_e).texture;if(at.format!==lt.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",at.format,lt.format);return}it.currentPass.end(),st.copyTextureToTexture({texture:at,origin:{x:rt.x,y:rt.y,z:0}},{texture:lt},[rt.z,rt.w]),_e.generateMipmaps&&this.textureUtils.generateMipmaps(_e);for(let ct=0;ct<ot.colorAttachments.length;ct++)ot.colorAttachments[ct].loadOp=GPULoadOp.Load;et.depth&&(ot.depthStencilAttachment.depthLoadOp=GPULoadOp.Load),et.stencil&&(ot.depthStencilAttachment.stencilLoadOp=GPULoadOp.Load),it.currentPass=st.beginRenderPass(ot),it.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null}}}class IESSpotLight extends SpotLight{constructor(_e,et,rt,it,st,ot){super(_e,et,rt,it,st,ot),this.iesMap=null}copy(_e,et){return super.copy(_e,et),this.iesMap=_e.iesMap,this}}class StandardNodeLibrary extends NodeLibrary{constructor(){super(),this.addMaterial(MeshPhongNodeMaterial,MeshPhongMaterial),this.addMaterial(MeshStandardNodeMaterial,MeshStandardMaterial),this.addMaterial(MeshPhysicalNodeMaterial,MeshPhysicalMaterial),this.addMaterial(MeshToonNodeMaterial,MeshToonMaterial),this.addMaterial(MeshBasicNodeMaterial,MeshBasicMaterial),this.addMaterial(MeshLambertNodeMaterial,MeshLambertMaterial),this.addMaterial(MeshNormalNodeMaterial,MeshNormalMaterial),this.addMaterial(MeshMatcapNodeMaterial,MeshMatcapMaterial),this.addMaterial(LineBasicNodeMaterial,LineBasicMaterial),this.addMaterial(LineDashedNodeMaterial,LineDashedMaterial),this.addMaterial(PointsNodeMaterial,PointsMaterial),this.addMaterial(SpriteNodeMaterial,SpriteMaterial),this.addMaterial(ShadowNodeMaterial,ShadowMaterial),this.addLight(PointLightNode,PointLight),this.addLight(DirectionalLightNode,DirectionalLight),this.addLight(RectAreaLightNode,RectAreaLight),this.addLight(SpotLightNode,SpotLight),this.addLight(AmbientLightNode,AmbientLight),this.addLight(HemisphereLightNode,HemisphereLight),this.addLight(LightProbeNode,LightProbe),this.addLight(IESSpotLightNode,IESSpotLight),this.addToneMapping(linearToneMapping,LinearToneMapping),this.addToneMapping(reinhardToneMapping,ReinhardToneMapping),this.addToneMapping(cineonToneMapping,CineonToneMapping),this.addToneMapping(acesFilmicToneMapping,ACESFilmicToneMapping),this.addToneMapping(agxToneMapping,AgXToneMapping),this.addToneMapping(neutralToneMapping,NeutralToneMapping),this.addColorSpace(linearSRGBTosRGB,getColorSpaceMethod(LinearSRGBColorSpace,SRGBColorSpace)),this.addColorSpace(sRGBToLinearSRGB,getColorSpaceMethod(SRGBColorSpace,LinearSRGBColorSpace))}}class WebGPURenderer extends Renderer{constructor(_e={}){let et;_e.forceWebGL?et=WebGLBackend:(et=WebGPUBackend,_e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new WebGLBackend(_e)));const rt=new et(_e);super(rt,_e),this.nodes.library=new StandardNodeLibrary,this.isWebGPURenderer=!0}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const _changeEvent$2={type:"change"},_startEvent$1={type:"start"},_endEvent$1={type:"end"},_EPS$2=1e-6,_STATE$1={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},_v2=new Vector2$1,_mouseChange=new Vector2$1,_objectUp=new Vector3$1,_pan=new Vector3$1,_axis=new Vector3$1,_quaternion=new Quaternion$1,_eyeDirection=new Vector3$1,_objectUpDirection=new Vector3$1,_objectSidewaysDirection=new Vector3$1,_moveDirection=new Vector3$1;class TrackballControls extends Controls{constructor(_e,et=null){super(_e,et),this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN},this.state=_STATE$1.NONE,this.keyState=_STATE$1.NONE,this.target=new Vector3$1,this._lastPosition=new Vector3$1,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new Vector3$1,this._movePrev=new Vector2$1,this._moveCurr=new Vector2$1,this._lastAxis=new Vector3$1,this._zoomStart=new Vector2$1,this._zoomEnd=new Vector2$1,this._panStart=new Vector2$1,this._panEnd=new Vector2$1,this._pointers=[],this._pointerPositions={},this._onPointerMove=onPointerMove$2.bind(this),this._onPointerDown=onPointerDown$2.bind(this),this._onPointerUp=onPointerUp$2.bind(this),this._onPointerCancel=onPointerCancel$1.bind(this),this._onContextMenu=onContextMenu$2.bind(this),this._onMouseWheel=onMouseWheel$1.bind(this),this._onKeyDown=onKeyDown$2.bind(this),this._onKeyUp=onKeyUp$1.bind(this),this._onTouchStart=onTouchStart$1.bind(this),this._onTouchMove=onTouchMove$1.bind(this),this._onTouchEnd=onTouchEnd.bind(this),this._onMouseDown=onMouseDown$1.bind(this),this._onMouseMove=onMouseMove$1.bind(this),this._onMouseUp=onMouseUp.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,et!==null&&(this.connect(),this.handleResize()),this.update()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const _e=this.domElement.getBoundingClientRect(),et=this.domElement.ownerDocument.documentElement;this.screen.left=_e.left+window.pageXOffset-et.clientLeft,this.screen.top=_e.top+window.pageYOffset-et.clientTop,this.screen.width=_e.width,this.screen.height=_e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>_EPS$2&&(this.dispatchEvent(_changeEvent$2),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>_EPS$2||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(_changeEvent$2),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=_STATE$1.NONE,this.keyState=_STATE$1.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(_changeEvent$2),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(_mouseChange.copy(this._panEnd).sub(this._panStart),_mouseChange.lengthSq()){if(this.object.isOrthographicCamera){const _e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,et=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;_mouseChange.x*=_e,_mouseChange.y*=et}_mouseChange.multiplyScalar(this._eye.length()*this.panSpeed),_pan.copy(this._eye).cross(this.object.up).setLength(_mouseChange.x),_pan.add(_objectUp.copy(this.object.up).setLength(_mouseChange.y)),this.object.position.add(_pan),this.target.add(_pan),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(_mouseChange.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){_moveDirection.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let _e=_moveDirection.length();_e?(this._eye.copy(this.object.position).sub(this.target),_eyeDirection.copy(this._eye).normalize(),_objectUpDirection.copy(this.object.up).normalize(),_objectSidewaysDirection.crossVectors(_objectUpDirection,_eyeDirection).normalize(),_objectUpDirection.setLength(this._moveCurr.y-this._movePrev.y),_objectSidewaysDirection.setLength(this._moveCurr.x-this._movePrev.x),_moveDirection.copy(_objectUpDirection.add(_objectSidewaysDirection)),_axis.crossVectors(_moveDirection,this._eye).normalize(),_e*=this.rotateSpeed,_quaternion.setFromAxisAngle(_axis,_e),this._eye.applyQuaternion(_quaternion),this.object.up.applyQuaternion(_quaternion),this._lastAxis.copy(_axis),this._lastAngle=_e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),_quaternion.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(_quaternion),this.object.up.applyQuaternion(_quaternion)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let _e;this.state===_STATE$1.TOUCH_ZOOM_PAN?(_e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(_e):this.object.isOrthographicCamera?(this.object.zoom=MathUtils$1.clamp(this.object.zoom/_e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(_e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,_e!==1&&_e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(_e):this.object.isOrthographicCamera?(this.object.zoom=MathUtils$1.clamp(this.object.zoom/_e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(_e,et){return _v2.set((_e-this.screen.left)/this.screen.width,(et-this.screen.top)/this.screen.height),_v2}_getMouseOnCircle(_e,et){return _v2.set((_e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-et))/this.screen.width),_v2}_addPointer(_e){this._pointers.push(_e)}_removePointer(_e){delete this._pointerPositions[_e.pointerId];for(let et=0;et<this._pointers.length;et++)if(this._pointers[et].pointerId==_e.pointerId){this._pointers.splice(et,1);return}}_trackPointer(_e){let et=this._pointerPositions[_e.pointerId];et===void 0&&(et=new Vector2$1,this._pointerPositions[_e.pointerId]=et),et.set(_e.pageX,_e.pageY)}_getSecondPointerPosition(_e){const et=_e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[et.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function onPointerDown$2(nt){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(nt.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(nt),nt.pointerType==="touch"?this._onTouchStart(nt):this._onMouseDown(nt))}function onPointerMove$2(nt){this.enabled!==!1&&(nt.pointerType==="touch"?this._onTouchMove(nt):this._onMouseMove(nt))}function onPointerUp$2(nt){this.enabled!==!1&&(nt.pointerType==="touch"?this._onTouchEnd(nt):this._onMouseUp(),this._removePointer(nt),this._pointers.length===0&&(this.domElement.releasePointerCapture(nt.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function onPointerCancel$1(nt){this._removePointer(nt)}function onKeyUp$1(){this.enabled!==!1&&(this.keyState=_STATE$1.NONE,window.addEventListener("keydown",this._onKeyDown))}function onKeyDown$2(nt){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===_STATE$1.NONE&&(nt.code===this.keys[_STATE$1.ROTATE]&&!this.noRotate?this.keyState=_STATE$1.ROTATE:nt.code===this.keys[_STATE$1.ZOOM]&&!this.noZoom?this.keyState=_STATE$1.ZOOM:nt.code===this.keys[_STATE$1.PAN]&&!this.noPan&&(this.keyState=_STATE$1.PAN)))}function onMouseDown$1(nt){let _e;switch(nt.button){case 0:_e=this.mouseButtons.LEFT;break;case 1:_e=this.mouseButtons.MIDDLE;break;case 2:_e=this.mouseButtons.RIGHT;break;default:_e=-1}switch(_e){case MOUSE.DOLLY:this.state=_STATE$1.ZOOM;break;case MOUSE.ROTATE:this.state=_STATE$1.ROTATE;break;case MOUSE.PAN:this.state=_STATE$1.PAN;break;default:this.state=_STATE$1.NONE}const et=this.keyState!==_STATE$1.NONE?this.keyState:this.state;et===_STATE$1.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(nt.pageX,nt.pageY)),this._movePrev.copy(this._moveCurr)):et===_STATE$1.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(nt.pageX,nt.pageY)),this._zoomEnd.copy(this._zoomStart)):et===_STATE$1.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(nt.pageX,nt.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(_startEvent$1)}function onMouseMove$1(nt){const _e=this.keyState!==_STATE$1.NONE?this.keyState:this.state;_e===_STATE$1.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(nt.pageX,nt.pageY))):_e===_STATE$1.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(nt.pageX,nt.pageY)):_e===_STATE$1.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(nt.pageX,nt.pageY))}function onMouseUp(){this.state=_STATE$1.NONE,this.dispatchEvent(_endEvent$1)}function onMouseWheel$1(nt){if(this.enabled!==!1&&this.noZoom!==!0){switch(nt.preventDefault(),nt.deltaMode){case 2:this._zoomStart.y-=nt.deltaY*.025;break;case 1:this._zoomStart.y-=nt.deltaY*.01;break;default:this._zoomStart.y-=nt.deltaY*25e-5;break}this.dispatchEvent(_startEvent$1),this.dispatchEvent(_endEvent$1)}}function onContextMenu$2(nt){this.enabled!==!1&&nt.preventDefault()}function onTouchStart$1(nt){switch(this._trackPointer(nt),this._pointers.length){case 1:this.state=_STATE$1.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=_STATE$1.TOUCH_ZOOM_PAN;const _e=this._pointers[0].pageX-this._pointers[1].pageX,et=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(_e*_e+et*et);const rt=(this._pointers[0].pageX+this._pointers[1].pageX)/2,it=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(rt,it)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(_startEvent$1)}function onTouchMove$1(nt){switch(this._trackPointer(nt),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(nt.pageX,nt.pageY));break;default:const _e=this._getSecondPointerPosition(nt),et=nt.pageX-_e.x,rt=nt.pageY-_e.y;this._touchZoomDistanceEnd=Math.sqrt(et*et+rt*rt);const it=(nt.pageX+_e.x)/2,st=(nt.pageY+_e.y)/2;this._panEnd.copy(this._getMouseOnScreen(it,st));break}}function onTouchEnd(nt){switch(this._pointers.length){case 0:this.state=_STATE$1.NONE;break;case 1:this.state=_STATE$1.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(nt.pageX,nt.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=_STATE$1.TOUCH_ZOOM_PAN;for(let _e=0;_e<this._pointers.length;_e++)if(this._pointers[_e].pointerId!==nt.pointerId){const et=this._pointerPositions[this._pointers[_e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(et.x,et.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(_endEvent$1)}const _changeEvent$1={type:"change"},_startEvent={type:"start"},_endEvent={type:"end"},_ray=new Ray$1,_plane=new Plane$1,_TILT_LIMIT=Math.cos(70*MathUtils$1.DEG2RAD),_v=new Vector3$1,_twoPI=2*Math.PI,_STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},_EPS$1=1e-6;class OrbitControls extends Controls{constructor(_e,et=null){super(_e,et),this.state=_STATE.NONE,this.enabled=!0,this.target=new Vector3$1,this.cursor=new Vector3$1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN},this.touches={ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Vector3$1,this._lastQuaternion=new Quaternion$1,this._lastTargetPosition=new Vector3$1,this._quat=new Quaternion$1().setFromUnitVectors(_e.up,new Vector3$1(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Spherical,this._sphericalDelta=new Spherical,this._scale=1,this._panOffset=new Vector3$1,this._rotateStart=new Vector2$1,this._rotateEnd=new Vector2$1,this._rotateDelta=new Vector2$1,this._panStart=new Vector2$1,this._panEnd=new Vector2$1,this._panDelta=new Vector2$1,this._dollyStart=new Vector2$1,this._dollyEnd=new Vector2$1,this._dollyDelta=new Vector2$1,this._dollyDirection=new Vector3$1,this._mouse=new Vector2$1,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=onPointerMove$1.bind(this),this._onPointerDown=onPointerDown$1.bind(this),this._onPointerUp=onPointerUp$1.bind(this),this._onContextMenu=onContextMenu$1.bind(this),this._onMouseWheel=onMouseWheel.bind(this),this._onKeyDown=onKeyDown$1.bind(this),this._onTouchStart=onTouchStart.bind(this),this._onTouchMove=onTouchMove.bind(this),this._onMouseDown=onMouseDown.bind(this),this._onMouseMove=onMouseMove.bind(this),this._interceptControlDown=interceptControlDown.bind(this),this._interceptControlUp=interceptControlUp.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(_e){_e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=_e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(_changeEvent$1),this.update(),this.state=_STATE.NONE}update(_e=null){const et=this.object.position;_v.copy(et).sub(this.target),_v.applyQuaternion(this._quat),this._spherical.setFromVector3(_v),this.autoRotate&&this.state===_STATE.NONE&&this._rotateLeft(this._getAutoRotationAngle(_e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let rt=this.minAzimuthAngle,it=this.maxAzimuthAngle;isFinite(rt)&&isFinite(it)&&(rt<-Math.PI?rt+=_twoPI:rt>Math.PI&&(rt-=_twoPI),it<-Math.PI?it+=_twoPI:it>Math.PI&&(it-=_twoPI),rt<=it?this._spherical.theta=Math.max(rt,Math.min(it,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(rt+it)/2?Math.max(rt,this._spherical.theta):Math.min(it,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let st=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const ot=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),st=ot!=this._spherical.radius}if(_v.setFromSpherical(this._spherical),_v.applyQuaternion(this._quatInverse),et.copy(this.target).add(_v),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let ot=null;if(this.object.isPerspectiveCamera){const at=_v.length();ot=this._clampDistance(at*this._scale);const lt=at-ot;this.object.position.addScaledVector(this._dollyDirection,lt),this.object.updateMatrixWorld(),st=!!lt}else if(this.object.isOrthographicCamera){const at=new Vector3$1(this._mouse.x,this._mouse.y,0);at.unproject(this.object);const lt=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),st=lt!==this.object.zoom;const ct=new Vector3$1(this._mouse.x,this._mouse.y,0);ct.unproject(this.object),this.object.position.sub(ct).add(at),this.object.updateMatrixWorld(),ot=_v.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;ot!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(ot).add(this.object.position):(_ray.origin.copy(this.object.position),_ray.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(_ray.direction))<_TILT_LIMIT?this.object.lookAt(this.target):(_plane.setFromNormalAndCoplanarPoint(this.object.up,this.target),_ray.intersectPlane(_plane,this.target))))}else if(this.object.isOrthographicCamera){const ot=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),ot!==this.object.zoom&&(this.object.updateProjectionMatrix(),st=!0)}return this._scale=1,this._performCursorZoom=!1,st||this._lastPosition.distanceToSquared(this.object.position)>_EPS$1||8*(1-this._lastQuaternion.dot(this.object.quaternion))>_EPS$1||this._lastTargetPosition.distanceToSquared(this.target)>_EPS$1?(this.dispatchEvent(_changeEvent$1),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(_e){return _e!==null?_twoPI/60*this.autoRotateSpeed*_e:_twoPI/60/60*this.autoRotateSpeed}_getZoomScale(_e){const et=Math.abs(_e*.01);return Math.pow(.95,this.zoomSpeed*et)}_rotateLeft(_e){this._sphericalDelta.theta-=_e}_rotateUp(_e){this._sphericalDelta.phi-=_e}_panLeft(_e,et){_v.setFromMatrixColumn(et,0),_v.multiplyScalar(-_e),this._panOffset.add(_v)}_panUp(_e,et){this.screenSpacePanning===!0?_v.setFromMatrixColumn(et,1):(_v.setFromMatrixColumn(et,0),_v.crossVectors(this.object.up,_v)),_v.multiplyScalar(_e),this._panOffset.add(_v)}_pan(_e,et){const rt=this.domElement;if(this.object.isPerspectiveCamera){const it=this.object.position;_v.copy(it).sub(this.target);let st=_v.length();st*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*_e*st/rt.clientHeight,this.object.matrix),this._panUp(2*et*st/rt.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(_e*(this.object.right-this.object.left)/this.object.zoom/rt.clientWidth,this.object.matrix),this._panUp(et*(this.object.top-this.object.bottom)/this.object.zoom/rt.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(_e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=_e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(_e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=_e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(_e,et){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const rt=this.domElement.getBoundingClientRect(),it=_e-rt.left,st=et-rt.top,ot=rt.width,at=rt.height;this._mouse.x=it/ot*2-1,this._mouse.y=-(st/at)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(_e){return Math.max(this.minDistance,Math.min(this.maxDistance,_e))}_handleMouseDownRotate(_e){this._rotateStart.set(_e.clientX,_e.clientY)}_handleMouseDownDolly(_e){this._updateZoomParameters(_e.clientX,_e.clientX),this._dollyStart.set(_e.clientX,_e.clientY)}_handleMouseDownPan(_e){this._panStart.set(_e.clientX,_e.clientY)}_handleMouseMoveRotate(_e){this._rotateEnd.set(_e.clientX,_e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const et=this.domElement;this._rotateLeft(_twoPI*this._rotateDelta.x/et.clientHeight),this._rotateUp(_twoPI*this._rotateDelta.y/et.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(_e){this._dollyEnd.set(_e.clientX,_e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(_e){this._panEnd.set(_e.clientX,_e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(_e){this._updateZoomParameters(_e.clientX,_e.clientY),_e.deltaY<0?this._dollyIn(this._getZoomScale(_e.deltaY)):_e.deltaY>0&&this._dollyOut(this._getZoomScale(_e.deltaY)),this.update()}_handleKeyDown(_e){let et=!1;switch(_e.code){case this.keys.UP:_e.ctrlKey||_e.metaKey||_e.shiftKey?this._rotateUp(_twoPI*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),et=!0;break;case this.keys.BOTTOM:_e.ctrlKey||_e.metaKey||_e.shiftKey?this._rotateUp(-_twoPI*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),et=!0;break;case this.keys.LEFT:_e.ctrlKey||_e.metaKey||_e.shiftKey?this._rotateLeft(_twoPI*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),et=!0;break;case this.keys.RIGHT:_e.ctrlKey||_e.metaKey||_e.shiftKey?this._rotateLeft(-_twoPI*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),et=!0;break}et&&(_e.preventDefault(),this.update())}_handleTouchStartRotate(_e){if(this._pointers.length===1)this._rotateStart.set(_e.pageX,_e.pageY);else{const et=this._getSecondPointerPosition(_e),rt=.5*(_e.pageX+et.x),it=.5*(_e.pageY+et.y);this._rotateStart.set(rt,it)}}_handleTouchStartPan(_e){if(this._pointers.length===1)this._panStart.set(_e.pageX,_e.pageY);else{const et=this._getSecondPointerPosition(_e),rt=.5*(_e.pageX+et.x),it=.5*(_e.pageY+et.y);this._panStart.set(rt,it)}}_handleTouchStartDolly(_e){const et=this._getSecondPointerPosition(_e),rt=_e.pageX-et.x,it=_e.pageY-et.y,st=Math.sqrt(rt*rt+it*it);this._dollyStart.set(0,st)}_handleTouchStartDollyPan(_e){this.enableZoom&&this._handleTouchStartDolly(_e),this.enablePan&&this._handleTouchStartPan(_e)}_handleTouchStartDollyRotate(_e){this.enableZoom&&this._handleTouchStartDolly(_e),this.enableRotate&&this._handleTouchStartRotate(_e)}_handleTouchMoveRotate(_e){if(this._pointers.length==1)this._rotateEnd.set(_e.pageX,_e.pageY);else{const rt=this._getSecondPointerPosition(_e),it=.5*(_e.pageX+rt.x),st=.5*(_e.pageY+rt.y);this._rotateEnd.set(it,st)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const et=this.domElement;this._rotateLeft(_twoPI*this._rotateDelta.x/et.clientHeight),this._rotateUp(_twoPI*this._rotateDelta.y/et.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(_e){if(this._pointers.length===1)this._panEnd.set(_e.pageX,_e.pageY);else{const et=this._getSecondPointerPosition(_e),rt=.5*(_e.pageX+et.x),it=.5*(_e.pageY+et.y);this._panEnd.set(rt,it)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(_e){const et=this._getSecondPointerPosition(_e),rt=_e.pageX-et.x,it=_e.pageY-et.y,st=Math.sqrt(rt*rt+it*it);this._dollyEnd.set(0,st),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const ot=(_e.pageX+et.x)*.5,at=(_e.pageY+et.y)*.5;this._updateZoomParameters(ot,at)}_handleTouchMoveDollyPan(_e){this.enableZoom&&this._handleTouchMoveDolly(_e),this.enablePan&&this._handleTouchMovePan(_e)}_handleTouchMoveDollyRotate(_e){this.enableZoom&&this._handleTouchMoveDolly(_e),this.enableRotate&&this._handleTouchMoveRotate(_e)}_addPointer(_e){this._pointers.push(_e.pointerId)}_removePointer(_e){delete this._pointerPositions[_e.pointerId];for(let et=0;et<this._pointers.length;et++)if(this._pointers[et]==_e.pointerId){this._pointers.splice(et,1);return}}_isTrackingPointer(_e){for(let et=0;et<this._pointers.length;et++)if(this._pointers[et]==_e.pointerId)return!0;return!1}_trackPointer(_e){let et=this._pointerPositions[_e.pointerId];et===void 0&&(et=new Vector2$1,this._pointerPositions[_e.pointerId]=et),et.set(_e.pageX,_e.pageY)}_getSecondPointerPosition(_e){const et=_e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[et]}_customWheelEvent(_e){const et=_e.deltaMode,rt={clientX:_e.clientX,clientY:_e.clientY,deltaY:_e.deltaY};switch(et){case 1:rt.deltaY*=16;break;case 2:rt.deltaY*=100;break}return _e.ctrlKey&&!this._controlActive&&(rt.deltaY*=10),rt}}function onPointerDown$1(nt){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(nt.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(nt)&&(this._addPointer(nt),nt.pointerType==="touch"?this._onTouchStart(nt):this._onMouseDown(nt)))}function onPointerMove$1(nt){this.enabled!==!1&&(nt.pointerType==="touch"?this._onTouchMove(nt):this._onMouseMove(nt))}function onPointerUp$1(nt){switch(this._removePointer(nt),this._pointers.length){case 0:this.domElement.releasePointerCapture(nt.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(_endEvent),this.state=_STATE.NONE;break;case 1:const _e=this._pointers[0],et=this._pointerPositions[_e];this._onTouchStart({pointerId:_e,pageX:et.x,pageY:et.y});break}}function onMouseDown(nt){let _e;switch(nt.button){case 0:_e=this.mouseButtons.LEFT;break;case 1:_e=this.mouseButtons.MIDDLE;break;case 2:_e=this.mouseButtons.RIGHT;break;default:_e=-1}switch(_e){case MOUSE.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(nt),this.state=_STATE.DOLLY;break;case MOUSE.ROTATE:if(nt.ctrlKey||nt.metaKey||nt.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(nt),this.state=_STATE.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(nt),this.state=_STATE.ROTATE}break;case MOUSE.PAN:if(nt.ctrlKey||nt.metaKey||nt.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(nt),this.state=_STATE.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(nt),this.state=_STATE.PAN}break;default:this.state=_STATE.NONE}this.state!==_STATE.NONE&&this.dispatchEvent(_startEvent)}function onMouseMove(nt){switch(this.state){case _STATE.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(nt);break;case _STATE.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(nt);break;case _STATE.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(nt);break}}function onMouseWheel(nt){this.enabled===!1||this.enableZoom===!1||this.state!==_STATE.NONE||(nt.preventDefault(),this.dispatchEvent(_startEvent),this._handleMouseWheel(this._customWheelEvent(nt)),this.dispatchEvent(_endEvent))}function onKeyDown$1(nt){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(nt)}function onTouchStart(nt){switch(this._trackPointer(nt),this._pointers.length){case 1:switch(this.touches.ONE){case TOUCH.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(nt),this.state=_STATE.TOUCH_ROTATE;break;case TOUCH.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(nt),this.state=_STATE.TOUCH_PAN;break;default:this.state=_STATE.NONE}break;case 2:switch(this.touches.TWO){case TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(nt),this.state=_STATE.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(nt),this.state=_STATE.TOUCH_DOLLY_ROTATE;break;default:this.state=_STATE.NONE}break;default:this.state=_STATE.NONE}this.state!==_STATE.NONE&&this.dispatchEvent(_startEvent)}function onTouchMove(nt){switch(this._trackPointer(nt),this.state){case _STATE.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(nt),this.update();break;case _STATE.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(nt),this.update();break;case _STATE.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(nt),this.update();break;case _STATE.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(nt),this.update();break;default:this.state=_STATE.NONE}}function onContextMenu$1(nt){this.enabled!==!1&&nt.preventDefault()}function interceptControlDown(nt){nt.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function interceptControlUp(nt){nt.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const _changeEvent={type:"change"},_EPS=1e-6,_tmpQuaternion=new Quaternion$1;class FlyControls extends Controls{constructor(_e,et=null){super(_e,et),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new Vector3$1(0,0,0),this._rotationVector=new Vector3$1(0,0,0),this._lastQuaternion=new Quaternion$1,this._lastPosition=new Vector3$1,this._status=0,this._onKeyDown=onKeyDown.bind(this),this._onKeyUp=onKeyUp.bind(this),this._onPointerMove=onPointerMove.bind(this),this._onPointerDown=onPointerDown.bind(this),this._onPointerUp=onPointerUp.bind(this),this._onPointerCancel=onPointerCancel.bind(this),this._onContextMenu=onContextMenu.bind(this),et!==null&&this.connect()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(_e){if(this.enabled===!1)return;const et=this.object,rt=_e*this.movementSpeed,it=_e*this.rollSpeed;et.translateX(this._moveVector.x*rt),et.translateY(this._moveVector.y*rt),et.translateZ(this._moveVector.z*rt),_tmpQuaternion.set(this._rotationVector.x*it,this._rotationVector.y*it,this._rotationVector.z*it,1).normalize(),et.quaternion.multiply(_tmpQuaternion),(this._lastPosition.distanceToSquared(et.position)>_EPS||8*(1-this._lastQuaternion.dot(et.quaternion))>_EPS)&&(this.dispatchEvent(_changeEvent),this._lastQuaternion.copy(et.quaternion),this._lastPosition.copy(et.position))}_updateMovementVector(){const _e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-_e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function onKeyDown(nt){if(!(nt.altKey||this.enabled===!1)){switch(nt.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function onKeyUp(nt){if(this.enabled!==!1){switch(nt.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function onPointerDown(nt){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(nt.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function onPointerMove(nt){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const _e=this._getContainerDimensions(),et=_e.size[0]/2,rt=_e.size[1]/2;this._moveState.yawLeft=-(nt.pageX-_e.offset[0]-et)/et,this._moveState.pitchDown=(nt.pageY-_e.offset[1]-rt)/rt,this._updateRotationVector()}}function onPointerUp(nt){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(nt.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function onPointerCancel(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function onContextMenu(nt){this.enabled!==!1&&nt.preventDefault()}const CopyShader={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};let Pass$1=class{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}};const _camera=new OrthographicCamera$1(-1,1,1,-1,0,1);class FullscreenTriangleGeometry extends BufferGeometry$1{constructor(){super(),this.setAttribute("position",new Float32BufferAttribute$1([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Float32BufferAttribute$1([0,2,0,0,2,0],2))}}const _geometry=new FullscreenTriangleGeometry;class FullScreenQuad{constructor(_e){this._mesh=new Mesh$1(_geometry,_e)}dispose(){this._mesh.geometry.dispose()}render(_e){_e.render(this._mesh,_camera)}get material(){return this._mesh.material}set material(_e){this._mesh.material=_e}}let ShaderPass$1=class extends Pass$1{constructor(_e,et){super(),this.textureID=et!==void 0?et:"tDiffuse",_e instanceof ShaderMaterial$1?(this.uniforms=_e.uniforms,this.material=_e):_e&&(this.uniforms=UniformsUtils.clone(_e.uniforms),this.material=new ShaderMaterial$1({name:_e.name!==void 0?_e.name:"unspecified",defines:Object.assign({},_e.defines),uniforms:this.uniforms,vertexShader:_e.vertexShader,fragmentShader:_e.fragmentShader})),this.fsQuad=new FullScreenQuad(this.material)}render(_e,et,rt){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=rt.texture),this.fsQuad.material=this.material,this.renderToScreen?(_e.setRenderTarget(null),this.fsQuad.render(_e)):(_e.setRenderTarget(et),this.clear&&_e.clear(_e.autoClearColor,_e.autoClearDepth,_e.autoClearStencil),this.fsQuad.render(_e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}},MaskPass$1=class extends Pass$1{constructor(_e,et){super(),this.scene=_e,this.camera=et,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(_e,et,rt){const it=_e.getContext(),st=_e.state;st.buffers.color.setMask(!1),st.buffers.depth.setMask(!1),st.buffers.color.setLocked(!0),st.buffers.depth.setLocked(!0);let ot,at;this.inverse?(ot=0,at=1):(ot=1,at=0),st.buffers.stencil.setTest(!0),st.buffers.stencil.setOp(it.REPLACE,it.REPLACE,it.REPLACE),st.buffers.stencil.setFunc(it.ALWAYS,ot,4294967295),st.buffers.stencil.setClear(at),st.buffers.stencil.setLocked(!0),_e.setRenderTarget(rt),this.clear&&_e.clear(),_e.render(this.scene,this.camera),_e.setRenderTarget(et),this.clear&&_e.clear(),_e.render(this.scene,this.camera),st.buffers.color.setLocked(!1),st.buffers.depth.setLocked(!1),st.buffers.color.setMask(!0),st.buffers.depth.setMask(!0),st.buffers.stencil.setLocked(!1),st.buffers.stencil.setFunc(it.EQUAL,1,4294967295),st.buffers.stencil.setOp(it.KEEP,it.KEEP,it.KEEP),st.buffers.stencil.setLocked(!0)}},ClearMaskPass$1=class extends Pass$1{constructor(){super(),this.needsSwap=!1}render(_e){_e.state.buffers.stencil.setLocked(!1),_e.state.buffers.stencil.setTest(!1)}},EffectComposer$2=class{constructor(_e,et){if(this.renderer=_e,this._pixelRatio=_e.getPixelRatio(),et===void 0){const rt=_e.getSize(new Vector2$1);this._width=rt.width,this._height=rt.height,et=new WebGLRenderTarget$1(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:HalfFloatType$1}),et.texture.name="EffectComposer.rt1"}else this._width=et.width,this._height=et.height;this.renderTarget1=et,this.renderTarget2=et.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new ShaderPass$1(CopyShader),this.copyPass.material.blending=NoBlending$1,this.clock=new Clock}swapBuffers(){const _e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=_e}addPass(_e){this.passes.push(_e),_e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(_e,et){this.passes.splice(et,0,_e),_e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(_e){const et=this.passes.indexOf(_e);et!==-1&&this.passes.splice(et,1)}isLastEnabledPass(_e){for(let et=_e+1;et<this.passes.length;et++)if(this.passes[et].enabled)return!1;return!0}render(_e){_e===void 0&&(_e=this.clock.getDelta());const et=this.renderer.getRenderTarget();let rt=!1;for(let it=0,st=this.passes.length;it<st;it++){const ot=this.passes[it];if(ot.enabled!==!1){if(ot.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(it),ot.render(this.renderer,this.writeBuffer,this.readBuffer,_e,rt),ot.needsSwap){if(rt){const at=this.renderer.getContext(),lt=this.renderer.state.buffers.stencil;lt.setFunc(at.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,_e),lt.setFunc(at.EQUAL,1,4294967295)}this.swapBuffers()}MaskPass$1!==void 0&&(ot instanceof MaskPass$1?rt=!0:ot instanceof ClearMaskPass$1&&(rt=!1))}}this.renderer.setRenderTarget(et)}reset(_e){if(_e===void 0){const et=this.renderer.getSize(new Vector2$1);this._pixelRatio=this.renderer.getPixelRatio(),this._width=et.width,this._height=et.height,_e=this.renderTarget1.clone(),_e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=_e,this.renderTarget2=_e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(_e,et){this._width=_e,this._height=et;const rt=this._width*this._pixelRatio,it=this._height*this._pixelRatio;this.renderTarget1.setSize(rt,it),this.renderTarget2.setSize(rt,it);for(let st=0;st<this.passes.length;st++)this.passes[st].setSize(rt,it)}setPixelRatio(_e){this._pixelRatio=_e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}},RenderPass$1=class extends Pass$1{constructor(_e,et,rt=null,it=null,st=null){super(),this.scene=_e,this.camera=et,this.overrideMaterial=rt,this.clearColor=it,this.clearAlpha=st,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Color$2}render(_e,et,rt){const it=_e.autoClear;_e.autoClear=!1;let st,ot;this.overrideMaterial!==null&&(ot=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(_e.getClearColor(this._oldClearColor),_e.setClearColor(this.clearColor,_e.getClearAlpha())),this.clearAlpha!==null&&(st=_e.getClearAlpha(),_e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&_e.clearDepth(),_e.setRenderTarget(this.renderToScreen?null:rt),this.clear===!0&&_e.clear(_e.autoClearColor,_e.autoClearDepth,_e.autoClearStencil),_e.render(this.scene,this.camera),this.clearColor!==null&&_e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&_e.setClearAlpha(st),this.overrideMaterial!==null&&(this.scene.overrideMaterial=ot),_e.autoClear=it}};function _assertThisInitialized(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _setPrototypeOf(nt,_e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(et,rt){return et.__proto__=rt,et},_setPrototypeOf(nt,_e)}function _inheritsLoose(nt,_e){nt.prototype=Object.create(_e.prototype),nt.prototype.constructor=nt,_setPrototypeOf(nt,_e)}function _getPrototypeOf(nt){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf(nt)}function _isNativeFunction(nt){try{return Function.toString.call(nt).indexOf("[native code]")!==-1}catch{return typeof nt=="function"}}function _isNativeReflectConstruct(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!nt})()}function _construct(nt,_e,et){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var rt=[null];rt.push.apply(rt,_e);var it=new(nt.bind.apply(nt,rt));return et&&_setPrototypeOf(it,et.prototype),it}function _wrapNativeSuper(nt){var _e=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(rt){if(rt===null||!_isNativeFunction(rt))return rt;if(typeof rt!="function")throw new TypeError("Super expression must either be null or a function");if(_e!==void 0){if(_e.has(rt))return _e.get(rt);_e.set(rt,it)}function it(){return _construct(rt,arguments,_getPrototypeOf(this).constructor)}return it.prototype=Object.create(rt.prototype,{constructor:{value:it,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(it,rt)},_wrapNativeSuper(nt)}var PolishedError=function(nt){_inheritsLoose(_e,nt);function _e(et){var rt;return rt=nt.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+et+" for more information.")||this,_assertThisInitialized(rt)}return _e}(_wrapNativeSuper(Error));function colorToInt(nt){return Math.round(nt*255)}function convertToInt(nt,_e,et){return colorToInt(nt)+","+colorToInt(_e)+","+colorToInt(et)}function hslToRgb(nt,_e,et,rt){if(rt===void 0&&(rt=convertToInt),_e===0)return rt(et,et,et);var it=(nt%360+360)%360/60,st=(1-Math.abs(2*et-1))*_e,ot=st*(1-Math.abs(it%2-1)),at=0,lt=0,ct=0;it>=0&&it<1?(at=st,lt=ot):it>=1&&it<2?(at=ot,lt=st):it>=2&&it<3?(lt=st,ct=ot):it>=3&&it<4?(lt=ot,ct=st):it>=4&&it<5?(at=ot,ct=st):it>=5&&it<6&&(at=st,ct=ot);var ut=et-st/2,ht=at+ut,dt=lt+ut,ft=ct+ut;return rt(ht,dt,ft)}var namedColorMap={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function nameToHex(nt){if(typeof nt!="string")return nt;var _e=nt.toLowerCase();return namedColorMap[_e]?"#"+namedColorMap[_e]:nt}var hexRegex=/^#[a-fA-F0-9]{6}$/,hexRgbaRegex=/^#[a-fA-F0-9]{8}$/,reducedHexRegex=/^#[a-fA-F0-9]{3}$/,reducedRgbaHexRegex=/^#[a-fA-F0-9]{4}$/,rgbRegex=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,rgbaRegex=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,hslRegex=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,hslaRegex=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function parseToRgb(nt){if(typeof nt!="string")throw new PolishedError(3);var _e=nameToHex(nt);if(_e.match(hexRegex))return{red:parseInt(""+_e[1]+_e[2],16),green:parseInt(""+_e[3]+_e[4],16),blue:parseInt(""+_e[5]+_e[6],16)};if(_e.match(hexRgbaRegex)){var et=parseFloat((parseInt(""+_e[7]+_e[8],16)/255).toFixed(2));return{red:parseInt(""+_e[1]+_e[2],16),green:parseInt(""+_e[3]+_e[4],16),blue:parseInt(""+_e[5]+_e[6],16),alpha:et}}if(_e.match(reducedHexRegex))return{red:parseInt(""+_e[1]+_e[1],16),green:parseInt(""+_e[2]+_e[2],16),blue:parseInt(""+_e[3]+_e[3],16)};if(_e.match(reducedRgbaHexRegex)){var rt=parseFloat((parseInt(""+_e[4]+_e[4],16)/255).toFixed(2));return{red:parseInt(""+_e[1]+_e[1],16),green:parseInt(""+_e[2]+_e[2],16),blue:parseInt(""+_e[3]+_e[3],16),alpha:rt}}var it=rgbRegex.exec(_e);if(it)return{red:parseInt(""+it[1],10),green:parseInt(""+it[2],10),blue:parseInt(""+it[3],10)};var st=rgbaRegex.exec(_e.substring(0,50));if(st)return{red:parseInt(""+st[1],10),green:parseInt(""+st[2],10),blue:parseInt(""+st[3],10),alpha:parseFloat(""+st[4])>1?parseFloat(""+st[4])/100:parseFloat(""+st[4])};var ot=hslRegex.exec(_e);if(ot){var at=parseInt(""+ot[1],10),lt=parseInt(""+ot[2],10)/100,ct=parseInt(""+ot[3],10)/100,ut="rgb("+hslToRgb(at,lt,ct)+")",ht=rgbRegex.exec(ut);if(!ht)throw new PolishedError(4,_e,ut);return{red:parseInt(""+ht[1],10),green:parseInt(""+ht[2],10),blue:parseInt(""+ht[3],10)}}var dt=hslaRegex.exec(_e.substring(0,50));if(dt){var ft=parseInt(""+dt[1],10),pt=parseInt(""+dt[2],10)/100,mt=parseInt(""+dt[3],10)/100,At="rgb("+hslToRgb(ft,pt,mt)+")",gt=rgbRegex.exec(At);if(!gt)throw new PolishedError(4,_e,At);return{red:parseInt(""+gt[1],10),green:parseInt(""+gt[2],10),blue:parseInt(""+gt[3],10),alpha:parseFloat(""+dt[4])>1?parseFloat(""+dt[4])/100:parseFloat(""+dt[4])}}throw new PolishedError(5)}function rgbToHsl(nt){var _e=nt.red/255,et=nt.green/255,rt=nt.blue/255,it=Math.max(_e,et,rt),st=Math.min(_e,et,rt),ot=(it+st)/2;if(it===st)return nt.alpha!==void 0?{hue:0,saturation:0,lightness:ot,alpha:nt.alpha}:{hue:0,saturation:0,lightness:ot};var at,lt=it-st,ct=ot>.5?lt/(2-it-st):lt/(it+st);switch(it){case _e:at=(et-rt)/lt+(et<rt?6:0);break;case et:at=(rt-_e)/lt+2;break;default:at=(_e-et)/lt+4;break}return at*=60,nt.alpha!==void 0?{hue:at,saturation:ct,lightness:ot,alpha:nt.alpha}:{hue:at,saturation:ct,lightness:ot}}function parseToHsl(nt){return rgbToHsl(parseToRgb(nt))}var reduceHexValue=function(_e){return _e.length===7&&_e[1]===_e[2]&&_e[3]===_e[4]&&_e[5]===_e[6]?"#"+_e[1]+_e[3]+_e[5]:_e},reduceHexValue$1=reduceHexValue;function numberToHex(nt){var _e=nt.toString(16);return _e.length===1?"0"+_e:_e}function colorToHex(nt){return numberToHex(Math.round(nt*255))}function convertToHex(nt,_e,et){return reduceHexValue$1("#"+colorToHex(nt)+colorToHex(_e)+colorToHex(et))}function hslToHex(nt,_e,et){return hslToRgb(nt,_e,et,convertToHex)}function hsl(nt,_e,et){if(typeof nt=="number"&&typeof _e=="number"&&typeof et=="number")return hslToHex(nt,_e,et);if(typeof nt=="object"&&_e===void 0&&et===void 0)return hslToHex(nt.hue,nt.saturation,nt.lightness);throw new PolishedError(1)}function hsla$1(nt,_e,et,rt){if(typeof nt=="number"&&typeof _e=="number"&&typeof et=="number"&&typeof rt=="number")return rt>=1?hslToHex(nt,_e,et):"rgba("+hslToRgb(nt,_e,et)+","+rt+")";if(typeof nt=="object"&&_e===void 0&&et===void 0&&rt===void 0)return nt.alpha>=1?hslToHex(nt.hue,nt.saturation,nt.lightness):"rgba("+hslToRgb(nt.hue,nt.saturation,nt.lightness)+","+nt.alpha+")";throw new PolishedError(2)}function rgb(nt,_e,et){if(typeof nt=="number"&&typeof _e=="number"&&typeof et=="number")return reduceHexValue$1("#"+numberToHex(nt)+numberToHex(_e)+numberToHex(et));if(typeof nt=="object"&&_e===void 0&&et===void 0)return reduceHexValue$1("#"+numberToHex(nt.red)+numberToHex(nt.green)+numberToHex(nt.blue));throw new PolishedError(6)}function rgba$1(nt,_e,et,rt){if(typeof nt=="string"&&typeof _e=="number"){var it=parseToRgb(nt);return"rgba("+it.red+","+it.green+","+it.blue+","+_e+")"}else{if(typeof nt=="number"&&typeof _e=="number"&&typeof et=="number"&&typeof rt=="number")return rt>=1?rgb(nt,_e,et):"rgba("+nt+","+_e+","+et+","+rt+")";if(typeof nt=="object"&&_e===void 0&&et===void 0&&rt===void 0)return nt.alpha>=1?rgb(nt.red,nt.green,nt.blue):"rgba("+nt.red+","+nt.green+","+nt.blue+","+nt.alpha+")"}throw new PolishedError(7)}var isRgb=function(_e){return typeof _e.red=="number"&&typeof _e.green=="number"&&typeof _e.blue=="number"&&(typeof _e.alpha!="number"||typeof _e.alpha>"u")},isRgba=function(_e){return typeof _e.red=="number"&&typeof _e.green=="number"&&typeof _e.blue=="number"&&typeof _e.alpha=="number"},isHsl=function(_e){return typeof _e.hue=="number"&&typeof _e.saturation=="number"&&typeof _e.lightness=="number"&&(typeof _e.alpha!="number"||typeof _e.alpha>"u")},isHsla=function(_e){return typeof _e.hue=="number"&&typeof _e.saturation=="number"&&typeof _e.lightness=="number"&&typeof _e.alpha=="number"};function toColorString(nt){if(typeof nt!="object")throw new PolishedError(8);if(isRgba(nt))return rgba$1(nt);if(isRgb(nt))return rgb(nt);if(isHsla(nt))return hsla$1(nt);if(isHsl(nt))return hsl(nt);throw new PolishedError(8)}function curried(nt,_e,et){return function(){var it=et.concat(Array.prototype.slice.call(arguments));return it.length>=_e?nt.apply(this,it):curried(nt,_e,it)}}function curry(nt){return curried(nt,nt.length,[])}function adjustHue(nt,_e){if(_e==="transparent")return _e;var et=parseToHsl(_e);return toColorString(_extends$2({},et,{hue:et.hue+parseFloat(nt)}))}curry(adjustHue);function guard(nt,_e,et){return Math.max(nt,Math.min(_e,et))}function darken(nt,_e){if(_e==="transparent")return _e;var et=parseToHsl(_e);return toColorString(_extends$2({},et,{lightness:guard(0,1,et.lightness-parseFloat(nt))}))}curry(darken);function desaturate(nt,_e){if(_e==="transparent")return _e;var et=parseToHsl(_e);return toColorString(_extends$2({},et,{saturation:guard(0,1,et.saturation-parseFloat(nt))}))}curry(desaturate);function lighten(nt,_e){if(_e==="transparent")return _e;var et=parseToHsl(_e);return toColorString(_extends$2({},et,{lightness:guard(0,1,et.lightness+parseFloat(nt))}))}curry(lighten);function mix$1(nt,_e,et){if(_e==="transparent")return et;if(et==="transparent")return _e;if(nt===0)return et;var rt=parseToRgb(_e),it=_extends$2({},rt,{alpha:typeof rt.alpha=="number"?rt.alpha:1}),st=parseToRgb(et),ot=_extends$2({},st,{alpha:typeof st.alpha=="number"?st.alpha:1}),at=it.alpha-ot.alpha,lt=parseFloat(nt)*2-1,ct=lt*at===-1?lt:lt+at,ut=1+lt*at,ht=(ct/ut+1)/2,dt=1-ht,ft={red:Math.floor(it.red*ht+ot.red*dt),green:Math.floor(it.green*ht+ot.green*dt),blue:Math.floor(it.blue*ht+ot.blue*dt),alpha:it.alpha*parseFloat(nt)+ot.alpha*(1-parseFloat(nt))};return rgba$1(ft)}var curriedMix=curry(mix$1),mix$1$1=curriedMix;function opacify(nt,_e){if(_e==="transparent")return _e;var et=parseToRgb(_e),rt=typeof et.alpha=="number"?et.alpha:1,it=_extends$2({},et,{alpha:guard(0,1,(rt*100+parseFloat(nt)*100)/100)});return rgba$1(it)}var curriedOpacify=curry(opacify),curriedOpacify$1=curriedOpacify;function saturate(nt,_e){if(_e==="transparent")return _e;var et=parseToHsl(_e);return toColorString(_extends$2({},et,{saturation:guard(0,1,et.saturation+parseFloat(nt))}))}curry(saturate);function setHue(nt,_e){return _e==="transparent"?_e:toColorString(_extends$2({},parseToHsl(_e),{hue:parseFloat(nt)}))}curry(setHue);function setLightness(nt,_e){return _e==="transparent"?_e:toColorString(_extends$2({},parseToHsl(_e),{lightness:parseFloat(nt)}))}curry(setLightness);function setSaturation(nt,_e){return _e==="transparent"?_e:toColorString(_extends$2({},parseToHsl(_e),{saturation:parseFloat(nt)}))}curry(setSaturation);function shade(nt,_e){return _e==="transparent"?_e:mix$1$1(parseFloat(nt),"rgb(0, 0, 0)",_e)}curry(shade);function tint(nt,_e){return _e==="transparent"?_e:mix$1$1(parseFloat(nt),"rgb(255, 255, 255)",_e)}curry(tint);function transparentize(nt,_e){if(_e==="transparent")return _e;var et=parseToRgb(_e),rt=typeof et.alpha=="number"?et.alpha:1,it=_extends$2({},et,{alpha:guard(0,1,+(rt*100-parseFloat(nt)*100).toFixed(2)/100)});return rgba$1(it)}curry(transparentize);function styleInject$1(nt,_e){_e===void 0&&(_e={});var et=_e.insertAt;if(!(typeof document>"u")){var rt=document.head||document.getElementsByTagName("head")[0],it=document.createElement("style");it.type="text/css",et==="top"&&rt.firstChild?rt.insertBefore(it,rt.firstChild):rt.appendChild(it),it.styleSheet?it.styleSheet.cssText=nt:it.appendChild(document.createTextNode(nt))}}var css_248z$1=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  top: 0;
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;styleInject$1(css_248z$1);function _arrayLikeToArray$1(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithHoles(nt){if(Array.isArray(nt))return nt}function _arrayWithoutHoles$1(nt){if(Array.isArray(nt))return _arrayLikeToArray$1(nt)}function _defineProperty$1(nt,_e,et){return(_e=_toPropertyKey$1(_e))in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _iterableToArray$1(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _iterableToArrayLimit(nt,_e){var et=nt==null?null:typeof Symbol<"u"&&nt[Symbol.iterator]||nt["@@iterator"];if(et!=null){var rt,it,st,ot,at=[],lt=!0,ct=!1;try{if(st=(et=et.call(nt)).next,_e!==0)for(;!(lt=(rt=st.call(et)).done)&&(at.push(rt.value),at.length!==_e);lt=!0);}catch(ut){ct=!0,it=ut}finally{try{if(!lt&&et.return!=null&&(ot=et.return(),Object(ot)!==ot))return}finally{if(ct)throw it}}return at}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(nt,_e){return _arrayWithHoles(nt)||_iterableToArrayLimit(nt,_e)||_unsupportedIterableToArray$1(nt,_e)||_nonIterableRest()}function _toConsumableArray$1(nt){return _arrayWithoutHoles$1(nt)||_iterableToArray$1(nt)||_unsupportedIterableToArray$1(nt)||_nonIterableSpread$1()}function _toPrimitive$1(nt,_e){if(typeof nt!="object"||!nt)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey$1(nt){var _e=_toPrimitive$1(nt,"string");return typeof _e=="symbol"?_e:_e+""}function _unsupportedIterableToArray$1(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray$1(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray$1(nt,_e):void 0}}var three=window.THREE?window.THREE:{WebGLRenderer,Scene:Scene$1,PerspectiveCamera:PerspectiveCamera$2,Raycaster,SRGBColorSpace:SRGBColorSpace$2,TextureLoader,Vector2:Vector2$1,Vector3:Vector3$1,Box3:Box3$1,Color:Color$2,Mesh:Mesh$1,SphereGeometry:SphereGeometry$1,MeshBasicMaterial:MeshBasicMaterial$1,BackSide:BackSide$1,EventDispatcher:EventDispatcher$1,MOUSE,Quaternion:Quaternion$1,Spherical,Clock},threeRenderObjects=index$2({props:{width:{default:window.innerWidth,onChange:function(_e,et,rt){isNaN(_e)&&(et.width=rt)}},height:{default:window.innerHeight,onChange:function(_e,et,rt){isNaN(_e)&&(et.height=rt)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(_e,et){et.hoverObj=null,et.toolTipElem&&(et.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(_e){if(_e.initialised){if(_e.controls.update&&_e.controls.update(Math.min(1,_e.clock.getDelta())),_e.postProcessingComposer?_e.postProcessingComposer.render():_e.renderer.render(_e.scene,_e.camera),_e.extraRenderers.forEach(function(st){return st.render(_e.scene,_e.camera)}),_e.enablePointerInteraction){var et=null;if(_e.hoverDuringDrag||!_e.isPointerDragging){var rt=this.intersectingObjects(_e.pointerPos.x,_e.pointerPos.y).filter(function(st){return _e.hoverFilter(st.object)}).sort(function(st,ot){return _e.hoverOrderComparator(st.object,ot.object)}),it=rt.length?rt[0]:null;et=it?it.object:null,_e.intersectionPoint=it?it.point:null}et!==_e.hoverObj&&(_e.onHover(et,_e.hoverObj),_e.toolTipElem.innerHTML=et&&index$1(_e.tooltipContent)(et)||"",_e.hoverObj=et)}_e.tweenGroup.update()}return this},getPointerPos:function(_e){var et=_e.pointerPos,rt=et.x,it=et.y;return{x:rt,y:it}},cameraPosition:function(_e,et,rt,it){var st=_e.camera;if(et&&_e.initialised){var ot=et,at=rt||{x:0,y:0,z:0};if(!it)ut(ot),ht(at);else{var lt=Object.assign({},st.position),ct=dt();_e.tweenGroup.add(new Tween(lt).to(ot,it).easing(Easing.Quadratic.Out).onUpdate(ut).start()),_e.tweenGroup.add(new Tween(ct).to(at,it/3).easing(Easing.Quadratic.Out).onUpdate(ht).start())}return this}return Object.assign({},st.position,{lookAt:dt()});function ut(ft){var pt=ft.x,mt=ft.y,At=ft.z;pt!==void 0&&(st.position.x=pt),mt!==void 0&&(st.position.y=mt),At!==void 0&&(st.position.z=At)}function ht(ft){var pt=new three.Vector3(ft.x,ft.y,ft.z);_e.controls.target?_e.controls.target=pt:st.lookAt(pt)}function dt(){return Object.assign(new three.Vector3(0,0,-1e3).applyQuaternion(st.quaternion).add(st.position))}},zoomToFit:function(_e){for(var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,it=arguments.length,st=new Array(it>3?it-3:0),ot=3;ot<it;ot++)st[ot-3]=arguments[ot];return this.fitToBbox(this.getBbox.apply(this,st),et,rt)},fitToBbox:function(_e,et){var rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,it=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,st=_e.camera;if(et){var ot=new three.Vector3(0,0,0),at=Math.max.apply(Math,_toConsumableArray$1(Object.entries(et).map(function(ft){var pt=_slicedToArray(ft,2),mt=pt[0],At=pt[1];return Math.max.apply(Math,_toConsumableArray$1(At.map(function(gt){return Math.abs(ot[mt]-gt)})))})))*2,lt=(1-it*2/_e.height)*st.fov,ct=at/Math.atan(lt*Math.PI/180),ut=ct/st.aspect,ht=Math.max(ct,ut);if(ht>0){var dt=ot.clone().sub(st.position).normalize().multiplyScalar(-ht);this.cameraPosition(dt,ot,rt)}}return this},getBbox:function(_e){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},rt=new three.Box3(new three.Vector3(0,0,0),new three.Vector3(0,0,0)),it=_e.objects.filter(et);return it.length?(it.forEach(function(st){return rt.expandByObject(st)}),Object.assign.apply(Object,_toConsumableArray$1(["x","y","z"].map(function(st){return _defineProperty$1({},st,[rt.min[st],rt.max[st]])})))):null},getScreenCoords:function(_e,et,rt,it){var st=new three.Vector3(et,rt,it);return st.project(this.camera()),{x:(st.x+1)*_e.width/2,y:-(st.y-1)*_e.height/2}},getSceneCoords:function(_e,et,rt){var it=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,st=new three.Vector2(et/_e.width*2-1,-(rt/_e.height)*2+1),ot=new three.Raycaster;return ot.setFromCamera(st,_e.camera),Object.assign({},ot.ray.at(it,new three.Vector3))},intersectingObjects:function(_e,et,rt){var it=new three.Vector2(et/_e.width*2-1,-(rt/_e.height)*2+1),st=new three.Raycaster;return st.params.Line.threshold=_e.lineHoverPrecision,st.setFromCamera(it,_e.camera),st.intersectObjects(_e.objects,!0)},renderer:function(_e){return _e.renderer},scene:function(_e){return _e.scene},camera:function(_e){return _e.camera},postProcessingComposer:function(_e){return _e.postProcessingComposer},controls:function(_e){return _e.controls},tbControls:function(_e){return _e.controls}},stateInit:function(){return{scene:new three.Scene,camera:new three.PerspectiveCamera,clock:new three.Clock,tweenGroup:new Group}},init:function(_e,et){var rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},it=rt.controlType,st=it===void 0?"trackball":it,ot=rt.useWebGPU,at=ot===void 0?!1:ot,lt=rt.rendererConfig,ct=lt===void 0?{}:lt,ut=rt.extraRenderers,ht=ut===void 0?[]:ut,dt=rt.waitForLoadComplete,ft=dt===void 0?!0:dt;_e.innerHTML="",_e.appendChild(et.container=document.createElement("div")),et.container.className="scene-container",et.container.style.position="relative",et.container.appendChild(et.navInfo=document.createElement("div")),et.navInfo.className="scene-nav-info",et.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[st]||"",et.navInfo.style.display=et.showNavInfo?null:"none",et.toolTipElem=document.createElement("div"),et.toolTipElem.classList.add("scene-tooltip"),et.container.appendChild(et.toolTipElem),et.pointerPos=new three.Vector2,et.pointerPos.x=-2,et.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(pt){return et.container.addEventListener(pt,function(mt){if(pt==="pointerdown"&&(et.isPointerPressed=!0),!et.isPointerDragging&&mt.type==="pointermove"&&(mt.pressure>0||et.isPointerPressed)&&(mt.pointerType!=="touch"||mt.movementX===void 0||[mt.movementX,mt.movementY].some(function(bt){return Math.abs(bt)>1}))&&(et.isPointerDragging=!0),et.enablePointerInteraction){var At=gt(et.container);et.pointerPos.x=mt.pageX-At.left,et.pointerPos.y=mt.pageY-At.top,et.toolTipElem.style.top="".concat(et.pointerPos.y,"px"),et.toolTipElem.style.left="".concat(et.pointerPos.x,"px"),et.toolTipElem.style.transform="translate(-".concat(et.pointerPos.x/et.width*100,"%, ").concat(et.height-et.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}function gt(bt){var Tt=bt.getBoundingClientRect(),wt=window.pageXOffset||document.documentElement.scrollLeft,Rt=window.pageYOffset||document.documentElement.scrollTop;return{top:Tt.top+Rt,left:Tt.left+wt}}},{passive:!0})}),et.container.addEventListener("pointerup",function(pt){et.isPointerPressed=!1,!(et.isPointerDragging&&(et.isPointerDragging=!1,!et.clickAfterDrag))&&requestAnimationFrame(function(){pt.button===0&&et.onClick(et.hoverObj||null,pt,et.intersectionPoint),pt.button===2&&et.onRightClick&&et.onRightClick(et.hoverObj||null,pt,et.intersectionPoint)})},{passive:!0,capture:!0}),et.container.addEventListener("contextmenu",function(pt){et.onRightClick&&pt.preventDefault()}),et.renderer=new(at?WebGPURenderer:three.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},ct)),et.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),et.container.appendChild(et.renderer.domElement),et.extraRenderers=ht,et.extraRenderers.forEach(function(pt){pt.domElement.style.position="absolute",pt.domElement.style.top="0px",pt.domElement.style.pointerEvents="none",et.container.appendChild(pt.domElement)}),et.postProcessingComposer=new EffectComposer$2(et.renderer),et.postProcessingComposer.addPass(new RenderPass$1(et.scene,et.camera)),et.controls=new{trackball:TrackballControls,orbit:OrbitControls,fly:FlyControls}[st](et.camera,et.renderer.domElement),st==="fly"&&(et.controls.movementSpeed=300,et.controls.rollSpeed=Math.PI/6,et.controls.dragToLook=!0),(st==="trackball"||st==="orbit")&&(et.controls.minDistance=.1,et.controls.maxDistance=et.skyRadius,et.controls.addEventListener("start",function(){et.controlsEngaged=!0}),et.controls.addEventListener("change",function(){et.controlsEngaged&&(et.controlsDragging=!0)}),et.controls.addEventListener("end",function(){et.controlsEngaged=!1,et.controlsDragging=!1})),[et.renderer,et.postProcessingComposer].concat(_toConsumableArray$1(et.extraRenderers)).forEach(function(pt){return pt.setSize(et.width,et.height)}),et.camera.aspect=et.width/et.height,et.camera.updateProjectionMatrix(),et.camera.position.z=1e3,et.scene.add(et.skysphere=new three.Mesh),et.skysphere.visible=!1,et.loadComplete=et.scene.visible=!ft,window.scene=et.scene},update:function(_e,et){if(_e.width&&_e.height&&(et.hasOwnProperty("width")||et.hasOwnProperty("height"))&&(_e.container.style.width="".concat(_e.width,"px"),_e.container.style.height="".concat(_e.height,"px"),[_e.renderer,_e.postProcessingComposer].concat(_toConsumableArray$1(_e.extraRenderers)).forEach(function(st){return st.setSize(_e.width,_e.height)}),_e.camera.aspect=_e.width/_e.height,_e.camera.updateProjectionMatrix()),et.hasOwnProperty("skyRadius")&&_e.skyRadius&&(_e.controls.hasOwnProperty("maxDistance")&&et.skyRadius&&(_e.controls.maxDistance=Math.min(_e.controls.maxDistance,_e.skyRadius)),_e.camera.far=_e.skyRadius*2.5,_e.camera.updateProjectionMatrix(),_e.skysphere.geometry=new three.SphereGeometry(_e.skyRadius)),et.hasOwnProperty("backgroundColor")){var rt=parseToRgb(_e.backgroundColor).alpha;rt===void 0&&(rt=1),_e.renderer.setClearColor(new three.Color(curriedOpacify$1(1,_e.backgroundColor)),rt)}et.hasOwnProperty("backgroundImageUrl")&&(_e.backgroundImageUrl?new three.TextureLoader().load(_e.backgroundImageUrl,function(st){st.colorSpace=three.SRGBColorSpace,_e.skysphere.material=new three.MeshBasicMaterial({map:st,side:three.BackSide}),_e.skysphere.visible=!0,_e.onBackgroundImageLoaded&&setTimeout(_e.onBackgroundImageLoaded),!_e.loadComplete&&it()}):(_e.skysphere.visible=!1,_e.skysphere.material.map=null,!_e.loadComplete&&it())),et.hasOwnProperty("showNavInfo")&&(_e.navInfo.style.display=_e.showNavInfo?null:"none"),et.hasOwnProperty("lights")&&((et.lights||[]).forEach(function(st){return _e.scene.remove(st)}),_e.lights.forEach(function(st){return _e.scene.add(st)})),et.hasOwnProperty("objects")&&((et.objects||[]).forEach(function(st){return _e.scene.remove(st)}),_e.objects.forEach(function(st){return _e.scene.add(st)}));function it(){_e.loadComplete=_e.scene.visible=!0}}});function styleInject(nt,_e){_e===void 0&&(_e={});var et=_e.insertAt;if(!(typeof document>"u")){var rt=document.head||document.getElementsByTagName("head")[0],it=document.createElement("style");it.type="text/css",et==="top"&&rt.firstChild?rt.insertBefore(it,rt.firstChild):rt.appendChild(it),it.styleSheet?it.styleSheet.cssText=nt:it.appendChild(document.createTextNode(nt))}}var css_248z=`.scene-container .clickable {
  cursor: pointer;
}`;styleInject(css_248z);function _arrayLikeToArray(nt,_e){(_e==null||_e>nt.length)&&(_e=nt.length);for(var et=0,rt=Array(_e);et<_e;et++)rt[et]=nt[et];return rt}function _arrayWithoutHoles(nt){if(Array.isArray(nt))return _arrayLikeToArray(nt)}function _defineProperty(nt,_e,et){return(_e=_toPropertyKey(_e))in nt?Object.defineProperty(nt,_e,{value:et,enumerable:!0,configurable:!0,writable:!0}):nt[_e]=et,nt}function _iterableToArray(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys(nt,_e){var et=Object.keys(nt);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(nt);_e&&(rt=rt.filter(function(it){return Object.getOwnPropertyDescriptor(nt,it).enumerable})),et.push.apply(et,rt)}return et}function _objectSpread2(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys(Object(et),!0).forEach(function(rt){_defineProperty(nt,rt,et[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(et)):ownKeys(Object(et)).forEach(function(rt){Object.defineProperty(nt,rt,Object.getOwnPropertyDescriptor(et,rt))})}return nt}function _objectWithoutProperties(nt,_e){if(nt==null)return{};var et,rt,it=_objectWithoutPropertiesLoose(nt,_e);if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(nt);for(rt=0;rt<st.length;rt++)et=st[rt],_e.includes(et)||{}.propertyIsEnumerable.call(nt,et)&&(it[et]=nt[et])}return it}function _objectWithoutPropertiesLoose(nt,_e){if(nt==null)return{};var et={};for(var rt in nt)if({}.hasOwnProperty.call(nt,rt)){if(_e.includes(rt))continue;et[rt]=nt[rt]}return et}function _toConsumableArray(nt){return _arrayWithoutHoles(nt)||_iterableToArray(nt)||_unsupportedIterableToArray(nt)||_nonIterableSpread()}function _toPrimitive(nt,_e){if(typeof nt!="object"||!nt)return nt;var et=nt[Symbol.toPrimitive];if(et!==void 0){var rt=et.call(nt,_e||"default");if(typeof rt!="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(nt)}function _toPropertyKey(nt){var _e=_toPrimitive(nt,"string");return typeof _e=="symbol"?_e:_e+""}function _unsupportedIterableToArray(nt,_e){if(nt){if(typeof nt=="string")return _arrayLikeToArray(nt,_e);var et={}.toString.call(nt).slice(8,-1);return et==="Object"&&nt.constructor&&(et=nt.constructor.name),et==="Map"||et==="Set"?Array.from(nt):et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et)?_arrayLikeToArray(nt,_e):void 0}}function linkKapsule(nt,_e){var et=new _e;return et._destructor&&et._destructor(),{linkProp:function(it){return{default:et[it](),onChange:function(ot,at){at[nt][it](ot)},triggerUpdate:!1}},linkMethod:function(it){return function(st){for(var ot=st[nt],at=arguments.length,lt=new Array(at>1?at-1:0),ct=1;ct<at;ct++)lt[ct-1]=arguments[ct];var ut=ot[it].apply(ot,lt);return ut===ot?this:ut}}}}var _excluded=["rendererConfig","waitForGlobeReady"],THREE=_objectSpread2(_objectSpread2({},window.THREE?window.THREE:{AmbientLight:AmbientLight$1,DirectionalLight:DirectionalLight$1,Vector2:Vector2$1,REVISION:REVISION$1}),{},{CSS2DRenderer}),bindGlobe=linkKapsule("globe",threeGlobe),linkedGlobeProps=Object.assign.apply(Object,_toConsumableArray(["globeImageUrl","bumpImageUrl","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(nt){return _defineProperty({},nt,bindGlobe.linkProp(nt))}))),linkedGlobeMethods=Object.assign.apply(Object,_toConsumableArray(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map(function(nt){return _defineProperty({},nt,bindGlobe.linkMethod(nt))}))),bindRenderObjs=linkKapsule("renderObjs",threeRenderObjects),linkedRenderObjsProps=Object.assign.apply(Object,_toConsumableArray(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map(function(nt){return _defineProperty({},nt,bindRenderObjs.linkProp(nt))}))),linkedRenderObjsMethods=Object.assign.apply(Object,_toConsumableArray(["lights","postProcessingComposer"].map(function(nt){return _defineProperty({},nt,bindRenderObjs.linkMethod(nt))}))),globe=index$2({props:_objectSpread2(_objectSpread2({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1,onChange:function(_e,et){return et.renderObjs.hoverFilter(function(rt){return _e(rt,rt.__data)})}},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(_e,et){return et.renderObjs.lineHoverPrecision(_e)}}},linkedGlobeProps),linkedRenderObjsProps),methods:_objectSpread2(_objectSpread2({pauseAnimation:function(_e){var et;return _e.animationFrameRequestId!==null&&(cancelAnimationFrame(_e.animationFrameRequestId),_e.animationFrameRequestId=null),(et=_e.globe)===null||et===void 0||et.pauseAnimation(),this},resumeAnimation:function(_e){var et;return _e.animationFrameRequestId===null&&this._animationCycle(),(et=_e.globe)===null||et===void 0||et.resumeAnimation(),this},_animationCycle:function(_e){_e.renderObjs.tick(),_e.tweenGroup.update(),_e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(_e){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,it=ot();if(et.lat===void 0&&et.lng===void 0&&et.altitude===void 0)return it;var st=Object.assign({},it,et);if(["lat","lng","altitude"].forEach(function(lt){return st[lt]=+st[lt]}),!rt)at(st);else{for(;it.lng-st.lng>180;)it.lng-=360;for(;it.lng-st.lng<-180;)it.lng+=360;_e.tweenGroup.add(new Tween(it).to(st,rt).easing(Easing.Cubic.InOut).onUpdate(at).start())}return this;function ot(){return _e.globe.toGeoCoords(_e.renderObjs.cameraPosition())}function at(lt){var ct=lt.lat,ut=lt.lng,ht=lt.altitude;_e.renderObjs.cameraPosition(_e.globe.getCoords(ct,ut,ht))}},getScreenCoords:function(_e){for(var et,rt=arguments.length,it=new Array(rt>1?rt-1:0),st=1;st<rt;st++)it[st-1]=arguments[st];var ot=(et=_e.globe).getCoords.apply(et,it);return _e.renderObjs.getScreenCoords(ot.x,ot.y,ot.z)},toGlobeCoords:function(_e,et,rt){var it=_e.renderObjs.intersectingObjects(et,rt).find(function(lt){return lt.object.__globeObjType==="globe"});if(!it)return null;var st=_e.globe.toGeoCoords(it.point),ot=st.lat,at=st.lng;return{lat:ot,lng:at}},scene:function(_e){return _e.renderObjs.scene()},camera:function(_e){return _e.renderObjs.camera()},renderer:function(_e){return _e.renderObjs.renderer()},controls:function(_e){return _e.renderObjs.controls()},_destructor:function(_e){_e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},linkedGlobeMethods),linkedRenderObjsMethods),stateInit:function(_e){var et=_e.rendererConfig,rt=_e.waitForGlobeReady,it=rt===void 0?!0:rt,st=_objectWithoutProperties(_e,_excluded),ot=new threeGlobe(_objectSpread2({waitForGlobeReady:it},st));return{globe:ot,renderObjs:threeRenderObjects({controlType:"orbit",rendererConfig:et,waitForLoadComplete:it,extraRenderers:[new THREE.CSS2DRenderer]}).skyRadius(ot.getGlobeRadius()*500).showNavInfo(!1).objects([ot]).lights([new THREE.AmbientLight(13421772,Math.PI),new THREE.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new Group}},init:function(_e,et){var rt=this;_e.innerHTML="",_e.appendChild(et.container=document.createElement("div")),et.container.style.position="relative";var it=document.createElement("div");et.container.appendChild(it),et.renderObjs(it),et.globe.rendererSize(et.renderObjs.renderer().getSize(new THREE.Vector2)),this.pointOfView({altitude:2.5});var st=et.globe.getGlobeRadius(),ot=et.renderObjs.controls();ot.minDistance=st*1.01,ot.maxDistance=st*100,ot.enablePan=!1,ot.enableDamping=!0,ot.dampingFactor=.1,ot.rotateSpeed=.3,ot.zoomSpeed=.3,ot.addEventListener("change",function(){var ct=rt.pointOfView();ot.rotateSpeed=ct.altitude*.2,ot.zoomSpeed=(ct.altitude+1)*.1,et.globe.setPointOfView(et.renderObjs.camera().position),et.onZoom&&et.onZoom(ct)});var at=function(ut){for(var ht=ut;ht&&!ht.hasOwnProperty("__globeObjType");)ht=ht.parent;return ht},lt={point:function(ut){return ut},arc:function(ut){return ut},polygon:function(ut){return ut.data},path:function(ut){return ut},heatmap:function(ut){return ut},hexbin:function(ut){return ut},hexPolygon:function(ut){return ut},tile:function(ut){return ut},label:function(ut){return ut},object:function(ut){return ut},custom:function(ut){return ut}};THREE.REVISION<155&&(et.renderObjs.renderer().useLegacyLights=!1),et.renderObjs.hoverOrderComparator(function(ct,ut){var ht=at(ct),dt=at(ut),ft=function(mt){return!mt};return ft(ht)-ft(dt)}).tooltipContent(function(ct){var ut={point:et.pointLabel,arc:et.arcLabel,polygon:et.polygonLabel,path:et.pathLabel,hexbin:et.hexLabel,hexPolygon:et.hexPolygonLabel,tile:et.tileLabel,label:et.labelLabel,object:et.objectLabel,custom:et.customLayerLabel},ht=at(ct),dt=ht&&ht.__globeObjType;return ht&&dt&&ut.hasOwnProperty(dt)&&lt.hasOwnProperty(dt)&&index$1(ut[dt])(lt[dt](ht.__data))||""}).onHover(function(ct){var ut={point:et.onPointHover,arc:et.onArcHover,polygon:et.onPolygonHover,path:et.onPathHover,heatmap:et.onHeatmapHover,hexbin:et.onHexHover,hexPolygon:et.onHexPolygonHover,tile:et.onTileHover,label:et.onLabelHover,object:et.onObjectHover,custom:et.onCustomLayerHover},ht={globe:et.onGlobeClick,point:et.onPointClick,arc:et.onArcClick,polygon:et.onPolygonClick,path:et.onPathClick,heatmap:et.onHeatmapClick,hexbin:et.onHexClick,hexPolygon:et.onHexPolygonClick,tile:et.onTileClick,label:et.onLabelClick,object:et.onObjectClick,custom:et.onCustomLayerClick},dt=at(ct);if(dt&&!ut.hasOwnProperty(dt.__globeObjType)&&(dt=null),dt!==et.hoverObj){var ft=et.hoverObj?et.hoverObj.__globeObjType:null,pt=et.hoverObj?lt[ft](et.hoverObj.__data):null,mt=dt?dt.__globeObjType:null,At=dt?lt[mt](dt.__data):null;ft&&ft!==mt&&ut[ft]&&ut[ft](null,pt),mt&&ut[mt]&&ut[mt](At,ft===mt?pt:null),et.renderObjs.renderer().domElement.classList[mt&&ht[mt]?"add":"remove"]("clickable"),et.hoverObj=dt}}).onClick(function(ct,ut,ht){if(ct){var dt={globe:et.onGlobeClick,point:et.onPointClick,arc:et.onArcClick,polygon:et.onPolygonClick,path:et.onPathClick,heatmap:et.onHeatmapClick,hexbin:et.onHexClick,hexPolygon:et.onHexPolygonClick,tile:et.onTileClick,label:et.onLabelClick,object:et.onObjectClick,custom:et.onCustomLayerClick},ft=at(ct),pt=ft.__globeObjType;if(ft&&dt.hasOwnProperty(pt)&&dt[pt]){var mt=[ut];if(pt==="globe"){var At=rt.toGeoCoords(ht),gt=At.lat,bt=At.lng;mt.unshift({lat:gt,lng:bt})}else mt.push(rt.toGeoCoords(ht));lt.hasOwnProperty(pt)&&mt.unshift(lt[pt](ft.__data)),dt[pt].apply(dt,mt)}}}).onRightClick(function(ct,ut,ht){if(ct){var dt={globe:et.onGlobeRightClick,point:et.onPointRightClick,arc:et.onArcRightClick,polygon:et.onPolygonRightClick,path:et.onPathRightClick,heatmap:et.onHeatmapRightClick,hexbin:et.onHexRightClick,hexPolygon:et.onHexPolygonRightClick,tile:et.onTileRightClick,label:et.onLabelRightClick,object:et.onObjectRightClick,custom:et.onCustomLayerRightClick},ft=at(ct),pt=ft.__globeObjType;if(ft&&dt.hasOwnProperty(pt)&&dt[pt]){var mt=[ut];if(pt==="globe"){var At=rt.toGeoCoords(ht),gt=At.lat,bt=At.lng;mt.unshift({lat:gt,lng:bt})}else mt.push(rt.toGeoCoords(ht));lt.hasOwnProperty(pt)&&mt.unshift(lt[pt](ft.__data)),dt[pt].apply(dt,mt)}}}),this._animationCycle()}}),GlobePropTypes={width:PropTypes.number,height:PropTypes.number,backgroundColor:PropTypes.string,backgroundImageUrl:PropTypes.string,globeImageUrl:PropTypes.string,bumpImageUrl:PropTypes.string,showGlobe:PropTypes.bool,showGraticules:PropTypes.bool,showAtmosphere:PropTypes.bool,atmosphereColor:PropTypes.string,atmosphereAltitude:PropTypes.number,globeMaterial:PropTypes.object,onGlobeReady:PropTypes.func,onGlobeClick:PropTypes.func,onGlobeRightClick:PropTypes.func,pointsData:PropTypes.arrayOf(PropTypes.object),pointLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pointLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pointColor:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),pointAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pointRadius:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pointResolution:PropTypes.number,pointsMerge:PropTypes.bool,pointsTransitionDuration:PropTypes.number,pointLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onPointClick:PropTypes.func,onPointRightClick:PropTypes.func,onPointHover:PropTypes.func,arcsData:PropTypes.arrayOf(PropTypes.object),arcStartLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcStartLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcEndLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcEndLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcColor:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string),PropTypes.func]),arcAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcAltitudeAutoScale:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcStroke:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcCurveResolution:PropTypes.number,arcCircularResolution:PropTypes.number,arcDashLength:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcDashGap:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcDashInitialGap:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcDashAnimateTime:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),arcsTransitionDuration:PropTypes.number,arcLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onArcClick:PropTypes.func,onArcRightClick:PropTypes.func,onArcHover:PropTypes.func,polygonsData:PropTypes.arrayOf(PropTypes.object),polygonGeoJsonGeometry:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),polygonCapColor:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),polygonCapMaterial:PropTypes.oneOfType([PropTypes.object,PropTypes.string,PropTypes.func]),polygonSideColor:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),polygonSideMaterial:PropTypes.oneOfType([PropTypes.object,PropTypes.string,PropTypes.func]),polygonStrokeColor:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),polygonAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),polygonCapCurvatureResolution:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),polygonsTransitionDuration:PropTypes.number,polygonLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onPolygonClick:PropTypes.func,onPolygonRightClick:PropTypes.func,onPolygonHover:PropTypes.func,pathsData:PropTypes.array,pathPoints:PropTypes.oneOfType([PropTypes.array,PropTypes.string,PropTypes.func]),pathPointLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathPointLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathPointAlt:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathResolution:PropTypes.number,pathColor:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string),PropTypes.func]),pathStroke:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathDashLength:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathDashGap:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathDashInitialGap:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathDashAnimateTime:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),pathTransitionDuration:PropTypes.number,pathLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onPathClick:PropTypes.func,onPathRightClick:PropTypes.func,onPathHover:PropTypes.func,heatmapsData:PropTypes.array,heatmapPoints:PropTypes.oneOfType([PropTypes.array,PropTypes.string,PropTypes.func]),heatmapPointLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapPointLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapPointWeight:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapBandwidth:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapColorFn:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),heatmapColorSaturation:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapBaseAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapTopAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),heatmapsTransitionDuration:PropTypes.number,onHeatmapClick:PropTypes.func,onHeatmapRightClick:PropTypes.func,onHeatmapHover:PropTypes.func,hexBinPointsData:PropTypes.arrayOf(PropTypes.object),hexBinPointLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexBinPointLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexBinPointWeight:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexBinResolution:PropTypes.number,hexMargin:PropTypes.oneOfType([PropTypes.number,PropTypes.func]),hexTopColor:PropTypes.func,hexSideColor:PropTypes.func,hexAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.func]),hexTopCurvatureResolution:PropTypes.number,hexBinMerge:PropTypes.bool,hexTransitionDuration:PropTypes.number,hexLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onHexClick:PropTypes.func,onHexRightClick:PropTypes.func,onHexHover:PropTypes.func,hexPolygonsData:PropTypes.arrayOf(PropTypes.object),hexPolygonGeoJsonGeometry:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),hexPolygonColor:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),hexPolygonAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexPolygonResolution:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexPolygonMargin:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexPolygonUseDots:PropTypes.oneOfType([PropTypes.bool,PropTypes.string,PropTypes.func]),hexPolygonCurvatureResolution:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexPolygonDotResolution:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),hexPolygonsTransitionDuration:PropTypes.number,hexPolygonLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onHexPolygonClick:PropTypes.func,onHexPolygonRightClick:PropTypes.func,onHexPolygonHover:PropTypes.func,tilesData:PropTypes.arrayOf(PropTypes.object),tileLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),tileLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),tileAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),tileWidth:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),tileHeight:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),tileUseGlobeProjection:PropTypes.oneOfType([PropTypes.bool,PropTypes.string,PropTypes.func]),tileMaterial:PropTypes.oneOfType([PropTypes.object,PropTypes.string,PropTypes.func]),tileCurvatureResolution:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),tilesTransitionDuration:PropTypes.number,tileLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onTileClick:PropTypes.func,onTileRightClick:PropTypes.func,onTileHover:PropTypes.func,ringsData:PropTypes.arrayOf(PropTypes.object),ringLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),ringLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),ringAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),ringColor:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string),PropTypes.func]),ringResolution:PropTypes.number,ringMaxRadius:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),ringPropagationSpeed:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),ringRepeatPeriod:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelsData:PropTypes.arrayOf(PropTypes.object),labelLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelRotation:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelText:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),labelSize:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelTypeFace:PropTypes.object,labelColor:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),labelResolution:PropTypes.number,labelIncludeDot:PropTypes.oneOfType([PropTypes.bool,PropTypes.string,PropTypes.func]),labelDotRadius:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),labelDotOrientation:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),labelsTransitionDuration:PropTypes.number,labelLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onLabelClick:PropTypes.func,onLabelRightClick:PropTypes.func,onLabelHover:PropTypes.func,htmlElementsData:PropTypes.arrayOf(PropTypes.object),htmlLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),htmlLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),htmlAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),htmlElement:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),htmlTransitionDuration:PropTypes.number,objectsData:PropTypes.arrayOf(PropTypes.object),objectLat:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),objectLng:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),objectAltitude:PropTypes.oneOfType([PropTypes.number,PropTypes.string,PropTypes.func]),objectRotation:PropTypes.oneOfType([PropTypes.shape({x:PropTypes.number,y:PropTypes.number,z:PropTypes.number}),PropTypes.string,PropTypes.func]),objectFacesSurface:PropTypes.oneOfType([PropTypes.bool,PropTypes.string,PropTypes.func]),objectThreeObject:PropTypes.oneOfType([PropTypes.object,PropTypes.string,PropTypes.func]),objectLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onObjectClick:PropTypes.func,onObjectRightClick:PropTypes.func,onObjectHover:PropTypes.func,customLayerData:PropTypes.arrayOf(PropTypes.object),customThreeObject:PropTypes.oneOfType([PropTypes.object,PropTypes.string,PropTypes.func]),customThreeObjectUpdate:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),customLayerLabel:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),onCustomLayerClick:PropTypes.func,onCustomLayerRightClick:PropTypes.func,onCustomLayerHover:PropTypes.func,enablePointerInteraction:PropTypes.bool,pointerEventsFilter:PropTypes.func,lineHoverPrecision:PropTypes.number,onZoom:PropTypes.func},Globe=index$3(globe,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});Globe.displayName="Globe";Globe.propTypes=GlobePropTypes;var L=(nt,_e,et,rt,it,st,ot,at)=>{let lt=document.documentElement,ct=["light","dark"];function ut(ft){(Array.isArray(nt)?nt:[nt]).forEach(pt=>{let mt=pt==="class",At=mt&&st?it.map(gt=>st[gt]||gt):it;mt?(lt.classList.remove(...At),lt.classList.add(ft)):lt.setAttribute(pt,ft)}),ht(ft)}function ht(ft){at&&ct.includes(ft)&&(lt.style.colorScheme=ft)}function dt(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(rt)ut(rt);else try{let ft=localStorage.getItem(_e)||et,pt=ot&&ft==="system"?dt():ft;ut(pt)}catch{}},E=reactExports.createContext(void 0),N={setTheme:nt=>{},themes:[]},z=()=>{var nt;return(nt=reactExports.useContext(E))!=null?nt:N};reactExports.memo(({forcedTheme:nt,storageKey:_e,attribute:et,enableSystem:rt,enableColorScheme:it,defaultTheme:st,value:ot,themes:at,nonce:lt,scriptProps:ct})=>{let ut=JSON.stringify([et,_e,st,nt,at,ot,rt,it]).slice(1,-1);return reactExports.createElement("script",{...ct,suppressHydrationWarning:!0,nonce:typeof window>"u"?lt:"",dangerouslySetInnerHTML:{__html:`(${L.toString()})(${ut})`}})});function n(nt,_e){return function(et){if(Array.isArray(et))return et}(nt)||function(et,rt){var it=[],st=!0,ot=!1,at=void 0;try{for(var lt,ct=et[Symbol.iterator]();!(st=(lt=ct.next()).done)&&(it.push(lt.value),!rt||it.length!==rt);st=!0);}catch(ut){ot=!0,at=ut}finally{try{st||ct.return==null||ct.return()}finally{if(ot)throw at}}return it}(nt,_e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const i$1=1e8,v=Math.max,M=Math.min,I=Math.pow;function Q(nt,_e){return function(et,rt){const it=v(et,rt),st=M(et,rt);return(it*i$1+.05*i$1)/(st*i$1+.05*i$1)}(R(...nt),R(..._e))}function R(nt,_e,et){return(U(nt)*X+U(_e)*Y+U(et)*Z)/i$1}const U=nt=>nt<=3.928?nt/W:V(nt),V=nt=>I((nt+5.5)/105.5,2.4),W=1292,X=.2126*i$1,Y=.7152*i$1,Z=.0722*i$1;function _(nt){const _e=n(nt.match(tn)||[],9),et=_e[1],rt=_e[2],it=_e[3],st=_e[4],ot=_e[5],at=_e[6],lt=_e[7],ct=_e[8];if(ot!==void 0||et!==void 0)return[parseInt(ot!==void 0?ot:et+et,16),parseInt(at!==void 0?at:rt+rt,16),parseInt(lt!==void 0?lt:it+it,16),ct!==void 0?parseInt(ct,16):st!==void 0?parseInt(st+st,16):255].map(ut=>100*ut/255)}const tn=/^#?(?:([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?|([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?)$/i;function tt(nt,_e){return Q(_(nt),_(_e))}function asyncGeneratorStep(nt,_e,et,rt,it,st,ot){try{var at=nt[st](ot),lt=at.value}catch(ct){et(ct);return}at.done?_e(lt):Promise.resolve(lt).then(rt,it)}function _asyncToGenerator(nt){return function(){var _e=this,et=arguments;return new Promise(function(rt,it){var st=nt.apply(_e,et);function ot(lt){asyncGeneratorStep(st,rt,it,ot,at,"next",lt)}function at(lt){asyncGeneratorStep(st,rt,it,ot,at,"throw",lt)}ot(void 0)})}}function _extends(){return _extends=Object.assign||function(nt){for(var _e=1;_e<arguments.length;_e++){var et=arguments[_e];for(var rt in et)Object.prototype.hasOwnProperty.call(et,rt)&&(nt[rt]=et[rt])}return nt},_extends.apply(this,arguments)}var tagCanvasString=`(function(){"use strict"; var r,C,p=Math.abs,o=Math.sin,l=Math.cos,g=Math.max,h=Math.min,af=Math.ceil,E=Math.sqrt,w=Math.pow,I={},D={},R={0:"0,",1:"17,",2:"34,",3:"51,",4:"68,",5:"85,",6:"102,",7:"119,",8:"136,",9:"153,",a:"170,",A:"170,",b:"187,",B:"187,",c:"204,",C:"204,",d:"221,",D:"221,",e:"238,",E:"238,",f:"255,",F:"255,"},f,d,b,T,z,F,M,c=document,v,e,P,j={};for(r=0;r<256;++r)C=r.toString(16),r<16&&(C='0'+C),D[C]=D[C.toUpperCase()]=r.toString()+',';function n(a){return typeof a!='undefined'}function B(a){return typeof a=='object'&&a!=null}function G(a,c,b){return isNaN(a)?b:h(b,g(c,a))}function x(){return!1}function q(){return(new Date).valueOf()}function ak(c,d){var b=[],e=c.length,a;for(a=0;a<e;++a)b.push(c[a]);return b.sort(d),b}function ai(a){for(var b=a.length-1,d,c;b;)c=~~(Math.random()*b),d=a[b],a[b]=a[c],a[c]=d,--b}function ag(){var a=window.AudioContext||window.webkitAudioContext;if(e=new a,!e){e='off';return}return e}function $(u,a,t,s,r,q,p){var j=s,h=r,i=t*.01,n=80*i,m=100*i,o=40*i,l=30*i,c=l/2,b=j+n,f=b-o,k=h+m,d=k-l,g=h+l,e=h+m/2;if(a.setTransform(1,0,0,1,0,0),a.setLineDash([]),a.globalAlpha=1,a.strokeStyle=p,a.lineWidth=q,a.lineJoin='round',a.beginPath(),a.moveTo(f,g),a.lineTo(f,d),a.moveTo(b,k),a.lineTo(f,d),a.lineTo(j,d),a.lineTo(j,g),a.lineTo(f,g),a.lineTo(b,h),u){a.lineTo(b,g),a.moveTo(b,d),a.lineTo(b,k),a.moveTo(b-c,e-c),a.lineTo(b+c,e+c),a.moveTo(b+c,e-c),a.lineTo(b-c,e+c),a.stroke();return}a.closePath(),a.stroke()}function s(a,b,c){this.x=a,this.y=b,this.z=c}z=s.prototype,z.length=function(){return E(this.x*this.x+this.y*this.y+this.z*this.z)},z.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},z.cross=function(a){var b=this.y*a.z-this.z*a.y,c=this.z*a.x-this.x*a.z,d=this.x*a.y-this.y*a.x;return new s(b,c,d)},z.angle=function(b){var c=this.dot(b),a;return c==0?Math.PI/2:(a=c/(this.length()*b.length()),a>=1)?0:a<=-1?Math.PI:Math.acos(a)},z.unit=function(){var a=this.length();return new s(this.x/a,this.y/a,this.z/a)};function ay(b,a){a=a*Math.PI/180,b=b*Math.PI/180;var c=o(b)*l(a),d=-o(a),e=-l(b)*l(a);return new s(c,d,e)}function m(a){this[1]={1:a[0],2:a[1],3:a[2]},this[2]={1:a[3],2:a[4],3:a[5]},this[3]={1:a[6],2:a[7],3:a[8]}}T=m.prototype,m.Identity=function(){return new m([1,0,0,0,1,0,0,0,1])},m.Rotation=function(e,a){var c=o(e),d=l(e),b=1-d;return new m([d+w(a.x,2)*b,a.x*a.y*b-a.z*c,a.x*a.z*b+a.y*c,a.y*a.x*b+a.z*c,d+w(a.y,2)*b,a.y*a.z*b-a.x*c,a.z*a.x*b-a.y*c,a.z*a.y*b+a.x*c,d+w(a.z,2)*b])},T.mul=function(c){var d=[],a,b,e=c.xform?1:0;for(a=1;a<=3;++a)for(b=1;b<=3;++b)e?d.push(this[a][1]*c[1][b]+this[a][2]*c[2][b]+this[a][3]*c[3][b]):d.push(this[a][b]*c);return new m(d)},T.xform=function(b){var a={},c=b.x,d=b.y,e=b.z;return a.x=c*this[1][1]+d*this[2][1]+e*this[3][1],a.y=c*this[1][2]+d*this[2][2]+e*this[3][2],a.z=c*this[1][3]+d*this[2][3]+e*this[3][3],a};function aB(g,j,k,m,f){var a,b,c,d,e=[],h=2/g,i;i=Math.PI*(3-E(5)+(parseFloat(f)?parseFloat(f):0));for(a=0;a<g;++a)b=a*h-1+h/2,c=E(1-b*b),d=a*i,e.push([l(d)*c*j,b*k,o(d)*c*m]);return e}function U(n,p,m,k,h,g){var b,f=[],i=2/n,j,a,d,c,e;j=Math.PI*(3-E(5)+(parseFloat(g)?parseFloat(g):0));for(a=0;a<n;++a)d=a*i-1+i/2,b=a*j,c=l(b),e=o(b),f.push(p?[d*m,c*k,e*h]:[c*m,d*k,e*h]);return f}function aa(k,e,f,h,i,j){var b,g=[],m=Math.PI*2/e,a,c,d;for(a=0;a<e;++a)b=a*m,c=l(b),d=o(b),g.push(k?[j*f,c*h,d*i]:[c*f,j*h,d*i]);return g}function ax(a,b,c,d,e){return U(a,0,b,c,d,e)}function aH(a,b,c,d,e){return U(a,1,b,c,d,e)}function aG(b,c,d,e,a){return a=isNaN(a)?0:a*1,aa(0,b,c,d,e,a)}function aF(b,c,d,e,a){return a=isNaN(a)?0:a*1,aa(1,b,c,d,e,a)}function av(b){var a=new Image;a.onload=function(){var c=a.width/2,d=a.height/2;b.centreFunc=function(b,g,h,e,f){b.setTransform(1,0,0,1,0,0),b.globalAlpha=1,b.drawImage(a,e-c,f-d)}},a.src=b.centreImage}function aE(a,c){var b=a,d,e,f=(c*1).toPrecision(3)+')';return a[0]==='#'?(I[a]||(a.length===4?I[a]='rgba('+R[a[1]]+R[a[2]]+R[a[3]]:I[a]='rgba('+D[a.substr(1,2)]+D[a.substr(3,2)]+D[a.substr(5,2)]),b=I[a]+f):a.substr(0,4)==='rgb('||a.substr(0,4)==='hsl('?b=a.replace('(','a(').replace(')',','+f):(a.substr(0,5)==='rgba('||a.substr(0,5)==='hsla(')&&(d=a.lastIndexOf(',')+1,e=a.indexOf(')'),c*=parseFloat(a.substring(d,e)),b=a.substr(0,d)+c.toPrecision(3)+')'),b}function k(b,d){if(window.G_vmlCanvasManager)return null;var a=c.createElement('canvas');return a.width=b,a.height=d,a}function aD(){var b=k(3,3),a,c;return!!b&&(a=b.getContext('2d'),a.strokeStyle='#000',a.shadowColor='#fff',a.shadowBlur=3,a.globalAlpha=0,a.strokeRect(2,2,2,2),a.globalAlpha=1,c=a.getImageData(2,2,1,1),b=null,c.data[0]>0)}function aC(a,c,f,d){var e=a.createLinearGradient(0,0,c,0),b;for(b in d)e.addColorStop(1-b,d[b]);a.fillStyle=e,a.fillRect(0,f,c,1)}function L(a,m,j){var l=1024,d=1,e=a.weightGradient,i,f,b,c;if(a.gCanvas)f=a.gCanvas.getContext('2d'),d=a.gCanvas.height;else{if(B(e[0])?d=e.length:e=[e],a.gCanvas=i=k(l,d),!i)return null;f=i.getContext('2d');for(b=0;b<d;++b)aC(f,l,b,e[b])}return j=g(h(j||0,d-1),0),c=f.getImageData(~~((l-1)*m),j,1,1).data,'rgba('+c[0]+','+c[1]+','+c[2]+','+c[3]/255+')'}function Y(b,i,q,k,o,n,h,d,a,g,f,l){var m=o+(d||0)+(a.length&&a[0]<0?p(a[0]):0),j=n+(d||0)+(a.length&&a[1]<0?p(a[1]):0),c,e;b.font=i,b.textBaseline='top',b.fillStyle=q,h&&(b.shadowColor=h),d&&(b.shadowBlur=d),a.length&&(b.shadowOffsetX=a[0],b.shadowOffsetY=a[1]);for(c=0;c<k.length;++c)e=0,f&&('right'==l?e=g-f[c]:'centre'==l&&(e=(g-f[c])/2)),b.fillText(k[c],m+e,j),j+=parseInt(i)}function y(d,a,b,f,e,c,g){c?(d.beginPath(),d.moveTo(a,b+e-c),d.arcTo(a,b,a+c,b,c),d.arcTo(a+f,b,a+f,b+c,c),d.arcTo(a+f,b+e,a+f-c,b+e,c),d.arcTo(a,b+e,a,b+e-c,c),d.closePath(),d[g?'stroke':'fill']()):d[g?'strokeRect':'fillRect'](a,b,f,e)}function O(a,b,c,d,e,f,g,h,i){this.strings=a,this.font=b,this.width=c,this.height=d,this.maxWidth=e,this.stringWidths=f,this.align=g,this.valign=h,this.scale=i}M=O.prototype,M.SetImage=function(a,b,c,d,e,f,g,h){this.image=a,this.iwidth=b*this.scale,this.iheight=c*this.scale,this.ipos=d,this.ipad=e*this.scale,this.iscale=h,this.ialign=f,this.ivalign=g},M.Align=function(c,d,a){var b=0;return a=='right'||a=='bottom'?b=d-c:a!='left'&&a!='top'&&(b=(d-c)/2),b},M.Create=function(G,D,F,b,A,m,q,j,E){var o,e,f,a,l,s,i,u,v,r,w,n,c,d,x,B=p(q[0]),C=p(q[1]),t,z;return j=g(j,B+m,C+m),l=2*(j+b),i=2*(j+b),e=this.width+l,f=this.height+i,v=r=j+b,this.image&&(w=n=j+b,c=this.iwidth,d=this.iheight,this.ipos=='top'||this.ipos=='bottom'?(c<this.width?w+=this.Align(c,this.width,this.ialign):v+=this.Align(this.width,c,this.align),this.ipos=='top'?r+=d+this.ipad:n+=this.height+this.ipad,e=g(e,c+l),f+=d+this.ipad):(d<this.height?n+=this.Align(d,this.height,this.ivalign):r+=this.Align(this.height,d,this.valign),this.ipos=='right'?w+=this.width+this.ipad:v+=c+this.ipad,e+=c+this.ipad,f=g(f,d+i))),o=k(e,f),!o?null:(l=i=b/2,s=e-b,u=f-b,x=h(E,s/2,u/2),a=o.getContext('2d'),D&&(a.fillStyle=D,y(a,l,i,s,u,x)),b&&(a.strokeStyle=F,a.lineWidth=b,y(a,l,i,s,u,x,!0)),(m||B||C)&&(t=k(e,f),t&&(z=a,a=t.getContext('2d'))),Y(a,this.font,G,this.strings,v,r,0,0,[],this.maxWidth,this.stringWidths,this.align),this.image&&a.drawImage(this.image,w,n,c,d),z&&(a=z,A&&(a.shadowColor=A),m&&(a.shadowBlur=m),a.shadowOffsetX=q[0],a.shadowOffsetY=q[1],a.drawImage(t,0,0)),o)};function H(a,c,d){var b=k(c,d),e;return b?(e=b.getContext('2d'),e.drawImage(a,(c-a.width)/2,(d-a.height)/2),b):null}function S(e,b,c){var a=k(b,c),d;return a?(d=a.getContext('2d'),d.drawImage(e,0,0,b,c),a):null}function W(n,u,t,e,s,c,v,d,r,w){var g=u+(2*d+c)*e,f=t+(2*d+c)*e,l=k(g,f),b,i,q,m,j,o,a,p;return l?(c*=e,r*=e,i=q=c/2,m=g-c,j=f-c,d=d*e+i,b=l.getContext('2d'),p=h(r,m/2,j/2),s&&(b.fillStyle=s,y(b,i,q,m,j,p)),c&&(b.strokeStyle=v,b.lineWidth=c,y(b,i,q,m,j,p,!0)),w?(o=k(g,f),a=o.getContext('2d'),a.drawImage(n,d,d,u,t),a.globalCompositeOperation='source-in',a.fillStyle=v,a.fillRect(0,0,g,f),a.globalCompositeOperation='destination-over',a.drawImage(l,0,0),a.globalCompositeOperation='source-over',b.drawImage(o,0,0)):b.drawImage(n,d,d,n.width,n.height),{image:l,width:g/e,height:f/e}):null}function at(l,f,c,d,j){var e,a,b=parseFloat(f),i=g(c,d);return e=k(c,d),!e?null:(f.indexOf('%')>0?b=i*b/100:b=b*j,a=e.getContext('2d'),a.globalCompositeOperation='source-over',a.fillStyle='#fff',b>=i/2?(b=h(c,d)/2,a.beginPath(),a.moveTo(c/2,d/2),a.arc(c/2,d/2,b,0,2*Math.PI,!1),a.fill(),a.closePath()):(b=h(c/2,d/2,b),y(a,0,0,c,d,b,!0),a.fill()),a.globalCompositeOperation='source-in',a.drawImage(l,0,0,c,d),e)}function ao(q,m,i,b,h,a,c){var g=p(c[0]),f=p(c[1]),j=m+(g>a?g+a:a*2)*b,l=i+(f>a?f+a:a*2)*b,n=b*((a||0)+(c[0]<0?g:0)),o=b*((a||0)+(c[1]<0?f:0)),e,d;return e=k(j,l),!e?null:(d=e.getContext('2d'),h&&(d.shadowColor=h),a&&(d.shadowBlur=a*b),c&&(d.shadowOffsetX=c[0]*b,d.shadowOffsetY=c[1]*b),d.drawImage(q,n,o,m,i),{image:e,width:j/b,height:l/b})}function ae(m,o,l){var c=parseInt(m.toString().length*l),h=parseInt(l*2*m.length),j=k(c,h),g,i,e,f,b,d,n,a;if(!j)return null;g=j.getContext('2d'),g.fillStyle='#000',g.fillRect(0,0,c,h),Y(g,l+'px '+o,'#fff',m,0,0,0,0,[],'centre'),i=g.getImageData(0,0,c,h),e=i.width,f=i.height,a={min:{x:e,y:f},max:{x:-1,y:-1}};for(d=0;d<f;++d)for(b=0;b<e;++b)n=(d*e+b)*4,i.data[n+1]>0&&(b<a.min.x&&(a.min.x=b),b>a.max.x&&(a.max.x=b),d<a.min.y&&(a.min.y=d),d>a.max.y&&(a.max.y=d));return e!=c&&(a.min.x*=c/e,a.max.x*=c/e),f!=h&&(a.min.y*=c/f,a.max.y*=c/f),j=null,a}function Q(a){return"'"+a.replace(/('|")/g,'').replace(/s*,s*/g,"', '")+"'"}function t(b,d,a){a=a||c,a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent('on'+b,d)}function am(b,d,a){a=a||c,a.removeEventListener?a.removeEventListener(b,d):a.detachEvent('on'+b,d)}function A(g,e,j,a,b){var l=b.imageScale,h,c,k,m,f,d;if(!e.complete)return t('load',function(){A(g,e,j,a,b)},e);if(!g.complete)return t('load',function(){A(g,e,j,a,b)},g);if(j&&!j.complete)return t('load',function(){A(g,e,j,a,b)},j);e.width=e.width,e.height=e.height,l&&(g.width=e.width*l,g.height=e.height*l),a.iw=g.width,a.ih=g.height,b.txtOpt&&(c=g,h=b.zoomMax*b.txtScale,f=a.iw*h,d=a.ih*h,f<e.naturalWidth||d<e.naturalHeight?(c=S(g,f,d),c&&(a.fimage=c)):(f=a.iw,d=a.ih,h=1),parseFloat(b.imageRadius)&&(a.image=a.fimage=g=at(a.image,b.imageRadius,f,d,h)),a.HasText()||(b.shadow&&(c=ao(a.image,f,d,h,b.shadow,b.shadowBlur,b.shadowOffset),c&&(a.fimage=c.image,a.w=c.width,a.h=c.height)),(b.bgColour||b.bgOutlineThickness)&&(k=b.bgColour=='tag'?i(a.a,'background-color'):b.bgColour,m=b.bgOutline=='tag'?i(a.a,'color'):b.bgOutline||b.textColour,f=a.fimage.width,d=a.fimage.height,b.outlineMethod=='colour'&&(c=W(a.fimage,f,d,h,k,b.bgOutlineThickness,a.outline.colour,b.padding,b.bgRadius,1),c&&(a.oimage=c.image)),c=W(a.fimage,f,d,h,k,b.bgOutlineThickness,m,b.padding,b.bgRadius),c&&(a.fimage=c.image,a.w=c.width,a.h=c.height)),b.outlineMethod=='size'&&(b.outlineIncrease>0?(a.iw+=2*b.outlineIncrease,a.ih+=2*b.outlineIncrease,f=h*a.iw,d=h*a.ih,c=S(a.fimage,f,d),a.oimage=c,a.fimage=H(a.fimage,a.oimage.width,a.oimage.height)):(f=h*(a.iw+2*b.outlineIncrease),d=h*(a.ih+2*b.outlineIncrease),c=S(a.fimage,f,d),a.oimage=H(c,a.fimage.width,a.fimage.height))))),a.alt=j,a.Init()}function i(a,d){var b=c.defaultView,e=d.replace(/-([a-z])/g,function(a){return a.charAt(1).toUpperCase()});return b&&b.getComputedStyle&&b.getComputedStyle(a,null).getPropertyValue(d)||a.currentStyle&&a.currentStyle[e]}function aj(c,d,e){var b=1,a;return d?b=1*(c.getAttribute(d)||e):(a=i(c,'font-size'))&&(b=a.indexOf('px')>-1&&a.replace('px','')*1||a.indexOf('pt')>-1&&a.replace('pt','')*1.25||a*3.3),b}function u(a){return a.target&&n(a.target.id)?a.target.id:a.srcElement.parentNode.id}function K(a,c){var b,d,e=parseInt(i(c,'width'))/c.width,f=parseInt(i(c,'height'))/c.height;return n(a.offsetX)?b={x:a.offsetX,y:a.offsetY}:(d=X(c.id),n(a.changedTouches)&&(a=a.changedTouches[0]),a.pageX&&(b={x:a.pageX-d.x,y:a.pageY-d.y})),b&&e&&f&&(b.x/=e,b.y/=f),b}function an(c){var d=c.target||c.fromElement.parentNode,b=a.tc[d.id];b&&(b.mx=b.my=-1,b.UnFreeze(),b.EndDrag())}function ad(e){var g,c=a,b,d,f=u(e);for(g in c.tc)b=c.tc[g],b.tttimer&&(clearTimeout(b.tttimer),b.tttimer=null);f&&c.tc[f]&&(b=c.tc[f],(d=K(e,b.canvas))&&(b.mx=d.x,b.my=d.y,b.Drag(e,d)),b.drawn=0)}function ap(b){var e=a,f=c.addEventListener?0:1,d=u(b);d&&b.button==f&&e.tc[d]&&e.tc[d].BeginDrag(b)}function aq(b){var f=a,g=c.addEventListener?0:1,e=u(b),d;e&&b.button==g&&f.tc[e]&&(d=f.tc[e],ad(b),!d.EndDrag()&&!d.touchState&&d.Clicked(b))}function ar(c){var e=u(c),b=e&&a.tc[e],d;b&&c.changedTouches&&(c.touches.length==1&&b.touchState==0?(b.touchState=1,b.BeginDrag(c),(d=K(c,b.canvas))&&(b.mx=d.x,b.my=d.y,b.drawn=0)):c.targetTouches.length==2&&b.pinchZoom?(b.touchState=3,b.EndDrag(),b.BeginPinch(c)):(b.EndDrag(),b.EndPinch(),b.touchState=0))}function ac(c){var d=u(c),b=d&&a.tc[d];if(b&&c.changedTouches){switch(b.touchState){case 1:b.Draw(),b.Clicked();break;break;case 2:b.EndDrag();break;case 3:b.EndPinch()}b.touchState=0}}function au(c){var f,e=a,b,d,g=u(c);for(f in e.tc)b=e.tc[f],b.tttimer&&(clearTimeout(b.tttimer),b.tttimer=null);if(b=g&&e.tc[g],b&&c.changedTouches&&b.touchState){switch(b.touchState){case 1:case 2:(d=K(c,b.canvas))&&(b.mx=d.x,b.my=d.y,b.Drag(c,d)&&(b.touchState=2));break;case 3:b.Pinch(c)}b.drawn=0}}function ab(b){var d=a,c=u(b);c&&d.tc[c]&&(b.cancelBubble=!0,b.returnValue=!1,b.preventDefault&&b.preventDefault(),d.tc[c].Wheel((b.wheelDelta||b.detail)>0))}function aw(d){var c,b=a;clearTimeout(b.scrollTimer);for(c in b.tc)b.tc[c].Pause();b.scrollTimer=setTimeout(function(){var b,c=a;for(b in c.tc)c.tc[b].Resume()},b.scrollPause)}function al(){Z(q())}function Z(b){var c=a.tc,d;a.NextFrame(a.interval),b=b||q();for(d in c)c[d].Draw(b)}function az(){requestAnimationFrame(Z)}function aA(a){setTimeout(al,a)}function X(f){var g=c.getElementById(f),b=g.getBoundingClientRect(),a=c.documentElement,d=c.body,e=window,h=e.pageXOffset||a.scrollLeft,i=e.pageYOffset||a.scrollTop,j=a.clientLeft||d.clientLeft,k=a.clientTop||d.clientTop;return{x:b.left+h-j,y:b.top+i-k}}function aI(a,b,d,e){var c=a.radius*a.z1/(a.z1+a.z2+b.z);return{x:b.x*c*d,y:b.y*c*e,z:b.z,w:(a.z1-b.z)/a.z2}}function V(a){this.e=a,this.br=0,this.line=[],this.text=[],this.original=a.innerText||a.textContent}F=V.prototype,F.Empty=function(){for(var a=0;a<this.text.length;++a)if(this.text[a].length)return!1;return!0},F.Lines=function(c){var e=c?1:0,b,d,a;c=c||this.e,b=c.childNodes,d=b.length;for(a=0;a<d;++a)b[a].nodeName=='BR'?(this.text.push(this.line.join(' ')),this.br=1):b[a].nodeType==3?this.br?(this.line=[b[a].nodeValue],this.br=0):this.line.push(b[a].nodeValue):this.Lines(b[a]);return e||this.br||this.text.push(this.line.join(' ')),this.text},F.SplitWidth=function(h,e,f,g){var c,b,a,d=[];e.font=g+'px '+f;for(c=0;c<this.text.length;++c){a=this.text[c].split(/s+/),this.line=[a[0]];for(b=1;b<a.length;++b)e.measureText(this.line.join(' ')+' '+a[b]).width>h?(d.push(this.line.join(' ')),this.line=[a[b]]):this.line.push(a[b]);d.push(this.line.join(' '))}return this.text=d};function _(a,b){this.ts=null,this.tc=a,this.tag=b,this.x=this.y=this.w=this.h=this.sc=1,this.z=0,this.pulse=1,this.pulsate=a.pulsateTo<1,this.colour=a.outlineColour,this.adash=~~a.outlineDash,this.agap=~~a.outlineDashSpace||this.adash,this.aspeed=a.outlineDashSpeed*1,this.colour=='tag'?this.colour=i(b.a,'color'):this.colour=='tagbg'&&(this.colour=i(b.a,'background-color')),this.Draw=this.pulsate?this.DrawPulsate:this.DrawSimple,this.radius=a.outlineRadius|0,this.SetMethod(a.outlineMethod,a.altImage)}f=_.prototype,f.SetMethod=function(a,d){var b={block:['PreDraw','DrawBlock'],colour:['PreDraw','DrawColour'],outline:['PostDraw','DrawOutline'],classic:['LastDraw','DrawOutline'],size:['PreDraw','DrawSize'],none:['LastDraw']},c=b[a]||b.outline;a=='none'?this.Draw=function(){return 1}:this.drawFunc=this[c[1]],this[c[0]]=this.Draw,d&&(this.RealPreDraw=this.PreDraw,this.PreDraw=this.DrawAlt)},f.Update=function(d,e,i,j,a,f,g,h){var b=this.tc.outlineOffset,c=2*b;this.x=a*d+g-b,this.y=a*e+h-b,this.w=a*i+c,this.h=a*j+c,this.sc=a,this.z=f},f.Ants=function(k){if(!this.adash)return;var b=this.adash,c=this.agap,a=this.aspeed,j=b+c,h=0,g=b,f=c,i=0,d=0,e;a&&(d=p(a)*(q()-this.ts)/50,a<0&&(d=864e4-d),a=~~d%j),a?(b>=a?(h=b-a,g=a):(f=j-a,i=c-f),e=[h,f,g,i]):e=[b,c],k.setLineDash(e)},f.DrawOutline=function(a,d,e,b,c,f){var g=h(this.radius,c/2,b/2);a.strokeStyle=f,this.Ants(a),y(a,d,e,b,c,g,!0)},f.DrawSize=function(i,n,m,l,k,j,a,h,g){var f=a.w,e=a.h,c,b,d;return this.pulsate?(a.image?d=(a.image.height+this.tc.outlineIncrease)/a.image.height:d=a.oscale,b=a.fimage||a.image,c=1+(d-1)*(1-this.pulse),a.h*=c,a.w*=c):b=a.oimage,a.alpha=1,a.Draw(i,h,g,b),a.h=e,a.w=f,1},f.DrawColour=function(d,h,i,e,f,g,a,b,c){return a.oimage?(this.pulse<1?(a.alpha=1-w(this.pulse,2),a.Draw(d,b,c,a.fimage),a.alpha=this.pulse):a.alpha=1,a.Draw(d,b,c,a.oimage),1):this[a.image?'DrawColourImage':'DrawColourText'](d,h,i,e,f,g,a,b,c)},f.DrawColourText=function(f,h,i,j,g,e,a,b,c){var d=a.colour;return a.colour=e,a.alpha=1,a.Draw(f,b,c),a.colour=d,1},f.DrawColourImage=function(a,q,p,o,n,m,i,r,l){var f=a.canvas,e=~~g(q,0),d=~~g(p,0),c=h(f.width-e,o)+.5|0,b=h(f.height-d,n)+.5|0,j;return v?(v.width=c,v.height=b):v=k(c,b),!v?this.SetMethod('outline'):(j=v.getContext('2d'),j.drawImage(f,e,d,c,b,0,0,c,b),a.clearRect(e,d,c,b),this.pulsate?i.alpha=1-w(this.pulse,2):i.alpha=1,i.Draw(a,r,l),a.setTransform(1,0,0,1,0,0),a.save(),a.beginPath(),a.rect(e,d,c,b),a.clip(),a.globalCompositeOperation='source-in',a.fillStyle=m,a.fillRect(e,d,c,b),a.restore(),a.globalAlpha=1,a.globalCompositeOperation='destination-over',a.drawImage(v,0,0,c,b,e,d,c,b),a.globalCompositeOperation='source-over',1)},f.DrawAlt=function(b,a,c,d,f,g){var e=this.RealPreDraw(b,a,c,d,f,g);return a.alt&&(a.DrawImage(b,c,d,a.alt),e=1),e},f.DrawBlock=function(a,d,e,b,c,f){var g=h(this.radius,c/2,b/2);a.fillStyle=f,y(a,d,e,b,c,g)},f.DrawSimple=function(a,b,c,d,e,f){var g=this.tc;return a.setTransform(1,0,0,1,0,0),a.strokeStyle=this.colour,a.lineWidth=g.outlineThickness,a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0,a.globalAlpha=f?e:1,this.drawFunc(a,this.x,this.y,this.w,this.h,this.colour,b,c,d)},f.DrawPulsate=function(h,d,e,f){var g=q()-this.ts,c=this.tc,b=c.pulsateTo+(1-c.pulsateTo)*(.5+l(2*Math.PI*g/(1e3*c.pulsateTime))/2);return this.pulse=b=a.Smooth(1,b),this.DrawSimple(h,d,e,f,b,1)},f.Active=function(d,a,b){var c=a>=this.x&&b>=this.y&&a<=this.x+this.w&&b<=this.y+this.h;return c?this.ts=this.ts||q():this.ts=null,c},f.PreDraw=f.PostDraw=f.LastDraw=x;function J(a,h,c,b,e,f,g,d,i,j,k,l,m,n){this.tc=a,this.image=null,this.text=h,this.text_original=n,this.line_widths=[],this.title=c.title||null,this.a=c,this.position=new s(b[0],b[1],b[2]),this.x=this.y=this.z=0,this.w=e,this.h=f,this.colour=g||a.textColour,this.bgColour=d||a.bgColour,this.bgRadius=i|0,this.bgOutline=j||this.colour,this.bgOutlineThickness=k|0,this.textFont=l||a.textFont,this.padding=m|0,this.sc=this.alpha=1,this.weighted=!a.weight,this.outline=new _(a,this),this.audio=null}d=J.prototype,d.Init=function(b){var a=this.tc;this.textHeight=a.textHeight,this.HasText()?this.Measure(a.ctxt,a):(this.w=this.iw,this.h=this.ih),this.SetShadowColour=a.shadowAlpha?this.SetShadowColourAlpha:this.SetShadowColourFixed,this.SetDraw(a)},d.Draw=x,d.HasText=function(){return this.text&&this.text[0].length>0},d.EqualTo=function(a){var b=a.getElementsByTagName('img');return this.a.href!=a.href?0:b.length?this.image.src==b[0].src:(a.innerText||a.textContent)==this.text_original},d.SetImage=function(a){this.image=this.fimage=a},d.SetAudio=function(a){this.audio=a,this.audio.load()},d.SetDraw=function(a){this.Draw=this.fimage?a.ie>7?this.DrawImageIE:this.DrawImage:this.DrawText,a.noSelect&&(this.CheckActive=x)},d.MeasureText=function(d){var a,e=this.text.length,b=0,c;for(a=0;a<e;++a)this.line_widths[a]=c=d.measureText(this.text[a]).width,b=g(b,c);return b},d.Measure=function(e,a){var f=ae(this.text,this.textFont,this.textHeight),b,k,h,i,g,l,j,c,d;j=f?f.max.y+f.min.y:this.textHeight,e.font=this.font=this.textHeight+'px '+this.textFont,l=this.MeasureText(e),a.txtOpt&&(b=a.txtScale,k=b*this.textHeight,h=k+'px '+this.textFont,i=[b*a.shadowOffset[0],b*a.shadowOffset[1]],e.font=h,g=this.MeasureText(e),d=new O(this.text,h,g+b,b*j+b,g,this.line_widths,a.textAlign,a.textVAlign,b),this.image&&d.SetImage(this.image,this.iw,this.ih,a.imagePosition,a.imagePadding,a.imageAlign,a.imageVAlign,a.imageScale),c=d.Create(this.colour,this.bgColour,this.bgOutline,b*this.bgOutlineThickness,a.shadow,b*a.shadowBlur,i,b*this.padding,b*this.bgRadius),a.outlineMethod=='colour'?this.oimage=d.Create(this.outline.colour,this.bgColour,this.outline.colour,b*this.bgOutlineThickness,a.shadow,b*a.shadowBlur,i,b*this.padding,b*this.bgRadius):a.outlineMethod=='size'&&(f=ae(this.text,this.textFont,this.textHeight+a.outlineIncrease),k=f.max.y+f.min.y,h=b*(this.textHeight+a.outlineIncrease)+'px '+this.textFont,e.font=h,g=this.MeasureText(e),d=new O(this.text,h,g+b,b*k+b,g,this.line_widths,a.textAlign,a.textVAlign,b),this.image&&d.SetImage(this.image,this.iw+a.outlineIncrease,this.ih+a.outlineIncrease,a.imagePosition,a.imagePadding,a.imageAlign,a.imageVAlign,a.imageScale),this.oimage=d.Create(this.colour,this.bgColour,this.bgOutline,b*this.bgOutlineThickness,a.shadow,b*a.shadowBlur,i,b*this.padding,b*this.bgRadius),this.oscale=this.oimage.width/c.width,a.outlineIncrease>0?c=H(c,this.oimage.width,this.oimage.height):this.oimage=H(this.oimage,c.width,c.height)),c&&(this.fimage=c,l=this.fimage.width/b,j=this.fimage.height/b),this.SetDraw(a),a.txtOpt=!!this.fimage),this.h=j,this.w=l},d.SetFont=function(a,b,c,d){this.textFont=a,this.colour=b,this.bgColour=c,this.bgOutline=d,this.Measure(this.tc.ctxt,this.tc)},d.SetWeight=function(c){var b=this.tc,e=b.weightMode.split(/[, ]/),d,a,f=c.length;if(!this.HasText())return;this.weighted=!0;for(a=0;a<f;++a)d=e[a]||'size','both'==d?(this.Weight(c[a],b.ctxt,b,'size',b.min_weight[a],b.max_weight[a],a),this.Weight(c[a],b.ctxt,b,'colour',b.min_weight[a],b.max_weight[a],a)):this.Weight(c[a],b.ctxt,b,d,b.min_weight[a],b.max_weight[a],a);this.Measure(b.ctxt,b)},d.Weight=function(b,i,a,d,f,h,e){b=isNaN(b)?1:b;var c=(b-f)/(h-f);'colour'==d?this.colour=L(a,c,e):'bgcolour'==d?this.bgColour=L(a,c,e):'bgoutline'==d?this.bgOutline=L(a,c,e):'outline'==d?this.outline.colour=L(a,c,e):'size'==d&&(a.weightSizeMin>0&&a.weightSizeMax>a.weightSizeMin?this.textHeight=a.weightSize*(a.weightSizeMin+(a.weightSizeMax-a.weightSizeMin)*c):this.textHeight=g(1,b*a.weightSize))},d.SetShadowColourFixed=function(a,b,c){a.shadowColor=b},d.SetShadowColourAlpha=function(a,b,c){a.shadowColor=aE(b,c)},d.DrawText=function(a,h,i){var e=this.tc,g=this.x,f=this.y,c=this.sc,b,d;a.globalAlpha=this.alpha,a.fillStyle=this.colour,e.shadow&&this.SetShadowColour(a,e.shadow,this.alpha),a.font=this.font,g+=h/c,f+=i/c-this.h/2;for(b=0;b<this.text.length;++b)d=g,'right'==e.textAlign?d+=this.w/2-this.line_widths[b]:'centre'==e.textAlign?d-=this.line_widths[b]/2:d-=this.w/2,a.setTransform(c,0,0,c,c*d,c*f),a.fillText(this.text[b],0,0),f+=this.textHeight},d.DrawImage=function(b,i,k,l){var e=this.x,f=this.y,a=this.sc,j=l||this.fimage,c=this.w,d=this.h,g=this.alpha,h=this.shadow;b.globalAlpha=g,h&&this.SetShadowColour(b,h,g),e+=i/a-c/2,f+=k/a-d/2,b.setTransform(a,0,0,a,a*e,a*f),b.drawImage(j,0,0,c,d)},d.DrawImageIE=function(b,d,e){var c=this.fimage,a=this.sc,f=c.width=this.w*a,g=c.height=this.h*a,h=this.x*a+d-f/2,i=this.y*a+e-g/2;b.setTransform(1,0,0,1,0,0),b.globalAlpha=this.alpha,b.drawImage(c,h,i)},d.Calc=function(g,e){var a,b=this.tc,d=b.minBrightness,f=b.maxBrightness,c=b.max_radius;return a=g.xform(this.position),this.xformed=a,a=aI(b,a,b.stretchX,b.stretchY),this.x=a.x,this.y=a.y,this.z=a.z,this.sc=a.w,this.alpha=e*G(d+(f-d)*(c-this.z)/(2*c),0,1),this.xformed},d.UpdateActive=function(h,e,f){var a=this.outline,b=this.w,c=this.h,d=this.x-b/2,g=this.y-c/2;return a.Update(d,g,b,c,this.sc,this.z,e,f),a},d.CheckActive=function(a,d,e){var b=this.tc,c=this.UpdateActive(a,d,e);return c.Active(a,b.mx,b.my)?c:null},d.Clicked=function(f){var b=this.a,a=b.target,d=b.href,e;if(a!=''&&a!='_self'){if(self.frames[a])self.frames[a].document.location=d;else{try{if(top.frames[a]){top.frames[a].document.location=d;return}}catch(a){}window.open(d,a)}return}if(c.createEvent){if(e=c.createEvent('MouseEvents'),e.initMouseEvent('click',1,1,window,0,0,0,0,0,0,0,0,0,0,null),!b.dispatchEvent(e))return}else if(b.fireEvent)if(!b.fireEvent('onclick'))return;c.location=d},d.StopAudio=function(){this.audio&&this.playing&&this.audio.pause(),this.stopped=1,this.playing=0},d.PlayAudio=function(){if(e==='off'||this.tc.audioOff)return;if(!e&&!ag())return;var a=this.tc.audio,c=this.tc.gain,d='suspended',b;if(this.audio)if(this.track||(this.track=e.createMediaElementSource(this.audio),this.gain=e.createGain(),this.track.connect(this.gain),this.gain.connect(e.destination)),a=this.audio,c=this.gain,!a.paused)return 1;if(a){if(e.state==d&&e.resume(),e.state==d)return;return c.gain.value=h(2,g(0,this.tc.audioVolume*1)),a.currentTime=0,this.stopped=0,b=a.play(),b!==void 0&&b.then(a=>{this.stopped?this.audio.pause():this.playing=1}),1}};function a(f,o,k){var d,i,b=c.getElementById(f),l=['id','class','innerHTML'];if(!b)throw 0;if(n(window.G_vmlCanvasManager)&&(b=window.G_vmlCanvasManager.initElement(b),this.ie=parseFloat(navigator.appVersion.split('MSIE')[1])),b&&(!b.getContext||!b.getContext('2d').fillText)){i=c.createElement('DIV');for(d=0;d<l.length;++d)i[l[d]]=b[l[d]];throw b.parentNode.insertBefore(i,b),b.parentNode.removeChild(b),0}for(d in a.options)this[d]=k&&n(k[d])?k[d]:n(a[d])?a[d]:a.options[d];if(this.canvas=b,this.ctxt=b.getContext('2d'),this.z1=250/g(this.depth,.001),this.z2=this.z1/this.zoom,this.radius=h(b.height,b.width)*.0075,this.max_radius=100,this.max_weight=[],this.min_weight=[],this.textFont=this.textFont&&Q(this.textFont),this.textHeight*=1,this.imageRadius=this.imageRadius.toString(),this.pulsateTo=G(this.pulsateTo,0,1),this.minBrightness=G(this.minBrightness,0,1),this.maxBrightness=G(this.maxBrightness,this.minBrightness,1),this.ctxt.textBaseline='top',this.lx=(this.lock+'').indexOf('x')+1,this.ly=(this.lock+'').indexOf('y')+1,this.frozen=this.dx=this.dy=this.fixedAnim=this.touchState=0,this.fixedAlpha=1,this.source=o||f,this.repeatTags=h(64,~~this.repeatTags),this.minTags=h(200,~~this.minTags),~~this.scrollPause>0?a.scrollPause=~~this.scrollPause:this.scrollPause=0,this.minTags>0&&this.repeatTags<1&&(d=this.GetTags().length)&&(this.repeatTags=af(this.minTags/d)-1),this.transform=m.Identity(),this.startTime=this.time=q(),this.mx=this.my=-1,this.centreImage&&av(this),this.Animate=this.dragControl?this.AnimateDrag:this.AnimatePosition,this.animTiming=typeof a[this.animTiming]=='function'?a[this.animTiming]:a.Smooth,this.shadowBlur||this.shadowOffset[0]||this.shadowOffset[1]?(this.ctxt.shadowColor=this.shadow,this.shadow=this.ctxt.shadowColor,this.shadowAlpha=aD()):delete this.shadow,this.activeAudio===!1?e='off':this.activeAudio&&this.LoadAudio(),this.Load(),o&&this.hideTags&&function(b){a.loaded?b.HideTags():t('load',function(){b.HideTags()},window)}(this),this.yaw=this.initial?this.initial[0]*this.maxSpeed:0,this.pitch=this.initial?this.initial[1]*this.maxSpeed:0,this.tooltip?(this.ctitle=b.title,b.title='',this.tooltip=='native'?this.Tooltip=this.TooltipNative:(this.Tooltip=this.TooltipDiv,this.ttdiv||(this.ttdiv=c.createElement('div'),this.ttdiv.className=this.tooltipClass,this.ttdiv.style.position='absolute',this.ttdiv.style.zIndex=b.style.zIndex+1,t('mouseover',function(a){a.target.style.display='none'},this.ttdiv),c.body.appendChild(this.ttdiv)))):this.Tooltip=this.TooltipNone,!this.noMouse&&!j[f]){j[f]=[['mousemove',ad],['mouseout',an],['mouseup',aq],['touchstart',ar],['touchend',ac],['touchcancel',ac],['touchmove',au]],this.dragControl&&(j[f].push(['mousedown',ap]),j[f].push(['selectstart',x])),this.wheelZoom&&(j[f].push(['mousewheel',ab]),j[f].push(['DOMMouseScroll',ab])),this.scrollPause&&j[f].push(['scroll',aw,window]);for(d=0;d<j[f].length;++d)i=j[f][d],t(i[0],i[1],i[2]?i[2]:b)}a.started||(a.NextFrame=window.requestAnimationFrame?az:aA,a.interval=this.interval,a.NextFrame(this.interval),a.started=1)}b=a.prototype,b.SourceElements=function(){return c.querySelectorAll?c.querySelectorAll('#'+this.source):[c.getElementById(this.source)]},b.HideTags=function(){var b=this.SourceElements(),a;for(a=0;a<b.length;++a)b[a].style.display='none'},b.GetTags=function(){var e=this.SourceElements(),c,f=[],a,b,d;for(d=0;d<=this.repeatTags;++d)for(a=0;a<e.length;++a){c=e[a].getElementsByTagName('a');for(b=0;b<c.length;++b)f.push(c[b])}return f},b.Message=function(j){var g=[],a,f,b=j.split(''),d,e,h,i;for(a=0;a<b.length;++a)b[a]!=' '&&(f=a-b.length/2,d=c.createElement('A'),d.href='#',d.innerText=b[a],h=100*o(f/9),i=-100*l(f/9),e=new J(this,b[a],d,[h,0,i],2,18,'#000','#fff',0,0,0,'monospace',2,b[a]),e.Init(),g.push(e));return g},b.AddAudio=function(b,c){if(e==='off')return;var a=b.getElementsByTagName('audio');a.length&&(c.SetAudio(a[0]),this.hasAudio=1)},b.CreateTag=function(b){var e,c,a,f,d,g,h,j,k=[0,0,0],l;if('text'!=this.imageMode)if(e=b.getElementsByTagName('img'),e.length)if(c=new Image,c.src=e[0].src,!this.imageMode)return a=new J(this,"",b,k,0,0),a.SetImage(c),A(c,e[0],e[1],a,this),this.AddAudio(b,a),a;if('image'!=this.imageMode&&(d=new V(b),f=d.Lines(),d.Empty()?d=null:(g=this.textFont||Q(i(b,'font-family')),this.splitWidth&&(f=d.SplitWidth(this.splitWidth,this.ctxt,g,this.textHeight)),h=this.bgColour=='tag'?i(b,'background-color'):this.bgColour,j=this.bgOutline=='tag'?i(b,'color'):this.bgOutline)),d||c)return a=new J(this,f,b,k,2,this.textHeight+2,this.textColour||i(b,'color'),h,this.bgRadius,j,this.bgOutlineThickness,g,this.padding,d&&d.original),c?(a.SetImage(c),A(c,e[0],e[1],a,this)):a.Init(),this.AddAudio(b,a),a},b.UpdateTag=function(a,b){var c=this.textColour||i(b,'color'),d=this.textFont||Q(i(b,'font-family')),e=this.bgColour=='tag'?i(b,'background-color'):this.bgColour,f=this.bgOutline=='tag'?i(b,'color'):this.bgOutline;a.a=b,a.title=b.title,(a.colour!=c||a.textFont!=d||a.bgColour!=e||a.bgOutline!=f)&&a.SetFont(d,c,e,f)},b.Weight=function(d){var f=d.length,c,b,a,e=[],g,h=this.weightFrom?this.weightFrom.split(/[, ]/):[null],i=h.length;for(b=0;b<f;++b){e[b]=[];for(a=0;a<i;++a)c=aj(d[b].a,h[a],this.textHeight),(!this.max_weight[a]||c>this.max_weight[a])&&(this.max_weight[a]=c),(!this.min_weight[a]||c<this.min_weight[a])&&(this.min_weight[a]=c),e[b][a]=c}for(a=0;a<i;++a)this.max_weight[a]>this.min_weight[a]&&(g=1);if(g)for(b=0;b<f;++b)d[b].SetWeight(e[b])},b.Load=function(){var c=this.GetTags(),b=[],d,k,l,h,i,j,f,a,e=[],m={sphere:aB,vcylinder:ax,hcylinder:aH,vring:aG,hring:aF};if(c.length){e.length=c.length;for(a=0;a<c.length;++a)e[a]=a;this.shuffleTags&&ai(e),h=100*this.radiusX,i=100*this.radiusY,j=100*this.radiusZ,this.max_radius=g(h,g(i,j));for(a=0;a<c.length;++a)k=this.CreateTag(c[e[a]]),k&&b.push(k);this.weight&&this.Weight(b,!0),this.shapeArgs?this.shapeArgs[0]=b.length:(l=this.shape.toString().split(/[(),]/),d=l.shift(),typeof window[d]=='function'?this.shape=window[d]:this.shape=m[d]||m.sphere,this.shapeArgs=[b.length,h,i,j].concat(l)),f=this.shape.apply(this,this.shapeArgs),this.listLength=b.length;for(a=0;a<b.length;++a)b[a].position=new s(f[a][0],f[a][1],f[a][2])}this.noTagsMessage&&!b.length&&(a=this.imageMode&&this.imageMode!='both'?this.imageMode+' ':'',b=this.Message('No '+a+'tags')),this.taglist=b},b.Update=function(){var e=this.GetTags(),d=[],j=this.taglist,k,f=[],c=[],h,i,g,a,b;if(!this.shapeArgs)return this.Load();if(e.length){g=this.listLength=e.length,i=j.length;for(a=0;a<i;++a)d.push(j[a]),c.push(a);for(a=0;a<g;++a){for(b=0,k=0;b<i;++b)j[b].EqualTo(e[a])&&(this.UpdateTag(d[b],e[a]),k=c[b]=-1);k||f.push(a)}for(a=0,b=0;a<i;++a)c[b]==-1?c.splice(b,1):++b;if(c.length){for(ai(c);c.length&&f.length;)a=c.shift(),b=f.shift(),d[a]=this.CreateTag(e[b]);for(c.sort(function(a,b){return a-b});c.length;)d.splice(c.pop(),1)}for(b=d.length/(f.length+1),a=0;f.length;)d.splice(af(++a*b),0,this.CreateTag(e[f.shift()]));this.shapeArgs[0]=g=d.length,h=this.shape.apply(this,this.shapeArgs);for(a=0;a<g;++a)d[a].position=new s(h[a][0],h[a][1],h[a][2]);this.weight&&this.Weight(d)}this.taglist=d},b.SetShadow=function(a){a.shadowBlur=this.shadowBlur,a.shadowOffsetX=this.shadowOffset[0],a.shadowOffsetY=this.shadowOffset[1]},b.LoadAudio=function(){if(!e&&!ag())return;this.audio=c.createElement('audio'),this.audio.src=this.activeAudio,this.track=e.createMediaElementSource(this.audio),this.gain=e.createGain(),this.track.connect(this.gain),this.gain.connect(e.destination),this.hasAudio=1,P=function(a){e.resume(),c.removeEventListener('click',P)},c.addEventListener('click',P)},b.ShowAudioIcon=function(){var a=this.audioIconSize,c=this.canvas,d=this.ctxt,k=c.width-a-3,f=c.height-a-3,g=this.audioIconThickness,h='#000',i='#fff',j=this.audioIconDark,b=this.audioOff,l='suspended';if(!e)return;b||(b=e.state===l),this.audioIcon&&this.hasAudio&&($(b,d,a,k,f,g+1,j?i:h),$(b,d,a,k,f,g,j?h:i))},b.CheckAudioIcon=function(){var a=this.audioIconSize,b=this.canvas,c=this.audioIconThickness/2,d=b.width-a-3-c,e=b.height-a-3-c;if(this.audioIcon&&this.mx>=d&&this.my>=e)return!0},b.ToggleAudio=function(){var a=this.audioOff||e&&e.state==='suspended';a||this.currentAudio&&this.currentAudio.StopAudio(),this.audioOff=!a},b.Draw=function(s){if(this.paused)return;var l=this.canvas,i=l.width,j=l.height,q=0,p=(s-this.time)*a.interval/1e3,h=i/2+this.offsetX,g=j/2+this.offsetY,d=this.ctxt,b,f,c,o=-1,e=this.taglist,k=e.length,t=this.active&&this.active.tag,m='',u=this.frontSelect,r=this.centreFunc==x,n;if(this.time=s,this.frozen&&this.drawn)return this.Animate(i,j,p);n=this.AnimateFixed(),d.setTransform(1,0,0,1,0,0);for(c=0;c<k;++c)e[c].Calc(this.transform,this.fixedAlpha);if(e=ak(e,function(a,b){return b.z-a.z}),n&&this.fixedAnim.active)b=this.fixedAnim.tag.UpdateActive(d,h,g);else if(this.active=null,this.CheckAudioIcon())m='pointer';else{for(c=0;c<k;++c)f=this.mx>=0&&this.my>=0&&this.taglist[c].CheckActive(d,h,g),f&&f.sc>q&&(!u||f.z<=0)&&(b=f,o=c,b.tag=this.taglist[c],q=f.sc);this.active=b}this.txtOpt||this.shadow&&this.SetShadow(d),d.clearRect(0,0,i,j);for(c=0;c<k;++c){if(!r&&e[c].z<=0){try{this.centreFunc(d,i,j,h,g)}catch(a){alert(a),this.centreFunc=x}r=!0}b&&b.tag==e[c]&&b.PreDraw(d,e[c],h,g)||e[c].Draw(d,h,g),b&&b.tag==e[c]&&b.PostDraw(d)}this.freezeActive&&b?this.Freeze():(this.UnFreeze(),this.drawn=k==this.listLength),this.fixedCallback&&(this.fixedCallback(this,this.fixedCallbackTag),this.fixedCallback=null),n||this.Animate(i,j,p),b&&(b.LastDraw(d),b.tag!=t&&(this.currentAudio&&this.currentAudio!=b.tag&&this.currentAudio.StopAudio(),b.tag.PlayAudio()&&(this.currentAudio=b.tag)),m=this.activeCursor),l.style.cursor=m,this.Tooltip(b,this.taglist[o]),this.audioIcon&&this.ShowAudioIcon()},b.TooltipNone=function(){},b.TooltipNative=function(b,a){b?this.canvas.title=a&&a.title?a.title:'':this.canvas.title=this.ctitle},b.SetTTDiv=function(c,d){var a=this,b=a.ttdiv.style;c!=a.ttdiv.innerHTML&&(b.display='none'),a.ttdiv.innerHTML=c,d&&(d.title=a.ttdiv.innerHTML),b.display=='none'&&!a.tttimer&&(a.tttimer=setTimeout(function(){var c=X(a.canvas.id);b.display='block',b.left=c.x+a.mx+'px',b.top=c.y+a.my+24+'px',a.tttimer=null},a.tooltipDelay))},b.TooltipDiv=function(b,a){b&&a&&a.title?this.SetTTDiv(a.title,a):!b&&this.mx!=-1&&this.my!=-1&&this.ctitle.length?this.SetTTDiv(this.ctitle):this.ttdiv.style.display='none'},b.Transform=function(c,a,b){if(a||b){var d=o(a),e=l(a),f=o(b),g=l(b),h=new m([g,0,f,0,1,0,-f,0,g]),i=new m([1,0,0,0,e,-d,0,d,e]);c.transform=c.transform.mul(h.mul(i))}},b.AnimateFixed=function(){var a,b,c,d,e;return!!(this.fadeIn&&(b=q()-this.startTime,b>=this.fadeIn?(this.fadeIn=0,this.fixedAlpha=1):this.fixedAlpha=b/this.fadeIn),this.fixedAnim)&&(this.fixedAnim.transform||(this.fixedAnim.transform=this.transform),a=this.fixedAnim,b=q()-a.t0,c=a.angle,d,e=this.animTiming(a.t,b),this.transform=a.transform,b>=a.t?(this.fixedCallbackTag=a.tag,this.fixedCallback=a.cb,this.fixedAnim=this.yaw=this.pitch=0):c*=e,d=m.Rotation(c,a.axis),this.transform=this.transform.mul(d),this.fixedAnim!=0)},b.AnimatePosition=function(g,h,f){var a=this,d=a.mx,e=a.my,b,c;!a.frozen&&d>=0&&e>=0&&d<g&&e<h?(b=a.maxSpeed,c=a.reverse?-1:1,a.lx||(a.yaw=(d*2*b/g-b)*c*f),a.ly||(a.pitch=(e*2*b/h-b)*-c*f),a.initial=null):a.initial||(a.frozen&&!a.freezeDecel?a.yaw=a.pitch=0:a.Decel(a)),this.Transform(a,a.pitch,a.yaw)},b.AnimateDrag=function(d,e,c){var a=this,b=100*c*a.maxSpeed/a.max_radius/a.zoom;a.dx||a.dy?(a.lx||(a.yaw=a.dx*b/a.stretchX),a.ly||(a.pitch=a.dy*-b/a.stretchY),a.dx=a.dy=0,a.initial=null):a.initial||a.Decel(a),this.Transform(a,a.pitch,a.yaw)},b.Freeze=function(){this.frozen||(this.preFreeze=[this.yaw,this.pitch],this.frozen=1,this.drawn=0)},b.UnFreeze=function(){this.frozen&&(this.yaw=this.preFreeze[0],this.pitch=this.preFreeze[1],this.frozen=0)},b.Decel=function(a){var b=a.minSpeed,c=p(a.yaw),d=p(a.pitch);!a.lx&&c>b&&(a.yaw=c>a.z0?a.yaw*a.decel:0),!a.ly&&d>b&&(a.pitch=d>a.z0?a.pitch*a.decel:0)},b.Zoom=function(a){this.z2=this.z1*(1/a),this.drawn=0},b.Clicked=function(b){if(this.CheckAudioIcon()){this.ToggleAudio();return}var a=this.active;try{a&&a.tag&&(this.clickToFront===!1||this.clickToFront===null?a.tag.Clicked(b):this.TagToFront(a.tag,this.clickToFront,function(){a.tag.Clicked(b)},!0))}catch(a){}},b.Wheel=function(a){var b=this.zoom+this.zoomStep*(a?1:-1);this.zoom=h(this.zoomMax,g(this.zoomMin,b)),this.Zoom(this.zoom)},b.BeginDrag=function(a){this.down=K(a,this.canvas),a.cancelBubble=!0,a.returnValue=!1,a.preventDefault&&a.preventDefault()},b.Drag=function(e,a){if(this.dragControl&&this.down){var d=this.dragThreshold*this.dragThreshold,b=a.x-this.down.x,c=a.y-this.down.y;(this.dragging||b*b+c*c>d)&&(this.dx=b,this.dy=c,this.dragging=1,this.down=a)}return this.dragging},b.EndDrag=function(){var a=this.dragging;return this.dragging=this.down=null,a};function ah(a){var b=a.targetTouches[0],c=a.targetTouches[1];return E(w(c.pageX-b.pageX,2)+w(c.pageY-b.pageY,2))}b.BeginPinch=function(a){this.pinched=[ah(a),this.zoom],a.preventDefault&&a.preventDefault()},b.Pinch=function(d){var b,c,a=this.pinched;if(!a)return;c=ah(d),b=a[1]*c/a[0],this.zoom=h(this.zoomMax,g(this.zoomMin,b)),this.Zoom(this.zoom)},b.EndPinch=function(a){this.pinched=null},b.Pause=function(){this.paused=!0},b.Resume=function(){this.paused=!1},b.SetSpeed=function(a){this.initial=a,this.yaw=a[0]*this.maxSpeed,this.pitch=a[1]*this.maxSpeed},b.FindTag=function(a){if(!n(a))return null;if(n(a.index)&&(a=a.index),!B(a))return this.taglist[a];var c,d,b;n(a.id)?(c='id',d=a.id):n(a.text)&&(c='innerText',d=a.text);for(b=0;b<this.taglist.length;++b)if(this.taglist[b].a[c]==d)return this.taglist[b]},b.RotateTag=function(a,h,i,j,f,g){var b=a.Calc(this.transform,1),c=new s(b.x,b.y,b.z),d=ay(i,h),e=c.angle(d),k=c.cross(d).unit();e==0?(this.fixedCallbackTag=a,this.fixedCallback=f):this.fixedAnim={angle:-e,axis:k,t:j,t0:q(),cb:f,tag:a,active:g}},b.TagToFront=function(a,b,c,d){this.RotateTag(a,0,0,b,c,d)},b.Volume=function(a){this.audioVolume=a*1},a.Start=function(b,c,d){a.Delete(b),a.tc[b]=new a(b,c,d)};function N(c,b){a.tc[b]&&a.tc[b][c]()}a.Linear=function(a,b){return b/a},a.Smooth=function(a,b){return.5-l(b*Math.PI/a)/2},a.Pause=function(a){N('Pause',a)},a.Resume=function(a){N('Resume',a)},a.Reload=function(a){N('Load',a)},a.Update=function(a){N('Update',a)},a.SetSpeed=function(c,b){return!!(B(b)&&a.tc[c]&&!isNaN(b[0])&&!isNaN(b[1]))&&(a.tc[c].SetSpeed(b),!0)},a.TagToFront=function(c,b){return!!B(b)&&(b.lat=b.lng=0,a.RotateTag(c,b))},a.RotateTag=function(c,b){if(B(b)&&a.tc[c]){isNaN(b.time)&&(b.time=500);var d=a.tc[c].FindTag(b);if(d)return a.tc[c].RotateTag(d,b.lat,b.lng,b.time,b.callback,b.active),!0}return!1},a.Delete=function(b){var d,e;if(j[b])if(e=c.getElementById(b),e)for(d=0;d<j[b].length;++d)am(j[b][d][0],j[b][d][1],e);delete j[b],delete a.tc[b]},a.tc={},a.options={z1:2e4,z2:2e4,z0:2e-4,freezeActive:!1,freezeDecel:!1,activeCursor:'pointer',pulsateTo:1,pulsateTime:3,reverse:!1,depth:.5,maxSpeed:.05,minSpeed:0,decel:.95,interval:20,minBrightness:.1,maxBrightness:1,outlineColour:'#ffff99',outlineThickness:2,outlineOffset:5,outlineMethod:'outline',outlineRadius:0,textColour:'#ff99ff',textHeight:15,textFont:'Helvetica, Arial, sans-serif',shadow:'#000',shadowBlur:0,shadowOffset:[0,0],initial:null,hideTags:!0,zoom:1,weight:!1,weightMode:'size',weightFrom:null,weightSize:1,weightSizeMin:null,weightSizeMax:null,weightGradient:{0:'#f00',0.33:'#ff0',0.66:'#0f0',1:'#00f'},txtOpt:!0,txtScale:2,frontSelect:!1,wheelZoom:!0,zoomMin:.3,zoomMax:3,zoomStep:.05,shape:'sphere',lock:null,tooltip:null,tooltipDelay:300,tooltipClass:'tctooltip',radiusX:1,radiusY:1,radiusZ:1,stretchX:1,stretchY:1,offsetX:0,offsetY:0,shuffleTags:!1,noSelect:!1,noMouse:!1,imageScale:1,paused:!1,dragControl:!1,dragThreshold:4,centreFunc:x,splitWidth:0,animTiming:'Smooth',clickToFront:!1,fadeIn:0,padding:0,bgColour:null,bgRadius:0,bgOutline:null,bgOutlineThickness:0,outlineIncrease:4,textAlign:'centre',textVAlign:'middle',imageMode:null,imagePosition:null,imagePadding:2,imageAlign:'centre',imageVAlign:'middle',noTagsMessage:!0,centreImage:null,pinchZoom:!1,repeatTags:0,minTags:0,imageRadius:0,scrollPause:!1,outlineDash:0,outlineDashSpace:0,outlineDashSpeed:1,activeAudio:'',audioVolume:1,audioIcon:1,audioIconSize:20,audioIconThickness:2,audioIconDark:0,altImage:0};for(r in a.options)a[r]=a.options[r];window.TagCanvas=a,t('load',function(){a.loaded=1},window)})()`,s=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},guid=function(){return""+s()+s()+"-"+s()+"-"+s()+"-"+s()+"-"+s()+s()+s()},UseInViewport=function(_e){var et=_e.cb,rt=_e.children,it=React.useRef(null);return React.useEffect(function(){var st={root:null,rootMargin:"0px",threshold:.1},ot=function(ct){et(ct.some(function(ut){return ut.isIntersecting}))},at=new IntersectionObserver(ot,st);return it!=null&&it.current&&at.observe(it.current),function(){at.disconnect()}},[et]),React.createElement("div",{ref:it},rt)},isScriptLoaded=!1,tr=function(_e){try{_e()}catch{try{_e()}catch{}}},CloudWrapped=function CloudWrapped(_ref){var _ref$options=_ref.options,options=_ref$options===void 0?{}:_ref$options,_ref$containerProps=_ref.containerProps,containerProps=_ref$containerProps===void 0?{}:_ref$containerProps,_ref$canvasProps=_ref.canvasProps,canvasProps=_ref$canvasProps===void 0?{}:_ref$canvasProps,children=_ref.children,_ref$id=_ref.id,id=_ref$id===void 0?guid():_ref$id,state=React.useRef({canvasContainerId:"canvas-container-"+id,canvasId:"canvas-"+id,hasStarted:!1}).current,_React$useState=React.useState(!1),mounted=_React$useState[0],setMounted=_React$useState[1];React.useEffect(function(){return setMounted(!0),function(){return tr(function(){eval("TagCanvas.Delete('"+state.canvasId+"')")})}},[]);var supportsTouch=typeof window<"u"?"ontouchstart"in window||navigator.maxTouchPoints:!1,ops=JSON.stringify(_extends({dragControl:!!supportsTouch,maxSpeed:supportsTouch?.01:.05,textFont:null,textColour:null},options)),onVisibilityChange=function onVisibilityChange(isVisible){return tr(function(){if(isVisible&&mounted)if(isScriptLoaded||(eval(tagCanvasString),isScriptLoaded=!0),state.hasStarted)eval("TagCanvas.Resume('"+state.canvasId+"')");else try{eval("TagCanvas.Start('"+state.canvasId+"', null, "+ops+")"),state.hasStarted=!0}catch(nt){var el=document.getElementById(state.canvasContainerId);throw el&&(el.style.display="none"),nt}else state.hasStarted&&eval("TagCanvas.Pause('"+state.canvasId+"')")})};return React.createElement(UseInViewport,{cb:onVisibilityChange},React.createElement("div",Object.assign({id:state.canvasContainerId},containerProps),React.createElement("canvas",Object.assign({id:state.canvasId,style:{width:"100%",maxWidth:"70vh"},width:1e3,height:1e3},canvasProps),children)))},Cloud=function nt(_e){return React.createElement(CloudWrapped,Object.assign({},_e,{key:guid()}))},addHash=function nt(_e){return _e[0]==="#"?_e:"#"+_e},renderSimpleIcon=function nt(_e){var et=_e.aProps,rt=et===void 0?{}:et,it=_e.bgHex,st=it===void 0?"#fff":it,ot=_e.fallbackHex,at=ot===void 0?"#000":ot,lt=_e.icon,ct=_e.imgProps,ut=ct===void 0?{}:ct,ht=_e.minContrastRatio,dt=ht===void 0?1:ht,ft=_e.size,pt=ft===void 0?42:ft,mt=addHash(lt.hex),At=addHash(st),gt=addHash(at),bt=tt(At,mt)>dt,Tt=_(bt?mt:gt),wt=Tt.map(function(Ot){return Math.round(Ot/100*255)}),Rt=wt[0],It=wt[1],Lt=wt[2],$t='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" style="fill: rgb('+Rt+", "+It+", "+Lt+');" viewBox="0 0 24 24" height="'+pt+'px" width="'+pt+'px"> <title>'+lt.title+'</title> <path d="'+lt.path+'"></path> </svg>',kt=_extends({key:guid(),title:lt.title,style:{cursor:"pointer"}},rt),Dt=_extends({height:pt,width:pt,alt:lt.title,src:$t},ut);return React.createElement("a",Object.assign({},kt),React.createElement("img",Object.assign({},Dt)))};function createCommonjsModule(nt,_e){return _e={exports:{}},nt(_e,_e.exports),_e.exports}var runtime_1=createCommonjsModule(function(nt){var _e=function(et){var rt=Object.prototype,it=rt.hasOwnProperty,st,ot=typeof Symbol=="function"?Symbol:{},at=ot.iterator||"@@iterator",lt=ot.asyncIterator||"@@asyncIterator",ct=ot.toStringTag||"@@toStringTag";function ut(Gt,jt,Kt){return Object.defineProperty(Gt,jt,{value:Kt,enumerable:!0,configurable:!0,writable:!0}),Gt[jt]}try{ut({},"")}catch{ut=function(jt,Kt,Jt){return jt[Kt]=Jt}}function ht(Gt,jt,Kt,Jt){var sn=jt&&jt.prototype instanceof bt?jt:bt,hn=Object.create(sn.prototype),an=new Xt(Jt||[]);return hn._invoke=Ot(Gt,Kt,an),hn}et.wrap=ht;function dt(Gt,jt,Kt){try{return{type:"normal",arg:Gt.call(jt,Kt)}}catch(Jt){return{type:"throw",arg:Jt}}}var ft="suspendedStart",pt="suspendedYield",mt="executing",At="completed",gt={};function bt(){}function Tt(){}function wt(){}var Rt={};ut(Rt,at,function(){return this});var It=Object.getPrototypeOf,Lt=It&&It(It(Zt([])));Lt&&Lt!==rt&&it.call(Lt,at)&&(Rt=Lt);var $t=wt.prototype=bt.prototype=Object.create(Rt);Tt.prototype=wt,ut($t,"constructor",wt),ut(wt,"constructor",Tt),Tt.displayName=ut(wt,ct,"GeneratorFunction");function kt(Gt){["next","throw","return"].forEach(function(jt){ut(Gt,jt,function(Kt){return this._invoke(jt,Kt)})})}et.isGeneratorFunction=function(Gt){var jt=typeof Gt=="function"&&Gt.constructor;return jt?jt===Tt||(jt.displayName||jt.name)==="GeneratorFunction":!1},et.mark=function(Gt){return Object.setPrototypeOf?Object.setPrototypeOf(Gt,wt):(Gt.__proto__=wt,ut(Gt,ct,"GeneratorFunction")),Gt.prototype=Object.create($t),Gt},et.awrap=function(Gt){return{__await:Gt}};function Dt(Gt,jt){function Kt(hn,an,pn,_n){var yn=dt(Gt[hn],Gt,an);if(yn.type==="throw")_n(yn.arg);else{var $n=yn.arg,Jn=$n.value;return Jn&&typeof Jn=="object"&&it.call(Jn,"__await")?jt.resolve(Jn.__await).then(function(Xn){Kt("next",Xn,pn,_n)},function(Xn){Kt("throw",Xn,pn,_n)}):jt.resolve(Jn).then(function(Xn){$n.value=Xn,pn($n)},function(Xn){return Kt("throw",Xn,pn,_n)})}}var Jt;function sn(hn,an){function pn(){return new jt(function(_n,yn){Kt(hn,an,_n,yn)})}return Jt=Jt?Jt.then(pn,pn):pn()}this._invoke=sn}kt(Dt.prototype),ut(Dt.prototype,lt,function(){return this}),et.AsyncIterator=Dt,et.async=function(Gt,jt,Kt,Jt,sn){sn===void 0&&(sn=Promise);var hn=new Dt(ht(Gt,jt,Kt,Jt),sn);return et.isGeneratorFunction(jt)?hn:hn.next().then(function(an){return an.done?an.value:hn.next()})};function Ot(Gt,jt,Kt){var Jt=ft;return function(hn,an){if(Jt===mt)throw new Error("Generator is already running");if(Jt===At){if(hn==="throw")throw an;return rn()}for(Kt.method=hn,Kt.arg=an;;){var pn=Kt.delegate;if(pn){var _n=zt(pn,Kt);if(_n){if(_n===gt)continue;return _n}}if(Kt.method==="next")Kt.sent=Kt._sent=Kt.arg;else if(Kt.method==="throw"){if(Jt===ft)throw Jt=At,Kt.arg;Kt.dispatchException(Kt.arg)}else Kt.method==="return"&&Kt.abrupt("return",Kt.arg);Jt=mt;var yn=dt(Gt,jt,Kt);if(yn.type==="normal"){if(Jt=Kt.done?At:pt,yn.arg===gt)continue;return{value:yn.arg,done:Kt.done}}else yn.type==="throw"&&(Jt=At,Kt.method="throw",Kt.arg=yn.arg)}}}function zt(Gt,jt){var Kt=Gt.iterator[jt.method];if(Kt===st){if(jt.delegate=null,jt.method==="throw"){if(Gt.iterator.return&&(jt.method="return",jt.arg=st,zt(Gt,jt),jt.method==="throw"))return gt;jt.method="throw",jt.arg=new TypeError("The iterator does not provide a 'throw' method")}return gt}var Jt=dt(Kt,Gt.iterator,jt.arg);if(Jt.type==="throw")return jt.method="throw",jt.arg=Jt.arg,jt.delegate=null,gt;var sn=Jt.arg;if(!sn)return jt.method="throw",jt.arg=new TypeError("iterator result is not an object"),jt.delegate=null,gt;if(sn.done)jt[Gt.resultName]=sn.value,jt.next=Gt.nextLoc,jt.method!=="return"&&(jt.method="next",jt.arg=st);else return sn;return jt.delegate=null,gt}kt($t),ut($t,ct,"Generator"),ut($t,at,function(){return this}),ut($t,"toString",function(){return"[object Generator]"});function Ht(Gt){var jt={tryLoc:Gt[0]};1 in Gt&&(jt.catchLoc=Gt[1]),2 in Gt&&(jt.finallyLoc=Gt[2],jt.afterLoc=Gt[3]),this.tryEntries.push(jt)}function Yt(Gt){var jt=Gt.completion||{};jt.type="normal",delete jt.arg,Gt.completion=jt}function Xt(Gt){this.tryEntries=[{tryLoc:"root"}],Gt.forEach(Ht,this),this.reset(!0)}et.keys=function(Gt){var jt=[];for(var Kt in Gt)jt.push(Kt);return jt.reverse(),function Jt(){for(;jt.length;){var sn=jt.pop();if(sn in Gt)return Jt.value=sn,Jt.done=!1,Jt}return Jt.done=!0,Jt}};function Zt(Gt){if(Gt){var jt=Gt[at];if(jt)return jt.call(Gt);if(typeof Gt.next=="function")return Gt;if(!isNaN(Gt.length)){var Kt=-1,Jt=function sn(){for(;++Kt<Gt.length;)if(it.call(Gt,Kt))return sn.value=Gt[Kt],sn.done=!1,sn;return sn.value=st,sn.done=!0,sn};return Jt.next=Jt}}return{next:rn}}et.values=Zt;function rn(){return{value:st,done:!0}}return Xt.prototype={constructor:Xt,reset:function(Gt){if(this.prev=0,this.next=0,this.sent=this._sent=st,this.done=!1,this.delegate=null,this.method="next",this.arg=st,this.tryEntries.forEach(Yt),!Gt)for(var jt in this)jt.charAt(0)==="t"&&it.call(this,jt)&&!isNaN(+jt.slice(1))&&(this[jt]=st)},stop:function(){this.done=!0;var Gt=this.tryEntries[0],jt=Gt.completion;if(jt.type==="throw")throw jt.arg;return this.rval},dispatchException:function(Gt){if(this.done)throw Gt;var jt=this;function Kt(_n,yn){return hn.type="throw",hn.arg=Gt,jt.next=_n,yn&&(jt.method="next",jt.arg=st),!!yn}for(var Jt=this.tryEntries.length-1;Jt>=0;--Jt){var sn=this.tryEntries[Jt],hn=sn.completion;if(sn.tryLoc==="root")return Kt("end");if(sn.tryLoc<=this.prev){var an=it.call(sn,"catchLoc"),pn=it.call(sn,"finallyLoc");if(an&&pn){if(this.prev<sn.catchLoc)return Kt(sn.catchLoc,!0);if(this.prev<sn.finallyLoc)return Kt(sn.finallyLoc)}else if(an){if(this.prev<sn.catchLoc)return Kt(sn.catchLoc,!0)}else if(pn){if(this.prev<sn.finallyLoc)return Kt(sn.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(Gt,jt){for(var Kt=this.tryEntries.length-1;Kt>=0;--Kt){var Jt=this.tryEntries[Kt];if(Jt.tryLoc<=this.prev&&it.call(Jt,"finallyLoc")&&this.prev<Jt.finallyLoc){var sn=Jt;break}}sn&&(Gt==="break"||Gt==="continue")&&sn.tryLoc<=jt&&jt<=sn.finallyLoc&&(sn=null);var hn=sn?sn.completion:{};return hn.type=Gt,hn.arg=jt,sn?(this.method="next",this.next=sn.finallyLoc,gt):this.complete(hn)},complete:function(Gt,jt){if(Gt.type==="throw")throw Gt.arg;return Gt.type==="break"||Gt.type==="continue"?this.next=Gt.arg:Gt.type==="return"?(this.rval=this.arg=Gt.arg,this.method="return",this.next="end"):Gt.type==="normal"&&jt&&(this.next=jt),gt},finish:function(Gt){for(var jt=this.tryEntries.length-1;jt>=0;--jt){var Kt=this.tryEntries[jt];if(Kt.finallyLoc===Gt)return this.complete(Kt.completion,Kt.afterLoc),Yt(Kt),gt}},catch:function(Gt){for(var jt=this.tryEntries.length-1;jt>=0;--jt){var Kt=this.tryEntries[jt];if(Kt.tryLoc===Gt){var Jt=Kt.completion;if(Jt.type==="throw"){var sn=Jt.arg;Yt(Kt)}return sn}}throw new Error("illegal catch attempt")},delegateYield:function(Gt,jt,Kt){return this.delegate={iterator:Zt(Gt),resultName:jt,nextLoc:Kt},this.method==="next"&&(this.arg=st),gt}},et}(nt.exports);try{regeneratorRuntime=_e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=_e:Function("r","regeneratorRuntime = r")(_e)}}),svgToPath=function nt(_e){var et=_e.indexOf('d="'),rt=_e.indexOf('"',et+3);return _e.substring(et+3,rt)},url="https://cdn.jsdelivr.net/npm/simple-icons@latest/icons/",cache={},fallback="",getSlugPath=function(){var nt=_asyncToGenerator(runtime_1.mark(function _e(et){var rt,it,st,ot;return runtime_1.wrap(function(lt){for(;;)switch(lt.prev=lt.next){case 0:if(cache[et]){lt.next=15;break}return lt.prev=1,rt=""+url+et+".svg",lt.next=5,fetch(rt,{cache:"force-cache"});case 5:return it=lt.sent,lt.next=8,it.text();case 8:st=lt.sent,ot=svgToPath(st),cache[et]=ot,lt.next=15;break;case 13:lt.prev=13,lt.t0=lt.catch(1);case 15:if(!cache[et]){lt.next=17;break}return lt.abrupt("return",cache[et]);case 17:return lt.abrupt("return",fallback);case 18:case"end":return lt.stop()}},_e,null,[[1,13]])}));return function(et){return nt.apply(this,arguments)}}(),getSlugsPath=function(){var nt=_asyncToGenerator(runtime_1.mark(function _e(et){var rt;return runtime_1.wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return rt={},et.forEach(function(ot){rt[ot]=ot}),st.next=4,Promise.all(Object.keys(rt).map(getSlugPath));case 4:return st.abrupt("return",et.map(function(ot){var at;return{slug:ot,path:(at=cache[ot])!=null?at:fallback}}));case 5:case"end":return st.stop()}},_e)}));return function(et){return nt.apply(this,arguments)}}(),TITLE_TO_SLUG_REPLACEMENTS={"+":"plus",".":"dot","&":"and",:"d",:"h",:"i",:"k",:"l",:"l",:"ss",:"t"},TITLE_TO_SLUG_CHARS_REGEX=RegExp("["+Object.keys(TITLE_TO_SLUG_REPLACEMENTS).join("")+"]","g"),TITLE_TO_SLUG_RANGE_REGEX=/[^a-z0-9]/g,getSlug=function nt(_e){var et=_e.title;return et.toLowerCase().replace(TITLE_TO_SLUG_CHARS_REGEX,function(rt){return TITLE_TO_SLUG_REPLACEMENTS[rt]}).normalize("NFD").replace(TITLE_TO_SLUG_RANGE_REGEX,"")},url$1="https://raw.githubusercontent.com/simple-icons/simple-icons/develop/_data/simple-icons.json",cache$1,fallback$1="#000",primeCache=function(){var nt=_asyncToGenerator(runtime_1.mark(function _e(){var et,rt;return runtime_1.wrap(function(st){for(;;)switch(st.prev=st.next){case 0:if(cache$1){st.next=14;break}return st.prev=1,st.next=4,fetch(url$1,{cache:"force-cache"});case 4:return et=st.sent,st.next=7,et.json();case 7:rt=st.sent,cache$1={},rt.icons.forEach(function(ot){var at,lt=getSlug({title:ot.title});cache$1[lt]={hex:addHash((at=ot.hex)!=null?at:fallback$1),title:ot.title,slug:lt}}),st.next=14;break;case 12:st.prev=12,st.t0=st.catch(1);case 14:case"end":return st.stop()}},_e,null,[[1,12]])}));return function(){return nt.apply(this,arguments)}}(),getSlugHexs=function(){var nt=_asyncToGenerator(runtime_1.mark(function _e(et){return runtime_1.wrap(function(it){for(;;)switch(it.prev=it.next){case 0:return it.next=2,primeCache();case 2:return it.abrupt("return",{hexs:et.map(function(st){var ot,at,lt,ct;return{slug:st,hex:cache$1&&(ot=(at=cache$1[st])==null?void 0:at.hex)!=null?ot:fallback$1,title:cache$1&&(lt=(ct=cache$1[st])==null?void 0:ct.title)!=null?lt:"icon"}}),cache:cache$1});case 3:case"end":return it.stop()}},_e)}));return function(et){return nt.apply(this,arguments)}}(),fetchSimpleIcons=function(){var nt=_asyncToGenerator(runtime_1.mark(function _e(et){var rt,it,st,ot,at,lt,ct;return runtime_1.wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return rt=et.slugs,ht.next=3,Promise.all([getSlugsPath(rt),getSlugHexs(rt)]);case 3:return it=ht.sent,st=it[0],ot=it[1],at=ot.hexs,lt=ot.cache,ct={},at.forEach(function(dt){ct[dt.slug]=dt}),st.forEach(function(dt){ct[dt.slug].path=dt.path}),rt.forEach(function(dt){var ft=ct[dt];(!ft.hex||!ft.path)&&delete ct[dt]}),ht.abrupt("return",{simpleIcons:ct,allIcon:lt});case 13:case"end":return ht.stop()}},_e)}));return function(et){return nt.apply(this,arguments)}}();const cloudProps={containerProps:{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",paddingTop:40}},options:{reverse:!0,depth:1,wheelZoom:!1,imageScale:2,activeCursor:"default",tooltip:"native",initial:[.1,-.1],clickToFront:500,tooltipDelay:0,outlineColour:"#0000",maxSpeed:.04,minSpeed:.02}},renderCustomIcon=(nt,_e)=>renderSimpleIcon({icon:nt,bgHex:_e==="light"?"#f3f2ef":"#080510",fallbackHex:_e==="light"?"#6e6e73":"#ffffff",minContrastRatio:_e==="dark"?2:1.2,size:42,aProps:{href:void 0,target:void 0,rel:void 0,onClick:st=>st.preventDefault()}});function IconCloud({iconSlugs:nt}){const[_e,et]=reactExports.useState(null),{theme:rt}=z();reactExports.useEffect(()=>{fetchSimpleIcons({slugs:nt}).then(et)},[nt]);const it=reactExports.useMemo(()=>_e?Object.values(_e.simpleIcons).map(st=>renderCustomIcon(st,rt||"light")):null,[_e,rt]);return jsxRuntimeExports.jsx(Cloud,{...cloudProps,children:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:it})})}const About=()=>{const[nt,_e]=reactExports.useState(!1),et=()=>{navigator.clipboard.writeText("ansh06tomar@gmail.com"),_e(!0),setTimeout(()=>{_e(!1)},2e3)},rt=["javascript","typescript","react","nextjs","nodejs","python","mongodb","postgresql","tailwindcss","html5","css3","git","github","vscode","docker","pytorch","cplusplus"];return jsxRuntimeExports.jsx("section",{className:"c-space my-20",id:"about",children:jsxRuntimeExports.jsxs("div",{className:"grid xl:grid-cols-3 xl:grid-rows-6 md:grid-cols-2 grid-cols-1 gap-5 h-full",children:[jsxRuntimeExports.jsx("div",{className:"col-span-1 xl:row-span-3",children:jsxRuntimeExports.jsxs("div",{className:"grid-container",children:[jsxRuntimeExports.jsx("img",{src:"assets/grid3grid.png",alt:"grid-1",className:"w-full sm:h-[276px] h-fit object-contain"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"grid-headtext",children:"Hi, I'm Ansh Tomar"}),jsxRuntimeExports.jsx("p",{className:"grid-subtext",children:"With 2 years of experience, I have honed my skills in both frontend and backend dev, creating dynamic and responsive websites."})]})]})}),jsxRuntimeExports.jsx("div",{className:"col-span-1 xl:row-span-3",children:jsxRuntimeExports.jsxs("div",{className:"grid-container",children:[jsxRuntimeExports.jsx("div",{className:"w-full sm:h-[276px] h-fit flex items-center justify-center",children:jsxRuntimeExports.jsx(IconCloud,{iconSlugs:rt})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"grid-headtext",children:"Tech Stack"}),jsxRuntimeExports.jsx("p",{className:"grid-subtext",children:"Im skilled in using a diverse set of languages, frameworks, and tools, which gives me the flexibility to build applications that are both reliable and scalable, no matter the challenge"})]})]})}),jsxRuntimeExports.jsx("div",{className:"col-span-1 xl:row-span-4",children:jsxRuntimeExports.jsxs("div",{className:"grid-container",children:[jsxRuntimeExports.jsx("div",{className:"rounded-3xl w-full sm:h-[326px] h-fit flex justify-center items-center",children:jsxRuntimeExports.jsx(Globe,{height:326,width:326,backgroundColor:"rgba(0, 0, 0, 0)",backgroundImageOpacity:.5,showAtmosphere:!0,showGraticules:!0,globeImageUrl:"//unpkg.com/three-globe/example/img/earth-night.jpg",bumpImageUrl:"//unpkg.com/three-globe/example/img/earth-topology.png",labelsData:[{lat:33,lng:-117,text:"Orange, California",color:"white",size:15}]})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"grid-headtext",children:"I'm very flexible with time zone communications & locations"}),jsxRuntimeExports.jsx("p",{className:"grid-subtext",children:"I'm based in California, U.S. and open to remote work worldwide."}),jsxRuntimeExports.jsx("a",{href:"#contact",className:"w-fit",children:jsxRuntimeExports.jsx(Button,{name:"Contact Me",isBeam:!0,containerClass:"w-full mt-10"})})]})]})}),jsxRuntimeExports.jsx("div",{className:"xl:col-span-2 xl:row-span-3",children:jsxRuntimeExports.jsxs("div",{className:"grid-container",children:[jsxRuntimeExports.jsx("img",{src:"assets/grid3new.png",alt:"grid-3",className:"w-full sm:h-[266px] h-fit object-contain"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"grid-headtext",children:"My Passion for Coding"}),jsxRuntimeExports.jsx("p",{className:"grid-subtext",children:"I love solving problems and building things through code. Programming isn't just my professionit's my passion. I enjoy exploring new technologies, and enhancing my skills."})]})]})}),jsxRuntimeExports.jsx("div",{className:"xl:col-span-1 xl:row-span-2",children:jsxRuntimeExports.jsxs("div",{className:"grid-container",children:[jsxRuntimeExports.jsx("img",{src:"assets/grid4.png",alt:"grid-4",className:"w-full md:h-[126px] sm:h-[276px] h-fit object-cover sm:object-top"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("p",{className:"grid-headtext text-center",children:"Contact me"}),jsxRuntimeExports.jsxs("div",{className:"copy-container",onClick:et,children:[jsxRuntimeExports.jsx("img",{src:nt?"assets/tick.svg":"assets/copy.svg",alt:"copy"}),jsxRuntimeExports.jsx("p",{className:"lg:text-2xl md:text-xl font-medium text-gray_gradient text-white",children:"ansh06tomar@gmail.com"})]})]})]})})]})})},Footer=()=>jsxRuntimeExports.jsxs("footer",{className:"c-space pt-7 pb-3 border-t border-black-300 flex justify-between items-center flex-wrap gap-5",children:[jsxRuntimeExports.jsxs("div",{className:"text-white-500 flex gap-2",children:[jsxRuntimeExports.jsx("p",{children:"Crafted with Passion "}),jsxRuntimeExports.jsx("p",{children:""})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 justify-center",children:[jsxRuntimeExports.jsx("div",{className:"social-icon flex items-center justify-center w-10 h-10 rounded-full bg-gray-200 hover:bg-gray-300 transition-colors duration-200",children:jsxRuntimeExports.jsx("a",{href:"https://github.com/atomar1",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx("img",{src:"/assets/github.svg",alt:"github",className:"w-6 h-6 transition-colors duration-200 hover:fill-white"})})}),jsxRuntimeExports.jsx("div",{className:"social-icon flex items-center justify-center w-10 h-10 rounded-full bg-gray-200 hover:bg-gray-300 transition-colors duration-200",children:jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/anshtomar/",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx("img",{src:"/assets/linkedin.svg",alt:"linkedin",className:"w-6 h-6 transition-colors duration-200 hover:fill-white"})})})]}),jsxRuntimeExports.jsx("p",{className:"text-white-500",children:" 2024 Ansh Tomar. All rights reserved."})]});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=nt=>nt.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...nt)=>nt.filter((_e,et,rt)=>!!_e&&_e.trim()!==""&&rt.indexOf(_e)===et).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:nt="currentColor",size:_e=24,strokeWidth:et=2,absoluteStrokeWidth:rt,className:it="",children:st,iconNode:ot,...at},lt)=>reactExports.createElement("svg",{ref:lt,...defaultAttributes,width:_e,height:_e,stroke:nt,strokeWidth:rt?Number(et)*24/Number(_e):et,className:mergeClasses("lucide",it),...at},[...ot.map(([ct,ut])=>reactExports.createElement(ct,ut)),...Array.isArray(st)?st:[st]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(nt,_e)=>{const et=reactExports.forwardRef(({className:rt,...it},st)=>reactExports.createElement(Icon,{ref:st,iconNode:_e,className:mergeClasses(`lucide-${toKebabCase(nt)}`,rt),...it}));return et.displayName=`${nt}`,et};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Github=createLucideIcon("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Linkedin=createLucideIcon("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LoaderCircle=createLucideIcon("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Send=createLucideIcon("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),CustomLogo=()=>jsxRuntimeExports.jsx("img",{src:"assets/Favicon.png",alt:"Logo",className:"w-6 h-6 object-contain"}),NavItems=({onClick:nt=()=>{}})=>jsxRuntimeExports.jsx("ul",{className:"nav-ul",children:navLinks.map(_e=>jsxRuntimeExports.jsx("li",{className:"nav-li",children:jsxRuntimeExports.jsx("a",{href:_e.href,className:"nav-li_a",onClick:nt,children:_e.name})},_e.id))}),Navbar=()=>{const[nt,_e]=reactExports.useState(!1),et=()=>_e(!nt),rt=()=>_e(!1);return jsxRuntimeExports.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center py-4 mx-auto c-space",children:[jsxRuntimeExports.jsx("nav",{className:"hidden sm:block",children:jsxRuntimeExports.jsx("div",{className:"bg-white/10 px-8 py-2 rounded-full",children:jsxRuntimeExports.jsx(NavItems,{})})}),jsxRuntimeExports.jsx("a",{href:"/",className:"absolute left-1/2 -translate-x-1/2 text-white/80 hover:text-white transition-colors hidden sm:block",children:jsxRuntimeExports.jsx(CustomLogo,{})}),jsxRuntimeExports.jsx("a",{href:"/",className:"text-white/80 hover:text-white transition-colors sm:hidden",children:jsxRuntimeExports.jsx(CustomLogo,{})}),jsxRuntimeExports.jsxs("div",{className:"hidden sm:flex items-center space-x-6",children:[jsxRuntimeExports.jsx("a",{href:"https://github.com/atomar1",className:"text-white/80 hover:text-white transition-colors",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(Github,{size:20})}),jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/anshtomar/",className:"text-white/80 hover:text-white transition-colors",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(Linkedin,{size:20})})]}),jsxRuntimeExports.jsx("button",{onClick:et,className:"text-white/80 hover:text-white focus:outline-none sm:hidden flex","aria-label":"Toggle menu",children:jsxRuntimeExports.jsx("img",{src:nt?"assets/close.svg":"assets/menu.svg",alt:"toggle",className:"w-6 h-6"})})]})}),jsxRuntimeExports.jsx("div",{className:`nav-sidebar ${nt?"max-h-screen":"max-h-0"}`,children:jsxRuntimeExports.jsxs("nav",{className:"p-5",children:[jsxRuntimeExports.jsx(NavItems,{onClick:rt}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center space-x-6 mt-6",children:[jsxRuntimeExports.jsx("a",{href:"https://github.com/atomar1",className:"text-white/80 hover:text-white transition-colors",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(Github,{size:20})}),jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/anshtomar/",className:"text-white/80 hover:text-white transition-colors",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(Linkedin,{size:20})})]})]})})]})};class EmailJSResponseStatus{constructor(_e=0,et="Network Error"){this.status=_e,this.text=et}}const createWebStorage=()=>{if(!(typeof localStorage>"u"))return{get:nt=>Promise.resolve(localStorage.getItem(nt)),set:(nt,_e)=>Promise.resolve(localStorage.setItem(nt,_e)),remove:nt=>Promise.resolve(localStorage.removeItem(nt))}},store={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:createWebStorage()},buildOptions=nt=>nt?typeof nt=="string"?{publicKey:nt}:nt.toString()==="[object Object]"?nt:{}:{},init=(nt,_e="https://api.emailjs.com")=>{if(!nt)return;const et=buildOptions(nt);store.publicKey=et.publicKey,store.blockHeadless=et.blockHeadless,store.storageProvider=et.storageProvider,store.blockList=et.blockList,store.limitRate=et.limitRate,store.origin=et.origin||_e},sendPost=async(nt,_e,et={})=>{const rt=await fetch(store.origin+nt,{method:"POST",headers:et,body:_e}),it=await rt.text(),st=new EmailJSResponseStatus(rt.status,it);if(rt.ok)return st;throw st},validateParams=(nt,_e,et)=>{if(!nt||typeof nt!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!_e||typeof _e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!et||typeof et!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},validateTemplateParams=nt=>{if(nt&&nt.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},isHeadless=nt=>nt.webdriver||!nt.languages||nt.languages.length===0,headlessError=()=>new EmailJSResponseStatus(451,"Unavailable For Headless Browser"),validateBlockListParams=(nt,_e)=>{if(!Array.isArray(nt))throw"The BlockList list has to be an array";if(typeof _e!="string")throw"The BlockList watchVariable has to be a string"},isBlockListDisabled=nt=>{var _e;return!((_e=nt.list)!=null&&_e.length)||!nt.watchVariable},getValue=(nt,_e)=>nt instanceof FormData?nt.get(_e):nt[_e],isBlockedValueInParams=(nt,_e)=>{if(isBlockListDisabled(nt))return!1;validateBlockListParams(nt.list,nt.watchVariable);const et=getValue(_e,nt.watchVariable);return typeof et!="string"?!1:nt.list.includes(et)},blockedEmailError=()=>new EmailJSResponseStatus(403,"Forbidden"),validateLimitRateParams=(nt,_e)=>{if(typeof nt!="number"||nt<0)throw"The LimitRate throttle has to be a positive number";if(_e&&typeof _e!="string")throw"The LimitRate ID has to be a non-empty string"},getLeftTime=async(nt,_e,et)=>{const rt=Number(await et.get(nt)||0);return _e-Date.now()+rt},isLimitRateHit=async(nt,_e,et)=>{if(!_e.throttle||!et)return!1;validateLimitRateParams(_e.throttle,_e.id);const rt=_e.id||nt;return await getLeftTime(rt,_e.throttle,et)>0?!0:(await et.set(rt,Date.now().toString()),!1)},limitRateError=()=>new EmailJSResponseStatus(429,"Too Many Requests"),send=async(nt,_e,et,rt)=>{const it=buildOptions(rt),st=it.publicKey||store.publicKey,ot=it.blockHeadless||store.blockHeadless,at=it.storageProvider||store.storageProvider,lt={...store.blockList,...it.blockList},ct={...store.limitRate,...it.limitRate};return ot&&isHeadless(navigator)?Promise.reject(headlessError()):(validateParams(st,nt,_e),validateTemplateParams(et),et&&isBlockedValueInParams(lt,et)?Promise.reject(blockedEmailError()):await isLimitRateHit(location.pathname,ct,at)?Promise.reject(limitRateError()):sendPost("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:st,service_id:nt,template_id:_e,template_params:et}),{"Content-type":"application/json"}))},validateForm=nt=>{if(!nt||nt.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},findHTMLForm=nt=>typeof nt=="string"?document.querySelector(nt):nt,sendForm=async(nt,_e,et,rt)=>{const it=buildOptions(rt),st=it.publicKey||store.publicKey,ot=it.blockHeadless||store.blockHeadless,at=store.storageProvider||it.storageProvider,lt={...store.blockList,...it.blockList},ct={...store.limitRate,...it.limitRate};if(ot&&isHeadless(navigator))return Promise.reject(headlessError());const ut=findHTMLForm(et);validateParams(st,nt,_e),validateForm(ut);const ht=new FormData(ut);return isBlockedValueInParams(lt,ht)?Promise.reject(blockedEmailError()):await isLimitRateHit(location.pathname,ct,at)?Promise.reject(limitRateError()):(ht.append("lib_version","4.4.1"),ht.append("service_id",nt),ht.append("template_id",_e),ht.append("user_id",st),sendPost("/api/v1.0/email/send-form",ht))},emailjs={init,send,sendForm,EmailJSResponseStatus};function createDOMMotionComponentProxy(nt){if(typeof Proxy>"u")return nt;const _e=new Map,et=(...rt)=>nt(...rt);return new Proxy(et,{get:(rt,it)=>it==="create"?nt:(_e.has(it)||_e.set(it,nt(it)),_e.get(it))})}function isAnimationControls(nt){return nt!==null&&typeof nt=="object"&&typeof nt.start=="function"}const isKeyframesTarget=nt=>Array.isArray(nt);function shallowCompare(nt,_e){if(!Array.isArray(_e))return!1;const et=_e.length;if(et!==nt.length)return!1;for(let rt=0;rt<et;rt++)if(_e[rt]!==nt[rt])return!1;return!0}function isVariantLabel(nt){return typeof nt=="string"||Array.isArray(nt)}function getValueState(nt){const _e=[{},{}];return nt==null||nt.values.forEach((et,rt)=>{_e[0][rt]=et.get(),_e[1][rt]=et.getVelocity()}),_e}function resolveVariantFromProps(nt,_e,et,rt){if(typeof _e=="function"){const[it,st]=getValueState(rt);_e=_e(et!==void 0?et:nt.custom,it,st)}if(typeof _e=="string"&&(_e=nt.variants&&nt.variants[_e]),typeof _e=="function"){const[it,st]=getValueState(rt);_e=_e(et!==void 0?et:nt.custom,it,st)}return _e}function resolveVariant(nt,_e,et){const rt=nt.getProps();return resolveVariantFromProps(rt,_e,et!==void 0?et:rt.custom,nt)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder],transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),secondsToMilliseconds=nt=>nt*1e3,millisecondsToSeconds=nt=>nt/1e3,underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=nt=>({type:"spring",stiffness:550,damping:nt===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(nt,{keyframes:_e})=>_e.length>2?keyframesTransition:transformProps.has(nt)?nt.startsWith("scale")?criticallyDampedSpring(_e[1]):underDampedSpring:ease;function getValueTransition(nt,_e){return nt?nt[_e]||nt.default||nt:void 0}const MotionGlobalConfig={skipAnimations:!1,useManualTiming:!1},isNotNull=nt=>nt!==null;function getFinalKeyframe(nt,{repeat:_e,repeatType:et="loop"},rt){const it=nt.filter(isNotNull),st=_e&&et!=="loop"&&_e%2===1?0:it.length-1;return!st||rt===void 0?it[st]:rt}const noop=nt=>nt;function createRenderStep(nt){let _e=new Set,et=new Set,rt=!1,it=!1;const st=new WeakSet;let ot={delta:0,timestamp:0,isProcessing:!1};function at(ct){st.has(ct)&&(lt.schedule(ct),nt()),ct(ot)}const lt={schedule:(ct,ut=!1,ht=!1)=>{const ft=ht&&rt?_e:et;return ut&&st.add(ct),ft.has(ct)||ft.add(ct),ct},cancel:ct=>{et.delete(ct),st.delete(ct)},process:ct=>{if(ot=ct,rt){it=!0;return}rt=!0,[_e,et]=[et,_e],et.clear(),_e.forEach(at),rt=!1,it&&(it=!1,lt.process(ct))}};return lt}const stepsOrder=["read","resolveKeyframes","update","preRender","render","postRender"],maxElapsed=40;function createRenderBatcher(nt,_e){let et=!1,rt=!0;const it={delta:0,timestamp:0,isProcessing:!1},st=()=>et=!0,ot=stepsOrder.reduce((gt,bt)=>(gt[bt]=createRenderStep(st),gt),{}),{read:at,resolveKeyframes:lt,update:ct,preRender:ut,render:ht,postRender:dt}=ot,ft=()=>{const gt=performance.now();et=!1,it.delta=rt?1e3/60:Math.max(Math.min(gt-it.timestamp,maxElapsed),1),it.timestamp=gt,it.isProcessing=!0,at.process(it),lt.process(it),ct.process(it),ut.process(it),ht.process(it),dt.process(it),it.isProcessing=!1,et&&_e&&(rt=!1,nt(ft))},pt=()=>{et=!0,rt=!0,it.isProcessing||nt(ft)};return{schedule:stepsOrder.reduce((gt,bt)=>{const Tt=ot[bt];return gt[bt]=(wt,Rt=!1,It=!1)=>(et||pt(),Tt.schedule(wt,Rt,It)),gt},{}),cancel:gt=>{for(let bt=0;bt<stepsOrder.length;bt++)ot[stepsOrder[bt]].cancel(gt)},state:it,steps:ot}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0),calcBezier=(nt,_e,et)=>(((1-3*et+3*_e)*nt+(3*et-6*_e))*nt+3*_e)*nt,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(nt,_e,et,rt,it){let st,ot,at=0;do ot=_e+(et-_e)/2,st=calcBezier(ot,rt,it)-nt,st>0?et=ot:_e=ot;while(Math.abs(st)>subdivisionPrecision&&++at<subdivisionMaxIterations);return ot}function cubicBezier(nt,_e,et,rt){if(nt===_e&&et===rt)return noop;const it=st=>binarySubdivide(st,0,1,nt,et);return st=>st===0||st===1?st:calcBezier(it(st),_e,rt)}const mirrorEasing=nt=>_e=>_e<=.5?nt(2*_e)/2:(2-nt(2*(1-_e)))/2,reverseEasing=nt=>_e=>1-nt(1-_e),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=nt=>(nt*=2)<1?.5*backIn(nt):.5*(2-Math.pow(2,-10*(nt-1))),circIn=nt=>1-Math.sin(Math.acos(nt)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),isZeroValueString=nt=>/^0[^.\s]+$/u.test(nt);function isNone(nt){return typeof nt=="number"?nt===0:nt!==null?nt==="none"||nt==="0"||isZeroValueString(nt):!0}let invariant=noop;const isNumericalString=nt=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(nt),checkStringStartsWith=nt=>_e=>typeof _e=="string"&&_e.startsWith(nt),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=nt=>startsAsVariableToken(nt)?singleCssVariableRegex.test(nt.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(nt){const _e=splitCSSVariableRegex.exec(nt);if(!_e)return[,];const[,et,rt,it]=_e;return[`--${et??rt}`,it]}function getVariableValue(nt,_e,et=1){const[rt,it]=parseCSSVariable(nt);if(!rt)return;const st=window.getComputedStyle(_e).getPropertyValue(rt);if(st){const ot=st.trim();return isNumericalString(ot)?parseFloat(ot):ot}return isCSSVariableToken(it)?getVariableValue(it,_e,et+1):it}const clamp=(nt,_e,et)=>et>_e?_e:et<nt?nt:et,number={test:nt=>typeof nt=="number",parse:parseFloat,transform:nt=>nt},alpha={...number,transform:nt=>clamp(0,1,nt)},scale={...number,default:1},createUnitType=nt=>({test:_e=>typeof _e=="string"&&_e.endsWith(nt)&&_e.split(" ").length===1,parse:parseFloat,transform:_e=>`${_e}${nt}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:nt=>percent.parse(nt)/100,transform:nt=>percent.transform(nt*100)},positionalKeys=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),isNumOrPxType=nt=>nt===number||nt===px,getPosFromMatrix=(nt,_e)=>parseFloat(nt.split(", ")[_e]),getTranslateFromMatrix=(nt,_e)=>(et,{transform:rt})=>{if(rt==="none"||!rt)return 0;const it=rt.match(/^matrix3d\((.+)\)$/u);if(it)return getPosFromMatrix(it[1],_e);{const st=rt.match(/^matrix\((.+)\)$/u);return st?getPosFromMatrix(st[1],nt):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(nt=>!transformKeys.has(nt));function removeNonTranslationalTransform(nt){const _e=[];return nonTranslationalTransformKeys.forEach(et=>{const rt=nt.getValue(et);rt!==void 0&&(_e.push([et,rt.get()]),rt.set(et.startsWith("scale")?1:0))}),_e}const positionalValues={width:({x:nt},{paddingLeft:_e="0",paddingRight:et="0"})=>nt.max-nt.min-parseFloat(_e)-parseFloat(et),height:({y:nt},{paddingTop:_e="0",paddingBottom:et="0"})=>nt.max-nt.min-parseFloat(_e)-parseFloat(et),top:(nt,{top:_e})=>parseFloat(_e),left:(nt,{left:_e})=>parseFloat(_e),bottom:({y:nt},{top:_e})=>parseFloat(_e)+(nt.max-nt.min),right:({x:nt},{left:_e})=>parseFloat(_e)+(nt.max-nt.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const testValueType=nt=>_e=>_e.test(nt),auto={test:nt=>nt==="auto",parse:nt=>nt},dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=nt=>dimensionValueTypes.find(testValueType(nt)),toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const nt=Array.from(toResolve).filter(rt=>rt.needsMeasurement),_e=new Set(nt.map(rt=>rt.element)),et=new Map;_e.forEach(rt=>{const it=removeNonTranslationalTransform(rt);it.length&&(et.set(rt,it),rt.render())}),nt.forEach(rt=>rt.measureInitialState()),_e.forEach(rt=>{rt.render();const it=et.get(rt);it&&it.forEach(([st,ot])=>{var at;(at=rt.getValue(st))===null||at===void 0||at.set(ot)})}),nt.forEach(rt=>rt.measureEndState()),nt.forEach(rt=>{rt.suspendedScrollY!==void 0&&window.scrollTo(0,rt.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(nt=>nt.complete()),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(nt=>{nt.readKeyframes(),nt.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){readAllKeyframes(),measureAllKeyframes()}class KeyframeResolver{constructor(_e,et,rt,it,st,ot=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[..._e],this.onComplete=et,this.name=rt,this.motionValue=it,this.element=st,this.isAsync=ot}scheduleResolve(){this.isScheduled=!0,this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:_e,name:et,element:rt,motionValue:it}=this;for(let st=0;st<_e.length;st++)if(_e[st]===null)if(st===0){const ot=it==null?void 0:it.get(),at=_e[_e.length-1];if(ot!==void 0)_e[0]=ot;else if(rt&&et){const lt=rt.readValue(et,at);lt!=null&&(_e[0]=lt)}_e[0]===void 0&&(_e[0]=at),it&&ot===void 0&&it.set(_e[0])}else _e[st]=_e[st-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),toResolve.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,toResolve.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const sanitize=nt=>Math.round(nt*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(nt){return nt==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(nt,_e)=>et=>!!(typeof et=="string"&&singleColorRegex.test(et)&&et.startsWith(nt)||_e&&!isNullish(et)&&Object.prototype.hasOwnProperty.call(et,_e)),splitColor=(nt,_e,et)=>rt=>{if(typeof rt!="string")return rt;const[it,st,ot,at]=rt.match(floatRegex);return{[nt]:parseFloat(it),[_e]:parseFloat(st),[et]:parseFloat(ot),alpha:at!==void 0?parseFloat(at):1}},clampRgbUnit=nt=>clamp(0,255,nt),rgbUnit={...number,transform:nt=>Math.round(clampRgbUnit(nt))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:nt,green:_e,blue:et,alpha:rt=1})=>"rgba("+rgbUnit.transform(nt)+", "+rgbUnit.transform(_e)+", "+rgbUnit.transform(et)+", "+sanitize(alpha.transform(rt))+")"};function parseHex(nt){let _e="",et="",rt="",it="";return nt.length>5?(_e=nt.substring(1,3),et=nt.substring(3,5),rt=nt.substring(5,7),it=nt.substring(7,9)):(_e=nt.substring(1,2),et=nt.substring(2,3),rt=nt.substring(3,4),it=nt.substring(4,5),_e+=_e,et+=et,rt+=rt,it+=it),{red:parseInt(_e,16),green:parseInt(et,16),blue:parseInt(rt,16),alpha:it?parseInt(it,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:nt,saturation:_e,lightness:et,alpha:rt=1})=>"hsla("+Math.round(nt)+", "+percent.transform(sanitize(_e))+", "+percent.transform(sanitize(et))+", "+sanitize(alpha.transform(rt))+")"},color$1={test:nt=>rgba.test(nt)||hex.test(nt)||hsla.test(nt),parse:nt=>rgba.test(nt)?rgba.parse(nt):hsla.test(nt)?hsla.parse(nt):hex.parse(nt),transform:nt=>typeof nt=="string"?nt:nt.hasOwnProperty("red")?rgba.transform(nt):hsla.transform(nt)},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(nt){var _e,et;return isNaN(nt)&&typeof nt=="string"&&(((_e=nt.match(floatRegex))===null||_e===void 0?void 0:_e.length)||0)+(((et=nt.match(colorRegex))===null||et===void 0?void 0:et.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(nt){const _e=nt.toString(),et=[],rt={color:[],number:[],var:[]},it=[];let st=0;const at=_e.replace(complexRegex,lt=>(color$1.test(lt)?(rt.color.push(st),it.push(COLOR_TOKEN),et.push(color$1.parse(lt))):lt.startsWith(VAR_FUNCTION_TOKEN)?(rt.var.push(st),it.push(VAR_TOKEN),et.push(lt)):(rt.number.push(st),it.push(NUMBER_TOKEN),et.push(parseFloat(lt))),++st,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:et,split:at,indexes:rt,types:it}}function parseComplexValue(nt){return analyseComplexValue(nt).values}function createTransformer(nt){const{split:_e,types:et}=analyseComplexValue(nt),rt=_e.length;return it=>{let st="";for(let ot=0;ot<rt;ot++)if(st+=_e[ot],it[ot]!==void 0){const at=et[ot];at===NUMBER_TOKEN?st+=sanitize(it[ot]):at===COLOR_TOKEN?st+=color$1.transform(it[ot]):st+=it[ot]}return st}}const convertNumbersToZero=nt=>typeof nt=="number"?0:nt;function getAnimatableNone$1(nt){const _e=parseComplexValue(nt);return createTransformer(nt)(_e.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1},maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(nt){const[_e,et]=nt.slice(0,-1).split("(");if(_e==="drop-shadow")return nt;const[rt]=et.match(floatRegex)||[];if(!rt)return nt;const it=et.replace(rt,"");let st=maxDefaults.has(_e)?1:0;return rt!==et&&(st*=100),_e+"("+st+it+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:nt=>{const _e=nt.match(functionRegex);return _e?_e.map(applyDefaultFilter).join(" "):nt}},browserNumberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},int={...number,transform:Math.round},numberValueTypes={...browserNumberValueTypes,...transformValueTypes,zIndex:int,size:px,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color:color$1,backgroundColor:color$1,outlineColor:color$1,fill:color$1,stroke:color$1,borderColor:color$1,borderTopColor:color$1,borderRightColor:color$1,borderBottomColor:color$1,borderLeftColor:color$1,filter,WebkitFilter:filter},getDefaultValueType=nt=>defaultValueTypes[nt];function getAnimatableNone(nt,_e){let et=getDefaultValueType(nt);return et!==filter&&(et=complex),et.getAnimatableNone?et.getAnimatableNone(_e):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(nt,_e,et){let rt=0,it;for(;rt<nt.length&&!it;){const st=nt[rt];typeof st=="string"&&!invalidTemplates.has(st)&&analyseComplexValue(st).values.length&&(it=nt[rt]),rt++}if(it&&et)for(const st of _e)nt[st]=getAnimatableNone(et,it)}class DOMKeyframesResolver extends KeyframeResolver{constructor(_e,et,rt,it,st){super(_e,et,rt,it,st,!0)}readKeyframes(){const{unresolvedKeyframes:_e,element:et,name:rt}=this;if(!et||!et.current)return;super.readKeyframes();for(let lt=0;lt<_e.length;lt++){let ct=_e[lt];if(typeof ct=="string"&&(ct=ct.trim(),isCSSVariableToken(ct))){const ut=getVariableValue(ct,et.current);ut!==void 0&&(_e[lt]=ut),lt===_e.length-1&&(this.finalKeyframe=ct)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(rt)||_e.length!==2)return;const[it,st]=_e,ot=findDimensionValueType(it),at=findDimensionValueType(st);if(ot!==at)if(isNumOrPxType(ot)&&isNumOrPxType(at))for(let lt=0;lt<_e.length;lt++){const ct=_e[lt];typeof ct=="string"&&(_e[lt]=parseFloat(ct))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:_e,name:et}=this,rt=[];for(let it=0;it<_e.length;it++)isNone(_e[it])&&rt.push(it);rt.length&&makeNoneKeyframesAnimatable(_e,rt,et)}measureInitialState(){const{element:_e,unresolvedKeyframes:et,name:rt}=this;if(!_e||!_e.current)return;rt==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[rt](_e.measureViewportBox(),window.getComputedStyle(_e.current)),et[0]=this.measuredOrigin;const it=et[et.length-1];it!==void 0&&_e.getValue(rt,it).jump(it,!1)}measureEndState(){var _e;const{element:et,name:rt,unresolvedKeyframes:it}=this;if(!et||!et.current)return;const st=et.getValue(rt);st&&st.jump(this.measuredOrigin,!1);const ot=it.length-1,at=it[ot];it[ot]=positionalValues[rt](et.measureViewportBox(),window.getComputedStyle(et.current)),at!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=at),!((_e=this.removedTransforms)===null||_e===void 0)&&_e.length&&this.removedTransforms.forEach(([lt,ct])=>{et.getValue(lt).set(ct)}),this.resolveNoneKeyframes()}}function isGenerator(nt){return typeof nt=="function"}let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:nt=>{now=nt,queueMicrotask(clearTime)}},isAnimatable=(nt,_e)=>_e==="zIndex"?!1:!!(typeof nt=="number"||Array.isArray(nt)||typeof nt=="string"&&(complex.test(nt)||nt==="0")&&!nt.startsWith("url("));function hasKeyframesChanged(nt){const _e=nt[0];if(nt.length===1)return!0;for(let et=0;et<nt.length;et++)if(nt[et]!==_e)return!0}function canAnimate(nt,_e,et,rt){const it=nt[0];if(it===null)return!1;if(_e==="display"||_e==="visibility")return!0;const st=nt[nt.length-1],ot=isAnimatable(it,_e),at=isAnimatable(st,_e);return!ot||!at?!1:hasKeyframesChanged(nt)||(et==="spring"||isGenerator(et))&&rt}const MAX_RESOLVE_DELAY=40;class BaseAnimation{constructor({autoplay:_e=!0,delay:et=0,type:rt="keyframes",repeat:it=0,repeatDelay:st=0,repeatType:ot="loop",...at}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=time.now(),this.options={autoplay:_e,delay:et,type:rt,repeat:it,repeatDelay:st,repeatType:ot,...at},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&flushKeyframeResolvers(),this._resolved}onKeyframesResolved(_e,et){this.resolvedAt=time.now(),this.hasAttemptedResolve=!0;const{name:rt,type:it,velocity:st,delay:ot,onComplete:at,onUpdate:lt,isGenerator:ct}=this.options;if(!ct&&!canAnimate(_e,rt,it,st))if(ot)this.options.duration=0;else{lt==null||lt(getFinalKeyframe(_e,this.options,et)),at==null||at(),this.resolveFinishedPromise();return}const ut=this.initPlayback(_e,et);ut!==!1&&(this._resolved={keyframes:_e,finalKeyframe:et,...ut},this.onPostResolved())}onPostResolved(){}then(_e,et){return this.currentFinishedPromise.then(_e,et)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(_e=>{this.resolveFinishedPromise=_e})}}const progress=(nt,_e,et)=>{const rt=_e-nt;return rt===0?1:(et-nt)/rt},generateLinearEasing=(nt,_e,et=10)=>{let rt="";const it=Math.max(Math.round(_e/et),2);for(let st=0;st<it;st++)rt+=nt(progress(0,it-1,st))+", ";return`linear(${rt.substring(0,rt.length-2)})`};function velocityPerSecond(nt,_e){return _e?nt*(1e3/_e):0}const velocitySampleDuration=5;function calcGeneratorVelocity(nt,_e,et){const rt=Math.max(_e-velocitySampleDuration,0);return velocityPerSecond(et-nt(rt),_e-rt)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:nt=springDefaults.duration,bounce:_e=springDefaults.bounce,velocity:et=springDefaults.velocity,mass:rt=springDefaults.mass}){let it,st,ot=1-_e;ot=clamp(springDefaults.minDamping,springDefaults.maxDamping,ot),nt=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(nt)),ot<1?(it=ct=>{const ut=ct*ot,ht=ut*nt,dt=ut-et,ft=calcAngularFreq(ct,ot),pt=Math.exp(-ht);return safeMin-dt/ft*pt},st=ct=>{const ht=ct*ot*nt,dt=ht*et+et,ft=Math.pow(ot,2)*Math.pow(ct,2)*nt,pt=Math.exp(-ht),mt=calcAngularFreq(Math.pow(ct,2),ot);return(-it(ct)+safeMin>0?-1:1)*((dt-ft)*pt)/mt}):(it=ct=>{const ut=Math.exp(-ct*nt),ht=(ct-et)*nt+1;return-safeMin+ut*ht},st=ct=>{const ut=Math.exp(-ct*nt),ht=(et-ct)*(nt*nt);return ut*ht});const at=5/nt,lt=approximateRoot(it,st,at);if(nt=secondsToMilliseconds(nt),isNaN(lt))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:nt};{const ct=Math.pow(lt,2)*rt;return{stiffness:ct,damping:ot*2*Math.sqrt(rt*ct),duration:nt}}}const rootIterations=12;function approximateRoot(nt,_e,et){let rt=et;for(let it=1;it<rootIterations;it++)rt=rt-nt(rt)/_e(rt);return rt}function calcAngularFreq(nt,_e){return nt*Math.sqrt(1-_e*_e)}const maxGeneratorDuration=2e4;function calcGeneratorDuration(nt){let _e=0;const et=50;let rt=nt.next(_e);for(;!rt.done&&_e<maxGeneratorDuration;)_e+=et,rt=nt.next(_e);return _e>=maxGeneratorDuration?1/0:_e}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(nt,_e){return _e.some(et=>nt[et]!==void 0)}function getSpringOptions(nt){let _e={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...nt};if(!isSpringType(nt,physicsKeys)&&isSpringType(nt,durationKeys))if(nt.visualDuration){const et=nt.visualDuration,rt=2*Math.PI/(et*1.2),it=rt*rt,st=2*clamp(.05,1,1-nt.bounce)*Math.sqrt(it);_e={..._e,mass:springDefaults.mass,stiffness:it,damping:st}}else{const et=findSpring(nt);_e={..._e,...et,mass:springDefaults.mass},_e.isResolvedFromDuration=!0}return _e}function spring(nt=springDefaults.visualDuration,_e=springDefaults.bounce){const et=typeof nt!="object"?{visualDuration:nt,keyframes:[0,1],bounce:_e}:nt;let{restSpeed:rt,restDelta:it}=et;const st=et.keyframes[0],ot=et.keyframes[et.keyframes.length-1],at={done:!1,value:st},{stiffness:lt,damping:ct,mass:ut,duration:ht,velocity:dt,isResolvedFromDuration:ft}=getSpringOptions({...et,velocity:-millisecondsToSeconds(et.velocity||0)}),pt=dt||0,mt=ct/(2*Math.sqrt(lt*ut)),At=ot-st,gt=millisecondsToSeconds(Math.sqrt(lt/ut)),bt=Math.abs(At)<5;rt||(rt=bt?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),it||(it=bt?springDefaults.restDelta.granular:springDefaults.restDelta.default);let Tt;if(mt<1){const Rt=calcAngularFreq(gt,mt);Tt=It=>{const Lt=Math.exp(-mt*gt*It);return ot-Lt*((pt+mt*gt*At)/Rt*Math.sin(Rt*It)+At*Math.cos(Rt*It))}}else if(mt===1)Tt=Rt=>ot-Math.exp(-gt*Rt)*(At+(pt+gt*At)*Rt);else{const Rt=gt*Math.sqrt(mt*mt-1);Tt=It=>{const Lt=Math.exp(-mt*gt*It),$t=Math.min(Rt*It,300);return ot-Lt*((pt+mt*gt*At)*Math.sinh($t)+Rt*At*Math.cosh($t))/Rt}}const wt={calculatedDuration:ft&&ht||null,next:Rt=>{const It=Tt(Rt);if(ft)at.done=Rt>=ht;else{let Lt=0;mt<1&&(Lt=Rt===0?secondsToMilliseconds(pt):calcGeneratorVelocity(Tt,Rt,It));const $t=Math.abs(Lt)<=rt,kt=Math.abs(ot-It)<=it;at.done=$t&&kt}return at.value=at.done?ot:It,at},toString:()=>{const Rt=Math.min(calcGeneratorDuration(wt),maxGeneratorDuration),It=generateLinearEasing(Lt=>wt.next(Rt*Lt).value,Rt,30);return Rt+"ms "+It}};return wt}function inertia({keyframes:nt,velocity:_e=0,power:et=.8,timeConstant:rt=325,bounceDamping:it=10,bounceStiffness:st=500,modifyTarget:ot,min:at,max:lt,restDelta:ct=.5,restSpeed:ut}){const ht=nt[0],dt={done:!1,value:ht},ft=$t=>at!==void 0&&$t<at||lt!==void 0&&$t>lt,pt=$t=>at===void 0?lt:lt===void 0||Math.abs(at-$t)<Math.abs(lt-$t)?at:lt;let mt=et*_e;const At=ht+mt,gt=ot===void 0?At:ot(At);gt!==At&&(mt=gt-ht);const bt=$t=>-mt*Math.exp(-$t/rt),Tt=$t=>gt+bt($t),wt=$t=>{const kt=bt($t),Dt=Tt($t);dt.done=Math.abs(kt)<=ct,dt.value=dt.done?gt:Dt};let Rt,It;const Lt=$t=>{ft(dt.value)&&(Rt=$t,It=spring({keyframes:[dt.value,pt(dt.value)],velocity:calcGeneratorVelocity(Tt,$t,dt.value),damping:it,stiffness:st,restDelta:ct,restSpeed:ut}))};return Lt(0),{calculatedDuration:null,next:$t=>{let kt=!1;return!It&&Rt===void 0&&(kt=!0,wt($t),Lt($t)),Rt!==void 0&&$t>=Rt?It.next($t-Rt):(!kt&&wt($t),dt)}}}const easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=nt=>Array.isArray(nt)&&typeof nt[0]!="number",isBezierDefinition=nt=>Array.isArray(nt)&&typeof nt[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},easingDefinitionToFunction=nt=>{if(isBezierDefinition(nt)){invariant(nt.length===4);const[_e,et,rt,it]=nt;return cubicBezier(_e,et,rt,it)}else if(typeof nt=="string")return invariant(easingLookup[nt]!==void 0),easingLookup[nt];return nt},combineFunctions=(nt,_e)=>et=>_e(nt(et)),pipe=(...nt)=>nt.reduce(combineFunctions),mixNumber$1=(nt,_e,et)=>nt+(_e-nt)*et;function hueToRgb(nt,_e,et){return et<0&&(et+=1),et>1&&(et-=1),et<1/6?nt+(_e-nt)*6*et:et<1/2?_e:et<2/3?nt+(_e-nt)*(2/3-et)*6:nt}function hslaToRgba({hue:nt,saturation:_e,lightness:et,alpha:rt}){nt/=360,_e/=100,et/=100;let it=0,st=0,ot=0;if(!_e)it=st=ot=et;else{const at=et<.5?et*(1+_e):et+_e-et*_e,lt=2*et-at;it=hueToRgb(lt,at,nt+1/3),st=hueToRgb(lt,at,nt),ot=hueToRgb(lt,at,nt-1/3)}return{red:Math.round(it*255),green:Math.round(st*255),blue:Math.round(ot*255),alpha:rt}}function mixImmediate(nt,_e){return et=>et>0?_e:nt}const mixLinearColor=(nt,_e,et)=>{const rt=nt*nt,it=et*(_e*_e-rt)+rt;return it<0?0:Math.sqrt(it)},colorTypes=[hex,rgba,hsla],getColorType=nt=>colorTypes.find(_e=>_e.test(nt));function asRGBA(nt){const _e=getColorType(nt);if(!_e)return!1;let et=_e.parse(nt);return _e===hsla&&(et=hslaToRgba(et)),et}const mixColor=(nt,_e)=>{const et=asRGBA(nt),rt=asRGBA(_e);if(!et||!rt)return mixImmediate(nt,_e);const it={...et};return st=>(it.red=mixLinearColor(et.red,rt.red,st),it.green=mixLinearColor(et.green,rt.green,st),it.blue=mixLinearColor(et.blue,rt.blue,st),it.alpha=mixNumber$1(et.alpha,rt.alpha,st),rgba.transform(it))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(nt,_e){return invisibleValues.has(nt)?et=>et<=0?nt:_e:et=>et>=1?_e:nt}function mixNumber(nt,_e){return et=>mixNumber$1(nt,_e,et)}function getMixer(nt){return typeof nt=="number"?mixNumber:typeof nt=="string"?isCSSVariableToken(nt)?mixImmediate:color$1.test(nt)?mixColor:mixComplex:Array.isArray(nt)?mixArray:typeof nt=="object"?color$1.test(nt)?mixColor:mixObject:mixImmediate}function mixArray(nt,_e){const et=[...nt],rt=et.length,it=nt.map((st,ot)=>getMixer(st)(st,_e[ot]));return st=>{for(let ot=0;ot<rt;ot++)et[ot]=it[ot](st);return et}}function mixObject(nt,_e){const et={...nt,..._e},rt={};for(const it in et)nt[it]!==void 0&&_e[it]!==void 0&&(rt[it]=getMixer(nt[it])(nt[it],_e[it]));return it=>{for(const st in rt)et[st]=rt[st](it);return et}}function matchOrder(nt,_e){var et;const rt=[],it={color:0,var:0,number:0};for(let st=0;st<_e.values.length;st++){const ot=_e.types[st],at=nt.indexes[ot][it[ot]],lt=(et=nt.values[at])!==null&&et!==void 0?et:0;rt[st]=lt,it[ot]++}return rt}const mixComplex=(nt,_e)=>{const et=complex.createTransformer(_e),rt=analyseComplexValue(nt),it=analyseComplexValue(_e);return rt.indexes.var.length===it.indexes.var.length&&rt.indexes.color.length===it.indexes.color.length&&rt.indexes.number.length>=it.indexes.number.length?invisibleValues.has(nt)&&!it.values.length||invisibleValues.has(_e)&&!rt.values.length?mixVisibility(nt,_e):pipe(mixArray(matchOrder(rt,it),it.values),et):mixImmediate(nt,_e)};function mix(nt,_e,et){return typeof nt=="number"&&typeof _e=="number"&&typeof et=="number"?mixNumber$1(nt,_e,et):getMixer(nt)(nt,_e)}function createMixers(nt,_e,et){const rt=[],it=et||mix,st=nt.length-1;for(let ot=0;ot<st;ot++){let at=it(nt[ot],nt[ot+1]);if(_e){const lt=Array.isArray(_e)?_e[ot]||noop:_e;at=pipe(lt,at)}rt.push(at)}return rt}function interpolate(nt,_e,{clamp:et=!0,ease:rt,mixer:it}={}){const st=nt.length;if(invariant(st===_e.length),st===1)return()=>_e[0];if(st===2&&nt[0]===nt[1])return()=>_e[1];nt[0]>nt[st-1]&&(nt=[...nt].reverse(),_e=[..._e].reverse());const ot=createMixers(_e,rt,it),at=ot.length,lt=ct=>{let ut=0;if(at>1)for(;ut<nt.length-2&&!(ct<nt[ut+1]);ut++);const ht=progress(nt[ut],nt[ut+1],ct);return ot[ut](ht)};return et?ct=>lt(clamp(nt[0],nt[st-1],ct)):lt}function fillOffset(nt,_e){const et=nt[nt.length-1];for(let rt=1;rt<=_e;rt++){const it=progress(0,_e,rt);nt.push(mixNumber$1(et,1,it))}}function defaultOffset(nt){const _e=[0];return fillOffset(_e,nt.length-1),_e}function convertOffsetToTimes(nt,_e){return nt.map(et=>et*_e)}function defaultEasing(nt,_e){return nt.map(()=>_e||easeInOut).splice(0,nt.length-1)}function keyframes({duration:nt=300,keyframes:_e,times:et,ease:rt="easeInOut"}){const it=isEasingArray(rt)?rt.map(easingDefinitionToFunction):easingDefinitionToFunction(rt),st={done:!1,value:_e[0]},ot=convertOffsetToTimes(et&&et.length===_e.length?et:defaultOffset(_e),nt),at=interpolate(ot,_e,{ease:Array.isArray(it)?it:defaultEasing(_e,it)});return{calculatedDuration:nt,next:lt=>(st.value=at(lt),st.done=lt>=nt,st)}}const frameloopDriver=nt=>{const _e=({timestamp:et})=>nt(et);return{start:()=>frame.update(_e,!0),stop:()=>cancelFrame(_e),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generators={decay:inertia,inertia,tween:keyframes,keyframes,spring},percentToProgress=nt=>nt/100;class MainThreadAnimation extends BaseAnimation{constructor(_e){super(_e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:lt}=this.options;lt&&lt()};const{name:et,motionValue:rt,element:it,keyframes:st}=this.options,ot=(it==null?void 0:it.KeyframeResolver)||KeyframeResolver,at=(lt,ct)=>this.onKeyframesResolved(lt,ct);this.resolver=new ot(st,at,et,rt,it),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(_e){const{type:et="keyframes",repeat:rt=0,repeatDelay:it=0,repeatType:st,velocity:ot=0}=this.options,at=isGenerator(et)?et:generators[et]||keyframes;let lt,ct;at!==keyframes&&typeof _e[0]!="number"&&(lt=pipe(percentToProgress,mix(_e[0],_e[1])),_e=[0,100]);const ut=at({...this.options,keyframes:_e});st==="mirror"&&(ct=at({...this.options,keyframes:[..._e].reverse(),velocity:-ot})),ut.calculatedDuration===null&&(ut.calculatedDuration=calcGeneratorDuration(ut));const{calculatedDuration:ht}=ut,dt=ht+it,ft=dt*(rt+1)-it;return{generator:ut,mirroredGenerator:ct,mapPercentToKeyframes:lt,calculatedDuration:ht,resolvedDuration:dt,totalDuration:ft}}onPostResolved(){const{autoplay:_e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!_e?this.pause():this.state=this.pendingPlayState}tick(_e,et=!1){const{resolved:rt}=this;if(!rt){const{keyframes:$t}=this.options;return{done:!0,value:$t[$t.length-1]}}const{finalKeyframe:it,generator:st,mirroredGenerator:ot,mapPercentToKeyframes:at,keyframes:lt,calculatedDuration:ct,totalDuration:ut,resolvedDuration:ht}=rt;if(this.startTime===null)return st.next(0);const{delay:dt,repeat:ft,repeatType:pt,repeatDelay:mt,onUpdate:At}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,_e):this.speed<0&&(this.startTime=Math.min(_e-ut/this.speed,this.startTime)),et?this.currentTime=_e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(_e-this.startTime)*this.speed;const gt=this.currentTime-dt*(this.speed>=0?1:-1),bt=this.speed>=0?gt<0:gt>ut;this.currentTime=Math.max(gt,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=ut);let Tt=this.currentTime,wt=st;if(ft){const $t=Math.min(this.currentTime,ut)/ht;let kt=Math.floor($t),Dt=$t%1;!Dt&&$t>=1&&(Dt=1),Dt===1&&kt--,kt=Math.min(kt,ft+1),!!(kt%2)&&(pt==="reverse"?(Dt=1-Dt,mt&&(Dt-=mt/ht)):pt==="mirror"&&(wt=ot)),Tt=clamp(0,1,Dt)*ht}const Rt=bt?{done:!1,value:lt[0]}:wt.next(Tt);at&&(Rt.value=at(Rt.value));let{done:It}=Rt;!bt&&ct!==null&&(It=this.speed>=0?this.currentTime>=ut:this.currentTime<=0);const Lt=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&It);return Lt&&it!==void 0&&(Rt.value=getFinalKeyframe(lt,this.options,it)),At&&At(Rt.value),Lt&&this.finish(),Rt}get duration(){const{resolved:_e}=this;return _e?millisecondsToSeconds(_e.calculatedDuration):0}get time(){return millisecondsToSeconds(this.currentTime)}set time(_e){_e=secondsToMilliseconds(_e),this.currentTime=_e,this.holdTime!==null||this.speed===0?this.holdTime=_e:this.driver&&(this.startTime=this.driver.now()-_e/this.speed)}get speed(){return this.playbackSpeed}set speed(_e){const et=this.playbackSpeed!==_e;this.playbackSpeed=_e,et&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:_e=frameloopDriver,onPlay:et,startTime:rt}=this.options;this.driver||(this.driver=_e(st=>this.tick(st))),et&&et();const it=this.driver.now();this.holdTime!==null?this.startTime=it-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=it):this.startTime=rt??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var _e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(_e=this.currentTime)!==null&&_e!==void 0?_e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:_e}=this.options;_e&&_e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(_e){return this.startTime=0,this.tick(_e,!0)}}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]);function memo(nt){let _e;return()=>(_e===void 0&&(_e=nt()),_e)}const supportsFlags={linearEasing:void 0};function memoSupports(nt,_e){const et=memo(nt);return()=>{var rt;return(rt=supportsFlags[_e])!==null&&rt!==void 0?rt:et()}}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing");function isWaapiSupportedEasing(nt){return!!(typeof nt=="function"&&supportsLinearEasing()||!nt||typeof nt=="string"&&(nt in supportedWaapiEasing||supportsLinearEasing())||isBezierDefinition(nt)||Array.isArray(nt)&&nt.every(isWaapiSupportedEasing))}const cubicBezierAsString=([nt,_e,et,rt])=>`cubic-bezier(${nt}, ${_e}, ${et}, ${rt})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(nt,_e){if(nt)return typeof nt=="function"&&supportsLinearEasing()?generateLinearEasing(nt,_e):isBezierDefinition(nt)?cubicBezierAsString(nt):Array.isArray(nt)?nt.map(et=>mapEasingToNativeEasing(et,_e)||supportedWaapiEasing.easeOut):supportedWaapiEasing[nt]}function startWaapiAnimation(nt,_e,et,{delay:rt=0,duration:it=300,repeat:st=0,repeatType:ot="loop",ease:at="easeInOut",times:lt}={}){const ct={[_e]:et};lt&&(ct.offset=lt);const ut=mapEasingToNativeEasing(at,it);return Array.isArray(ut)&&(ct.easing=ut),nt.animate(ct,{delay:rt,duration:it,easing:Array.isArray(ut)?"linear":ut,fill:"both",iterations:st+1,direction:ot==="reverse"?"alternate":"normal"})}function attachTimeline(nt,_e){nt.timeline=_e,nt.onfinish=null}const supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),sampleDelta=10,maxDuration=2e4;function requiresPregeneratedKeyframes(nt){return isGenerator(nt.type)||nt.type==="spring"||!isWaapiSupportedEasing(nt.ease)}function pregenerateKeyframes(nt,_e){const et=new MainThreadAnimation({..._e,keyframes:nt,repeat:0,delay:0,isGenerator:!0});let rt={done:!1,value:nt[0]};const it=[];let st=0;for(;!rt.done&&st<maxDuration;)rt=et.sample(st),it.push(rt.value),st+=sampleDelta;return{times:void 0,keyframes:it,duration:st-sampleDelta,ease:"linear"}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(nt){return nt in unsupportedEasingFunctions}class AcceleratedAnimation extends BaseAnimation{constructor(_e){super(_e);const{name:et,motionValue:rt,element:it,keyframes:st}=this.options;this.resolver=new DOMKeyframesResolver(st,(ot,at)=>this.onKeyframesResolved(ot,at),et,rt,it),this.resolver.scheduleResolve()}initPlayback(_e,et){var rt;let{duration:it=300,times:st,ease:ot,type:at,motionValue:lt,name:ct,startTime:ut}=this.options;if(!(!((rt=lt.owner)===null||rt===void 0)&&rt.current))return!1;if(typeof ot=="string"&&supportsLinearEasing()&&isUnsupportedEase(ot)&&(ot=unsupportedEasingFunctions[ot]),requiresPregeneratedKeyframes(this.options)){const{onComplete:dt,onUpdate:ft,motionValue:pt,element:mt,...At}=this.options,gt=pregenerateKeyframes(_e,At);_e=gt.keyframes,_e.length===1&&(_e[1]=_e[0]),it=gt.duration,st=gt.times,ot=gt.ease,at="keyframes"}const ht=startWaapiAnimation(lt.owner.current,ct,_e,{...this.options,duration:it,times:st,ease:ot});return ht.startTime=ut??this.calcStartTime(),this.pendingTimeline?(attachTimeline(ht,this.pendingTimeline),this.pendingTimeline=void 0):ht.onfinish=()=>{const{onComplete:dt}=this.options;lt.set(getFinalKeyframe(_e,this.options,et)),dt&&dt(),this.cancel(),this.resolveFinishedPromise()},{animation:ht,duration:it,times:st,type:at,ease:ot,keyframes:_e}}get duration(){const{resolved:_e}=this;if(!_e)return 0;const{duration:et}=_e;return millisecondsToSeconds(et)}get time(){const{resolved:_e}=this;if(!_e)return 0;const{animation:et}=_e;return millisecondsToSeconds(et.currentTime||0)}set time(_e){const{resolved:et}=this;if(!et)return;const{animation:rt}=et;rt.currentTime=secondsToMilliseconds(_e)}get speed(){const{resolved:_e}=this;if(!_e)return 1;const{animation:et}=_e;return et.playbackRate}set speed(_e){const{resolved:et}=this;if(!et)return;const{animation:rt}=et;rt.playbackRate=_e}get state(){const{resolved:_e}=this;if(!_e)return"idle";const{animation:et}=_e;return et.playState}get startTime(){const{resolved:_e}=this;if(!_e)return null;const{animation:et}=_e;return et.startTime}attachTimeline(_e){if(!this._resolved)this.pendingTimeline=_e;else{const{resolved:et}=this;if(!et)return noop;const{animation:rt}=et;attachTimeline(rt,_e)}return noop}play(){if(this.isStopped)return;const{resolved:_e}=this;if(!_e)return;const{animation:et}=_e;et.playState==="finished"&&this.updateFinishedPromise(),et.play()}pause(){const{resolved:_e}=this;if(!_e)return;const{animation:et}=_e;et.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:_e}=this;if(!_e)return;const{animation:et,keyframes:rt,duration:it,type:st,ease:ot,times:at}=_e;if(et.playState==="idle"||et.playState==="finished")return;if(this.time){const{motionValue:ct,onUpdate:ut,onComplete:ht,element:dt,...ft}=this.options,pt=new MainThreadAnimation({...ft,keyframes:rt,duration:it,type:st,ease:ot,times:at,isGenerator:!0}),mt=secondsToMilliseconds(this.time);ct.setWithVelocity(pt.sample(mt-sampleDelta).value,pt.sample(mt).value,sampleDelta)}const{onStop:lt}=this.options;lt&&lt(),this.cancel()}complete(){const{resolved:_e}=this;_e&&_e.animation.finish()}cancel(){const{resolved:_e}=this;_e&&_e.animation.cancel()}static supports(_e){const{motionValue:et,name:rt,repeatDelay:it,repeatType:st,damping:ot,type:at}=_e;return supportsWaapi()&&rt&&acceleratedValues.has(rt)&&et&&et.owner&&et.owner.current instanceof HTMLElement&&!et.owner.getProps().onUpdate&&!it&&st!=="mirror"&&ot!==0&&at!=="inertia"}}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0);class GroupPlaybackControls{constructor(_e){this.stop=()=>this.runAll("stop"),this.animations=_e.filter(Boolean)}then(_e,et){return Promise.all(this.animations).then(_e).catch(et)}getAll(_e){return this.animations[0][_e]}setAll(_e,et){for(let rt=0;rt<this.animations.length;rt++)this.animations[rt][_e]=et}attachTimeline(_e,et){const rt=this.animations.map(it=>supportsScrollTimeline()&&it.attachTimeline?it.attachTimeline(_e):et(it));return()=>{rt.forEach((it,st)=>{it&&it(),this.animations[st].stop()})}}get time(){return this.getAll("time")}set time(_e){this.setAll("time",_e)}get speed(){return this.getAll("speed")}set speed(_e){this.setAll("speed",_e)}get startTime(){return this.getAll("startTime")}get duration(){let _e=0;for(let et=0;et<this.animations.length;et++)_e=Math.max(_e,this.animations[et].duration);return _e}runAll(_e){this.animations.forEach(et=>et[_e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function isTransitionDefined({when:nt,delay:_e,delayChildren:et,staggerChildren:rt,staggerDirection:it,repeat:st,repeatType:ot,repeatDelay:at,from:lt,elapsed:ct,...ut}){return!!Object.keys(ut).length}const animateMotionValue=(nt,_e,et,rt={},it,st)=>ot=>{const at=getValueTransition(rt,nt)||{},lt=at.delay||rt.delay||0;let{elapsed:ct=0}=rt;ct=ct-secondsToMilliseconds(lt);let ut={keyframes:Array.isArray(et)?et:[null,et],ease:"easeOut",velocity:_e.getVelocity(),...at,delay:-ct,onUpdate:dt=>{_e.set(dt),at.onUpdate&&at.onUpdate(dt)},onComplete:()=>{ot(),at.onComplete&&at.onComplete()},name:nt,motionValue:_e,element:st?void 0:it};isTransitionDefined(at)||(ut={...ut,...getDefaultTransition(nt,ut)}),ut.duration&&(ut.duration=secondsToMilliseconds(ut.duration)),ut.repeatDelay&&(ut.repeatDelay=secondsToMilliseconds(ut.repeatDelay)),ut.from!==void 0&&(ut.keyframes[0]=ut.from);let ht=!1;if((ut.type===!1||ut.duration===0&&!ut.repeatDelay)&&(ut.duration=0,ut.delay===0&&(ht=!0)),ht&&!st&&_e.get()!==void 0){const dt=getFinalKeyframe(ut.keyframes,at);if(dt!==void 0)return frame.update(()=>{ut.onUpdate(dt),ut.onComplete()}),new GroupPlaybackControls([])}return!st&&AcceleratedAnimation.supports(ut)?new AcceleratedAnimation(ut):new MainThreadAnimation(ut)},isCustomValue=nt=>!!(nt&&typeof nt=="object"&&nt.mix&&nt.toValue),resolveFinalValueInKeyframes=nt=>isKeyframesTarget(nt)?nt[nt.length-1]||0:nt;function addUniqueItem(nt,_e){nt.indexOf(_e)===-1&&nt.push(_e)}function removeItem(nt,_e){const et=nt.indexOf(_e);et>-1&&nt.splice(et,1)}class SubscriptionManager{constructor(){this.subscriptions=[]}add(_e){return addUniqueItem(this.subscriptions,_e),()=>removeItem(this.subscriptions,_e)}notify(_e,et,rt){const it=this.subscriptions.length;if(it)if(it===1)this.subscriptions[0](_e,et,rt);else for(let st=0;st<it;st++){const ot=this.subscriptions[st];ot&&ot(_e,et,rt)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const MAX_VELOCITY_DELTA=30,isFloat=nt=>!isNaN(parseFloat(nt));class MotionValue{constructor(_e,et={}){this.version="11.12.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(rt,it=!0)=>{const st=time.now();this.updatedAt!==st&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(rt),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),it&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(_e),this.owner=et.owner}setCurrent(_e){this.current=_e,this.updatedAt=time.now(),this.canTrackVelocity===null&&_e!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(_e=this.current){this.prevFrameValue=_e,this.prevUpdatedAt=this.updatedAt}onChange(_e){return this.on("change",_e)}on(_e,et){this.events[_e]||(this.events[_e]=new SubscriptionManager);const rt=this.events[_e].add(et);return _e==="change"?()=>{rt(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:rt}clearListeners(){for(const _e in this.events)this.events[_e].clear()}attach(_e,et){this.passiveEffect=_e,this.stopPassiveEffect=et}set(_e,et=!0){!et||!this.passiveEffect?this.updateAndNotify(_e,et):this.passiveEffect(_e,this.updateAndNotify)}setWithVelocity(_e,et,rt){this.set(et),this.prev=void 0,this.prevFrameValue=_e,this.prevUpdatedAt=this.updatedAt-rt}jump(_e,et=!0){this.updateAndNotify(_e),this.prev=_e,this.prevUpdatedAt=this.prevFrameValue=void 0,et&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const _e=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||_e-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const et=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),et)}start(_e){return this.stop(),new Promise(et=>{this.hasAnimated=!0,this.animation=_e(et),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(nt,_e){return new MotionValue(nt,_e)}function setMotionValue(nt,_e,et){nt.hasValue(_e)?nt.getValue(_e).set(et):nt.addValue(_e,motionValue(et))}function setTarget(nt,_e){const et=resolveVariant(nt,_e);let{transitionEnd:rt={},transition:it={},...st}=et||{};st={...st,...rt};for(const ot in st){const at=resolveFinalValueInKeyframes(st[ot]);setMotionValue(nt,ot,at)}}const camelToDash=nt=>nt.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId);function getOptimisedAppearId(nt){return nt.props[optimizedAppearDataAttribute]}const isMotionValue=nt=>!!(nt&&nt.getVelocity);function isWillChangeMotionValue(nt){return!!(isMotionValue(nt)&&nt.add)}function addValueToWillChange(nt,_e){const et=nt.getValue("willChange");if(isWillChangeMotionValue(et))return et.add(_e)}function shouldBlockAnimation({protectedKeys:nt,needsAnimating:_e},et){const rt=nt.hasOwnProperty(et)&&_e[et]!==!0;return _e[et]=!1,rt}function animateTarget(nt,_e,{delay:et=0,transitionOverride:rt,type:it}={}){var st;let{transition:ot=nt.getDefaultTransition(),transitionEnd:at,...lt}=_e;rt&&(ot=rt);const ct=[],ut=it&&nt.animationState&&nt.animationState.getState()[it];for(const ht in lt){const dt=nt.getValue(ht,(st=nt.latestValues[ht])!==null&&st!==void 0?st:null),ft=lt[ht];if(ft===void 0||ut&&shouldBlockAnimation(ut,ht))continue;const pt={delay:et,...getValueTransition(ot||{},ht)};let mt=!1;if(window.MotionHandoffAnimation){const gt=getOptimisedAppearId(nt);if(gt){const bt=window.MotionHandoffAnimation(gt,ht,frame);bt!==null&&(pt.startTime=bt,mt=!0)}}addValueToWillChange(nt,ht),dt.start(animateMotionValue(ht,dt,ft,nt.shouldReduceMotion&&transformProps.has(ht)?{type:!1}:pt,nt,mt));const At=dt.animation;At&&ct.push(At)}return at&&Promise.all(ct).then(()=>{frame.update(()=>{at&&setTarget(nt,at)})}),ct}function animateVariant(nt,_e,et={}){var rt;const it=resolveVariant(nt,_e,et.type==="exit"?(rt=nt.presenceContext)===null||rt===void 0?void 0:rt.custom:void 0);let{transition:st=nt.getDefaultTransition()||{}}=it||{};et.transitionOverride&&(st=et.transitionOverride);const ot=it?()=>Promise.all(animateTarget(nt,it,et)):()=>Promise.resolve(),at=nt.variantChildren&&nt.variantChildren.size?(ct=0)=>{const{delayChildren:ut=0,staggerChildren:ht,staggerDirection:dt}=st;return animateChildren(nt,_e,ut+ct,ht,dt,et)}:()=>Promise.resolve(),{when:lt}=st;if(lt){const[ct,ut]=lt==="beforeChildren"?[ot,at]:[at,ot];return ct().then(()=>ut())}else return Promise.all([ot(),at(et.delay)])}function animateChildren(nt,_e,et=0,rt=0,it=1,st){const ot=[],at=(nt.variantChildren.size-1)*rt,lt=it===1?(ct=0)=>ct*rt:(ct=0)=>at-ct*rt;return Array.from(nt.variantChildren).sort(sortByTreeOrder).forEach((ct,ut)=>{ct.notify("AnimationStart",_e),ot.push(animateVariant(ct,_e,{...st,delay:et+lt(ut)}).then(()=>ct.notify("AnimationComplete",_e)))}),Promise.all(ot)}function sortByTreeOrder(nt,_e){return nt.sortNodePosition(_e)}function animateVisualElement(nt,_e,et={}){nt.notify("AnimationStart",_e);let rt;if(Array.isArray(_e)){const it=_e.map(st=>animateVariant(nt,st,et));rt=Promise.all(it)}else if(typeof _e=="string")rt=animateVariant(nt,_e,et);else{const it=typeof _e=="function"?resolveVariant(nt,_e,et.custom):_e;rt=Promise.all(animateTarget(nt,it,et))}return rt.then(()=>{nt.notify("AnimationComplete",_e)})}const numVariantProps=variantProps.length;function getVariantContext(nt){if(!nt)return;if(!nt.isControllingVariants){const et=nt.parent?getVariantContext(nt.parent)||{}:{};return nt.props.initial!==void 0&&(et.initial=nt.props.initial),et}const _e={};for(let et=0;et<numVariantProps;et++){const rt=variantProps[et],it=nt.props[rt];(isVariantLabel(it)||it===!1)&&(_e[rt]=it)}return _e}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(nt){return _e=>Promise.all(_e.map(({animation:et,options:rt})=>animateVisualElement(nt,et,rt)))}function createAnimationState(nt){let _e=animateList(nt),et=createState(),rt=!0;const it=lt=>(ct,ut)=>{var ht;const dt=resolveVariant(nt,ut,lt==="exit"?(ht=nt.presenceContext)===null||ht===void 0?void 0:ht.custom:void 0);if(dt){const{transition:ft,transitionEnd:pt,...mt}=dt;ct={...ct,...mt,...pt}}return ct};function st(lt){_e=lt(nt)}function ot(lt){const{props:ct}=nt,ut=getVariantContext(nt.parent)||{},ht=[],dt=new Set;let ft={},pt=1/0;for(let At=0;At<numAnimationTypes;At++){const gt=reversePriorityOrder[At],bt=et[gt],Tt=ct[gt]!==void 0?ct[gt]:ut[gt],wt=isVariantLabel(Tt),Rt=gt===lt?bt.isActive:null;Rt===!1&&(pt=At);let It=Tt===ut[gt]&&Tt!==ct[gt]&&wt;if(It&&rt&&nt.manuallyAnimateOnMount&&(It=!1),bt.protectedKeys={...ft},!bt.isActive&&Rt===null||!Tt&&!bt.prevProp||isAnimationControls(Tt)||typeof Tt=="boolean")continue;const Lt=checkVariantsDidChange(bt.prevProp,Tt);let $t=Lt||gt===lt&&bt.isActive&&!It&&wt||At>pt&&wt,kt=!1;const Dt=Array.isArray(Tt)?Tt:[Tt];let Ot=Dt.reduce(it(gt),{});Rt===!1&&(Ot={});const{prevResolvedValues:zt={}}=bt,Ht={...zt,...Ot},Yt=rn=>{$t=!0,dt.has(rn)&&(kt=!0,dt.delete(rn)),bt.needsAnimating[rn]=!0;const Gt=nt.getValue(rn);Gt&&(Gt.liveStyle=!1)};for(const rn in Ht){const Gt=Ot[rn],jt=zt[rn];if(ft.hasOwnProperty(rn))continue;let Kt=!1;isKeyframesTarget(Gt)&&isKeyframesTarget(jt)?Kt=!shallowCompare(Gt,jt):Kt=Gt!==jt,Kt?Gt!=null?Yt(rn):dt.add(rn):Gt!==void 0&&dt.has(rn)?Yt(rn):bt.protectedKeys[rn]=!0}bt.prevProp=Tt,bt.prevResolvedValues=Ot,bt.isActive&&(ft={...ft,...Ot}),rt&&nt.blockInitialAnimation&&($t=!1),$t&&(!(It&&Lt)||kt)&&ht.push(...Dt.map(rn=>({animation:rn,options:{type:gt}})))}if(dt.size){const At={};dt.forEach(gt=>{const bt=nt.getBaseTarget(gt),Tt=nt.getValue(gt);Tt&&(Tt.liveStyle=!0),At[gt]=bt??null}),ht.push({animation:At})}let mt=!!ht.length;return rt&&(ct.initial===!1||ct.initial===ct.animate)&&!nt.manuallyAnimateOnMount&&(mt=!1),rt=!1,mt?_e(ht):Promise.resolve()}function at(lt,ct){var ut;if(et[lt].isActive===ct)return Promise.resolve();(ut=nt.variantChildren)===null||ut===void 0||ut.forEach(dt=>{var ft;return(ft=dt.animationState)===null||ft===void 0?void 0:ft.setActive(lt,ct)}),et[lt].isActive=ct;const ht=ot(lt);for(const dt in et)et[dt].protectedKeys={};return ht}return{animateChanges:ot,setActive:at,setAnimateFunction:st,getState:()=>et,reset:()=>{et=createState(),rt=!0}}}function checkVariantsDidChange(nt,_e){return typeof _e=="string"?_e!==nt:Array.isArray(_e)?!shallowCompare(_e,nt):!1}function createTypeState(nt=!1){return{isActive:nt,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(_e){this.isMounted=!1,this.node=_e}update(){}}class AnimationFeature extends Feature{constructor(_e){super(_e),_e.animationState||(_e.animationState=createAnimationState(_e))}updateAnimationControlsSubscription(){const{animate:_e}=this.node.getProps();isAnimationControls(_e)&&(this.unmountControls=_e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:_e}=this.node.getProps(),{animate:et}=this.node.prevProps||{};_e!==et&&this.updateAnimationControlsSubscription()}unmount(){var _e;this.node.animationState.reset(),(_e=this.unmountControls)===null||_e===void 0||_e.call(this)}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:_e,onExitComplete:et}=this.node.presenceContext,{isPresent:rt}=this.node.prevPresenceContext||{};if(!this.node.animationState||_e===rt)return;const it=this.node.animationState.setActive("exit",!_e);et&&!_e&&it.then(()=>et(this.id))}mount(){const{register:_e}=this.node.presenceContext||{};_e&&(this.unmount=_e(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}},isPrimaryPointer=nt=>nt.pointerType==="mouse"?typeof nt.button!="number"||nt.button<=0:nt.isPrimary!==!1;function extractEventInfo(nt,_e="page"){return{point:{x:nt[`${_e}X`],y:nt[`${_e}Y`]}}}const addPointerInfo=nt=>_e=>isPrimaryPointer(_e)&&nt(_e,extractEventInfo(_e));function addDomEvent(nt,_e,et,rt={passive:!0}){return nt.addEventListener(_e,et,rt),()=>nt.removeEventListener(_e,et)}function addPointerEvent(nt,_e,et,rt){return addDomEvent(nt,_e,addPointerInfo(et),rt)}const distance=(nt,_e)=>Math.abs(nt-_e);function distance2D(nt,_e){const et=distance(nt.x,_e.x),rt=distance(nt.y,_e.y);return Math.sqrt(et**2+rt**2)}class PanSession{constructor(_e,et,{transformPagePoint:rt,contextWindow:it,dragSnapToOrigin:st=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ht=getPanInfo(this.lastMoveEventInfo,this.history),dt=this.startEvent!==null,ft=distance2D(ht.offset,{x:0,y:0})>=3;if(!dt&&!ft)return;const{point:pt}=ht,{timestamp:mt}=frameData;this.history.push({...pt,timestamp:mt});const{onStart:At,onMove:gt}=this.handlers;dt||(At&&At(this.lastMoveEvent,ht),this.startEvent=this.lastMoveEvent),gt&&gt(this.lastMoveEvent,ht)},this.handlePointerMove=(ht,dt)=>{this.lastMoveEvent=ht,this.lastMoveEventInfo=transformPoint(dt,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(ht,dt)=>{this.end();const{onEnd:ft,onSessionEnd:pt,resumeAnimation:mt}=this.handlers;if(this.dragSnapToOrigin&&mt&&mt(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const At=getPanInfo(ht.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(dt,this.transformPagePoint),this.history);this.startEvent&&ft&&ft(ht,At),pt&&pt(ht,At)},!isPrimaryPointer(_e))return;this.dragSnapToOrigin=st,this.handlers=et,this.transformPagePoint=rt,this.contextWindow=it||window;const ot=extractEventInfo(_e),at=transformPoint(ot,this.transformPagePoint),{point:lt}=at,{timestamp:ct}=frameData;this.history=[{...lt,timestamp:ct}];const{onSessionStart:ut}=et;ut&&ut(_e,getPanInfo(at,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(_e){this.handlers=_e}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(nt,_e){return _e?{point:_e(nt.point)}:nt}function subtractPoint(nt,_e){return{x:nt.x-_e.x,y:nt.y-_e.y}}function getPanInfo({point:nt},_e){return{point:nt,delta:subtractPoint(nt,lastDevicePoint(_e)),offset:subtractPoint(nt,startDevicePoint(_e)),velocity:getVelocity(_e,.1)}}function startDevicePoint(nt){return nt[0]}function lastDevicePoint(nt){return nt[nt.length-1]}function getVelocity(nt,_e){if(nt.length<2)return{x:0,y:0};let et=nt.length-1,rt=null;const it=lastDevicePoint(nt);for(;et>=0&&(rt=nt[et],!(it.timestamp-rt.timestamp>secondsToMilliseconds(_e)));)et--;if(!rt)return{x:0,y:0};const st=millisecondsToSeconds(it.timestamp-rt.timestamp);if(st===0)return{x:0,y:0};const ot={x:(it.x-rt.x)/st,y:(it.y-rt.y)/st};return ot.x===1/0&&(ot.x=0),ot.y===1/0&&(ot.y=0),ot}function createLock(nt){let _e=null;return()=>{const et=()=>{_e=null};return _e===null?(_e=nt,et):!1}}const globalHorizontalLock=createLock("dragHorizontal"),globalVerticalLock=createLock("dragVertical");function getGlobalLock(nt){let _e=!1;if(nt==="y")_e=globalVerticalLock();else if(nt==="x")_e=globalHorizontalLock();else{const et=globalHorizontalLock(),rt=globalVerticalLock();et&&rt?_e=()=>{et(),rt()}:(et&&et(),rt&&rt())}return _e}function isDragActive(){const nt=getGlobalLock(!0);return nt?(nt(),!1):!0}function isRefObject(nt){return nt&&typeof nt=="object"&&Object.prototype.hasOwnProperty.call(nt,"current")}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(nt){return nt.max-nt.min}function isNear(nt,_e,et){return Math.abs(nt-_e)<=et}function calcAxisDelta(nt,_e,et,rt=.5){nt.origin=rt,nt.originPoint=mixNumber$1(_e.min,_e.max,nt.origin),nt.scale=calcLength(et)/calcLength(_e),nt.translate=mixNumber$1(et.min,et.max,nt.origin)-nt.originPoint,(nt.scale>=SCALE_MIN&&nt.scale<=SCALE_MAX||isNaN(nt.scale))&&(nt.scale=1),(nt.translate>=TRANSLATE_MIN&&nt.translate<=TRANSLATE_MAX||isNaN(nt.translate))&&(nt.translate=0)}function calcBoxDelta(nt,_e,et,rt){calcAxisDelta(nt.x,_e.x,et.x,rt?rt.originX:void 0),calcAxisDelta(nt.y,_e.y,et.y,rt?rt.originY:void 0)}function calcRelativeAxis(nt,_e,et){nt.min=et.min+_e.min,nt.max=nt.min+calcLength(_e)}function calcRelativeBox(nt,_e,et){calcRelativeAxis(nt.x,_e.x,et.x),calcRelativeAxis(nt.y,_e.y,et.y)}function calcRelativeAxisPosition(nt,_e,et){nt.min=_e.min-et.min,nt.max=nt.min+calcLength(_e)}function calcRelativePosition(nt,_e,et){calcRelativeAxisPosition(nt.x,_e.x,et.x),calcRelativeAxisPosition(nt.y,_e.y,et.y)}function applyConstraints(nt,{min:_e,max:et},rt){return _e!==void 0&&nt<_e?nt=rt?mixNumber$1(_e,nt,rt.min):Math.max(nt,_e):et!==void 0&&nt>et&&(nt=rt?mixNumber$1(et,nt,rt.max):Math.min(nt,et)),nt}function calcRelativeAxisConstraints(nt,_e,et){return{min:_e!==void 0?nt.min+_e:void 0,max:et!==void 0?nt.max+et-(nt.max-nt.min):void 0}}function calcRelativeConstraints(nt,{top:_e,left:et,bottom:rt,right:it}){return{x:calcRelativeAxisConstraints(nt.x,et,it),y:calcRelativeAxisConstraints(nt.y,_e,rt)}}function calcViewportAxisConstraints(nt,_e){let et=_e.min-nt.min,rt=_e.max-nt.max;return _e.max-_e.min<nt.max-nt.min&&([et,rt]=[rt,et]),{min:et,max:rt}}function calcViewportConstraints(nt,_e){return{x:calcViewportAxisConstraints(nt.x,_e.x),y:calcViewportAxisConstraints(nt.y,_e.y)}}function calcOrigin$1(nt,_e){let et=.5;const rt=calcLength(nt),it=calcLength(_e);return it>rt?et=progress(_e.min,_e.max-rt,nt.min):rt>it&&(et=progress(nt.min,nt.max-it,_e.min)),clamp(0,1,et)}function rebaseAxisConstraints(nt,_e){const et={};return _e.min!==void 0&&(et.min=_e.min-nt.min),_e.max!==void 0&&(et.max=_e.max-nt.min),et}const defaultElastic=.35;function resolveDragElastic(nt=defaultElastic){return nt===!1?nt=0:nt===!0&&(nt=defaultElastic),{x:resolveAxisElastic(nt,"left","right"),y:resolveAxisElastic(nt,"top","bottom")}}function resolveAxisElastic(nt,_e,et){return{min:resolvePointElastic(nt,_e),max:resolvePointElastic(nt,et)}}function resolvePointElastic(nt,_e){return typeof nt=="number"?nt:nt[_e]||0}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(nt){return[nt("x"),nt("y")]}function convertBoundingBoxToBox({top:nt,left:_e,right:et,bottom:rt}){return{x:{min:_e,max:et},y:{min:nt,max:rt}}}function convertBoxToBoundingBox({x:nt,y:_e}){return{top:_e.min,right:nt.max,bottom:_e.max,left:nt.min}}function transformBoxPoints(nt,_e){if(!_e)return nt;const et=_e({x:nt.left,y:nt.top}),rt=_e({x:nt.right,y:nt.bottom});return{top:et.y,left:et.x,bottom:rt.y,right:rt.x}}function isIdentityScale(nt){return nt===void 0||nt===1}function hasScale({scale:nt,scaleX:_e,scaleY:et}){return!isIdentityScale(nt)||!isIdentityScale(_e)||!isIdentityScale(et)}function hasTransform(nt){return hasScale(nt)||has2DTranslate(nt)||nt.z||nt.rotate||nt.rotateX||nt.rotateY||nt.skewX||nt.skewY}function has2DTranslate(nt){return is2DTranslate(nt.x)||is2DTranslate(nt.y)}function is2DTranslate(nt){return nt&&nt!=="0%"}function scalePoint(nt,_e,et){const rt=nt-et,it=_e*rt;return et+it}function applyPointDelta(nt,_e,et,rt,it){return it!==void 0&&(nt=scalePoint(nt,it,rt)),scalePoint(nt,et,rt)+_e}function applyAxisDelta(nt,_e=0,et=1,rt,it){nt.min=applyPointDelta(nt.min,_e,et,rt,it),nt.max=applyPointDelta(nt.max,_e,et,rt,it)}function applyBoxDelta(nt,{x:_e,y:et}){applyAxisDelta(nt.x,_e.translate,_e.scale,_e.originPoint),applyAxisDelta(nt.y,et.translate,et.scale,et.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(nt,_e,et,rt=!1){const it=et.length;if(!it)return;_e.x=_e.y=1;let st,ot;for(let at=0;at<it;at++){st=et[at],ot=st.projectionDelta;const{visualElement:lt}=st.options;lt&&lt.props.style&&lt.props.style.display==="contents"||(rt&&st.options.layoutScroll&&st.scroll&&st!==st.root&&transformBox(nt,{x:-st.scroll.offset.x,y:-st.scroll.offset.y}),ot&&(_e.x*=ot.x.scale,_e.y*=ot.y.scale,applyBoxDelta(nt,ot)),rt&&hasTransform(st.latestValues)&&transformBox(nt,st.latestValues))}_e.x<TREE_SCALE_SNAP_MAX&&_e.x>TREE_SCALE_SNAP_MIN&&(_e.x=1),_e.y<TREE_SCALE_SNAP_MAX&&_e.y>TREE_SCALE_SNAP_MIN&&(_e.y=1)}function translateAxis(nt,_e){nt.min=nt.min+_e,nt.max=nt.max+_e}function transformAxis(nt,_e,et,rt,it=.5){const st=mixNumber$1(nt.min,nt.max,it);applyAxisDelta(nt,_e,et,st,rt)}function transformBox(nt,_e){transformAxis(nt.x,_e.x,_e.scaleX,_e.scale,_e.originX),transformAxis(nt.y,_e.y,_e.scaleY,_e.scale,_e.originY)}function measureViewportBox(nt,_e){return convertBoundingBoxToBox(transformBoxPoints(nt.getBoundingClientRect(),_e))}function measurePageBox(nt,_e,et){const rt=measureViewportBox(nt,et),{scroll:it}=_e;return it&&(translateAxis(rt.x,it.offset.x),translateAxis(rt.y,it.offset.y)),rt}const getContextWindow=({current:nt})=>nt?nt.ownerDocument.defaultView:null,elementDragControls=new WeakMap;class VisualElementDragControls{constructor(_e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=_e}start(_e,{snapToCursor:et=!1}={}){const{presenceContext:rt}=this.visualElement;if(rt&&rt.isPresent===!1)return;const it=ut=>{const{dragSnapToOrigin:ht}=this.getProps();ht?this.pauseAnimation():this.stopAnimation(),et&&this.snapToCursor(extractEventInfo(ut,"page").point)},st=(ut,ht)=>{const{drag:dt,dragPropagation:ft,onDragStart:pt}=this.getProps();if(dt&&!ft&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=getGlobalLock(dt),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(At=>{let gt=this.getAxisMotionValue(At).get()||0;if(percent.test(gt)){const{projection:bt}=this.visualElement;if(bt&&bt.layout){const Tt=bt.layout.layoutBox[At];Tt&&(gt=calcLength(Tt)*(parseFloat(gt)/100))}}this.originPoint[At]=gt}),pt&&frame.postRender(()=>pt(ut,ht)),addValueToWillChange(this.visualElement,"transform");const{animationState:mt}=this.visualElement;mt&&mt.setActive("whileDrag",!0)},ot=(ut,ht)=>{const{dragPropagation:dt,dragDirectionLock:ft,onDirectionLock:pt,onDrag:mt}=this.getProps();if(!dt&&!this.openGlobalLock)return;const{offset:At}=ht;if(ft&&this.currentDirection===null){this.currentDirection=getCurrentDirection(At),this.currentDirection!==null&&pt&&pt(this.currentDirection);return}this.updateAxis("x",ht.point,At),this.updateAxis("y",ht.point,At),this.visualElement.render(),mt&&mt(ut,ht)},at=(ut,ht)=>this.stop(ut,ht),lt=()=>eachAxis(ut=>{var ht;return this.getAnimationState(ut)==="paused"&&((ht=this.getAxisMotionValue(ut).animation)===null||ht===void 0?void 0:ht.play())}),{dragSnapToOrigin:ct}=this.getProps();this.panSession=new PanSession(_e,{onSessionStart:it,onStart:st,onMove:ot,onSessionEnd:at,resumeAnimation:lt},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:ct,contextWindow:getContextWindow(this.visualElement)})}stop(_e,et){const rt=this.isDragging;if(this.cancel(),!rt)return;const{velocity:it}=et;this.startAnimation(it);const{onDragEnd:st}=this.getProps();st&&frame.postRender(()=>st(_e,et))}cancel(){this.isDragging=!1;const{projection:_e,animationState:et}=this.visualElement;_e&&(_e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:rt}=this.getProps();!rt&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),et&&et.setActive("whileDrag",!1)}updateAxis(_e,et,rt){const{drag:it}=this.getProps();if(!rt||!shouldDrag(_e,it,this.currentDirection))return;const st=this.getAxisMotionValue(_e);let ot=this.originPoint[_e]+rt[_e];this.constraints&&this.constraints[_e]&&(ot=applyConstraints(ot,this.constraints[_e],this.elastic[_e])),st.set(ot)}resolveConstraints(){var _e;const{dragConstraints:et,dragElastic:rt}=this.getProps(),it=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(_e=this.visualElement.projection)===null||_e===void 0?void 0:_e.layout,st=this.constraints;et&&isRefObject(et)?this.constraints||(this.constraints=this.resolveRefConstraints()):et&&it?this.constraints=calcRelativeConstraints(it.layoutBox,et):this.constraints=!1,this.elastic=resolveDragElastic(rt),st!==this.constraints&&it&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(ot=>{this.constraints!==!1&&this.getAxisMotionValue(ot)&&(this.constraints[ot]=rebaseAxisConstraints(it.layoutBox[ot],this.constraints[ot]))})}resolveRefConstraints(){const{dragConstraints:_e,onMeasureDragConstraints:et}=this.getProps();if(!_e||!isRefObject(_e))return!1;const rt=_e.current,{projection:it}=this.visualElement;if(!it||!it.layout)return!1;const st=measurePageBox(rt,it.root,this.visualElement.getTransformPagePoint());let ot=calcViewportConstraints(it.layout.layoutBox,st);if(et){const at=et(convertBoxToBoundingBox(ot));this.hasMutatedConstraints=!!at,at&&(ot=convertBoundingBoxToBox(at))}return ot}startAnimation(_e){const{drag:et,dragMomentum:rt,dragElastic:it,dragTransition:st,dragSnapToOrigin:ot,onDragTransitionEnd:at}=this.getProps(),lt=this.constraints||{},ct=eachAxis(ut=>{if(!shouldDrag(ut,et,this.currentDirection))return;let ht=lt&&lt[ut]||{};ot&&(ht={min:0,max:0});const dt=it?200:1e6,ft=it?40:1e7,pt={type:"inertia",velocity:rt?_e[ut]:0,bounceStiffness:dt,bounceDamping:ft,timeConstant:750,restDelta:1,restSpeed:10,...st,...ht};return this.startAxisValueAnimation(ut,pt)});return Promise.all(ct).then(at)}startAxisValueAnimation(_e,et){const rt=this.getAxisMotionValue(_e);return addValueToWillChange(this.visualElement,_e),rt.start(animateMotionValue(_e,rt,0,et,this.visualElement,!1))}stopAnimation(){eachAxis(_e=>this.getAxisMotionValue(_e).stop())}pauseAnimation(){eachAxis(_e=>{var et;return(et=this.getAxisMotionValue(_e).animation)===null||et===void 0?void 0:et.pause()})}getAnimationState(_e){var et;return(et=this.getAxisMotionValue(_e).animation)===null||et===void 0?void 0:et.state}getAxisMotionValue(_e){const et=`_drag${_e.toUpperCase()}`,rt=this.visualElement.getProps(),it=rt[et];return it||this.visualElement.getValue(_e,(rt.initial?rt.initial[_e]:void 0)||0)}snapToCursor(_e){eachAxis(et=>{const{drag:rt}=this.getProps();if(!shouldDrag(et,rt,this.currentDirection))return;const{projection:it}=this.visualElement,st=this.getAxisMotionValue(et);if(it&&it.layout){const{min:ot,max:at}=it.layout.layoutBox[et];st.set(_e[et]-mixNumber$1(ot,at,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:_e,dragConstraints:et}=this.getProps(),{projection:rt}=this.visualElement;if(!isRefObject(et)||!rt||!this.constraints)return;this.stopAnimation();const it={x:0,y:0};eachAxis(ot=>{const at=this.getAxisMotionValue(ot);if(at&&this.constraints!==!1){const lt=at.get();it[ot]=calcOrigin$1({min:lt,max:lt},this.constraints[ot])}});const{transformTemplate:st}=this.visualElement.getProps();this.visualElement.current.style.transform=st?st({},""):"none",rt.root&&rt.root.updateScroll(),rt.updateLayout(),this.resolveConstraints(),eachAxis(ot=>{if(!shouldDrag(ot,_e,null))return;const at=this.getAxisMotionValue(ot),{min:lt,max:ct}=this.constraints[ot];at.set(mixNumber$1(lt,ct,it[ot]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const _e=this.visualElement.current,et=addPointerEvent(_e,"pointerdown",lt=>{const{drag:ct,dragListener:ut=!0}=this.getProps();ct&&ut&&this.start(lt)}),rt=()=>{const{dragConstraints:lt}=this.getProps();isRefObject(lt)&&lt.current&&(this.constraints=this.resolveRefConstraints())},{projection:it}=this.visualElement,st=it.addEventListener("measure",rt);it&&!it.layout&&(it.root&&it.root.updateScroll(),it.updateLayout()),frame.read(rt);const ot=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),at=it.addEventListener("didUpdate",({delta:lt,hasLayoutChanged:ct})=>{this.isDragging&&ct&&(eachAxis(ut=>{const ht=this.getAxisMotionValue(ut);ht&&(this.originPoint[ut]+=lt[ut].translate,ht.set(ht.get()+lt[ut].translate))}),this.visualElement.render())});return()=>{ot(),et(),st(),at&&at()}}getProps(){const _e=this.visualElement.getProps(),{drag:et=!1,dragDirectionLock:rt=!1,dragPropagation:it=!1,dragConstraints:st=!1,dragElastic:ot=defaultElastic,dragMomentum:at=!0}=_e;return{..._e,drag:et,dragDirectionLock:rt,dragPropagation:it,dragConstraints:st,dragElastic:ot,dragMomentum:at}}}function shouldDrag(nt,_e,et){return(_e===!0||_e===nt)&&(et===null||et===nt)}function getCurrentDirection(nt,_e=10){let et=null;return Math.abs(nt.y)>_e?et="y":Math.abs(nt.x)>_e&&(et="x"),et}class DragGesture extends Feature{constructor(_e){super(_e),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(_e)}mount(){const{dragControls:_e}=this.node.getProps();_e&&(this.removeGroupControls=_e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=nt=>(_e,et)=>{nt&&frame.postRender(()=>nt(_e,et))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(_e){this.session=new PanSession(_e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:_e,onPanStart:et,onPan:rt,onPanEnd:it}=this.node.getProps();return{onSessionStart:asyncHandler(_e),onStart:asyncHandler(et),onMove:rt,onEnd:(st,ot)=>{delete this.session,it&&frame.postRender(()=>it(st,ot))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",_e=>this.onPointerDown(_e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const PresenceContext=reactExports.createContext(null);function usePresence(){const nt=reactExports.useContext(PresenceContext);if(nt===null)return[!0,null];const{isPresent:_e,onExitComplete:et,register:rt}=nt,it=reactExports.useId();reactExports.useEffect(()=>rt(it),[]);const st=reactExports.useCallback(()=>et&&et(it),[it,et]);return!_e&&et?[!1,st]:[!0]}const LayoutGroupContext=reactExports.createContext({}),SwitchLayoutGroupContext=reactExports.createContext({}),globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(nt,_e){return _e.max===_e.min?0:nt/(_e.max-_e.min)*100}const correctBorderRadius={correct:(nt,_e)=>{if(!_e.target)return nt;if(typeof nt=="string")if(px.test(nt))nt=parseFloat(nt);else return nt;const et=pixelsToPercent(nt,_e.target.x),rt=pixelsToPercent(nt,_e.target.y);return`${et}% ${rt}%`}},correctBoxShadow={correct:(nt,{treeScale:_e,projectionDelta:et})=>{const rt=nt,it=complex.parse(nt);if(it.length>5)return rt;const st=complex.createTransformer(nt),ot=typeof it[0]!="number"?1:0,at=et.x.scale*_e.x,lt=et.y.scale*_e.y;it[0+ot]/=at,it[1+ot]/=lt;const ct=mixNumber$1(at,lt,.5);return typeof it[2+ot]=="number"&&(it[2+ot]/=ct),typeof it[3+ot]=="number"&&(it[3+ot]/=ct),st(it)}},scaleCorrectors={};function addScaleCorrector(nt){Object.assign(scaleCorrectors,nt)}const{schedule:microtask,cancel:cancelMicrotask}=createRenderBatcher(queueMicrotask,!1);class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:_e,layoutGroup:et,switchLayoutGroup:rt,layoutId:it}=this.props,{projection:st}=_e;addScaleCorrector(defaultScaleCorrectors),st&&(et.group&&et.group.add(st),rt&&rt.register&&it&&rt.register(st),st.root.didUpdate(),st.addEventListener("animationComplete",()=>{this.safeToRemove()}),st.setOptions({...st.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(_e){const{layoutDependency:et,visualElement:rt,drag:it,isPresent:st}=this.props,ot=rt.projection;return ot&&(ot.isPresent=st,it||_e.layoutDependency!==et||et===void 0?ot.willUpdate():this.safeToRemove(),_e.isPresent!==st&&(st?ot.promote():ot.relegate()||frame.postRender(()=>{const at=ot.getStack();(!at||!at.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:_e}=this.props.visualElement;_e&&(_e.root.didUpdate(),microtask.postRender(()=>{!_e.currentAnimation&&_e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:_e,layoutGroup:et,switchLayoutGroup:rt}=this.props,{projection:it}=_e;it&&(it.scheduleCheckAfterUnmount(),et&&et.group&&et.group.remove(it),rt&&rt.deregister&&rt.deregister(it))}safeToRemove(){const{safeToRemove:_e}=this.props;_e&&_e()}render(){return null}}function MeasureLayout(nt){const[_e,et]=usePresence(),rt=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...nt,layoutGroup:rt,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:_e,safeToRemove:et})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow},borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=nt=>typeof nt=="string"?parseFloat(nt):nt,isPx=nt=>typeof nt=="number"||px.test(nt);function mixValues(nt,_e,et,rt,it,st){it?(nt.opacity=mixNumber$1(0,et.opacity!==void 0?et.opacity:1,easeCrossfadeIn(rt)),nt.opacityExit=mixNumber$1(_e.opacity!==void 0?_e.opacity:1,0,easeCrossfadeOut(rt))):st&&(nt.opacity=mixNumber$1(_e.opacity!==void 0?_e.opacity:1,et.opacity!==void 0?et.opacity:1,rt));for(let ot=0;ot<numBorders;ot++){const at=`border${borders[ot]}Radius`;let lt=getRadius(_e,at),ct=getRadius(et,at);if(lt===void 0&&ct===void 0)continue;lt||(lt=0),ct||(ct=0),lt===0||ct===0||isPx(lt)===isPx(ct)?(nt[at]=Math.max(mixNumber$1(asNumber(lt),asNumber(ct),rt),0),(percent.test(ct)||percent.test(lt))&&(nt[at]+="%")):nt[at]=ct}(_e.rotate||et.rotate)&&(nt.rotate=mixNumber$1(_e.rotate||0,et.rotate||0,rt))}function getRadius(nt,_e){return nt[_e]!==void 0?nt[_e]:nt.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(nt,_e,et){return rt=>rt<nt?0:rt>_e?1:et(progress(nt,_e,rt))}function copyAxisInto(nt,_e){nt.min=_e.min,nt.max=_e.max}function copyBoxInto(nt,_e){copyAxisInto(nt.x,_e.x),copyAxisInto(nt.y,_e.y)}function copyAxisDeltaInto(nt,_e){nt.translate=_e.translate,nt.scale=_e.scale,nt.originPoint=_e.originPoint,nt.origin=_e.origin}function removePointDelta(nt,_e,et,rt,it){return nt-=_e,nt=scalePoint(nt,1/et,rt),it!==void 0&&(nt=scalePoint(nt,1/it,rt)),nt}function removeAxisDelta(nt,_e=0,et=1,rt=.5,it,st=nt,ot=nt){if(percent.test(_e)&&(_e=parseFloat(_e),_e=mixNumber$1(ot.min,ot.max,_e/100)-ot.min),typeof _e!="number")return;let at=mixNumber$1(st.min,st.max,rt);nt===st&&(at-=_e),nt.min=removePointDelta(nt.min,_e,et,at,it),nt.max=removePointDelta(nt.max,_e,et,at,it)}function removeAxisTransforms(nt,_e,[et,rt,it],st,ot){removeAxisDelta(nt,_e[et],_e[rt],_e[it],_e.scale,st,ot)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(nt,_e,et,rt){removeAxisTransforms(nt.x,_e,xKeys,et?et.x:void 0,rt?rt.x:void 0),removeAxisTransforms(nt.y,_e,yKeys,et?et.y:void 0,rt?rt.y:void 0)}function isAxisDeltaZero(nt){return nt.translate===0&&nt.scale===1}function isDeltaZero(nt){return isAxisDeltaZero(nt.x)&&isAxisDeltaZero(nt.y)}function axisEquals(nt,_e){return nt.min===_e.min&&nt.max===_e.max}function boxEquals(nt,_e){return axisEquals(nt.x,_e.x)&&axisEquals(nt.y,_e.y)}function axisEqualsRounded(nt,_e){return Math.round(nt.min)===Math.round(_e.min)&&Math.round(nt.max)===Math.round(_e.max)}function boxEqualsRounded(nt,_e){return axisEqualsRounded(nt.x,_e.x)&&axisEqualsRounded(nt.y,_e.y)}function aspectRatio(nt){return calcLength(nt.x)/calcLength(nt.y)}function axisDeltaEquals(nt,_e){return nt.translate===_e.translate&&nt.scale===_e.scale&&nt.originPoint===_e.originPoint}class NodeStack{constructor(){this.members=[]}add(_e){addUniqueItem(this.members,_e),_e.scheduleRender()}remove(_e){if(removeItem(this.members,_e),_e===this.prevLead&&(this.prevLead=void 0),_e===this.lead){const et=this.members[this.members.length-1];et&&this.promote(et)}}relegate(_e){const et=this.members.findIndex(it=>_e===it);if(et===0)return!1;let rt;for(let it=et;it>=0;it--){const st=this.members[it];if(st.isPresent!==!1){rt=st;break}}return rt?(this.promote(rt),!0):!1}promote(_e,et){const rt=this.lead;if(_e!==rt&&(this.prevLead=rt,this.lead=_e,_e.show(),rt)){rt.instance&&rt.scheduleRender(),_e.scheduleRender(),_e.resumeFrom=rt,et&&(_e.resumeFrom.preserveOpacity=!0),rt.snapshot&&(_e.snapshot=rt.snapshot,_e.snapshot.latestValues=rt.animationValues||rt.latestValues),_e.root&&_e.root.isUpdating&&(_e.isLayoutDirty=!0);const{crossfade:it}=_e.options;it===!1&&rt.hide()}}exitAnimationComplete(){this.members.forEach(_e=>{const{options:et,resumingFrom:rt}=_e;et.onExitComplete&&et.onExitComplete(),rt&&rt.options.onExitComplete&&rt.options.onExitComplete()})}scheduleRender(){this.members.forEach(_e=>{_e.instance&&_e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(nt,_e,et){let rt="";const it=nt.x.translate/_e.x,st=nt.y.translate/_e.y,ot=(et==null?void 0:et.z)||0;if((it||st||ot)&&(rt=`translate3d(${it}px, ${st}px, ${ot}px) `),(_e.x!==1||_e.y!==1)&&(rt+=`scale(${1/_e.x}, ${1/_e.y}) `),et){const{transformPerspective:ct,rotate:ut,rotateX:ht,rotateY:dt,skewX:ft,skewY:pt}=et;ct&&(rt=`perspective(${ct}px) ${rt}`),ut&&(rt+=`rotate(${ut}deg) `),ht&&(rt+=`rotateX(${ht}deg) `),dt&&(rt+=`rotateY(${dt}deg) `),ft&&(rt+=`skewX(${ft}deg) `),pt&&(rt+=`skewY(${pt}deg) `)}const at=nt.x.scale*_e.x,lt=nt.y.scale*_e.y;return(at!==1||lt!==1)&&(rt+=`scale(${at}, ${lt})`),rt||"none"}const compareByDepth=(nt,_e)=>nt.depth-_e.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(_e){addUniqueItem(this.children,_e),this.isDirty=!0}remove(_e){removeItem(this.children,_e),this.isDirty=!0}forEach(_e){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(_e)}}function resolveMotionValue(nt){const _e=isMotionValue(nt)?nt.get():nt;return isCustomValue(_e)?_e.toValue():_e}function delay(nt,_e){const et=time.now(),rt=({timestamp:it})=>{const st=it-et;st>=_e&&(cancelFrame(rt),nt(st-_e))};return frame.read(rt,!0),()=>cancelFrame(rt)}function isSVGElement(nt){return nt instanceof SVGElement&&nt.tagName!=="svg"}function animateSingleValue(nt,_e,et){const rt=isMotionValue(nt)?nt:motionValue(nt);return rt.start(animateMotionValue("",rt,_e,et)),rt.animation}const metrics={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},isDebug=typeof window<"u"&&window.MotionDebug!==void 0,transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id=0;function resetDistortingTransform(nt,_e,et,rt){const{latestValues:it}=_e;it[nt]&&(et[nt]=it[nt],_e.setStaticValue(nt,0),rt&&(rt[nt]=0))}function cancelTreeOptimisedTransformAnimations(nt){if(nt.hasCheckedOptimisedAppear=!0,nt.root===nt)return;const{visualElement:_e}=nt.options;if(!_e)return;const et=getOptimisedAppearId(_e);if(window.MotionHasOptimisedAnimation(et,"transform")){const{layout:it,layoutId:st}=nt.options;window.MotionCancelOptimisedAnimation(et,"transform",frame,!(it||st))}const{parent:rt}=nt;rt&&!rt.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(rt)}function createProjectionNode$1({attachResizeListener:nt,defaultParent:_e,measureScroll:et,checkIsScrollRoot:rt,resetTransform:it}){return class{constructor(ot={},at=_e==null?void 0:_e()){this.id=id++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,isDebug&&(metrics.totalNodes=metrics.resolvedTargetDeltas=metrics.recalculatedProjection=0),this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),isDebug&&window.MotionDebug.record(metrics)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=ot,this.root=at?at.root||at:this,this.path=at?[...at.path,at]:[],this.parent=at,this.depth=at?at.depth+1:0;for(let lt=0;lt<this.path.length;lt++)this.path[lt].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(ot,at){return this.eventHandlers.has(ot)||this.eventHandlers.set(ot,new SubscriptionManager),this.eventHandlers.get(ot).add(at)}notifyListeners(ot,...at){const lt=this.eventHandlers.get(ot);lt&&lt.notify(...at)}hasListeners(ot){return this.eventHandlers.has(ot)}mount(ot,at=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=isSVGElement(ot),this.instance=ot;const{layoutId:lt,layout:ct,visualElement:ut}=this.options;if(ut&&!ut.current&&ut.mount(ot),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),at&&(ct||lt)&&(this.isLayoutDirty=!0),nt){let ht;const dt=()=>this.root.updateBlockedByResize=!1;nt(ot,()=>{this.root.updateBlockedByResize=!0,ht&&ht(),ht=delay(dt,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}lt&&this.root.registerSharedNode(lt,this),this.options.animate!==!1&&ut&&(lt||ct)&&this.addEventListener("didUpdate",({delta:ht,hasLayoutChanged:dt,hasRelativeTargetChanged:ft,layout:pt})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const mt=this.options.transition||ut.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:At,onLayoutAnimationComplete:gt}=ut.getProps(),bt=!this.targetLayout||!boxEqualsRounded(this.targetLayout,pt)||ft,Tt=!dt&&ft;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||Tt||dt&&(bt||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(ht,Tt);const wt={...getValueTransition(mt,"layout"),onPlay:At,onComplete:gt};(ut.shouldReduceMotion||this.options.layoutRoot)&&(wt.delay=0,wt.type=!1),this.startAnimation(wt)}else dt||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=pt})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const ot=this.getStack();ot&&ot.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:ot}=this.options;return ot&&ot.getProps().transformTemplate}willUpdate(ot=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let ut=0;ut<this.path.length;ut++){const ht=this.path[ut];ht.shouldResetTransform=!0,ht.updateScroll("snapshot"),ht.options.layoutRoot&&ht.willUpdate(!1)}const{layoutId:at,layout:lt}=this.options;if(at===void 0&&!lt)return;const ct=this.getTransformTemplate();this.prevTransformTemplateValue=ct?ct(this.latestValues,""):void 0,this.updateSnapshot(),ot&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const at=time.now();frameData.delta=clamp(0,1e3/60,at-frameData.timestamp),frameData.timestamp=at,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let lt=0;lt<this.path.length;lt++)this.path[lt].updateScroll();const ot=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:at}=this.options;at&&at.notify("LayoutMeasure",this.layout.layoutBox,ot?ot.layoutBox:void 0)}updateScroll(ot="measure"){let at=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===ot&&(at=!1),at){const lt=rt(this.instance);this.scroll={animationId:this.root.animationId,phase:ot,isRoot:lt,offset:et(this.instance),wasRoot:this.scroll?this.scroll.isRoot:lt}}}resetTransform(){if(!it)return;const ot=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,at=this.projectionDelta&&!isDeltaZero(this.projectionDelta),lt=this.getTransformTemplate(),ct=lt?lt(this.latestValues,""):void 0,ut=ct!==this.prevTransformTemplateValue;ot&&(at||hasTransform(this.latestValues)||ut)&&(it(this.instance,ct),this.shouldResetTransform=!1,this.scheduleRender())}measure(ot=!0){const at=this.measurePageBox();let lt=this.removeElementScroll(at);return ot&&(lt=this.removeTransform(lt)),roundBox(lt),{animationId:this.root.animationId,measuredBox:at,layoutBox:lt,latestValues:{},source:this.id}}measurePageBox(){var ot;const{visualElement:at}=this.options;if(!at)return createBox();const lt=at.measureViewportBox();if(!(((ot=this.scroll)===null||ot===void 0?void 0:ot.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:ut}=this.root;ut&&(translateAxis(lt.x,ut.offset.x),translateAxis(lt.y,ut.offset.y))}return lt}removeElementScroll(ot){var at;const lt=createBox();if(copyBoxInto(lt,ot),!((at=this.scroll)===null||at===void 0)&&at.wasRoot)return lt;for(let ct=0;ct<this.path.length;ct++){const ut=this.path[ct],{scroll:ht,options:dt}=ut;ut!==this.root&&ht&&dt.layoutScroll&&(ht.wasRoot&&copyBoxInto(lt,ot),translateAxis(lt.x,ht.offset.x),translateAxis(lt.y,ht.offset.y))}return lt}applyTransform(ot,at=!1){const lt=createBox();copyBoxInto(lt,ot);for(let ct=0;ct<this.path.length;ct++){const ut=this.path[ct];!at&&ut.options.layoutScroll&&ut.scroll&&ut!==ut.root&&transformBox(lt,{x:-ut.scroll.offset.x,y:-ut.scroll.offset.y}),hasTransform(ut.latestValues)&&transformBox(lt,ut.latestValues)}return hasTransform(this.latestValues)&&transformBox(lt,this.latestValues),lt}removeTransform(ot){const at=createBox();copyBoxInto(at,ot);for(let lt=0;lt<this.path.length;lt++){const ct=this.path[lt];if(!ct.instance||!hasTransform(ct.latestValues))continue;hasScale(ct.latestValues)&&ct.updateSnapshot();const ut=createBox(),ht=ct.measurePageBox();copyBoxInto(ut,ht),removeBoxTransforms(at,ct.latestValues,ct.snapshot?ct.snapshot.layoutBox:void 0,ut)}return hasTransform(this.latestValues)&&removeBoxTransforms(at,this.latestValues),at}setTargetDelta(ot){this.targetDelta=ot,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(ot){this.options={...this.options,...ot,crossfade:ot.crossfade!==void 0?ot.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(ot=!1){var at;const lt=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=lt.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=lt.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=lt.isSharedProjectionDirty);const ct=!!this.resumingFrom||this!==lt;if(!(ot||ct&&this.isSharedProjectionDirty||this.isProjectionDirty||!((at=this.parent)===null||at===void 0)&&at.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:ht,layoutId:dt}=this.options;if(!(!this.layout||!(ht||dt))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const ft=this.getClosestProjectingParent();ft&&ft.layout&&this.animationProgress!==1?(this.relativeParent=ft,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,ft.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const ft=this.getClosestProjectingParent();ft&&!!ft.resumingFrom==!!this.resumingFrom&&!ft.options.layoutScroll&&ft.target&&this.animationProgress!==1?(this.relativeParent=ft,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,ft.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}isDebug&&metrics.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var ot;const at=this.getLead(),lt=!!this.resumingFrom||this!==at;let ct=!0;if((this.isProjectionDirty||!((ot=this.parent)===null||ot===void 0)&&ot.isProjectionDirty)&&(ct=!1),lt&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(ct=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(ct=!1),ct)return;const{layout:ut,layoutId:ht}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(ut||ht))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const dt=this.treeScale.x,ft=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,lt),at.layout&&!at.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(at.target=at.layout.layoutBox,at.targetWithTransforms=createBox());const{target:pt}=at;if(!pt){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,pt,this.latestValues),(this.treeScale.x!==dt||this.treeScale.y!==ft||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",pt)),isDebug&&metrics.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(ot=!0){var at;if((at=this.options.visualElement)===null||at===void 0||at.scheduleRender(),ot){const lt=this.getStack();lt&&lt.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(ot,at=!1){const lt=this.snapshot,ct=lt?lt.latestValues:{},ut={...this.latestValues},ht=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!at;const dt=createBox(),ft=lt?lt.source:void 0,pt=this.layout?this.layout.source:void 0,mt=ft!==pt,At=this.getStack(),gt=!At||At.members.length<=1,bt=!!(mt&&!gt&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let Tt;this.mixTargetDelta=wt=>{const Rt=wt/1e3;mixAxisDelta(ht.x,ot.x,Rt),mixAxisDelta(ht.y,ot.y,Rt),this.setTargetDelta(ht),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(dt,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,dt,Rt),Tt&&boxEquals(this.relativeTarget,Tt)&&(this.isProjectionDirty=!1),Tt||(Tt=createBox()),copyBoxInto(Tt,this.relativeTarget)),mt&&(this.animationValues=ut,mixValues(ut,ct,this.latestValues,Rt,bt,gt)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Rt},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(ot){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.currentAnimation=animateSingleValue(0,animationTarget,{...ot,onUpdate:at=>{this.mixTargetDelta(at),ot.onUpdate&&ot.onUpdate(at)},onComplete:()=>{ot.onComplete&&ot.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const ot=this.getStack();ot&&ot.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const ot=this.getLead();let{targetWithTransforms:at,target:lt,layout:ct,latestValues:ut}=ot;if(!(!at||!lt||!ct)){if(this!==ot&&this.layout&&ct&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,ct.layoutBox)){lt=this.target||createBox();const ht=calcLength(this.layout.layoutBox.x);lt.x.min=ot.target.x.min,lt.x.max=lt.x.min+ht;const dt=calcLength(this.layout.layoutBox.y);lt.y.min=ot.target.y.min,lt.y.max=lt.y.min+dt}copyBoxInto(at,lt),transformBox(at,ut),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,at,ut)}}registerSharedNode(ot,at){this.sharedNodes.has(ot)||this.sharedNodes.set(ot,new NodeStack),this.sharedNodes.get(ot).add(at);const ct=at.options.initialPromotionConfig;at.promote({transition:ct?ct.transition:void 0,preserveFollowOpacity:ct&&ct.shouldPreserveFollowOpacity?ct.shouldPreserveFollowOpacity(at):void 0})}isLead(){const ot=this.getStack();return ot?ot.lead===this:!0}getLead(){var ot;const{layoutId:at}=this.options;return at?((ot=this.getStack())===null||ot===void 0?void 0:ot.lead)||this:this}getPrevLead(){var ot;const{layoutId:at}=this.options;return at?(ot=this.getStack())===null||ot===void 0?void 0:ot.prevLead:void 0}getStack(){const{layoutId:ot}=this.options;if(ot)return this.root.sharedNodes.get(ot)}promote({needsReset:ot,transition:at,preserveFollowOpacity:lt}={}){const ct=this.getStack();ct&&ct.promote(this,lt),ot&&(this.projectionDelta=void 0,this.needsReset=!0),at&&this.setOptions({transition:at})}relegate(){const ot=this.getStack();return ot?ot.relegate(this):!1}resetSkewAndRotation(){const{visualElement:ot}=this.options;if(!ot)return;let at=!1;const{latestValues:lt}=ot;if((lt.z||lt.rotate||lt.rotateX||lt.rotateY||lt.rotateZ||lt.skewX||lt.skewY)&&(at=!0),!at)return;const ct={};lt.z&&resetDistortingTransform("z",ot,ct,this.animationValues);for(let ut=0;ut<transformAxes.length;ut++)resetDistortingTransform(`rotate${transformAxes[ut]}`,ot,ct,this.animationValues),resetDistortingTransform(`skew${transformAxes[ut]}`,ot,ct,this.animationValues);ot.render();for(const ut in ct)ot.setStaticValue(ut,ct[ut]),this.animationValues&&(this.animationValues[ut]=ct[ut]);ot.scheduleRender()}getProjectionStyles(ot){var at,lt;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const ct={visibility:""},ut=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,ct.opacity="",ct.pointerEvents=resolveMotionValue(ot==null?void 0:ot.pointerEvents)||"",ct.transform=ut?ut(this.latestValues,""):"none",ct;const ht=this.getLead();if(!this.projectionDelta||!this.layout||!ht.target){const mt={};return this.options.layoutId&&(mt.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,mt.pointerEvents=resolveMotionValue(ot==null?void 0:ot.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(mt.transform=ut?ut({},""):"none",this.hasProjected=!1),mt}const dt=ht.animationValues||ht.latestValues;this.applyTransformsToTarget(),ct.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,dt),ut&&(ct.transform=ut(dt,ct.transform));const{x:ft,y:pt}=this.projectionDelta;ct.transformOrigin=`${ft.origin*100}% ${pt.origin*100}% 0`,ht.animationValues?ct.opacity=ht===this?(lt=(at=dt.opacity)!==null&&at!==void 0?at:this.latestValues.opacity)!==null&&lt!==void 0?lt:1:this.preserveOpacity?this.latestValues.opacity:dt.opacityExit:ct.opacity=ht===this?dt.opacity!==void 0?dt.opacity:"":dt.opacityExit!==void 0?dt.opacityExit:0;for(const mt in scaleCorrectors){if(dt[mt]===void 0)continue;const{correct:At,applyTo:gt}=scaleCorrectors[mt],bt=ct.transform==="none"?dt[mt]:At(dt[mt],ht);if(gt){const Tt=gt.length;for(let wt=0;wt<Tt;wt++)ct[gt[wt]]=bt}else ct[mt]=bt}return this.options.layoutId&&(ct.pointerEvents=ht===this?resolveMotionValue(ot==null?void 0:ot.pointerEvents)||"":"none"),ct}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(ot=>{var at;return(at=ot.currentAnimation)===null||at===void 0?void 0:at.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(nt){nt.updateLayout()}function notifyLayoutUpdate(nt){var _e;const et=((_e=nt.resumeFrom)===null||_e===void 0?void 0:_e.snapshot)||nt.snapshot;if(nt.isLead()&&nt.layout&&et&&nt.hasListeners("didUpdate")){const{layoutBox:rt,measuredBox:it}=nt.layout,{animationType:st}=nt.options,ot=et.source!==nt.layout.source;st==="size"?eachAxis(ht=>{const dt=ot?et.measuredBox[ht]:et.layoutBox[ht],ft=calcLength(dt);dt.min=rt[ht].min,dt.max=dt.min+ft}):shouldAnimatePositionOnly(st,et.layoutBox,rt)&&eachAxis(ht=>{const dt=ot?et.measuredBox[ht]:et.layoutBox[ht],ft=calcLength(rt[ht]);dt.max=dt.min+ft,nt.relativeTarget&&!nt.currentAnimation&&(nt.isProjectionDirty=!0,nt.relativeTarget[ht].max=nt.relativeTarget[ht].min+ft)});const at=createDelta();calcBoxDelta(at,rt,et.layoutBox);const lt=createDelta();ot?calcBoxDelta(lt,nt.applyTransform(it,!0),et.measuredBox):calcBoxDelta(lt,rt,et.layoutBox);const ct=!isDeltaZero(at);let ut=!1;if(!nt.resumeFrom){const ht=nt.getClosestProjectingParent();if(ht&&!ht.resumeFrom){const{snapshot:dt,layout:ft}=ht;if(dt&&ft){const pt=createBox();calcRelativePosition(pt,et.layoutBox,dt.layoutBox);const mt=createBox();calcRelativePosition(mt,rt,ft.layoutBox),boxEqualsRounded(pt,mt)||(ut=!0),ht.options.layoutRoot&&(nt.relativeTarget=mt,nt.relativeTargetOrigin=pt,nt.relativeParent=ht)}}}nt.notifyListeners("didUpdate",{layout:rt,snapshot:et,delta:lt,layoutDelta:at,hasLayoutChanged:ct,hasRelativeTargetChanged:ut})}else if(nt.isLead()){const{onExitComplete:rt}=nt.options;rt&&rt()}nt.options.transition=void 0}function propagateDirtyNodes(nt){isDebug&&metrics.totalNodes++,nt.parent&&(nt.isProjecting()||(nt.isProjectionDirty=nt.parent.isProjectionDirty),nt.isSharedProjectionDirty||(nt.isSharedProjectionDirty=!!(nt.isProjectionDirty||nt.parent.isProjectionDirty||nt.parent.isSharedProjectionDirty)),nt.isTransformDirty||(nt.isTransformDirty=nt.parent.isTransformDirty))}function cleanDirtyNodes(nt){nt.isProjectionDirty=nt.isSharedProjectionDirty=nt.isTransformDirty=!1}function clearSnapshot(nt){nt.clearSnapshot()}function clearMeasurements(nt){nt.clearMeasurements()}function clearIsLayoutDirty(nt){nt.isLayoutDirty=!1}function resetTransformStyle(nt){const{visualElement:_e}=nt.options;_e&&_e.getProps().onBeforeLayoutMeasure&&_e.notify("BeforeLayoutMeasure"),nt.resetTransform()}function finishAnimation(nt){nt.finishAnimation(),nt.targetDelta=nt.relativeTarget=nt.target=void 0,nt.isProjectionDirty=!0}function resolveTargetDelta(nt){nt.resolveTargetDelta()}function calcProjection(nt){nt.calcProjection()}function resetSkewAndRotation(nt){nt.resetSkewAndRotation()}function removeLeadSnapshots(nt){nt.removeLeadSnapshot()}function mixAxisDelta(nt,_e,et){nt.translate=mixNumber$1(_e.translate,0,et),nt.scale=mixNumber$1(_e.scale,1,et),nt.origin=_e.origin,nt.originPoint=_e.originPoint}function mixAxis(nt,_e,et,rt){nt.min=mixNumber$1(_e.min,et.min,rt),nt.max=mixNumber$1(_e.max,et.max,rt)}function mixBox(nt,_e,et,rt){mixAxis(nt.x,_e.x,et.x,rt),mixAxis(nt.y,_e.y,et.y,rt)}function hasOpacityCrossfade(nt){return nt.animationValues&&nt.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=nt=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(nt),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(nt){nt.min=roundPoint(nt.min),nt.max=roundPoint(nt.max)}function roundBox(nt){roundAxis(nt.x),roundAxis(nt.y)}function shouldAnimatePositionOnly(nt,_e,et){return nt==="position"||nt==="preserve-aspect"&&!isNear(aspectRatio(_e),aspectRatio(et),.2)}function checkNodeWasScrollRoot(nt){var _e;return nt!==nt.root&&((_e=nt.scroll)===null||_e===void 0?void 0:_e.wasRoot)}const DocumentProjectionNode=createProjectionNode$1({attachResizeListener:(nt,_e)=>addDomEvent(nt,"resize",_e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode$1({measureScroll:nt=>({x:nt.scrollLeft,y:nt.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const nt=new DocumentProjectionNode({});nt.mount(window),nt.setOptions({layoutScroll:!0}),rootProjectionNode.current=nt}return rootProjectionNode.current},resetTransform:(nt,_e)=>{nt.style.transform=_e!==void 0?_e:"none"},checkIsScrollRoot:nt=>window.getComputedStyle(nt).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function addHoverEvent(nt,_e){const et=_e?"pointerenter":"pointerleave",rt=_e?"onHoverStart":"onHoverEnd",it=(st,ot)=>{if(st.pointerType==="touch"||isDragActive())return;const at=nt.getProps();nt.animationState&&at.whileHover&&nt.animationState.setActive("whileHover",_e);const lt=at[rt];lt&&frame.postRender(()=>lt(st,ot))};return addPointerEvent(nt.current,et,it,{passive:!nt.getProps()[rt]})}class HoverGesture extends Feature{mount(){this.unmount=pipe(addHoverEvent(this.node,!0),addHoverEvent(this.node,!1))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let _e=!1;try{_e=this.node.current.matches(":focus-visible")}catch{_e=!0}!_e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const isNodeOrChild=(nt,_e)=>_e?nt===_e?!0:isNodeOrChild(nt,_e.parentElement):!1;function fireSyntheticPointerEvent(nt,_e){if(!_e)return;const et=new PointerEvent("pointer"+nt);_e(et,extractEventInfo(et))}class PressGesture extends Feature{constructor(){super(...arguments),this.removeStartListeners=noop,this.removeEndListeners=noop,this.removeAccessibleListeners=noop,this.startPointerPress=(_e,et)=>{if(this.isPressing)return;this.removeEndListeners();const rt=this.node.getProps(),st=addPointerEvent(window,"pointerup",(at,lt)=>{if(!this.checkPressEnd())return;const{onTap:ct,onTapCancel:ut,globalTapTarget:ht}=this.node.getProps(),dt=!ht&&!isNodeOrChild(this.node.current,at.target)?ut:ct;dt&&frame.update(()=>dt(at,lt))},{passive:!(rt.onTap||rt.onPointerUp)}),ot=addPointerEvent(window,"pointercancel",(at,lt)=>this.cancelPress(at,lt),{passive:!(rt.onTapCancel||rt.onPointerCancel)});this.removeEndListeners=pipe(st,ot),this.startPress(_e,et)},this.startAccessiblePress=()=>{const _e=st=>{if(st.key!=="Enter"||this.isPressing)return;const ot=at=>{at.key!=="Enter"||!this.checkPressEnd()||fireSyntheticPointerEvent("up",(lt,ct)=>{const{onTap:ut}=this.node.getProps();ut&&frame.postRender(()=>ut(lt,ct))})};this.removeEndListeners(),this.removeEndListeners=addDomEvent(this.node.current,"keyup",ot),fireSyntheticPointerEvent("down",(at,lt)=>{this.startPress(at,lt)})},et=addDomEvent(this.node.current,"keydown",_e),rt=()=>{this.isPressing&&fireSyntheticPointerEvent("cancel",(st,ot)=>this.cancelPress(st,ot))},it=addDomEvent(this.node.current,"blur",rt);this.removeAccessibleListeners=pipe(et,it)}}startPress(_e,et){this.isPressing=!0;const{onTapStart:rt,whileTap:it}=this.node.getProps();it&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),rt&&frame.postRender(()=>rt(_e,et))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!isDragActive()}cancelPress(_e,et){if(!this.checkPressEnd())return;const{onTapCancel:rt}=this.node.getProps();rt&&frame.postRender(()=>rt(_e,et))}mount(){const _e=this.node.getProps(),et=addPointerEvent(_e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(_e.onTapStart||_e.onPointerStart)}),rt=addDomEvent(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pipe(et,rt)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=nt=>{const _e=observerCallbacks.get(nt.target);_e&&_e(nt)},fireAllObserverCallbacks=nt=>{nt.forEach(fireObserverCallback)};function initIntersectionObserver({root:nt,..._e}){const et=nt||document;observers.has(et)||observers.set(et,{});const rt=observers.get(et),it=JSON.stringify(_e);return rt[it]||(rt[it]=new IntersectionObserver(fireAllObserverCallbacks,{root:nt,..._e})),rt[it]}function observeIntersection(nt,_e,et){const rt=initIntersectionObserver(_e);return observerCallbacks.set(nt,et),rt.observe(nt),()=>{observerCallbacks.delete(nt),rt.unobserve(nt)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:_e={}}=this.node.getProps(),{root:et,margin:rt,amount:it="some",once:st}=_e,ot={root:et?et.current:void 0,rootMargin:rt,threshold:typeof it=="number"?it:thresholdNames[it]},at=lt=>{const{isIntersecting:ct}=lt;if(this.isInView===ct||(this.isInView=ct,st&&!ct&&this.hasEnteredView))return;ct&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",ct);const{onViewportEnter:ut,onViewportLeave:ht}=this.node.getProps(),dt=ct?ut:ht;dt&&dt(lt)};return observeIntersection(this.node.current,ot,at)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:_e,prevProps:et}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(_e,et))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:nt={}},{viewport:_e={}}={}){return et=>nt[et]!==_e[et]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},MotionConfigContext=reactExports.createContext({transformPagePoint:nt=>nt,isStatic:!1,reducedMotion:"never"}),MotionContext=reactExports.createContext({}),isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,LazyContext=reactExports.createContext({strict:!1});function useVisualElement(nt,_e,et,rt,it){var st,ot;const{visualElement:at}=reactExports.useContext(MotionContext),lt=reactExports.useContext(LazyContext),ct=reactExports.useContext(PresenceContext),ut=reactExports.useContext(MotionConfigContext).reducedMotion,ht=reactExports.useRef();rt=rt||lt.renderer,!ht.current&&rt&&(ht.current=rt(nt,{visualState:_e,parent:at,props:et,presenceContext:ct,blockInitialAnimation:ct?ct.initial===!1:!1,reducedMotionConfig:ut}));const dt=ht.current,ft=reactExports.useContext(SwitchLayoutGroupContext);dt&&!dt.projection&&it&&(dt.type==="html"||dt.type==="svg")&&createProjectionNode(ht.current,et,it,ft);const pt=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{dt&&pt.current&&dt.update(et,ct)});const mt=et[optimizedAppearDataAttribute],At=reactExports.useRef(!!mt&&!(!((st=window.MotionHandoffIsComplete)===null||st===void 0)&&st.call(window,mt))&&((ot=window.MotionHasOptimisedAnimation)===null||ot===void 0?void 0:ot.call(window,mt)));return useIsomorphicLayoutEffect(()=>{dt&&(pt.current=!0,window.MotionIsMounted=!0,dt.updateFeatures(),microtask.render(dt.render),At.current&&dt.animationState&&dt.animationState.animateChanges())}),reactExports.useEffect(()=>{dt&&(!At.current&&dt.animationState&&dt.animationState.animateChanges(),At.current&&(queueMicrotask(()=>{var gt;(gt=window.MotionHandoffMarkAsComplete)===null||gt===void 0||gt.call(window,mt)}),At.current=!1))}),dt}function createProjectionNode(nt,_e,et,rt){const{layoutId:it,layout:st,drag:ot,dragConstraints:at,layoutScroll:lt,layoutRoot:ct}=_e;nt.projection=new et(nt.latestValues,_e["data-framer-portal-id"]?void 0:getClosestProjectingNode(nt.parent)),nt.projection.setOptions({layoutId:it,layout:st,alwaysMeasureLayout:!!ot||at&&isRefObject(at),visualElement:nt,animationType:typeof st=="string"?st:"both",initialPromotionConfig:rt,layoutScroll:lt,layoutRoot:ct})}function getClosestProjectingNode(nt){if(nt)return nt.options.allowProjection!==!1?nt.projection:getClosestProjectingNode(nt.parent)}function useMotionRef(nt,_e,et){return reactExports.useCallback(rt=>{rt&&nt.mount&&nt.mount(rt),_e&&(rt?_e.mount(rt):_e.unmount()),et&&(typeof et=="function"?et(rt):isRefObject(et)&&(et.current=rt))},[_e])}function isControllingVariants(nt){return isAnimationControls(nt.animate)||variantProps.some(_e=>isVariantLabel(nt[_e]))}function isVariantNode(nt){return!!(isControllingVariants(nt)||nt.variants)}function getCurrentTreeVariants(nt,_e){if(isControllingVariants(nt)){const{initial:et,animate:rt}=nt;return{initial:et===!1||isVariantLabel(et)?et:void 0,animate:isVariantLabel(rt)?rt:void 0}}return nt.inherit!==!1?_e:{}}function useCreateMotionContext(nt){const{initial:_e,animate:et}=getCurrentTreeVariants(nt,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:_e,animate:et}),[variantLabelsAsDependency(_e),variantLabelsAsDependency(et)])}function variantLabelsAsDependency(nt){return Array.isArray(nt)?nt.join(" "):nt}const featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const nt in featureProps)featureDefinitions[nt]={isEnabled:_e=>featureProps[nt].some(et=>!!_e[et])};function loadFeatures(nt){for(const _e in nt)featureDefinitions[_e]={...featureDefinitions[_e],...nt[_e]}}const motionComponentSymbol=Symbol.for("motionComponentSymbol");function createRendererMotionComponent({preloadedFeatures:nt,createVisualElement:_e,useRender:et,useVisualState:rt,Component:it}){nt&&loadFeatures(nt);function st(at,lt){let ct;const ut={...reactExports.useContext(MotionConfigContext),...at,layoutId:useLayoutId(at)},{isStatic:ht}=ut,dt=useCreateMotionContext(at),ft=rt(at,ht);if(!ht&&isBrowser){useStrictMode();const pt=getProjectionFunctionality(ut);ct=pt.MeasureLayout,dt.visualElement=useVisualElement(it,ft,ut,_e,pt.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:dt,children:[ct&&dt.visualElement?jsxRuntimeExports.jsx(ct,{visualElement:dt.visualElement,...ut}):null,et(it,at,useMotionRef(ft,dt.visualElement,lt),ft,ht,dt.visualElement)]})}const ot=reactExports.forwardRef(st);return ot[motionComponentSymbol]=it,ot}function useLayoutId({layoutId:nt}){const _e=reactExports.useContext(LayoutGroupContext).id;return _e&&nt!==void 0?_e+"-"+nt:nt}function useStrictMode(nt,_e){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(nt){const{drag:_e,layout:et}=featureDefinitions;if(!_e&&!et)return{};const rt={..._e,...et};return{MeasureLayout:_e!=null&&_e.isEnabled(nt)||et!=null&&et.isEnabled(nt)?rt.MeasureLayout:void 0,ProjectionNode:rt.ProjectionNode}}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(nt){return typeof nt!="string"||nt.includes("-")?!1:!!(lowercaseSVGElements.indexOf(nt)>-1||/[A-Z]/u.test(nt))}function renderHTML(nt,{style:_e,vars:et},rt,it){Object.assign(nt.style,_e,it&&it.getProjectionStyles(rt));for(const st in et)nt.style.setProperty(st,et[st])}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(nt,_e,et,rt){renderHTML(nt,_e,void 0,rt);for(const it in _e.attrs)nt.setAttribute(camelCaseAttributes.has(it)?it:camelToDash(it),_e.attrs[it])}function isForcedMotionValue(nt,{layout:_e,layoutId:et}){return transformProps.has(nt)||nt.startsWith("origin")||(_e||et!==void 0)&&(!!scaleCorrectors[nt]||nt==="opacity")}function scrapeMotionValuesFromProps$1(nt,_e,et){var rt;const{style:it}=nt,st={};for(const ot in it)(isMotionValue(it[ot])||_e.style&&isMotionValue(_e.style[ot])||isForcedMotionValue(ot,nt)||((rt=et==null?void 0:et.getValue(ot))===null||rt===void 0?void 0:rt.liveStyle)!==void 0)&&(st[ot]=it[ot]);return st}function scrapeMotionValuesFromProps(nt,_e,et){const rt=scrapeMotionValuesFromProps$1(nt,_e,et);for(const it in nt)if(isMotionValue(nt[it])||isMotionValue(_e[it])){const st=transformPropOrder.indexOf(it)!==-1?"attr"+it.charAt(0).toUpperCase()+it.substring(1):it;rt[st]=nt[it]}return rt}function useConstant(nt){const _e=reactExports.useRef(null);return _e.current===null&&(_e.current=nt()),_e.current}function makeState({scrapeMotionValuesFromProps:nt,createRenderState:_e,onMount:et},rt,it,st){const ot={latestValues:makeLatestValues(rt,it,st,nt),renderState:_e()};return et&&(ot.mount=at=>et(rt,at,ot)),ot}const makeUseVisualState=nt=>(_e,et)=>{const rt=reactExports.useContext(MotionContext),it=reactExports.useContext(PresenceContext),st=()=>makeState(nt,_e,rt,it);return et?st():useConstant(st)};function makeLatestValues(nt,_e,et,rt){const it={},st=rt(nt,{});for(const dt in st)it[dt]=resolveMotionValue(st[dt]);let{initial:ot,animate:at}=nt;const lt=isControllingVariants(nt),ct=isVariantNode(nt);_e&&ct&&!lt&&nt.inherit!==!1&&(ot===void 0&&(ot=_e.initial),at===void 0&&(at=_e.animate));let ut=et?et.initial===!1:!1;ut=ut||ot===!1;const ht=ut?at:ot;if(ht&&typeof ht!="boolean"&&!isAnimationControls(ht)){const dt=Array.isArray(ht)?ht:[ht];for(let ft=0;ft<dt.length;ft++){const pt=resolveVariantFromProps(nt,dt[ft]);if(pt){const{transitionEnd:mt,transition:At,...gt}=pt;for(const bt in gt){let Tt=gt[bt];if(Array.isArray(Tt)){const wt=ut?Tt.length-1:0;Tt=Tt[wt]}Tt!==null&&(it[bt]=Tt)}for(const bt in mt)it[bt]=mt[bt]}}}return it}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),getValueAsType=(nt,_e)=>_e&&typeof nt=="number"?_e.transform(nt):nt,translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(nt,_e,et){let rt="",it=!0;for(let st=0;st<numTransforms;st++){const ot=transformPropOrder[st],at=nt[ot];if(at===void 0)continue;let lt=!0;if(typeof at=="number"?lt=at===(ot.startsWith("scale")?1:0):lt=parseFloat(at)===0,!lt||et){const ct=getValueAsType(at,numberValueTypes[ot]);if(!lt){it=!1;const ut=translateAlias[ot]||ot;rt+=`${ut}(${ct}) `}et&&(_e[ot]=ct)}}return rt=rt.trim(),et?rt=et(_e,it?"":rt):it&&(rt="none"),rt}function buildHTMLStyles(nt,_e,et){const{style:rt,vars:it,transformOrigin:st}=nt;let ot=!1,at=!1;for(const lt in _e){const ct=_e[lt];if(transformProps.has(lt)){ot=!0;continue}else if(isCSSVariableName(lt)){it[lt]=ct;continue}else{const ut=getValueAsType(ct,numberValueTypes[lt]);lt.startsWith("origin")?(at=!0,st[lt]=ut):rt[lt]=ut}}if(_e.transform||(ot||et?rt.transform=buildTransform(_e,nt.transform,et):rt.transform&&(rt.transform="none")),at){const{originX:lt="50%",originY:ct="50%",originZ:ut=0}=st;rt.transformOrigin=`${lt} ${ct} ${ut}`}}function calcOrigin(nt,_e,et){return typeof nt=="string"?nt:px.transform(_e+et*nt)}function calcSVGTransformOrigin(nt,_e,et){const rt=calcOrigin(_e,nt.x,nt.width),it=calcOrigin(et,nt.y,nt.height);return`${rt} ${it}`}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(nt,_e,et=1,rt=0,it=!0){nt.pathLength=1;const st=it?dashKeys:camelKeys;nt[st.offset]=px.transform(-rt);const ot=px.transform(_e),at=px.transform(et);nt[st.array]=`${ot} ${at}`}function buildSVGAttrs(nt,{attrX:_e,attrY:et,attrScale:rt,originX:it,originY:st,pathLength:ot,pathSpacing:at=1,pathOffset:lt=0,...ct},ut,ht){if(buildHTMLStyles(nt,ct,ht),ut){nt.style.viewBox&&(nt.attrs.viewBox=nt.style.viewBox);return}nt.attrs=nt.style,nt.style={};const{attrs:dt,style:ft,dimensions:pt}=nt;dt.transform&&(pt&&(ft.transform=dt.transform),delete dt.transform),pt&&(it!==void 0||st!==void 0||ft.transform)&&(ft.transformOrigin=calcSVGTransformOrigin(pt,it!==void 0?it:.5,st!==void 0?st:.5)),_e!==void 0&&(dt.x=_e),et!==void 0&&(dt.y=et),rt!==void 0&&(dt.scale=rt),ot!==void 0&&buildSVGPath(dt,ot,at,lt,!1)}const isSVGTag=nt=>typeof nt=="string"&&nt.toLowerCase()==="svg",svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onMount:(nt,_e,{renderState:et,latestValues:rt})=>{frame.read(()=>{try{et.dimensions=typeof _e.getBBox=="function"?_e.getBBox():_e.getBoundingClientRect()}catch{et.dimensions={x:0,y:0,width:0,height:0}}}),frame.render(()=>{buildSVGAttrs(et,rt,isSVGTag(_e.tagName),nt.transformTemplate),renderSVG(_e,et)})}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function copyRawValuesOnly(nt,_e,et){for(const rt in _e)!isMotionValue(_e[rt])&&!isForcedMotionValue(rt,et)&&(nt[rt]=_e[rt])}function useInitialMotionValues({transformTemplate:nt},_e){return reactExports.useMemo(()=>{const et=createHtmlRenderState();return buildHTMLStyles(et,_e,nt),Object.assign({},et.vars,et.style)},[_e])}function useStyle(nt,_e){const et=nt.style||{},rt={};return copyRawValuesOnly(rt,et,nt),Object.assign(rt,useInitialMotionValues(nt,_e)),rt}function useHTMLProps(nt,_e){const et={},rt=useStyle(nt,_e);return nt.drag&&nt.dragListener!==!1&&(et.draggable=!1,rt.userSelect=rt.WebkitUserSelect=rt.WebkitTouchCallout="none",rt.touchAction=nt.drag===!0?"none":`pan-${nt.drag==="x"?"y":"x"}`),nt.tabIndex===void 0&&(nt.onTap||nt.onTapStart||nt.whileTap)&&(et.tabIndex=0),et.style=rt,et}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(nt){return nt.startsWith("while")||nt.startsWith("drag")&&nt!=="draggable"||nt.startsWith("layout")||nt.startsWith("onTap")||nt.startsWith("onPan")||nt.startsWith("onLayout")||validMotionProps.has(nt)}let shouldForward=nt=>!isValidMotionProp(nt);function loadExternalIsValidProp(nt){nt&&(shouldForward=_e=>_e.startsWith("on")?!isValidMotionProp(_e):nt(_e))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch(nt){}function filterProps(nt,_e,et){const rt={};for(const it in nt)it==="values"&&typeof nt.values=="object"||(shouldForward(it)||et===!0&&isValidMotionProp(it)||!_e&&!isValidMotionProp(it)||nt.draggable&&it.startsWith("onDrag"))&&(rt[it]=nt[it]);return rt}function useSVGProps(nt,_e,et,rt){const it=reactExports.useMemo(()=>{const st=createSvgRenderState();return buildSVGAttrs(st,_e,isSVGTag(rt),nt.transformTemplate),{...st.attrs,style:{...st.style}}},[_e]);if(nt.style){const st={};copyRawValuesOnly(st,nt.style,nt),it.style={...st,...it.style}}return it}function createUseRender(nt=!1){return(et,rt,it,{latestValues:st},ot)=>{const lt=(isSVGComponent(et)?useSVGProps:useHTMLProps)(rt,st,ot,et),ct=filterProps(rt,typeof et=="string",nt),ut=et!==reactExports.Fragment?{...ct,...lt,ref:it}:{},{children:ht}=rt,dt=reactExports.useMemo(()=>isMotionValue(ht)?ht.get():ht,[ht]);return reactExports.createElement(et,{...ut,children:dt})}}function createMotionComponentFactory(nt,_e){return function(rt,{forwardMotionProps:it}={forwardMotionProps:!1}){const ot={...isSVGComponent(rt)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:nt,useRender:createUseRender(it),createVisualElement:_e,Component:rt};return createRendererMotionComponent(ot)}}const prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const nt=window.matchMedia("(prefers-reduced-motion)"),_e=()=>prefersReducedMotion.current=nt.matches;nt.addListener(_e),_e()}else prefersReducedMotion.current=!1}function updateMotionValuesFromProps(nt,_e,et){for(const rt in _e){const it=_e[rt],st=et[rt];if(isMotionValue(it))nt.addValue(rt,it);else if(isMotionValue(st))nt.addValue(rt,motionValue(it,{owner:nt}));else if(st!==it)if(nt.hasValue(rt)){const ot=nt.getValue(rt);ot.liveStyle===!0?ot.jump(it):ot.hasAnimated||ot.set(it)}else{const ot=nt.getStaticValue(rt);nt.addValue(rt,motionValue(ot!==void 0?ot:it,{owner:nt}))}}for(const rt in et)_e[rt]===void 0&&nt.removeValue(rt);return _e}const visualElementStore=new WeakMap,valueTypes=[...dimensionValueTypes,color$1,complex],findValueType=nt=>valueTypes.find(testValueType(nt)),propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(_e,et,rt){return{}}constructor({parent:_e,props:et,presenceContext:rt,reducedMotionConfig:it,blockInitialAnimation:st,visualState:ot},at={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const dt=time.now();this.renderScheduledAt<dt&&(this.renderScheduledAt=dt,frame.render(this.render,!1,!0))};const{latestValues:lt,renderState:ct}=ot;this.latestValues=lt,this.baseTarget={...lt},this.initialValues=et.initial?{...lt}:{},this.renderState=ct,this.parent=_e,this.props=et,this.presenceContext=rt,this.depth=_e?_e.depth+1:0,this.reducedMotionConfig=it,this.options=at,this.blockInitialAnimation=!!st,this.isControllingVariants=isControllingVariants(et),this.isVariantNode=isVariantNode(et),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(_e&&_e.current);const{willChange:ut,...ht}=this.scrapeMotionValuesFromProps(et,{},this);for(const dt in ht){const ft=ht[dt];lt[dt]!==void 0&&isMotionValue(ft)&&ft.set(lt[dt],!1)}}mount(_e){this.current=_e,visualElementStore.set(_e,this),this.projection&&!this.projection.instance&&this.projection.mount(_e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((et,rt)=>this.bindToMotionValue(rt,et)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){visualElementStore.delete(this.current),this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(_e=>_e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const _e in this.events)this.events[_e].clear();for(const _e in this.features){const et=this.features[_e];et&&(et.unmount(),et.isMounted=!1)}this.current=null}bindToMotionValue(_e,et){this.valueSubscriptions.has(_e)&&this.valueSubscriptions.get(_e)();const rt=transformProps.has(_e),it=et.on("change",at=>{this.latestValues[_e]=at,this.props.onUpdate&&frame.preRender(this.notifyUpdate),rt&&this.projection&&(this.projection.isTransformDirty=!0)}),st=et.on("renderRequest",this.scheduleRender);let ot;window.MotionCheckAppearSync&&(ot=window.MotionCheckAppearSync(this,_e,et)),this.valueSubscriptions.set(_e,()=>{it(),st(),ot&&ot(),et.owner&&et.stop()})}sortNodePosition(_e){return!this.current||!this.sortInstanceNodePosition||this.type!==_e.type?0:this.sortInstanceNodePosition(this.current,_e.current)}updateFeatures(){let _e="animation";for(_e in featureDefinitions){const et=featureDefinitions[_e];if(!et)continue;const{isEnabled:rt,Feature:it}=et;if(!this.features[_e]&&it&&rt(this.props)&&(this.features[_e]=new it(this)),this.features[_e]){const st=this.features[_e];st.isMounted?st.update():(st.mount(),st.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(_e){return this.latestValues[_e]}setStaticValue(_e,et){this.latestValues[_e]=et}update(_e,et){(_e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=_e,this.prevPresenceContext=this.presenceContext,this.presenceContext=et;for(let rt=0;rt<propEventHandlers.length;rt++){const it=propEventHandlers[rt];this.propEventSubscriptions[it]&&(this.propEventSubscriptions[it](),delete this.propEventSubscriptions[it]);const st="on"+it,ot=_e[st];ot&&(this.propEventSubscriptions[it]=this.on(it,ot))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(_e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(_e){return this.props.variants?this.props.variants[_e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(_e){const et=this.getClosestVariantNode();if(et)return et.variantChildren&&et.variantChildren.add(_e),()=>et.variantChildren.delete(_e)}addValue(_e,et){const rt=this.values.get(_e);et!==rt&&(rt&&this.removeValue(_e),this.bindToMotionValue(_e,et),this.values.set(_e,et),this.latestValues[_e]=et.get())}removeValue(_e){this.values.delete(_e);const et=this.valueSubscriptions.get(_e);et&&(et(),this.valueSubscriptions.delete(_e)),delete this.latestValues[_e],this.removeValueFromRenderState(_e,this.renderState)}hasValue(_e){return this.values.has(_e)}getValue(_e,et){if(this.props.values&&this.props.values[_e])return this.props.values[_e];let rt=this.values.get(_e);return rt===void 0&&et!==void 0&&(rt=motionValue(et===null?void 0:et,{owner:this}),this.addValue(_e,rt)),rt}readValue(_e,et){var rt;let it=this.latestValues[_e]!==void 0||!this.current?this.latestValues[_e]:(rt=this.getBaseTargetFromProps(this.props,_e))!==null&&rt!==void 0?rt:this.readValueFromInstance(this.current,_e,this.options);return it!=null&&(typeof it=="string"&&(isNumericalString(it)||isZeroValueString(it))?it=parseFloat(it):!findValueType(it)&&complex.test(et)&&(it=getAnimatableNone(_e,et)),this.setBaseTarget(_e,isMotionValue(it)?it.get():it)),isMotionValue(it)?it.get():it}setBaseTarget(_e,et){this.baseTarget[_e]=et}getBaseTarget(_e){var et;const{initial:rt}=this.props;let it;if(typeof rt=="string"||typeof rt=="object"){const ot=resolveVariantFromProps(this.props,rt,(et=this.presenceContext)===null||et===void 0?void 0:et.custom);ot&&(it=ot[_e])}if(rt&&it!==void 0)return it;const st=this.getBaseTargetFromProps(this.props,_e);return st!==void 0&&!isMotionValue(st)?st:this.initialValues[_e]!==void 0&&it===void 0?void 0:this.baseTarget[_e]}on(_e,et){return this.events[_e]||(this.events[_e]=new SubscriptionManager),this.events[_e].add(et)}notify(_e,...et){this.events[_e]&&this.events[_e].notify(...et)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(_e,et){return _e.compareDocumentPosition(et)&2?1:-1}getBaseTargetFromProps(_e,et){return _e.style?_e.style[et]:void 0}removeValueFromRenderState(_e,{vars:et,style:rt}){delete et[_e],delete rt[_e]}}function getComputedStyle$1(nt){return window.getComputedStyle(nt)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(_e,et){if(transformProps.has(et)){const rt=getDefaultValueType(et);return rt&&rt.default||0}else{const rt=getComputedStyle$1(_e),it=(isCSSVariableName(et)?rt.getPropertyValue(et):rt[et])||0;return typeof it=="string"?it.trim():it}}measureInstanceViewportBox(_e,{transformPagePoint:et}){return measureViewportBox(_e,et)}build(_e,et,rt){buildHTMLStyles(_e,et,rt.transformTemplate)}scrapeMotionValuesFromProps(_e,et,rt){return scrapeMotionValuesFromProps$1(_e,et,rt)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:_e}=this.props;isMotionValue(_e)&&(this.childSubscription=_e.on("change",et=>{this.current&&(this.current.textContent=`${et}`)}))}}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(_e,et){return _e[et]}readValueFromInstance(_e,et){if(transformProps.has(et)){const rt=getDefaultValueType(et);return rt&&rt.default||0}return et=camelCaseAttributes.has(et)?et:camelToDash(et),_e.getAttribute(et)}scrapeMotionValuesFromProps(_e,et,rt){return scrapeMotionValuesFromProps(_e,et,rt)}build(_e,et,rt){buildSVGAttrs(_e,et,this.isSVGTag,rt.transformTemplate)}renderInstance(_e,et,rt,it){renderSVG(_e,et,rt,it)}mount(_e){this.isSVGTag=isSVGTag(_e.tagName),super.mount(_e)}}const createDomVisualElement=(nt,_e)=>isSVGComponent(nt)?new SVGVisualElement(_e):new HTMLVisualElement(_e,{allowProjection:nt!==reactExports.Fragment}),createMotionComponent=createMotionComponentFactory({...animations,...gestureAnimations,...drag,...layout},createDomVisualElement),motion=createDOMMotionComponentProxy(createMotionComponent),useAlert=()=>{const[nt,_e]=reactExports.useState({show:!1,text:"",type:"danger"});return{alert:nt,showAlert:({text:it,type:st="danger"})=>_e({show:!0,text:it,type:st}),hideAlert:()=>_e({show:!1,text:"",type:"danger"})}},Alert=({type:nt,text:_e})=>jsxRuntimeExports.jsx("div",{className:"fixed bottom-5 right-5 flex justify-center items-center z-50",children:jsxRuntimeExports.jsxs("div",{className:`p-2 ${nt==="danger"?"bg-red-800":"bg-blue-800"} items-center text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex rounded-md p-5`,role:"alert",children:[jsxRuntimeExports.jsx("p",{className:`flex rounded-full ${nt==="danger"?"bg-red-500":"bg-blue-500"} uppercase px-2 py-1 text-xs font-semibold mr-3`,children:nt==="danger"?"Failed":"Success"}),jsxRuntimeExports.jsx("p",{className:"mr-2 text-left",children:_e})]})}),Contact=()=>{const nt=reactExports.useRef(),{alert:_e,showAlert:et,hideAlert:rt}=useAlert(),[it,st]=reactExports.useState(!1),[ot,at]=reactExports.useState({name:"",email:"",message:""}),lt=({target:{name:ut,value:ht}})=>{at({...ot,[ut]:ht})},ct=ut=>{ut.preventDefault(),st(!0),emailjs.send("service_3cv50hx","template_ytrmgg6",{from_name:ot.name,to_name:"Ansh Tomar",from_email:ot.email,to_email:"ansh06tomar@gmail.com",message:ot.message},"YILAbEKH16R3GwjqZ").then(()=>{st(!1),et({show:!0,text:"Thank you for your message ",type:"success"}),setTimeout(()=>{rt(!1),at({name:"",email:"",message:""})},3e3)},ht=>{st(!1),console.error(ht),et({show:!0,text:"I didn't receive your message ",type:"danger"})})};return jsxRuntimeExports.jsxs("section",{className:"relative min-h-screen flex items-center justify-center py-20",id:"contact",children:[jsxRuntimeExports.jsx("img",{src:"/assets/terminal.png",alt:"terminal background",className:"absolute inset-0 w-full h-full object-cover opacity-20 pointer-events-none"}),_e.show&&jsxRuntimeExports.jsx(Alert,{..._e}),jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-4xl mx-auto px-4 z-10",children:jsxRuntimeExports.jsxs("div",{className:"bg-neutral-900/70 backdrop-blur-lg border border-neutral-700 rounded-3xl p-8 md:p-12 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-12",children:[jsxRuntimeExports.jsx(motion.h2,{className:"text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 via-yellow-200 to-orange-500 mb-4",initial:{scale:.9,opacity:0},whileInView:{scale:1,opacity:1},transition:{duration:.5},children:"Let's Connect"}),jsxRuntimeExports.jsx("p",{className:"text-neutral-300 max-w-xl mx-auto text-lg",children:`Got an exciting project or just want to say hello? Drop me a message and I'll get back to you faster than you can say "code"!`})]}),jsxRuntimeExports.jsxs("form",{ref:nt,onSubmit:ct,className:"space-y-6 max-w-xl mx-auto",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},transition:{delay:.2,duration:.5},children:[jsxRuntimeExports.jsx("label",{className:"block mb-2 text-neutral-300",children:"Full Name"}),jsxRuntimeExports.jsx("input",{type:"text",name:"name",value:ot.name,onChange:lt,required:!0,className:"w-full bg-neutral-700/50 border border-neutral-600 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all",placeholder:"Your Name"})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},transition:{delay:.3,duration:.5},children:[jsxRuntimeExports.jsx("label",{className:"block mb-2 text-neutral-300",children:"Email Address"}),jsxRuntimeExports.jsx("input",{type:"email",name:"email",value:ot.email,onChange:lt,required:!0,className:"w-full bg-neutral-700/50 border border-neutral-600 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all",placeholder:"your@email.com"})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},transition:{delay:.4,duration:.5},children:[jsxRuntimeExports.jsx("label",{className:"block mb-2 text-neutral-300",children:"Your Message"}),jsxRuntimeExports.jsx("textarea",{name:"message",value:ot.message,onChange:lt,required:!0,rows:5,className:"w-full bg-neutral-700/50 border border-neutral-600 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all",placeholder:"What's on your mind?"})]}),jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:jsxRuntimeExports.jsx("button",{type:"submit",disabled:it,className:"w-full bg-gradient-to-r from-green-400 via-yellow-200 to-orange-500 text-black font-bold py-4 rounded-xl hover:from-green-500 hover:via-yellow-300 hover:to-orange-600 transition-all flex items-center justify-center space-x-2 disabled:opacity-50",children:it?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"mr-2 h-5 w-5 animate-spin"}),"Sending..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{children:"Send Message"}),jsxRuntimeExports.jsx(Send,{className:"ml-2 h-5 w-5"})]})})})]})]})})]})},DemoComputer=nt=>{const _e=reactExports.useRef(),{nodes:et,materials:rt,animations:it}=useGLTF("/models/computer.glb");useAnimations(it,_e);const st=useVideoTexture(nt.texture?nt.texture:"/textures/project/project1.mp4");return reactExports.useEffect(()=>{st&&(st.flipY=!1)},[st]),useGSAP(()=>{gsapWithCSS.from(_e.current.rotation,{y:Math.PI/2,duration:1,ease:"power3.out"})},[st]),jsxRuntimeExports.jsx("group",{ref:_e,...nt,dispose:null,children:jsxRuntimeExports.jsxs("group",{name:"Scene",children:[jsxRuntimeExports.jsx("mesh",{name:"monitor-screen",geometry:et["monitor-screen"].geometry,material:et["monitor-screen"].material,position:[.127,1.831,.511],rotation:[1.571,-.005,.031],scale:[.661,.608,.401],children:jsxRuntimeExports.jsx("meshBasicMaterial",{map:st,toneMapped:!1})}),jsxRuntimeExports.jsxs("group",{name:"RootNode",position:[0,1.093,0],rotation:[-Math.PI/2,0,-.033],scale:.045,children:[jsxRuntimeExports.jsx("group",{name:"Screen001",position:[5.658,1.643,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen002",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen003",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen004",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen005",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen006",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen007",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen008",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen009",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen010",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen011",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen012",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen013",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen014",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen015",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen016",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen017",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen018",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen019",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen020",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen021",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen022",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen023",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen024",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen025",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen026",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen027",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen028",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen029",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen030",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen031",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen032",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen033",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen034",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen035",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen036",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen037",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen038",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen039",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen040",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen041",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen042",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen043",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen044",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen045",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen046",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen047",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen048",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen049",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen050",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen051",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen052",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen053",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen054",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen055",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen056",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen057",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen058",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen059",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen060",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen061",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen062",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen063",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen064",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen065",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen066",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen067",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen068",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen069",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen070",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen071",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen072",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen073",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen074",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen075",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen076",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen077",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen078",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen079",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen080",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen081",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen082",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen083",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen084",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen085",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen086",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen087",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen088",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen089",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen090",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen091",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen092",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen093",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen094",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen095",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen096",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen097",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen098",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen099",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen100",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen101",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen102",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen103",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen104",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen105",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen106",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen107",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen108",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen109",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen110",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen111",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen112",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen113",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen114",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen115",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen116",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen117",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen118",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen119",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen120",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen121",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen122",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen123",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen124",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen125",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen126",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen127",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen128",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen129",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen130",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen131",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen132",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen133",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen134",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen135",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen136",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen137",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen138",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen139",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen140",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen141",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen142",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen143",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen144",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen145",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen146",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen147",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Screen148",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),jsxRuntimeExports.jsx("group",{name:"Tower-light-007",position:[16.089,-3.47,-14.495],rotation:[Math.PI/2,0,0],scale:.963}),jsxRuntimeExports.jsx("group",{name:"Tower-light-008",position:[15.155,-3.47,-14.495],rotation:[Math.PI/2,0,0],scale:.963})]}),jsxRuntimeExports.jsxs("group",{name:"Monitor-B-_computer_0",position:[.266,1.132,.051],rotation:[0,-.033,0],scale:[.042,.045,.045],children:[jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_1",geometry:et["Monitor-B-_computer_0_1"].geometry,material:rt.computer}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_2",geometry:et["Monitor-B-_computer_0_2"].geometry,material:rt.base__0}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_3",geometry:et["Monitor-B-_computer_0_3"].geometry,material:rt.Material_36}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_4",geometry:et["Monitor-B-_computer_0_4"].geometry,material:rt.Material_35}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_5",geometry:et["Monitor-B-_computer_0_5"].geometry,material:rt.Material_34}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_6",geometry:et["Monitor-B-_computer_0_6"].geometry,material:rt.keys}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_7",geometry:et["Monitor-B-_computer_0_7"].geometry,material:rt.keys2}),jsxRuntimeExports.jsx("mesh",{name:"Monitor-B-_computer_0_8",geometry:et["Monitor-B-_computer_0_8"].geometry,material:rt.Material_37})]})]})})};useGLTF.preload("/models/computer.glb");const projectCount=myProjects.length,Projects=()=>{const[nt,_e]=reactExports.useState(0),et=it=>{_e(st=>it==="previous"?st===0?projectCount-1:st-1:st===projectCount-1?0:st+1)};useGSAP(()=>{gsapWithCSS.fromTo(".animatedText",{opacity:0},{opacity:1,duration:1,stagger:.2,ease:"power2.inOut"})},[nt]);const rt=myProjects[nt];return jsxRuntimeExports.jsxs("section",{className:"c-space my-20",id:"projects",children:[jsxRuntimeExports.jsx("p",{className:"head-text",children:"Selected Work"}),jsxRuntimeExports.jsxs("div",{className:"grid lg:grid-cols-2 grid-cols-1 mt-12 gap-5 w-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-5 relative sm:p-10 py-10 px-5 shadow-2xl shadow-black-200",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0",children:jsxRuntimeExports.jsx("img",{src:rt.spotlight,alt:"spotlight",className:"w-full h-96 object-cover rounded-xl"})}),jsxRuntimeExports.jsx("div",{className:"p-3 backdrop-filter backdrop-blur-3xl w-fit rounded-lg",style:rt.logoStyle,children:jsxRuntimeExports.jsx("img",{className:"w-10 h-10 shadow-sm",src:rt.logo,alt:"logo"})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-5 text-white-600 my-5",children:[jsxRuntimeExports.jsx("p",{className:"text-white text-2xl font-semibold animatedText",children:rt.title}),jsxRuntimeExports.jsx("p",{className:"animatedText",children:rt.desc}),jsxRuntimeExports.jsx("p",{className:"animatedText",children:rt.subdesc})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-5",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:rt.tags.map((it,st)=>jsxRuntimeExports.jsx("div",{className:"tech-logo",children:jsxRuntimeExports.jsx("img",{src:it.path,alt:it.name})},st))}),jsxRuntimeExports.jsxs("a",{className:"flex items-center gap-2 cursor-pointer text-white-600",href:rt.href,target:"_blank",rel:"noreferrer",children:[jsxRuntimeExports.jsx("p",{children:"Check Live Site"}),jsxRuntimeExports.jsx("img",{src:"/assets/arrow-up.png",alt:"arrow",className:"w-3 h-3"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mt-7",children:[jsxRuntimeExports.jsx("button",{className:"arrow-btn",onClick:()=>et("previous"),children:jsxRuntimeExports.jsx("img",{src:"/assets/left-arrow.png",alt:"left arrow"})}),jsxRuntimeExports.jsx("button",{className:"arrow-btn",onClick:()=>et("next"),children:jsxRuntimeExports.jsx("img",{src:"/assets/right-arrow.png",alt:"right arrow",className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsx("div",{className:"border border-black-300 bg-black-200 rounded-lg h-96 md:h-full",children:jsxRuntimeExports.jsxs(Canvas,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:Math.PI}),jsxRuntimeExports.jsx("directionalLight",{position:[10,10,5]}),jsxRuntimeExports.jsx(Center,{children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(CanvasLoader,{}),children:jsxRuntimeExports.jsx("group",{scale:2,position:[0,-3,0],rotation:[0,-.1,0],children:jsxRuntimeExports.jsx(DemoComputer,{texture:rt.texture})})})}),jsxRuntimeExports.jsx(OrbitControls$1,{maxPolarAngle:Math.PI/2,enableZoom:!1})]})})]})]})};useGLTF.preload("/models/animations/developer.glb");/**
 * postprocessing v6.36.4 build Tue Nov 05 2024
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2024 Raoul van Rschen
 * @license Zlib
 */var MILLISECONDS_TO_SECONDS=1/1e3,SECONDS_TO_MILLISECONDS=1e3,Timer=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(nt){typeof document<"u"&&document.hidden!==void 0&&(nt?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=nt)}get delta(){return this._delta*MILLISECONDS_TO_SECONDS}get fixedDelta(){return this._fixedDelta*MILLISECONDS_TO_SECONDS}set fixedDelta(nt){this._fixedDelta=nt*SECONDS_TO_MILLISECONDS}get elapsed(){return this._elapsed*MILLISECONDS_TO_SECONDS}update(nt){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(nt!==void 0?nt:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(nt){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},fullscreenGeometry=(()=>{const nt=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),_e=new Float32Array([0,0,2,0,0,2]),et=new BufferGeometry$1;return et.setAttribute("position",new BufferAttribute$1(nt,3)),et.setAttribute("uv",new BufferAttribute$1(_e,2)),et})(),Pass=class Gm{static get fullscreenGeometry(){return fullscreenGeometry}constructor(_e="Pass",et=new Scene$1,rt=new Camera$1){this.name=_e,this.renderer=null,this.scene=et,this.camera=rt,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(_e){if(this.rtt===_e){const et=this.fullscreenMaterial;et!==null&&(et.needsUpdate=!0),this.rtt=!_e}}set mainScene(_e){}set mainCamera(_e){}setRenderer(_e){this.renderer=_e}isEnabled(){return this.enabled}setEnabled(_e){this.enabled=_e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(_e){let et=this.screen;et!==null?et.material=_e:(et=new Mesh$1(Gm.fullscreenGeometry,_e),et.frustumCulled=!1,this.scene===null&&(this.scene=new Scene$1),this.scene.add(et),this.screen=et)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(_e){this.fullscreenMaterial=_e}getDepthTexture(){return null}setDepthTexture(_e,et=BasicDepthPacking){}render(_e,et,rt,it,st){throw new Error("Render method not implemented!")}setSize(_e,et){}initialize(_e,et,rt){}dispose(){for(const _e of Object.keys(this)){const et=this[_e];(et instanceof WebGLRenderTarget$1||et instanceof Material$1||et instanceof Texture$1||et instanceof Gm)&&this[_e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},ClearMaskPass=class extends Pass{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(nt,_e,et,rt,it){const st=nt.state.buffers.stencil;st.setLocked(!1),st.setTest(!1)}},copy_default=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,common_default="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",CopyMaterial=class extends ShaderMaterial$1{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Uniform$1(null),opacity:new Uniform$1(1)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:copy_default,vertexShader:common_default})}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}getOpacity(nt){return this.uniforms.opacity.value}setOpacity(nt){this.uniforms.opacity.value=nt}},CopyPass=class extends Pass{constructor(nt,_e=!0){super("CopyPass"),this.fullscreenMaterial=new CopyMaterial,this.needsSwap=!1,this.renderTarget=nt,nt===void 0&&(this.renderTarget=new WebGLRenderTarget$1(1,1,{minFilter:LinearFilter$1,magFilter:LinearFilter$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=_e}get resize(){return this.autoResize}set resize(nt){this.autoResize=nt}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(nt){this.autoResize=nt}render(nt,_e,et,rt,it){this.fullscreenMaterial.inputBuffer=_e.texture,nt.setRenderTarget(this.renderToScreen?null:this.renderTarget),nt.render(this.scene,this.camera)}setSize(nt,_e){this.autoResize&&this.renderTarget.setSize(nt,_e)}initialize(nt,_e,et){et!==void 0&&(this.renderTarget.texture.type=et,et!==UnsignedByteType$1?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":nt!==null&&nt.outputColorSpace===SRGBColorSpace$2&&(this.renderTarget.texture.colorSpace=SRGBColorSpace$2))}},color=new Color$2,ClearPass=class extends Pass{constructor(nt=!0,_e=!0,et=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=nt,this.depth=_e,this.stencil=et,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(nt,_e,et){this.color=nt,this.depth=_e,this.stencil=et}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(nt){this.overrideClearColor=nt}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(nt){this.overrideClearAlpha=nt}render(nt,_e,et,rt,it){const st=this.overrideClearColor,ot=this.overrideClearAlpha,at=nt.getClearAlpha(),lt=st!==null,ct=ot>=0;lt?(nt.getClearColor(color),nt.setClearColor(st,ct?ot:at)):ct&&nt.setClearAlpha(ot),nt.setRenderTarget(this.renderToScreen?null:_e),nt.clear(this.color,this.depth,this.stencil),lt?nt.setClearColor(color,at):ct&&nt.setClearAlpha(at)}},MaskPass=class extends Pass{constructor(nt,_e){super("MaskPass",nt,_e),this.needsSwap=!1,this.clearPass=new ClearPass(!1,!1,!0),this.inverse=!1}set mainScene(nt){this.scene=nt}set mainCamera(nt){this.camera=nt}get inverted(){return this.inverse}set inverted(nt){this.inverse=nt}get clear(){return this.clearPass.enabled}set clear(nt){this.clearPass.enabled=nt}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(nt){this.inverted=nt}render(nt,_e,et,rt,it){const st=nt.getContext(),ot=nt.state.buffers,at=this.scene,lt=this.camera,ct=this.clearPass,ut=this.inverted?0:1,ht=1-ut;ot.color.setMask(!1),ot.depth.setMask(!1),ot.color.setLocked(!0),ot.depth.setLocked(!0),ot.stencil.setTest(!0),ot.stencil.setOp(st.REPLACE,st.REPLACE,st.REPLACE),ot.stencil.setFunc(st.ALWAYS,ut,4294967295),ot.stencil.setClear(ht),ot.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?ct.render(nt,null):(ct.render(nt,_e),ct.render(nt,et))),this.renderToScreen?(nt.setRenderTarget(null),nt.render(at,lt)):(nt.setRenderTarget(_e),nt.render(at,lt),nt.setRenderTarget(et),nt.render(at,lt)),ot.color.setLocked(!1),ot.depth.setLocked(!1),ot.stencil.setLocked(!1),ot.stencil.setFunc(st.EQUAL,1,4294967295),ot.stencil.setOp(st.KEEP,st.KEEP,st.KEEP),ot.stencil.setLocked(!0)}},EffectComposer$1=class{constructor(_e=null,{depthBuffer:et=!0,stencilBuffer:rt=!1,multisampling:it=0,frameBufferType:st}={}){this.renderer=null,this.inputBuffer=this.createBuffer(et,rt,st,it),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new CopyPass,this.depthTexture=null,this.passes=[],this.timer=new Timer,this.autoRenderToScreen=!0,this.setRenderer(_e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(_e){const et=this.inputBuffer,rt=this.multisampling;rt>0&&_e>0?(this.inputBuffer.samples=_e,this.outputBuffer.samples=_e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):rt!==_e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(et.depthBuffer,et.stencilBuffer,et.texture.type,_e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(_e){if(this.renderer=_e,_e!==null){const et=_e.getSize(new Vector2$1),rt=_e.getContext().getContextAttributes().alpha,it=this.inputBuffer.texture.type;it===UnsignedByteType$1&&_e.outputColorSpace===SRGBColorSpace$2&&(this.inputBuffer.texture.colorSpace=SRGBColorSpace$2,this.outputBuffer.texture.colorSpace=SRGBColorSpace$2,this.inputBuffer.dispose(),this.outputBuffer.dispose()),_e.autoClear=!1,this.setSize(et.width,et.height);for(const st of this.passes)st.initialize(_e,rt,it)}}replaceRenderer(_e,et=!0){const rt=this.renderer,it=rt.domElement.parentNode;return this.setRenderer(_e),et&&it!==null&&(it.removeChild(rt.domElement),it.appendChild(_e.domElement)),rt}createDepthTexture(){const _e=this.depthTexture=new DepthTexture$1;return this.inputBuffer.depthTexture=_e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(_e.format=DepthStencilFormat$1,_e.type=UnsignedInt248Type$1):_e.type=UnsignedIntType$1,_e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const _e of this.passes)_e.setDepthTexture(null)}}createBuffer(_e,et,rt,it){const st=this.renderer,ot=st===null?new Vector2$1:st.getDrawingBufferSize(new Vector2$1),at={minFilter:LinearFilter$1,magFilter:LinearFilter$1,stencilBuffer:et,depthBuffer:_e,type:rt},lt=new WebGLRenderTarget$1(ot.width,ot.height,at);return it>0&&(lt.ignoreDepthForMultisampleCopy=!1,lt.samples=it),rt===UnsignedByteType$1&&st!==null&&st.outputColorSpace===SRGBColorSpace$2&&(lt.texture.colorSpace=SRGBColorSpace$2),lt.texture.name="EffectComposer.Buffer",lt.texture.generateMipmaps=!1,lt}setMainScene(_e){for(const et of this.passes)et.mainScene=_e}setMainCamera(_e){for(const et of this.passes)et.mainCamera=_e}addPass(_e,et){const rt=this.passes,it=this.renderer,st=it.getDrawingBufferSize(new Vector2$1),ot=it.getContext().getContextAttributes().alpha,at=this.inputBuffer.texture.type;if(_e.setRenderer(it),_e.setSize(st.width,st.height),_e.initialize(it,ot,at),this.autoRenderToScreen&&(rt.length>0&&(rt[rt.length-1].renderToScreen=!1),_e.renderToScreen&&(this.autoRenderToScreen=!1)),et!==void 0?rt.splice(et,0,_e):rt.push(_e),this.autoRenderToScreen&&(rt[rt.length-1].renderToScreen=!0),_e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const lt=this.createDepthTexture();for(_e of rt)_e.setDepthTexture(lt)}else _e.setDepthTexture(this.depthTexture)}removePass(_e){const et=this.passes,rt=et.indexOf(_e);if(rt!==-1&&et.splice(rt,1).length>0){if(this.depthTexture!==null){const ot=(lt,ct)=>lt||ct.needsDepthTexture;et.reduce(ot,!1)||(_e.getDepthTexture()===this.depthTexture&&_e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&rt===et.length&&(_e.renderToScreen=!1,et.length>0&&(et[et.length-1].renderToScreen=!0))}}removeAllPasses(){const _e=this.passes;this.deleteDepthTexture(),_e.length>0&&(this.autoRenderToScreen&&(_e[_e.length-1].renderToScreen=!1),this.passes=[])}render(_e){const et=this.renderer,rt=this.copyPass;let it=this.inputBuffer,st=this.outputBuffer,ot=!1,at,lt,ct;_e===void 0&&(this.timer.update(),_e=this.timer.getDelta());for(const ut of this.passes)ut.enabled&&(ut.render(et,it,st,_e,ot),ut.needsSwap&&(ot&&(rt.renderToScreen=ut.renderToScreen,at=et.getContext(),lt=et.state.buffers.stencil,lt.setFunc(at.NOTEQUAL,1,4294967295),rt.render(et,it,st,_e,ot),lt.setFunc(at.EQUAL,1,4294967295)),ct=it,it=st,st=ct),ut instanceof MaskPass?ot=!0:ut instanceof ClearMaskPass&&(ot=!1))}setSize(_e,et,rt){const it=this.renderer,st=it.getSize(new Vector2$1);(_e===void 0||et===void 0)&&(_e=st.width,et=st.height),(st.width!==_e||st.height!==et)&&it.setSize(_e,et,rt);const ot=it.getDrawingBufferSize(new Vector2$1);this.inputBuffer.setSize(ot.width,ot.height),this.outputBuffer.setSize(ot.width,ot.height);for(const at of this.passes)at.setSize(ot.width,ot.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const _e of this.passes)_e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Pass.fullscreenGeometry.dispose()}},EffectAttribute={NONE:0,DEPTH:1,CONVOLUTION:2},EffectShaderSection={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},EffectShaderData=class{constructor(){this.shaderParts=new Map([[EffectShaderSection.FRAGMENT_HEAD,null],[EffectShaderSection.FRAGMENT_MAIN_UV,null],[EffectShaderSection.FRAGMENT_MAIN_IMAGE,null],[EffectShaderSection.VERTEX_HEAD,null],[EffectShaderSection.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=EffectAttribute.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=LinearSRGBColorSpace$2}},workaroundEnabled=!1,OverrideMaterialManager=class{constructor(nt=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(nt),this.meshCount=0,this.replaceMaterial=_e=>{if(_e.isMesh){let et;if(_e.material.flatShading)switch(_e.material.side){case DoubleSide$1:et=this.materialsFlatShadedDoubleSide;break;case BackSide$1:et=this.materialsFlatShadedBackSide;break;default:et=this.materialsFlatShaded;break}else switch(_e.material.side){case DoubleSide$1:et=this.materialsDoubleSide;break;case BackSide$1:et=this.materialsBackSide;break;default:et=this.materials;break}this.originalMaterials.set(_e,_e.material),_e.isSkinnedMesh?_e.material=et[2]:_e.isInstancedMesh?_e.material=et[1]:_e.material=et[0],++this.meshCount}}}cloneMaterial(nt){if(!(nt instanceof ShaderMaterial$1))return nt.clone();const _e=nt.uniforms,et=new Map;for(const it in _e){const st=_e[it].value;st.isRenderTargetTexture&&(_e[it].value=null,et.set(it,st))}const rt=nt.clone();for(const it of et)_e[it[0]].value=it[1],rt.uniforms[it[0]].value=it[1];return rt}setMaterial(nt){if(this.disposeMaterials(),this.material=nt,nt!==null){const _e=this.materials=[this.cloneMaterial(nt),this.cloneMaterial(nt),this.cloneMaterial(nt)];for(const et of _e)et.uniforms=Object.assign({},nt.uniforms),et.side=FrontSide$1;_e[2].skinning=!0,this.materialsBackSide=_e.map(et=>{const rt=this.cloneMaterial(et);return rt.uniforms=Object.assign({},nt.uniforms),rt.side=BackSide$1,rt}),this.materialsDoubleSide=_e.map(et=>{const rt=this.cloneMaterial(et);return rt.uniforms=Object.assign({},nt.uniforms),rt.side=DoubleSide$1,rt}),this.materialsFlatShaded=_e.map(et=>{const rt=this.cloneMaterial(et);return rt.uniforms=Object.assign({},nt.uniforms),rt.flatShading=!0,rt}),this.materialsFlatShadedBackSide=_e.map(et=>{const rt=this.cloneMaterial(et);return rt.uniforms=Object.assign({},nt.uniforms),rt.flatShading=!0,rt.side=BackSide$1,rt}),this.materialsFlatShadedDoubleSide=_e.map(et=>{const rt=this.cloneMaterial(et);return rt.uniforms=Object.assign({},nt.uniforms),rt.flatShading=!0,rt.side=DoubleSide$1,rt})}}render(nt,_e,et){const rt=nt.shadowMap.enabled;if(nt.shadowMap.enabled=!1,workaroundEnabled){const it=this.originalMaterials;this.meshCount=0,_e.traverse(this.replaceMaterial),nt.render(_e,et);for(const st of it)st[0].material=st[1];this.meshCount!==it.size&&it.clear()}else{const it=_e.overrideMaterial;_e.overrideMaterial=this.material,nt.render(_e,et),_e.overrideMaterial=it}nt.shadowMap.enabled=rt}disposeMaterials(){if(this.material!==null){const nt=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const _e of nt)_e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return workaroundEnabled}static set workaroundEnabled(nt){workaroundEnabled=nt}},AUTO_SIZE=-1,Resolution=class extends EventDispatcher$1{constructor(nt,_e=AUTO_SIZE,et=AUTO_SIZE,rt=1){super(),this.resizable=nt,this.baseSize=new Vector2$1(1,1),this.preferredSize=new Vector2$1(_e,et),this.target=this.preferredSize,this.s=rt,this.effectiveSize=new Vector2$1,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const nt=this.baseSize,_e=this.preferredSize,et=this.effectiveSize,rt=this.scale;_e.width!==AUTO_SIZE?et.width=_e.width:_e.height!==AUTO_SIZE?et.width=Math.round(_e.height*(nt.width/Math.max(nt.height,1))):et.width=Math.round(nt.width*rt),_e.height!==AUTO_SIZE?et.height=_e.height:_e.width!==AUTO_SIZE?et.height=Math.round(_e.width/Math.max(nt.width/Math.max(nt.height,1),1)):et.height=Math.round(nt.height*rt)}get width(){return this.effectiveSize.width}set width(nt){this.preferredWidth=nt}get height(){return this.effectiveSize.height}set height(nt){this.preferredHeight=nt}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(nt){this.s!==nt&&(this.s=nt,this.preferredSize.setScalar(AUTO_SIZE),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(nt){this.scale=nt}get baseWidth(){return this.baseSize.width}set baseWidth(nt){this.baseSize.width!==nt&&(this.baseSize.width=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(nt){this.baseWidth=nt}get baseHeight(){return this.baseSize.height}set baseHeight(nt){this.baseSize.height!==nt&&(this.baseSize.height=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(nt){this.baseHeight=nt}setBaseSize(nt,_e){(this.baseSize.width!==nt||this.baseSize.height!==_e)&&(this.baseSize.set(nt,_e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(nt){this.preferredSize.width!==nt&&(this.preferredSize.width=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(nt){this.preferredWidth=nt}get preferredHeight(){return this.preferredSize.height}set preferredHeight(nt){this.preferredSize.height!==nt&&(this.preferredSize.height=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(nt){this.preferredHeight=nt}setPreferredSize(nt,_e){(this.preferredSize.width!==nt||this.preferredSize.height!==_e)&&(this.preferredSize.set(nt,_e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(nt){this.s=nt.scale,this.baseSize.set(nt.baseWidth,nt.baseHeight),this.preferredSize.set(nt.preferredWidth,nt.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return AUTO_SIZE}},BlendFunction={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},add_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",alpha_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",average_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",color_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",color_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",color_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",darken_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",difference_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",divide_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",exclusion_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",hard_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",hard_mix_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",hue_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",invert_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",invert_rgb_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",lighten_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",linear_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",linear_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",linear_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",luminosity_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",multiply_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",negation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",normal_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",overlay_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",pin_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",reflect_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",saturation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",screen_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",soft_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",src_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",subtract_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",vivid_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",blendFunctions=new Map([[BlendFunction.ADD,add_default],[BlendFunction.ALPHA,alpha_default],[BlendFunction.AVERAGE,average_default],[BlendFunction.COLOR,color_default],[BlendFunction.COLOR_BURN,color_burn_default],[BlendFunction.COLOR_DODGE,color_dodge_default],[BlendFunction.DARKEN,darken_default],[BlendFunction.DIFFERENCE,difference_default],[BlendFunction.DIVIDE,divide_default],[BlendFunction.DST,null],[BlendFunction.EXCLUSION,exclusion_default],[BlendFunction.HARD_LIGHT,hard_light_default],[BlendFunction.HARD_MIX,hard_mix_default],[BlendFunction.HUE,hue_default],[BlendFunction.INVERT,invert_default],[BlendFunction.INVERT_RGB,invert_rgb_default],[BlendFunction.LIGHTEN,lighten_default],[BlendFunction.LINEAR_BURN,linear_burn_default],[BlendFunction.LINEAR_DODGE,linear_dodge_default],[BlendFunction.LINEAR_LIGHT,linear_light_default],[BlendFunction.LUMINOSITY,luminosity_default],[BlendFunction.MULTIPLY,multiply_default],[BlendFunction.NEGATION,negation_default],[BlendFunction.NORMAL,normal_default],[BlendFunction.OVERLAY,overlay_default],[BlendFunction.PIN_LIGHT,pin_light_default],[BlendFunction.REFLECT,reflect_default],[BlendFunction.SATURATION,saturation_default],[BlendFunction.SCREEN,screen_default],[BlendFunction.SOFT_LIGHT,soft_light_default],[BlendFunction.SRC,src_default],[BlendFunction.SUBTRACT,subtract_default],[BlendFunction.VIVID_LIGHT,vivid_light_default]]),BlendMode=class extends EventDispatcher$1{constructor(nt,_e=1){super(),this._blendFunction=nt,this.opacity=new Uniform$1(_e)}getOpacity(){return this.opacity.value}setOpacity(nt){this.opacity.value=nt}get blendFunction(){return this._blendFunction}set blendFunction(nt){this._blendFunction=nt,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(nt){this.blendFunction=nt}getShaderCode(){return blendFunctions.get(this.blendFunction)}},KernelSize={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},convolution_kawase_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,convolution_kawase_default2="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",kernelPresets=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],KawaseBlurMaterial=class extends ShaderMaterial$1{constructor(nt=new Vector4$1){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Uniform$1(null),texelSize:new Uniform$1(new Vector4$1),scale:new Uniform$1(1),kernel:new Uniform$1(0)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_kawase_default,vertexShader:convolution_kawase_default2}),this.setTexelSize(nt.x,nt.y),this.kernelSize=KernelSize.MEDIUM}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.inputBuffer=nt}get kernelSequence(){return kernelPresets[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(nt){this.uniforms.scale.value=nt}getScale(){return this.uniforms.scale.value}setScale(nt){this.uniforms.scale.value=nt}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(nt){this.uniforms.kernel.value=nt}setKernel(nt){this.kernel=nt}setTexelSize(nt,_e){this.uniforms.texelSize.value.set(nt,_e,nt*.5,_e*.5)}setSize(nt,_e){const et=1/nt,rt=1/_e;this.uniforms.texelSize.value.set(et,rt,et*.5,rt*.5)}},KawaseBlurPass=class extends Pass{constructor({kernelSize:nt=KernelSize.MEDIUM,resolutionScale:_e=.5,width:et=Resolution.AUTO_SIZE,height:rt=Resolution.AUTO_SIZE,resolutionX:it=et,resolutionY:st=rt}={}){super("KawaseBlurPass"),this.renderTargetA=new WebGLRenderTarget$1(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const ot=this.resolution=new Resolution(this,it,st,_e);ot.addEventListener("change",at=>this.setSize(ot.baseWidth,ot.baseHeight)),this._blurMaterial=new KawaseBlurMaterial,this._blurMaterial.kernelSize=nt,this.copyMaterial=new CopyMaterial}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(nt){this._blurMaterial=nt}get dithering(){return this.copyMaterial.dithering}set dithering(nt){this.copyMaterial.dithering=nt}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(nt){this.blurMaterial.kernelSize=nt}get width(){return this.resolution.width}set width(nt){this.resolution.preferredWidth=nt}get height(){return this.resolution.height}set height(nt){this.resolution.preferredHeight=nt}get scale(){return this.blurMaterial.scale}set scale(nt){this.blurMaterial.scale=nt}getScale(){return this.blurMaterial.scale}setScale(nt){this.blurMaterial.scale=nt}getKernelSize(){return this.kernelSize}setKernelSize(nt){this.kernelSize=nt}getResolutionScale(){return this.resolution.scale}setResolutionScale(nt){this.resolution.scale=nt}render(nt,_e,et,rt,it){const st=this.scene,ot=this.camera,at=this.renderTargetA,lt=this.renderTargetB,ct=this.blurMaterial,ut=ct.kernelSequence;let ht=_e;this.fullscreenMaterial=ct;for(let dt=0,ft=ut.length;dt<ft;++dt){const pt=dt&1?lt:at;ct.kernel=ut[dt],ct.inputBuffer=ht.texture,nt.setRenderTarget(pt),nt.render(st,ot),ht=pt}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=ht.texture,nt.setRenderTarget(this.renderToScreen?null:et),nt.render(st,ot)}setSize(nt,_e){const et=this.resolution;et.setBaseSize(nt,_e);const rt=et.width,it=et.height;this.renderTargetA.setSize(rt,it),this.renderTargetB.setSize(rt,it),this.blurMaterial.setSize(nt,_e)}initialize(nt,_e,et){et!==void 0&&(this.renderTargetA.texture.type=et,this.renderTargetB.texture.type=et,et!==UnsignedByteType$1?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):nt!==null&&nt.outputColorSpace===SRGBColorSpace$2&&(this.renderTargetA.texture.colorSpace=SRGBColorSpace$2,this.renderTargetB.texture.colorSpace=SRGBColorSpace$2))}static get AUTO_SIZE(){return Resolution.AUTO_SIZE}},luminance_default=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,LuminanceMaterial=class extends ShaderMaterial$1{constructor(nt=!1,_e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:REVISION$1.replace(/\D+/g,"")},uniforms:{inputBuffer:new Uniform$1(null),threshold:new Uniform$1(0),smoothing:new Uniform$1(1),range:new Uniform$1(null)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:luminance_default,vertexShader:common_default}),this.colorOutput=nt,this.luminanceRange=_e}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}get threshold(){return this.uniforms.threshold.value}set threshold(nt){this.smoothing>0||nt>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=nt}getThreshold(){return this.threshold}setThreshold(nt){this.threshold=nt}get smoothing(){return this.uniforms.smoothing.value}set smoothing(nt){this.threshold>0||nt>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=nt}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(nt){this.smoothing=nt}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(nt){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(nt){nt?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(nt){return this.colorOutput}setColorOutputEnabled(nt){this.colorOutput=nt}get useRange(){return this.luminanceRange!==null}set useRange(nt){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(nt){nt!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=nt,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(nt){this.luminanceRange=nt}},LuminancePass=class extends Pass{constructor({renderTarget:nt,luminanceRange:_e,colorOutput:et,resolutionScale:rt=1,width:it=Resolution.AUTO_SIZE,height:st=Resolution.AUTO_SIZE,resolutionX:ot=it,resolutionY:at=st}={}){super("LuminancePass"),this.fullscreenMaterial=new LuminanceMaterial(et,_e),this.needsSwap=!1,this.renderTarget=nt,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget$1(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const lt=this.resolution=new Resolution(this,ot,at,rt);lt.addEventListener("change",ct=>this.setSize(lt.baseWidth,lt.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(nt,_e,et,rt,it){const st=this.fullscreenMaterial;st.inputBuffer=_e.texture,nt.setRenderTarget(this.renderToScreen?null:this.renderTarget),nt.render(this.scene,this.camera)}setSize(nt,_e){const et=this.resolution;et.setBaseSize(nt,_e),this.renderTarget.setSize(et.width,et.height)}initialize(nt,_e,et){et!==void 0&&et!==UnsignedByteType$1&&(this.renderTarget.texture.type=et,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},convolution_downsampling_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,convolution_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",DownsamplingMaterial=class extends ShaderMaterial$1{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Uniform$1(null),texelSize:new Uniform$1(new Vector2$1)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_downsampling_default,vertexShader:convolution_downsampling_default2})}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setSize(nt,_e){this.uniforms.texelSize.value.set(1/nt,1/_e)}},convolution_upsampling_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,convolution_upsampling_default2="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",UpsamplingMaterial=class extends ShaderMaterial$1{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Uniform$1(null),supportBuffer:new Uniform$1(null),texelSize:new Uniform$1(new Vector2$1),radius:new Uniform$1(.85)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_upsampling_default,vertexShader:convolution_upsampling_default2})}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}set supportBuffer(nt){this.uniforms.supportBuffer.value=nt}get radius(){return this.uniforms.radius.value}set radius(nt){this.uniforms.radius.value=nt}setSize(nt,_e){this.uniforms.texelSize.value.set(1/nt,1/_e)}},MipmapBlurPass=class extends Pass{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget$1(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new DownsamplingMaterial,this.upsamplingMaterial=new UpsamplingMaterial,this.resolution=new Vector2$1}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(nt){if(this.levels!==nt){const _e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let et=0;et<nt;++et){const rt=_e.clone();rt.texture.name="Downsampling.Mipmap"+et,this.downsamplingMipmaps.push(rt)}this.upsamplingMipmaps.push(_e);for(let et=1,rt=nt-1;et<rt;++et){const it=_e.clone();it.texture.name="Upsampling.Mipmap"+et,this.upsamplingMipmaps.push(it)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(nt){this.upsamplingMaterial.radius=nt}render(nt,_e,et,rt,it){const{scene:st,camera:ot}=this,{downsamplingMaterial:at,upsamplingMaterial:lt}=this,{downsamplingMipmaps:ct,upsamplingMipmaps:ut}=this;let ht=_e;this.fullscreenMaterial=at;for(let dt=0,ft=ct.length;dt<ft;++dt){const pt=ct[dt];at.setSize(ht.width,ht.height),at.inputBuffer=ht.texture,nt.setRenderTarget(pt),nt.render(st,ot),ht=pt}this.fullscreenMaterial=lt;for(let dt=ut.length-1;dt>=0;--dt){const ft=ut[dt];lt.setSize(ht.width,ht.height),lt.inputBuffer=ht.texture,lt.supportBuffer=ct[dt].texture,nt.setRenderTarget(ft),nt.render(st,ot),ht=ft}}setSize(nt,_e){const et=this.resolution;et.set(nt,_e);let rt=et.width,it=et.height;for(let st=0,ot=this.downsamplingMipmaps.length;st<ot;++st)rt=Math.round(rt*.5),it=Math.round(it*.5),this.downsamplingMipmaps[st].setSize(rt,it),st<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[st].setSize(rt,it)}initialize(nt,_e,et){if(et!==void 0){const rt=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const it of rt)it.texture.type=et;if(et!==UnsignedByteType$1)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(nt!==null&&nt.outputColorSpace===SRGBColorSpace$2)for(const it of rt)it.texture.colorSpace=SRGBColorSpace$2}}dispose(){super.dispose();for(const nt of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))nt.dispose()}},Effect=class extends EventDispatcher$1{constructor(nt,_e,{attributes:et=EffectAttribute.NONE,blendFunction:rt=BlendFunction.NORMAL,defines:it=new Map,uniforms:st=new Map,extensions:ot=null,vertexShader:at=null}={}){super(),this.name=nt,this.renderer=null,this.attributes=et,this.fragmentShader=_e,this.vertexShader=at,this.defines=it,this.uniforms=st,this.extensions=ot,this.blendMode=new BlendMode(rt),this.blendMode.addEventListener("change",lt=>this.setChanged()),this._inputColorSpace=LinearSRGBColorSpace$2,this._outputColorSpace=NoColorSpace$1}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(nt){this._inputColorSpace=nt,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(nt){this._outputColorSpace=nt,this.setChanged()}set mainScene(nt){}set mainCamera(nt){}getName(){return this.name}setRenderer(nt){this.renderer=nt}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(nt){this.attributes=nt,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(nt){this.fragmentShader=nt,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(nt){this.vertexShader=nt,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(nt,_e=BasicDepthPacking){}update(nt,_e,et){}setSize(nt,_e){}initialize(nt,_e,et){}dispose(){for(const nt of Object.keys(this)){const _e=this[nt];(_e instanceof WebGLRenderTarget$1||_e instanceof Material$1||_e instanceof Texture$1||_e instanceof Pass)&&this[nt].dispose()}}},bloom_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,BloomEffect=class extends Effect{constructor({blendFunction:nt=BlendFunction.SCREEN,luminanceThreshold:_e=.9,luminanceSmoothing:et=.025,mipmapBlur:rt=!1,intensity:it=1,radius:st=.85,levels:ot=8,kernelSize:at=KernelSize.LARGE,resolutionScale:lt=.5,width:ct=Resolution.AUTO_SIZE,height:ut=Resolution.AUTO_SIZE,resolutionX:ht=ct,resolutionY:dt=ut}={}){super("BloomEffect",bloom_default,{blendFunction:nt,uniforms:new Map([["map",new Uniform$1(null)],["intensity",new Uniform$1(it)]])}),this.renderTarget=new WebGLRenderTarget$1(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new KawaseBlurPass({kernelSize:at}),this.luminancePass=new LuminancePass({colorOutput:!0}),this.luminanceMaterial.threshold=_e,this.luminanceMaterial.smoothing=et,this.mipmapBlurPass=new MipmapBlurPass,this.mipmapBlurPass.enabled=rt,this.mipmapBlurPass.radius=st,this.mipmapBlurPass.levels=ot,this.uniforms.get("map").value=rt?this.mipmapBlurPass.texture:this.renderTarget.texture;const ft=this.resolution=new Resolution(this,ht,dt,lt);ft.addEventListener("change",pt=>this.setSize(ft.baseWidth,ft.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(nt){this.resolution.preferredWidth=nt}get height(){return this.resolution.height}set height(nt){this.resolution.preferredHeight=nt}get dithering(){return this.blurPass.dithering}set dithering(nt){this.blurPass.dithering=nt}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(nt){this.blurPass.kernelSize=nt}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(nt){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(nt){this.uniforms.get("intensity").value=nt}getIntensity(){return this.intensity}setIntensity(nt){this.intensity=nt}getResolutionScale(){return this.resolution.scale}setResolutionScale(nt){this.resolution.scale=nt}update(nt,_e,et){const rt=this.renderTarget,it=this.luminancePass;it.enabled?(it.render(nt,_e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(nt,it.renderTarget):this.blurPass.render(nt,it.renderTarget,rt)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(nt,_e):this.blurPass.render(nt,_e,rt)}setSize(nt,_e){const et=this.resolution;et.setBaseSize(nt,_e),this.renderTarget.setSize(et.width,et.height),this.blurPass.resolution.copy(et),this.luminancePass.setSize(nt,_e),this.mipmapBlurPass.setSize(nt,_e)}initialize(nt,_e,et){this.blurPass.initialize(nt,_e,et),this.luminancePass.initialize(nt,_e,et),this.mipmapBlurPass.initialize(nt,_e,et),et!==void 0&&(this.renderTarget.texture.type=et,nt!==null&&nt.outputColorSpace===SRGBColorSpace$2&&(this.renderTarget.texture.colorSpace=SRGBColorSpace$2))}},ColorChannel={RED:0,GREEN:1,BLUE:2,ALPHA:3},MaskFunction={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2,MULTIPLY_RGB:3},convolution_bokeh_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 cocNearFar=texture2D(cocBuffer,vUv).rg*scale;float coc=cocNearFar.x;
#else
float coc=texture2D(cocBuffer,vUv).g*scale;
#endif
if(coc==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(cocNearFar.x,cocNearFar.y);
#else
vec2 step=texelSize*coc;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,BokehMaterial=class extends ShaderMaterial$1{constructor(nt=!1,_e=!1){super({name:"BokehMaterial",defines:{PASS:nt?"2":"1"},uniforms:{inputBuffer:new Uniform$1(null),cocBuffer:new Uniform$1(null),texelSize:new Uniform$1(new Vector2$1),kernel64:new Uniform$1(null),kernel16:new Uniform$1(null),scale:new Uniform$1(1)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_bokeh_default,vertexShader:common_default}),_e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}set cocBuffer(nt){this.uniforms.cocBuffer.value=nt}setCoCBuffer(nt){this.uniforms.cocBuffer.value=nt}get scale(){return this.uniforms.scale.value}set scale(nt){this.uniforms.scale.value=nt}getScale(nt){return this.scale}setScale(nt){this.scale=nt}generateKernel(){const nt=2.39996323,_e=new Float64Array(128),et=new Float64Array(32);let rt=0,it=0;for(let st=0,ot=Math.sqrt(80);st<80;++st){const at=st*nt,lt=Math.sqrt(st)/ot,ct=lt*Math.cos(at),ut=lt*Math.sin(at);st%5===0?(et[it++]=ct,et[it++]=ut):(_e[rt++]=ct,_e[rt++]=ut)}this.uniforms.kernel64.value=_e,this.uniforms.kernel16.value=et}setTexelSize(nt,_e){this.uniforms.texelSize.value.set(nt,_e)}setSize(nt,_e){this.uniforms.texelSize.value.set(1/nt,1/_e)}};function orthographicDepthToViewZ(nt,_e,et){return nt*(_e-et)-_e}function viewZToOrthographicDepth(nt,_e,et){return Math.min(Math.max((nt+_e)/(_e-et),0),1)}var circle_of_confusion_default=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#ifdef LOG_DEPTH
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#endif
return depth;}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,CircleOfConfusionMaterial=class extends ShaderMaterial$1{constructor(nt){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Uniform$1(null),focusDistance:new Uniform$1(0),focusRange:new Uniform$1(0),cameraNear:new Uniform$1(.3),cameraFar:new Uniform$1(1e3)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:circle_of_confusion_default,vertexShader:common_default}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(nt)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(nt){this.uniforms.depthBuffer.value=nt}set depthPacking(nt){this.defines.DEPTH_PACKING=nt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(nt,_e=BasicDepthPacking){this.depthBuffer=nt,this.depthPacking=_e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(nt){this.uniforms.focusDistance.value=nt}get worldFocusDistance(){return-orthographicDepthToViewZ(this.focusDistance,this.near,this.far)}set worldFocusDistance(nt){this.focusDistance=viewZToOrthographicDepth(-nt,this.near,this.far)}getFocusDistance(nt){this.uniforms.focusDistance.value=nt}setFocusDistance(nt){this.uniforms.focusDistance.value=nt}get focalLength(){return this.focusRange}set focalLength(nt){this.focusRange=nt}get focusRange(){return this.uniforms.focusRange.value}set focusRange(nt){this.uniforms.focusRange.value=nt}get worldFocusRange(){return-orthographicDepthToViewZ(this.focusRange,this.near,this.far)}set worldFocusRange(nt){this.focusRange=viewZToOrthographicDepth(-nt,this.near,this.far)}getFocalLength(nt){return this.focusRange}setFocalLength(nt){this.focusRange=nt}adoptCameraSettings(nt){this.copyCameraSettings(nt)}copyCameraSettings(nt){nt&&(this.uniforms.cameraNear.value=nt.near,this.uniforms.cameraFar.value=nt.far,nt instanceof PerspectiveCamera$2?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},mask_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 3
vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=vec4(mask*texel.rgb,texel.a);
#elif MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,MaskMaterial=class extends ShaderMaterial$1{constructor(nt=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Uniform$1(nt),inputBuffer:new Uniform$1(null),strength:new Uniform$1(1)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:mask_default,vertexShader:common_default}),this.colorChannel=ColorChannel.RED,this.maskFunction=MaskFunction.DISCARD}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}set maskTexture(nt){this.uniforms.maskTexture.value=nt,delete this.defines.MASK_PRECISION_HIGH,nt.type!==UnsignedByteType$1&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(nt){this.maskTexture=nt}set colorChannel(nt){this.defines.COLOR_CHANNEL=nt.toFixed(0),this.needsUpdate=!0}setColorChannel(nt){this.colorChannel=nt}set maskFunction(nt){this.defines.MASK_FUNCTION=nt.toFixed(0),this.needsUpdate=!0}setMaskFunction(nt){this.maskFunction=nt}get inverted(){return this.defines.INVERTED!==void 0}set inverted(nt){this.inverted&&!nt?delete this.defines.INVERTED:nt&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(nt){this.inverted=nt}get strength(){return this.uniforms.strength.value}set strength(nt){this.uniforms.strength.value=nt}getStrength(){return this.strength}setStrength(nt){this.strength=nt}},ShaderPass=class extends Pass{constructor(nt,_e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=nt,this.input=_e}setInput(nt){this.input=nt}render(nt,_e,et,rt,it){const st=this.fullscreenMaterial.uniforms;_e!==null&&st!==void 0&&st[this.input]!==void 0&&(st[this.input].value=_e.texture),nt.setRenderTarget(this.renderToScreen?null:et),nt.render(this.scene,this.camera)}initialize(nt,_e,et){et!==void 0&&et!==UnsignedByteType$1&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},depth_of_field_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform lowp sampler2D farCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);
#if MASK_FUNCTION == 1
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,colorFar.a);cocNearFar.x=min(cocNearFar.x*scale,1.0);
#else
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,texture2D(farCoCBuffer,uv).g);cocNearFar=min(cocNearFar*scale,1.0);
#endif
vec4 result=inputColor*(1.0-cocNearFar.y)+colorFar;result=mix(result,colorNear,cocNearFar.x);outputColor=result;}`,DepthOfFieldEffect=class extends Effect{constructor(nt,{blendFunction:_e,worldFocusDistance:et,worldFocusRange:rt,focusDistance:it=0,focalLength:st=.1,focusRange:ot=st,bokehScale:at=1,resolutionScale:lt=1,width:ct=Resolution.AUTO_SIZE,height:ut=Resolution.AUTO_SIZE,resolutionX:ht=ct,resolutionY:dt=ut}={}){super("DepthOfFieldEffect",depth_of_field_default,{blendFunction:_e,attributes:EffectAttribute.DEPTH,uniforms:new Map([["nearColorBuffer",new Uniform$1(null)],["farColorBuffer",new Uniform$1(null)],["nearCoCBuffer",new Uniform$1(null)],["farCoCBuffer",new Uniform$1(null)],["scale",new Uniform$1(1)]])}),this.camera=nt,this.renderTarget=new WebGLRenderTarget$1(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.uniforms.get("farCoCBuffer").value=this.renderTargetCoC.texture,this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new ShaderPass(new CircleOfConfusionMaterial(nt));const ft=this.cocMaterial;ft.focusDistance=it,ft.focusRange=ot,et!==void 0&&(ft.worldFocusDistance=et),rt!==void 0&&(ft.worldFocusRange=rt),this.blurPass=new KawaseBlurPass({resolutionScale:lt,resolutionX:ht,resolutionY:dt,kernelSize:KernelSize.MEDIUM}),this.maskPass=new ShaderPass(new MaskMaterial(this.renderTargetCoC.texture));const pt=this.maskPass.fullscreenMaterial;pt.colorChannel=ColorChannel.GREEN,this.maskFunction=MaskFunction.MULTIPLY_RGB,this.bokehNearBasePass=new ShaderPass(new BokehMaterial(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new ShaderPass(new BokehMaterial(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new ShaderPass(new BokehMaterial(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new ShaderPass(new BokehMaterial(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const mt=this.resolution=new Resolution(this,ht,dt,lt);mt.addEventListener("change",At=>this.setSize(mt.baseWidth,mt.baseHeight)),this.bokehScale=at}set mainCamera(nt){this.camera=nt,this.cocMaterial.copyCameraSettings(nt)}get cocTexture(){return this.renderTargetCoC.texture}get maskFunction(){return this.maskPass.fullscreenMaterial.maskFunction}set maskFunction(nt){this.maskFunction!==nt&&(this.defines.set("MASK_FUNCTION",nt.toFixed(0)),this.maskPass.fullscreenMaterial.maskFunction=nt,this.setChanged())}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.cocMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(nt){this.bokehNearBasePass.fullscreenMaterial.scale=nt,this.bokehNearFillPass.fullscreenMaterial.scale=nt,this.bokehFarBasePass.fullscreenMaterial.scale=nt,this.bokehFarFillPass.fullscreenMaterial.scale=nt,this.maskPass.fullscreenMaterial.strength=nt,this.uniforms.get("scale").value=nt}getBokehScale(){return this.bokehScale}setBokehScale(nt){this.bokehScale=nt}getTarget(){return this.target}setTarget(nt){this.target=nt}calculateFocusDistance(nt){const _e=this.camera,et=_e.position.distanceTo(nt);return viewZToOrthographicDepth(-et,_e.near,_e.far)}setDepthTexture(nt,_e=BasicDepthPacking){this.cocMaterial.depthBuffer=nt,this.cocMaterial.depthPacking=_e}update(nt,_e,et){const rt=this.renderTarget,it=this.renderTargetCoC,st=this.renderTargetCoCBlurred,ot=this.renderTargetMasked;if(this.target!==null){const at=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=at}this.cocPass.render(nt,null,it),this.blurPass.render(nt,it,st),this.maskPass.render(nt,_e,ot),this.bokehFarBasePass.render(nt,ot,rt),this.bokehFarFillPass.render(nt,rt,this.renderTargetFar),this.bokehNearBasePass.render(nt,_e,rt),this.bokehNearFillPass.render(nt,rt,this.renderTargetNear)}setSize(nt,_e){const et=this.resolution;et.setBaseSize(nt,_e);const rt=et.width,it=et.height;this.cocPass.setSize(nt,_e),this.blurPass.setSize(nt,_e),this.maskPass.setSize(nt,_e),this.renderTargetFar.setSize(nt,_e),this.renderTargetCoC.setSize(nt,_e),this.renderTargetMasked.setSize(nt,_e),this.renderTarget.setSize(rt,it),this.renderTargetNear.setSize(rt,it),this.renderTargetCoCBlurred.setSize(rt,it),this.bokehNearBasePass.fullscreenMaterial.setSize(nt,_e),this.bokehNearFillPass.fullscreenMaterial.setSize(nt,_e),this.bokehFarBasePass.fullscreenMaterial.setSize(nt,_e),this.bokehFarFillPass.fullscreenMaterial.setSize(nt,_e)}initialize(nt,_e,et){this.cocPass.initialize(nt,_e,et),this.maskPass.initialize(nt,_e,et),this.bokehNearBasePass.initialize(nt,_e,et),this.bokehNearFillPass.initialize(nt,_e,et),this.bokehFarBasePass.initialize(nt,_e,et),this.bokehFarFillPass.initialize(nt,_e,et),this.blurPass.initialize(nt,_e,UnsignedByteType$1),nt.capabilities.logarithmicDepthBuffer&&(this.cocPass.fullscreenMaterial.defines.LOG_DEPTH="1"),et!==void 0&&(this.renderTarget.texture.type=et,this.renderTargetNear.texture.type=et,this.renderTargetFar.texture.type=et,this.renderTargetMasked.texture.type=et,nt!==null&&nt.outputColorSpace===SRGBColorSpace$2&&(this.renderTarget.texture.colorSpace=SRGBColorSpace$2,this.renderTargetNear.texture.colorSpace=SRGBColorSpace$2,this.renderTargetFar.texture.colorSpace=SRGBColorSpace$2,this.renderTargetMasked.texture.colorSpace=SRGBColorSpace$2))}},RenderPass=class extends Pass{constructor(nt,_e,et=null){super("RenderPass",nt,_e),this.needsSwap=!1,this.clearPass=new ClearPass,this.overrideMaterialManager=et===null?null:new OverrideMaterialManager(et),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(nt){this.scene=nt}set mainCamera(nt){this.camera=nt}get renderToScreen(){return super.renderToScreen}set renderToScreen(nt){super.renderToScreen=nt,this.clearPass.renderToScreen=nt}get overrideMaterial(){const nt=this.overrideMaterialManager;return nt!==null?nt.material:null}set overrideMaterial(nt){const _e=this.overrideMaterialManager;nt!==null?_e!==null?_e.setMaterial(nt):this.overrideMaterialManager=new OverrideMaterialManager(nt):_e!==null&&(_e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(nt){this.overrideMaterial=nt}get clear(){return this.clearPass.enabled}set clear(nt){this.clearPass.enabled=nt}getSelection(){return this.selection}setSelection(nt){this.selection=nt}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(nt){this.ignoreBackground=nt}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(nt){this.skipShadowMapUpdate=nt}getClearPass(){return this.clearPass}render(nt,_e,et,rt,it){const st=this.scene,ot=this.camera,at=this.selection,lt=ot.layers.mask,ct=st.background,ut=nt.shadowMap.autoUpdate,ht=this.renderToScreen?null:_e;at!==null&&ot.layers.set(at.getLayer()),this.skipShadowMapUpdate&&(nt.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(st.background=null),this.clearPass.enabled&&this.clearPass.render(nt,_e),nt.setRenderTarget(ht),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(nt,st,ot):nt.render(st,ot),ot.layers.mask=lt,st.background=ct,nt.shadowMap.autoUpdate=ut}},depth_downsampling_default=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,depth_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",DepthDownsamplingMaterial=class extends ShaderMaterial$1{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Uniform$1(null),normalBuffer:new Uniform$1(null),texelSize:new Uniform$1(new Vector2$1)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:depth_downsampling_default,vertexShader:depth_downsampling_default2})}set depthBuffer(nt){this.uniforms.depthBuffer.value=nt}set depthPacking(nt){this.defines.DEPTH_PACKING=nt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(nt,_e=BasicDepthPacking){this.depthBuffer=nt,this.depthPacking=_e}set normalBuffer(nt){this.uniforms.normalBuffer.value=nt,nt!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(nt){this.normalBuffer=nt}setTexelSize(nt,_e){this.uniforms.texelSize.value.set(nt,_e)}setSize(nt,_e){this.uniforms.texelSize.value.set(1/nt,1/_e)}},DepthDownsamplingPass=class extends Pass{constructor({normalBuffer:nt=null,resolutionScale:_e=.5,width:et=Resolution.AUTO_SIZE,height:rt=Resolution.AUTO_SIZE,resolutionX:it=et,resolutionY:st=rt}={}){super("DepthDownsamplingPass");const ot=new DepthDownsamplingMaterial;ot.normalBuffer=nt,this.fullscreenMaterial=ot,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget$1(1,1,{minFilter:NearestFilter$1,magFilter:NearestFilter$1,depthBuffer:!1,type:FloatType$1}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const at=this.resolution=new Resolution(this,it,st,_e);at.addEventListener("change",lt=>this.setSize(at.baseWidth,at.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(nt,_e=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=nt,this.fullscreenMaterial.depthPacking=_e}render(nt,_e,et,rt,it){nt.setRenderTarget(this.renderToScreen?null:this.renderTarget),nt.render(this.scene,this.camera)}setSize(nt,_e){const et=this.resolution;et.setBaseSize(nt,_e),this.renderTarget.setSize(et.width,et.height),this.fullscreenMaterial.setSize(nt,_e)}initialize(nt,_e,et){const rt=nt.getContext();if(!(rt.getExtension("EXT_color_buffer_float")||rt.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},effect_default=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,effect_default2="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",EffectMaterial=class extends ShaderMaterial$1{constructor(nt,_e,et,rt,it=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:REVISION$1.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Uniform$1(null),depthBuffer:new Uniform$1(null),resolution:new Uniform$1(new Vector2$1),texelSize:new Uniform$1(new Vector2$1),cameraNear:new Uniform$1(.3),cameraFar:new Uniform$1(1e3),aspect:new Uniform$1(1),time:new Uniform$1(0)},blending:NoBlending$1,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:it}),nt&&this.setShaderParts(nt),_e&&this.setDefines(_e),et&&this.setUniforms(et),this.copyCameraSettings(rt)}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(nt){this.uniforms.depthBuffer.value=nt}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(nt){this.defines.DEPTH_PACKING=nt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(nt,_e=BasicDepthPacking){this.depthBuffer=nt,this.depthPacking=_e}setShaderData(nt){this.setShaderParts(nt.shaderParts),this.setDefines(nt.defines),this.setUniforms(nt.uniforms),this.setExtensions(nt.extensions)}setShaderParts(nt){return this.fragmentShader=effect_default.replace(EffectShaderSection.FRAGMENT_HEAD,nt.get(EffectShaderSection.FRAGMENT_HEAD)||"").replace(EffectShaderSection.FRAGMENT_MAIN_UV,nt.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"").replace(EffectShaderSection.FRAGMENT_MAIN_IMAGE,nt.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=effect_default2.replace(EffectShaderSection.VERTEX_HEAD,nt.get(EffectShaderSection.VERTEX_HEAD)||"").replace(EffectShaderSection.VERTEX_MAIN_SUPPORT,nt.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(nt){for(const _e of nt.entries())this.defines[_e[0]]=_e[1];return this.needsUpdate=!0,this}setUniforms(nt){for(const _e of nt.entries())this.uniforms[_e[0]]=_e[1];return this}setExtensions(nt){this.extensions={};for(const _e of nt)this.extensions[_e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(nt){this.encodeOutput!==nt&&(nt?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(nt){return this.encodeOutput}setOutputEncodingEnabled(nt){this.encodeOutput=nt}get time(){return this.uniforms.time.value}set time(nt){this.uniforms.time.value=nt}setDeltaTime(nt){this.uniforms.time.value+=nt}adoptCameraSettings(nt){this.copyCameraSettings(nt)}copyCameraSettings(nt){nt&&(this.uniforms.cameraNear.value=nt.near,this.uniforms.cameraFar.value=nt.far,nt instanceof PerspectiveCamera$2?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(nt,_e){const et=this.uniforms;et.resolution.value.set(nt,_e),et.texelSize.value.set(1/nt,1/_e),et.aspect.value=nt/_e}static get Section(){return EffectShaderSection}};function prefixSubstrings(nt,_e,et){for(const rt of _e){const it="$1"+nt+rt.charAt(0).toUpperCase()+rt.slice(1),st=new RegExp("([^\\.])(\\b"+rt+"\\b)","g");for(const ot of et.entries())ot[1]!==null&&et.set(ot[0],ot[1].replace(st,it))}}function integrateEffect(nt,_e,et){let rt=_e.getFragmentShader(),it=_e.getVertexShader();const st=rt!==void 0&&/mainImage/.test(rt),ot=rt!==void 0&&/mainUv/.test(rt);if(et.attributes|=_e.getAttributes(),rt===void 0)throw new Error(`Missing fragment shader (${_e.name})`);if(ot&&et.attributes&EffectAttribute.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${_e.name})`);if(!st&&!ot)throw new Error(`Could not find mainImage or mainUv function (${_e.name})`);{const at=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,lt=et.shaderParts;let ct=lt.get(EffectShaderSection.FRAGMENT_HEAD)||"",ut=lt.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"",ht=lt.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||"",dt=lt.get(EffectShaderSection.VERTEX_HEAD)||"",ft=lt.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||"";const pt=new Set,mt=new Set;if(ot&&(ut+=`	${nt}MainUv(UV);
`,et.uvTransformation=!0),it!==null&&/mainSupport/.test(it)){const bt=/mainSupport *\([\w\s]*?uv\s*?\)/.test(it);ft+=`	${nt}MainSupport(`,ft+=bt?`vUv);
`:`);
`;for(const Tt of it.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const wt of Tt[1].split(/\s*,\s*/))et.varyings.add(wt),pt.add(wt),mt.add(wt);for(const Tt of it.matchAll(at))mt.add(Tt[1])}for(const bt of rt.matchAll(at))mt.add(bt[1]);for(const bt of _e.defines.keys())mt.add(bt.replace(/\([\w\s,]*\)/g,""));for(const bt of _e.uniforms.keys())mt.add(bt);mt.delete("while"),mt.delete("for"),mt.delete("if"),_e.uniforms.forEach((bt,Tt)=>et.uniforms.set(nt+Tt.charAt(0).toUpperCase()+Tt.slice(1),bt)),_e.defines.forEach((bt,Tt)=>et.defines.set(nt+Tt.charAt(0).toUpperCase()+Tt.slice(1),bt));const At=new Map([["fragment",rt],["vertex",it]]);prefixSubstrings(nt,mt,et.defines),prefixSubstrings(nt,mt,At),rt=At.get("fragment"),it=At.get("vertex");const gt=_e.blendMode;if(et.blendModes.set(gt.blendFunction,gt),st){_e.inputColorSpace!==null&&_e.inputColorSpace!==et.colorSpace&&(ht+=_e.inputColorSpace===SRGBColorSpace$2?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),_e.outputColorSpace!==NoColorSpace$1?et.colorSpace=_e.outputColorSpace:_e.inputColorSpace!==null&&(et.colorSpace=_e.inputColorSpace);const bt=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;ht+=`${nt}MainImage(color0, UV, `,et.attributes&EffectAttribute.DEPTH&&bt.test(rt)&&(ht+="depth, ",et.readDepth=!0),ht+=`color1);
	`;const Tt=nt+"BlendOpacity";et.uniforms.set(Tt,gt.opacity),ht+=`color0 = blend${gt.blendFunction}(color0, color1, ${Tt});

	`,ct+=`uniform float ${Tt};

`}if(ct+=rt+`
`,it!==null&&(dt+=it+`
`),lt.set(EffectShaderSection.FRAGMENT_HEAD,ct),lt.set(EffectShaderSection.FRAGMENT_MAIN_UV,ut),lt.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,ht),lt.set(EffectShaderSection.VERTEX_HEAD,dt),lt.set(EffectShaderSection.VERTEX_MAIN_SUPPORT,ft),_e.extensions!==null)for(const bt of _e.extensions)et.extensions.add(bt)}}var EffectPass=class extends Pass{constructor(nt,..._e){super("EffectPass"),this.fullscreenMaterial=new EffectMaterial(null,null,null,nt),this.listener=et=>this.handleEvent(et),this.effects=[],this.setEffects(_e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(nt){for(const _e of this.effects)_e.mainScene=nt}set mainCamera(nt){this.fullscreenMaterial.copyCameraSettings(nt);for(const _e of this.effects)_e.mainCamera=nt}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(nt){this.fullscreenMaterial.encodeOutput=nt}get dithering(){return this.fullscreenMaterial.dithering}set dithering(nt){const _e=this.fullscreenMaterial;_e.dithering=nt,_e.needsUpdate=!0}setEffects(nt){for(const _e of this.effects)_e.removeEventListener("change",this.listener);this.effects=nt.sort((_e,et)=>et.attributes-_e.attributes);for(const _e of this.effects)_e.addEventListener("change",this.listener)}updateMaterial(){const nt=new EffectShaderData;let _e=0;for(const ot of this.effects)if(ot.blendMode.blendFunction===BlendFunction.DST)nt.attributes|=ot.getAttributes()&EffectAttribute.DEPTH;else{if(nt.attributes&ot.getAttributes()&EffectAttribute.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${ot.name})`);integrateEffect("e"+_e++,ot,nt)}let et=nt.shaderParts.get(EffectShaderSection.FRAGMENT_HEAD),rt=nt.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE),it=nt.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_UV);const st=/\bblend\b/g;for(const ot of nt.blendModes.values())et+=ot.getShaderCode().replace(st,`blend${ot.blendFunction}`)+`
`;nt.attributes&EffectAttribute.DEPTH?(nt.readDepth&&(rt=`float depth = readDepth(UV);

	`+rt),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,nt.colorSpace===SRGBColorSpace$2&&(rt+=`color0 = sRGBToLinear(color0);
	`),nt.uvTransformation?(it=`vec2 transformedUv = vUv;
`+it,nt.defines.set("UV","transformedUv")):nt.defines.set("UV","vUv"),nt.shaderParts.set(EffectShaderSection.FRAGMENT_HEAD,et),nt.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,rt),nt.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_UV,it);for(const[ot,at]of nt.shaderParts)at!==null&&nt.shaderParts.set(ot,at.trim().replace(/^#/,`
#`));this.skipRendering=_e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(nt)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(nt,_e=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=nt,this.fullscreenMaterial.depthPacking=_e;for(const et of this.effects)et.setDepthTexture(nt,_e)}render(nt,_e,et,rt,it){for(const st of this.effects)st.update(nt,_e,rt);if(!this.skipRendering||this.renderToScreen){const st=this.fullscreenMaterial;st.inputBuffer=_e.texture,st.time+=rt*this.timeScale,nt.setRenderTarget(this.renderToScreen?null:et),nt.render(this.scene,this.camera)}}setSize(nt,_e){this.fullscreenMaterial.setSize(nt,_e);for(const et of this.effects)et.setSize(nt,_e)}initialize(nt,_e,et){this.renderer=nt;for(const rt of this.effects)rt.initialize(nt,_e,et);this.updateMaterial(),et!==void 0&&et!==UnsignedByteType$1&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const nt of this.effects)nt.removeEventListener("change",this.listener),nt.dispose()}handleEvent(nt){switch(nt.type){case"change":this.recompile();break}}},NormalPass=class extends Pass{constructor(nt,_e,{renderTarget:et,resolutionScale:rt=1,width:it=Resolution.AUTO_SIZE,height:st=Resolution.AUTO_SIZE,resolutionX:ot=it,resolutionY:at=st}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new RenderPass(nt,_e,new MeshNormalMaterial$1);const lt=this.renderPass;lt.ignoreBackground=!0,lt.skipShadowMapUpdate=!0;const ct=lt.getClearPass();ct.overrideClearColor=new Color$2(7829503),ct.overrideClearAlpha=1,this.renderTarget=et,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget$1(1,1,{minFilter:NearestFilter$1,magFilter:NearestFilter$1}),this.renderTarget.texture.name="NormalPass.Target");const ut=this.resolution=new Resolution(this,ot,at,rt);ut.addEventListener("change",ht=>this.setSize(ut.baseWidth,ut.baseHeight))}set mainScene(nt){this.renderPass.mainScene=nt}set mainCamera(nt){this.renderPass.mainCamera=nt}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(nt){this.resolution.scale=nt}render(nt,_e,et,rt,it){const st=this.renderToScreen?null:this.renderTarget;this.renderPass.render(nt,st,st)}setSize(nt,_e){const et=this.resolution;et.setBaseSize(nt,_e),this.renderTarget.setSize(et.width,et.height)}};const EffectComposerContext=reactExports.createContext(null),isConvolution=nt=>(nt.getAttributes()&EffectAttribute.CONVOLUTION)===EffectAttribute.CONVOLUTION,EffectComposer=React.memo(reactExports.forwardRef(({children:nt,camera:_e,scene:et,resolutionScale:rt,enabled:it=!0,renderPriority:st=1,autoClear:ot=!0,depthBuffer:at,enableNormalPass:lt,stencilBuffer:ct,multisampling:ut=8,frameBufferType:ht=HalfFloatType$1},dt)=>{const{gl:ft,scene:pt,camera:mt,size:At}=useThree(),gt=et||pt,bt=_e||mt,[Tt,wt,Rt]=reactExports.useMemo(()=>{const kt=isWebGL2Available(),Dt=new EffectComposer$1(ft,{depthBuffer:at,stencilBuffer:ct,multisampling:ut>0&&kt?ut:0,frameBufferType:ht});Dt.addPass(new RenderPass(gt,bt));let Ot=null,zt=null;return lt&&(zt=new NormalPass(gt,bt),zt.enabled=!1,Dt.addPass(zt),rt!==void 0&&kt&&(Ot=new DepthDownsamplingPass({normalBuffer:zt.texture,resolutionScale:rt}),Ot.enabled=!1,Dt.addPass(Ot))),[Dt,zt,Ot]},[bt,ft,at,ct,ut,ht,gt,lt,rt]);reactExports.useEffect(()=>Tt==null?void 0:Tt.setSize(At.width,At.height),[Tt,At]),useFrame((kt,Dt)=>{if(it){const Ot=ft.autoClear;ft.autoClear=ot,ct&&!ot&&ft.clearStencil(),Tt.render(Dt),ft.autoClear=Ot}},it?st:0);const It=reactExports.useRef(null),Lt=useInstanceHandle(It);reactExports.useLayoutEffect(()=>{const kt=[];if(It.current&&Lt.current&&Tt){const Dt=Lt.current.objects;for(let Ot=0;Ot<Dt.length;Ot++){const zt=Dt[Ot];if(zt instanceof Effect){const Ht=[zt];if(!isConvolution(zt)){let Xt=null;for(;(Xt=Dt[Ot+1])instanceof Effect&&!isConvolution(Xt);)Ht.push(Xt),Ot++}const Yt=new EffectPass(bt,...Ht);kt.push(Yt)}else zt instanceof Pass&&kt.push(zt)}for(const Ot of kt)Tt==null||Tt.addPass(Ot);wt&&(wt.enabled=!0),Rt&&(Rt.enabled=!0)}return()=>{for(const Dt of kt)Tt==null||Tt.removePass(Dt);wt&&(wt.enabled=!1),Rt&&(Rt.enabled=!1)}},[Tt,nt,bt,wt,Rt,Lt]),reactExports.useEffect(()=>{const kt=ft.toneMapping;return ft.toneMapping=NoToneMapping$1,()=>{ft.toneMapping=kt}},[]);const $t=reactExports.useMemo(()=>({composer:Tt,normalPass:wt,downSamplingPass:Rt,resolutionScale:rt,camera:bt,scene:gt}),[Tt,wt,Rt,rt,bt,gt]);return reactExports.useImperativeHandle(dt,()=>Tt,[Tt]),jsxRuntimeExports.jsx(EffectComposerContext.Provider,{value:$t,children:jsxRuntimeExports.jsx("group",{ref:It,children:nt})})}));let i=0;const components=new WeakMap,wrapEffect=(nt,_e)=>React.forwardRef(function({blendFunction:rt=_e==null?void 0:_e.blendFunction,opacity:it=_e==null?void 0:_e.opacity,...st},ot){let at=components.get(nt);if(!at){const ut=`@react-three/postprocessing/${nt.name}-${i++}`;extend$1({[ut]:nt}),components.set(nt,at=ut)}const lt=useThree(ut=>ut.camera),ct=React.useMemo(()=>{var ut,ht;return[...(ut=_e==null?void 0:_e.args)!=null?ut:[],...(ht=st.args)!=null?ht:[{..._e,...st}]]},[JSON.stringify(st)]);return jsxRuntimeExports.jsx(at,{camera:lt,"blendMode-blendFunction":rt,"blendMode-opacity-value":it,...st,ref:ot,args:ct})}),DepthOfField=reactExports.forwardRef(function nt({blendFunction:_e,worldFocusDistance:et,worldFocusRange:rt,focusDistance:it,focusRange:st,focalLength:ot,bokehScale:at,resolutionScale:lt,resolutionX:ct,resolutionY:ut,width:ht,height:dt,target:ft,depthTexture:pt,...mt},At){const{camera:gt}=reactExports.useContext(EffectComposerContext),bt=ft!=null,Tt=reactExports.useMemo(()=>{const wt=new DepthOfFieldEffect(gt,{blendFunction:_e,worldFocusDistance:et,worldFocusRange:rt,focusDistance:it,focusRange:st,focalLength:ot,bokehScale:at,resolutionScale:lt,resolutionX:ct,resolutionY:ut,width:ht,height:dt});bt&&(wt.target=new Vector3$1),pt&&wt.setDepthTexture(pt.texture,pt.packing);const Rt=wt.maskPass;return Rt.maskFunction=MaskFunction.MULTIPLY_RGB_SET_ALPHA,wt},[gt,_e,et,rt,it,st,ot,at,lt,ct,ut,ht,dt,bt,pt]);return reactExports.useEffect(()=>()=>{Tt.dispose()},[Tt]),jsxRuntimeExports.jsx("primitive",{...mt,ref:At,object:Tt,target:ft})}),Bloom=wrapEffect(BloomEffect,{blendFunction:BlendFunction.ADD});function SpinningBox({scale:nt,..._e}){const et=reactExports.useRef(),[rt,it]=reactExports.useState(!1),[st,ot]=reactExports.useState(!1);return useCursor(rt),useFrame((at,lt)=>et.current.rotation.x=et.current.rotation.y+=lt),jsxRuntimeExports.jsxs("mesh",{..._e,ref:et,scale:st?nt*1.4:nt*1.2,onClick:at=>ot(!st),onPointerOver:at=>it(!0),onPointerOut:at=>it(!1),children:[jsxRuntimeExports.jsx("boxGeometry",{}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:rt?"hotpink":"indianred"})]})}ColorManagement$1.legacyMode=!1;const context=reactExports.createContext();function Instances({children:nt,..._e}){const{nodes:et}=useGLTF("/models/computers_1-transformed.glb"),rt=reactExports.useMemo(()=>({Object:et.Object_4,Object1:et.Object_16,Object3:et.Object_52,Object13:et.Object_172,Object14:et.Object_174,Object23:et.Object_22,Object24:et.Object_26,Object32:et.Object_178,Object36:et.Object_28,Object45:et.Object_206,Object46:et.Object_207,Object47:et.Object_215,Object48:et.Object_216,Sphere:et.Sphere}),[et]);return jsxRuntimeExports.jsx(Merged,{castShadow:!0,receiveShadow:!0,meshes:rt,..._e,children:it=>jsxRuntimeExports.jsx(context.Provider,{value:it,children:nt})})}function Computers(nt){const{nodes:_e,materials:et}=useGLTF("/models/computers_1-transformed.glb"),rt=reactExports.useContext(context);return jsxRuntimeExports.jsxs("group",{...nt,dispose:null,children:[jsxRuntimeExports.jsx(rt.Object,{position:[.16,.79,-1.97],rotation:[-.54,.93,-1.12],scale:.5}),jsxRuntimeExports.jsx(rt.Object,{position:[-2.79,.27,1.82],rotation:[-1.44,1.22,1.43],scale:.5}),jsxRuntimeExports.jsx(rt.Object,{position:[-5.6,4.62,-.03],rotation:[-1.96,.16,1.2],scale:.5}),jsxRuntimeExports.jsx(rt.Object,{position:[2.62,1.98,-2.47],rotation:[-.42,-.7,-1.85],scale:.5}),jsxRuntimeExports.jsx(rt.Object,{position:[4.6,3.46,1.19],rotation:[-1.24,-.72,.48],scale:.5}),jsxRuntimeExports.jsx(rt.Object1,{position:[.63,0,-3],rotation:[0,.17,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-2.36,.32,-2.02],rotation:[0,.53,-Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_24.geometry,material:et.Texture,position:[-2.42,.94,-2.25],rotation:[0,.14,Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-3.53,0,.59],rotation:[Math.PI,-1.09,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-3.53,1.53,.59],rotation:[0,.91,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[3.42,0,0],rotation:[-Math.PI,1.13,-Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[4.09,2.18,2.41],rotation:[0,-1.55,1.57],scale:1.52}),jsxRuntimeExports.jsx(rt.Object3,{position:[4.31,1.57,2.34],rotation:[0,-1.15,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object3,{position:[-3.79,0,1.66],rotation:[Math.PI,-1.39,0],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object3,{position:[-3.79,1.53,1.66],rotation:[0,1.22,-Math.PI],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-3.69,0,2.59],rotation:[0,-1.57,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.36,2.18,.81],rotation:[0,.77,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object3,{position:[-5.56,1.57,.69],rotation:[0,1.17,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.47,2.79,.74],rotation:[Math.PI,-1.16,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object3,{position:[-5.29,3.41,.89],rotation:[Math.PI,-.76,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.28,0,-2.33],rotation:[0,.75,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.49,0,-1.38],rotation:[Math.PI,-.99,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-3.01,0,-3.79],rotation:[0,.6,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-2.08,0,-4.32],rotation:[Math.PI,-.6,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-1.02,0,-4.49],rotation:[0,.31,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.31,1.83,-1.41],rotation:[0,1.06,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-4.18,1.83,-3.06],rotation:[-Math.PI,-.46,-Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-1.76,1.83,-3.6],rotation:[0,-1.16,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-.25,1.83,-5.54],rotation:[0,1.55,1.57],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.28,2.14,-2.33],rotation:[Math.PI,-.75,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.49,2.14,-1.38],rotation:[0,.99,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-3.01,2.14,-3.79],rotation:[Math.PI,-.6,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-2.08,2.14,-4.32],rotation:[0,.6,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-1.02,2.14,-4.49],rotation:[Math.PI,-.31,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-5.31,3.98,-1.41],rotation:[0,1.06,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-4.18,3.98,-3.06],rotation:[-Math.PI,-.46,-Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-1.17,3.98,-4.45],rotation:[0,.17,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object1,{position:[-.94,3.98,-4.66],rotation:[Math.PI,.02,-Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_140.geometry,material:et.Texture,position:[5.53,2.18,.17],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_144.geometry,material:et.Texture,position:[5.74,1.57,.05],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_148.geometry,material:et.Texture,position:[5.65,2.79,.11],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_152.geometry,material:et.Texture,position:[5.46,3.41,.26],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_156.geometry,material:et.Texture,position:[4.86,0,-2.54],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_160.geometry,material:et.Texture,position:[5.06,0,-1.6],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_164.geometry,material:et.Texture,position:[2.59,0,-4],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_168.geometry,material:et.Texture,position:[1.66,0,-4.54],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_170.geometry,material:et.Texture,position:[.59,0,-4.7],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object13,{position:[4.89,1.83,-1.62],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object14,{position:[3.75,1.83,-3.28],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_176.geometry,material:et.Texture,position:[1.33,1.83,-3.82],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_180.geometry,material:et.Texture,position:[4.86,2.14,-2.54],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_184.geometry,material:et.Texture,position:[5.06,2.14,-1.6],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_188.geometry,material:et.Texture,position:[2.59,2.14,-4],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_192.geometry,material:et.Texture,position:[1.66,2.14,-4.54],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_194.geometry,material:et.Texture,position:[.59,2.14,-4.7],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object13,{position:[4.89,3.98,-1.62],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object14,{position:[3.75,3.98,-3.28],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_200.geometry,material:et.Texture,position:[.75,3.98,-4.66],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_18.geometry,material:et.Texture,position:[-.19,0,-2.96],rotation:[0,-.06,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-2.29,1.56,-2.26],rotation:[0,-.005,-Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object24,{position:[-2.19,2.19,-1.87],rotation:[0,.51,Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-2.9,.3,-1.47],rotation:[Math.PI,-1.35,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[3.22,0,-.8],rotation:[0,-1.32,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[3.53,1.83,.44],rotation:[-Math.PI,1.32,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[4.26,.94,2.22],rotation:[0,-1,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object24,{position:[3.87,.32,2.35],rotation:[0,-1.53,-1.57],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-5.61,.94,.82],rotation:[0,1.32,1.57],scale:1.52}),jsxRuntimeExports.jsx(rt.Object24,{position:[-5.26,.32,1.01],rotation:[0,.79,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-5.39,4.03,.99],rotation:[Math.PI,-.61,Math.PI/2],scale:1.52}),jsxRuntimeExports.jsx(rt.Object24,{position:[-5.7,4.66,.72],rotation:[Math.PI,-1.13,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-5.95,0,-.64],rotation:[0,.95,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-4.48,0,-2.75],rotation:[Math.PI,-.57,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-3.72,0,-2.89],rotation:[0,.64,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-.08,0,-5.03],rotation:[Math.PI,-.04,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object24,{position:[-4.19,1.84,-2.77],rotation:[Math.PI,-.66,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-5.95,2.14,-.64],rotation:[Math.PI,-.95,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-4.48,2.14,-2.75],rotation:[0,.57,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-3.73,2.14,-3.1],rotation:[Math.PI,-.64,Math.PI],scale:1.52}),jsxRuntimeExports.jsx(rt.Object23,{position:[-.08,2.14,-5.03],rotation:[0,.04,0],scale:1.52}),jsxRuntimeExports.jsx(rt.Object24,{position:[-4.19,3.98,-2.77],rotation:[Math.PI,-.66,-Math.PI/2],scale:-1.52}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_142.geometry,material:et.Texture,position:[5.79,.94,.18],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_146.geometry,material:et.Texture,position:[5.43,.32,.37],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_150.geometry,material:et.Texture,position:[5.56,4.03,.35],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_154.geometry,material:et.Texture,position:[5.87,4.66,.08],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_158.geometry,material:et.Texture,position:[5.53,0,-.85],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_162.geometry,material:et.Texture,position:[4.05,0,-2.96],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_166.geometry,material:et.Texture,position:[3.29,0,-3.1],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object32,{position:[3.77,1.84,-2.98],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_182.geometry,material:et.Texture,position:[5.53,2.14,-.85],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_186.geometry,material:et.Texture,position:[4.05,2.14,-2.96],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_190.geometry,material:et.Texture,position:[3.3,2.14,-3.31],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object32,{position:[3.77,3.98,-2.98],rotation:[-Math.PI,0,0],scale:-1}),jsxRuntimeExports.jsx(rt.Object36,{position:[.35,2.35,-3.34],rotation:[-.26,0,0]}),jsxRuntimeExports.jsx(rt.Object36,{position:[.18,2.8,-2.85],rotation:[.09,.15,-.005]}),jsxRuntimeExports.jsx(rt.Object36,{position:[1.89,0,-1.94],rotation:[0,-.44,0],scale:[1.5,1,1.5]}),jsxRuntimeExports.jsx(rt.Object36,{position:[1.86,1.61,-1.81],rotation:[0,-Math.PI/3,0]}),jsxRuntimeExports.jsx(rt.Object36,{position:[3.95,2.49,1.61],rotation:[0,-Math.PI/3,0]}),jsxRuntimeExports.jsx(rt.Object36,{position:[-1.1,4.29,-4.43],rotation:[0,.36,0]}),jsxRuntimeExports.jsx(rt.Object36,{position:[-5.25,4.29,-1.47],rotation:[0,1.25,0]}),jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:_e.Object_204.geometry,material:et.Texture,position:[3.2,4.29,-3.09],rotation:[-Math.PI,.56,0],scale:-1}),jsxRuntimeExports.jsx(ScreenInteractive,{frame:"Object_206",panel:"Object_207",position:[.27,1.53,-2.61]}),jsxRuntimeExports.jsx(ScreenText,{frame:"Object_209",panel:"Object_210",y:5,position:[-1.43,2.5,-1.8],rotation:[0,1,0]}),jsxRuntimeExports.jsx(ScreenText,{invert:!0,frame:"Object_212",panel:"Object_213",x:-5,y:5,position:[-2.73,.63,-.52],rotation:[0,1.09,0]}),jsxRuntimeExports.jsx(ScreenText,{invert:!0,frame:"Object_215",panel:"Object_216",position:[1.84,.38,-1.77],rotation:[0,-Math.PI/9,0]}),jsxRuntimeExports.jsx(ScreenText,{invert:!0,frame:"Object_218",panel:"Object_219",x:-5,position:[3.11,2.15,-.18],rotation:[0,-.79,0],scale:.81}),jsxRuntimeExports.jsx(ScreenText,{frame:"Object_221",panel:"Object_222",y:5,position:[-3.42,3.06,1.3],rotation:[0,1.22,0],scale:.9}),jsxRuntimeExports.jsx(ScreenText,{invert:!0,frame:"Object_224",panel:"Object_225",position:[-3.9,4.29,-2.64],rotation:[0,.54,0]}),jsxRuntimeExports.jsx(ScreenText,{frame:"Object_227",panel:"Object_228",position:[.96,4.28,-4.2],rotation:[0,-.65,0]}),jsxRuntimeExports.jsx(ScreenText,{frame:"Object_230",panel:"Object_231",position:[4.68,4.29,-1.56],rotation:[0,-Math.PI/3,0]}),jsxRuntimeExports.jsx(Leds,{instances:rt})]})}function Screen({frame:nt,panel:_e,children:et,...rt}){const{nodes:it,materials:st}=useGLTF("/models/computers_1-transformed.glb");return jsxRuntimeExports.jsxs("group",{...rt,children:[jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:it[nt].geometry,material:st.Texture}),jsxRuntimeExports.jsx("mesh",{geometry:it[_e].geometry,children:jsxRuntimeExports.jsx("meshBasicMaterial",{toneMapped:!1,children:jsxRuntimeExports.jsx(RenderTexture,{width:512,height:512,attach:"map",anisotropy:16,children:et})})})]})}function ScreenText({invert:nt,x:_e=0,y:et=1.2,...rt}){const it=reactExports.useRef(),st=Math.random()*1e4;return useFrame(ot=>it.current.position.x=_e+Math.sin(st+ot.clock.elapsedTime/4)*8),jsxRuntimeExports.jsxs(Screen,{...rt,children:[jsxRuntimeExports.jsx(PerspectiveCamera$1,{makeDefault:!0,manual:!0,aspect:1/1,position:[0,0,15]}),jsxRuntimeExports.jsx("color",{attach:"background",args:[nt?"black":"#35c19f"]}),jsxRuntimeExports.jsx("ambientLight",{intensity:.5}),jsxRuntimeExports.jsx("directionalLight",{position:[10,10,5]}),jsxRuntimeExports.jsx(Text,{font:"./assets/Inter-Medium.woff",position:[_e,et,0],ref:it,fontSize:4,letterSpacing:-.1,color:nt?"#35c19f":"black",children:"Anshthedev."})]})}function ScreenInteractive(nt){return jsxRuntimeExports.jsxs(Screen,{...nt,children:[jsxRuntimeExports.jsx(PerspectiveCamera$1,{makeDefault:!0,manual:!0,aspect:1/1,position:[0,0,10]}),jsxRuntimeExports.jsx("color",{attach:"background",args:["orange"]}),jsxRuntimeExports.jsx("ambientLight",{intensity:Math.PI/2}),jsxRuntimeExports.jsx("pointLight",{decay:0,position:[10,10,10],intensity:Math.PI}),jsxRuntimeExports.jsx("pointLight",{decay:0,position:[-10,-10,-10]}),jsxRuntimeExports.jsx(SpinningBox,{position:[-3.15,.75,0],scale:.5})]})}function Leds({instances:nt}){const _e=reactExports.useRef(),{nodes:et}=useGLTF("/models/computers_1-transformed.glb");return reactExports.useMemo(()=>{et.Sphere.material=new MeshBasicMaterial$1,et.Sphere.material.toneMapped=!1},[]),useFrame(rt=>{_e.current.children.forEach(it=>{const st=Math.abs(2+it.position.x),ot=Math.round((1+Math.sin(st*1e4+rt.clock.elapsedTime*st))/2);it.color.setRGB(0,ot*1.1,ot)})}),jsxRuntimeExports.jsxs("group",{ref:_e,children:[jsxRuntimeExports.jsx(nt.Sphere,{position:[-.41,1.1,-2.21],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[.59,1.32,-2.22],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[1.77,1.91,-1.17],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[2.44,1.1,-.79],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[4.87,3.8,-.1],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[1.93,3.8,-3.69],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[-2.35,3.8,-3.48],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[-4.71,4.59,-1.81],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[-3.03,2.85,1.19],scale:.005,color:[1,2,1]}),jsxRuntimeExports.jsx(nt.Sphere,{position:[-1.21,1.73,-1.49],scale:.005,color:[1,2,1]})]})}const suzi=__vitePreload(()=>import("./bunny.glb-BOtn7u-Q.js"),[]),NewHero=()=>{const nt=useMediaQuery({maxWidth:440}),_e=useMediaQuery({maxWidth:768}),et=useMediaQuery({minWidth:768,maxWidth:1024});return reactExports.useMemo(()=>calculateSizes(nt,_e,et),[nt,_e,et]),jsxRuntimeExports.jsxs("section",{className:"relative h-screen w-full overflow-hidden",id:"home",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 w-full h-full",children:jsxRuntimeExports.jsxs(Canvas,{shadows:!0,dpr:[1,1.5],camera:{position:[-1.5,1,5.5],fov:45,near:1,far:20},eventSource:document.getElementById("root"),eventPrefix:"client",className:"w-full h-full",children:[jsxRuntimeExports.jsx("color",{attach:"background",args:["black"]}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.15,groundColor:"black"}),jsxRuntimeExports.jsx("spotLight",{decay:0,position:[10,20,10],angle:.12,penumbra:1,intensity:1,castShadow:!0,"shadow-mapSize":1024}),jsxRuntimeExports.jsxs("group",{position:[1.8,-1,0],children:[jsxRuntimeExports.jsx(Instances,{children:jsxRuntimeExports.jsx(Computers,{scale:.35})}),jsxRuntimeExports.jsxs("mesh",{receiveShadow:!0,rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[50,50]}),jsxRuntimeExports.jsx(MeshReflectorMaterial,{blur:[300,30],resolution:2048,mixBlur:1,mixStrength:180,roughness:1,depthScale:1.2,minDepthThreshold:.4,maxDepthThreshold:1.4,color:"#202020",metalness:.8})]}),jsxRuntimeExports.jsx(Bun,{scale:.3,position:[0,.3,.5],rotation:[0,-Math.PI*.85,0]}),jsxRuntimeExports.jsx("pointLight",{distance:1.5,intensity:1,position:[-.15,.7,0],color:"orange"})]}),jsxRuntimeExports.jsxs(EffectComposer,{disableNormalPass:!0,children:[jsxRuntimeExports.jsx(Bloom,{luminanceThreshold:0,mipmapBlur:!0,luminanceSmoothing:0,intensity:5}),jsxRuntimeExports.jsx(DepthOfField,{target:[2,0,13],focalLength:.3,bokehScale:15,height:700})]}),jsxRuntimeExports.jsx(CameraRig,{}),jsxRuntimeExports.jsx(BakeShadows,{})]})}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 h-full",children:[jsxRuntimeExports.jsx("div",{className:"max-w-[2000px] mx-auto w-full h-full px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16",children:jsxRuntimeExports.jsx("div",{className:"h-full flex flex-col lg:flex-row items-center justify-center lg:justify-between",children:jsxRuntimeExports.jsxs("div",{className:"w-full lg:w-1/2 flex flex-col items-center lg:items-start sm:mt-36 mt-20 gap-3 lg:gap-6",children:[jsxRuntimeExports.jsx("p",{className:"sm:text-2xl text-xl font-medium text-white/95 font-montserrat lg:text-3xl xl:text-4xl",children:"hey there, I am Ansh!"}),jsxRuntimeExports.jsx("p",{className:"hero_tag text-gray_gradient lg:text-left lg:text-4xl xl:text-5xl",children:"Full-stack dev & technology enthusiast"}),jsxRuntimeExports.jsx("div",{className:"hidden lg:block mt-8",children:jsxRuntimeExports.jsx("a",{href:"#about",className:"w-fit",children:jsxRuntimeExports.jsx(Button,{name:"Collaborate with Me",isBeam:!0,containerClass:"w-fit min-w-[250px] xl:min-w-[300px]"})})})]})})}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-7 left-0 right-0 w-full lg:hidden",children:jsxRuntimeExports.jsx("div",{className:"px-4 sm:px-6",children:jsxRuntimeExports.jsx("a",{href:"#about",className:"w-fit",children:jsxRuntimeExports.jsx(Button,{name:"Collaborate with Me",isBeam:!0,containerClass:"sm:w-fit w-full sm:min-w-96"})})})})]})]})};function Bun(nt){const{nodes:_e}=useGLTF(suspend(suzi).default);return jsxRuntimeExports.jsx("mesh",{receiveShadow:!0,castShadow:!0,geometry:_e.mesh.geometry,...nt,children:jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#222",roughness:.5})})}function CameraRig(){useFrame((nt,_e)=>{easing.damp3(nt.camera.position,[-1+nt.pointer.x*nt.viewport.width/3,(1+nt.pointer.y)/2,5.5],.5,_e),nt.camera.lookAt(0,0,0)})}const App=()=>jsxRuntimeExports.jsxs("main",{className:"max-w-7xl mx-auto relative",children:[jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsx(NewHero,{}),jsxRuntimeExports.jsx(About,{}),jsxRuntimeExports.jsx(Projects,{}),jsxRuntimeExports.jsx(Contact,{}),jsxRuntimeExports.jsx(Footer,{})]});createRoot$1(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
